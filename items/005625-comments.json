[
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/15767593",
    "html_url": "https://github.com/rust-lang/rust/issues/5625#issuecomment-15767593",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/5625",
    "id": 15767593,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE1NzY3NTkz",
    "user": {
      "login": "huonw",
      "id": 1203825,
      "node_id": "MDQ6VXNlcjEyMDM4MjU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1203825?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/huonw",
      "html_url": "https://github.com/huonw",
      "followers_url": "https://api.github.com/users/huonw/followers",
      "following_url": "https://api.github.com/users/huonw/following{/other_user}",
      "gists_url": "https://api.github.com/users/huonw/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/huonw/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/huonw/subscriptions",
      "organizations_url": "https://api.github.com/users/huonw/orgs",
      "repos_url": "https://api.github.com/users/huonw/repos",
      "events_url": "https://api.github.com/users/huonw/events{/privacy}",
      "received_events_url": "https://api.github.com/users/huonw/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2013-04-02T10:26:45Z",
    "updated_at": "2013-04-02T11:21:12Z",
    "body": "Similar code that segfaults, except when `_x2` is replaced by `ref _x2`, or when compiling with opt-level > 0.\n\n``` rust\nenum AB {\n    A {x: int},\n    B\n}\n\nfn main() {\n    let a = A {x : 1};\n    let b = B;\n\n    match a {\n        A {x : _x1} => {\n            match b {\n                A {x : _x2} => io::println(\"AA\"),\n                _ => io::println(\"A_\")\n            }\n        },\n        _ => io::println(\"_\")\n    }\n}\n```\n\n#5530 is almost certainly related (and quite probably the same issue), since both of these examples don't segfault when the `_` patterns are replaced by the appropriate variant.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/15767593/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/19016864",
    "html_url": "https://github.com/rust-lang/rust/issues/5625#issuecomment-19016864",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/5625",
    "id": 19016864,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE5MDE2ODY0",
    "user": {
      "login": "Aatch",
      "id": 342416,
      "node_id": "MDQ6VXNlcjM0MjQxNg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/342416?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Aatch",
      "html_url": "https://github.com/Aatch",
      "followers_url": "https://api.github.com/users/Aatch/followers",
      "following_url": "https://api.github.com/users/Aatch/following{/other_user}",
      "gists_url": "https://api.github.com/users/Aatch/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Aatch/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Aatch/subscriptions",
      "organizations_url": "https://api.github.com/users/Aatch/orgs",
      "repos_url": "https://api.github.com/users/Aatch/repos",
      "events_url": "https://api.github.com/users/Aatch/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Aatch/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2013-06-05T23:52:10Z",
    "updated_at": "2013-06-05T23:52:10Z",
    "body": "Hmm, seems like it's an issue with struct variants. There are two things to note, 1) this code works as expected:\n\n``` rust\nenum AB {\n    A {x: int},\n    B\n}\n\nfn main() {\n    let a = A { x: 1 };\n    let b = B;\n\n    match a {\n        A {x : _x1} => {\n            match b {\n                A {x : _x2} => println(\"AA\"),\n                _ => println(\"A_\")\n            }\n        },\n        _ => println(\"_\")\n    }\n}\n```\n\nand 2) even though the optimized example doesn't segfault, it still fails because it prints out `AA` instead of `A_`.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/19016864/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/19318568",
    "html_url": "https://github.com/rust-lang/rust/issues/5625#issuecomment-19318568",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/5625",
    "id": 19318568,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE5MzE4NTY4",
    "user": {
      "login": "pnkfelix",
      "id": 173127,
      "node_id": "MDQ6VXNlcjE3MzEyNw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/173127?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/pnkfelix",
      "html_url": "https://github.com/pnkfelix",
      "followers_url": "https://api.github.com/users/pnkfelix/followers",
      "following_url": "https://api.github.com/users/pnkfelix/following{/other_user}",
      "gists_url": "https://api.github.com/users/pnkfelix/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/pnkfelix/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/pnkfelix/subscriptions",
      "organizations_url": "https://api.github.com/users/pnkfelix/orgs",
      "repos_url": "https://api.github.com/users/pnkfelix/repos",
      "events_url": "https://api.github.com/users/pnkfelix/events{/privacy}",
      "received_events_url": "https://api.github.com/users/pnkfelix/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2013-06-12T10:56:46Z",
    "updated_at": "2013-06-12T11:03:50Z",
    "body": "The original test case also segfaults for me on Mac OS X.  (Noting this because the comments from tjc in #5530 indicate that the failure there might be Linux-specific.  But then again, I just saw the test from #5530 fail as well on my Mac.)\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/19318568/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/22120679",
    "html_url": "https://github.com/rust-lang/rust/issues/5625#issuecomment-22120679",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/5625",
    "id": 22120679,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIyMTIwNjc5",
    "user": {
      "login": "emberian",
      "id": 704250,
      "node_id": "MDQ6VXNlcjcwNDI1MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/704250?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/emberian",
      "html_url": "https://github.com/emberian",
      "followers_url": "https://api.github.com/users/emberian/followers",
      "following_url": "https://api.github.com/users/emberian/following{/other_user}",
      "gists_url": "https://api.github.com/users/emberian/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/emberian/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/emberian/subscriptions",
      "organizations_url": "https://api.github.com/users/emberian/orgs",
      "repos_url": "https://api.github.com/users/emberian/repos",
      "events_url": "https://api.github.com/users/emberian/events{/privacy}",
      "received_events_url": "https://api.github.com/users/emberian/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2013-08-05T17:08:14Z",
    "updated_at": "2013-08-05T17:08:14Z",
    "body": "Still reproduces\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/22120679/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/22208453",
    "html_url": "https://github.com/rust-lang/rust/issues/5625#issuecomment-22208453",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/5625",
    "id": 22208453,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIyMjA4NDUz",
    "user": {
      "login": "dim-an",
      "id": 88889,
      "node_id": "MDQ6VXNlcjg4ODg5",
      "avatar_url": "https://avatars.githubusercontent.com/u/88889?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dim-an",
      "html_url": "https://github.com/dim-an",
      "followers_url": "https://api.github.com/users/dim-an/followers",
      "following_url": "https://api.github.com/users/dim-an/following{/other_user}",
      "gists_url": "https://api.github.com/users/dim-an/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dim-an/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dim-an/subscriptions",
      "organizations_url": "https://api.github.com/users/dim-an/orgs",
      "repos_url": "https://api.github.com/users/dim-an/repos",
      "events_url": "https://api.github.com/users/dim-an/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dim-an/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2013-08-06T20:25:53Z",
    "updated_at": "2013-08-06T20:25:53Z",
    "body": "There is a simpler testcase:\n\n```\nenum AB {\n    A {x: int},\n    B\n}\n\nfn main() {\n    let a = B;\n    match a {\n        A {x : _x} => {fail!()}\n        _ => {}\n    }\n}\n```\n\nThis code gets compiled to the following llvm-assembly:\n\n```\n; Function Attrs: uwtable\ndefine void @\"_ZN4main17_23295c4eb32a43657_0$x2e0E\"({ i64, %tydesc*, i8*, i8*, i8 }*) #0 {\n\"function top level\":\n  %a = alloca %enum.AB\n  %__llmatch = alloca i64*\n  %_x = alloca i64\n  %__trans_ret_slot = alloca {}\n  %1 = alloca %str_slice\n  %2 = alloca %str_slice\n  %3 = getelementptr inbounds %enum.AB* %a, i32 0, i32 0\n  store i64 1, i64* %3\n  %4 = getelementptr inbounds %enum.AB* %a, i32 0, i32 0\n  %5 = load i64* %4, !range !0\n  switch i64 %5, label %match_else [\n    i64 0, label %match_case\n  ]\n\ncase_body:                                        ; preds = %match_else, %match_case\n  %6 = load i64** %__llmatch\n  %7 = load i64* %6\n  store i64 %7, i64* %_x\n  %8 = getelementptr inbounds %str_slice* %1, i32 0, i32 0\n  store i8* getelementptr inbounds ([17 x i8]* @str3379, i32 0, i32 0), i8** %8\n  %9 = getelementptr inbounds %str_slice* %1, i32 0, i32 1\n  store i64 17, i64* %9\n  %10 = getelementptr inbounds %str_slice* %2, i32 0, i32 0\n  store i8* getelementptr inbounds ([11 x i8]* @str3380, i32 0, i32 0), i8** %10\n  %11 = getelementptr inbounds %str_slice* %2, i32 0, i32 1\n  store i64 11, i64* %11\n  call void @\"_ZN3sys14__extensions__10meth_131479fail_with16_db4c44d01ce411614_0$x2e8$x2dpreE\"({}* %__trans_ret_slot, { i64, %tydesc*, i8*, i8*, i8 }* undef, %str_slice* %1, %str_slice* %2, i64 9)\n  unreachable\n\ncase_body1:                                       ; No predecessors!\n  br label %join\n\nmatch_else:                                       ; preds = %\"function top level\"\n  br label %case_body\n\nmatch_case:                                       ; preds = %\"function top level\"\n  %12 = bitcast %enum.AB* %a to { i64, i64 }*\n  %13 = getelementptr inbounds { i64, i64 }* %12, i32 0, i32 1\n  store i64* %13, i64** %__llmatch\n  br label %case_body\n\njoin:                                             ; preds = %case_body1\n  ret void\n}\n```\n\nas you can see both `match_case` and `match_else` lables jumps (`br`s) to `case_body`, while `match_else` should really jump to `case_body1`\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/22208453/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
