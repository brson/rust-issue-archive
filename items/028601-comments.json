[
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/142577116",
    "html_url": "https://github.com/rust-lang/rust/issues/28601#issuecomment-142577116",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28601",
    "id": 142577116,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE0MjU3NzExNg==",
    "user": {
      "login": "Veedrac",
      "id": 2867413,
      "node_id": "MDQ6VXNlcjI4Njc0MTM=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2867413?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Veedrac",
      "html_url": "https://github.com/Veedrac",
      "followers_url": "https://api.github.com/users/Veedrac/followers",
      "following_url": "https://api.github.com/users/Veedrac/following{/other_user}",
      "gists_url": "https://api.github.com/users/Veedrac/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Veedrac/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Veedrac/subscriptions",
      "organizations_url": "https://api.github.com/users/Veedrac/orgs",
      "repos_url": "https://api.github.com/users/Veedrac/repos",
      "events_url": "https://api.github.com/users/Veedrac/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Veedrac/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-09-23T11:52:02Z",
    "updated_at": "2015-09-23T12:23:18Z",
    "body": "Replacing the implementation of `clone_from` with just\n\n```\nself.truncate(0);\nself.push_all(&other);\n```\n\nfixes this for me, and `clone_from` becomes faster. I assume it was the `zip` causing problems.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/142577116/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/142577341",
    "html_url": "https://github.com/rust-lang/rust/issues/28601#issuecomment-142577341",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28601",
    "id": 142577341,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE0MjU3NzM0MQ==",
    "user": {
      "login": "bluss",
      "id": 3209739,
      "node_id": "MDQ6VXNlcjMyMDk3Mzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3209739?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/bluss",
      "html_url": "https://github.com/bluss",
      "followers_url": "https://api.github.com/users/bluss/followers",
      "following_url": "https://api.github.com/users/bluss/following{/other_user}",
      "gists_url": "https://api.github.com/users/bluss/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/bluss/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/bluss/subscriptions",
      "organizations_url": "https://api.github.com/users/bluss/orgs",
      "repos_url": "https://api.github.com/users/bluss/repos",
      "events_url": "https://api.github.com/users/bluss/events{/privacy}",
      "received_events_url": "https://api.github.com/users/bluss/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-09-23T11:54:02Z",
    "updated_at": "2015-09-23T11:54:02Z",
    "body": "That makes clone_from shallow and not recursive. I can totally see zip causing problems. Maybe some [zip optimizations](https://users.rust-lang.org/t/how-to-zip-two-slices-efficiently/2048) can help?\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/142577341/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/142578380",
    "html_url": "https://github.com/rust-lang/rust/issues/28601#issuecomment-142578380",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28601",
    "id": 142578380,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE0MjU3ODM4MA==",
    "user": {
      "login": "dotdash",
      "id": 230962,
      "node_id": "MDQ6VXNlcjIzMDk2Mg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/230962?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dotdash",
      "html_url": "https://github.com/dotdash",
      "followers_url": "https://api.github.com/users/dotdash/followers",
      "following_url": "https://api.github.com/users/dotdash/following{/other_user}",
      "gists_url": "https://api.github.com/users/dotdash/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dotdash/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dotdash/subscriptions",
      "organizations_url": "https://api.github.com/users/dotdash/orgs",
      "repos_url": "https://api.github.com/users/dotdash/repos",
      "events_url": "https://api.github.com/users/dotdash/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dotdash/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-09-23T12:00:55Z",
    "updated_at": "2015-09-23T12:00:55Z",
    "body": "I guess we should keep the reuse of the current values, might be faster for types that need to be dropped because the length can be kept fixed instead of shrinking first and regrowing later. Just replace the zip with a faster loop.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/142578380/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/142603104",
    "html_url": "https://github.com/rust-lang/rust/issues/28601#issuecomment-142603104",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28601",
    "id": 142603104,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE0MjYwMzEwNA==",
    "user": {
      "login": "Veedrac",
      "id": 2867413,
      "node_id": "MDQ6VXNlcjI4Njc0MTM=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2867413?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Veedrac",
      "html_url": "https://github.com/Veedrac",
      "followers_url": "https://api.github.com/users/Veedrac/followers",
      "following_url": "https://api.github.com/users/Veedrac/following{/other_user}",
      "gists_url": "https://api.github.com/users/Veedrac/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Veedrac/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Veedrac/subscriptions",
      "organizations_url": "https://api.github.com/users/Veedrac/orgs",
      "repos_url": "https://api.github.com/users/Veedrac/repos",
      "events_url": "https://api.github.com/users/Veedrac/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Veedrac/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-09-23T13:35:51Z",
    "updated_at": "2015-09-23T13:35:51Z",
    "body": "The best non-shallow clone I've managed is\n\n```\n// Manually inlining this prevents LLVM turning it into a memcpy\nunsafe fn clone_from_existing<T: Clone>(dst: &mut Vec<T>, src: &[T]) {\n    for i in 0..dst.len() {\n        dst.get_unchecked_mut(i).clone_from(src.get_unchecked(i));\n    }\n}\n\nself.truncate(other.len());\n\nunsafe { clone_from_existing(self, &other); }\n\nlet len = self.len();\nif len != other.len() {\n    self.push_all(&other[len..]);\n}\n```\n\nComparing it to `self.truncate(0); self.push_all(&other);`: For the given benchmarks, the above generally wins a tiny bit (<5%), except for the last two benchmarks where the simpler truncate-push version wins by 10-25%.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/142603104/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/142617878",
    "html_url": "https://github.com/rust-lang/rust/issues/28601#issuecomment-142617878",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28601",
    "id": 142617878,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE0MjYxNzg3OA==",
    "user": {
      "login": "apasel422",
      "id": 8644784,
      "node_id": "MDQ6VXNlcjg2NDQ3ODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8644784?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/apasel422",
      "html_url": "https://github.com/apasel422",
      "followers_url": "https://api.github.com/users/apasel422/followers",
      "following_url": "https://api.github.com/users/apasel422/following{/other_user}",
      "gists_url": "https://api.github.com/users/apasel422/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/apasel422/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/apasel422/subscriptions",
      "organizations_url": "https://api.github.com/users/apasel422/orgs",
      "repos_url": "https://api.github.com/users/apasel422/repos",
      "events_url": "https://api.github.com/users/apasel422/events{/privacy}",
      "received_events_url": "https://api.github.com/users/apasel422/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-09-23T14:25:58Z",
    "updated_at": "2015-09-23T14:25:58Z",
    "body": "Using `iterate_slices_counted_2` from @bluss's zip optimizations link above, I have `clone_from` winning in each scenario. I will open a PR shortly.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/142617878/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/142628585",
    "html_url": "https://github.com/rust-lang/rust/issues/28601#issuecomment-142628585",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28601",
    "id": 142628585,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE0MjYyODU4NQ==",
    "user": {
      "login": "Veedrac",
      "id": 2867413,
      "node_id": "MDQ6VXNlcjI4Njc0MTM=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2867413?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Veedrac",
      "html_url": "https://github.com/Veedrac",
      "followers_url": "https://api.github.com/users/Veedrac/followers",
      "following_url": "https://api.github.com/users/Veedrac/following{/other_user}",
      "gists_url": "https://api.github.com/users/Veedrac/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Veedrac/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Veedrac/subscriptions",
      "organizations_url": "https://api.github.com/users/Veedrac/orgs",
      "repos_url": "https://api.github.com/users/Veedrac/repos",
      "events_url": "https://api.github.com/users/Veedrac/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Veedrac/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-09-23T14:56:59Z",
    "updated_at": "2015-09-23T14:58:27Z",
    "body": "@apasel422 My suggestion prior is giving me better times.\n\nYours:\n\n```\ntest dst_bigger::src_100_dst_1000::clone_from ... bench:         112 ns/iter (+/- 1)\ntest dst_bigger::src_10_dst_100::clone_from   ... bench:          26 ns/iter (+/- 0)\ntest eq::src_1000_dst_1000::clone_from        ... bench:         921 ns/iter (+/- 15)\ntest eq::src_100_dst_100::clone_from          ... bench:         112 ns/iter (+/- 3)\ntest src_bigger::src_1000_dst_100::clone_from ... bench:         452 ns/iter (+/- 10)\ntest src_bigger::src_100_dst_10::clone_from   ... bench:          89 ns/iter (+/- 0)\n```\n\nMine:\n\n```\ntest dst_bigger::src_100_dst_1000::clone_from ... bench:          65 ns/iter (+/- 1)\ntest dst_bigger::src_10_dst_100::clone_from   ... bench:          23 ns/iter (+/- 0)\ntest eq::src_1000_dst_1000::clone_from        ... bench:         373 ns/iter (+/- 4)\ntest eq::src_100_dst_100::clone_from          ... bench:          66 ns/iter (+/- 1)\ntest src_bigger::src_1000_dst_100::clone_from ... bench:         424 ns/iter (+/- 7)\ntest src_bigger::src_100_dst_10::clone_from   ... bench:          91 ns/iter (+/- 14)\n```\n\nClone:\n\n```\ntest dst_bigger::src_100_dst_1000::clone      ... bench:         121 ns/iter (+/- 3)\ntest dst_bigger::src_10_dst_100::clone        ... bench:          79 ns/iter (+/- 3)\ntest eq::src_1000_dst_1000::clone             ... bench:         429 ns/iter (+/- 7)\ntest eq::src_100_dst_100::clone               ... bench:         121 ns/iter (+/- 2)\ntest src_bigger::src_1000_dst_100::clone      ... bench:         429 ns/iter (+/- 4)\ntest src_bigger::src_100_dst_10::clone        ... bench:         121 ns/iter (+/- 1)\n```\n\nAnd, for what it's worth, `self.truncate(0); self.push_all(&other);`\n\n```\ntest dst_bigger::src_100_dst_1000::clone_from ... bench:          68 ns/iter (+/- 2)\ntest dst_bigger::src_10_dst_100::clone_from   ... bench:          26 ns/iter (+/- 0)\ntest eq::src_1000_dst_1000::clone_from        ... bench:         376 ns/iter (+/- 6)\ntest eq::src_100_dst_100::clone_from          ... bench:          68 ns/iter (+/- 4)\ntest src_bigger::src_1000_dst_100::clone_from ... bench:         377 ns/iter (+/- 7)\ntest src_bigger::src_100_dst_10::clone_from   ... bench:          68 ns/iter (+/- 1)\n```\n\nI'm not sure why the discrepancy, especially for `src_1000_dst_1000`.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/142628585/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/142632854",
    "html_url": "https://github.com/rust-lang/rust/issues/28601#issuecomment-142632854",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28601",
    "id": 142632854,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE0MjYzMjg1NA==",
    "user": {
      "login": "apasel422",
      "id": 8644784,
      "node_id": "MDQ6VXNlcjg2NDQ3ODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8644784?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/apasel422",
      "html_url": "https://github.com/apasel422",
      "followers_url": "https://api.github.com/users/apasel422/followers",
      "following_url": "https://api.github.com/users/apasel422/following{/other_user}",
      "gists_url": "https://api.github.com/users/apasel422/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/apasel422/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/apasel422/subscriptions",
      "organizations_url": "https://api.github.com/users/apasel422/orgs",
      "repos_url": "https://api.github.com/users/apasel422/repos",
      "events_url": "https://api.github.com/users/apasel422/events{/privacy}",
      "received_events_url": "https://api.github.com/users/apasel422/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-09-23T15:07:05Z",
    "updated_at": "2015-09-23T15:07:05Z",
    "body": "@Veedrac Hmm. The call to `cmp::min` in mine appears to be unnecessary. Let me investigate.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/142632854/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
