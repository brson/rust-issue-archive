{
  "url": "https://api.github.com/repos/rust-lang/rust/issues/15670",
  "repository_url": "https://api.github.com/repos/rust-lang/rust",
  "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/15670/labels{/name}",
  "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/15670/comments",
  "events_url": "https://api.github.com/repos/rust-lang/rust/issues/15670/events",
  "html_url": "https://github.com/rust-lang/rust/pull/15670",
  "id": 37825156,
  "node_id": "MDExOlB1bGxSZXF1ZXN0MTgzNzIxMTY=",
  "number": 15670,
  "title": "speed up static linking by combining `ar` invocations",
  "user": {
    "login": "spernsteiner",
    "id": 3031136,
    "node_id": "MDQ6VXNlcjMwMzExMzY=",
    "avatar_url": "https://avatars.githubusercontent.com/u/3031136?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/spernsteiner",
    "html_url": "https://github.com/spernsteiner",
    "followers_url": "https://api.github.com/users/spernsteiner/followers",
    "following_url": "https://api.github.com/users/spernsteiner/following{/other_user}",
    "gists_url": "https://api.github.com/users/spernsteiner/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/spernsteiner/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/spernsteiner/subscriptions",
    "organizations_url": "https://api.github.com/users/spernsteiner/orgs",
    "repos_url": "https://api.github.com/users/spernsteiner/repos",
    "events_url": "https://api.github.com/users/spernsteiner/events{/privacy}",
    "received_events_url": "https://api.github.com/users/spernsteiner/received_events",
    "type": "User",
    "user_view_type": "public",
    "site_admin": false
  },
  "labels": [],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [],
  "milestone": null,
  "comments": 7,
  "created_at": "2014-07-14T20:31:31Z",
  "updated_at": "2014-07-30T09:21:13Z",
  "closed_at": "2014-07-30T09:21:12Z",
  "author_association": "CONTRIBUTOR",
  "type": null,
  "active_lock_reason": null,
  "draft": false,
  "pull_request": {
    "url": "https://api.github.com/repos/rust-lang/rust/pulls/15670",
    "html_url": "https://github.com/rust-lang/rust/pull/15670",
    "diff_url": "https://github.com/rust-lang/rust/pull/15670.diff",
    "patch_url": "https://github.com/rust-lang/rust/pull/15670.patch",
    "merged_at": "2014-07-30T09:21:13Z"
  },
  "body": "When rustc produces an rlib, it includes the contents of each static library required by the crate.  Currently each static library is added individually, by extracting the library with `ar x` and adding the objects to the rlib using `ar r`.  Each `ar r` has significant overhead - it appears to scan through the full contents of the rlib before adding the new files.  This patch avoids most of the overhead by adding all library objects (and other rlib components) at once using a single `ar r`.\n\nWhen building `librustc` (on Linux, using GNU ar), this patch gives a 60-80% reduction in linking time, from 90s to 10s one machine I tried and 25s to 8s on another.  (Though `librustc` is a bit of a special case - it's a very large crate, so the rlib is large to begin with, and it also relies on a total of 45 static libraries due to the way LLVM is organized.)  More reasonable crates such as `libstd` and `libcore` also get a small reduction in linking time (just from adding metadata, bitcode, and object code in one `ar` invocation instead of three), but this is not very noticeable since the time there is small to begin with (around 1s).\n",
  "closed_by": {
    "login": "bors",
    "id": 3372342,
    "node_id": "MDQ6VXNlcjMzNzIzNDI=",
    "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/bors",
    "html_url": "https://github.com/bors",
    "followers_url": "https://api.github.com/users/bors/followers",
    "following_url": "https://api.github.com/users/bors/following{/other_user}",
    "gists_url": "https://api.github.com/users/bors/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/bors/subscriptions",
    "organizations_url": "https://api.github.com/users/bors/orgs",
    "repos_url": "https://api.github.com/users/bors/repos",
    "events_url": "https://api.github.com/users/bors/events{/privacy}",
    "received_events_url": "https://api.github.com/users/bors/received_events",
    "type": "User",
    "user_view_type": "public",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/15670/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/15670/timeline",
  "performed_via_github_app": null,
  "state_reason": null,
  "_meta": {
    "type": "pr"
  }
}
