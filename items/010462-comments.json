[
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/28406141",
    "html_url": "https://github.com/rust-lang/rust/issues/10462#issuecomment-28406141",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10462",
    "id": 28406141,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI4NDA2MTQx",
    "user": {
      "login": "klutzy",
      "id": 1589355,
      "node_id": "MDQ6VXNlcjE1ODkzNTU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1589355?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/klutzy",
      "html_url": "https://github.com/klutzy",
      "followers_url": "https://api.github.com/users/klutzy/followers",
      "following_url": "https://api.github.com/users/klutzy/following{/other_user}",
      "gists_url": "https://api.github.com/users/klutzy/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/klutzy/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/klutzy/subscriptions",
      "organizations_url": "https://api.github.com/users/klutzy/orgs",
      "repos_url": "https://api.github.com/users/klutzy/repos",
      "events_url": "https://api.github.com/users/klutzy/events{/privacy}",
      "received_events_url": "https://api.github.com/users/klutzy/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2013-11-13T15:54:15Z",
    "updated_at": "2013-11-13T15:54:15Z",
    "body": "I initially thought this would work:\n\n``` Diff\n pub struct TempDir {\n     priv path: Option<Path>\n+    priv tmpdir: ~Path\n }\n...\n\n     pub fn new_in(tmpdir: &Path, suffix: &str) -> Option<TempDir> {\n...\n-                Ok(()) => return Some(TempDir { path: Some(p) })\n+                Ok(()) => return Some(TempDir { path: Some(p), tmpdir: tmpdir.clone() })\n...\n     }\n...\n impl Drop for TempDir {\n     fn drop(&mut self) {\n        for path in self.path.iter() {\n            if path.exists() {\n+               os::change_dir(tmpdir);\n                fs::rmdir_recursive(path);\n            }\n        }\n     }\n```\n\nbut I realized that `os::change_dir` is not task-safe: #10463\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/28406141/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/28413845",
    "html_url": "https://github.com/rust-lang/rust/issues/10462#issuecomment-28413845",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10462",
    "id": 28413845,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI4NDEzODQ1",
    "user": {
      "login": "alexcrichton",
      "id": 64996,
      "node_id": "MDQ6VXNlcjY0OTk2",
      "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alexcrichton",
      "html_url": "https://github.com/alexcrichton",
      "followers_url": "https://api.github.com/users/alexcrichton/followers",
      "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}",
      "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions",
      "organizations_url": "https://api.github.com/users/alexcrichton/orgs",
      "repos_url": "https://api.github.com/users/alexcrichton/repos",
      "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alexcrichton/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2013-11-13T17:15:57Z",
    "updated_at": "2013-11-13T17:15:57Z",
    "body": "It would seem to me that the most reasonable thing to do would to be just ignore the error in the destructor of `TempDir`. It's also a real possibility that someone else removed it, but it's just a temporary thing that should do its best to go away. If you changed directories into that directory, then I think that it's then your responsibility for removing it.\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/28413845/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/28426225",
    "html_url": "https://github.com/rust-lang/rust/issues/10462#issuecomment-28426225",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10462",
    "id": 28426225,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI4NDI2MjI1",
    "user": {
      "login": "ben0x539",
      "id": 24142,
      "node_id": "MDQ6VXNlcjI0MTQy",
      "avatar_url": "https://avatars.githubusercontent.com/u/24142?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ben0x539",
      "html_url": "https://github.com/ben0x539",
      "followers_url": "https://api.github.com/users/ben0x539/followers",
      "following_url": "https://api.github.com/users/ben0x539/following{/other_user}",
      "gists_url": "https://api.github.com/users/ben0x539/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ben0x539/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ben0x539/subscriptions",
      "organizations_url": "https://api.github.com/users/ben0x539/orgs",
      "repos_url": "https://api.github.com/users/ben0x539/repos",
      "events_url": "https://api.github.com/users/ben0x539/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ben0x539/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2013-11-13T19:35:56Z",
    "updated_at": "2013-11-13T19:35:56Z",
    "body": "I don't think unconditionally changing directories in the destructor is appropriate, but I'm not happy about silently leaving temporary directories lying around.\n\nThe destructor could check whether the current working directory is a subdirectory of the one it's going to delete and only if so change directory to its parent directory, but then we're still transparently changing directories in a destructor, which I'm pretty sure is going to catch most people by surprise.\n\nI'd suggest we should just fail on all platforms in that case, but then we're failing in a destructor and callers pretty much need to do their own RAII for `chdir`'ing into and out of the temp dir to avoid unwinding while still in the temp dir and then aborting. :(\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/28426225/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/28450677",
    "html_url": "https://github.com/rust-lang/rust/issues/10462#issuecomment-28450677",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10462",
    "id": 28450677,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI4NDUwNjc3",
    "user": {
      "login": "klutzy",
      "id": 1589355,
      "node_id": "MDQ6VXNlcjE1ODkzNTU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1589355?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/klutzy",
      "html_url": "https://github.com/klutzy",
      "followers_url": "https://api.github.com/users/klutzy/followers",
      "following_url": "https://api.github.com/users/klutzy/following{/other_user}",
      "gists_url": "https://api.github.com/users/klutzy/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/klutzy/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/klutzy/subscriptions",
      "organizations_url": "https://api.github.com/users/klutzy/orgs",
      "repos_url": "https://api.github.com/users/klutzy/repos",
      "events_url": "https://api.github.com/users/klutzy/events{/privacy}",
      "received_events_url": "https://api.github.com/users/klutzy/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2013-11-14T00:58:26Z",
    "updated_at": "2013-11-14T00:58:26Z",
    "body": "I started to think the real issue is that user does not easily recognize `TempDir::drop()` will occur. What about adding `tempfile::with_temp_dir()` function like this? (not tested)\n\n``` Rust\nfn with_temp_dir<T>(base: &Path, suffix: &str, f: |temp_dir: &Path| -> T) -> T {\n    let prev_path = os::getcwd();\n    let temp_dir = TempDir::new_in(base, suffix);\n    os::change_dir(temp_dir.path());\n    let result = f(temp_dir.path());\n    os::change_dir(prev_path);\n    fs::rmdir_recursive(temp_dir);\n    result\n}\n```\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/28450677/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/36420035",
    "html_url": "https://github.com/rust-lang/rust/issues/10462#issuecomment-36420035",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10462",
    "id": 36420035,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM2NDIwMDM1",
    "user": {
      "login": "alexcrichton",
      "id": 64996,
      "node_id": "MDQ6VXNlcjY0OTk2",
      "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alexcrichton",
      "html_url": "https://github.com/alexcrichton",
      "followers_url": "https://api.github.com/users/alexcrichton/followers",
      "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}",
      "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions",
      "organizations_url": "https://api.github.com/users/alexcrichton/orgs",
      "repos_url": "https://api.github.com/users/alexcrichton/repos",
      "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alexcrichton/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-03-01T09:02:34Z",
    "updated_at": "2014-03-01T09:02:34Z",
    "body": "cc #12628\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/36420035/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/73938575",
    "html_url": "https://github.com/rust-lang/rust/issues/10462#issuecomment-73938575",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10462",
    "id": 73938575,
    "node_id": "MDEyOklzc3VlQ29tbWVudDczOTM4NTc1",
    "user": {
      "login": "alexcrichton",
      "id": 64996,
      "node_id": "MDQ6VXNlcjY0OTk2",
      "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alexcrichton",
      "html_url": "https://github.com/alexcrichton",
      "followers_url": "https://api.github.com/users/alexcrichton/followers",
      "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}",
      "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions",
      "organizations_url": "https://api.github.com/users/alexcrichton/orgs",
      "repos_url": "https://api.github.com/users/alexcrichton/repos",
      "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alexcrichton/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-02-11T18:45:39Z",
    "updated_at": "2015-02-11T18:45:39Z",
    "body": "Since opening the `drop` implementation of `TempDir` has been modified to respect the semantics of not panicking on drop and ignoring I/O errors, so I'm going to close this.\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/73938575/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
