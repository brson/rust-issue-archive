[
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/51729189",
    "html_url": "https://github.com/rust-lang/rust/pull/16407#issuecomment-51729189",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/16407",
    "id": 51729189,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUxNzI5MTg5",
    "user": {
      "login": "ipetkov",
      "id": 1638690,
      "node_id": "MDQ6VXNlcjE2Mzg2OTA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1638690?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ipetkov",
      "html_url": "https://github.com/ipetkov",
      "followers_url": "https://api.github.com/users/ipetkov/followers",
      "following_url": "https://api.github.com/users/ipetkov/following{/other_user}",
      "gists_url": "https://api.github.com/users/ipetkov/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ipetkov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ipetkov/subscriptions",
      "organizations_url": "https://api.github.com/users/ipetkov/orgs",
      "repos_url": "https://api.github.com/users/ipetkov/repos",
      "events_url": "https://api.github.com/users/ipetkov/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ipetkov/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-08-10T22:16:48Z",
    "updated_at": "2014-08-10T22:16:48Z",
    "body": "Sample program that demonstrates scenario 1 above:\n\n``` rust\nextern crate native;\nextern crate rustrt;\n\nfn main() {\n    let fdes = match native::io::file::open(&\"output.txt\".to_c_str(), rustrt::rtio::Open, rustrt::rtio::Write) {\n        Ok(f) => f,\n        Err(_) => fail!(\"failed to open file\"),\n    };\n\n    let mut cmd = std::io::process::Command::new(\"echo\");\n    cmd.arg(\"hello\");\n    cmd.arg(\"world\");\n    cmd.stdout(std::io::process::InheritFd(fdes.fd()));\n\n    let mut process = match cmd.spawn() {\n        Ok(p) => p,\n        Err(e) => fail!(\"failed to spawn process: {}\", e),\n    };\n\n    match process.wait() {\n        Ok(s) => println!(\"subprocess exited with status: {}\", s),\n        Err(e) => fail!(\"failed to wait on process: {}\", e),\n    }\n\n    // fdes destroyed here\n}\n```\n\nOutput:\n\n```\nsubprocess exited with status: exit code: 0\nerror -1 when closing file descriptor 3\n```\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/51729189/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/51729367",
    "html_url": "https://github.com/rust-lang/rust/pull/16407#issuecomment-51729367",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/16407",
    "id": 51729367,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUxNzI5MzY3",
    "user": {
      "login": "ipetkov",
      "id": 1638690,
      "node_id": "MDQ6VXNlcjE2Mzg2OTA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1638690?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ipetkov",
      "html_url": "https://github.com/ipetkov",
      "followers_url": "https://api.github.com/users/ipetkov/followers",
      "following_url": "https://api.github.com/users/ipetkov/following{/other_user}",
      "gists_url": "https://api.github.com/users/ipetkov/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ipetkov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ipetkov/subscriptions",
      "organizations_url": "https://api.github.com/users/ipetkov/orgs",
      "repos_url": "https://api.github.com/users/ipetkov/repos",
      "events_url": "https://api.github.com/users/ipetkov/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ipetkov/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-08-10T22:23:35Z",
    "updated_at": "2014-08-10T22:23:35Z",
    "body": "Perhaps `std::io::process::Command` could be given an interface to set a file descriptor for a child via a file path, where it would internally create a `FileDesc` object and close it after the process was spawned, thus safely freeing up resources after spawning.\n\nThis approach, however, would require creating the `FileDesc` object via `libnative`, causing a nasty circular dependency between the `libstd` and `libnative`...\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/51729367/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/51739093",
    "html_url": "https://github.com/rust-lang/rust/pull/16407#issuecomment-51739093",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/16407",
    "id": 51739093,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUxNzM5MDkz",
    "user": {
      "login": "alexcrichton",
      "id": 64996,
      "node_id": "MDQ6VXNlcjY0OTk2",
      "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alexcrichton",
      "html_url": "https://github.com/alexcrichton",
      "followers_url": "https://api.github.com/users/alexcrichton/followers",
      "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}",
      "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions",
      "organizations_url": "https://api.github.com/users/alexcrichton/orgs",
      "repos_url": "https://api.github.com/users/alexcrichton/repos",
      "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alexcrichton/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-08-11T03:31:27Z",
    "updated_at": "2014-08-11T03:31:27Z",
    "body": "This seems like it can definitely cause badness, nice catch! Just a few requests and this should be good to go:\n- Can you update the documentation for `InheritFd` to explicitly say that it does not take ownership of the file descriptor?\n- Can you add a test for this functionality?\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/51739093/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/51783264",
    "html_url": "https://github.com/rust-lang/rust/pull/16407#issuecomment-51783264",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/16407",
    "id": 51783264,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUxNzgzMjY0",
    "user": {
      "login": "ipetkov",
      "id": 1638690,
      "node_id": "MDQ6VXNlcjE2Mzg2OTA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1638690?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ipetkov",
      "html_url": "https://github.com/ipetkov",
      "followers_url": "https://api.github.com/users/ipetkov/followers",
      "following_url": "https://api.github.com/users/ipetkov/following{/other_user}",
      "gists_url": "https://api.github.com/users/ipetkov/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ipetkov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ipetkov/subscriptions",
      "organizations_url": "https://api.github.com/users/ipetkov/orgs",
      "repos_url": "https://api.github.com/users/ipetkov/repos",
      "events_url": "https://api.github.com/users/ipetkov/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ipetkov/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-08-11T13:58:31Z",
    "updated_at": "2014-08-11T13:58:31Z",
    "body": "@alexcrichton done, and done!\n\nI added the test under `libnative` since I didn't want to add a dependency to it from `std`, even though it is technically testing commands from `std`.\n\nAlso I apparently messed up rebasing and pushing the branch last night and pushed an existing commit, making bors think the branch was already merged. Since I cant seem to be able to reopen the PR I submitted a new one here: #16421\n\nSorry about the confusion!\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/51783264/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
