[
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/145129810",
    "html_url": "https://github.com/rust-lang/rust/issues/28809#issuecomment-145129810",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28809",
    "id": 145129810,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE0NTEyOTgxMA==",
    "user": {
      "login": "petrochenkov",
      "id": 5751617,
      "node_id": "MDQ6VXNlcjU3NTE2MTc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5751617?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/petrochenkov",
      "html_url": "https://github.com/petrochenkov",
      "followers_url": "https://api.github.com/users/petrochenkov/followers",
      "following_url": "https://api.github.com/users/petrochenkov/following{/other_user}",
      "gists_url": "https://api.github.com/users/petrochenkov/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/petrochenkov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/petrochenkov/subscriptions",
      "organizations_url": "https://api.github.com/users/petrochenkov/orgs",
      "repos_url": "https://api.github.com/users/petrochenkov/repos",
      "events_url": "https://api.github.com/users/petrochenkov/events{/privacy}",
      "received_events_url": "https://api.github.com/users/petrochenkov/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-10-02T19:16:38Z",
    "updated_at": "2015-10-02T19:16:49Z",
    "body": "Oh, I was interested in this some time ago, but mostly in `Self` and not type parameters, which is similar nonetheless.\nThe changes in librustc_resolve required to resolve `Self` or type parameters in types or initializers of associated constants are simple, I can do them, but I have no idea what repercussions it will cause in later stages of compilation (especially for initializers).\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/145129810/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/149567575",
    "html_url": "https://github.com/rust-lang/rust/issues/28809#issuecomment-149567575",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28809",
    "id": 149567575,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE0OTU2NzU3NQ==",
    "user": {
      "login": "pnkfelix",
      "id": 173127,
      "node_id": "MDQ6VXNlcjE3MzEyNw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/173127?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/pnkfelix",
      "html_url": "https://github.com/pnkfelix",
      "followers_url": "https://api.github.com/users/pnkfelix/followers",
      "following_url": "https://api.github.com/users/pnkfelix/following{/other_user}",
      "gists_url": "https://api.github.com/users/pnkfelix/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/pnkfelix/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/pnkfelix/subscriptions",
      "organizations_url": "https://api.github.com/users/pnkfelix/orgs",
      "repos_url": "https://api.github.com/users/pnkfelix/repos",
      "events_url": "https://api.github.com/users/pnkfelix/events{/privacy}",
      "received_events_url": "https://api.github.com/users/pnkfelix/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-10-20T13:24:59Z",
    "updated_at": "2015-10-20T13:27:11Z",
    "body": "sigh: my actual goal here was to be able to adjust `NonZero::new(inner)` to assert that `inner` is non-zero.\n\nI thought I could still achieve this by adding an `fn is_zero(&self) -> bool` to the `trait Zeroable`.\n\nAnd until recently, that worked.\n\nBut now with #29085, adding the above check does not work, because we cannot call the non-const `is_zero` method from the now `const` function `NonZero::new`.\n\nAnd we cannot make `fn is_zero` itself `const`, because [RFC 911](https://github.com/rust-lang/rfcs/blob/master/text/0911-const-fn.md) does not allow trait methods to be declared `const`.\n\n(I'm not 100% clear about the reasoning there, I have read the discussion in its [alternatives](https://github.com/rust-lang/rfcs/blob/master/text/0911-const-fn.md#alternatives) section a couple times but still do not quite grok why it is hard to apply the same analysis we use for normal `const fn` onto the `const fn` for the `impl` of the trait...)\n\n---\n\nUpdate: okay, clearly even if we got the capability to declare trait methods as `const`, I would still have the same problem that I could not include the assertion I want in `NonZero::new`, since as a `const fn` I would not be allowed to write:\n\n``` rust\n        pub unsafe const fn new(inner: T) -> NonZero<T> {\n            debug_assert!(!inner.is_zero());\n            NonZero(inner)\n        }\n```\n\nmeh.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/149567575/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/176724914",
    "html_url": "https://github.com/rust-lang/rust/issues/28809#issuecomment-176724914",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28809",
    "id": 176724914,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE3NjcyNDkxNA==",
    "user": {
      "login": "pnkfelix",
      "id": 173127,
      "node_id": "MDQ6VXNlcjE3MzEyNw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/173127?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/pnkfelix",
      "html_url": "https://github.com/pnkfelix",
      "followers_url": "https://api.github.com/users/pnkfelix/followers",
      "following_url": "https://api.github.com/users/pnkfelix/following{/other_user}",
      "gists_url": "https://api.github.com/users/pnkfelix/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/pnkfelix/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/pnkfelix/subscriptions",
      "organizations_url": "https://api.github.com/users/pnkfelix/orgs",
      "repos_url": "https://api.github.com/users/pnkfelix/repos",
      "events_url": "https://api.github.com/users/pnkfelix/events{/privacy}",
      "received_events_url": "https://api.github.com/users/pnkfelix/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2016-01-29T12:10:24Z",
    "updated_at": "2016-01-29T12:10:24Z",
    "body": "I just encountered another case where this bug bit me: we have some places where we have a new-type wrapper around a `usize` acting as an index into some other array-based data-structure, and we use `usize::MAX` to represent an invalid index.\n- (Thinking on the matter now, I guess there are other options here, like making the array 1-indexed, implementing `NonZero` for the wrapper, and then using `Option<Wrapper>` as the actual type with `None` as the invalid case. But I digress.)\n\nAnyway, I thought I might play with trying to make a trait to capture this pattern of new-typed wrapper around a simple `usize` index into some associated array container.  So I tried making this:\n\n``` rust\ntrait Idx {\n    type Data;\n    const INVALID: Self;\n    fn idx(&self) -> usize;\n}\n```\n\nthen I tried making this impl of the above trait:\n\n``` rust\npub struct MovePathIndex(usize);\n\nconst INVALID_MOVE_PATH_INDEX: MovePathIndex = MovePathIndex(usize::MAX);\n\nimpl Idx for MovePathIndex {\n    type Data = MovePath;\n    const INVALID: Self = INVALID_MOVE_PATH_INDEX;\n    fn idx(&self) -> usize { self.0 }\n}\n```\n\nand Bam: I hit the bug:\n\n```\n/Users/fklock/Dev/Mozilla/rust-mir/src/librustc_borrowck/borrowck/mir/gather_moves.rs:24:20: 24:24 error: cannot use an outer type parameter in this context [E0402]\n/Users/fklock/Dev/Mozilla/rust-mir/src/librustc_borrowck/borrowck/mir/gather_moves.rs:24     const INVALID: Self = INVALID_MOVE_PATH_INDEX;\n                                                                                                            ^~~~\n/Users/fklock/Dev/Mozilla/rust-mir/src/librustc_borrowck/borrowck/mir/gather_moves.rs:24:20: 24:24 error: use of `Self` outside of an impl or trait [E0411]\n/Users/fklock/Dev/Mozilla/rust-mir/src/librustc_borrowck/borrowck/mir/gather_moves.rs:24     const INVALID: Self = INVALID_MOVE_PATH_INDEX;\n                                                                                                            ^~~~\n```\n\n(I suspect this is exactly the kind of case that @petrochenkov was talking about above.)\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/176724914/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/176725098",
    "html_url": "https://github.com/rust-lang/rust/issues/28809#issuecomment-176725098",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28809",
    "id": 176725098,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE3NjcyNTA5OA==",
    "user": {
      "login": "pnkfelix",
      "id": 173127,
      "node_id": "MDQ6VXNlcjE3MzEyNw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/173127?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/pnkfelix",
      "html_url": "https://github.com/pnkfelix",
      "followers_url": "https://api.github.com/users/pnkfelix/followers",
      "following_url": "https://api.github.com/users/pnkfelix/following{/other_user}",
      "gists_url": "https://api.github.com/users/pnkfelix/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/pnkfelix/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/pnkfelix/subscriptions",
      "organizations_url": "https://api.github.com/users/pnkfelix/orgs",
      "repos_url": "https://api.github.com/users/pnkfelix/repos",
      "events_url": "https://api.github.com/users/pnkfelix/events{/privacy}",
      "received_events_url": "https://api.github.com/users/pnkfelix/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2016-01-29T12:11:37Z",
    "updated_at": "2016-01-29T12:11:37Z",
    "body": "(nominating so that the compiler team can decide what priority it is to fix this, assuming it should be fixed in the first place...)\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/176725098/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/180051942",
    "html_url": "https://github.com/rust-lang/rust/issues/28809#issuecomment-180051942",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28809",
    "id": 180051942,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE4MDA1MTk0Mg==",
    "user": {
      "login": "nikomatsakis",
      "id": 155238,
      "node_id": "MDQ6VXNlcjE1NTIzOA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/155238?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nikomatsakis",
      "html_url": "https://github.com/nikomatsakis",
      "followers_url": "https://api.github.com/users/nikomatsakis/followers",
      "following_url": "https://api.github.com/users/nikomatsakis/following{/other_user}",
      "gists_url": "https://api.github.com/users/nikomatsakis/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nikomatsakis/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nikomatsakis/subscriptions",
      "organizations_url": "https://api.github.com/users/nikomatsakis/orgs",
      "repos_url": "https://api.github.com/users/nikomatsakis/repos",
      "events_url": "https://api.github.com/users/nikomatsakis/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nikomatsakis/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2016-02-04T21:11:22Z",
    "updated_at": "2016-02-04T21:11:22Z",
    "body": "triage: P-medium\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/180051942/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/218330833",
    "html_url": "https://github.com/rust-lang/rust/issues/28809#issuecomment-218330833",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28809",
    "id": 218330833,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIxODMzMDgzMw==",
    "user": {
      "login": "nagisa",
      "id": 679122,
      "node_id": "MDQ6VXNlcjY3OTEyMg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/679122?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nagisa",
      "html_url": "https://github.com/nagisa",
      "followers_url": "https://api.github.com/users/nagisa/followers",
      "following_url": "https://api.github.com/users/nagisa/following{/other_user}",
      "gists_url": "https://api.github.com/users/nagisa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nagisa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nagisa/subscriptions",
      "organizations_url": "https://api.github.com/users/nagisa/orgs",
      "repos_url": "https://api.github.com/users/nagisa/repos",
      "events_url": "https://api.github.com/users/nagisa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nagisa/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2016-05-11T00:28:12Z",
    "updated_at": "2016-05-11T00:28:12Z",
    "body": "Hit this just now.\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/218330833/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/218331626",
    "html_url": "https://github.com/rust-lang/rust/issues/28809#issuecomment-218331626",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28809",
    "id": 218331626,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIxODMzMTYyNg==",
    "user": {
      "login": "nagisa",
      "id": 679122,
      "node_id": "MDQ6VXNlcjY3OTEyMg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/679122?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nagisa",
      "html_url": "https://github.com/nagisa",
      "followers_url": "https://api.github.com/users/nagisa/followers",
      "following_url": "https://api.github.com/users/nagisa/following{/other_user}",
      "gists_url": "https://api.github.com/users/nagisa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nagisa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nagisa/subscriptions",
      "organizations_url": "https://api.github.com/users/nagisa/orgs",
      "repos_url": "https://api.github.com/users/nagisa/repos",
      "events_url": "https://api.github.com/users/nagisa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nagisa/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2016-05-11T00:34:10Z",
    "updated_at": "2016-05-11T00:34:10Z",
    "body": "Similar thing you cannot do is\n\n```\nimpl<T> Trait for Option<T> {\nconst C: Option<T> ... = Some(<T as Trait>::C);\n                               ^ cannot use T here either\n```\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/218331626/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/218333812",
    "html_url": "https://github.com/rust-lang/rust/issues/28809#issuecomment-218333812",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28809",
    "id": 218333812,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIxODMzMzgxMg==",
    "user": {
      "login": "nagisa",
      "id": 679122,
      "node_id": "MDQ6VXNlcjY3OTEyMg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/679122?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nagisa",
      "html_url": "https://github.com/nagisa",
      "followers_url": "https://api.github.com/users/nagisa/followers",
      "following_url": "https://api.github.com/users/nagisa/following{/other_user}",
      "gists_url": "https://api.github.com/users/nagisa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nagisa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nagisa/subscriptions",
      "organizations_url": "https://api.github.com/users/nagisa/orgs",
      "repos_url": "https://api.github.com/users/nagisa/repos",
      "events_url": "https://api.github.com/users/nagisa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nagisa/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2016-05-11T00:49:55Z",
    "updated_at": "2016-05-11T00:49:55Z",
    "body": "cc @eddyb \n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/218333812/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/218338048",
    "html_url": "https://github.com/rust-lang/rust/issues/28809#issuecomment-218338048",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28809",
    "id": 218338048,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIxODMzODA0OA==",
    "user": {
      "login": "eddyb",
      "id": 77424,
      "node_id": "MDQ6VXNlcjc3NDI0",
      "avatar_url": "https://avatars.githubusercontent.com/u/77424?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/eddyb",
      "html_url": "https://github.com/eddyb",
      "followers_url": "https://api.github.com/users/eddyb/followers",
      "following_url": "https://api.github.com/users/eddyb/following{/other_user}",
      "gists_url": "https://api.github.com/users/eddyb/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/eddyb/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/eddyb/subscriptions",
      "organizations_url": "https://api.github.com/users/eddyb/orgs",
      "repos_url": "https://api.github.com/users/eddyb/repos",
      "events_url": "https://api.github.com/users/eddyb/events{/privacy}",
      "received_events_url": "https://api.github.com/users/eddyb/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2016-05-11T01:22:12Z",
    "updated_at": "2016-05-11T01:22:12Z",
    "body": "The problem here is that we use a constant `Rib` for associated constants but that is there only to prevent `const` items inside `fn`s from getting weird errors about accesses to variables which look like they are in scope.\nWe should just use the same thing for methods and associated consts. Probably not a big diff.\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/218338048/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
