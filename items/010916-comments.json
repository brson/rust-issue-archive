[
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/30299906",
    "html_url": "https://github.com/rust-lang/rust/pull/10916#issuecomment-30299906",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10916",
    "id": 30299906,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMwMjk5OTA2",
    "user": {
      "login": "alexcrichton",
      "id": 64996,
      "node_id": "MDQ6VXNlcjY0OTk2",
      "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alexcrichton",
      "html_url": "https://github.com/alexcrichton",
      "followers_url": "https://api.github.com/users/alexcrichton/followers",
      "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}",
      "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions",
      "organizations_url": "https://api.github.com/users/alexcrichton/orgs",
      "repos_url": "https://api.github.com/users/alexcrichton/repos",
      "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alexcrichton/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2013-12-11T07:30:39Z",
    "updated_at": "2013-12-11T07:30:39Z",
    "body": "I think there's a few things that should be reviewed about this:\n- whether the code is good (as usual)\n- whether this should be a crate attribute or a compile-time flag (I don't think this should be allowed as a crate attribute on rlib or dylib outputs)\n- whether this should actually close the issue in question\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/30299906/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/30301095",
    "html_url": "https://github.com/rust-lang/rust/pull/10916#issuecomment-30301095",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10916",
    "id": 30301095,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMwMzAxMDk1",
    "user": {
      "login": "huonw",
      "id": 1203825,
      "node_id": "MDQ6VXNlcjEyMDM4MjU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1203825?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/huonw",
      "html_url": "https://github.com/huonw",
      "followers_url": "https://api.github.com/users/huonw/followers",
      "following_url": "https://api.github.com/users/huonw/following{/other_user}",
      "gists_url": "https://api.github.com/users/huonw/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/huonw/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/huonw/subscriptions",
      "organizations_url": "https://api.github.com/users/huonw/orgs",
      "repos_url": "https://api.github.com/users/huonw/repos",
      "events_url": "https://api.github.com/users/huonw/events{/privacy}",
      "received_events_url": "https://api.github.com/users/huonw/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2013-12-11T08:01:00Z",
    "updated_at": "2013-12-11T08:01:00Z",
    "body": "How will this interact with `--test` (especially as a crate attribute, since there is no way to conditionally add/remove individual attributes from items (and, in fact, no way at all for crate attributes))?\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/30301095/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/30318896",
    "html_url": "https://github.com/rust-lang/rust/pull/10916#issuecomment-30318896",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10916",
    "id": 30318896,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMwMzE4ODk2",
    "user": {
      "login": "thestinger",
      "id": 1505226,
      "node_id": "MDQ6VXNlcjE1MDUyMjY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1505226?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/thestinger",
      "html_url": "https://github.com/thestinger",
      "followers_url": "https://api.github.com/users/thestinger/followers",
      "following_url": "https://api.github.com/users/thestinger/following{/other_user}",
      "gists_url": "https://api.github.com/users/thestinger/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/thestinger/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/thestinger/subscriptions",
      "organizations_url": "https://api.github.com/users/thestinger/orgs",
      "repos_url": "https://api.github.com/users/thestinger/repos",
      "events_url": "https://api.github.com/users/thestinger/events{/privacy}",
      "received_events_url": "https://api.github.com/users/thestinger/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2013-12-11T13:11:09Z",
    "updated_at": "2013-12-11T13:19:04Z",
    "body": "@alexcrichton: I'm not quite sure it should close it, because it would be nice to be able to omit them without optimizations enabled or without link-time optimization. This should also probably not work if unwinding is used because it's going to be undefined behaviour. One way to do that would be having an `abort` language item in addition to `fail`, and enforcing that only one or the other it undefined. It's still up to the user to get it right, but it will prevent problems with the default standard library configuration.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/30318896/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/30338177",
    "html_url": "https://github.com/rust-lang/rust/pull/10916#issuecomment-30338177",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10916",
    "id": 30338177,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMwMzM4MTc3",
    "user": {
      "login": "alexcrichton",
      "id": 64996,
      "node_id": "MDQ6VXNlcjY0OTk2",
      "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alexcrichton",
      "html_url": "https://github.com/alexcrichton",
      "followers_url": "https://api.github.com/users/alexcrichton/followers",
      "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}",
      "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions",
      "organizations_url": "https://api.github.com/users/alexcrichton/orgs",
      "repos_url": "https://api.github.com/users/alexcrichton/repos",
      "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alexcrichton/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2013-12-11T16:51:20Z",
    "updated_at": "2013-12-11T16:51:20Z",
    "body": "I don't think that we should encourage distribution of libraries with `-Z no-landing-pads` because most rust programs cannot safely link to them. I am very much in favor of this solution because the landing-pad-presence is a choice of the final-downstream user. It's a little unfortunate that this can only be done at LTO time, but that's also the only time at which we can alter upstream code.\n\nI agree that the only way to truly safely do this is to statically ensure that `fail!` does not unwind and rather aborts. Right now we have no compile-time checking that the failure function triggers an abort rather than failing. I am a firm believer in that crates should be compiled once, so I should never have to make a decision of calling `fail!()` vs `abort!()`.\n\nThe best way that I can think of doing something like this:\n- If landing pads are generated, then the _compiler_ will link dylibs/binaries to `librustunwind` which defines two symbols: `rust_try` and `rust_begin_unwind`. The _compiler_ will also manually specify `-lstdc++` on the link line. Note that this is different than what happens today in that `libstd` currently specifies the `libstdc++` dependency via `std::rtdeps`. Additionally, `librustunwind` is currently an object file inside `librustrt`\n- If landing pads are _not_ generated, then the compiler will instead link to `librustnounwind`. This library would also define two symbols: `rust_try` and `rust_begin_unwind` but the difference would be that `rust_begin_unwind` just aborts and `rust_try` just calls the function. The compiler would then have no need to link against libstdc++\n\nIf we did something like this, then we would have a static guarantee that code compiled with `-Z no-landing-pads` would not unwind through the `fail!()` macro (because no support for it was ever linked in). Additionally, this means that even libstd doesn't have to get recompiled with and without unwinding.\n\nAs another consequence of possibly going down this route, if we start making `no-landing-pads` a first-class option, I would want to make it a crate attribute and have it be a compiler error if an `rlib` or `dylib` is being generated. We could explore a method of allowing `no-landing-pads` for `dylib` outputs, but this has the same problems of mixing static/dynamic linking in that all upstream dependencies must be tracked.\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/30338177/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/30339944",
    "html_url": "https://github.com/rust-lang/rust/pull/10916#issuecomment-30339944",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10916",
    "id": 30339944,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMwMzM5OTQ0",
    "user": {
      "login": "pcwalton",
      "id": 157897,
      "node_id": "MDQ6VXNlcjE1Nzg5Nw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/157897?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/pcwalton",
      "html_url": "https://github.com/pcwalton",
      "followers_url": "https://api.github.com/users/pcwalton/followers",
      "following_url": "https://api.github.com/users/pcwalton/following{/other_user}",
      "gists_url": "https://api.github.com/users/pcwalton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/pcwalton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/pcwalton/subscriptions",
      "organizations_url": "https://api.github.com/users/pcwalton/orgs",
      "repos_url": "https://api.github.com/users/pcwalton/repos",
      "events_url": "https://api.github.com/users/pcwalton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/pcwalton/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2013-12-11T17:08:50Z",
    "updated_at": "2013-12-11T17:08:50Z",
    "body": "I like this approach because it handles the kernel case quite nicely (as kernels definitely want LTO and probably don't want unwinding). Although if your kernel supports loadable kernel modules then, well, we'll have to come up with something.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/30339944/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/30340866",
    "html_url": "https://github.com/rust-lang/rust/pull/10916#issuecomment-30340866",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10916",
    "id": 30340866,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMwMzQwODY2",
    "user": {
      "login": "alexcrichton",
      "id": 64996,
      "node_id": "MDQ6VXNlcjY0OTk2",
      "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alexcrichton",
      "html_url": "https://github.com/alexcrichton",
      "followers_url": "https://api.github.com/users/alexcrichton/followers",
      "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}",
      "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions",
      "organizations_url": "https://api.github.com/users/alexcrichton/orgs",
      "repos_url": "https://api.github.com/users/alexcrichton/repos",
      "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alexcrichton/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2013-12-11T17:18:50Z",
    "updated_at": "2013-12-11T17:18:50Z",
    "body": "(I force pushed to remove the 'Closes' part of the commit message)\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/30340866/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
