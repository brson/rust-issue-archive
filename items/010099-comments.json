[
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/27175444",
    "html_url": "https://github.com/rust-lang/rust/pull/10099#issuecomment-27175444",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10099",
    "id": 27175444,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3MTc1NDQ0",
    "user": {
      "login": "alexcrichton",
      "id": 64996,
      "node_id": "MDQ6VXNlcjY0OTk2",
      "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alexcrichton",
      "html_url": "https://github.com/alexcrichton",
      "followers_url": "https://api.github.com/users/alexcrichton/followers",
      "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}",
      "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions",
      "organizations_url": "https://api.github.com/users/alexcrichton/orgs",
      "repos_url": "https://api.github.com/users/alexcrichton/repos",
      "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alexcrichton/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2013-10-27T18:19:18Z",
    "updated_at": "2013-10-27T18:19:18Z",
    "body": "So if I understand this correctly, using the ziggurat tables leads to the wrong distribution, but this slower implementation of calculating the distribution is more correct, but less fast. The idea though is to in the future use the ziggurat tables for speed, but you're investigating what's going wrong with the distribution that we're seeing.\n\nIf that's the case, I may be more inclined to hold off ignoring ziggurat for a bit. It seems kinda odd to keep around all those tables when they're possibly incorrect and nothing is using them. If the bug with the tables can't be found soon, I'd be more in favor of removing them entirely and then bringing them back when the bugs have been found.\n\nIt would also be nice to have unit tests for this kind of thing, but I suppose that it's difficult to test for seeing how you're taking a billion samples. Also, do you know what's up with that bump in the black line compared to the red line? Is that also something that we should be worried about? I found it odd that it was also a part of the previous graph (using the ziggurat tables)...\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/27175444/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/27180650",
    "html_url": "https://github.com/rust-lang/rust/pull/10099#issuecomment-27180650",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10099",
    "id": 27180650,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3MTgwNjUw",
    "user": {
      "login": "huonw",
      "id": 1203825,
      "node_id": "MDQ6VXNlcjEyMDM4MjU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1203825?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/huonw",
      "html_url": "https://github.com/huonw",
      "followers_url": "https://api.github.com/users/huonw/followers",
      "following_url": "https://api.github.com/users/huonw/following{/other_user}",
      "gists_url": "https://api.github.com/users/huonw/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/huonw/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/huonw/subscriptions",
      "organizations_url": "https://api.github.com/users/huonw/orgs",
      "repos_url": "https://api.github.com/users/huonw/repos",
      "events_url": "https://api.github.com/users/huonw/events{/privacy}",
      "received_events_url": "https://api.github.com/users/huonw/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2013-10-27T22:05:12Z",
    "updated_at": "2013-10-27T22:05:12Z",
    "body": "> The idea though is to in the future use the ziggurat tables for speed, but you're investigating what's going wrong with the distribution that we're seeing.\n\nYour understanding is correct. FWIW, I checked the Normal (also using Ziggurat) and plain `f64` generators in a little more detail, and neither of these display a bias, so it does appears to be specific to the Exp tables. In theory I'll have a solid few hours I can devote to Rust on Wednesday, which will likely be fixing this properly, so feel free to r-, I can always reopen this if I cannot fix it. (The reason for this is just to make sure the implementation is correct, but if we're not too concerned about temporarily being incorrect that's ok.)\n\n> It seems kinda odd to keep around all those tables when they're possibly incorrect and nothing is using them\n\nThere's only 6 kB of tables (3 of them with 257 `f64`s each) in an auto-generated non-`pub` module, so having them hanging around (for now) isn't a huge burden on either code maintenance, public API or binary size.\n\n> Also, do you know what's up with that bump in the black line compared to the red line? Is that also something that we should be worried about?\n\nAppears to just be an artefact of the randomness, running a few more samples all look generally similar to:\n\n![cdf-exp-density](https://f.cloud.github.com/assets/1203825/1416408/e2a21598-3f4e-11e3-9b7e-e45e3f0d6b51.png)\n\n> It would also be nice to have unit tests for this kind of thing, but I suppose that it's difficult to test for seeing how you're taking a billion samples\n\nIt's not just the huge number of samples, since one can just run the tests with a smaller sample size: these are inherently random, so every reasonable test would have a non-zero chance of failure. Of course, if one is doing significance-level tests, one can choose the p-value such that the chance of failure is very small (when the implementation is correct), however this is at the cost of having less power to detect an incorrect implementation. Compensating for this by increasing the sample size makes the tests very slow.\n\nI'm planning to add [Gamma](https://en.wikipedia.org/wiki/Gamma_distribution) (I have an implementation that is essentially blocked on this) and derived distributions next, and to land that I'll write either a pile of probabilistic tests in a separate repo (on Rust CI, so that failures don't block other PRs) or as a run-by-hand file in `src/test/run-pass`.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/27180650/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/27252052",
    "html_url": "https://github.com/rust-lang/rust/pull/10099#issuecomment-27252052",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10099",
    "id": 27252052,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3MjUyMDUy",
    "user": {
      "login": "alexcrichton",
      "id": 64996,
      "node_id": "MDQ6VXNlcjY0OTk2",
      "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alexcrichton",
      "html_url": "https://github.com/alexcrichton",
      "followers_url": "https://api.github.com/users/alexcrichton/followers",
      "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}",
      "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions",
      "organizations_url": "https://api.github.com/users/alexcrichton/orgs",
      "repos_url": "https://api.github.com/users/alexcrichton/repos",
      "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alexcrichton/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2013-10-28T20:20:33Z",
    "updated_at": "2013-10-28T20:20:33Z",
    "body": "Just wanted to say, excellent analysis of this problem! In the meantime though, let's leave this open for awhile and see if you managed to uncover the underlying problem (no rush at all of course). If it does take longer than expected, we can probably merge this.\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/27252052/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/27453269",
    "html_url": "https://github.com/rust-lang/rust/pull/10099#issuecomment-27453269",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10099",
    "id": 27453269,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3NDUzMjY5",
    "user": {
      "login": "huonw",
      "id": 1203825,
      "node_id": "MDQ6VXNlcjEyMDM4MjU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1203825?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/huonw",
      "html_url": "https://github.com/huonw",
      "followers_url": "https://api.github.com/users/huonw/followers",
      "following_url": "https://api.github.com/users/huonw/following{/other_user}",
      "gists_url": "https://api.github.com/users/huonw/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/huonw/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/huonw/subscriptions",
      "organizations_url": "https://api.github.com/users/huonw/orgs",
      "repos_url": "https://api.github.com/users/huonw/repos",
      "events_url": "https://api.github.com/users/huonw/events{/privacy}",
      "received_events_url": "https://api.github.com/users/huonw/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2013-10-31T00:52:10Z",
    "updated_at": "2013-10-31T00:52:10Z",
    "body": "I think I've tracked the actual bug in the Ziggurat implementation, will submit a PR doing that correction when I've checked it properly.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/27453269/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
