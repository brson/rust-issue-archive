[
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/70702937",
    "html_url": "https://github.com/rust-lang/rust/issues/21198#issuecomment-70702937",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/21198",
    "id": 70702937,
    "node_id": "MDEyOklzc3VlQ29tbWVudDcwNzAyOTM3",
    "user": {
      "login": "pnkfelix",
      "id": 173127,
      "node_id": "MDQ6VXNlcjE3MzEyNw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/173127?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/pnkfelix",
      "html_url": "https://github.com/pnkfelix",
      "followers_url": "https://api.github.com/users/pnkfelix/followers",
      "following_url": "https://api.github.com/users/pnkfelix/following{/other_user}",
      "gists_url": "https://api.github.com/users/pnkfelix/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/pnkfelix/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/pnkfelix/subscriptions",
      "organizations_url": "https://api.github.com/users/pnkfelix/orgs",
      "repos_url": "https://api.github.com/users/pnkfelix/repos",
      "events_url": "https://api.github.com/users/pnkfelix/events{/privacy}",
      "received_events_url": "https://api.github.com/users/pnkfelix/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-01-20T18:13:14Z",
    "updated_at": "2015-01-20T18:13:25Z",
    "body": "It is now a little more questionable whether the variance changes suggested would suffice.  At least, I tried a local hack of making `Vec<T>`/`Box<T>`/`Rc<T>` all covariant in `T`, as @nikomatsakis told me that might fix my problem.\n\nHowever, I still cannot bootstrap in that case.\n\nHere is a gist of a semi-reduced case that I made from my attempt to compile `librustc_driver` (so we can get fairly far along in the bootstrapping), along with the transcript of build errors when attempting to bootstrap atop https://github.com/pnkfelix/rust/tree/new-dtor-semantics-5-chkpt : \n\n  https://gist.github.com/pnkfelix/7b9f0dde7acd8b4f84fe\n\n(I am going to try to further reduce the test case so that it stands entirely alone; the one in the gist is still pulling in the `syntax` and `rustc` crates.)\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/70702937/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/70716842",
    "html_url": "https://github.com/rust-lang/rust/issues/21198#issuecomment-70716842",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/21198",
    "id": 70716842,
    "node_id": "MDEyOklzc3VlQ29tbWVudDcwNzE2ODQy",
    "user": {
      "login": "pnkfelix",
      "id": 173127,
      "node_id": "MDQ6VXNlcjE3MzEyNw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/173127?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/pnkfelix",
      "html_url": "https://github.com/pnkfelix",
      "followers_url": "https://api.github.com/users/pnkfelix/followers",
      "following_url": "https://api.github.com/users/pnkfelix/following{/other_user}",
      "gists_url": "https://api.github.com/users/pnkfelix/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/pnkfelix/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/pnkfelix/subscriptions",
      "organizations_url": "https://api.github.com/users/pnkfelix/orgs",
      "repos_url": "https://api.github.com/users/pnkfelix/repos",
      "events_url": "https://api.github.com/users/pnkfelix/events{/privacy}",
      "received_events_url": "https://api.github.com/users/pnkfelix/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-01-20T19:32:50Z",
    "updated_at": "2015-01-20T19:32:50Z",
    "body": "(discussed the previous comment with @nikomatsakis ; he pointed out that our use of `TypedArena<T>` is probably the culprit, as it is invariant with respect to `T`, and needs to be under its current API, we think. Then we brainstormed and he came up with a solution: wrap the `TypedArena` in a trait that provides an impoverished API that _is_ covariant with respect to `T`.)\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/70716842/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/72216009",
    "html_url": "https://github.com/rust-lang/rust/issues/21198#issuecomment-72216009",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/21198",
    "id": 72216009,
    "node_id": "MDEyOklzc3VlQ29tbWVudDcyMjE2MDA5",
    "user": {
      "login": "pnkfelix",
      "id": 173127,
      "node_id": "MDQ6VXNlcjE3MzEyNw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/173127?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/pnkfelix",
      "html_url": "https://github.com/pnkfelix",
      "followers_url": "https://api.github.com/users/pnkfelix/followers",
      "following_url": "https://api.github.com/users/pnkfelix/following{/other_user}",
      "gists_url": "https://api.github.com/users/pnkfelix/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/pnkfelix/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/pnkfelix/subscriptions",
      "organizations_url": "https://api.github.com/users/pnkfelix/orgs",
      "repos_url": "https://api.github.com/users/pnkfelix/repos",
      "events_url": "https://api.github.com/users/pnkfelix/events{/privacy}",
      "received_events_url": "https://api.github.com/users/pnkfelix/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-01-30T15:15:52Z",
    "updated_at": "2015-01-30T15:15:52Z",
    "body": "(followup to the previous comment: We were mistaken, there is no wrapper trait for `TypedArena` that is both covariant with respect to `T` while also providing the functionality needed.  I believe such a trait is not expressible in Rust today, but I have discussed some ideas with @nikomatsakis for future extensions to the language that could allow such a trait to be encoded.)\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/72216009/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/192383030",
    "html_url": "https://github.com/rust-lang/rust/issues/21198#issuecomment-192383030",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/21198",
    "id": 192383030,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE5MjM4MzAzMA==",
    "user": {
      "login": "steveklabnik",
      "id": 27786,
      "node_id": "MDQ6VXNlcjI3Nzg2",
      "avatar_url": "https://avatars.githubusercontent.com/u/27786?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/steveklabnik",
      "html_url": "https://github.com/steveklabnik",
      "followers_url": "https://api.github.com/users/steveklabnik/followers",
      "following_url": "https://api.github.com/users/steveklabnik/following{/other_user}",
      "gists_url": "https://api.github.com/users/steveklabnik/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/steveklabnik/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/steveklabnik/subscriptions",
      "organizations_url": "https://api.github.com/users/steveklabnik/orgs",
      "repos_url": "https://api.github.com/users/steveklabnik/repos",
      "events_url": "https://api.github.com/users/steveklabnik/events{/privacy}",
      "received_events_url": "https://api.github.com/users/steveklabnik/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2016-03-04T18:00:17Z",
    "updated_at": "2016-03-04T18:00:17Z",
    "body": "Triage: too in the weeds for me.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/192383030/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/298267109",
    "html_url": "https://github.com/rust-lang/rust/issues/21198#issuecomment-298267109",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/21198",
    "id": 298267109,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI5ODI2NzEwOQ==",
    "user": {
      "login": "Mark-Simulacrum",
      "id": 5047365,
      "node_id": "MDQ6VXNlcjUwNDczNjU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5047365?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Mark-Simulacrum",
      "html_url": "https://github.com/Mark-Simulacrum",
      "followers_url": "https://api.github.com/users/Mark-Simulacrum/followers",
      "following_url": "https://api.github.com/users/Mark-Simulacrum/following{/other_user}",
      "gists_url": "https://api.github.com/users/Mark-Simulacrum/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Mark-Simulacrum/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Mark-Simulacrum/subscriptions",
      "organizations_url": "https://api.github.com/users/Mark-Simulacrum/orgs",
      "repos_url": "https://api.github.com/users/Mark-Simulacrum/repos",
      "events_url": "https://api.github.com/users/Mark-Simulacrum/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Mark-Simulacrum/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2017-05-01T00:24:10Z",
    "updated_at": "2017-05-01T00:24:10Z",
    "body": "This is also going over my head. The example in the original issue does compile successfully today, but I can't get an old enough nightly to install with rustup to verify if it did back in 2015. Can anyone comment on this to say if it's still relevant?",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/298267109/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/298677840",
    "html_url": "https://github.com/rust-lang/rust/issues/21198#issuecomment-298677840",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/21198",
    "id": 298677840,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI5ODY3Nzg0MA==",
    "user": {
      "login": "pnkfelix",
      "id": 173127,
      "node_id": "MDQ6VXNlcjE3MzEyNw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/173127?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/pnkfelix",
      "html_url": "https://github.com/pnkfelix",
      "followers_url": "https://api.github.com/users/pnkfelix/followers",
      "following_url": "https://api.github.com/users/pnkfelix/following{/other_user}",
      "gists_url": "https://api.github.com/users/pnkfelix/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/pnkfelix/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/pnkfelix/subscriptions",
      "organizations_url": "https://api.github.com/users/pnkfelix/orgs",
      "repos_url": "https://api.github.com/users/pnkfelix/repos",
      "events_url": "https://api.github.com/users/pnkfelix/events{/privacy}",
      "received_events_url": "https://api.github.com/users/pnkfelix/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2017-05-02T15:55:07Z",
    "updated_at": "2017-05-02T15:55:07Z",
    "body": "So if I understand what I wrote (back two years ago), I think that this ticket was meant to track parts of the code that might be improved if we added variance of types (with respect to particular type parameters).\r\n\r\nWe at this point *do* have variance. (Which presumably would explain why the example in the description does compile.)\r\n\r\nSo if there was a big list of instances in the code base that could be improved based on the addition of variance, then I would say we should work our way down that list to clean things up. However, there is no such big list.\r\n\r\nTherefore, I'm just going to close this ticket. (As far as I can tell there are no references to #21198 in the source tree, and even if there were, the discussion already present here should suffice to provide context about what those references mean.)",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/298677840/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/348164767",
    "html_url": "https://github.com/rust-lang/rust/issues/21198#issuecomment-348164767",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/21198",
    "id": 348164767,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM0ODE2NDc2Nw==",
    "user": {
      "login": "pnkfelix",
      "id": 173127,
      "node_id": "MDQ6VXNlcjE3MzEyNw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/173127?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/pnkfelix",
      "html_url": "https://github.com/pnkfelix",
      "followers_url": "https://api.github.com/users/pnkfelix/followers",
      "following_url": "https://api.github.com/users/pnkfelix/following{/other_user}",
      "gists_url": "https://api.github.com/users/pnkfelix/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/pnkfelix/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/pnkfelix/subscriptions",
      "organizations_url": "https://api.github.com/users/pnkfelix/orgs",
      "repos_url": "https://api.github.com/users/pnkfelix/repos",
      "events_url": "https://api.github.com/users/pnkfelix/events{/privacy}",
      "received_events_url": "https://api.github.com/users/pnkfelix/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2017-11-30T11:42:19Z",
    "updated_at": "2017-11-30T15:35:18Z",
    "body": "Earlier I wrote: \r\n\r\n> ... there is no wrapper trait for `TypedArena` that is both covariant with respect to `T` while also providing the functionality needed.  I believe such a trait is not expressible in Rust today, but I have [...] ideas ...\r\n\r\nOn IRC [`Sharp` asked](https://botbot.me/mozilla/rust/2017-11-30/?msg=94093262&page=21) for more details on the problem and the ideas for a solution. Here is the summary as best I have been able to reconstruct in short order (transcribed from aforementioned IRC log):\r\n\r\n1. `TypedArena<T>` drops all of its contents when the TypedArena itself is dropped\r\n2. So if it were covariant, then `A <: `B would imply `TypedArena<A> <: TypedArena<B>`\r\n3. then you could instantiate A and B with types with lifetimes `'a` and `'b` where `'a` outlives `'b`, and pass the arena for holding A's into a context expecting an arena of B's\r\n4. then start throwing in objects whose Drop impls dereference data of lifetime `'b`\r\n5. but now they outlive that scope\r\n6. so the destructor executions on those instances of B are now unsound\r\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/348164767/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
