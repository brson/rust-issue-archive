{
  "url": "https://api.github.com/repos/rust-lang/rust/issues/27474",
  "repository_url": "https://api.github.com/repos/rust-lang/rust",
  "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/27474/labels{/name}",
  "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/27474/comments",
  "events_url": "https://api.github.com/repos/rust-lang/rust/issues/27474/events",
  "html_url": "https://github.com/rust-lang/rust/pull/27474",
  "id": 98627190,
  "node_id": "MDExOlB1bGxSZXF1ZXN0NDE0MjIzNzc=",
  "number": 27474,
  "title": "Implement the complete reverse case for the two way algorithm",
  "user": {
    "login": "bluss",
    "id": 3209739,
    "node_id": "MDQ6VXNlcjMyMDk3Mzk=",
    "avatar_url": "https://avatars.githubusercontent.com/u/3209739?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/bluss",
    "html_url": "https://github.com/bluss",
    "followers_url": "https://api.github.com/users/bluss/followers",
    "following_url": "https://api.github.com/users/bluss/following{/other_user}",
    "gists_url": "https://api.github.com/users/bluss/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/bluss/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/bluss/subscriptions",
    "organizations_url": "https://api.github.com/users/bluss/orgs",
    "repos_url": "https://api.github.com/users/bluss/repos",
    "events_url": "https://api.github.com/users/bluss/events{/privacy}",
    "received_events_url": "https://api.github.com/users/bluss/received_events",
    "type": "User",
    "user_view_type": "public",
    "site_admin": false
  },
  "labels": [
    {
      "id": 223796632,
      "node_id": "MDU6TGFiZWwyMjM3OTY2MzI=",
      "url": "https://api.github.com/repos/rust-lang/rust/labels/relnotes",
      "name": "relnotes",
      "color": "fad8c7",
      "default": false,
      "description": "Marks issues that should be documented in the release notes of the next release."
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": {
    "login": "huonw",
    "id": 1203825,
    "node_id": "MDQ6VXNlcjEyMDM4MjU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1203825?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/huonw",
    "html_url": "https://github.com/huonw",
    "followers_url": "https://api.github.com/users/huonw/followers",
    "following_url": "https://api.github.com/users/huonw/following{/other_user}",
    "gists_url": "https://api.github.com/users/huonw/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/huonw/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/huonw/subscriptions",
    "organizations_url": "https://api.github.com/users/huonw/orgs",
    "repos_url": "https://api.github.com/users/huonw/repos",
    "events_url": "https://api.github.com/users/huonw/events{/privacy}",
    "received_events_url": "https://api.github.com/users/huonw/received_events",
    "type": "User",
    "user_view_type": "public",
    "site_admin": false
  },
  "assignees": [
    {
      "login": "huonw",
      "id": 1203825,
      "node_id": "MDQ6VXNlcjEyMDM4MjU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1203825?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/huonw",
      "html_url": "https://github.com/huonw",
      "followers_url": "https://api.github.com/users/huonw/followers",
      "following_url": "https://api.github.com/users/huonw/following{/other_user}",
      "gists_url": "https://api.github.com/users/huonw/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/huonw/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/huonw/subscriptions",
      "organizations_url": "https://api.github.com/users/huonw/orgs",
      "repos_url": "https://api.github.com/users/huonw/repos",
      "events_url": "https://api.github.com/users/huonw/events{/privacy}",
      "received_events_url": "https://api.github.com/users/huonw/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    }
  ],
  "milestone": null,
  "comments": 20,
  "created_at": "2015-08-02T18:45:56Z",
  "updated_at": "2015-08-18T10:15:16Z",
  "closed_at": "2015-08-18T04:23:29Z",
  "author_association": "CONTRIBUTOR",
  "type": null,
  "active_lock_reason": null,
  "draft": false,
  "pull_request": {
    "url": "https://api.github.com/repos/rust-lang/rust/pulls/27474",
    "html_url": "https://github.com/rust-lang/rust/pull/27474",
    "diff_url": "https://github.com/rust-lang/rust/pull/27474.diff",
    "patch_url": "https://github.com/rust-lang/rust/pull/27474.patch",
    "merged_at": "2015-08-18T04:23:29Z"
  },
  "body": "StrSearcher: Implement the complete reverse case for the two way algorithm\n\nFix quadratic behavior in StrSearcher in reverse search with periodic\nneedles.\n\nThis commit adds the missing pieces for the \"short period\" case in\nreverse search. The short case will show up when the needle is literally\nperiodic, for example \"abababab\".\n\nTwo way uses a \"critical factorization\" of the needle: x = u v.\n\nSearching matches v first, if mismatch at character k, skip k forward.\nMatching u, if mismatch, skip period(x) forward.\n\nTo avoid O(mn) behavior after mismatch in u, memorize the already\nmatched prefix.\n\nThe short period case requires that |u| < period(x).\n\nFor the reverse search we need to compute a different critical\nfactorization x = u' v' where |v'| < period(x), because we are searching\nfor the reversed needle. A short v' also benefits the algorithm in\ngeneral.\n\nThe reverse critical factorization is computed quickly by using the same\nmaximal suffix algorithm, but terminating as soon as we have a location\nwith local period equal to period(x).\n\nThis adds extra fields crit_pos_back and memory_back for the reverse\ncase. The new overhead for TwoWaySearcher::new is low, and additionally\nI think the \"short period\" case is uncommon in many applications of\nstring search.\n\nThe maximal_suffix methods were updated in documentation and the\nalgorithms updated to not use !0 and wrapping add, variable left is now\n1 larger, offset 1 smaller.\n\nUse periodicity when computing byteset: in the periodic case, just\niterate over one period instead of the whole needle.\n\nExample before (rfind) after (twoway_rfind) benchmark shows the removal\nof quadratic behavior.\n\nneedle: \"ab\" \\* 100, haystack: (\"bb\" + \"ab\" \\* 100) \\* 100\n\n```\ntest periodic::rfind           ... bench:   1,926,595 ns/iter (+/- 11,390) = 10 MB/s\ntest periodic::twoway_rfind    ... bench:      51,740 ns/iter (+/- 66) = 386 MB/s\n```\n",
  "closed_by": {
    "login": "bors",
    "id": 3372342,
    "node_id": "MDQ6VXNlcjMzNzIzNDI=",
    "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/bors",
    "html_url": "https://github.com/bors",
    "followers_url": "https://api.github.com/users/bors/followers",
    "following_url": "https://api.github.com/users/bors/following{/other_user}",
    "gists_url": "https://api.github.com/users/bors/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/bors/subscriptions",
    "organizations_url": "https://api.github.com/users/bors/orgs",
    "repos_url": "https://api.github.com/users/bors/repos",
    "events_url": "https://api.github.com/users/bors/events{/privacy}",
    "received_events_url": "https://api.github.com/users/bors/received_events",
    "type": "User",
    "user_view_type": "public",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/27474/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/27474/timeline",
  "performed_via_github_app": null,
  "state_reason": null,
  "_meta": {
    "type": "pr"
  }
}
