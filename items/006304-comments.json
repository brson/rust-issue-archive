[
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/17556343",
    "html_url": "https://github.com/rust-lang/rust/issues/6304#issuecomment-17556343",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/6304",
    "id": 17556343,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE3NTU2MzQz",
    "user": {
      "login": "alexcrichton",
      "id": 64996,
      "node_id": "MDQ6VXNlcjY0OTk2",
      "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alexcrichton",
      "html_url": "https://github.com/alexcrichton",
      "followers_url": "https://api.github.com/users/alexcrichton/followers",
      "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}",
      "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions",
      "organizations_url": "https://api.github.com/users/alexcrichton/orgs",
      "repos_url": "https://api.github.com/users/alexcrichton/repos",
      "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alexcrichton/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2013-05-07T17:17:04Z",
    "updated_at": "2013-05-07T17:17:04Z",
    "body": "As I'm bringing one of my projects up to date, I'm getting this error a lot. Pretty much anything which uses macros and somehow uses some mutability inside causes this ICE.\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/17556343/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/17580706",
    "html_url": "https://github.com/rust-lang/rust/issues/6304#issuecomment-17580706",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/6304",
    "id": 17580706,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE3NTgwNzA2",
    "user": {
      "login": "nikomatsakis",
      "id": 155238,
      "node_id": "MDQ6VXNlcjE1NTIzOA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/155238?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nikomatsakis",
      "html_url": "https://github.com/nikomatsakis",
      "followers_url": "https://api.github.com/users/nikomatsakis/followers",
      "following_url": "https://api.github.com/users/nikomatsakis/following{/other_user}",
      "gists_url": "https://api.github.com/users/nikomatsakis/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nikomatsakis/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nikomatsakis/subscriptions",
      "organizations_url": "https://api.github.com/users/nikomatsakis/orgs",
      "repos_url": "https://api.github.com/users/nikomatsakis/repos",
      "events_url": "https://api.github.com/users/nikomatsakis/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nikomatsakis/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2013-05-08T01:03:32Z",
    "updated_at": "2013-05-08T01:03:32Z",
    "body": "I'll take a look.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/17580706/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/20417795",
    "html_url": "https://github.com/rust-lang/rust/issues/6304#issuecomment-20417795",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/6304",
    "id": 20417795,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIwNDE3Nzk1",
    "user": {
      "login": "emberian",
      "id": 704250,
      "node_id": "MDQ6VXNlcjcwNDI1MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/704250?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/emberian",
      "html_url": "https://github.com/emberian",
      "followers_url": "https://api.github.com/users/emberian/followers",
      "following_url": "https://api.github.com/users/emberian/following{/other_user}",
      "gists_url": "https://api.github.com/users/emberian/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/emberian/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/emberian/subscriptions",
      "organizations_url": "https://api.github.com/users/emberian/orgs",
      "repos_url": "https://api.github.com/users/emberian/repos",
      "events_url": "https://api.github.com/users/emberian/events{/privacy}",
      "received_events_url": "https://api.github.com/users/emberian/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2013-07-03T14:12:45Z",
    "updated_at": "2013-07-03T14:12:45Z",
    "body": "Backtrace\n\n```\n#0  upcall_fail (expr=0x7fffe48c5de0 \"assertion failed: region_maps.scopes_intersect(old_loan.kill_scope, new_loan.kill_scope)\", \n    file=0x7ffff6877450 <str67452> \"/home/cmr/hacking/rust/src/librustc/middle/borrowck/check_loans.rs\", line=181) at ../src/rt/rust_upcall.cpp:127\n#1  0x00007ffff78c1eac in sys::begin_unwind_::_89e154cd0915671::_07 () from /home/cmr/.local/bin/../lib/libstd-6c65cf4b443341b1-0.7.so\n#2  0x00007ffff78c1ad2 in sys::__extensions__::fail_with::anon::anon::expr_fn_21919 () from /home/cmr/.local/bin/../lib/libstd-6c65cf4b443341b1-0.7.so\n#3  0x00007ffff78c1a01 in str::as_buf_21914::_f8c6f4a6f9cb738::_07 () from /home/cmr/.local/bin/../lib/libstd-6c65cf4b443341b1-0.7.so\n#4  0x00007ffff78c1a8c in sys::__extensions__::fail_with::anon::expr_fn_21917 () from /home/cmr/.local/bin/../lib/libstd-6c65cf4b443341b1-0.7.so\n#5  0x00007ffff78c1a01 in str::as_buf_21914::_f8c6f4a6f9cb738::_07 () from /home/cmr/.local/bin/../lib/libstd-6c65cf4b443341b1-0.7.so\n#6  0x00007ffff782bf1b in sys::__extensions__::meth_10068::fail_with::_d96679812a86c367::_07 ()\n   from /home/cmr/.local/bin/../lib/libstd-6c65cf4b443341b1-0.7.so\n#7  0x00007ffff6610e8c in middle::borrowck::check_loans::__extensions__::meth_67539::report_error_if_loans_conflict::_7a7bbb95dbe43ed::_07 ()\n   from /home/cmr/.local/bin/../lib/librustc-d3cb8c2ccd84a7a7-0.7.so\n#8  0x00007ffff661087a in middle::borrowck::check_loans::__extensions__::check_for_conflicting_loans::anon::expr_fn_67532 ()\n   from /home/cmr/.local/bin/../lib/librustc-d3cb8c2ccd84a7a7-0.7.so\n#9  0x00007ffff660ef92 in middle::borrowck::check_loans::__extensions__::meth_67420::each_issued_loan::_a8f64f5878cbbed::_07 ()\n   from /home/cmr/.local/bin/../lib/librustc-d3cb8c2ccd84a7a7-0.7.so\n#10 0x00007ffff661022b in middle::borrowck::check_loans::__extensions__::meth_67513::check_for_conflicting_loans::_da3080ceacf4c36f::_07 ()\n   from /home/cmr/.local/bin/../lib/librustc-d3cb8c2ccd84a7a7-0.7.so\n#11 0x00007ffff660ba89 in middle::borrowck::check_loans::check_loans_in_expr::_c19a735d2f695f4::_07 ()\n---Type <return> to continue, or q <return> to quit---\n   from /home/cmr/.local/bin/../lib/librustc-d3cb8c2ccd84a7a7-0.7.so\n#12 0x00007ffff6239cea in visit::visit_expr_27456::_c1574f318f1f1a6::_07 () from /home/cmr/.local/bin/../lib/librustc-d3cb8c2ccd84a7a7-0.7.so\n#13 0x00007ffff660b7c9 in middle::borrowck::check_loans::check_loans_in_expr::_c19a735d2f695f4::_07 ()\n   from /home/cmr/.local/bin/../lib/librustc-d3cb8c2ccd84a7a7-0.7.so\n#14 0x00007ffff623a4d4 in visit::visit_exprs_27459::_b96d71a127b74940::_07 () from /home/cmr/.local/bin/../lib/librustc-d3cb8c2ccd84a7a7-0.7.so\n#15 0x00007ffff6238eb4 in visit::visit_expr_27456::_c1574f318f1f1a6::_07 () from /home/cmr/.local/bin/../lib/librustc-d3cb8c2ccd84a7a7-0.7.so\n#16 0x00007ffff660b7c9 in middle::borrowck::check_loans::check_loans_in_expr::_c19a735d2f695f4::_07 ()\n   from /home/cmr/.local/bin/../lib/librustc-d3cb8c2ccd84a7a7-0.7.so\n#17 0x00007ffff6239961 in visit::visit_expr_27456::_c1574f318f1f1a6::_07 () from /home/cmr/.local/bin/../lib/librustc-d3cb8c2ccd84a7a7-0.7.so\n#18 0x00007ffff660b7c9 in middle::borrowck::check_loans::check_loans_in_expr::_c19a735d2f695f4::_07 ()\n   from /home/cmr/.local/bin/../lib/librustc-d3cb8c2ccd84a7a7-0.7.so\n#19 0x00007ffff6234adb in visit::visit_expr_opt_27065::_719f6211725a297::_07 () from /home/cmr/.local/bin/../lib/librustc-d3cb8c2ccd84a7a7-0.7.so\n#20 0x00007ffff6233fb4 in visit::visit_block_26910::_2945d7bc2771dfd::_07 () from /home/cmr/.local/bin/../lib/librustc-d3cb8c2ccd84a7a7-0.7.so\n#21 0x00007ffff660df58 in middle::borrowck::check_loans::check_loans_in_block::_535c1a3589f6e3::_07 ()\n   from /home/cmr/.local/bin/../lib/librustc-d3cb8c2ccd84a7a7-0.7.so\n#22 0x00007ffff623954a in visit::visit_expr_27456::_c1574f318f1f1a6::_07 () from /home/cmr/.local/bin/../lib/librustc-d3cb8c2ccd84a7a7-0.7.so\n#23 0x00007ffff660b7c9 in middle::borrowck::check_loans::check_loans_in_expr::_c19a735d2f695f4::_07 ()\n   from /home/cmr/.local/bin/../lib/librustc-d3cb8c2ccd84a7a7-0.7.so\n---Type <return> to continue, or q <return> to quit---\n#24 0x00007ffff6234adb in visit::visit_expr_opt_27065::_719f6211725a297::_07 () from /home/cmr/.local/bin/../lib/librustc-d3cb8c2ccd84a7a7-0.7.so\n#25 0x00007ffff6233fb4 in visit::visit_block_26910::_2945d7bc2771dfd::_07 () from /home/cmr/.local/bin/../lib/librustc-d3cb8c2ccd84a7a7-0.7.so\n#26 0x00007ffff660df58 in middle::borrowck::check_loans::check_loans_in_block::_535c1a3589f6e3::_07 ()\n   from /home/cmr/.local/bin/../lib/librustc-d3cb8c2ccd84a7a7-0.7.so\n#27 0x00007ffff6240023 in visit::visit_arm_27993::_fe1ea04ccc534::_07 () from /home/cmr/.local/bin/../lib/librustc-d3cb8c2ccd84a7a7-0.7.so\n#28 0x00007ffff623fe6c in visit::default_visitor_27605::anon::expr_fn_27991 () from /home/cmr/.local/bin/../lib/librustc-d3cb8c2ccd84a7a7-0.7.so\n#29 0x00007ffff6239464 in visit::visit_expr_27456::_c1574f318f1f1a6::_07 () from /home/cmr/.local/bin/../lib/librustc-d3cb8c2ccd84a7a7-0.7.so\n#30 0x00007ffff660b7c9 in middle::borrowck::check_loans::check_loans_in_expr::_c19a735d2f695f4::_07 ()\n   from /home/cmr/.local/bin/../lib/librustc-d3cb8c2ccd84a7a7-0.7.so\n#31 0x00007ffff6234adb in visit::visit_expr_opt_27065::_719f6211725a297::_07 () from /home/cmr/.local/bin/../lib/librustc-d3cb8c2ccd84a7a7-0.7.so\n#32 0x00007ffff6233fb4 in visit::visit_block_26910::_2945d7bc2771dfd::_07 () from /home/cmr/.local/bin/../lib/librustc-d3cb8c2ccd84a7a7-0.7.so\n#33 0x00007ffff660df58 in middle::borrowck::check_loans::check_loans_in_block::_535c1a3589f6e3::_07 ()\n   from /home/cmr/.local/bin/../lib/librustc-d3cb8c2ccd84a7a7-0.7.so\n#34 0x00007ffff660035d in middle::borrowck::check_loans::check_loans::_78399e2f71ef86d::_07 ()\n   from /home/cmr/.local/bin/../lib/librustc-d3cb8c2ccd84a7a7-0.7.so\n#35 0x00007ffff665a0de in middle::borrowck::borrowck_fn::_b7106e69c6c155e3::_07 () from /home/cmr/.local/bin/../lib/librustc-d3cb8c2ccd84a7a7-0.7.so\n#36 0x00007ffff623f465 in visit::visit_method_helper_27933::_ccd15c8939a283f7::_07 () from /home/cmr/.local/bin/../lib/librustc-d3cb8c2ccd84a7a7-0.7.so\n#37 0x00007ffff623f164 in visit::visit_item_27804::_72d5616277254d51::_07 () from /home/cmr/.local/bin/../lib/librustc-d3cb8c2ccd84a7a7-0.7.so\n---Type <return> to continue, or q <return> to quit---\n#38 0x00007ffff623e11c in visit::default_visitor_27605::anon::expr_fn_27802 () from /home/cmr/.local/bin/../lib/librustc-d3cb8c2ccd84a7a7-0.7.so\n#39 0x00007ffff623d913 in visit::visit_mod_27738::_180342e1b369096::_07 () from /home/cmr/.local/bin/../lib/librustc-d3cb8c2ccd84a7a7-0.7.so\n#40 0x00007ffff623d748 in visit::default_visitor_27605::anon::expr_fn_27736 () from /home/cmr/.local/bin/../lib/librustc-d3cb8c2ccd84a7a7-0.7.so\n#41 0x00007ffff65f0f1a in visit::visit_crate_65814::_85b5b27c66c5cece::_07 () from /home/cmr/.local/bin/../lib/librustc-d3cb8c2ccd84a7a7-0.7.so\n#42 0x00007ffff6655025 in middle::borrowck::check_crate::_66a2ce23a87e3a87::_07 () from /home/cmr/.local/bin/../lib/librustc-d3cb8c2ccd84a7a7-0.7.so\n#43 0x00007ffff682f9c1 in driver::driver::compile_rest::anon::expr_fn_93289 () from /home/cmr/.local/bin/../lib/librustc-d3cb8c2ccd84a7a7-0.7.so\n#44 0x00007ffff682d083 in driver::driver::compile_rest::_e58f61c4387ba8b7::_07 () from /home/cmr/.local/bin/../lib/librustc-d3cb8c2ccd84a7a7-0.7.so\n#45 0x00007ffff6861854 in __morestack () from /home/cmr/.local/bin/../lib/librustc-d3cb8c2ccd84a7a7-0.7.so\n#46 0x00007ffff682ffbc in driver::driver::compile_upto::_af4a64d82884294::_07 () from /home/cmr/.local/bin/../lib/librustc-d3cb8c2ccd84a7a7-0.7.so\n#47 0x00007ffff6830355 in driver::driver::compile_input::_2d802f44a752fd9a::_07 () from /home/cmr/.local/bin/../lib/librustc-d3cb8c2ccd84a7a7-0.7.so\n#48 0x00007ffff684f793 in run_compiler::_7449a6c8ce585463::_07 () from /home/cmr/.local/bin/../lib/librustc-d3cb8c2ccd84a7a7-0.7.so\n#49 0x00007ffff686157e in main::anon::expr_fn_97271 () from /home/cmr/.local/bin/../lib/librustc-d3cb8c2ccd84a7a7-0.7.so\n#50 0x00007ffff685f027 in monitor::anon::expr_fn_97096 () from /home/cmr/.local/bin/../lib/librustc-d3cb8c2ccd84a7a7-0.7.so\n#51 0x00007ffff685693b in task::__extensions__::try_95957::anon::expr_fn_96395 () from /home/cmr/.local/bin/../lib/librustc-d3cb8c2ccd84a7a7-0.7.so\n#52 0x00007ffff6861854 in __morestack () from /home/cmr/.local/bin/../lib/librustc-d3cb8c2ccd84a7a7-0.7.so\n#53 0x00007ffff7894961 in task::spawn::spawn_raw_oldsched::make_child_wrapper::anon::expr_fn_18373 ()\n   from /home/cmr/.local/bin/../lib/libstd-6c65cf4b443341b1-0.7.so\n#54 0x00007ffff790ad7c in __morestack () from /home/cmr/.local/bin/../lib/libstd-6c65cf4b443341b1-0.7.so\n---Type <return> to continue, or q <return> to quit---\n#55 0x00007ffff5e54e43 in task_start_wrapper (a=0x7fffec20dcb0) at ../src/rt/rust_task.cpp:164\n#56 0x0000000000000000 in ?? ()\n```\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/20417795/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/20424989",
    "html_url": "https://github.com/rust-lang/rust/issues/6304#issuecomment-20424989",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/6304",
    "id": 20424989,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIwNDI0OTg5",
    "user": {
      "login": "nikomatsakis",
      "id": 155238,
      "node_id": "MDQ6VXNlcjE1NTIzOA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/155238?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nikomatsakis",
      "html_url": "https://github.com/nikomatsakis",
      "followers_url": "https://api.github.com/users/nikomatsakis/followers",
      "following_url": "https://api.github.com/users/nikomatsakis/following{/other_user}",
      "gists_url": "https://api.github.com/users/nikomatsakis/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nikomatsakis/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nikomatsakis/subscriptions",
      "organizations_url": "https://api.github.com/users/nikomatsakis/orgs",
      "repos_url": "https://api.github.com/users/nikomatsakis/repos",
      "events_url": "https://api.github.com/users/nikomatsakis/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nikomatsakis/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2013-07-03T15:52:15Z",
    "updated_at": "2013-07-03T15:52:15Z",
    "body": "Obviously I failed to take a look.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/20424989/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/21671136",
    "html_url": "https://github.com/rust-lang/rust/issues/6304#issuecomment-21671136",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/6304",
    "id": 21671136,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIxNjcxMTM2",
    "user": {
      "login": "DaGenix",
      "id": 2101211,
      "node_id": "MDQ6VXNlcjIxMDEyMTE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2101211?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/DaGenix",
      "html_url": "https://github.com/DaGenix",
      "followers_url": "https://api.github.com/users/DaGenix/followers",
      "following_url": "https://api.github.com/users/DaGenix/following{/other_user}",
      "gists_url": "https://api.github.com/users/DaGenix/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/DaGenix/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/DaGenix/subscriptions",
      "organizations_url": "https://api.github.com/users/DaGenix/orgs",
      "repos_url": "https://api.github.com/users/DaGenix/repos",
      "events_url": "https://api.github.com/users/DaGenix/events{/privacy}",
      "received_events_url": "https://api.github.com/users/DaGenix/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2013-07-27T19:30:05Z",
    "updated_at": "2013-07-27T19:32:31Z",
    "body": "I ran into this as well and didn't find this issue until I'd already come up with code to reproduce it. In case its helpful, here is the code I ended up with:\n\n``` rust\nfn test(x: &[u8]) {\n}\n\nmacro_rules! impl_buffer( ($name:ident, $size:expr) => (\n    impl $name {\n        fn run(&mut self, in: &[u8]) {\n            let mut i = 0;\n            while in.len() - i >= $size {\n                test(in.slice(i, i + $size));\n                i += $size;\n            }\n        }\n    }\n))\n\npub struct Buffer;\nimpl_buffer!(Buffer, 64)\n```\n\nAt least in my case, there is an easy workaround. The following works fine:\n\n``` rust\nfn test(x: &[u8]) {\n}\n\nmacro_rules! impl_buffer( ($name:ident, $size:expr) => (\n    impl $name {\n        fn run(&mut self, in: &[u8]) {\n            let size = $size;\n            let mut i = 0;\n            while in.len() - i >= size {\n                test(in.slice(i, i + size));\n                i += $size;\n            }\n        }\n    }\n))\n\npub struct Buffer;\nimpl_buffer!(Buffer, 64)\n```\n",
    "author_association": "NONE",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/21671136/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
