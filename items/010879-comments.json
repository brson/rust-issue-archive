[
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/30170543",
    "html_url": "https://github.com/rust-lang/rust/issues/10879#issuecomment-30170543",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10879",
    "id": 30170543,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMwMTcwNTQz",
    "user": {
      "login": "thestinger",
      "id": 1505226,
      "node_id": "MDQ6VXNlcjE1MDUyMjY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1505226?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/thestinger",
      "html_url": "https://github.com/thestinger",
      "followers_url": "https://api.github.com/users/thestinger/followers",
      "following_url": "https://api.github.com/users/thestinger/following{/other_user}",
      "gists_url": "https://api.github.com/users/thestinger/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/thestinger/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/thestinger/subscriptions",
      "organizations_url": "https://api.github.com/users/thestinger/orgs",
      "repos_url": "https://api.github.com/users/thestinger/repos",
      "events_url": "https://api.github.com/users/thestinger/events{/privacy}",
      "received_events_url": "https://api.github.com/users/thestinger/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2013-12-09T20:33:07Z",
    "updated_at": "2013-12-09T20:33:07Z",
    "body": "That `ReferenceCounted` marker is still too specific - it should at least to be `ReferenceCounted<T>`. Even then, it still forbids many correct non-cyclical data structures, and it's _more_ strict than the current `Freeze` bound in many cases. There's no way to make an `Rc` cycle if the inner type respects the mutability rules.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/30170543/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/30184829",
    "html_url": "https://github.com/rust-lang/rust/issues/10879#issuecomment-30184829",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10879",
    "id": 30184829,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMwMTg0ODI5",
    "user": {
      "login": "glaebhoerl",
      "id": 1216629,
      "node_id": "MDQ6VXNlcjEyMTY2Mjk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1216629?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/glaebhoerl",
      "html_url": "https://github.com/glaebhoerl",
      "followers_url": "https://api.github.com/users/glaebhoerl/followers",
      "following_url": "https://api.github.com/users/glaebhoerl/following{/other_user}",
      "gists_url": "https://api.github.com/users/glaebhoerl/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/glaebhoerl/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/glaebhoerl/subscriptions",
      "organizations_url": "https://api.github.com/users/glaebhoerl/orgs",
      "repos_url": "https://api.github.com/users/glaebhoerl/repos",
      "events_url": "https://api.github.com/users/glaebhoerl/events{/privacy}",
      "received_events_url": "https://api.github.com/users/glaebhoerl/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2013-12-09T23:21:14Z",
    "updated_at": "2013-12-09T23:26:37Z",
    "body": "> That `ReferenceCounted` marker is still too specific - it should at least be `ReferenceCounted<T>`.\n\nHmm. Would that still be sufficient to rule out cycles? I think it might be, but I'm having a hard time thinking straight enough to convince myself.\n\nIn that case it might be better to just straight-up make this a trait itself, instead of relying on magic attributes:\n\n```\ntrait NoRc<T>: DoesNotContain<ReferenceCounted<T>> { }\nimpl<X: DoesNotContain<ReferenceCounted<T>> NoRc<T> for X { }\n```\n\nI was shying away from this earlier because it seems potentially harder to implement, but I have no actual idea.\n\nAt this point the `NoRc` trait is only for brevity. Maybe if you do it this way, you don't need the separate marker type either, and could just write `DoesNotContain<Rc<T>>`... but maybe it would still be useful for preventing a mutual cycle between different reference counted types? (Is that possible?)\n\n> Even then, it still forbids many correct non-cyclical data structures, and it's more strict than the current Freeze bound in many cases. \n\nTrue, which is why I said the `Freeze` and unconstrained constructors would presumably also remain. I don't believe it's possible for a static analysis to precisely rule out all cyclical structures and only cyclical structures, you can't avoid having either false positives or false negatives. This would still be a strict improvement on the current `Send` constructor (I think).\n\nThe current built-in traits could potentially be reimplemented on top of this as well, so they would no longer have to be baked-in to the compiler, only `DoesNotContain` itself:\n\n```\nstruct Local;\nstruct Managed { marker: Local } // inheritance-ish!\nstruct Gc<T> { val: ..., marker: Managed }\ntrait NoManaged: DoesNotContain<Managed> { } // (+ impl)\ntrait Send: 'static + DoesNotContain<Local> { } // (+ impl)\nstruct ReferenceCounted<T> { marker: Local }\n\nstruct Mutable;\nstruct &mut 'a T { ..., marker: Mutable } // imaginary syntax, this would have to be wired-in (sadly)\nstruct Cell<T> { ..., marker: Mutable }\nstruct RefCell<T> { ..., marker: Mutable }\ntrait Freeze: DoesNotContain<Mutable> { } // (+ impl)\n```\n\nI don't know how feasible it would be to implement a general `DoesNotContain` of this form though.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/30184829/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/30209360",
    "html_url": "https://github.com/rust-lang/rust/issues/10879#issuecomment-30209360",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10879",
    "id": 30209360,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMwMjA5MzYw",
    "user": {
      "login": "pnkfelix",
      "id": 173127,
      "node_id": "MDQ6VXNlcjE3MzEyNw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/173127?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/pnkfelix",
      "html_url": "https://github.com/pnkfelix",
      "followers_url": "https://api.github.com/users/pnkfelix/followers",
      "following_url": "https://api.github.com/users/pnkfelix/following{/other_user}",
      "gists_url": "https://api.github.com/users/pnkfelix/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/pnkfelix/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/pnkfelix/subscriptions",
      "organizations_url": "https://api.github.com/users/pnkfelix/orgs",
      "repos_url": "https://api.github.com/users/pnkfelix/repos",
      "events_url": "https://api.github.com/users/pnkfelix/events{/privacy}",
      "received_events_url": "https://api.github.com/users/pnkfelix/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2013-12-10T09:08:47Z",
    "updated_at": "2013-12-10T09:08:47Z",
    "body": "cc me\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/30209360/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/30314568",
    "html_url": "https://github.com/rust-lang/rust/issues/10879#issuecomment-30314568",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10879",
    "id": 30314568,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMwMzE0NTY4",
    "user": {
      "login": "nikomatsakis",
      "id": 155238,
      "node_id": "MDQ6VXNlcjE1NTIzOA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/155238?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nikomatsakis",
      "html_url": "https://github.com/nikomatsakis",
      "followers_url": "https://api.github.com/users/nikomatsakis/followers",
      "following_url": "https://api.github.com/users/nikomatsakis/following{/other_user}",
      "gists_url": "https://api.github.com/users/nikomatsakis/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nikomatsakis/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nikomatsakis/subscriptions",
      "organizations_url": "https://api.github.com/users/nikomatsakis/orgs",
      "repos_url": "https://api.github.com/users/nikomatsakis/repos",
      "events_url": "https://api.github.com/users/nikomatsakis/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nikomatsakis/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2013-12-11T11:58:23Z",
    "updated_at": "2013-12-11T11:58:23Z",
    "body": "Until we have our story straight about trait matching (#5527), I'd be reluctant to add features, and this seems like it's ultimately really a feature request for \"negative\" traits. I think those are feasible to support at some point, though.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/30314568/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/30319877",
    "html_url": "https://github.com/rust-lang/rust/issues/10879#issuecomment-30319877",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10879",
    "id": 30319877,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMwMzE5ODc3",
    "user": {
      "login": "glaebhoerl",
      "id": 1216629,
      "node_id": "MDQ6VXNlcjEyMTY2Mjk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1216629?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/glaebhoerl",
      "html_url": "https://github.com/glaebhoerl",
      "followers_url": "https://api.github.com/users/glaebhoerl/followers",
      "following_url": "https://api.github.com/users/glaebhoerl/following{/other_user}",
      "gists_url": "https://api.github.com/users/glaebhoerl/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/glaebhoerl/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/glaebhoerl/subscriptions",
      "organizations_url": "https://api.github.com/users/glaebhoerl/orgs",
      "repos_url": "https://api.github.com/users/glaebhoerl/repos",
      "events_url": "https://api.github.com/users/glaebhoerl/events{/privacy}",
      "received_events_url": "https://api.github.com/users/glaebhoerl/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2013-12-11T13:28:10Z",
    "updated_at": "2013-12-11T13:28:10Z",
    "body": "I was thinking of this as more of a refactor-and-generalize, with added power falling out as a side benefit. If it doesn't make things \"nicer\" then it's probably not a good idea.\n\nI did think of negated traits as a potential _alternative_ way to achieve similar functionality, but:\n- I think that would be a _replacement_ for the marker type way of doing things (e.g. `trait Mutable { }; trait Freeze = !Mutable; impl<T> Mutable for Cell<T> { }`), whereas this idea builds on top of it, and\n- I think marker type + `DoesNotContain` just plain works better. With negated traits you would still need some kind of special magic for why, if something is `Mutable`/`!Freeze`, that would propagate to any other type which has it as a member, whereas with `DoesNotContain` this transitivity happens naturally and the rule is easy to express.\n\nI also don't think the two ideas have much in common: `DoesNotContain` is a negated trait only insofar as it negates `DoesContain`, which doesn't exist either (and which seems like it would be implemented similarly, only less useful).\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/30319877/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/37550545",
    "html_url": "https://github.com/rust-lang/rust/issues/10879#issuecomment-37550545",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10879",
    "id": 37550545,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM3NTUwNTQ1",
    "user": {
      "login": "glaebhoerl",
      "id": 1216629,
      "node_id": "MDQ6VXNlcjEyMTY2Mjk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1216629?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/glaebhoerl",
      "html_url": "https://github.com/glaebhoerl",
      "followers_url": "https://api.github.com/users/glaebhoerl/followers",
      "following_url": "https://api.github.com/users/glaebhoerl/following{/other_user}",
      "gists_url": "https://api.github.com/users/glaebhoerl/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/glaebhoerl/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/glaebhoerl/subscriptions",
      "organizations_url": "https://api.github.com/users/glaebhoerl/orgs",
      "repos_url": "https://api.github.com/users/glaebhoerl/repos",
      "events_url": "https://api.github.com/users/glaebhoerl/events{/privacy}",
      "received_events_url": "https://api.github.com/users/glaebhoerl/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-03-13T15:59:34Z",
    "updated_at": "2014-03-13T15:59:34Z",
    "body": "I no longer think this is relevant and a good idea.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/37550545/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
