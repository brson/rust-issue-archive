{
  "url": "https://api.github.com/repos/rust-lang/rust/issues/8123",
  "repository_url": "https://api.github.com/repos/rust-lang/rust",
  "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/8123/labels{/name}",
  "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/8123/comments",
  "events_url": "https://api.github.com/repos/rust-lang/rust/issues/8123/events",
  "html_url": "https://github.com/rust-lang/rust/pull/8123",
  "id": 17384809,
  "node_id": "MDExOlB1bGxSZXF1ZXN0NzI1NTk2Mg==",
  "number": 8123,
  "title": "Allow early release of rvalues in assignments",
  "user": {
    "login": "dotdash",
    "id": 230962,
    "node_id": "MDQ6VXNlcjIzMDk2Mg==",
    "avatar_url": "https://avatars.githubusercontent.com/u/230962?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/dotdash",
    "html_url": "https://github.com/dotdash",
    "followers_url": "https://api.github.com/users/dotdash/followers",
    "following_url": "https://api.github.com/users/dotdash/following{/other_user}",
    "gists_url": "https://api.github.com/users/dotdash/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/dotdash/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/dotdash/subscriptions",
    "organizations_url": "https://api.github.com/users/dotdash/orgs",
    "repos_url": "https://api.github.com/users/dotdash/repos",
    "events_url": "https://api.github.com/users/dotdash/events{/privacy}",
    "received_events_url": "https://api.github.com/users/dotdash/received_events",
    "type": "User",
    "user_view_type": "public",
    "site_admin": false
  },
  "labels": [],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [],
  "milestone": null,
  "comments": 6,
  "created_at": "2013-07-30T09:16:34Z",
  "updated_at": "2018-02-06T08:45:32Z",
  "closed_at": "2013-08-22T18:06:37Z",
  "author_association": "CONTRIBUTOR",
  "type": null,
  "active_lock_reason": null,
  "draft": false,
  "pull_request": {
    "url": "https://api.github.com/repos/rust-lang/rust/pulls/8123",
    "html_url": "https://github.com/rust-lang/rust/pull/8123",
    "diff_url": "https://github.com/rust-lang/rust/pull/8123.diff",
    "patch_url": "https://github.com/rust-lang/rust/pull/8123.patch",
    "merged_at": null
  },
  "body": "The rvalues in assignments might be temporaries (like function return\nvalues) that could be freed immediately after the assignment is done. But\ncurrently, they live to the end of the enclosing scope. For managed\nbox, this currently means that there is an extra ref count that keeps\nthe value alive. This leads to a huge memory usage peak in the\nexpansion phase of compilation with rustc, because all intermediate\nexpansion results are kept alive till the end of phase 2, instead of\nbeing freed immediately after their last \"usable\" ref is dropped.\n\nAs a stop-gap solution, we can add a scope around the assignment during\ntranslation, which means that the temporary value is dropped right away.\nIt's only a stop-gap solution because once we switch from refcounting to\ngarbage collection, it won't help anymore and the code should switch to\neither RC or ~ for Crate data, but for now this reduces the peak memory\nusage when compiling librustc by about 100MB on my x86_64 Linux box.\n",
  "closed_by": {
    "login": "catamorphism",
    "id": 427212,
    "node_id": "MDQ6VXNlcjQyNzIxMg==",
    "avatar_url": "https://avatars.githubusercontent.com/u/427212?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/catamorphism",
    "html_url": "https://github.com/catamorphism",
    "followers_url": "https://api.github.com/users/catamorphism/followers",
    "following_url": "https://api.github.com/users/catamorphism/following{/other_user}",
    "gists_url": "https://api.github.com/users/catamorphism/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/catamorphism/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/catamorphism/subscriptions",
    "organizations_url": "https://api.github.com/users/catamorphism/orgs",
    "repos_url": "https://api.github.com/users/catamorphism/repos",
    "events_url": "https://api.github.com/users/catamorphism/events{/privacy}",
    "received_events_url": "https://api.github.com/users/catamorphism/received_events",
    "type": "User",
    "user_view_type": "public",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/8123/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/8123/timeline",
  "performed_via_github_app": null,
  "state_reason": null,
  "_meta": {
    "type": "pr"
  }
}
