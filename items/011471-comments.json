[
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/32092038",
    "html_url": "https://github.com/rust-lang/rust/pull/11471#issuecomment-32092038",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/11471",
    "id": 32092038,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMyMDkyMDM4",
    "user": {
      "login": "alexcrichton",
      "id": 64996,
      "node_id": "MDQ6VXNlcjY0OTk2",
      "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alexcrichton",
      "html_url": "https://github.com/alexcrichton",
      "followers_url": "https://api.github.com/users/alexcrichton/followers",
      "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}",
      "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions",
      "organizations_url": "https://api.github.com/users/alexcrichton/orgs",
      "repos_url": "https://api.github.com/users/alexcrichton/repos",
      "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alexcrichton/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-01-11T09:59:39Z",
    "updated_at": "2014-01-11T09:59:39Z",
    "body": "nice work!\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/32092038/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/32106174",
    "html_url": "https://github.com/rust-lang/rust/pull/11471#issuecomment-32106174",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/11471",
    "id": 32106174,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMyMTA2MTc0",
    "user": {
      "login": "ktt3ja",
      "id": 1735399,
      "node_id": "MDQ6VXNlcjE3MzUzOTk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1735399?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ktt3ja",
      "html_url": "https://github.com/ktt3ja",
      "followers_url": "https://api.github.com/users/ktt3ja/followers",
      "following_url": "https://api.github.com/users/ktt3ja/following{/other_user}",
      "gists_url": "https://api.github.com/users/ktt3ja/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ktt3ja/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ktt3ja/subscriptions",
      "organizations_url": "https://api.github.com/users/ktt3ja/orgs",
      "repos_url": "https://api.github.com/users/ktt3ja/repos",
      "events_url": "https://api.github.com/users/ktt3ja/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ktt3ja/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-01-11T20:31:25Z",
    "updated_at": "2014-01-11T20:31:25Z",
    "body": "r? @alexcrichton \n\nHere's the diff of this commit from when you last reviewed it: http://ix.io/9Oy/diff\n\n``` diff\ndiff --git a/src/librustc/middle/dead.rs b/src/librustc/middle/dead.rs\nindex ba810e5..52595d5 100644\n--- a/src/librustc/middle/dead.rs\n+++ b/src/librustc/middle/dead.rs\n@@ -12,16 +12,16 @@\n // closely. The idea is that all reachable symbols are live, codes called\n // from live codes are live, and everything else is dead.\n\n+use middle::lint::{allow, contains_lint, DeadCode};\n+use middle::privacy;\n use middle::ty;\n use middle::typeck;\n-use middle::privacy;\n-use middle::lint::DeadCode;\n\n use std::hashmap::HashSet;\n use syntax::ast;\n use syntax::ast_map;\n use syntax::ast_util::{local_def, def_id_of_def, is_local};\n-use syntax::attr::AttrMetaMethods;\n+use syntax::attr;\n use syntax::codemap;\n use syntax::parse::token;\n use syntax::visit::Visitor;\n@@ -200,30 +200,22 @@ impl Visitor<()> for MarkSymbolVisitor {\n }\n\n fn has_allow_dead_code_or_lang_attr(attrs: &[ast::Attribute]) -> bool {\n-    for attr in attrs.iter() {\n-        if \"allow\" == attr.name() {\n-            if attr.meta_item_list().is_none() {\n-                continue\n-            }\n-            let list = attr.meta_item_list().unwrap();\n-            for meta_item in list.iter() {\n-                if dead_code_lint_str == meta_item.name() {\n-                    return true;\n-                }\n-            }\n-        } else if \"lang\" == attr.name() {\n-            return true;\n-        }\n-    }\n-    false\n+    contains_lint(attrs, allow, dead_code_lint_str)\n+    || attr::contains_name(attrs, \"lang\")\n }\n\n // This visitor seeds items that\n-//   1) we want to explicitly consider as live:\n+//   1) We want to explicitly consider as live:\n //     * Item annotated with #[allow(dead_code)]\n+//         - This is done so that if we want to suppress warnings for a\n+//           group of dead functions, we only have to annotate the \"root\".\n+//           For example, if both `f` and `g` are dead and `f` calls `g`,\n+//           then annotating `f` with `#[allow(dead_code)]` will suppress\n+//           warning for both `f` and `g`.\n //     * Item annotated with #[lang=\"..\"]\n+//         - This is because lang items are always callable from elsewhere.\n //   or\n-//   2) we are not sure to be live or not\n+//   2) We are not sure to be live or not\n //     * Implementation of a trait method\n struct LifeSeeder {\n     worklist: ~[ast::NodeId],\ndiff --git a/src/librustc/middle/lint.rs b/src/librustc/middle/lint.rs\nindex b468f35..59536c6 100644\n--- a/src/librustc/middle/lint.rs\n+++ b/src/librustc/middle/lint.rs\n@@ -532,6 +532,8 @@ impl<'a> Context<'a> {\n     }\n }\n\n+// Check that every lint from the list of attributes satisfies `f`.\n+// Return true if that's the case. Otherwise return false.\n pub fn each_lint(sess: session::Session,\n                  attrs: &[ast::Attribute],\n                  f: |@ast::MetaItem, level, @str| -> bool)\n@@ -565,6 +567,25 @@ pub fn each_lint(sess: session::Session,\n     true\n }\n\n+// Check from a list of attributes if it contains the appropriate\n+// `#[level(lintname)]` attribute (e.g. `#[allow(dead_code)]).\n+pub fn contains_lint(attrs: &[ast::Attribute],\n+                    level: level, lintname: &'static str) -> bool {\n+    let level_name = level_to_str(level);\n+    for attr in attrs.iter().filter(|m| level_name == m.name()) {\n+        if attr.meta_item_list().is_none() {\n+            continue\n+        }\n+        let list = attr.meta_item_list().unwrap();\n+        for meta_item in list.iter() {\n+            if lintname == meta_item.name() {\n+                return true;\n+            }\n+        }\n+    }\n+    false\n+}\n+\n fn check_while_true_expr(cx: &Context, e: &ast::Expr) {\n     match e.node {\n         ast::ExprWhile(cond, _) => {\ndiff --git a/src/test/compile-fail/lint-dead-code-3.rs b/src/test/compile-fail/lint-dead-code-3.rs\nindex a24b3ae..50c9d50 100644\n--- a/src/test/compile-fail/lint-dead-code-3.rs\n+++ b/src/test/compile-fail/lint-dead-code-3.rs\n@@ -87,6 +87,6 @@ pub fn foo() {\n fn f() { g(); }\n fn g() {}\n\n-// Similarly, lang items are live\n-#[lang=\"fail_\"]\n+// Similarly, lang items are live (we use a dummy name here)\n+#[lang=\"blah\"]\n fn fail(_: *u8, _: *u8, _: uint) -> ! { loop {} }\n```\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/32106174/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/32130307",
    "html_url": "https://github.com/rust-lang/rust/pull/11471#issuecomment-32130307",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/11471",
    "id": 32130307,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMyMTMwMzA3",
    "user": {
      "login": "ktt3ja",
      "id": 1735399,
      "node_id": "MDQ6VXNlcjE3MzUzOTk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1735399?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ktt3ja",
      "html_url": "https://github.com/ktt3ja",
      "followers_url": "https://api.github.com/users/ktt3ja/followers",
      "following_url": "https://api.github.com/users/ktt3ja/following{/other_user}",
      "gists_url": "https://api.github.com/users/ktt3ja/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ktt3ja/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ktt3ja/subscriptions",
      "organizations_url": "https://api.github.com/users/ktt3ja/orgs",
      "repos_url": "https://api.github.com/users/ktt3ja/repos",
      "events_url": "https://api.github.com/users/ktt3ja/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ktt3ja/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-01-12T18:57:47Z",
    "updated_at": "2014-01-12T18:57:47Z",
    "body": "@alexcrichton: r+?\n\nI didn't check for duplicate function name when I moved the tests over from `lint-dead-code-3.rs` to `lint-dead-code-1.rs`, so the test failed.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/32130307/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
