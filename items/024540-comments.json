[
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/94210461",
    "html_url": "https://github.com/rust-lang/rust/issues/24540#issuecomment-94210461",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/24540",
    "id": 94210461,
    "node_id": "MDEyOklzc3VlQ29tbWVudDk0MjEwNDYx",
    "user": {
      "login": "steveklabnik",
      "id": 27786,
      "node_id": "MDQ6VXNlcjI3Nzg2",
      "avatar_url": "https://avatars.githubusercontent.com/u/27786?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/steveklabnik",
      "html_url": "https://github.com/steveklabnik",
      "followers_url": "https://api.github.com/users/steveklabnik/followers",
      "following_url": "https://api.github.com/users/steveklabnik/following{/other_user}",
      "gists_url": "https://api.github.com/users/steveklabnik/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/steveklabnik/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/steveklabnik/subscriptions",
      "organizations_url": "https://api.github.com/users/steveklabnik/orgs",
      "repos_url": "https://api.github.com/users/steveklabnik/repos",
      "events_url": "https://api.github.com/users/steveklabnik/events{/privacy}",
      "received_events_url": "https://api.github.com/users/steveklabnik/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-04-18T22:55:25Z",
    "updated_at": "2015-04-18T22:55:25Z",
    "body": "I _believe_ this is a Cargo issue, not really a `rustc` issue, yeah? /cc @alexcrichton \n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/94210461/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/94248702",
    "html_url": "https://github.com/rust-lang/rust/issues/24540#issuecomment-94248702",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/24540",
    "id": 94248702,
    "node_id": "MDEyOklzc3VlQ29tbWVudDk0MjQ4NzAy",
    "user": {
      "login": "alexcrichton",
      "id": 64996,
      "node_id": "MDQ6VXNlcjY0OTk2",
      "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alexcrichton",
      "html_url": "https://github.com/alexcrichton",
      "followers_url": "https://api.github.com/users/alexcrichton/followers",
      "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}",
      "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions",
      "organizations_url": "https://api.github.com/users/alexcrichton/orgs",
      "repos_url": "https://api.github.com/users/alexcrichton/repos",
      "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alexcrichton/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-04-19T07:48:11Z",
    "updated_at": "2015-04-19T07:48:11Z",
    "body": "This one reason why the compiler favors static linkage by default. Unfortunately there's no way for rustc to inject a path into each binary on Windows, so you'll have to set up your PATH environment variable appropriately before running executables if they're dynamically linked.\n\nFor most usage the dlls in the same folder as `rustc.exe` will suffice, so if `rustc.exe` is in your PATH then everything but plugins should work out ok as well.\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/94248702/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/94248713",
    "html_url": "https://github.com/rust-lang/rust/issues/24540#issuecomment-94248713",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/24540",
    "id": 94248713,
    "node_id": "MDEyOklzc3VlQ29tbWVudDk0MjQ4NzEz",
    "user": {
      "login": "alexcrichton",
      "id": 64996,
      "node_id": "MDQ6VXNlcjY0OTk2",
      "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alexcrichton",
      "html_url": "https://github.com/alexcrichton",
      "followers_url": "https://api.github.com/users/alexcrichton/followers",
      "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}",
      "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions",
      "organizations_url": "https://api.github.com/users/alexcrichton/orgs",
      "repos_url": "https://api.github.com/users/alexcrichton/repos",
      "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alexcrichton/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-04-19T07:48:37Z",
    "updated_at": "2015-04-19T07:48:37Z",
    "body": "I'm not certain that this is a Cargo issue, though. @nstoddard can you be more specific in how this problem arises and what triggers it?\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/94248713/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/94304072",
    "html_url": "https://github.com/rust-lang/rust/issues/24540#issuecomment-94304072",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/24540",
    "id": 94304072,
    "node_id": "MDEyOklzc3VlQ29tbWVudDk0MzA0MDcy",
    "user": {
      "login": "nstoddard",
      "id": 5508622,
      "node_id": "MDQ6VXNlcjU1MDg2MjI=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5508622?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nstoddard",
      "html_url": "https://github.com/nstoddard",
      "followers_url": "https://api.github.com/users/nstoddard/followers",
      "following_url": "https://api.github.com/users/nstoddard/following{/other_user}",
      "gists_url": "https://api.github.com/users/nstoddard/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nstoddard/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nstoddard/subscriptions",
      "organizations_url": "https://api.github.com/users/nstoddard/orgs",
      "repos_url": "https://api.github.com/users/nstoddard/repos",
      "events_url": "https://api.github.com/users/nstoddard/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nstoddard/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-04-19T18:36:34Z",
    "updated_at": "2015-04-19T18:36:34Z",
    "body": "I'll use GLFW as an example. I have a program which uses [glfw-rs](https://github.com/bjz/glfw-rs), which requires linking with `glfw3.dll`. If I put this DLL in my project's base directory (alongside `Cargo.toml`), the linker doesn't find it and I get this error:\n\n```\nerror: linking with `gcc` failed: exit code: 1\nnote: \"gcc\" \"-Wl,--enable-long-section-names\" \"-fno-use-linker-plugin\" \"-Wl,--nxcompat\" \"-static-libgcc\" \"-m64\" \"-L\" \"C:\\Rust\\bin\\rustlib\\x86_64-pc-windows-gnu\\lib\" \"-o\" <lots of rlibs and irrelevant stuff>  \"-L\" \"C:\\Users\\Nathan\\Desktop\\code\\image-viewer\\target\\release\" \"-L\" \"C:\\Users\\Nathan\\Desktop\\code\\image-viewer\\target\\release\\deps\" \"-L\" \"C:\\Users\\Nathan\\Dropbox\\code\\in-progress\\image-viewer\\target\\release\\build\\time-15ec407cfcd2d643\\out\" \"-L\" \"C:\\Rust\\bin\\rustlib\\x86_64-pc-windows-gnu\\lib\" \"-L\" \"C:\\Users\\Nathan\\Desktop\\code\\image-viewer\\.rust\\bin\\x86_64-pc-windows-gnu\" \"-L\" \"C:\\Users\\Nathan\\Desktop\\code\\image-viewer\\bin\\x86_64-pc-windows-gnu\" \"-Wl,--whole-archive\" \"-Wl,-Bstatic\" \"-Wl,--no-whole-archive\" \"-Wl,-Bdynamic\" \"-lglfw3\" \"-lopengl32\" \"-lgdi32\" \"-lfreetype-6\" \"-lws2_32\" \"-luserenv\" \"-lcompiler-rt\"\nnote: ld: cannot find -lglfw3\nld: cannot find -lfreetype-6\n```\n\nIt appears that the base directory isn't included in a `-L` flag. Looking at those flags, there's a few places where the linker looks for DLLs, and the best one to use seems to be `bin\\x86_64-pc-windows-gnu`, as most of the others would require putting the DLLs in the Rust installation directory, which doesn't seem like a good idea.\n\nThe problem is, once I move `glfw3.dll` to `bin\\x86_64-pc-windows-gnu`, the linking works but the program doesn't start, and I get this error:\n\n```\nThe program can't start because glfw3.dll is missing from your computer. Try reinstalling the program to fix this problem. \n```\n\nI need to put another copy of `glfw3.dll` somewhere the program can find it at runtime, and for development the easiest choice is the project's base directory.\n\nI'm not sure whether this is a rustc issue or a Cargo issue. Which one chooses which `-L` flags to pass to the linker?\n\nThere's a few possible solutions to this. One solution would be to pass a `-L` flag for the project's base directory. However, that would require you to pollute the base directory with DLLs, and may lead to problems if you have 32-bit and 64-bit versions of the DLLs.\n\nAnother option would be for `cargo build` and other cargo commands to copy all libraries found in `bin\\x86_64-pc-windows-gnu` (and related directories, for 32-bit windows and such) to `target\\debug` or `target\\release`. This seems like the best option to me, if the copying process doesn't take too long; could symlinks be used instead of actually copying the files? This would allow you to put all your DLLs in one place, and things would just work.\n",
    "author_association": "NONE",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/94304072/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/94475955",
    "html_url": "https://github.com/rust-lang/rust/issues/24540#issuecomment-94475955",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/24540",
    "id": 94475955,
    "node_id": "MDEyOklzc3VlQ29tbWVudDk0NDc1OTU1",
    "user": {
      "login": "retep998",
      "id": 666308,
      "node_id": "MDQ6VXNlcjY2NjMwOA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/666308?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/retep998",
      "html_url": "https://github.com/retep998",
      "followers_url": "https://api.github.com/users/retep998/followers",
      "following_url": "https://api.github.com/users/retep998/following{/other_user}",
      "gists_url": "https://api.github.com/users/retep998/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/retep998/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/retep998/subscriptions",
      "organizations_url": "https://api.github.com/users/retep998/orgs",
      "repos_url": "https://api.github.com/users/retep998/repos",
      "events_url": "https://api.github.com/users/retep998/events{/privacy}",
      "received_events_url": "https://api.github.com/users/retep998/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-04-20T15:00:00Z",
    "updated_at": "2015-04-20T15:00:00Z",
    "body": "On Windows linking should actually only need to be done to a `.lib` or a `.a`, not to a `.dll` directly. You'd have all your `.a` libraries in a location visible to rustc at compile time, while the `.dll`s would be somewhere visible to the binary at run time.\nCargo build scripts let you specify directories to look in for libraries. http://doc.crates.io/build-script.html#outputs-of-the-build-script\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/94475955/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/94550417",
    "html_url": "https://github.com/rust-lang/rust/issues/24540#issuecomment-94550417",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/24540",
    "id": 94550417,
    "node_id": "MDEyOklzc3VlQ29tbWVudDk0NTUwNDE3",
    "user": {
      "login": "alexcrichton",
      "id": 64996,
      "node_id": "MDQ6VXNlcjY0OTk2",
      "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alexcrichton",
      "html_url": "https://github.com/alexcrichton",
      "followers_url": "https://api.github.com/users/alexcrichton/followers",
      "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}",
      "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions",
      "organizations_url": "https://api.github.com/users/alexcrichton/orgs",
      "repos_url": "https://api.github.com/users/alexcrichton/repos",
      "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alexcrichton/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-04-20T19:41:07Z",
    "updated_at": "2015-04-20T19:41:07Z",
    "body": "This primarily sounds like a problem glfw-rs would want to solve rather than Cargo or the compiler. Cargo probably won't be copying dlls into each output folder, and symlinks require admin privileges by default on Windows. The build script support @retep998 linked to also allows for local overrides where you can [globally inform Cargo](http://doc.crates.io/build-script.html#overriding-build-scripts) where `glfw3.dll` is located which will then cause it to pick it up at both compile-time and runtime.\n\nIn general though this is just an aspect of Windows that Cargo and the compiler help to solve but won't solve altogether. @retep998 is correct in that dealing with static libraries is generally much easier to do as there's no runtime dependency on the DLL. Otherwise you'll just need to make sure that the DLL is in your PATH at runtime and there's a build script or override to inform Cargo where it is at compile time.\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/94550417/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
