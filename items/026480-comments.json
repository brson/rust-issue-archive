[
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/117973794",
    "html_url": "https://github.com/rust-lang/rust/issues/26480#issuecomment-117973794",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/26480",
    "id": 117973794,
    "node_id": "MDEyOklzc3VlQ29tbWVudDExNzk3Mzc5NA==",
    "user": {
      "login": "KokaKiwi",
      "id": 183116,
      "node_id": "MDQ6VXNlcjE4MzExNg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/183116?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/KokaKiwi",
      "html_url": "https://github.com/KokaKiwi",
      "followers_url": "https://api.github.com/users/KokaKiwi/followers",
      "following_url": "https://api.github.com/users/KokaKiwi/following{/other_user}",
      "gists_url": "https://api.github.com/users/KokaKiwi/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/KokaKiwi/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/KokaKiwi/subscriptions",
      "organizations_url": "https://api.github.com/users/KokaKiwi/orgs",
      "repos_url": "https://api.github.com/users/KokaKiwi/repos",
      "events_url": "https://api.github.com/users/KokaKiwi/events{/privacy}",
      "received_events_url": "https://api.github.com/users/KokaKiwi/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-07-02T09:23:33Z",
    "updated_at": "2015-07-02T09:24:06Z",
    "body": "Had the same issue, it seems to me that it's caused by macros: https://gist.github.com/2084b4bb800dd6a08939\n\n``` rust\nmacro_rules! jerry(\n    ($name:expr) => {\n        pub static NAME: *mut u8 = $name as *mut u8;\n    }\n);\n\njerry!(b\"Kiwi\\0\");\n```\n\n```\nlib.rs:8:8: 4:52 error: illegal cast: `&'static [u8; 5]` as `*mut u8`\n(internal compiler error: unprintable span)\nlib.rs:2:1: 6:3 note: in expansion of jerry!\nlib.rs:8:1: 8:19 note: expansion site\nerror: aborting due to previous error\n```\n",
    "author_association": "NONE",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/117973794/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/125055494",
    "html_url": "https://github.com/rust-lang/rust/issues/26480#issuecomment-125055494",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/26480",
    "id": 125055494,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEyNTA1NTQ5NA==",
    "user": {
      "login": "chris-morgan",
      "id": 392868,
      "node_id": "MDQ6VXNlcjM5Mjg2OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/392868?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/chris-morgan",
      "html_url": "https://github.com/chris-morgan",
      "followers_url": "https://api.github.com/users/chris-morgan/followers",
      "following_url": "https://api.github.com/users/chris-morgan/following{/other_user}",
      "gists_url": "https://api.github.com/users/chris-morgan/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/chris-morgan/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/chris-morgan/subscriptions",
      "organizations_url": "https://api.github.com/users/chris-morgan/orgs",
      "repos_url": "https://api.github.com/users/chris-morgan/repos",
      "events_url": "https://api.github.com/users/chris-morgan/events{/privacy}",
      "received_events_url": "https://api.github.com/users/chris-morgan/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-07-27T01:10:06Z",
    "updated_at": "2015-07-27T01:10:06Z",
    "body": "I just hit this myself. Most error spans deal with only a single token tree, but the one around casts is different as the start and end points come from two different token trees, because it\u2019s `EXPR as TY`. In these cases where the expression is a macro argument and the type is written inline, you then end up with a span starting inside the macro invocation site but ending inside the macro definition. This span, quite understandably, cannot be printed.\n\nMinimal test case:\n\n``` rust\nmacro_rules! cast {\n    ($x:expr) => ($x as ())\n}\n\nfn main() {\n    cast!(2);\n}\n```\n\n``` text\n<anon>:6:11: 2:27 error: non-scalar cast: `i32` as `()`\n(internal compiler error: unprintable span)\n<anon>:1:1: 3:2 note: in expansion of cast!\n<anon>:6:5: 6:14 note: expansion site\nerror: aborting due to previous error\n```\n\nOf course, if the expression and type both come from the macro invocation and are in order, you\u2019ll end up with a rather odd span too:\n\n``` rust\nmacro_rules! cast_aspersions {\n    ($expr:expr, various stuff here, $ty:ty) => ($expr as $ty)\n}\n\nfn main() {\n    cast_aspersions!(2, various stuff here, ());\n}\n```\n\n``` text\n<anon>:6:22: 6:47 error: non-scalar cast: `i32` as `()`\n<anon>:6     cast_aspersions!(2, various stuff here, ());\n                              ^~~~~~~~~~~~~~~~~~~~~~~~~\n<anon>:1:1: 3:2 note: in expansion of cast_aspersions!\n<anon>:6:5: 6:49 note: expansion site\nerror: aborting due to previous error\n```\n\nReally, for an error like this you need two distinct spans rather than one like these two examples below. I wonder how many other of our error messages are like that?\n\n``` text\n<anon>:6:22: 6:47 error: non-scalar cast: `i32` as `()`\n<anon>:6     cast_aspersions!(2, various stuff here, ());\n                              ^                      ^~\n<anon>:1:1: 3:2 note: in expansion of cast_aspersions!\n<anon>:6:5: 6:49 note: expansion site\nerror: aborting due to previous error\n```\n\n``` text\n<anon>:6:11: 2:27 error: non-scalar cast: `i32` as `()`\n<anon>:6     cast!(2);\n                   ^\n<anon>:2     ($x:expr) => ($x as ())\n                                 ^~\n<anon>:1:1: 3:2 note: in expansion of cast!\n<anon>:6:5: 6:14 note: expansion site\nerror: aborting due to previous error\n```\n\nI think this should be labelled A-diagnostics; it doesn\u2019t hold up compilation, just causes it to be unable to print that span.\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/125055494/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
