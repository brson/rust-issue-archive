[
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/151552540",
    "html_url": "https://github.com/rust-lang/rust/issues/29392#issuecomment-151552540",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/29392",
    "id": 151552540,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE1MTU1MjU0MA==",
    "user": {
      "login": "michaelwoerister",
      "id": 1825894,
      "node_id": "MDQ6VXNlcjE4MjU4OTQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1825894?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/michaelwoerister",
      "html_url": "https://github.com/michaelwoerister",
      "followers_url": "https://api.github.com/users/michaelwoerister/followers",
      "following_url": "https://api.github.com/users/michaelwoerister/following{/other_user}",
      "gists_url": "https://api.github.com/users/michaelwoerister/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/michaelwoerister/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/michaelwoerister/subscriptions",
      "organizations_url": "https://api.github.com/users/michaelwoerister/orgs",
      "repos_url": "https://api.github.com/users/michaelwoerister/repos",
      "events_url": "https://api.github.com/users/michaelwoerister/events{/privacy}",
      "received_events_url": "https://api.github.com/users/michaelwoerister/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-10-27T16:06:28Z",
    "updated_at": "2015-10-27T16:06:28Z",
    "body": "Filtering out NonZero and Unique in the pretty printers should be doable I think. We already have special handling for Vec<> and String, for example.\n\nChanging how GDB parses and evaluates expressions is a different thing though. There may be some way to make this work, but doing it cleanly involves going into GDB's rather messy C internals, as far as I know.\n\nAs a side note: It seems that LLDB is starting to support language plugins. A real Rust plugin would make it possible to support all of the above and a lot more `:)`.\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/151552540/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/152742688",
    "html_url": "https://github.com/rust-lang/rust/issues/29392#issuecomment-152742688",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/29392",
    "id": 152742688,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE1Mjc0MjY4OA==",
    "user": {
      "login": "michaelwoerister",
      "id": 1825894,
      "node_id": "MDQ6VXNlcjE4MjU4OTQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1825894?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/michaelwoerister",
      "html_url": "https://github.com/michaelwoerister",
      "followers_url": "https://api.github.com/users/michaelwoerister/followers",
      "following_url": "https://api.github.com/users/michaelwoerister/following{/other_user}",
      "gists_url": "https://api.github.com/users/michaelwoerister/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/michaelwoerister/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/michaelwoerister/subscriptions",
      "organizations_url": "https://api.github.com/users/michaelwoerister/orgs",
      "repos_url": "https://api.github.com/users/michaelwoerister/repos",
      "events_url": "https://api.github.com/users/michaelwoerister/events{/privacy}",
      "received_events_url": "https://api.github.com/users/michaelwoerister/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-10-31T15:26:14Z",
    "updated_at": "2015-10-31T15:26:14Z",
    "body": "OK, unfortunately this turns out to be way harder to do in GDB than expected. Due to how GDB's pretty printing API is structured, it's not possible filter out intermediate data structure nesting levels (like a NonZero field) without this level still leaving some kind of artifact in the rendered string:\n\n```\n// This ...\nstruct WithNonZero {\n    a: NonZero<u32>\n}\n// ... is rendered as this:\nWithNonZero = {a =  = { = 9}}\n```\n\nAt least the above is the best thing I managed and I tried various different approaches.\n\nThe only way to get arround this problem is to have pretty printers for _every_ type, even primitive ones. But then one loses the ability to influence how these are printed. E.g. one can't force integers to be printed as hexadecimals anymore, as can be done with `print/x`. That's pretty bad and personally I think that's too big a tradeoff.\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/152742688/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/299721246",
    "html_url": "https://github.com/rust-lang/rust/issues/29392#issuecomment-299721246",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/29392",
    "id": 299721246,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI5OTcyMTI0Ng==",
    "user": {
      "login": "tromey",
      "id": 1557670,
      "node_id": "MDQ6VXNlcjE1NTc2NzA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1557670?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/tromey",
      "html_url": "https://github.com/tromey",
      "followers_url": "https://api.github.com/users/tromey/followers",
      "following_url": "https://api.github.com/users/tromey/following{/other_user}",
      "gists_url": "https://api.github.com/users/tromey/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/tromey/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/tromey/subscriptions",
      "organizations_url": "https://api.github.com/users/tromey/orgs",
      "repos_url": "https://api.github.com/users/tromey/repos",
      "events_url": "https://api.github.com/users/tromey/events{/privacy}",
      "received_events_url": "https://api.github.com/users/tromey/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2017-05-07T17:29:07Z",
    "updated_at": "2017-05-07T17:29:07Z",
    "body": "I looked at this today.\r\n\r\nUpstream output is more or less the same, just more clear that pointer points to a tuple.\r\n```\r\n(gdb) p f\r\n$1 = u::Foo {\r\n  ptr: core::ptr::Unique<u::Bar> {\r\n    pointer: core::nonzero::NonZero<*const u::Bar> (\r\n      0x7fffffffe198\r\n    ),\r\n    _marker: core::marker::PhantomData<u::Bar>\r\n  }\r\n}\r\n```\r\n\r\nDereferencing still needs a lot of typing, but it's now Rust syntax at least:\r\n```\r\n(gdb) p *f.ptr.pointer.0\r\n$6 = u::Bar {\r\n  y: 10\r\n}\r\n```\r\n\r\nFor `print *f.ptr` -- I think making that work in gdb would require gdb knowing that the type implements `Deref` (currently not in the DWARF).  And, then it might also require a non-inlined copy of the appropriate function.  Adding the xmethod support would be another approach here.",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/299721246/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/1160549041",
    "html_url": "https://github.com/rust-lang/rust/issues/29392#issuecomment-1160549041",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/29392",
    "id": 1160549041,
    "node_id": "IC_kwDOAAsO6M5FLJKx",
    "user": {
      "login": "wesleywiser",
      "id": 831192,
      "node_id": "MDQ6VXNlcjgzMTE5Mg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/831192?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/wesleywiser",
      "html_url": "https://github.com/wesleywiser",
      "followers_url": "https://api.github.com/users/wesleywiser/followers",
      "following_url": "https://api.github.com/users/wesleywiser/following{/other_user}",
      "gists_url": "https://api.github.com/users/wesleywiser/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/wesleywiser/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/wesleywiser/subscriptions",
      "organizations_url": "https://api.github.com/users/wesleywiser/orgs",
      "repos_url": "https://api.github.com/users/wesleywiser/repos",
      "events_url": "https://api.github.com/users/wesleywiser/events{/privacy}",
      "received_events_url": "https://api.github.com/users/wesleywiser/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2022-06-20T14:54:45Z",
    "updated_at": "2022-06-20T14:54:45Z",
    "body": "Visited during wg-debugging triage. There seems to be two different parts to this issue:\r\n\r\n1. Pretty printers for these types. \r\n2. Debugger integration with expression evaluation that treats these types more like transparent wrappers. \r\n\r\nThe second part is quite a bit more complicated than the first and also relates to ongoing discussions the wg has had with regards to how we want to provider better support for debuggers in general. \r\n\r\nThe first part (adding pretty printers) shouldn't be too difficult. We already have NatVis ones [here](https://github.com/rust-lang/rust/blob/1d6010816c37186e2bee316709f0c0197c427513/src/etc/natvis/libcore.natvis#L108) and so we just need to add pretty printers to the appropriate Python scripts [here](https://github.com/rust-lang/rust/tree/master/src/etc) and debuginfo tests to cover them. Tagging as `E-medium` for the first part. ",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/1160549041/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
