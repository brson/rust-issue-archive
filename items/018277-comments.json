[
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/60401921",
    "html_url": "https://github.com/rust-lang/rust/pull/18277#issuecomment-60401921",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/18277",
    "id": 60401921,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYwNDAxOTIx",
    "user": {
      "login": "alexcrichton",
      "id": 64996,
      "node_id": "MDQ6VXNlcjY0OTk2",
      "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alexcrichton",
      "html_url": "https://github.com/alexcrichton",
      "followers_url": "https://api.github.com/users/alexcrichton/followers",
      "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}",
      "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions",
      "organizations_url": "https://api.github.com/users/alexcrichton/orgs",
      "repos_url": "https://api.github.com/users/alexcrichton/repos",
      "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alexcrichton/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-10-24T15:20:14Z",
    "updated_at": "2014-10-24T15:20:14Z",
    "body": "Could you expand a little more on how you see this working? I thought libcore wouldn't compile without this fake module?\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/60401921/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/60426306",
    "html_url": "https://github.com/rust-lang/rust/pull/18277#issuecomment-60426306",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/18277",
    "id": 60426306,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYwNDI2MzA2",
    "user": {
      "login": "bgamari",
      "id": 1010174,
      "node_id": "MDQ6VXNlcjEwMTAxNzQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1010174?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/bgamari",
      "html_url": "https://github.com/bgamari",
      "followers_url": "https://api.github.com/users/bgamari/followers",
      "following_url": "https://api.github.com/users/bgamari/following{/other_user}",
      "gists_url": "https://api.github.com/users/bgamari/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/bgamari/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/bgamari/subscriptions",
      "organizations_url": "https://api.github.com/users/bgamari/orgs",
      "repos_url": "https://api.github.com/users/bgamari/repos",
      "events_url": "https://api.github.com/users/bgamari/events{/privacy}",
      "received_events_url": "https://api.github.com/users/bgamari/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-10-24T18:06:16Z",
    "updated_at": "2014-10-24T18:06:16Z",
    "body": "Whoops, yes, you are right. My flag apparently wasn't making it through the Zinc build system to `rustc`.  Sorry for the noise.\n\nI just pushed another attempt which this time I confirmed was built with `--cfg=no_fail_fmt`. This reduced text sizes by nearly 2 kB.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/60426306/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/60432930",
    "html_url": "https://github.com/rust-lang/rust/pull/18277#issuecomment-60432930",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/18277",
    "id": 60432930,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYwNDMyOTMw",
    "user": {
      "login": "alexcrichton",
      "id": 64996,
      "node_id": "MDQ6VXNlcjY0OTk2",
      "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alexcrichton",
      "html_url": "https://github.com/alexcrichton",
      "followers_url": "https://api.github.com/users/alexcrichton/followers",
      "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}",
      "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions",
      "organizations_url": "https://api.github.com/users/alexcrichton/orgs",
      "repos_url": "https://api.github.com/users/alexcrichton/repos",
      "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alexcrichton/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-10-24T18:54:34Z",
    "updated_at": "2014-10-24T18:54:34Z",
    "body": "In the PR message you explained the motivation for this as \"some users would rather define their own fail handlers,\" but as written this hard-codes all failure to `intrinsics::abort` which can't be overridden (unlike defining the `fail_fmt` lang item), was that intentional?\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/60432930/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/60437312",
    "html_url": "https://github.com/rust-lang/rust/pull/18277#issuecomment-60437312",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/18277",
    "id": 60437312,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYwNDM3MzEy",
    "user": {
      "login": "bgamari",
      "id": 1010174,
      "node_id": "MDQ6VXNlcjEwMTAxNzQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1010174?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/bgamari",
      "html_url": "https://github.com/bgamari",
      "followers_url": "https://api.github.com/users/bgamari/followers",
      "following_url": "https://api.github.com/users/bgamari/following{/other_user}",
      "gists_url": "https://api.github.com/users/bgamari/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/bgamari/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/bgamari/subscriptions",
      "organizations_url": "https://api.github.com/users/bgamari/orgs",
      "repos_url": "https://api.github.com/users/bgamari/repos",
      "events_url": "https://api.github.com/users/bgamari/events{/privacy}",
      "received_events_url": "https://api.github.com/users/bgamari/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-10-24T19:27:54Z",
    "updated_at": "2014-10-24T19:28:46Z",
    "body": "@alexcrichton it wasn't intentional but it happened ;) I neglected to update the PR text. It has since been fixed. That being said, it is a bit unfortunate that we now lose the ability to define custom fail handlers. I added a patch on top to instead just eliminate the arguments of `format_args!`. This preserves a good fraction of the savings in binary size that the first approach offered (1096 bytes vs. 916 bytes on a simple blink example with division) while retaining the ability to override `fail_impl`.\n\nAt this point I'm weakly in support of this second approach as I think we'll really want the ability to override `fail_impl`. If you agree I'll squash the commits and we can continue from there.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/60437312/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/60439728",
    "html_url": "https://github.com/rust-lang/rust/pull/18277#issuecomment-60439728",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/18277",
    "id": 60439728,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYwNDM5NzI4",
    "user": {
      "login": "alexcrichton",
      "id": 64996,
      "node_id": "MDQ6VXNlcjY0OTk2",
      "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alexcrichton",
      "html_url": "https://github.com/alexcrichton",
      "followers_url": "https://api.github.com/users/alexcrichton/followers",
      "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}",
      "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions",
      "organizations_url": "https://api.github.com/users/alexcrichton/orgs",
      "repos_url": "https://api.github.com/users/alexcrichton/repos",
      "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alexcrichton/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-10-24T19:48:48Z",
    "updated_at": "2014-10-24T19:48:48Z",
    "body": "Interesting! With the goal of getting as small as possible here, I'm surprised that _only_ removing the formatting messages from these failure functions is sufficient to fit your constraints. When you say 1096 bytes to 916 bytes, is that a before/after with respect to the entire patch or just the first/second strategy?\n\nI'm curious about what's taking up the most space here which you you want to eliminate. The factors which contribute to the size of the code that I know of are:\n1. The file name of the failure invocation point\n2. The `__STATIC_FMTSTR` array which consists of pieces of string literals in format strings\n3. The code to generate `fmt::Arguments`\n4. The `_FILE_LINE` statics generated from failure locations.\n\nOf these, the current PR only eliminates 2/3 for the two functions in `core::failure`, which I would have expected to be a practically miniscule contribution. Does it actually end up being much larger?\n\nI suppose I could summarize my question as follows: Do you have some more data about the before/after picture here with respect to both the approaches? (forbidding overriding or just removing msgs)\n\nAlso, as a side note, while you're modifying these could you change the `-> ()` in the closures to `-> !` (now that we support it), that should also allow removing the calls to `intrinsics::unreachable()`.\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/60439728/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/60440291",
    "html_url": "https://github.com/rust-lang/rust/pull/18277#issuecomment-60440291",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/18277",
    "id": 60440291,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYwNDQwMjkx",
    "user": {
      "login": "bgamari",
      "id": 1010174,
      "node_id": "MDQ6VXNlcjEwMTAxNzQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1010174?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/bgamari",
      "html_url": "https://github.com/bgamari",
      "followers_url": "https://api.github.com/users/bgamari/followers",
      "following_url": "https://api.github.com/users/bgamari/following{/other_user}",
      "gists_url": "https://api.github.com/users/bgamari/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/bgamari/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/bgamari/subscriptions",
      "organizations_url": "https://api.github.com/users/bgamari/orgs",
      "repos_url": "https://api.github.com/users/bgamari/repos",
      "events_url": "https://api.github.com/users/bgamari/events{/privacy}",
      "received_events_url": "https://api.github.com/users/bgamari/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-10-24T19:53:37Z",
    "updated_at": "2014-10-25T16:25:54Z",
    "body": "@alexcrichton here is a more thorough tabulation (looking at zinc with `rake -j4 PLATFORM=k20 build_blink_k20`),\n\n| branch | .text | .bss |\n| --- | --- | --- |\n| no exceptions | 836 bytes | 8 bytes |\n| neither patch | 2568 bytes | 8 bytes |\n| first patch | 916 bytes | 8 bytes |\n| both patches | 1096 bytes | 8 bytes |\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/60440291/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/60441753",
    "html_url": "https://github.com/rust-lang/rust/pull/18277#issuecomment-60441753",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/18277",
    "id": 60441753,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYwNDQxNzUz",
    "user": {
      "login": "alexcrichton",
      "id": 64996,
      "node_id": "MDQ6VXNlcjY0OTk2",
      "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alexcrichton",
      "html_url": "https://github.com/alexcrichton",
      "followers_url": "https://api.github.com/users/alexcrichton/followers",
      "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}",
      "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions",
      "organizations_url": "https://api.github.com/users/alexcrichton/orgs",
      "repos_url": "https://api.github.com/users/alexcrichton/repos",
      "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alexcrichton/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-10-24T20:05:46Z",
    "updated_at": "2014-10-24T20:05:46Z",
    "body": "Wow, I would most certainly not expect the current patch to be under half the size of the original one. Could you past the before/after IR? I'm curious as to what's causing all the extra `.text`\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/60441753/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/60443721",
    "html_url": "https://github.com/rust-lang/rust/pull/18277#issuecomment-60443721",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/18277",
    "id": 60443721,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYwNDQzNzIx",
    "user": {
      "login": "farcaller",
      "id": 693,
      "node_id": "MDQ6VXNlcjY5Mw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/693?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/farcaller",
      "html_url": "https://github.com/farcaller",
      "followers_url": "https://api.github.com/users/farcaller/followers",
      "following_url": "https://api.github.com/users/farcaller/following{/other_user}",
      "gists_url": "https://api.github.com/users/farcaller/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/farcaller/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/farcaller/subscriptions",
      "organizations_url": "https://api.github.com/users/farcaller/orgs",
      "repos_url": "https://api.github.com/users/farcaller/repos",
      "events_url": "https://api.github.com/users/farcaller/events{/privacy}",
      "received_events_url": "https://api.github.com/users/farcaller/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-10-24T20:21:47Z",
    "updated_at": "2014-10-24T20:21:47Z",
    "body": "I don't have IR at hand, but I remember that bloat is introduced by `*fmt*` symbols, error description strings and file path strings. Ideally we'd like to get rid of all those.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/60443721/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/60488380",
    "html_url": "https://github.com/rust-lang/rust/pull/18277#issuecomment-60488380",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/18277",
    "id": 60488380,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYwNDg4Mzgw",
    "user": {
      "login": "bgamari",
      "id": 1010174,
      "node_id": "MDQ6VXNlcjEwMTAxNzQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1010174?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/bgamari",
      "html_url": "https://github.com/bgamari",
      "followers_url": "https://api.github.com/users/bgamari/followers",
      "following_url": "https://api.github.com/users/bgamari/following{/other_user}",
      "gists_url": "https://api.github.com/users/bgamari/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/bgamari/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/bgamari/subscriptions",
      "organizations_url": "https://api.github.com/users/bgamari/orgs",
      "repos_url": "https://api.github.com/users/bgamari/repos",
      "events_url": "https://api.github.com/users/bgamari/events{/privacy}",
      "received_events_url": "https://api.github.com/users/bgamari/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-10-25T16:30:18Z",
    "updated_at": "2014-10-25T16:34:16Z",
    "body": "@alexcrichton I haven't yet generated IR but looking at `objdump` output is fairly enlightening. Comparing patch 2 against master a few obvious differences pop out; namely these symbols appear,\n\n```\n00000635 l     F .text  000002de _ZN3fmt11secret_show21h15661710013944803792E\n00000915 l     F .text  0000014c _ZN3fmt22Formatter$LT$$x27a$GT$12with_padding20h568554db2fd92d406qzE\n00000a61 l     F .text  00000022 _ZN3fmt22Formatter$LT$$x27a$GT$3pad13closure.22207E\n00000c40 l     O .text  00000014 _ZN3str39_$BP$$x27a$x20str.StrSlice$LT$$x27a$GT$11slice_chars14_MSG_FILE_LINE20hf187f39f6e2e05067xrE\n00000bf0 l     O .text  00000014 _ZN3str39_$BP$$x27a$x20str.StrSlice$LT$$x27a$GT$11slice_chars14_MSG_FILE_LINE20hf187f39f6e2e0506HxrE\n00000ba0 l     O .text  00000014 _ZN3str3raw11slice_bytes14_MSG_FILE_LINE20hf187f39f6e2e050657qE\n00000b60 l     O .text  00000014 _ZN3str3raw11slice_bytes14_MSG_FILE_LINE20hf187f39f6e2e0506A7qE\n```\n\nBy my tally those constitute 1180 bytes of text.\n\nThese also appear,\n\n```\n00000b04 l     O .text  00000000 str22101\n00000b10 l     O .text  00000027 str22153\n00000b40 l     O .text  0000001e str22165\n00000b80 l     O .text  00000020 str22166\n00000bc0 l     O .text  0000002c str22180\n00000c10 l     O .text  0000002a str22181\n```\n\nWhich is another 187 bytes for a total of 1367 bytes.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/60488380/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/60493136",
    "html_url": "https://github.com/rust-lang/rust/pull/18277#issuecomment-60493136",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/18277",
    "id": 60493136,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYwNDkzMTM2",
    "user": {
      "login": "alexcrichton",
      "id": 64996,
      "node_id": "MDQ6VXNlcjY0OTk2",
      "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alexcrichton",
      "html_url": "https://github.com/alexcrichton",
      "followers_url": "https://api.github.com/users/alexcrichton/followers",
      "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}",
      "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions",
      "organizations_url": "https://api.github.com/users/alexcrichton/orgs",
      "repos_url": "https://api.github.com/users/alexcrichton/repos",
      "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alexcrichton/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-10-25T18:46:14Z",
    "updated_at": "2014-10-25T18:46:14Z",
    "body": "The plot thickens! So to explain my impetus for these questions, I do find it unfortunate that we have a mode for libcore where failure produces blank failure messages where it otherwise has useful contextual information about what happened. The size does seem worrying, however, and I'd love to optimize it!\n\nIt looks like the largest contributor is the `fmt::secret_show` which is generated once per `{}`-formatted argument. In this case it's probably pulling in `impl Show for &str` as they're both used in `core::failure`. Some of the more expensive asserts or codegen bloats may be:\n- The `Show` impl for `&str` properly handles things like padding and such, so the `Formatter::pad` function is used.\n- This padding function isn't exactly small and contains a few vectors of failure itself:\n  - It [calls `slice_chars`](https://github.com/rust-lang/rust/blob/80e5fe1a56bb95e8e89d5f8f0ff5122583bb5336/src/libcore/fmt/mod.rs#L486) which needs utf8 encoding and decoding.\n  - It also [calls `char_len`](https://github.com/rust-lang/rust/blob/80e5fe1a56bb95e8e89d5f8f0ff5122583bb5336/src/libcore/fmt/mod.rs#L498)\n  - The [`with_padding` function uses slices](https://github.com/rust-lang/rust/blob/80e5fe1a56bb95e8e89d5f8f0ff5122583bb5336/src/libcore/fmt/mod.rs#L529-L539) which may trigger a failure point.\n\nWould it be possible to investigate optimizing the size of the padding functions before adding a switch to turn off the error messages entirely? One possible route to take is to define `struct SimpleFormat<'a>(&'a str)` inside of `core::failure` (privately) and the `Show` impl just calls `write` directly instead of padding (b/c it knows it has no padding). That should bypass all the `fmt` infrastructure by default (for at least the simple use case), and it should also preserve error messages.\n\nThe more difficult route (but more general) would be optimizing the padding function itself. The first step here would probably be removing as many points of \"failure\" as possible, with the next being optimizing the amount of code. This would apply more generally and would help keep all binaries a tad bit smaller perhaps?\n\nHow does that sound?\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/60493136/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/60493773",
    "html_url": "https://github.com/rust-lang/rust/pull/18277#issuecomment-60493773",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/18277",
    "id": 60493773,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYwNDkzNzcz",
    "user": {
      "login": "farcaller",
      "id": 693,
      "node_id": "MDQ6VXNlcjY5Mw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/693?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/farcaller",
      "html_url": "https://github.com/farcaller",
      "followers_url": "https://api.github.com/users/farcaller/followers",
      "following_url": "https://api.github.com/users/farcaller/following{/other_user}",
      "gists_url": "https://api.github.com/users/farcaller/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/farcaller/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/farcaller/subscriptions",
      "organizations_url": "https://api.github.com/users/farcaller/orgs",
      "repos_url": "https://api.github.com/users/farcaller/repos",
      "events_url": "https://api.github.com/users/farcaller/events{/privacy}",
      "received_events_url": "https://api.github.com/users/farcaller/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-10-25T19:01:59Z",
    "updated_at": "2014-10-25T19:01:59Z",
    "body": "@alexcrichton, one of the things is that the system might run completely \"headless\" (no way to return any string of text to the user), or spend most of the boot time headless. Having any dependencies to pull in text strings and formatting is still dead weight, and in some cases each byte counts.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/60493773/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/60530225",
    "html_url": "https://github.com/rust-lang/rust/pull/18277#issuecomment-60530225",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/18277",
    "id": 60530225,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYwNTMwMjI1",
    "user": {
      "login": "alexcrichton",
      "id": 64996,
      "node_id": "MDQ6VXNlcjY0OTk2",
      "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alexcrichton",
      "html_url": "https://github.com/alexcrichton",
      "followers_url": "https://api.github.com/users/alexcrichton/followers",
      "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}",
      "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions",
      "organizations_url": "https://api.github.com/users/alexcrichton/orgs",
      "repos_url": "https://api.github.com/users/alexcrichton/repos",
      "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alexcrichton/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-10-26T20:09:17Z",
    "updated_at": "2014-10-26T20:09:26Z",
    "body": "Taking that to the extreme then the `no_fail_fmt` cfg flag should rewrite `fail!()` and `assert!()` to not pass strings at all but simply just call `intrinsics::abort()`. It looked like @bgamari was saying that it was adequate to just remove the formatting from `core::failure`, so I was hoping that tweaking the design there would prevent pulling in lots of formatting by default.\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/60530225/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/63239728",
    "html_url": "https://github.com/rust-lang/rust/pull/18277#issuecomment-63239728",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/18277",
    "id": 63239728,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYzMjM5NzI4",
    "user": {
      "login": "alexcrichton",
      "id": 64996,
      "node_id": "MDQ6VXNlcjY0OTk2",
      "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alexcrichton",
      "html_url": "https://github.com/alexcrichton",
      "followers_url": "https://api.github.com/users/alexcrichton/followers",
      "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}",
      "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions",
      "organizations_url": "https://api.github.com/users/alexcrichton/orgs",
      "repos_url": "https://api.github.com/users/alexcrichton/repos",
      "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alexcrichton/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-11-16T21:14:57Z",
    "updated_at": "2014-11-16T21:14:57Z",
    "body": "Closing due to inactivity (and @bors's queue is quite full!). Feel free to reopen with rebase!\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/63239728/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/63243443",
    "html_url": "https://github.com/rust-lang/rust/pull/18277#issuecomment-63243443",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/18277",
    "id": 63243443,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYzMjQzNDQz",
    "user": {
      "login": "bgamari",
      "id": 1010174,
      "node_id": "MDQ6VXNlcjEwMTAxNzQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1010174?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/bgamari",
      "html_url": "https://github.com/bgamari",
      "followers_url": "https://api.github.com/users/bgamari/followers",
      "following_url": "https://api.github.com/users/bgamari/following{/other_user}",
      "gists_url": "https://api.github.com/users/bgamari/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/bgamari/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/bgamari/subscriptions",
      "organizations_url": "https://api.github.com/users/bgamari/orgs",
      "repos_url": "https://api.github.com/users/bgamari/repos",
      "events_url": "https://api.github.com/users/bgamari/events{/privacy}",
      "received_events_url": "https://api.github.com/users/bgamari/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-11-16T22:47:18Z",
    "updated_at": "2014-11-16T22:47:18Z",
    "body": "Alex Crichton notifications@github.com writes:\n\n> Closing due to inactivity (and @bors's queue is quite full!). Feel\n> free to reopen with rebase!\n> \n> Sure, I've been meaning to do a more thorough investigation of the\n> contributions to the binary size but life has been getting in the way.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/63243443/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
