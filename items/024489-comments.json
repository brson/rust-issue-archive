[
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/93704182",
    "html_url": "https://github.com/rust-lang/rust/issues/24489#issuecomment-93704182",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/24489",
    "id": 93704182,
    "node_id": "MDEyOklzc3VlQ29tbWVudDkzNzA0MTgy",
    "user": {
      "login": "dotdash",
      "id": 230962,
      "node_id": "MDQ6VXNlcjIzMDk2Mg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/230962?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dotdash",
      "html_url": "https://github.com/dotdash",
      "followers_url": "https://api.github.com/users/dotdash/followers",
      "following_url": "https://api.github.com/users/dotdash/following{/other_user}",
      "gists_url": "https://api.github.com/users/dotdash/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dotdash/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dotdash/subscriptions",
      "organizations_url": "https://api.github.com/users/dotdash/orgs",
      "repos_url": "https://api.github.com/users/dotdash/repos",
      "events_url": "https://api.github.com/users/dotdash/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dotdash/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-04-16T10:36:10Z",
    "updated_at": "2015-04-16T10:36:10Z",
    "body": "That's an interesting case, which I think LLVM should handle, but currently doesn't. Maybe the required analysis is too expensive? No idea. The problem is this:\n\n``` llvm\nmatch_case:                                       ; preds = %match_case, %match_case.lr.ph\n  %.1417 = phi i32 [ %2, %match_case.lr.ph ], [ %.14, %match_case ]\n; black_box omitted here\n  %5 = icmp eq i32 %4, 0\n  %6 = add i32 %4, -1\n  %.14 = select i1 %5, i32 0, i32 %6\n  br i1 %5, label %clean_ast_57_.loopexit, label %match_case\n```\n\n`%.14` is only used in the PHI node when we are looping. And that is only the case when `%5` is false, which means that `%.i14` will always be equal to `%6`. And indeed, replacing `%.14` by `%6` in the PHI node leads to identical IR and ASM as the fast version.\n\nI'll try looking around in LLVM for a bit and file a bug if I can't figure out anything.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/93704182/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/93725016",
    "html_url": "https://github.com/rust-lang/rust/issues/24489#issuecomment-93725016",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/24489",
    "id": 93725016,
    "node_id": "MDEyOklzc3VlQ29tbWVudDkzNzI1MDE2",
    "user": {
      "login": "dotdash",
      "id": 230962,
      "node_id": "MDQ6VXNlcjIzMDk2Mg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/230962?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dotdash",
      "html_url": "https://github.com/dotdash",
      "followers_url": "https://api.github.com/users/dotdash/followers",
      "following_url": "https://api.github.com/users/dotdash/following{/other_user}",
      "gists_url": "https://api.github.com/users/dotdash/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dotdash/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dotdash/subscriptions",
      "organizations_url": "https://api.github.com/users/dotdash/orgs",
      "repos_url": "https://api.github.com/users/dotdash/repos",
      "events_url": "https://api.github.com/users/dotdash/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dotdash/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-04-16T12:44:59Z",
    "updated_at": "2015-04-16T12:44:59Z",
    "body": "http://reviews.llvm.org/D9051\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/93725016/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/93856475",
    "html_url": "https://github.com/rust-lang/rust/issues/24489#issuecomment-93856475",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/24489",
    "id": 93856475,
    "node_id": "MDEyOklzc3VlQ29tbWVudDkzODU2NDc1",
    "user": {
      "login": "tbu-",
      "id": 6666593,
      "node_id": "MDQ6VXNlcjY2NjY1OTM=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6666593?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/tbu-",
      "html_url": "https://github.com/tbu-",
      "followers_url": "https://api.github.com/users/tbu-/followers",
      "following_url": "https://api.github.com/users/tbu-/following{/other_user}",
      "gists_url": "https://api.github.com/users/tbu-/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/tbu-/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/tbu-/subscriptions",
      "organizations_url": "https://api.github.com/users/tbu-/orgs",
      "repos_url": "https://api.github.com/users/tbu-/repos",
      "events_url": "https://api.github.com/users/tbu-/events{/privacy}",
      "received_events_url": "https://api.github.com/users/tbu-/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-04-16T22:48:53Z",
    "updated_at": "2015-04-16T22:48:53Z",
    "body": "@dotdash Is this already the fix?\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/93856475/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/93860195",
    "html_url": "https://github.com/rust-lang/rust/issues/24489#issuecomment-93860195",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/24489",
    "id": 93860195,
    "node_id": "MDEyOklzc3VlQ29tbWVudDkzODYwMTk1",
    "user": {
      "login": "dotdash",
      "id": 230962,
      "node_id": "MDQ6VXNlcjIzMDk2Mg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/230962?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dotdash",
      "html_url": "https://github.com/dotdash",
      "followers_url": "https://api.github.com/users/dotdash/followers",
      "following_url": "https://api.github.com/users/dotdash/following{/other_user}",
      "gists_url": "https://api.github.com/users/dotdash/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dotdash/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dotdash/subscriptions",
      "organizations_url": "https://api.github.com/users/dotdash/orgs",
      "repos_url": "https://api.github.com/users/dotdash/repos",
      "events_url": "https://api.github.com/users/dotdash/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dotdash/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-04-16T23:14:43Z",
    "updated_at": "2015-04-16T23:14:43Z",
    "body": "@tbu- Yes, with that patch, both examples optimize to the same IR.\n\nTested with:\n\n``` rust\n#![crate_type=\"lib\"]\n#![feature(test)]\n\nextern crate test;\n\n#[inline(always)]\nfn decrement(val: u32) -> Option<u32> {\n    if val != 0 {\n        Some(val - 1)\n    } else {\n        None\n    }\n}\n\npub fn testfun(mut a: u32) {\n    loop {\n        if a == 0 { return; }\n        a = test::black_box(a - 1);\n    }\n}\n\npub fn testfun2(mut a: u32) {\n    loop {\n        a = test::black_box(match decrement(a) {\n            Some(aa) => { aa },\n            None => { return; },\n        })\n    }\n}\n```\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/93860195/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/93861912",
    "html_url": "https://github.com/rust-lang/rust/issues/24489#issuecomment-93861912",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/24489",
    "id": 93861912,
    "node_id": "MDEyOklzc3VlQ29tbWVudDkzODYxOTEy",
    "user": {
      "login": "steveklabnik",
      "id": 27786,
      "node_id": "MDQ6VXNlcjI3Nzg2",
      "avatar_url": "https://avatars.githubusercontent.com/u/27786?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/steveklabnik",
      "html_url": "https://github.com/steveklabnik",
      "followers_url": "https://api.github.com/users/steveklabnik/followers",
      "following_url": "https://api.github.com/users/steveklabnik/following{/other_user}",
      "gists_url": "https://api.github.com/users/steveklabnik/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/steveklabnik/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/steveklabnik/subscriptions",
      "organizations_url": "https://api.github.com/users/steveklabnik/orgs",
      "repos_url": "https://api.github.com/users/steveklabnik/repos",
      "events_url": "https://api.github.com/users/steveklabnik/events{/privacy}",
      "received_events_url": "https://api.github.com/users/steveklabnik/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-04-16T23:30:30Z",
    "updated_at": "2015-04-16T23:30:30Z",
    "body": "Since this is not only not our bug, but already fixed upstream, I'm going to give it a close. Thanks so much, @dotdash !\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/93861912/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/93866962",
    "html_url": "https://github.com/rust-lang/rust/issues/24489#issuecomment-93866962",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/24489",
    "id": 93866962,
    "node_id": "MDEyOklzc3VlQ29tbWVudDkzODY2OTYy",
    "user": {
      "login": "bstrie",
      "id": 865233,
      "node_id": "MDQ6VXNlcjg2NTIzMw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/865233?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/bstrie",
      "html_url": "https://github.com/bstrie",
      "followers_url": "https://api.github.com/users/bstrie/followers",
      "following_url": "https://api.github.com/users/bstrie/following{/other_user}",
      "gists_url": "https://api.github.com/users/bstrie/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/bstrie/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/bstrie/subscriptions",
      "organizations_url": "https://api.github.com/users/bstrie/orgs",
      "repos_url": "https://api.github.com/users/bstrie/repos",
      "events_url": "https://api.github.com/users/bstrie/events{/privacy}",
      "received_events_url": "https://api.github.com/users/bstrie/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-04-17T00:21:42Z",
    "updated_at": "2015-04-17T00:21:42Z",
    "body": "Reopening for the moment, since the patch mentioned above has not yet been accepted by LLVM and may need to be backported to our fork.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/93866962/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/101458447",
    "html_url": "https://github.com/rust-lang/rust/issues/24489#issuecomment-101458447",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/24489",
    "id": 101458447,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEwMTQ1ODQ0Nw==",
    "user": {
      "login": "dotdash",
      "id": 230962,
      "node_id": "MDQ6VXNlcjIzMDk2Mg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/230962?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dotdash",
      "html_url": "https://github.com/dotdash",
      "followers_url": "https://api.github.com/users/dotdash/followers",
      "following_url": "https://api.github.com/users/dotdash/following{/other_user}",
      "gists_url": "https://api.github.com/users/dotdash/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dotdash/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dotdash/subscriptions",
      "organizations_url": "https://api.github.com/users/dotdash/orgs",
      "repos_url": "https://api.github.com/users/dotdash/repos",
      "events_url": "https://api.github.com/users/dotdash/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dotdash/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-05-12T23:23:32Z",
    "updated_at": "2015-05-13T14:06:42Z",
    "body": "This has been merged upstream. Not sure if we want to close this right away or wait until we support building against an LLVM version that includes that fix.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/101458447/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/113282112",
    "html_url": "https://github.com/rust-lang/rust/issues/24489#issuecomment-113282112",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/24489",
    "id": 113282112,
    "node_id": "MDEyOklzc3VlQ29tbWVudDExMzI4MjExMg==",
    "user": {
      "login": "dotdash",
      "id": 230962,
      "node_id": "MDQ6VXNlcjIzMDk2Mg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/230962?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dotdash",
      "html_url": "https://github.com/dotdash",
      "followers_url": "https://api.github.com/users/dotdash/followers",
      "following_url": "https://api.github.com/users/dotdash/following{/other_user}",
      "gists_url": "https://api.github.com/users/dotdash/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dotdash/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dotdash/subscriptions",
      "organizations_url": "https://api.github.com/users/dotdash/orgs",
      "repos_url": "https://api.github.com/users/dotdash/repos",
      "events_url": "https://api.github.com/users/dotdash/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dotdash/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-06-18T20:36:04Z",
    "updated_at": "2015-06-18T20:36:04Z",
    "body": "The fix landed with the LLVM update in #26025\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/113282112/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
