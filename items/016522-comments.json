[
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/52317978",
    "html_url": "https://github.com/rust-lang/rust/issues/16522#issuecomment-52317978",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/16522",
    "id": 52317978,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUyMzE3OTc4",
    "user": {
      "login": "Gankra",
      "id": 1136864,
      "node_id": "MDQ6VXNlcjExMzY4NjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1136864?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Gankra",
      "html_url": "https://github.com/Gankra",
      "followers_url": "https://api.github.com/users/Gankra/followers",
      "following_url": "https://api.github.com/users/Gankra/following{/other_user}",
      "gists_url": "https://api.github.com/users/Gankra/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Gankra/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Gankra/subscriptions",
      "organizations_url": "https://api.github.com/users/Gankra/orgs",
      "repos_url": "https://api.github.com/users/Gankra/repos",
      "events_url": "https://api.github.com/users/Gankra/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Gankra/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-08-15T15:21:05Z",
    "updated_at": "2014-08-15T15:21:05Z",
    "body": "@pcwalton you seem to be the primary author of SmallVec. I'm willing to do the bulk of the migration work, but would appreciate any insights you have on the matter. Is there anything you would change about the impl if you could?\n\nOne thing that comes to mind is that SmallVec would probably be simpler to implement as a tagged union between a Vec and Slice that does Vecish things but can fail (Result-wise) to insert. Might be possible to bring much of Vec's impl under some common interface to reduce duplication?\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/52317978/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/52338868",
    "html_url": "https://github.com/rust-lang/rust/issues/16522#issuecomment-52338868",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/16522",
    "id": 52338868,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUyMzM4ODY4",
    "user": {
      "login": "pcwalton",
      "id": 157897,
      "node_id": "MDQ6VXNlcjE1Nzg5Nw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/157897?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/pcwalton",
      "html_url": "https://github.com/pcwalton",
      "followers_url": "https://api.github.com/users/pcwalton/followers",
      "following_url": "https://api.github.com/users/pcwalton/following{/other_user}",
      "gists_url": "https://api.github.com/users/pcwalton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/pcwalton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/pcwalton/subscriptions",
      "organizations_url": "https://api.github.com/users/pcwalton/orgs",
      "repos_url": "https://api.github.com/users/pcwalton/repos",
      "events_url": "https://api.github.com/users/pcwalton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/pcwalton/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-08-15T18:07:18Z",
    "updated_at": "2014-08-15T18:07:18Z",
    "body": "Yeah, it would be slightly less efficient as an enum but much easier to understand. Sounds like a good idea to me.\n\nNote that you should extensively unit test it; IIRC the current implementation has some major safety bugs (in iteration I believe).\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/52338868/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/52347902",
    "html_url": "https://github.com/rust-lang/rust/issues/16522#issuecomment-52347902",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/16522",
    "id": 52347902,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUyMzQ3OTAy",
    "user": {
      "login": "Gankra",
      "id": 1136864,
      "node_id": "MDQ6VXNlcjExMzY4NjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1136864?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Gankra",
      "html_url": "https://github.com/Gankra",
      "followers_url": "https://api.github.com/users/Gankra/followers",
      "following_url": "https://api.github.com/users/Gankra/following{/other_user}",
      "gists_url": "https://api.github.com/users/Gankra/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Gankra/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Gankra/subscriptions",
      "organizations_url": "https://api.github.com/users/Gankra/orgs",
      "repos_url": "https://api.github.com/users/Gankra/repos",
      "events_url": "https://api.github.com/users/Gankra/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Gankra/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-08-15T19:28:30Z",
    "updated_at": "2014-08-15T19:29:19Z",
    "body": "So I think my basic idea for this is: \n- Write some trait, let's call it `AbstractVec`\n- Move almost all of `Vec`'s logic to `AbstractVec` as default impls\n- Have impls rely heavily on a two unimplemented methods: `get_internal_slice` and `get_internal_slice_mut`, which would return the implementers entire allocated space [0, capacity)\n- Probably also need a `get_len` and `set_len`\n- Provide a family of structs `FixedVec*` that look like: `struct FixedVec4<T> { slice: [T, ..4], length: uint }` \n- Provide `Vec` as it is now, but with almost all its implementation details now in AbstractVec, being fed by it giving the desired slice to `AbstractVec`\n- Provide a `SmallVec*` family that's basically `enum SmallVec4 { FixedVec(FixedVec4<T>), Vec(Vec<T>) }` that defaults using FixedVec until it's full, and then copies everything into a Vec<T> afterwards.\n\nAny thoughts? My largest concern is that this might have performance consequences for Vec itself, which is obviously a big deal.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/52347902/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/52348528",
    "html_url": "https://github.com/rust-lang/rust/issues/16522#issuecomment-52348528",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/16522",
    "id": 52348528,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUyMzQ4NTI4",
    "user": {
      "login": "Gankra",
      "id": 1136864,
      "node_id": "MDQ6VXNlcjExMzY4NjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1136864?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Gankra",
      "html_url": "https://github.com/Gankra",
      "followers_url": "https://api.github.com/users/Gankra/followers",
      "following_url": "https://api.github.com/users/Gankra/following{/other_user}",
      "gists_url": "https://api.github.com/users/Gankra/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Gankra/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Gankra/subscriptions",
      "organizations_url": "https://api.github.com/users/Gankra/orgs",
      "repos_url": "https://api.github.com/users/Gankra/repos",
      "events_url": "https://api.github.com/users/Gankra/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Gankra/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-08-15T19:35:10Z",
    "updated_at": "2014-08-15T19:35:10Z",
    "body": "Might be worth waiting for something like #15748 to make this less hacky.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/52348528/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/52358671",
    "html_url": "https://github.com/rust-lang/rust/issues/16522#issuecomment-52358671",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/16522",
    "id": 52358671,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUyMzU4Njcx",
    "user": {
      "login": "aturon",
      "id": 709807,
      "node_id": "MDQ6VXNlcjcwOTgwNw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/709807?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/aturon",
      "html_url": "https://github.com/aturon",
      "followers_url": "https://api.github.com/users/aturon/followers",
      "following_url": "https://api.github.com/users/aturon/following{/other_user}",
      "gists_url": "https://api.github.com/users/aturon/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/aturon/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/aturon/subscriptions",
      "organizations_url": "https://api.github.com/users/aturon/orgs",
      "repos_url": "https://api.github.com/users/aturon/repos",
      "events_url": "https://api.github.com/users/aturon/events{/privacy}",
      "received_events_url": "https://api.github.com/users/aturon/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-08-15T21:15:30Z",
    "updated_at": "2014-08-15T21:15:30Z",
    "body": "I wonder whether it would make sense to start by moving SmallVec into its own crate and working on improvements? Then Servo and others could use this crate, and if we found that it was common enough (and we were happy with the API) we could eventually move to libcollections.\n\nThat said, the `Vec` refactoring is an interesting idea that could be useful for other cases as well, and could be usefully done even if `SmallVec` lives in its own crate. Would you be interested in experimenting with this and measuring the performance impact? I'd like to see the design in more detail.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/52358671/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/55688378",
    "html_url": "https://github.com/rust-lang/rust/issues/16522#issuecomment-55688378",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/16522",
    "id": 55688378,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU1Njg4Mzc4",
    "user": {
      "login": "thestinger",
      "id": 1505226,
      "node_id": "MDQ6VXNlcjE1MDUyMjY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1505226?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/thestinger",
      "html_url": "https://github.com/thestinger",
      "followers_url": "https://api.github.com/users/thestinger/followers",
      "following_url": "https://api.github.com/users/thestinger/following{/other_user}",
      "gists_url": "https://api.github.com/users/thestinger/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/thestinger/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/thestinger/subscriptions",
      "organizations_url": "https://api.github.com/users/thestinger/orgs",
      "repos_url": "https://api.github.com/users/thestinger/repos",
      "events_url": "https://api.github.com/users/thestinger/events{/privacy}",
      "received_events_url": "https://api.github.com/users/thestinger/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-09-16T02:46:24Z",
    "updated_at": "2014-09-16T02:46:24Z",
    "body": "Closing as a duplicate of #4991. The Servo implementation has issues like depending on the drop flag and the design isn't necessarily what Rust wants for the standard library.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/55688378/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
