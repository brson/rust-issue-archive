[
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/47746161",
    "html_url": "https://github.com/rust-lang/rust/pull/15326#issuecomment-47746161",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/15326",
    "id": 47746161,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ3NzQ2MTYx",
    "user": {
      "login": "danburkert",
      "id": 160242,
      "node_id": "MDQ6VXNlcjE2MDI0Mg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/160242?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/danburkert",
      "html_url": "https://github.com/danburkert",
      "followers_url": "https://api.github.com/users/danburkert/followers",
      "following_url": "https://api.github.com/users/danburkert/following{/other_user}",
      "gists_url": "https://api.github.com/users/danburkert/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/danburkert/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/danburkert/subscriptions",
      "organizations_url": "https://api.github.com/users/danburkert/orgs",
      "repos_url": "https://api.github.com/users/danburkert/repos",
      "events_url": "https://api.github.com/users/danburkert/events{/privacy}",
      "received_events_url": "https://api.github.com/users/danburkert/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-07-02T07:44:37Z",
    "updated_at": "2014-07-02T07:44:37Z",
    "body": "Changed `with_capacity` to use `alloc` and `from_iter` to use `from_vec` in ca80af3.  Thanks for the prompt review, @huonw.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/47746161/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/47865560",
    "html_url": "https://github.com/rust-lang/rust/pull/15326#issuecomment-47865560",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/15326",
    "id": 47865560,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ3ODY1NTYw",
    "user": {
      "login": "huonw",
      "id": 1203825,
      "node_id": "MDQ6VXNlcjEyMDM4MjU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1203825?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/huonw",
      "html_url": "https://github.com/huonw",
      "followers_url": "https://api.github.com/users/huonw/followers",
      "following_url": "https://api.github.com/users/huonw/following{/other_user}",
      "gists_url": "https://api.github.com/users/huonw/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/huonw/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/huonw/subscriptions",
      "organizations_url": "https://api.github.com/users/huonw/orgs",
      "repos_url": "https://api.github.com/users/huonw/repos",
      "events_url": "https://api.github.com/users/huonw/events{/privacy}",
      "received_events_url": "https://api.github.com/users/huonw/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-07-03T04:23:16Z",
    "updated_at": "2014-07-03T04:23:38Z",
    "body": "Hm, I thought about this some more: since this is providing `into_vec` and `from_vec` functions, this _must_ guarantee that it is allocated/reallocated/deallocated like a `Vec` (same allocator etc.), so I would strongly prefer to see as many of these operations as possible go via `Vec`: e.g.\n- `with_capacity` should use the `Vec` version I suggested above;\n- `resize` can allocate/deallocate its memory via `Vec` (although, on that note, it seems that `resize` could actually `realloc` and then just move elements around as necessary, rather than allocating a whole new buffer?);\n- `Drop` could drop the individual elements, set the length to zero and then use `.into_vec`.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/47865560/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/47866168",
    "html_url": "https://github.com/rust-lang/rust/pull/15326#issuecomment-47866168",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/15326",
    "id": 47866168,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ3ODY2MTY4",
    "user": {
      "login": "huonw",
      "id": 1203825,
      "node_id": "MDQ6VXNlcjEyMDM4MjU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1203825?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/huonw",
      "html_url": "https://github.com/huonw",
      "followers_url": "https://api.github.com/users/huonw/followers",
      "following_url": "https://api.github.com/users/huonw/following{/other_user}",
      "gists_url": "https://api.github.com/users/huonw/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/huonw/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/huonw/subscriptions",
      "organizations_url": "https://api.github.com/users/huonw/orgs",
      "repos_url": "https://api.github.com/users/huonw/repos",
      "events_url": "https://api.github.com/users/huonw/events{/privacy}",
      "received_events_url": "https://api.github.com/users/huonw/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-07-03T04:40:18Z",
    "updated_at": "2014-07-03T04:40:18Z",
    "body": "There's quite a lot of `unsafe` here, most of it seems reasonable, but still, it would be nice to reduce it if possible.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/47866168/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/48803855",
    "html_url": "https://github.com/rust-lang/rust/pull/15326#issuecomment-48803855",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/15326",
    "id": 48803855,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ4ODAzODU1",
    "user": {
      "login": "danburkert",
      "id": 160242,
      "node_id": "MDQ6VXNlcjE2MDI0Mg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/160242?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/danburkert",
      "html_url": "https://github.com/danburkert",
      "followers_url": "https://api.github.com/users/danburkert/followers",
      "following_url": "https://api.github.com/users/danburkert/following{/other_user}",
      "gists_url": "https://api.github.com/users/danburkert/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/danburkert/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/danburkert/subscriptions",
      "organizations_url": "https://api.github.com/users/danburkert/orgs",
      "repos_url": "https://api.github.com/users/danburkert/repos",
      "events_url": "https://api.github.com/users/danburkert/events{/privacy}",
      "received_events_url": "https://api.github.com/users/danburkert/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-07-12T06:26:31Z",
    "updated_at": "2014-07-12T06:26:31Z",
    "body": "Allocation has been fixed, the buffer is now allocated and deallocated by creating / destructing a `Vec`.  I did another pass through to see if I could find any `unsafe` uses that were unnecessary, but came up empty.  Let me know if squashing the commits is preferred.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/48803855/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/48902207",
    "html_url": "https://github.com/rust-lang/rust/pull/15326#issuecomment-48902207",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/15326",
    "id": 48902207,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ4OTAyMjA3",
    "user": {
      "login": "alexcrichton",
      "id": 64996,
      "node_id": "MDQ6VXNlcjY0OTk2",
      "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alexcrichton",
      "html_url": "https://github.com/alexcrichton",
      "followers_url": "https://api.github.com/users/alexcrichton/followers",
      "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}",
      "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions",
      "organizations_url": "https://api.github.com/users/alexcrichton/orgs",
      "repos_url": "https://api.github.com/users/alexcrichton/repos",
      "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alexcrichton/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-07-14T13:55:46Z",
    "updated_at": "2014-07-14T13:55:46Z",
    "body": "Much of this code is almost an exact duplicate of the `Vec` logic. would it be possible to actually store a `Vec<T>` and perhaps occasionally unsafely manipulate it?\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/48902207/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/48902414",
    "html_url": "https://github.com/rust-lang/rust/pull/15326#issuecomment-48902414",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/15326",
    "id": 48902414,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ4OTAyNDE0",
    "user": {
      "login": "alexcrichton",
      "id": 64996,
      "node_id": "MDQ6VXNlcjY0OTk2",
      "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alexcrichton",
      "html_url": "https://github.com/alexcrichton",
      "followers_url": "https://api.github.com/users/alexcrichton/followers",
      "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}",
      "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions",
      "organizations_url": "https://api.github.com/users/alexcrichton/orgs",
      "repos_url": "https://api.github.com/users/alexcrichton/repos",
      "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alexcrichton/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-07-14T13:57:30Z",
    "updated_at": "2014-07-14T13:57:30Z",
    "body": "Another question is whether you've made optimizations other than storing `T` instead of `Option<T>`? If so, I would be curious what the performance impact of moving from `Option<T>` to `T` was as it seems to be the source of most of the unsafety.\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/48902414/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/48989615",
    "html_url": "https://github.com/rust-lang/rust/pull/15326#issuecomment-48989615",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/15326",
    "id": 48989615,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ4OTg5NjE1",
    "user": {
      "login": "danburkert",
      "id": 160242,
      "node_id": "MDQ6VXNlcjE2MDI0Mg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/160242?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/danburkert",
      "html_url": "https://github.com/danburkert",
      "followers_url": "https://api.github.com/users/danburkert/followers",
      "following_url": "https://api.github.com/users/danburkert/following{/other_user}",
      "gists_url": "https://api.github.com/users/danburkert/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/danburkert/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/danburkert/subscriptions",
      "organizations_url": "https://api.github.com/users/danburkert/orgs",
      "repos_url": "https://api.github.com/users/danburkert/repos",
      "events_url": "https://api.github.com/users/danburkert/events{/privacy}",
      "received_events_url": "https://api.github.com/users/danburkert/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-07-15T04:34:13Z",
    "updated_at": "2014-07-15T04:37:04Z",
    "body": "@alexcrichton I believe it would be possible to store a `Vec<T>`, but I do not believe this would cut down on the use of `unsafe`.  Everywhere there is `unsafe` usage to interact with the raw buffer now would be replaced with an `unsafe` access of the `Vec`.  Even something as simple as `get` would require `unsafe` in order to avoid checking bounds twice (once by the `RingBuf` and once by the `Vec`).  Replacing the raw buffer with `Vec` would also add an overhead of a word to track the `Vec`'s length (this is admittedly a small issue).\n\nTo your question about what has been optimized, I have two answers.  First, the most important part of the PR (to me, at least) is not the performance improvements that dropping the `Option`s provides, its that this allows `as_slices`, `into_vec`, and `from_vec` to be implemented with as few copies/allocations as possible.  Secondly, there are important optimizations in `resize` and `reset` that would not be possible if it were just a plain `Vec`.  Significantly, in the worst case, the current `RingBuf` implementation copies every element twice, this new version only does a single copy of each element.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/48989615/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/48989753",
    "html_url": "https://github.com/rust-lang/rust/pull/15326#issuecomment-48989753",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/15326",
    "id": 48989753,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ4OTg5NzUz",
    "user": {
      "login": "thestinger",
      "id": 1505226,
      "node_id": "MDQ6VXNlcjE1MDUyMjY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1505226?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/thestinger",
      "html_url": "https://github.com/thestinger",
      "followers_url": "https://api.github.com/users/thestinger/followers",
      "following_url": "https://api.github.com/users/thestinger/following{/other_user}",
      "gists_url": "https://api.github.com/users/thestinger/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/thestinger/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/thestinger/subscriptions",
      "organizations_url": "https://api.github.com/users/thestinger/orgs",
      "repos_url": "https://api.github.com/users/thestinger/repos",
      "events_url": "https://api.github.com/users/thestinger/events{/privacy}",
      "received_events_url": "https://api.github.com/users/thestinger/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-07-15T04:37:21Z",
    "updated_at": "2014-07-15T04:37:21Z",
    "body": "It doesn't have to add any overhead: https://github.com/thestinger/rust-core/blob/master/core/deque.rs\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/48989753/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/48989850",
    "html_url": "https://github.com/rust-lang/rust/pull/15326#issuecomment-48989850",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/15326",
    "id": 48989850,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ4OTg5ODUw",
    "user": {
      "login": "danburkert",
      "id": 160242,
      "node_id": "MDQ6VXNlcjE2MDI0Mg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/160242?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/danburkert",
      "html_url": "https://github.com/danburkert",
      "followers_url": "https://api.github.com/users/danburkert/followers",
      "following_url": "https://api.github.com/users/danburkert/following{/other_user}",
      "gists_url": "https://api.github.com/users/danburkert/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/danburkert/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/danburkert/subscriptions",
      "organizations_url": "https://api.github.com/users/danburkert/orgs",
      "repos_url": "https://api.github.com/users/danburkert/repos",
      "events_url": "https://api.github.com/users/danburkert/events{/privacy}",
      "received_events_url": "https://api.github.com/users/danburkert/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-07-15T04:39:38Z",
    "updated_at": "2014-07-15T04:39:38Z",
    "body": "@thestinger I'm specifically not claiming that it would add overhead (other than the 1 word length field that would be unused).  I'm claiming that using it would not cut down on `unsafe` use.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/48989850/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/48989934",
    "html_url": "https://github.com/rust-lang/rust/pull/15326#issuecomment-48989934",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/15326",
    "id": 48989934,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ4OTg5OTM0",
    "user": {
      "login": "danburkert",
      "id": 160242,
      "node_id": "MDQ6VXNlcjE2MDI0Mg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/160242?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/danburkert",
      "html_url": "https://github.com/danburkert",
      "followers_url": "https://api.github.com/users/danburkert/followers",
      "following_url": "https://api.github.com/users/danburkert/following{/other_user}",
      "gists_url": "https://api.github.com/users/danburkert/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/danburkert/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/danburkert/subscriptions",
      "organizations_url": "https://api.github.com/users/danburkert/orgs",
      "repos_url": "https://api.github.com/users/danburkert/repos",
      "events_url": "https://api.github.com/users/danburkert/events{/privacy}",
      "received_events_url": "https://api.github.com/users/danburkert/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-07-15T04:41:26Z",
    "updated_at": "2014-07-15T04:41:26Z",
    "body": "@thestinger that is a great example- it shows that it is possible, but notice that every single method still uses `unsafe`.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/48989934/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/48990173",
    "html_url": "https://github.com/rust-lang/rust/pull/15326#issuecomment-48990173",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/15326",
    "id": 48990173,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ4OTkwMTcz",
    "user": {
      "login": "danburkert",
      "id": 160242,
      "node_id": "MDQ6VXNlcjE2MDI0Mg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/160242?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/danburkert",
      "html_url": "https://github.com/danburkert",
      "followers_url": "https://api.github.com/users/danburkert/followers",
      "following_url": "https://api.github.com/users/danburkert/following{/other_user}",
      "gists_url": "https://api.github.com/users/danburkert/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/danburkert/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/danburkert/subscriptions",
      "organizations_url": "https://api.github.com/users/danburkert/orgs",
      "repos_url": "https://api.github.com/users/danburkert/repos",
      "events_url": "https://api.github.com/users/danburkert/events{/privacy}",
      "received_events_url": "https://api.github.com/users/danburkert/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-07-15T04:47:11Z",
    "updated_at": "2014-07-15T04:47:26Z",
    "body": "Well to be perfectly correct, not _every_ method, but all of the interesting ones.  Also notice that in `grow`, `reserve` is called on the `Vec`.  This potentially copies every element in the `Vec` a single time.  After that, up to n/2 elements are copied elsewhere in the buffer in order to restore the ring invariants.  In the proposed implementation, each element is only copied once.  Note that this optimization could still be done if the underlying buffer were a `Vec`, it would just require a lot of unsafe, and not using the `Vec`'s resize methods.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/48990173/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/48990263",
    "html_url": "https://github.com/rust-lang/rust/pull/15326#issuecomment-48990263",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/15326",
    "id": 48990263,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ4OTkwMjYz",
    "user": {
      "login": "thestinger",
      "id": 1505226,
      "node_id": "MDQ6VXNlcjE1MDUyMjY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1505226?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/thestinger",
      "html_url": "https://github.com/thestinger",
      "followers_url": "https://api.github.com/users/thestinger/followers",
      "following_url": "https://api.github.com/users/thestinger/following{/other_user}",
      "gists_url": "https://api.github.com/users/thestinger/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/thestinger/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/thestinger/subscriptions",
      "organizations_url": "https://api.github.com/users/thestinger/orgs",
      "repos_url": "https://api.github.com/users/thestinger/repos",
      "events_url": "https://api.github.com/users/thestinger/events{/privacy}",
      "received_events_url": "https://api.github.com/users/thestinger/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-07-15T04:48:59Z",
    "updated_at": "2014-07-15T04:48:59Z",
    "body": "There's no unused field in the linked example.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/48990263/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/48990315",
    "html_url": "https://github.com/rust-lang/rust/pull/15326#issuecomment-48990315",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/15326",
    "id": 48990315,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ4OTkwMzE1",
    "user": {
      "login": "danburkert",
      "id": 160242,
      "node_id": "MDQ6VXNlcjE2MDI0Mg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/160242?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/danburkert",
      "html_url": "https://github.com/danburkert",
      "followers_url": "https://api.github.com/users/danburkert/followers",
      "following_url": "https://api.github.com/users/danburkert/following{/other_user}",
      "gists_url": "https://api.github.com/users/danburkert/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/danburkert/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/danburkert/subscriptions",
      "organizations_url": "https://api.github.com/users/danburkert/orgs",
      "repos_url": "https://api.github.com/users/danburkert/repos",
      "events_url": "https://api.github.com/users/danburkert/events{/privacy}",
      "received_events_url": "https://api.github.com/users/danburkert/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-07-15T04:49:59Z",
    "updated_at": "2014-07-15T04:50:46Z",
    "body": "`Vec` includes a `len` field, which the ringbuffer does not use.\n\nEdit: sorry for the edits, I keep submitting accidently.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/48990315/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/48990811",
    "html_url": "https://github.com/rust-lang/rust/pull/15326#issuecomment-48990811",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/15326",
    "id": 48990811,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ4OTkwODEx",
    "user": {
      "login": "danburkert",
      "id": 160242,
      "node_id": "MDQ6VXNlcjE2MDI0Mg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/160242?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/danburkert",
      "html_url": "https://github.com/danburkert",
      "followers_url": "https://api.github.com/users/danburkert/followers",
      "following_url": "https://api.github.com/users/danburkert/following{/other_user}",
      "gists_url": "https://api.github.com/users/danburkert/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/danburkert/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/danburkert/subscriptions",
      "organizations_url": "https://api.github.com/users/danburkert/orgs",
      "repos_url": "https://api.github.com/users/danburkert/repos",
      "events_url": "https://api.github.com/users/danburkert/events{/privacy}",
      "received_events_url": "https://api.github.com/users/danburkert/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-07-15T05:01:04Z",
    "updated_at": "2014-07-15T05:06:18Z",
    "body": "@thestinger is the linked deque used anywhere?  It calls `self.elts.as_slice()` in many places, but no where I can find does it set the length of `elts` to the capacity, which I think would mean that `as_slice` would always return a 0 length slice.  Could easily be misunderstanding the implementation, though.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/48990811/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/48991126",
    "html_url": "https://github.com/rust-lang/rust/pull/15326#issuecomment-48991126",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/15326",
    "id": 48991126,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ4OTkxMTI2",
    "user": {
      "login": "thestinger",
      "id": 1505226,
      "node_id": "MDQ6VXNlcjE1MDUyMjY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1505226?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/thestinger",
      "html_url": "https://github.com/thestinger",
      "followers_url": "https://api.github.com/users/thestinger/followers",
      "following_url": "https://api.github.com/users/thestinger/following{/other_user}",
      "gists_url": "https://api.github.com/users/thestinger/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/thestinger/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/thestinger/subscriptions",
      "organizations_url": "https://api.github.com/users/thestinger/orgs",
      "repos_url": "https://api.github.com/users/thestinger/repos",
      "events_url": "https://api.github.com/users/thestinger/events{/privacy}",
      "received_events_url": "https://api.github.com/users/thestinger/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-07-15T05:08:01Z",
    "updated_at": "2014-07-15T05:08:01Z",
    "body": "It can use the field in `Vec` to store the length of the queue. It turns out that the version in rust-core is older than the one I have locally and didn't have that optimization. Sorry for the confusion.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/48991126/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/48991366",
    "html_url": "https://github.com/rust-lang/rust/pull/15326#issuecomment-48991366",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/15326",
    "id": 48991366,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ4OTkxMzY2",
    "user": {
      "login": "danburkert",
      "id": 160242,
      "node_id": "MDQ6VXNlcjE2MDI0Mg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/160242?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/danburkert",
      "html_url": "https://github.com/danburkert",
      "followers_url": "https://api.github.com/users/danburkert/followers",
      "following_url": "https://api.github.com/users/danburkert/following{/other_user}",
      "gists_url": "https://api.github.com/users/danburkert/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/danburkert/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/danburkert/subscriptions",
      "organizations_url": "https://api.github.com/users/danburkert/orgs",
      "repos_url": "https://api.github.com/users/danburkert/repos",
      "events_url": "https://api.github.com/users/danburkert/events{/privacy}",
      "received_events_url": "https://api.github.com/users/danburkert/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-07-15T05:13:18Z",
    "updated_at": "2014-07-15T05:13:18Z",
    "body": "Yes, but then calling `as_slice` gives you something less than the full buffer, so you have to fall back to using raw pointers and offsetting, hence more `unsafe`.  I don't think we are disagreeing, we are just trying to prove different points :)\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/48991366/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/50291698",
    "html_url": "https://github.com/rust-lang/rust/pull/15326#issuecomment-50291698",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/15326",
    "id": 50291698,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUwMjkxNjk4",
    "user": {
      "login": "danburkert",
      "id": 160242,
      "node_id": "MDQ6VXNlcjE2MDI0Mg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/160242?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/danburkert",
      "html_url": "https://github.com/danburkert",
      "followers_url": "https://api.github.com/users/danburkert/followers",
      "following_url": "https://api.github.com/users/danburkert/following{/other_user}",
      "gists_url": "https://api.github.com/users/danburkert/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/danburkert/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/danburkert/subscriptions",
      "organizations_url": "https://api.github.com/users/danburkert/orgs",
      "repos_url": "https://api.github.com/users/danburkert/repos",
      "events_url": "https://api.github.com/users/danburkert/events{/privacy}",
      "received_events_url": "https://api.github.com/users/danburkert/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-07-28T00:51:53Z",
    "updated_at": "2014-07-28T00:51:53Z",
    "body": "@blake2-ppc my intuition is that the unsafe version of the move iterator would be faster because it doesn't do a bounds check every time next() is called, but it turns out it is slightly slower.  I can't really explain this, but I don't have any experience reading llvm IR.  You can check out the benchmarks [here](https://github.com/danburkert/rust-ringbuf/commit/778f95cd28db58431a55bc351802e972d65061bf).  Accordingly, I've updated the implementation to a safe version with no destructor.\n\nI updated the review today to keep it in line with the changes that have been made in rustc (most notably implementing hash, and the `MutableSeq` change).  I also changed the organization of the code to keep it as close as possible to the current RingBuf (before it was organized to keep it similar to Vec).  Additionally, there is one more method added, the unsafe `set_len`, which does exactly as it does for `Vec`.\n\nI would appreciate some feedback about whether this is likely to be merged.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/50291698/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/52591151",
    "html_url": "https://github.com/rust-lang/rust/pull/15326#issuecomment-52591151",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/15326",
    "id": 52591151,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUyNTkxMTUx",
    "user": {
      "login": "alexcrichton",
      "id": 64996,
      "node_id": "MDQ6VXNlcjY0OTk2",
      "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alexcrichton",
      "html_url": "https://github.com/alexcrichton",
      "followers_url": "https://api.github.com/users/alexcrichton/followers",
      "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}",
      "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions",
      "organizations_url": "https://api.github.com/users/alexcrichton/orgs",
      "repos_url": "https://api.github.com/users/alexcrichton/repos",
      "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alexcrichton/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-08-19T05:10:13Z",
    "updated_at": "2014-08-19T05:10:13Z",
    "body": "Closing due to inactivity, but feel free to reopen with a rebase!\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/52591151/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/52592068",
    "html_url": "https://github.com/rust-lang/rust/pull/15326#issuecomment-52592068",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/15326",
    "id": 52592068,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUyNTkyMDY4",
    "user": {
      "login": "danburkert",
      "id": 160242,
      "node_id": "MDQ6VXNlcjE2MDI0Mg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/160242?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/danburkert",
      "html_url": "https://github.com/danburkert",
      "followers_url": "https://api.github.com/users/danburkert/followers",
      "following_url": "https://api.github.com/users/danburkert/following{/other_user}",
      "gists_url": "https://api.github.com/users/danburkert/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/danburkert/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/danburkert/subscriptions",
      "organizations_url": "https://api.github.com/users/danburkert/orgs",
      "repos_url": "https://api.github.com/users/danburkert/repos",
      "events_url": "https://api.github.com/users/danburkert/events{/privacy}",
      "received_events_url": "https://api.github.com/users/danburkert/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-08-19T05:29:25Z",
    "updated_at": "2014-08-19T05:29:25Z",
    "body": "If I rebase will this move forward?  I rebased at the end of last month and specifically asked if this was likely to get merged.  I am willing to keep rebasing (and certainly willing to continue responding to comments), but not without some indication that it will eventually be merged.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/52592068/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/52592906",
    "html_url": "https://github.com/rust-lang/rust/pull/15326#issuecomment-52592906",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/15326",
    "id": 52592906,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUyNTkyOTA2",
    "user": {
      "login": "alexcrichton",
      "id": 64996,
      "node_id": "MDQ6VXNlcjY0OTk2",
      "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alexcrichton",
      "html_url": "https://github.com/alexcrichton",
      "followers_url": "https://api.github.com/users/alexcrichton/followers",
      "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}",
      "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions",
      "organizations_url": "https://api.github.com/users/alexcrichton/orgs",
      "repos_url": "https://api.github.com/users/alexcrichton/repos",
      "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alexcrichton/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-08-19T05:46:40Z",
    "updated_at": "2014-08-19T05:46:40Z",
    "body": "I generally just close PRs that have had > 10 days of no activity, but I suspect that this has a higher chance of being merged if it's a little fresher than that.\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/52592906/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
