[
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/4031287",
    "html_url": "https://github.com/rust-lang/rust/issues/1861#issuecomment-4031287",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/1861",
    "id": 4031287,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQwMzEyODc=",
    "user": {
      "login": "brson",
      "id": 147214,
      "node_id": "MDQ6VXNlcjE0NzIxNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/brson",
      "html_url": "https://github.com/brson",
      "followers_url": "https://api.github.com/users/brson/followers",
      "following_url": "https://api.github.com/users/brson/following{/other_user}",
      "gists_url": "https://api.github.com/users/brson/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/brson/subscriptions",
      "organizations_url": "https://api.github.com/users/brson/orgs",
      "repos_url": "https://api.github.com/users/brson/repos",
      "events_url": "https://api.github.com/users/brson/events{/privacy}",
      "received_events_url": "https://api.github.com/users/brson/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2012-02-18T02:09:02Z",
    "updated_at": "2012-02-18T02:09:02Z",
    "body": "My impression is that for compiling rust code we kind of want to avoid having cargo delegate to other build systems (cargo should just build the crates). For complex non-rust components I suppose something like this is inevitable. Do you need this much flexibility currently for the leveldb bindings?\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/4031287/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/4046619",
    "html_url": "https://github.com/rust-lang/rust/issues/1861#issuecomment-4046619",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/1861",
    "id": 4046619,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQwNDY2MTk=",
    "user": {
      "login": "thoughtpolice",
      "id": 3416,
      "node_id": "MDQ6VXNlcjM0MTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3416?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/thoughtpolice",
      "html_url": "https://github.com/thoughtpolice",
      "followers_url": "https://api.github.com/users/thoughtpolice/followers",
      "following_url": "https://api.github.com/users/thoughtpolice/following{/other_user}",
      "gists_url": "https://api.github.com/users/thoughtpolice/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/thoughtpolice/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/thoughtpolice/subscriptions",
      "organizations_url": "https://api.github.com/users/thoughtpolice/orgs",
      "repos_url": "https://api.github.com/users/thoughtpolice/repos",
      "events_url": "https://api.github.com/users/thoughtpolice/events{/privacy}",
      "received_events_url": "https://api.github.com/users/thoughtpolice/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2012-02-20T00:11:10Z",
    "updated_at": "2012-02-20T00:19:07Z",
    "body": "Most of the source code could probably be put into crate attributes with `#[cfg]` and the hypothetical `#[external]` a la #1862. The _required_ components are mostly just that I can pass correct options to the C compiler, depending on the platform. That's all doable providing #1862 is implemented, and I could get bindings coming along quickly.\n\nThe main thing I would like to support, that this scheme allows, is configuration based logic before the build. LevelDB has optional snappy support for compressing blocks that hit the disk; I would _like_ to be able to detect a `snappy.h` and `libsnappy`, and, provided they exist, compile LevelDB with snappy support, and add a `link_args` attr to the crate, saying \"also link with libsnappy when building.\"\n\nSomething like this can easily be supported with the above framework, but it does need a feature like #612 as well (because the configure logic needs to give some extra crate attrs.) It's _not_ required, but it's nice to enable; especially as compression can regularly offset the I/O required for disk writes/reads enough to make a noticeable improvement, in my experience.\n\nPerhaps the scope here can be narrowed, to only encompass configuration logic for Cargo? I will say something like this is rather inevitable IMO, when you want to integrate a more complicated build scheme into Cargo packages - but of course an issue like this is also an issue of cost analysis - it's potentially not worth adding all this if we only have 1 or 2 packages (mine) using part of this infrastructure for like, the next year or however long. And when others come along, maybe it still won't be sufficient for them, or it'll just be terrible. ;)\n\nI'm more than willing to narrow down the scope here. An issue like this brings into question a lot of cargo's responsibilities/expected workflow, so please - tell me what you think. :)\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/4046619/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/4099168",
    "html_url": "https://github.com/rust-lang/rust/issues/1861#issuecomment-4099168",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/1861",
    "id": 4099168,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQwOTkxNjg=",
    "user": {
      "login": "brson",
      "id": 147214,
      "node_id": "MDQ6VXNlcjE0NzIxNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/brson",
      "html_url": "https://github.com/brson",
      "followers_url": "https://api.github.com/users/brson/followers",
      "following_url": "https://api.github.com/users/brson/following{/other_user}",
      "gists_url": "https://api.github.com/users/brson/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/brson/subscriptions",
      "organizations_url": "https://api.github.com/users/brson/orgs",
      "repos_url": "https://api.github.com/users/brson/repos",
      "events_url": "https://api.github.com/users/brson/events{/privacy}",
      "received_events_url": "https://api.github.com/users/brson/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2012-02-22T06:49:14Z",
    "updated_at": "2012-02-22T06:49:14Z",
    "body": "I do think we should add the minimum necessary to support current use cases, particularly because I just don't know much about how to properly design a package manager, nor build system (and I'm not sure exactly which cargo is). Maybe we can investigate what npm, cabal etc. do to support foreign code. I completely agree that something is necessary here. I'm a little scared of screwing this up, but I guess we can afford to make some mistakes here.\n\nWe need to get graydon's buy-in before expanding cargo in this direction. I believe he as expressed strong opinions about not executing arbitrary build scripts before.\n\nI realize this is extremely non-committal and I'm sorry.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/4099168/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/4099331",
    "html_url": "https://github.com/rust-lang/rust/issues/1861#issuecomment-4099331",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/1861",
    "id": 4099331,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQwOTkzMzE=",
    "user": {
      "login": "brson",
      "id": 147214,
      "node_id": "MDQ6VXNlcjE0NzIxNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/brson",
      "html_url": "https://github.com/brson",
      "followers_url": "https://api.github.com/users/brson/followers",
      "following_url": "https://api.github.com/users/brson/following{/other_user}",
      "gists_url": "https://api.github.com/users/brson/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/brson/subscriptions",
      "organizations_url": "https://api.github.com/users/brson/orgs",
      "repos_url": "https://api.github.com/users/brson/repos",
      "events_url": "https://api.github.com/users/brson/events{/privacy}",
      "received_events_url": "https://api.github.com/users/brson/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2012-02-22T07:06:02Z",
    "updated_at": "2012-02-22T07:06:02Z",
    "body": "I'm ok trying the design you suggest with cargo delegating to a script. There's no reason to hold this up if you need the feature now.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/4099331/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/4100752",
    "html_url": "https://github.com/rust-lang/rust/issues/1861#issuecomment-4100752",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/1861",
    "id": 4100752,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQxMDA3NTI=",
    "user": {
      "login": "graydon",
      "id": 14097,
      "node_id": "MDQ6VXNlcjE0MDk3",
      "avatar_url": "https://avatars.githubusercontent.com/u/14097?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/graydon",
      "html_url": "https://github.com/graydon",
      "followers_url": "https://api.github.com/users/graydon/followers",
      "following_url": "https://api.github.com/users/graydon/following{/other_user}",
      "gists_url": "https://api.github.com/users/graydon/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/graydon/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/graydon/subscriptions",
      "organizations_url": "https://api.github.com/users/graydon/orgs",
      "repos_url": "https://api.github.com/users/graydon/repos",
      "events_url": "https://api.github.com/users/graydon/events{/privacy}",
      "received_events_url": "https://api.github.com/users/graydon/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2012-02-22T09:28:17Z",
    "updated_at": "2012-02-22T09:28:17Z",
    "body": "Hi,\n\nI'm going to ask for a little bit of care and patience finding the right balance on this issue. Not to say that you shouldn't experiment -- please do! -- but I think that finding a \"right\" point that satisfies the various conflicting tensions in this design space is going to take a few iterations.\n\nWith that in mind, my general preferences are:\n- Declarative over procedural. That is, `#[cfg]` and such as much as we can, until it is really getting silly.\n- Searching for header files is not silly. It's a very sensible thing to do.\n- Querying pkgconfig or its ilk is not silly. It's built for this sort of task.\n- Passing `-D` defines through to compilers, likewise.\n- In both cases, the more declarative (the less you're just passing opaque strings to shells) the more likely we can adapt to multiple toolchains.\n- A good criterion for \"declarative enough\" is \"all cargo packages build on all 3 tier-1 operating systems, and those that do not, only because some dependent library in question isn't really available on that platform, and we'd have to be teaching cargo to build the entire dependency as well\". If we have a bunch of packages where the library requirements can all be met, but cargo fails to build a rust package on that platform (especially windows) due to \"bad configuration logic\", we're not declarative enough.\n- A _definite_ criterion for \"silly\" when considering how far to stretch the declarative system is \"turing-complete\". That is, If a \"declarative\" scheme provides a way of expressing non-terminating loops or defining callable functions, it's gone too far and should have just bottomed out in a trap door to real procedural code.\n- **_Note**_: that trap door should, itself, probably be a rust file, not \"some script we try to run via shebang\".\n- There is a reason for this!\n- The common denominator for \"invoking a command\" is actually a lot less useful than you imagine. The set of commands in common between a stock win32 development system (with powershell and visual studio, but not including msys since we want to eventually shed that dependency) and a stock linux system is nearly empty. That's important. It means \"invoking a script we ship\" will cause the package manager to force msys on everyone. And probably python as well, because seriously who wants to write autoconf in 2012? Now your build-deps have gone up a lot.\n- If you consider the analogy with homebrew further, you'll see what's going on here. Homebrew _knows_ it's on OSX and has ruby, so \"invoke a command\" will (a) definitely work and (b) probably has access to a ton of useful tools for doing builds already. The only analogous thing we _know_ we're going to have kicking around is a rust compiler with the rust standard library. We start from there. So don't shell out to shell; shell out to \"compile this bit of procedural rust logic and run it\". Best part, it can call into the same stdlib for sniffing around its environment that cargo was calling into. It's very likely that the user can express \"a build process that goes beyond declarative\" in plain rust-that-uses-stdlib code, and do so portably. If the user is just _desperate_ for some shell commands, they can put in a call to `std::run_command` and in so doing make themselves a whole lot less portable. But I don't want it to be the first hammer anyone reaches for. It's a hammer that's got \"nonportable extra build dependencies\" written on it in fine print.\n- About that fine print: as was pointed out on the mailing list the other day, we're \"reinventing\" a bunch of pieces that other building and package-management systems already have. We don't want to reinvent too much. We _will_ need, at some point, to do version-range calculation and dependency sorting, both between cargo packages and packages-outside-cargo. But: if you find yourself re-expressing, in cargo-ese, the configuration and build logic for some C package that already _has_ its own configuration and build logic, you're _probably_ making a mistake, have gone too far. Not absolutely certain -- some C code will sometimes call for packaging by copying-and-integrating into a cargo-managed tree -- but that's the boundary where you should be thinking carefully about whether to shell out to `apt` or `yum` to get a prebuilt C library in binary form, and/or fail with `sorry, I don't know how to retrieve libfoo on this platform`.\n\nYou are probably going to block, here, on conditionalizing attribute processing, supporting some kind of read/write or read/rebind access to the dictionary of configuration-time variables, as well as adding some fresh attributes for new tasks. You are not the only one. I am somewhat blocked on it too and @dylanlukes is poking around at it as well. I'd welcome coherent work in this space. We need a \"grammar\" relating conditionals, variables, and attributes. There's a sketch @dylanlukes wrote over in https://github.com/mozilla/rust/wiki/Proposal-for-attribute-preprocessing and a bug #1242 that talks about this, and he put up a gist the other day as a result of a conversation we had on IRC, but I'm having trouble tracking it down.\n\nTalk some with him, or catch me on IRC tomorrow, I'd like to see more of this stuff come into focus soon. It's important if I keep saying \"use attributes!\" for there to _be_ some credible system for expressing more complex logic in attributes.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/4100752/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/4101895",
    "html_url": "https://github.com/rust-lang/rust/issues/1861#issuecomment-4101895",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/1861",
    "id": 4101895,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQxMDE4OTU=",
    "user": {
      "login": "DylanLukes",
      "id": 250114,
      "node_id": "MDQ6VXNlcjI1MDExNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/250114?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/DylanLukes",
      "html_url": "https://github.com/DylanLukes",
      "followers_url": "https://api.github.com/users/DylanLukes/followers",
      "following_url": "https://api.github.com/users/DylanLukes/following{/other_user}",
      "gists_url": "https://api.github.com/users/DylanLukes/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/DylanLukes/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/DylanLukes/subscriptions",
      "organizations_url": "https://api.github.com/users/DylanLukes/orgs",
      "repos_url": "https://api.github.com/users/DylanLukes/repos",
      "events_url": "https://api.github.com/users/DylanLukes/events{/privacy}",
      "received_events_url": "https://api.github.com/users/DylanLukes/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2012-02-22T10:59:32Z",
    "updated_at": "2012-02-22T10:59:32Z",
    "body": "That proposal is very out of date... I'll TRY to have a new one with my new design up today sometime between 11:20 and 12:07.\n\nIf not, I should manage by the end of the day. \n\nIt'll be easier to discuss with something relatively concrete in place.\n",
    "author_association": "NONE",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/4101895/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/13659263",
    "html_url": "https://github.com/rust-lang/rust/issues/1861#issuecomment-13659263",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/1861",
    "id": 13659263,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEzNjU5MjYz",
    "user": {
      "login": "z0w0",
      "id": 676417,
      "node_id": "MDQ6VXNlcjY3NjQxNw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/676417?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/z0w0",
      "html_url": "https://github.com/z0w0",
      "followers_url": "https://api.github.com/users/z0w0/followers",
      "following_url": "https://api.github.com/users/z0w0/following{/other_user}",
      "gists_url": "https://api.github.com/users/z0w0/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/z0w0/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/z0w0/subscriptions",
      "organizations_url": "https://api.github.com/users/z0w0/orgs",
      "repos_url": "https://api.github.com/users/z0w0/repos",
      "events_url": "https://api.github.com/users/z0w0/events{/privacy}",
      "received_events_url": "https://api.github.com/users/z0w0/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2013-02-16T17:09:19Z",
    "updated_at": "2013-02-16T17:09:19Z",
    "body": "This can probably be closed now.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/13659263/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/13675283",
    "html_url": "https://github.com/rust-lang/rust/issues/1861#issuecomment-13675283",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/1861",
    "id": 13675283,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEzNjc1Mjgz",
    "user": {
      "login": "catamorphism",
      "id": 427212,
      "node_id": "MDQ6VXNlcjQyNzIxMg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/427212?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/catamorphism",
      "html_url": "https://github.com/catamorphism",
      "followers_url": "https://api.github.com/users/catamorphism/followers",
      "following_url": "https://api.github.com/users/catamorphism/following{/other_user}",
      "gists_url": "https://api.github.com/users/catamorphism/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/catamorphism/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/catamorphism/subscriptions",
      "organizations_url": "https://api.github.com/users/catamorphism/orgs",
      "repos_url": "https://api.github.com/users/catamorphism/repos",
      "events_url": "https://api.github.com/users/catamorphism/events{/privacy}",
      "received_events_url": "https://api.github.com/users/catamorphism/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2013-02-16T21:30:39Z",
    "updated_at": "2013-02-16T21:30:39Z",
    "body": "Closing as obsolete.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/13675283/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
