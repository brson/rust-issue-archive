[
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/178741678",
    "html_url": "https://github.com/rust-lang/rust/issues/14007#issuecomment-178741678",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/14007",
    "id": 178741678,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE3ODc0MTY3OA==",
    "user": {
      "login": "steveklabnik",
      "id": 27786,
      "node_id": "MDQ6VXNlcjI3Nzg2",
      "avatar_url": "https://avatars.githubusercontent.com/u/27786?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/steveklabnik",
      "html_url": "https://github.com/steveklabnik",
      "followers_url": "https://api.github.com/users/steveklabnik/followers",
      "following_url": "https://api.github.com/users/steveklabnik/following{/other_user}",
      "gists_url": "https://api.github.com/users/steveklabnik/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/steveklabnik/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/steveklabnik/subscriptions",
      "organizations_url": "https://api.github.com/users/steveklabnik/orgs",
      "repos_url": "https://api.github.com/users/steveklabnik/repos",
      "events_url": "https://api.github.com/users/steveklabnik/events{/privacy}",
      "received_events_url": "https://api.github.com/users/steveklabnik/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2016-02-02T18:29:26Z",
    "updated_at": "2016-02-02T18:29:26Z",
    "body": "Updated code:\n\n```\nuse std::collections::BTreeMap;\n\nfn main() {\n    let mut a = BTreeMap::new();\n    a.insert(0, 1);\n    a.insert(0, \"foo\");\n}\n```\n\nError\n\n```\n expected `_`,\n    found `&'static str`\n(expected integral variable,\n    found &-ptr) [E0308]\nhello.rs:6     a.insert(0, \"foo\");\n                           ^~~~~\n```\n\nIt still does not point to `insert(0, 1)`.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/178741678/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/401523418",
    "html_url": "https://github.com/rust-lang/rust/issues/14007#issuecomment-401523418",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/14007",
    "id": 401523418,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQwMTUyMzQxOA==",
    "user": {
      "login": "Havvy",
      "id": 731722,
      "node_id": "MDQ6VXNlcjczMTcyMg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/731722?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Havvy",
      "html_url": "https://github.com/Havvy",
      "followers_url": "https://api.github.com/users/Havvy/followers",
      "following_url": "https://api.github.com/users/Havvy/following{/other_user}",
      "gists_url": "https://api.github.com/users/Havvy/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Havvy/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Havvy/subscriptions",
      "organizations_url": "https://api.github.com/users/Havvy/orgs",
      "repos_url": "https://api.github.com/users/Havvy/repos",
      "events_url": "https://api.github.com/users/Havvy/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Havvy/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2018-06-30T07:20:47Z",
    "updated_at": "2018-06-30T07:20:47Z",
    "body": "Triage: No change.",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/401523418/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/873975672",
    "html_url": "https://github.com/rust-lang/rust/issues/14007#issuecomment-873975672",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/14007",
    "id": 873975672,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg3Mzk3NTY3Mg==",
    "user": {
      "login": "rylev",
      "id": 1327285,
      "node_id": "MDQ6VXNlcjEzMjcyODU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1327285?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/rylev",
      "html_url": "https://github.com/rylev",
      "followers_url": "https://api.github.com/users/rylev/followers",
      "following_url": "https://api.github.com/users/rylev/following{/other_user}",
      "gists_url": "https://api.github.com/users/rylev/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/rylev/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/rylev/subscriptions",
      "organizations_url": "https://api.github.com/users/rylev/orgs",
      "repos_url": "https://api.github.com/users/rylev/repos",
      "events_url": "https://api.github.com/users/rylev/events{/privacy}",
      "received_events_url": "https://api.github.com/users/rylev/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2021-07-05T09:52:26Z",
    "updated_at": "2021-07-05T09:52:26Z",
    "body": "Triage: the error message has improved but still does not point to the source of the expectation [(playground)](https://play.rust-lang.org/?version=stable&mode=debug&edition=2018&gist=856bbd8205c502a349bb7b5ccebfc185).\r\n\r\n```\r\nerror[E0308]: mismatched types\r\n --> src/main.rs:6:17\r\n  |\r\n6 |     a.insert(0, \"foo\");\r\n  |                 ^^^^^ expected integer, found `&str`\r\n\r\nerror: aborting due to previous error\r\n```",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/873975672/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/881880367",
    "html_url": "https://github.com/rust-lang/rust/issues/14007#issuecomment-881880367",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/14007",
    "id": 881880367,
    "node_id": "IC_kwDOAAsO6M40kG0v",
    "user": {
      "login": "oli-obk",
      "id": 332036,
      "node_id": "MDQ6VXNlcjMzMjAzNg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/332036?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/oli-obk",
      "html_url": "https://github.com/oli-obk",
      "followers_url": "https://api.github.com/users/oli-obk/followers",
      "following_url": "https://api.github.com/users/oli-obk/following{/other_user}",
      "gists_url": "https://api.github.com/users/oli-obk/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/oli-obk/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/oli-obk/subscriptions",
      "organizations_url": "https://api.github.com/users/oli-obk/orgs",
      "repos_url": "https://api.github.com/users/oli-obk/repos",
      "events_url": "https://api.github.com/users/oli-obk/events{/privacy}",
      "received_events_url": "https://api.github.com/users/oli-obk/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2021-07-17T11:20:54Z",
    "updated_at": "2021-07-17T11:20:54Z",
    "body": "We could probably add a Map<InferTy, Span> to InferCtxt and look at it whenever we encounter an error during inference. Though we may want to look at something that also works for concrete types, showing us where the type came from for all type mismatch errors.",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/881880367/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/882042180",
    "html_url": "https://github.com/rust-lang/rust/issues/14007#issuecomment-882042180",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/14007",
    "id": 882042180,
    "node_id": "IC_kwDOAAsO6M40kuVE",
    "user": {
      "login": "eddyb",
      "id": 77424,
      "node_id": "MDQ6VXNlcjc3NDI0",
      "avatar_url": "https://avatars.githubusercontent.com/u/77424?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/eddyb",
      "html_url": "https://github.com/eddyb",
      "followers_url": "https://api.github.com/users/eddyb/followers",
      "following_url": "https://api.github.com/users/eddyb/following{/other_user}",
      "gists_url": "https://api.github.com/users/eddyb/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/eddyb/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/eddyb/subscriptions",
      "organizations_url": "https://api.github.com/users/eddyb/orgs",
      "repos_url": "https://api.github.com/users/eddyb/repos",
      "events_url": "https://api.github.com/users/eddyb/events{/privacy}",
      "received_events_url": "https://api.github.com/users/eddyb/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2021-07-18T11:28:44Z",
    "updated_at": "2021-07-18T11:28:44Z",
    "body": "@oli-obk That effectively already exists, and is called the \"origin\" of the inference variable, and is already used by diagnostics.\r\nWhat might be missing is more fine-grained/details \"origins\" and diagnostic logic to use them.",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/882042180/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/882042629",
    "html_url": "https://github.com/rust-lang/rust/issues/14007#issuecomment-882042629",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/14007",
    "id": 882042629,
    "node_id": "IC_kwDOAAsO6M40kucF",
    "user": {
      "login": "eddyb",
      "id": 77424,
      "node_id": "MDQ6VXNlcjc3NDI0",
      "avatar_url": "https://avatars.githubusercontent.com/u/77424?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/eddyb",
      "html_url": "https://github.com/eddyb",
      "followers_url": "https://api.github.com/users/eddyb/followers",
      "following_url": "https://api.github.com/users/eddyb/following{/other_user}",
      "gists_url": "https://api.github.com/users/eddyb/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/eddyb/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/eddyb/subscriptions",
      "organizations_url": "https://api.github.com/users/eddyb/orgs",
      "repos_url": "https://api.github.com/users/eddyb/repos",
      "events_url": "https://api.github.com/users/eddyb/events{/privacy}",
      "received_events_url": "https://api.github.com/users/eddyb/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2021-07-18T11:33:07Z",
    "updated_at": "2021-07-18T11:33:07Z",
    "body": "However, what's *really* lacking (and for good reasons - i.e. performance), is a \"log\" of unifications - you may end up with an inference variable, but have no clue as to what else it got unified with, on your way there.\r\n\r\nIMO the way to have our cake and eat it too would be to add a generic parameter to `InferCtxt` and the typeck contexts that use it, that decides whether this is a \"fast / inference-only\" context, or a \"slow / diagnostic-enabled\" context - that way, any information used *only* for diagnostics, doesn't even have to be tracked until an error is observed (and the \"fast / inference-only\" typeck attempt aborted).",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/882042629/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/1371591822",
    "html_url": "https://github.com/rust-lang/rust/issues/14007#issuecomment-1371591822",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/14007",
    "id": 1371591822,
    "node_id": "IC_kwDOAAsO6M5RwNSO",
    "user": {
      "login": "estebank",
      "id": 1606434,
      "node_id": "MDQ6VXNlcjE2MDY0MzQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1606434?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/estebank",
      "html_url": "https://github.com/estebank",
      "followers_url": "https://api.github.com/users/estebank/followers",
      "following_url": "https://api.github.com/users/estebank/following{/other_user}",
      "gists_url": "https://api.github.com/users/estebank/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/estebank/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/estebank/subscriptions",
      "organizations_url": "https://api.github.com/users/estebank/orgs",
      "repos_url": "https://api.github.com/users/estebank/repos",
      "events_url": "https://api.github.com/users/estebank/events{/privacy}",
      "received_events_url": "https://api.github.com/users/estebank/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2023-01-05T00:39:25Z",
    "updated_at": "2023-01-05T00:41:35Z",
    "body": "@eddyb you might be interested in looking at the giant hack in https://github.com/rust-lang/rust/pull/106400, which relies exclusively on the HIR to find the expression where an expected type was inferred.\r\n\r\n```\r\nerror[E0308]: mismatched types\r\n    --> src/test/ui/type/type-check/point-at-inference-3.rs:7:12\r\n     |\r\n4    |     v.push(0i32);\r\n     |            ---- this is of type `i32`, which makes `v` to be inferred as `Vec<i32>`\r\n...\r\n7    |     v.push(1u32); //~ ERROR mismatched types\r\n     |       ---- ^^^^ expected `i32`, found `u32`\r\n     |       |\r\n     |       arguments to this function are incorrect\r\n     |\r\nnote: associated function defined here\r\n    --> /home/gh-estebank/rust/library/alloc/src/vec/mod.rs:1831:12\r\n     |\r\n1831 |     pub fn push(&mut self, value: T) {\r\n     |            ^^^^\r\nhelp: change the type of the numeric literal from `u32` to `i32`\r\n     |\r\n7    |     v.push(1i32); //~ ERROR mismatched types\r\n     |             ~~~\r\n```\r\n\r\nFor the updated example in the first comment:\r\n\r\n```\r\nerror[E0308]: mismatched types\r\n   --> f.rs:6:17\r\n    |\r\n5   |     a.insert(0, 1);\r\n    |              -  - this is of type `{integer}`, which makes `a` to be inferred as `BTreeMap<{integer}, {integer}>`\r\n    |              |\r\n    |              this is of type `{integer}`, which makes `a` to be inferred as `BTreeMap<{integer}, {integer}>`\r\n6   |     a.insert(0, \"foo\");\r\n    |       ------    ^^^^^ expected integer, found `&str`\r\n    |       |\r\n    |       arguments to this function are incorrect\r\n    |\r\nnote: associated function defined here\r\n   --> /home/gh-estebank/rust/library/alloc/src/collections/btree/map.rs:955:12\r\n    |\r\n955 |     pub fn insert(&mut self, key: K, value: V) -> Option<V>\r\n    |            ^^^^^^\r\n```",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/1371591822/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
