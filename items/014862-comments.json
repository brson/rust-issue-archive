[
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/45962255",
    "html_url": "https://github.com/rust-lang/rust/pull/14862#issuecomment-45962255",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/14862",
    "id": 45962255,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ1OTYyMjU1",
    "user": {
      "login": "huonw",
      "id": 1203825,
      "node_id": "MDQ6VXNlcjEyMDM4MjU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1203825?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/huonw",
      "html_url": "https://github.com/huonw",
      "followers_url": "https://api.github.com/users/huonw/followers",
      "following_url": "https://api.github.com/users/huonw/following{/other_user}",
      "gists_url": "https://api.github.com/users/huonw/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/huonw/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/huonw/subscriptions",
      "organizations_url": "https://api.github.com/users/huonw/orgs",
      "repos_url": "https://api.github.com/users/huonw/repos",
      "events_url": "https://api.github.com/users/huonw/events{/privacy}",
      "received_events_url": "https://api.github.com/users/huonw/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-06-12T23:56:35Z",
    "updated_at": "2014-06-12T23:56:35Z",
    "body": "> As a consequence of this change, this code is not permitted:\n\n_now_ permitted?\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/45962255/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/45963774",
    "html_url": "https://github.com/rust-lang/rust/pull/14862#issuecomment-45963774",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/14862",
    "id": 45963774,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ1OTYzNzc0",
    "user": {
      "login": "alexcrichton",
      "id": 64996,
      "node_id": "MDQ6VXNlcjY0OTk2",
      "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alexcrichton",
      "html_url": "https://github.com/alexcrichton",
      "followers_url": "https://api.github.com/users/alexcrichton/followers",
      "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}",
      "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions",
      "organizations_url": "https://api.github.com/users/alexcrichton/orgs",
      "repos_url": "https://api.github.com/users/alexcrichton/repos",
      "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alexcrichton/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-06-13T00:23:21Z",
    "updated_at": "2014-06-13T00:23:21Z",
    "body": "Indeed!\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/45963774/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/47486025",
    "html_url": "https://github.com/rust-lang/rust/pull/14862#issuecomment-47486025",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/14862",
    "id": 47486025,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ3NDg2MDI1",
    "user": {
      "login": "alexcrichton",
      "id": 64996,
      "node_id": "MDQ6VXNlcjY0OTk2",
      "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alexcrichton",
      "html_url": "https://github.com/alexcrichton",
      "followers_url": "https://api.github.com/users/alexcrichton/followers",
      "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}",
      "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions",
      "organizations_url": "https://api.github.com/users/alexcrichton/orgs",
      "repos_url": "https://api.github.com/users/alexcrichton/repos",
      "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alexcrichton/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-06-30T00:24:37Z",
    "updated_at": "2014-06-30T00:24:37Z",
    "body": "r? @pnkfelix\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/47486025/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/48137476",
    "html_url": "https://github.com/rust-lang/rust/pull/14862#issuecomment-48137476",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/14862",
    "id": 48137476,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ4MTM3NDc2",
    "user": {
      "login": "huonw",
      "id": 1203825,
      "node_id": "MDQ6VXNlcjEyMDM4MjU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1203825?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/huonw",
      "html_url": "https://github.com/huonw",
      "followers_url": "https://api.github.com/users/huonw/followers",
      "following_url": "https://api.github.com/users/huonw/following{/other_user}",
      "gists_url": "https://api.github.com/users/huonw/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/huonw/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/huonw/subscriptions",
      "organizations_url": "https://api.github.com/users/huonw/orgs",
      "repos_url": "https://api.github.com/users/huonw/repos",
      "events_url": "https://api.github.com/users/huonw/events{/privacy}",
      "received_events_url": "https://api.github.com/users/huonw/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-07-07T03:08:45Z",
    "updated_at": "2014-07-07T03:08:53Z",
    "body": "Ping, r? @pnkfelix \n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/48137476/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/48424521",
    "html_url": "https://github.com/rust-lang/rust/pull/14862#issuecomment-48424521",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/14862",
    "id": 48424521,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ4NDI0NTIx",
    "user": {
      "login": "lilyball",
      "id": 714,
      "node_id": "MDQ6VXNlcjcxNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/714?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/lilyball",
      "html_url": "https://github.com/lilyball",
      "followers_url": "https://api.github.com/users/lilyball/followers",
      "following_url": "https://api.github.com/users/lilyball/following{/other_user}",
      "gists_url": "https://api.github.com/users/lilyball/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/lilyball/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/lilyball/subscriptions",
      "organizations_url": "https://api.github.com/users/lilyball/orgs",
      "repos_url": "https://api.github.com/users/lilyball/repos",
      "events_url": "https://api.github.com/users/lilyball/events{/privacy}",
      "received_events_url": "https://api.github.com/users/lilyball/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-07-09T02:55:24Z",
    "updated_at": "2014-07-09T02:55:24Z",
    "body": "Is this actually a safe approach?\n\nMy impression was that `static mut FOO: uint` intentionally required `unsafe {}` for reading because reading a `static mut` is an inherently unsafe operation. No amount of synchronization on the write side will make reading safe, unless you use synchronization on the reading side as well.\n\nI feel like a better approach would be to allow `static`s to have an `Unsafe` interior if the type is also `Share`. That way you can still get mutability (via `Unsafe`) but the entire `static` value is safe to use as a whole. The downside of this approach is that a `static` is no longer guaranteed to be unchanging, but at least it's _safe_.\n\nNote that types like `uint` are `Share` because the assumption is made that any construct that provides a `&`-pointer to a shared `uint` will prevent any concurrent `&mut` pointers from existing (or being usable).\n\nHowever, a `static mut` does not make that guarantee. In fact, the entire point of `static mut` is for unrestricted mutable access to global shared state. Because of this, you _cannot_ rely on `Share` to make reads safe.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/48424521/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/48424832",
    "html_url": "https://github.com/rust-lang/rust/pull/14862#issuecomment-48424832",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/14862",
    "id": 48424832,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ4NDI0ODMy",
    "user": {
      "login": "lilyball",
      "id": 714,
      "node_id": "MDQ6VXNlcjcxNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/714?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/lilyball",
      "html_url": "https://github.com/lilyball",
      "followers_url": "https://api.github.com/users/lilyball/followers",
      "following_url": "https://api.github.com/users/lilyball/following{/other_user}",
      "gists_url": "https://api.github.com/users/lilyball/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/lilyball/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/lilyball/subscriptions",
      "organizations_url": "https://api.github.com/users/lilyball/orgs",
      "repos_url": "https://api.github.com/users/lilyball/repos",
      "events_url": "https://api.github.com/users/lilyball/events{/privacy}",
      "received_events_url": "https://api.github.com/users/lilyball/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-07-09T03:01:30Z",
    "updated_at": "2014-07-09T03:01:30Z",
    "body": "I think it's safe to say that a `static mut` is roughly the equivalent of a `*mut` pointer. The `static mut` must be unsafe for both reads and writes for the same reason that dereferencing a `*mut` pointer must be unsafe for both reading and mutation (with the sole difference that accessing a `static mut` is guaranteed to not result in dereferencing unallocated memory, although you can trivially do so if the `static mut` contains any form of pointer/reference itself).\n\nMeanwhile a `static` is roughly equivalent to a `&` reference. This also explains why a `static` cannot contain any `Unsafe` data that is not `Share`; because it is effectively a `&` reference, the value must be `Share` for the `&` reference to be valid.\n\nAnd this also explains why `Unsafe` values that are also `Share` _should_ be allowed, because the `Share` indicates that it's safe.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/48424832/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/48425018",
    "html_url": "https://github.com/rust-lang/rust/pull/14862#issuecomment-48425018",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/14862",
    "id": 48425018,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ4NDI1MDE4",
    "user": {
      "login": "huonw",
      "id": 1203825,
      "node_id": "MDQ6VXNlcjEyMDM4MjU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1203825?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/huonw",
      "html_url": "https://github.com/huonw",
      "followers_url": "https://api.github.com/users/huonw/followers",
      "following_url": "https://api.github.com/users/huonw/following{/other_user}",
      "gists_url": "https://api.github.com/users/huonw/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/huonw/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/huonw/subscriptions",
      "organizations_url": "https://api.github.com/users/huonw/orgs",
      "repos_url": "https://api.github.com/users/huonw/repos",
      "events_url": "https://api.github.com/users/huonw/events{/privacy}",
      "received_events_url": "https://api.github.com/users/huonw/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-07-09T03:05:22Z",
    "updated_at": "2014-07-09T03:08:25Z",
    "body": "It's still not possible to have a program with UB without using `unsafe` somewhere.\n\nIt seems perfectly reasonable to regard accessing a `Share` `static mut` as perfectly safe, with the edge case of overwriting it as the problem. That is, consider the safe Rust language to include `Share` + `static mut`s with `&` access (having only that functionality is 100% ok), and then `unsafe` enables some extra dangerous functionality. As an example of this behaviour already in Rust, `&` can be transmuted to `&mut` and then modified in `unsafe` code, which would possibly break a read of the `&`, but we still don't regard every access of a `&` as `unsafe`.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/48425018/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/48425195",
    "html_url": "https://github.com/rust-lang/rust/pull/14862#issuecomment-48425195",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/14862",
    "id": 48425195,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ4NDI1MTk1",
    "user": {
      "login": "lilyball",
      "id": 714,
      "node_id": "MDQ6VXNlcjcxNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/714?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/lilyball",
      "html_url": "https://github.com/lilyball",
      "followers_url": "https://api.github.com/users/lilyball/followers",
      "following_url": "https://api.github.com/users/lilyball/following{/other_user}",
      "gists_url": "https://api.github.com/users/lilyball/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/lilyball/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/lilyball/subscriptions",
      "organizations_url": "https://api.github.com/users/lilyball/orgs",
      "repos_url": "https://api.github.com/users/lilyball/repos",
      "events_url": "https://api.github.com/users/lilyball/events{/privacy}",
      "received_events_url": "https://api.github.com/users/lilyball/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-07-09T03:09:09Z",
    "updated_at": "2014-07-09T03:09:09Z",
    "body": "@huonw \n\n> It's still not possible to have a program with UB without using `unsafe` somewhere.\n\nEntirely irrelevant. The existence of `unsafe` does not whatsoever mean that safe code should be able to invoke UB. Safe code should only be able to invoke UB as a result of _bugs_ in the `unsafe` code. But making reads for `static mut` not require `unsafe` makes it **literally impossible** to write bug-free `unsafe` code that writes to the value. There is _no way whatsoever_ to contain the unsafety when writing to the static.\n\nThe entire point of `unsafe {}` blocks are to contain unsafety. If the unsafety leaks outside of the `unsafe {}` block, then it's a bug. But since it is impossible to contain the unsafety when writing to a `static mut` with this PR, that leads to the inevitable conclusion that _any_ writes to a `static mut` (that is modified by this PR to consider reads to be safe) requires the _entire program_ to be contained within an `unsafe {}` block. And not only is that completely preposterous, but it also means you may as well let reads remain `unsafe` anyway.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/48425195/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/48425301",
    "html_url": "https://github.com/rust-lang/rust/pull/14862#issuecomment-48425301",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/14862",
    "id": 48425301,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ4NDI1MzAx",
    "user": {
      "login": "lilyball",
      "id": 714,
      "node_id": "MDQ6VXNlcjcxNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/714?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/lilyball",
      "html_url": "https://github.com/lilyball",
      "followers_url": "https://api.github.com/users/lilyball/followers",
      "following_url": "https://api.github.com/users/lilyball/following{/other_user}",
      "gists_url": "https://api.github.com/users/lilyball/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/lilyball/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/lilyball/subscriptions",
      "organizations_url": "https://api.github.com/users/lilyball/orgs",
      "repos_url": "https://api.github.com/users/lilyball/repos",
      "events_url": "https://api.github.com/users/lilyball/events{/privacy}",
      "received_events_url": "https://api.github.com/users/lilyball/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-07-09T03:10:52Z",
    "updated_at": "2014-07-09T03:10:52Z",
    "body": "@huonw \n\n> `&` can be transmuted to `&mut` and then modified in unsafe code\n\nNo it can't.\n\nI mean, yes you can write that code, but that would be incorrect code.\n\nThe point of `unsafe` is not that you _can_ write buggy code that makes safe operations invoke UB, it's that you can write _bug-free_ code that preserves the safety of safe operations. But it is impossible to write bug-free code that writes to a `static mut Foo: uint` as long as reading from the static does not require `unsafe {}`.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/48425301/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/48425426",
    "html_url": "https://github.com/rust-lang/rust/pull/14862#issuecomment-48425426",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/14862",
    "id": 48425426,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ4NDI1NDI2",
    "user": {
      "login": "huonw",
      "id": 1203825,
      "node_id": "MDQ6VXNlcjEyMDM4MjU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1203825?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/huonw",
      "html_url": "https://github.com/huonw",
      "followers_url": "https://api.github.com/users/huonw/followers",
      "following_url": "https://api.github.com/users/huonw/following{/other_user}",
      "gists_url": "https://api.github.com/users/huonw/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/huonw/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/huonw/subscriptions",
      "organizations_url": "https://api.github.com/users/huonw/orgs",
      "repos_url": "https://api.github.com/users/huonw/repos",
      "events_url": "https://api.github.com/users/huonw/events{/privacy}",
      "received_events_url": "https://api.github.com/users/huonw/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-07-09T03:13:49Z",
    "updated_at": "2014-07-09T03:13:49Z",
    "body": "> I mean, yes you can write that code, but that would be incorrect code.\n\nAs is overwriting a `static mut` without synchronisation; I don't see how this differs.\n\n> But it is impossible to write bug-free code that writes to a static mut Foo: uint as long as reading from the static does not require unsafe {}.\n\nNo, it's clearly not. We can _currently_ write bug-free code that writes to a `static mut`, and we will still be able to do it after this lands. Reading that is no longer `unsafe` does not make writing bug-free code _impossible_. You are being overly hyperbolic.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/48425426/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/48425705",
    "html_url": "https://github.com/rust-lang/rust/pull/14862#issuecomment-48425705",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/14862",
    "id": 48425705,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ4NDI1NzA1",
    "user": {
      "login": "lilyball",
      "id": 714,
      "node_id": "MDQ6VXNlcjcxNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/714?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/lilyball",
      "html_url": "https://github.com/lilyball",
      "followers_url": "https://api.github.com/users/lilyball/followers",
      "following_url": "https://api.github.com/users/lilyball/following{/other_user}",
      "gists_url": "https://api.github.com/users/lilyball/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/lilyball/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/lilyball/subscriptions",
      "organizations_url": "https://api.github.com/users/lilyball/orgs",
      "repos_url": "https://api.github.com/users/lilyball/repos",
      "events_url": "https://api.github.com/users/lilyball/events{/privacy}",
      "received_events_url": "https://api.github.com/users/lilyball/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-07-09T03:19:57Z",
    "updated_at": "2014-07-09T03:21:39Z",
    "body": "@huonw It differs because you _can_ write safe wrappers for `unsafe` operations. Again, that is the _entire point_ of `unsafe`. If you can't write a safe wrapper at some level for some `unsafe` operation, then the operation should not be legal.\n\n> We can _currently_ write bug-free code that writes to a `static mut`,\n\nCorrect, but it's only bug-free because reading is `unsafe` and therefore requires using a safe wrapper that knows how to coordinate with the writing side to manage any synchronization.\n\n> and we will still be able to do it after this lands.\n\nIncorrect. You can still write a safe wrapper for reading that handles synchronization, yes, but reading without that wrapper is _also considered safe_. Except it _can't_ be safe. The only way to make reading safe is to go through the wrapper. Again, the mere existence of code that writes to a `static mut` makes the act of reading from the `static mut` inherently unsafe. And that's precisely why reading from a `static mut` is considered an `unsafe` operation today. This is completely irrespective of whether the type of the static conforms to `Share`, because _that's not what `Share` means_.\n\nInstead of accusing me of hyperbole, you should consider that perhaps you're actually wrong about this. I am not being hyperbolic in the slightest. I am 100% serious when I use the phrase \"literally impossible\".\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/48425705/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/48425814",
    "html_url": "https://github.com/rust-lang/rust/pull/14862#issuecomment-48425814",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/14862",
    "id": 48425814,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ4NDI1ODE0",
    "user": {
      "login": "alexcrichton",
      "id": 64996,
      "node_id": "MDQ6VXNlcjY0OTk2",
      "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alexcrichton",
      "html_url": "https://github.com/alexcrichton",
      "followers_url": "https://api.github.com/users/alexcrichton/followers",
      "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}",
      "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions",
      "organizations_url": "https://api.github.com/users/alexcrichton/orgs",
      "repos_url": "https://api.github.com/users/alexcrichton/repos",
      "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alexcrichton/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-07-09T03:22:14Z",
    "updated_at": "2014-07-09T03:22:14Z",
    "body": "> Instead of accusing me of hyperbole, you should consider that perhaps you're actually wrong about this\n\nLet's please calm down before commenting further. Heated arguments largely make little progress.\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/48425814/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/48426239",
    "html_url": "https://github.com/rust-lang/rust/pull/14862#issuecomment-48426239",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/14862",
    "id": 48426239,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ4NDI2MjM5",
    "user": {
      "login": "alexcrichton",
      "id": 64996,
      "node_id": "MDQ6VXNlcjY0OTk2",
      "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alexcrichton",
      "html_url": "https://github.com/alexcrichton",
      "followers_url": "https://api.github.com/users/alexcrichton/followers",
      "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}",
      "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions",
      "organizations_url": "https://api.github.com/users/alexcrichton/orgs",
      "repos_url": "https://api.github.com/users/alexcrichton/repos",
      "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alexcrichton/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-07-09T03:30:53Z",
    "updated_at": "2014-07-09T03:30:53Z",
    "body": "> > We can currently write bug-free code that writes to a static mut,\n> \n> Correct, but it's only bug-free because reading is unsafe and therefore requires using a safe wrapper that knows how to coordinate with the writing side to manage any synchronization\n\nHave you considered code such as this?\n\n``` rust\nstatic mut FOO: uint = 3;\nstatic mut LOCK: NativeMutex = NATIVE_MUTEX_INIT;\n\nfn write() {\n    unsafe {\n        let _l = LOCK.lock();\n        FOO = 4;\n    }\n}\n\n\nfn read() -> uint {\n    unsafe {\n        let _l = LOCK.lock();\n        FOO\n    }\n}\n```\n\nAll reads/writes made to `FOO` in this scenario are safe, which seems to contradict your claim that this is \"literally impossible\".\n\nThis is not the only case where this is safe, there are many many other safe and defined situations. Concurrent reads and writes only invoke undefined behavior if there is at least one unsynchronized operation occurring concurrently with any write operation. Note that this does not include all possible behavior, as it seems you are claiming. One could have externally synchronized reads/writes which allow unsynchronized reads/writes to have defined behavior.\n\nAlso note that the [precise definition of `Share`](http://doc.rust-lang.org/std/kinds/trait.Share.html) is:\n\n> The precise definition is: a type T is Share if &T is thread-safe. In other words, there is no possibility of data races when passing &T references between tasks.\n\nAs implemented, this is _precisely_ allowing exactly that. It is allowed to take a shared reference, `&T`, to any `static mut` which has a type `T` which ascribes to `Share`.\n\nOther operations, such as writing to a global, _may_ invoke undefined behavior, so they are `unsafe`.\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/48426239/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/48426664",
    "html_url": "https://github.com/rust-lang/rust/pull/14862#issuecomment-48426664",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/14862",
    "id": 48426664,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ4NDI2NjY0",
    "user": {
      "login": "lilyball",
      "id": 714,
      "node_id": "MDQ6VXNlcjcxNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/714?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/lilyball",
      "html_url": "https://github.com/lilyball",
      "followers_url": "https://api.github.com/users/lilyball/followers",
      "following_url": "https://api.github.com/users/lilyball/following{/other_user}",
      "gists_url": "https://api.github.com/users/lilyball/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/lilyball/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/lilyball/subscriptions",
      "organizations_url": "https://api.github.com/users/lilyball/orgs",
      "repos_url": "https://api.github.com/users/lilyball/repos",
      "events_url": "https://api.github.com/users/lilyball/events{/privacy}",
      "received_events_url": "https://api.github.com/users/lilyball/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-07-09T03:39:47Z",
    "updated_at": "2014-07-09T03:39:47Z",
    "body": "@alexcrichton \n\nAll _existing_ read/writes in your code are safe, yes. But with your PR, I can trivially write\n\n``` rust\nfn foo() -> uint {\n    FOO\n}\n```\n\nand this is unsafe. My _ability_ to write unsafe code consisting of nothing but safe operations means that you have violated the contract of the `unsafe {}` block in your `write()` function. Because I can create a data race using nothing but safe operations, your `write()` function is buggy and itself needs to be marked as `unsafe`. And so does any code that uses it, ad infinitum. Because it is impossible to safely contain the unsafety in your `write()` function, the end result is that the entire program must be `unsafe {}`.\n\nBasically, you are making the same mistake that @huonw is, which is confusing the _code you have written_ with _the code that is legal to write_. It doesn't matter whether or not you actually write an unsynchronized read, the fact that you _can_ is what makes the `write()` function buggy.\n\nRegarding `Share`, you are grossly misapplying its definition. Yes, if a type `T` is `Share`, then `&T` is thread-safe. The problem is you are interpreting that to mean that _constructing_ a `&T` is a safe operation, and that is not true. In fact, the entire reason that `Share` works is precisely because it is illegal to construct a `&T` that aliases with a mutable value (either `&mut T` or a mutable slot). This PR explicitly makes it legal to construct a `&T` that aliases with a subset of mutable slots (namely, those defined by `static mut`), but that's not a safe thing to do.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/48426664/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/48427013",
    "html_url": "https://github.com/rust-lang/rust/pull/14862#issuecomment-48427013",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/14862",
    "id": 48427013,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ4NDI3MDEz",
    "user": {
      "login": "huonw",
      "id": 1203825,
      "node_id": "MDQ6VXNlcjEyMDM4MjU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1203825?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/huonw",
      "html_url": "https://github.com/huonw",
      "followers_url": "https://api.github.com/users/huonw/followers",
      "following_url": "https://api.github.com/users/huonw/following{/other_user}",
      "gists_url": "https://api.github.com/users/huonw/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/huonw/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/huonw/subscriptions",
      "organizations_url": "https://api.github.com/users/huonw/orgs",
      "repos_url": "https://api.github.com/users/huonw/repos",
      "events_url": "https://api.github.com/users/huonw/events{/privacy}",
      "received_events_url": "https://api.github.com/users/huonw/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-07-09T03:47:13Z",
    "updated_at": "2014-07-09T03:47:24Z",
    "body": "You could adjust `Vec` to include `pub fn increase_len(&mut self) { self.len += 1 }` , it's not safe, but there's no `unsafe`.\n\nThis seems very similar: if you are wrapping `unsafe` in a safe interface, you need to consider the _whole_ interface, even parts that don't have `unsafe {}` blocks.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/48427013/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/48427340",
    "html_url": "https://github.com/rust-lang/rust/pull/14862#issuecomment-48427340",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/14862",
    "id": 48427340,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ4NDI3MzQw",
    "user": {
      "login": "lilyball",
      "id": 714,
      "node_id": "MDQ6VXNlcjcxNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/714?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/lilyball",
      "html_url": "https://github.com/lilyball",
      "followers_url": "https://api.github.com/users/lilyball/followers",
      "following_url": "https://api.github.com/users/lilyball/following{/other_user}",
      "gists_url": "https://api.github.com/users/lilyball/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/lilyball/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/lilyball/subscriptions",
      "organizations_url": "https://api.github.com/users/lilyball/orgs",
      "repos_url": "https://api.github.com/users/lilyball/repos",
      "events_url": "https://api.github.com/users/lilyball/events{/privacy}",
      "received_events_url": "https://api.github.com/users/lilyball/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-07-09T03:54:17Z",
    "updated_at": "2014-07-09T03:54:17Z",
    "body": "@huonw As I said before to @alexcrichton, you are confusing the _code you have written_ with the _code that is legal to write_. Your function there is buggy, and will cause other `unsafe {}` code to likely crash. But it's the _`unsafe`_ code that exhibits the bad behavior, not the safe code.\n\nThis PR is introducing the opposite problem, where it's the _safe_ code that behaves wrong. You may feel like arguing that you can trivially write `unsafe {}` code that causes safe code to behave wrong, but you would have to admit that your `unsafe {}` code is therefore buggy and needs to be fixed.\n\nThe problem with this PR is that you _cannot_ fix the `unsafe {}` code. There is no way to write your `unsafe {}` mutation that causes a read operation to be safe. And that inability to make the read operation safe is why reads on `static mut` values must be considered `unsafe`. Because it _is_ unsafe. You're just trying to get rid of the `unsafe` keyword without actually getting rid of the unsafe behavior.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/48427340/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/48427696",
    "html_url": "https://github.com/rust-lang/rust/pull/14862#issuecomment-48427696",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/14862",
    "id": 48427696,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ4NDI3Njk2",
    "user": {
      "login": "lilyball",
      "id": 714,
      "node_id": "MDQ6VXNlcjcxNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/714?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/lilyball",
      "html_url": "https://github.com/lilyball",
      "followers_url": "https://api.github.com/users/lilyball/followers",
      "following_url": "https://api.github.com/users/lilyball/following{/other_user}",
      "gists_url": "https://api.github.com/users/lilyball/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/lilyball/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/lilyball/subscriptions",
      "organizations_url": "https://api.github.com/users/lilyball/orgs",
      "repos_url": "https://api.github.com/users/lilyball/repos",
      "events_url": "https://api.github.com/users/lilyball/events{/privacy}",
      "received_events_url": "https://api.github.com/users/lilyball/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-07-09T04:01:29Z",
    "updated_at": "2014-07-09T04:01:29Z",
    "body": "It occurs to me there's another alternative to making `static` able to contain `Unsafe + Share` values, and that's to allow for declaring methods as `fn foo(*mut self)` (along with the corresponding autoref from a `mut T` to a `*mut T`). If you can declare a method like that, you can then allow for calling methods on `static mut` values without `unsafe {}`, which I gather is the motivating reason for this PR. The method itself, because it takes a `*mut`, requires `unsafe {}` in order to dereference the pointer and access the mutable static value.\n\nThe downside to this approach is that it's still not particularly safe, because you can create a `*mut T` pointer to some invalid value (e.g. `NULL`) and invoke the method on it without `unsafe {}`. This suggests that instead of `*mut T` we should have a new reference type `&unsafe T`, which is a mutable pointer that requires `unsafe` to dereference (or to borrow as `&T`). This would basically be a more constrained form of `*mut T`, one that is non-nullable and can only be constructed from a valid value of type `T` (whereas you can construct a `*mut T` from pretty much anything).\n\nOf course, introducing yet another reference type kind of sucks. So I think allowing `static` to contain`Unsafe + Share` is still the best solution.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/48427696/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/49708470",
    "html_url": "https://github.com/rust-lang/rust/pull/14862#issuecomment-49708470",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/14862",
    "id": 49708470,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ5NzA4NDcw",
    "user": {
      "login": "pnkfelix",
      "id": 173127,
      "node_id": "MDQ6VXNlcjE3MzEyNw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/173127?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/pnkfelix",
      "html_url": "https://github.com/pnkfelix",
      "followers_url": "https://api.github.com/users/pnkfelix/followers",
      "following_url": "https://api.github.com/users/pnkfelix/following{/other_user}",
      "gists_url": "https://api.github.com/users/pnkfelix/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/pnkfelix/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/pnkfelix/subscriptions",
      "organizations_url": "https://api.github.com/users/pnkfelix/orgs",
      "repos_url": "https://api.github.com/users/pnkfelix/repos",
      "events_url": "https://api.github.com/users/pnkfelix/events{/privacy}",
      "received_events_url": "https://api.github.com/users/pnkfelix/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-07-22T07:50:08Z",
    "updated_at": "2014-07-22T07:50:08Z",
    "body": "(wow there has been a lot of heat on this thread since the last review ping...)\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/49708470/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/49710897",
    "html_url": "https://github.com/rust-lang/rust/pull/14862#issuecomment-49710897",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/14862",
    "id": 49710897,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ5NzEwODk3",
    "user": {
      "login": "emberian",
      "id": 704250,
      "node_id": "MDQ6VXNlcjcwNDI1MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/704250?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/emberian",
      "html_url": "https://github.com/emberian",
      "followers_url": "https://api.github.com/users/emberian/followers",
      "following_url": "https://api.github.com/users/emberian/following{/other_user}",
      "gists_url": "https://api.github.com/users/emberian/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/emberian/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/emberian/subscriptions",
      "organizations_url": "https://api.github.com/users/emberian/orgs",
      "repos_url": "https://api.github.com/users/emberian/repos",
      "events_url": "https://api.github.com/users/emberian/events{/privacy}",
      "received_events_url": "https://api.github.com/users/emberian/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-07-22T08:20:36Z",
    "updated_at": "2014-07-22T08:20:45Z",
    "body": "I'm fairly certain @kballard  is right here. If you write `FOO` we have no mechanism of calling user-defined code before the read, meaning another thread could have written one field but not the other before being descheduled, leaving an inconsistent state, with the writer having no way at all to prevent this.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/49710897/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/49711019",
    "html_url": "https://github.com/rust-lang/rust/pull/14862#issuecomment-49711019",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/14862",
    "id": 49711019,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ5NzExMDE5",
    "user": {
      "login": "emberian",
      "id": 704250,
      "node_id": "MDQ6VXNlcjcwNDI1MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/704250?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/emberian",
      "html_url": "https://github.com/emberian",
      "followers_url": "https://api.github.com/users/emberian/followers",
      "following_url": "https://api.github.com/users/emberian/following{/other_user}",
      "gists_url": "https://api.github.com/users/emberian/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/emberian/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/emberian/subscriptions",
      "organizations_url": "https://api.github.com/users/emberian/orgs",
      "repos_url": "https://api.github.com/users/emberian/repos",
      "events_url": "https://api.github.com/users/emberian/events{/privacy}",
      "received_events_url": "https://api.github.com/users/emberian/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-07-22T08:22:27Z",
    "updated_at": "2014-07-22T08:22:27Z",
    "body": "I suppose it is possible to work around that by having your `static mut` be private and only allowing access through functions which guarantee the necessary invariants.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/49711019/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/49711220",
    "html_url": "https://github.com/rust-lang/rust/pull/14862#issuecomment-49711220",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/14862",
    "id": 49711220,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ5NzExMjIw",
    "user": {
      "login": "emberian",
      "id": 704250,
      "node_id": "MDQ6VXNlcjcwNDI1MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/704250?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/emberian",
      "html_url": "https://github.com/emberian",
      "followers_url": "https://api.github.com/users/emberian/followers",
      "following_url": "https://api.github.com/users/emberian/following{/other_user}",
      "gists_url": "https://api.github.com/users/emberian/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/emberian/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/emberian/subscriptions",
      "organizations_url": "https://api.github.com/users/emberian/orgs",
      "repos_url": "https://api.github.com/users/emberian/repos",
      "events_url": "https://api.github.com/users/emberian/events{/privacy}",
      "received_events_url": "https://api.github.com/users/emberian/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-07-22T08:24:54Z",
    "updated_at": "2014-07-22T08:24:54Z",
    "body": "(Also I would discourage any attempts at allowing `static` data to be mutable, as that removes our one fool-proof no-gotcha way of having rodata)\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/49711220/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/49716368",
    "html_url": "https://github.com/rust-lang/rust/pull/14862#issuecomment-49716368",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/14862",
    "id": 49716368,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ5NzE2MzY4",
    "user": {
      "login": "nikomatsakis",
      "id": 155238,
      "node_id": "MDQ6VXNlcjE1NTIzOA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/155238?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nikomatsakis",
      "html_url": "https://github.com/nikomatsakis",
      "followers_url": "https://api.github.com/users/nikomatsakis/followers",
      "following_url": "https://api.github.com/users/nikomatsakis/following{/other_user}",
      "gists_url": "https://api.github.com/users/nikomatsakis/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nikomatsakis/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nikomatsakis/subscriptions",
      "organizations_url": "https://api.github.com/users/nikomatsakis/orgs",
      "repos_url": "https://api.github.com/users/nikomatsakis/repos",
      "events_url": "https://api.github.com/users/nikomatsakis/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nikomatsakis/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-07-22T09:24:49Z",
    "updated_at": "2014-07-22T09:24:49Z",
    "body": "This is an interesting debate. I confess I am torn. \n\nOn the one hand, I agree that the safety requirement is subtle, and hence if you can write to a static mut (unsafely), it is best to say that all reads are also unsafe, since both of them must be synchronized together for the code to be data-race free.\n\nOn the other hand, it would be very nice to have global locks and atomic integers that one can expose safely. (Of course it is possible to create fn accessors instead.)\n\nI wonder if we can skin this cat another way. Currently, we have rules that say: \"static variables cannot have `Unsafe<T>` embedded within them\". The reason for this is that we want to put them in immutable memory, and interior mutability messes with that. Perhaps we can instead say \"static variables with `Unsafe<T>` embedded within them must be `Share` and will be not be placed into immutable memory\". I feel like we danced around this idea the last time this came up, and I can't recall what it's downsides were, besides being kind of complicated (and interacting with significant addresses to boot).\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/49716368/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/49717380",
    "html_url": "https://github.com/rust-lang/rust/pull/14862#issuecomment-49717380",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/14862",
    "id": 49717380,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ5NzE3Mzgw",
    "user": {
      "login": "lilyball",
      "id": 714,
      "node_id": "MDQ6VXNlcjcxNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/714?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/lilyball",
      "html_url": "https://github.com/lilyball",
      "followers_url": "https://api.github.com/users/lilyball/followers",
      "following_url": "https://api.github.com/users/lilyball/following{/other_user}",
      "gists_url": "https://api.github.com/users/lilyball/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/lilyball/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/lilyball/subscriptions",
      "organizations_url": "https://api.github.com/users/lilyball/orgs",
      "repos_url": "https://api.github.com/users/lilyball/repos",
      "events_url": "https://api.github.com/users/lilyball/events{/privacy}",
      "received_events_url": "https://api.github.com/users/lilyball/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-07-22T09:36:35Z",
    "updated_at": "2014-07-22T09:36:35Z",
    "body": "I'm a fan of \"static Unsafe<T> vars must be Share and will be placed into mutable memory\". I too feel that it's a bit strange, that a static could actually be mutable, but that seems to me to be a consequence of the existence of Unsafe<T>. What we have today, where you can't put Unsafe<T> into a static, has shown to be an undesirable limitation (e.g. because actually-safe constructs end up requiring static mut and unsafe {})\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/49717380/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/49739114",
    "html_url": "https://github.com/rust-lang/rust/pull/14862#issuecomment-49739114",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/14862",
    "id": 49739114,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ5NzM5MTE0",
    "user": {
      "login": "alexcrichton",
      "id": 64996,
      "node_id": "MDQ6VXNlcjY0OTk2",
      "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alexcrichton",
      "html_url": "https://github.com/alexcrichton",
      "followers_url": "https://api.github.com/users/alexcrichton/followers",
      "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}",
      "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions",
      "organizations_url": "https://api.github.com/users/alexcrichton/orgs",
      "repos_url": "https://api.github.com/users/alexcrichton/repos",
      "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alexcrichton/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-07-22T13:35:10Z",
    "updated_at": "2014-07-22T13:35:10Z",
    "body": "> Perhaps we can instead say \"static variables with Unsafe<T> embedded within them must be Share and will be not be placed into immutable memory\".\n\nI remember this coming up at the last work week, but it has the hazard of making code a little odd:\n\n``` rust\nuse std::sync::atomics;\n\nlet i = atomics::INIT_ATOMIC_UINT.fetch_add(1, atomics::SeqCst);\nlet j = atomics::INIT_ATOMIC_UINT; // assuming #13233\nprintln!(\"{}\", j.load(atomics::SeqCst)); // prints 1, not 0\n```\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/49739114/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/49740031",
    "html_url": "https://github.com/rust-lang/rust/pull/14862#issuecomment-49740031",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/14862",
    "id": 49740031,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ5NzQwMDMx",
    "user": {
      "login": "nikomatsakis",
      "id": 155238,
      "node_id": "MDQ6VXNlcjE1NTIzOA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/155238?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nikomatsakis",
      "html_url": "https://github.com/nikomatsakis",
      "followers_url": "https://api.github.com/users/nikomatsakis/followers",
      "following_url": "https://api.github.com/users/nikomatsakis/following{/other_user}",
      "gists_url": "https://api.github.com/users/nikomatsakis/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nikomatsakis/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nikomatsakis/subscriptions",
      "organizations_url": "https://api.github.com/users/nikomatsakis/orgs",
      "repos_url": "https://api.github.com/users/nikomatsakis/repos",
      "events_url": "https://api.github.com/users/nikomatsakis/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nikomatsakis/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-07-22T13:42:18Z",
    "updated_at": "2014-07-22T13:42:18Z",
    "body": "@alexcrichton ah yes, that was the thing we didn't like.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/49740031/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/49741117",
    "html_url": "https://github.com/rust-lang/rust/pull/14862#issuecomment-49741117",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/14862",
    "id": 49741117,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ5NzQxMTE3",
    "user": {
      "login": "nikomatsakis",
      "id": 155238,
      "node_id": "MDQ6VXNlcjE1NTIzOA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/155238?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nikomatsakis",
      "html_url": "https://github.com/nikomatsakis",
      "followers_url": "https://api.github.com/users/nikomatsakis/followers",
      "following_url": "https://api.github.com/users/nikomatsakis/following{/other_user}",
      "gists_url": "https://api.github.com/users/nikomatsakis/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nikomatsakis/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nikomatsakis/subscriptions",
      "organizations_url": "https://api.github.com/users/nikomatsakis/orgs",
      "repos_url": "https://api.github.com/users/nikomatsakis/repos",
      "events_url": "https://api.github.com/users/nikomatsakis/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nikomatsakis/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-07-22T13:51:36Z",
    "updated_at": "2014-07-22T13:51:36Z",
    "body": "I pondered this some more. It is certainly true that one must use privacy when writing to static muts, or else you cannot create a safe interface (since you must control reads and writes). However, this is _almost always_ true when writing unsafe code. In fact, that's kind of the _whole point_ of the unsafe keyword-- is to indicate code that is not safe on its own because it may interact with other code, so it is your responsibility to know what interacts exist and control them. It seems clearly worse to me to be able to modify the `INIT_ATOMIC_UINT`. Naturally we could have three kinds of statics but this seems like overkill to me. In short, I think our prior decision was the right one.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/49741117/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/49743142",
    "html_url": "https://github.com/rust-lang/rust/pull/14862#issuecomment-49743142",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/14862",
    "id": 49743142,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ5NzQzMTQy",
    "user": {
      "login": "nikomatsakis",
      "id": 155238,
      "node_id": "MDQ6VXNlcjE1NTIzOA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/155238?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nikomatsakis",
      "html_url": "https://github.com/nikomatsakis",
      "followers_url": "https://api.github.com/users/nikomatsakis/followers",
      "following_url": "https://api.github.com/users/nikomatsakis/following{/other_user}",
      "gists_url": "https://api.github.com/users/nikomatsakis/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nikomatsakis/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nikomatsakis/subscriptions",
      "organizations_url": "https://api.github.com/users/nikomatsakis/orgs",
      "repos_url": "https://api.github.com/users/nikomatsakis/repos",
      "events_url": "https://api.github.com/users/nikomatsakis/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nikomatsakis/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-07-22T14:06:29Z",
    "updated_at": "2014-07-22T14:06:29Z",
    "body": "Also, the supposed problem concerning static muts already exists for the `Unsafe` type: it has a public field, but creates unsafe `*mut` pointers to that field. The compiler permits safe access to that field even though unsafe aliases may exist. Failure to control access to a `Unsafe<T>` yields undefined behavior in the way as static mut. The reason for this, iirc, has to do with static initializers and privacy.\n\nIf we wanted to make static mut more secure, one option would be to simply forbid writes and mutable borrows of static mut values. In that case, if you wanted \"free\" writes (rather than using `Atomic`), you would simply make the type of your static mut be `Unsafe<Foo>` rather than `Foo`. You can then use the methods on `Unsafe<Foo>` to get a `*mut Foo` pointer. Now reads/writes are both unsafe (modulo the problem in first paragraph).\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/49743142/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/49743643",
    "html_url": "https://github.com/rust-lang/rust/pull/14862#issuecomment-49743643",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/14862",
    "id": 49743643,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ5NzQzNjQz",
    "user": {
      "login": "lilyball",
      "id": 714,
      "node_id": "MDQ6VXNlcjcxNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/714?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/lilyball",
      "html_url": "https://github.com/lilyball",
      "followers_url": "https://api.github.com/users/lilyball/followers",
      "following_url": "https://api.github.com/users/lilyball/following{/other_user}",
      "gists_url": "https://api.github.com/users/lilyball/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/lilyball/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/lilyball/subscriptions",
      "organizations_url": "https://api.github.com/users/lilyball/orgs",
      "repos_url": "https://api.github.com/users/lilyball/repos",
      "events_url": "https://api.github.com/users/lilyball/events{/privacy}",
      "received_events_url": "https://api.github.com/users/lilyball/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-07-22T14:09:50Z",
    "updated_at": "2014-07-22T14:09:50Z",
    "body": "@nikomatsakis We could introduce `static const` as a way of bringing back the restriction on `Unsafe` that we have today with `static`, e.g. that you can't take a borrow on the value. This way `INIT_ATOMIC_UINT` can be `static const`, and therefore you have to initialize your own atomic value from it before you can do anything.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/49743643/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/49743852",
    "html_url": "https://github.com/rust-lang/rust/pull/14862#issuecomment-49743852",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/14862",
    "id": 49743852,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ5NzQzODUy",
    "user": {
      "login": "nikomatsakis",
      "id": 155238,
      "node_id": "MDQ6VXNlcjE1NTIzOA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/155238?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nikomatsakis",
      "html_url": "https://github.com/nikomatsakis",
      "followers_url": "https://api.github.com/users/nikomatsakis/followers",
      "following_url": "https://api.github.com/users/nikomatsakis/following{/other_user}",
      "gists_url": "https://api.github.com/users/nikomatsakis/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nikomatsakis/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nikomatsakis/subscriptions",
      "organizations_url": "https://api.github.com/users/nikomatsakis/orgs",
      "repos_url": "https://api.github.com/users/nikomatsakis/repos",
      "events_url": "https://api.github.com/users/nikomatsakis/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nikomatsakis/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-07-22T14:11:28Z",
    "updated_at": "2014-07-22T14:11:28Z",
    "body": "@kballard yes, I consider three types of static to be overkill and inconsistent.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/49743852/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/49744783",
    "html_url": "https://github.com/rust-lang/rust/pull/14862#issuecomment-49744783",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/14862",
    "id": 49744783,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ5NzQ0Nzgz",
    "user": {
      "login": "lilyball",
      "id": 714,
      "node_id": "MDQ6VXNlcjcxNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/714?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/lilyball",
      "html_url": "https://github.com/lilyball",
      "followers_url": "https://api.github.com/users/lilyball/followers",
      "following_url": "https://api.github.com/users/lilyball/following{/other_user}",
      "gists_url": "https://api.github.com/users/lilyball/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/lilyball/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/lilyball/subscriptions",
      "organizations_url": "https://api.github.com/users/lilyball/orgs",
      "repos_url": "https://api.github.com/users/lilyball/repos",
      "events_url": "https://api.github.com/users/lilyball/events{/privacy}",
      "received_events_url": "https://api.github.com/users/lilyball/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-07-22T14:18:18Z",
    "updated_at": "2014-07-22T14:18:18Z",
    "body": "> It is certainly true that one must use privacy when writing to static muts, or else you cannot create a safe interface\n\nThat's true. The problem is we have _safe_ interfaces for values that want to live in statics (such as `sync::Once`). These safe interfaces should be usable without the `unsafe` keyword. In fact, that's the whole point of `Unsafe`, to allow you to wrap this kind of unsafe mutation in a safe interface for other people to use.\n\nI do agree that 3 kinds of statics is not ideal, but I'm not sure it's worse than what we have today, with the requirement for `unsafe` to wrap perfectly safe operations.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/49744783/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/49764801",
    "html_url": "https://github.com/rust-lang/rust/pull/14862#issuecomment-49764801",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/14862",
    "id": 49764801,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ5NzY0ODAx",
    "user": {
      "login": "pnkfelix",
      "id": 173127,
      "node_id": "MDQ6VXNlcjE3MzEyNw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/173127?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/pnkfelix",
      "html_url": "https://github.com/pnkfelix",
      "followers_url": "https://api.github.com/users/pnkfelix/followers",
      "following_url": "https://api.github.com/users/pnkfelix/following{/other_user}",
      "gists_url": "https://api.github.com/users/pnkfelix/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/pnkfelix/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/pnkfelix/subscriptions",
      "organizations_url": "https://api.github.com/users/pnkfelix/orgs",
      "repos_url": "https://api.github.com/users/pnkfelix/repos",
      "events_url": "https://api.github.com/users/pnkfelix/events{/privacy}",
      "received_events_url": "https://api.github.com/users/pnkfelix/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-07-22T16:37:37Z",
    "updated_at": "2014-07-22T16:37:57Z",
    "body": "Would a lint that flags `pub static mut` resolve the problem here?\n\nIn other words, would that satisfy the requirement that there be a fixed set of code (that must then be reasoned about in isolation), rather than allowing arbitrary new accessors from other mod's to be mixed in?\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/49764801/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/49765633",
    "html_url": "https://github.com/rust-lang/rust/pull/14862#issuecomment-49765633",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/14862",
    "id": 49765633,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ5NzY1NjMz",
    "user": {
      "login": "pnkfelix",
      "id": 173127,
      "node_id": "MDQ6VXNlcjE3MzEyNw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/173127?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/pnkfelix",
      "html_url": "https://github.com/pnkfelix",
      "followers_url": "https://api.github.com/users/pnkfelix/followers",
      "following_url": "https://api.github.com/users/pnkfelix/following{/other_user}",
      "gists_url": "https://api.github.com/users/pnkfelix/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/pnkfelix/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/pnkfelix/subscriptions",
      "organizations_url": "https://api.github.com/users/pnkfelix/orgs",
      "repos_url": "https://api.github.com/users/pnkfelix/repos",
      "events_url": "https://api.github.com/users/pnkfelix/events{/privacy}",
      "received_events_url": "https://api.github.com/users/pnkfelix/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-07-22T16:43:52Z",
    "updated_at": "2014-07-22T16:43:52Z",
    "body": "Or an alternative take on my previous suggestion: Make reads of `pub static mut` require `unsafe`, while reads of non-pub `static mut` (whose type ascribes to `Share`) do not require `unsafe`.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/49765633/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/49766183",
    "html_url": "https://github.com/rust-lang/rust/pull/14862#issuecomment-49766183",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/14862",
    "id": 49766183,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ5NzY2MTgz",
    "user": {
      "login": "lilyball",
      "id": 714,
      "node_id": "MDQ6VXNlcjcxNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/714?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/lilyball",
      "html_url": "https://github.com/lilyball",
      "followers_url": "https://api.github.com/users/lilyball/followers",
      "following_url": "https://api.github.com/users/lilyball/following{/other_user}",
      "gists_url": "https://api.github.com/users/lilyball/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/lilyball/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/lilyball/subscriptions",
      "organizations_url": "https://api.github.com/users/lilyball/orgs",
      "repos_url": "https://api.github.com/users/lilyball/repos",
      "events_url": "https://api.github.com/users/lilyball/events{/privacy}",
      "received_events_url": "https://api.github.com/users/lilyball/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-07-22T16:47:47Z",
    "updated_at": "2014-07-22T16:47:47Z",
    "body": "You can't get rid of the unsafe {}. Rust has never adopted a policy of unsafe {} only being required for public things. And it doesn't make any sense to start; with a static mut that doesn't require unsafe {} you can violate memory safety with supposedly-safe code.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/49766183/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/49767705",
    "html_url": "https://github.com/rust-lang/rust/pull/14862#issuecomment-49767705",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/14862",
    "id": 49767705,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ5NzY3NzA1",
    "user": {
      "login": "pnkfelix",
      "id": 173127,
      "node_id": "MDQ6VXNlcjE3MzEyNw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/173127?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/pnkfelix",
      "html_url": "https://github.com/pnkfelix",
      "followers_url": "https://api.github.com/users/pnkfelix/followers",
      "following_url": "https://api.github.com/users/pnkfelix/following{/other_user}",
      "gists_url": "https://api.github.com/users/pnkfelix/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/pnkfelix/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/pnkfelix/subscriptions",
      "organizations_url": "https://api.github.com/users/pnkfelix/orgs",
      "repos_url": "https://api.github.com/users/pnkfelix/repos",
      "events_url": "https://api.github.com/users/pnkfelix/events{/privacy}",
      "received_events_url": "https://api.github.com/users/pnkfelix/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-07-22T16:58:42Z",
    "updated_at": "2014-07-22T17:10:03Z",
    "body": "I suppose my suggestion of flagging `pub static mut` fails to satisfy @nikomatsakis 's desire for \"global locks and atomic integers that one can expose safely\".\n\nI worry that there is some fundamental philosophical divide here that strikes me as analogous to the debate that raged on https://github.com/rust-lang/rfcs/pull/80 , and  for some reason that divide is leading to very strongly worded comments from both sides on this ticket.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/49767705/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/49796921",
    "html_url": "https://github.com/rust-lang/rust/pull/14862#issuecomment-49796921",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/14862",
    "id": 49796921,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ5Nzk2OTIx",
    "user": {
      "login": "nikomatsakis",
      "id": 155238,
      "node_id": "MDQ6VXNlcjE1NTIzOA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/155238?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nikomatsakis",
      "html_url": "https://github.com/nikomatsakis",
      "followers_url": "https://api.github.com/users/nikomatsakis/followers",
      "following_url": "https://api.github.com/users/nikomatsakis/following{/other_user}",
      "gists_url": "https://api.github.com/users/nikomatsakis/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nikomatsakis/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nikomatsakis/subscriptions",
      "organizations_url": "https://api.github.com/users/nikomatsakis/orgs",
      "repos_url": "https://api.github.com/users/nikomatsakis/repos",
      "events_url": "https://api.github.com/users/nikomatsakis/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nikomatsakis/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-07-22T20:35:51Z",
    "updated_at": "2014-07-22T20:35:51Z",
    "body": "@pnkfelix I agree that this is analagous -- which seems to offer precedent for the approach we planned in the RFC. (At some later point, perhaps, we could add a notion of an `unsafe static` (just as one might add an `unsafe field`).)\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/49796921/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/49801692",
    "html_url": "https://github.com/rust-lang/rust/pull/14862#issuecomment-49801692",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/14862",
    "id": 49801692,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ5ODAxNjky",
    "user": {
      "login": "zwarich",
      "id": 440875,
      "node_id": "MDQ6VXNlcjQ0MDg3NQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/440875?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/zwarich",
      "html_url": "https://github.com/zwarich",
      "followers_url": "https://api.github.com/users/zwarich/followers",
      "following_url": "https://api.github.com/users/zwarich/following{/other_user}",
      "gists_url": "https://api.github.com/users/zwarich/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/zwarich/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/zwarich/subscriptions",
      "organizations_url": "https://api.github.com/users/zwarich/orgs",
      "repos_url": "https://api.github.com/users/zwarich/repos",
      "events_url": "https://api.github.com/users/zwarich/events{/privacy}",
      "received_events_url": "https://api.github.com/users/zwarich/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-07-22T21:11:52Z",
    "updated_at": "2014-07-22T21:14:10Z",
    "body": "@kballard Your objection about safe code being able to violate the invariants of unsafe code is already true today. For example, consider an example like this:\n\n``` rust\nmod M {\n    use std::ty::Unsafe;\n\n    pub struct A<T> {\n        a: Unsafe<T>,\n        // Other fields.\n    }\n\n    impl<T> A<T> {\n        // Functions that provide a safe interface.\n    }\n}\n```\n\nI can add a new safe function to the module and most likely break invariants preserved by the existing code:\n\n``` rust\nmod M {\n    use std::ty::Unsafe;\n\n    struct A<T> {\n        a: Unsafe<T>,\n        // Other fields.\n    }\n\n    impl<T> A<T> {\n        // Functions that provide a safe interface.\n        fn backdoor<'a>(&'a self) -> &'a T {\n            &self.a.value\n        }\n    }\n}\n```\n\nI think it would be interesting to pursue a model where _adding_ safe code doesn't break invariants provided by unsafe code, but it's not what we have today.\n",
    "author_association": "NONE",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/49801692/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/49804336",
    "html_url": "https://github.com/rust-lang/rust/pull/14862#issuecomment-49804336",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/14862",
    "id": 49804336,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ5ODA0MzM2",
    "user": {
      "login": "alexcrichton",
      "id": 64996,
      "node_id": "MDQ6VXNlcjY0OTk2",
      "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alexcrichton",
      "html_url": "https://github.com/alexcrichton",
      "followers_url": "https://api.github.com/users/alexcrichton/followers",
      "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}",
      "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions",
      "organizations_url": "https://api.github.com/users/alexcrichton/orgs",
      "repos_url": "https://api.github.com/users/alexcrichton/repos",
      "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alexcrichton/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-07-22T21:33:49Z",
    "updated_at": "2014-07-22T21:33:49Z",
    "body": "I have created an RFC for this PR: https://github.com/rust-lang/rfcs/pull/177\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/49804336/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/49807898",
    "html_url": "https://github.com/rust-lang/rust/pull/14862#issuecomment-49807898",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/14862",
    "id": 49807898,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ5ODA3ODk4",
    "user": {
      "login": "lilyball",
      "id": 714,
      "node_id": "MDQ6VXNlcjcxNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/714?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/lilyball",
      "html_url": "https://github.com/lilyball",
      "followers_url": "https://api.github.com/users/lilyball/followers",
      "following_url": "https://api.github.com/users/lilyball/following{/other_user}",
      "gists_url": "https://api.github.com/users/lilyball/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/lilyball/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/lilyball/subscriptions",
      "organizations_url": "https://api.github.com/users/lilyball/orgs",
      "repos_url": "https://api.github.com/users/lilyball/repos",
      "events_url": "https://api.github.com/users/lilyball/events{/privacy}",
      "received_events_url": "https://api.github.com/users/lilyball/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-07-22T22:04:40Z",
    "updated_at": "2014-07-22T22:04:40Z",
    "body": "@zwarich Your code snippet has actually convinced me that the fact that the `value` field of `Unsafe<T>` is public is a safety hole. Accessing that value should require `unsafe {}`. This may actually be the compelling reason to add `unsafe` fields (as proposed in RFC PR #80). Alternatively the `value` field could be made private, but I assume it is public for a reason (and I assume that reason is so `static` values can be constructed).\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/49807898/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/51343463",
    "html_url": "https://github.com/rust-lang/rust/pull/14862#issuecomment-51343463",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/14862",
    "id": 51343463,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUxMzQzNDYz",
    "user": {
      "login": "alexcrichton",
      "id": 64996,
      "node_id": "MDQ6VXNlcjY0OTk2",
      "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alexcrichton",
      "html_url": "https://github.com/alexcrichton",
      "followers_url": "https://api.github.com/users/alexcrichton/followers",
      "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}",
      "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions",
      "organizations_url": "https://api.github.com/users/alexcrichton/orgs",
      "repos_url": "https://api.github.com/users/alexcrichton/repos",
      "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alexcrichton/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-08-06T14:39:03Z",
    "updated_at": "2014-08-06T14:39:03Z",
    "body": "Closing pending the resolution of https://github.com/rust-lang/rfcs/pull/177\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/51343463/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
