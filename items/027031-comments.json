[
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/121145045",
    "html_url": "https://github.com/rust-lang/rust/issues/27031#issuecomment-121145045",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/27031",
    "id": 121145045,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEyMTE0NTA0NQ==",
    "user": {
      "login": "Gankra",
      "id": 1136864,
      "node_id": "MDQ6VXNlcjExMzY4NjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1136864?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Gankra",
      "html_url": "https://github.com/Gankra",
      "followers_url": "https://api.github.com/users/Gankra/followers",
      "following_url": "https://api.github.com/users/Gankra/following{/other_user}",
      "gists_url": "https://api.github.com/users/Gankra/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Gankra/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Gankra/subscriptions",
      "organizations_url": "https://api.github.com/users/Gankra/orgs",
      "repos_url": "https://api.github.com/users/Gankra/repos",
      "events_url": "https://api.github.com/users/Gankra/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Gankra/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-07-14T06:37:28Z",
    "updated_at": "2015-07-14T06:37:28Z",
    "body": "Variant &muts are not sound:\n\n``` rust\nfn overwrite<T: Copy>(input: &mut T, new: &mut T) {\n    *input = *new;\n}\n\nfn main() {\n    let mut forever_str: &'static str = \"hello\";\n    {\n        let string = String::from(\"world\");\n        overwrite(&mut forever_str, &mut &*string);\n    }\n    // Oops, printing free'd memory\n    println!(\"{}\", forever_str);\n}\n```\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/121145045/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/121147655",
    "html_url": "https://github.com/rust-lang/rust/issues/27031#issuecomment-121147655",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/27031",
    "id": 121147655,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEyMTE0NzY1NQ==",
    "user": {
      "login": "uzytkownik",
      "id": 5706,
      "node_id": "MDQ6VXNlcjU3MDY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5706?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/uzytkownik",
      "html_url": "https://github.com/uzytkownik",
      "followers_url": "https://api.github.com/users/uzytkownik/followers",
      "following_url": "https://api.github.com/users/uzytkownik/following{/other_user}",
      "gists_url": "https://api.github.com/users/uzytkownik/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/uzytkownik/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/uzytkownik/subscriptions",
      "organizations_url": "https://api.github.com/users/uzytkownik/orgs",
      "repos_url": "https://api.github.com/users/uzytkownik/repos",
      "events_url": "https://api.github.com/users/uzytkownik/events{/privacy}",
      "received_events_url": "https://api.github.com/users/uzytkownik/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-07-14T06:56:30Z",
    "updated_at": "2015-07-14T06:56:46Z",
    "body": "@Gankro You're right - I haven't thought about that. Correct me if I'm wrong, however, but this is only when the `&'a mut` reference outlives `&'b mut` reference. I was thinking about 'moving' the reference so once the cast is done in line 9 the forever_str would not be allowed to be accessed outside overwrite.\n\n---\n\nTo explain why - I've tried to create a mutable zipper. Effectively it is a recursive structure where each element refers to one created in parent structure and they all go out of scope \n",
    "author_association": "NONE",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/121147655/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/122046836",
    "html_url": "https://github.com/rust-lang/rust/issues/27031#issuecomment-122046836",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/27031",
    "id": 122046836,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEyMjA0NjgzNg==",
    "user": {
      "login": "steveklabnik",
      "id": 27786,
      "node_id": "MDQ6VXNlcjI3Nzg2",
      "avatar_url": "https://avatars.githubusercontent.com/u/27786?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/steveklabnik",
      "html_url": "https://github.com/steveklabnik",
      "followers_url": "https://api.github.com/users/steveklabnik/followers",
      "following_url": "https://api.github.com/users/steveklabnik/following{/other_user}",
      "gists_url": "https://api.github.com/users/steveklabnik/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/steveklabnik/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/steveklabnik/subscriptions",
      "organizations_url": "https://api.github.com/users/steveklabnik/orgs",
      "repos_url": "https://api.github.com/users/steveklabnik/repos",
      "events_url": "https://api.github.com/users/steveklabnik/events{/privacy}",
      "received_events_url": "https://api.github.com/users/steveklabnik/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-07-16T18:45:18Z",
    "updated_at": "2015-07-16T18:45:18Z",
    "body": "/cc @nikomatsakis @aturon , is @Gankro correct that this is unsound? if so, it should be closed.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/122046836/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/122050387",
    "html_url": "https://github.com/rust-lang/rust/issues/27031#issuecomment-122050387",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/27031",
    "id": 122050387,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEyMjA1MDM4Nw==",
    "user": {
      "login": "Gankra",
      "id": 1136864,
      "node_id": "MDQ6VXNlcjExMzY4NjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1136864?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Gankra",
      "html_url": "https://github.com/Gankra",
      "followers_url": "https://api.github.com/users/Gankra/followers",
      "following_url": "https://api.github.com/users/Gankra/following{/other_user}",
      "gists_url": "https://api.github.com/users/Gankra/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Gankra/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Gankra/subscriptions",
      "organizations_url": "https://api.github.com/users/Gankra/orgs",
      "repos_url": "https://api.github.com/users/Gankra/repos",
      "events_url": "https://api.github.com/users/Gankra/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Gankra/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-07-16T18:58:14Z",
    "updated_at": "2015-07-16T18:58:14Z",
    "body": "Discussed this more on IRC. I had originally only skimmed the details and had snapped \"&'a mut T is invariant in T\" to \"&mut is invariant in all args\", but this isn't actually necessary. The `'a: 'b` constraint prevents you from getting into any trouble (the input lifetime is forced to outlive output lifetime, which is all you really want for a `foo<'a>(x: &'a mut X) -> &'a mut T`).\n\nAlso this works:\n\n``` rust\ntype Test<'a> = &'a mut Fn(&'static str) -> u32;\n\nfn matched_lifetimes<'a>(_: &'a u8, _: Test<'a>) {}\n\nfn main() {\n    let x: Test<'static> = panic!();\n    {\n        let y: u8 = 0;\n        let z = &y;\n        matched_lifetimes(z, x);\n    }\n}\n```\n\nwhich suggests we already support this in a limited way.\n\nSo yes, I think this is a legit bug.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/122050387/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/122051185",
    "html_url": "https://github.com/rust-lang/rust/issues/27031#issuecomment-122051185",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/27031",
    "id": 122051185,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEyMjA1MTE4NQ==",
    "user": {
      "login": "arielb1",
      "id": 1830974,
      "node_id": "MDQ6VXNlcjE4MzA5NzQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1830974?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/arielb1",
      "html_url": "https://github.com/arielb1",
      "followers_url": "https://api.github.com/users/arielb1/followers",
      "following_url": "https://api.github.com/users/arielb1/following{/other_user}",
      "gists_url": "https://api.github.com/users/arielb1/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/arielb1/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/arielb1/subscriptions",
      "organizations_url": "https://api.github.com/users/arielb1/orgs",
      "repos_url": "https://api.github.com/users/arielb1/repos",
      "events_url": "https://api.github.com/users/arielb1/events{/privacy}",
      "received_events_url": "https://api.github.com/users/arielb1/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-07-16T19:02:06Z",
    "updated_at": "2015-07-16T19:02:06Z",
    "body": "I don't see the unsoundness here (in making `&'a mut T` be variant in `'a`). cc @pnkfelix too.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/122051185/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/122238532",
    "html_url": "https://github.com/rust-lang/rust/issues/27031#issuecomment-122238532",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/27031",
    "id": 122238532,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEyMjIzODUzMg==",
    "user": {
      "login": "arielb1",
      "id": 1830974,
      "node_id": "MDQ6VXNlcjE4MzA5NzQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1830974?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/arielb1",
      "html_url": "https://github.com/arielb1",
      "followers_url": "https://api.github.com/users/arielb1/followers",
      "following_url": "https://api.github.com/users/arielb1/following{/other_user}",
      "gists_url": "https://api.github.com/users/arielb1/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/arielb1/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/arielb1/subscriptions",
      "organizations_url": "https://api.github.com/users/arielb1/orgs",
      "repos_url": "https://api.github.com/users/arielb1/repos",
      "events_url": "https://api.github.com/users/arielb1/events{/privacy}",
      "received_events_url": "https://api.github.com/users/arielb1/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-07-17T10:24:57Z",
    "updated_at": "2015-07-17T10:24:57Z",
    "body": "For the record, you can ATM create a `&mut` zipper with trait objects.\n\n``` Rust\nenum BL<'a> {\n    Root,\n    Link(&'a mut BLLike, &'a mut u32)\n}\n\ntrait BLLike {\n    fn val(&mut self) -> BL;\n}\n\nimpl<'a> BLLike for BL<'a> {\n    fn val(&mut self) -> BL {\n        match self {\n            &mut BL::Root => BL::Root,\n            &mut BL::Link(ref mut cdr, ref mut car) => BL::Link(*cdr, car)\n        }\n    }\n\n}\n\nfn traverse<'a>(mut u: u32, mut l: BL) {\n    if u > 0 {\n        traverse(u-1, BL::Link(&mut l, &mut u))\n    } else {\n        while let BL::Link(cdr, car) = l {\n            println!(\"u={:?}\", car);\n            l = cdr.val();\n        }\n    }\n}\n\nfn main() {\n    traverse(14, BL::Root);\n}\n```\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/122238532/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/122382220",
    "html_url": "https://github.com/rust-lang/rust/issues/27031#issuecomment-122382220",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/27031",
    "id": 122382220,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEyMjM4MjIyMA==",
    "user": {
      "login": "nikomatsakis",
      "id": 155238,
      "node_id": "MDQ6VXNlcjE1NTIzOA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/155238?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nikomatsakis",
      "html_url": "https://github.com/nikomatsakis",
      "followers_url": "https://api.github.com/users/nikomatsakis/followers",
      "following_url": "https://api.github.com/users/nikomatsakis/following{/other_user}",
      "gists_url": "https://api.github.com/users/nikomatsakis/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nikomatsakis/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nikomatsakis/subscriptions",
      "organizations_url": "https://api.github.com/users/nikomatsakis/orgs",
      "repos_url": "https://api.github.com/users/nikomatsakis/repos",
      "events_url": "https://api.github.com/users/nikomatsakis/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nikomatsakis/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-07-17T19:21:32Z",
    "updated_at": "2015-07-17T19:21:32Z",
    "body": "I'm surprised by this, I expect `&'a mut T <: &'b mut T` if `'a: 'b`. I'll have to look briefly at the code to see why that is not the case. At first glance, I didn't see what was going on.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/122382220/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/122382752",
    "html_url": "https://github.com/rust-lang/rust/issues/27031#issuecomment-122382752",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/27031",
    "id": 122382752,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEyMjM4Mjc1Mg==",
    "user": {
      "login": "nikomatsakis",
      "id": 155238,
      "node_id": "MDQ6VXNlcjE1NTIzOA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/155238?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nikomatsakis",
      "html_url": "https://github.com/nikomatsakis",
      "followers_url": "https://api.github.com/users/nikomatsakis/followers",
      "following_url": "https://api.github.com/users/nikomatsakis/following{/other_user}",
      "gists_url": "https://api.github.com/users/nikomatsakis/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nikomatsakis/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nikomatsakis/subscriptions",
      "organizations_url": "https://api.github.com/users/nikomatsakis/orgs",
      "repos_url": "https://api.github.com/users/nikomatsakis/repos",
      "events_url": "https://api.github.com/users/nikomatsakis/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nikomatsakis/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-07-17T19:22:19Z",
    "updated_at": "2015-07-17T19:22:19Z",
    "body": "Oh, wait. I see what it is.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/122382752/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/122385611",
    "html_url": "https://github.com/rust-lang/rust/issues/27031#issuecomment-122385611",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/27031",
    "id": 122385611,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEyMjM4NTYxMQ==",
    "user": {
      "login": "nikomatsakis",
      "id": 155238,
      "node_id": "MDQ6VXNlcjE1NTIzOA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/155238?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nikomatsakis",
      "html_url": "https://github.com/nikomatsakis",
      "followers_url": "https://api.github.com/users/nikomatsakis/followers",
      "following_url": "https://api.github.com/users/nikomatsakis/following{/other_user}",
      "gists_url": "https://api.github.com/users/nikomatsakis/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nikomatsakis/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nikomatsakis/subscriptions",
      "organizations_url": "https://api.github.com/users/nikomatsakis/orgs",
      "repos_url": "https://api.github.com/users/nikomatsakis/repos",
      "events_url": "https://api.github.com/users/nikomatsakis/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nikomatsakis/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-07-17T19:30:30Z",
    "updated_at": "2015-07-17T19:30:30Z",
    "body": "The situation is caused by the defaulting rules around trait object lifetimes. Specifically, the fullly expanded version of the struct in question is:\n\n``` rust\nstruct Foo3<'a> {\n    a: &'a mut (Fn(&'static str) -> u32 + 'a)\n}\n```\n\nWhile it is true that `&'a mut T <: &'b mut T` if `'a:'b`, we do require that the two types be equal (iow, `&'a mut T` is contravar. w/r/t `'a`, but invariant w/r/t `T`). In this case, the reason the subtyping is failing is because of the (implicit) `'a` bound. For example, this test works http://is.gd/w2c9Df.\n\nNow, it is true that you can assign `&'a mut (Trait+'a)` to `&'b mut (Trait+'b)` if `'a:'b` -- but that is not due to subtyping, but rather coercion. In particular, we permit an unsizing coercion from `Trait+'a` to `Trait+'b` if `'a:'b`. \n\nSo I would say the current behavior is Working As Designed.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/122385611/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/122386034",
    "html_url": "https://github.com/rust-lang/rust/issues/27031#issuecomment-122386034",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/27031",
    "id": 122386034,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEyMjM4NjAzNA==",
    "user": {
      "login": "nikomatsakis",
      "id": 155238,
      "node_id": "MDQ6VXNlcjE1NTIzOA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/155238?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nikomatsakis",
      "html_url": "https://github.com/nikomatsakis",
      "followers_url": "https://api.github.com/users/nikomatsakis/followers",
      "following_url": "https://api.github.com/users/nikomatsakis/following{/other_user}",
      "gists_url": "https://api.github.com/users/nikomatsakis/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nikomatsakis/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nikomatsakis/subscriptions",
      "organizations_url": "https://api.github.com/users/nikomatsakis/orgs",
      "repos_url": "https://api.github.com/users/nikomatsakis/repos",
      "events_url": "https://api.github.com/users/nikomatsakis/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nikomatsakis/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-07-17T19:32:14Z",
    "updated_at": "2015-07-17T19:32:14Z",
    "body": "To be clear, I'd love to overcome have the original code work, but it'd require a fairly subtle typing rule to make it sound. I guess we could add a rule for subtyping of `&mut T` that is specific to the case where `T` is a trait object, but that doesn't feel very nice. (Not that I support this, but it's interesting to note that something like `&uniq T`, where you have uniqueness but not mutability, would of course be covariant.)\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/122386034/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/122488903",
    "html_url": "https://github.com/rust-lang/rust/issues/27031#issuecomment-122488903",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/27031",
    "id": 122488903,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEyMjQ4ODkwMw==",
    "user": {
      "login": "uzytkownik",
      "id": 5706,
      "node_id": "MDQ6VXNlcjU3MDY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5706?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/uzytkownik",
      "html_url": "https://github.com/uzytkownik",
      "followers_url": "https://api.github.com/users/uzytkownik/followers",
      "following_url": "https://api.github.com/users/uzytkownik/following{/other_user}",
      "gists_url": "https://api.github.com/users/uzytkownik/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/uzytkownik/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/uzytkownik/subscriptions",
      "organizations_url": "https://api.github.com/users/uzytkownik/orgs",
      "repos_url": "https://api.github.com/users/uzytkownik/repos",
      "events_url": "https://api.github.com/users/uzytkownik/events{/privacy}",
      "received_events_url": "https://api.github.com/users/uzytkownik/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-07-18T05:58:26Z",
    "updated_at": "2015-07-18T05:58:26Z",
    "body": "@nikomatsakis Initally I didn't have traits at all - it was closer to:\n\n``` rust\nenum Tree<T> {\n   Bin(*mut Tree<T>, T, *mut Tree<T>),\n   Leaf\n}\n\nenum TreeZipper<'a, T : 'a> {\n    Top,\n    Left(&'a mut TreeZipper<'a, T>, T, Tree<T>),\n    Right(Tree<T>, T, &'a mut TreeZipper<'a, T>)\n}\n\nfn cast<'a : 'b, 'b, T : 'a>(foo: TreeZipper<'a, T>) -> TreeZipper<'b, T> {\n    foo\n}\n```\n\n@arielb1 This still does no compile:\n\n``` rust\nenum BL<'a> {\n    Root,\n    Link(&'a mut BLLike, &'a mut u32)\n}\n\ntrait BLLike {\n    fn val(&mut self) -> BL;\n}\n\nfn cast<'a : 'b, 'b>(foo: BL<'a>) -> BL<'b> {foo}\n```\n",
    "author_association": "NONE",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/122488903/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/122530742",
    "html_url": "https://github.com/rust-lang/rust/issues/27031#issuecomment-122530742",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/27031",
    "id": 122530742,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEyMjUzMDc0Mg==",
    "user": {
      "login": "nikomatsakis",
      "id": 155238,
      "node_id": "MDQ6VXNlcjE1NTIzOA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/155238?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nikomatsakis",
      "html_url": "https://github.com/nikomatsakis",
      "followers_url": "https://api.github.com/users/nikomatsakis/followers",
      "following_url": "https://api.github.com/users/nikomatsakis/following{/other_user}",
      "gists_url": "https://api.github.com/users/nikomatsakis/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nikomatsakis/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nikomatsakis/subscriptions",
      "organizations_url": "https://api.github.com/users/nikomatsakis/orgs",
      "repos_url": "https://api.github.com/users/nikomatsakis/repos",
      "events_url": "https://api.github.com/users/nikomatsakis/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nikomatsakis/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-07-18T11:13:26Z",
    "updated_at": "2015-07-18T11:13:26Z",
    "body": "It is not a question of traits (in fact, my point was that traits are not special cased, which is why you get an error here). The point is that you have the reference to 'a inside the referent type in both cases (that is, the type that the &mut points at). That makes it \"invariant\", meaning it cannot be shortened (or else the language would be unsound). In the trait case however this is less obvious because it appears due to the implicit lifetime bound.\u00a0\n\nNiko\n\n<div>-------- Original message --------</div><div>From: Maciej Piechotka notifications@github.com </div><div>Date:07/18/2015  01:58  (GMT-05:00) </div><div>To: rust-lang/rust rust@noreply.github.com </div><div>Cc: Niko Matsakis niko@alum.mit.edu </div><div>Subject: Re: [rust] Rust does not allow narrowing the mutable references\n  (#27031) </div><div>\n</div>@nikomatsakis Initally I didn't have traits at all - it was closer to:\n\nenum Tree<T> {\n   Bin(*mut Tree<T>, T, *mut Tree<T>),\n   Leaf\n}\n\nenum TreeZipper<'a, T : 'a> {\n    Top,\n    Left(&'a mut TreeZipper<'a, T>, T, Tree<T>),\n    Right(Tree<T>, T, &'a mut TreeZipper<'a, T>)\n}\n\nfn cast<'a : 'b, 'b, T : 'a>(foo: TreeZipper<'a, T>) -> TreeZipper<'b, T> {\n    foo\n}\n@arielb1 This still does no compile:\n\nenum BL<'a> {\n    Root,\n    Link(&'a mut BLLike, &'a mut u32)\n}\n\ntrait BLLike {\n    fn val(&mut self) -> BL;\n}\n\nfn cast<'a : 'b, 'b>(foo: BL<'a>) -> BL<'b> {foo}\n\u2014\nReply to this email directly or view it on GitHub.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/122530742/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/122862104",
    "html_url": "https://github.com/rust-lang/rust/issues/27031#issuecomment-122862104",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/27031",
    "id": 122862104,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEyMjg2MjEwNA==",
    "user": {
      "login": "arielb1",
      "id": 1830974,
      "node_id": "MDQ6VXNlcjE4MzA5NzQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1830974?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/arielb1",
      "html_url": "https://github.com/arielb1",
      "followers_url": "https://api.github.com/users/arielb1/followers",
      "following_url": "https://api.github.com/users/arielb1/following{/other_user}",
      "gists_url": "https://api.github.com/users/arielb1/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/arielb1/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/arielb1/subscriptions",
      "organizations_url": "https://api.github.com/users/arielb1/orgs",
      "repos_url": "https://api.github.com/users/arielb1/repos",
      "events_url": "https://api.github.com/users/arielb1/events{/privacy}",
      "received_events_url": "https://api.github.com/users/arielb1/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-07-20T11:56:12Z",
    "updated_at": "2015-07-20T12:02:24Z",
    "body": "Anyway, you can bypass this by restructuring:\n\n``` Rust\nstruct Foo3<'a> {\n    a: &'a mut Fn(&'static str) -> u32 + 'a\n}\n\nfn foo3<'a : 'b, 'b>(foo: Foo3<'a>) -> Foo3<'b> {\n    match foo { Foo3 { a } => Foo3 { a: a }} \n}\n\nfn main() {}\n```\n\nIn the `BL` case:\n\n``` Rust\nenum BL<'a> {\n    Root,\n    Link(&'a mut BLLike, &'a mut u32)\n}\n\ntrait BLLike {\n    fn val(&mut self) -> BL;\n}\n\nfn cast<'a : 'b, 'b>(foo: BL<'a>) -> BL<'b> {\n    match foo { BL::Root => BL::Root, BL::Link(a,b) => BL::Link(a,b) }\n}\n```\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/122862104/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/122863843",
    "html_url": "https://github.com/rust-lang/rust/issues/27031#issuecomment-122863843",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/27031",
    "id": 122863843,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEyMjg2Mzg0Mw==",
    "user": {
      "login": "arielb1",
      "id": 1830974,
      "node_id": "MDQ6VXNlcjE4MzA5NzQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1830974?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/arielb1",
      "html_url": "https://github.com/arielb1",
      "followers_url": "https://api.github.com/users/arielb1/followers",
      "following_url": "https://api.github.com/users/arielb1/following{/other_user}",
      "gists_url": "https://api.github.com/users/arielb1/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/arielb1/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/arielb1/subscriptions",
      "organizations_url": "https://api.github.com/users/arielb1/orgs",
      "repos_url": "https://api.github.com/users/arielb1/repos",
      "events_url": "https://api.github.com/users/arielb1/events{/privacy}",
      "received_events_url": "https://api.github.com/users/arielb1/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-07-20T12:03:15Z",
    "updated_at": "2015-07-20T12:03:15Z",
    "body": "Anyway, this may be a reason to have `&uniq`, or equivalently use-site variance, so we don't need trait objects for this.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/122863843/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/270242281",
    "html_url": "https://github.com/rust-lang/rust/issues/27031#issuecomment-270242281",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/27031",
    "id": 270242281,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3MDI0MjI4MQ==",
    "user": {
      "login": "steveklabnik",
      "id": 27786,
      "node_id": "MDQ6VXNlcjI3Nzg2",
      "avatar_url": "https://avatars.githubusercontent.com/u/27786?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/steveklabnik",
      "html_url": "https://github.com/steveklabnik",
      "followers_url": "https://api.github.com/users/steveklabnik/followers",
      "following_url": "https://api.github.com/users/steveklabnik/following{/other_user}",
      "gists_url": "https://api.github.com/users/steveklabnik/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/steveklabnik/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/steveklabnik/subscriptions",
      "organizations_url": "https://api.github.com/users/steveklabnik/orgs",
      "repos_url": "https://api.github.com/users/steveklabnik/repos",
      "events_url": "https://api.github.com/users/steveklabnik/events{/privacy}",
      "received_events_url": "https://api.github.com/users/steveklabnik/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2017-01-03T22:22:04Z",
    "updated_at": "2017-01-03T22:22:04Z",
    "body": "So, years later: I think this ticket is basically not actionable, right? I would imagine something like\r\n\r\n> I'd love to overcome have the original code work, but it'd require a fairly subtle typing rule to make it sound. I guess we could add a rule for subtyping of &mut T that is specific to the case where T is a trait object, but that doesn't feel very nice.\r\n\r\nWould be RFC territory. Maybe not. I dunno.",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/270242281/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/270488432",
    "html_url": "https://github.com/rust-lang/rust/issues/27031#issuecomment-270488432",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/27031",
    "id": 270488432,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3MDQ4ODQzMg==",
    "user": {
      "login": "nikomatsakis",
      "id": 155238,
      "node_id": "MDQ6VXNlcjE1NTIzOA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/155238?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nikomatsakis",
      "html_url": "https://github.com/nikomatsakis",
      "followers_url": "https://api.github.com/users/nikomatsakis/followers",
      "following_url": "https://api.github.com/users/nikomatsakis/following{/other_user}",
      "gists_url": "https://api.github.com/users/nikomatsakis/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nikomatsakis/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nikomatsakis/subscriptions",
      "organizations_url": "https://api.github.com/users/nikomatsakis/orgs",
      "repos_url": "https://api.github.com/users/nikomatsakis/repos",
      "events_url": "https://api.github.com/users/nikomatsakis/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nikomatsakis/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2017-01-04T21:15:02Z",
    "updated_at": "2017-01-04T21:15:02Z",
    "body": "I think we should close this. It's a...quirk of the type system. =) ",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/270488432/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
