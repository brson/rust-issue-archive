{
  "url": "https://api.github.com/repos/rust-lang/rust/issues/4035",
  "repository_url": "https://api.github.com/repos/rust-lang/rust",
  "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/4035/labels{/name}",
  "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/4035/comments",
  "events_url": "https://api.github.com/repos/rust-lang/rust/issues/4035/events",
  "html_url": "https://github.com/rust-lang/rust/pull/4035",
  "id": 8639903,
  "node_id": "MDExOlB1bGxSZXF1ZXN0MzExMzU2OQ==",
  "number": 4035,
  "title": "Remove the crate language",
  "user": {
    "login": "brson",
    "id": 147214,
    "node_id": "MDQ6VXNlcjE0NzIxNA==",
    "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/brson",
    "html_url": "https://github.com/brson",
    "followers_url": "https://api.github.com/users/brson/followers",
    "following_url": "https://api.github.com/users/brson/following{/other_user}",
    "gists_url": "https://api.github.com/users/brson/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/brson/subscriptions",
    "organizations_url": "https://api.github.com/users/brson/orgs",
    "repos_url": "https://api.github.com/users/brson/repos",
    "events_url": "https://api.github.com/users/brson/events{/privacy}",
    "received_events_url": "https://api.github.com/users/brson/received_events",
    "type": "User",
    "user_view_type": "public",
    "site_admin": false
  },
  "labels": [],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [],
  "milestone": null,
  "comments": 3,
  "created_at": "2012-11-25T01:45:10Z",
  "updated_at": "2014-06-23T00:59:37Z",
  "closed_at": "2012-11-28T21:34:41Z",
  "author_association": "CONTRIBUTOR",
  "type": null,
  "active_lock_reason": null,
  "draft": false,
  "pull_request": {
    "url": "https://api.github.com/repos/rust-lang/rust/pulls/4035",
    "html_url": "https://github.com/rust-lang/rust/pull/4035",
    "diff_url": "https://github.com/rust-lang/rust/pull/4035.diff",
    "patch_url": "https://github.com/rust-lang/rust/pull/4035.patch",
    "merged_at": "2012-11-28T21:34:41Z"
  },
  "body": "r? @graydon, @nikomatsakis\n\nWorking towards #2176\n\nThis series completely removes the special language for .rc files. It uses several hacks required until the next snapshot.\n\nAfter this is completed .rc files will be parsed exactly the same as .rs files and companion mods will no longer exist, either at the crate level or directory level.\n\nThere's not a whole lot to review here, as it's just rewriting the crate files to use features compatible with the new model, but it is a big change.\n\nThere are two notable side-effects of this change:\n\n1) The int-template and iter-trait hacks used a latent property of our directory companion mods to 'merge' the contents of two different files into a single module. In lieu of item macros this will be supported by a new parser hack that uses a `#[merge = \"path/to/file.rs\"]` attribute.\n\n2) There will no longer be any in-language notion of directory structure. Through ongoing discussions it's not obvious what the right solution to this is. In the meantime, crates can use `#[path = \"path/to/file.rs\"]` to impose any directory structure they want. I think this itself is a decent compromise, gives us room to experiment with the correct patterns here.\n\nIn the medium-term, the rust repo itself will prefer the following pattern to create directory structure:\n\nrustc.rc:\n\n```\n#[path = \"front/mod.rs\"]\nmod front;\n#[path = \"middle/mod.rs\"]\nmod middle;\n#[path = \"back/mod.rs\"]\nmod back;\n```\n\nfront/mod.rs:\n\n```\nmod core_inject;\nmod test;\n```\n\nModules that are stored in directories will use a `mod.rs` file _inside_ the directory (vs. today's code where the mod file is _outside_ the directory).\n\nTransitional ugliness:\n- core, std, syntax, and rustc are all using a massive hack to force stage0 to use one crate file and the others to use a different one. Files that begin with `// DIVERT` are automatically parsed from a different file called `alternate_crate.rc`. This allows stage0 to continue using it's directory modules while stage1+ use the above described strategy.\n- There's a lot of usage of the new `#[merge]` attribute, but these are transitional except for the ones in core that implement iter-trait, etc.\n",
  "closed_by": {
    "login": "brson",
    "id": 147214,
    "node_id": "MDQ6VXNlcjE0NzIxNA==",
    "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/brson",
    "html_url": "https://github.com/brson",
    "followers_url": "https://api.github.com/users/brson/followers",
    "following_url": "https://api.github.com/users/brson/following{/other_user}",
    "gists_url": "https://api.github.com/users/brson/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/brson/subscriptions",
    "organizations_url": "https://api.github.com/users/brson/orgs",
    "repos_url": "https://api.github.com/users/brson/repos",
    "events_url": "https://api.github.com/users/brson/events{/privacy}",
    "received_events_url": "https://api.github.com/users/brson/received_events",
    "type": "User",
    "user_view_type": "public",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/4035/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/4035/timeline",
  "performed_via_github_app": null,
  "state_reason": null,
  "_meta": {
    "type": "pr"
  }
}
