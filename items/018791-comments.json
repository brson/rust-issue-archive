[
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/62293949",
    "html_url": "https://github.com/rust-lang/rust/issues/18791#issuecomment-62293949",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/18791",
    "id": 62293949,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYyMjkzOTQ5",
    "user": {
      "login": "soltanmm",
      "id": 4889063,
      "node_id": "MDQ6VXNlcjQ4ODkwNjM=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4889063?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/soltanmm",
      "html_url": "https://github.com/soltanmm",
      "followers_url": "https://api.github.com/users/soltanmm/followers",
      "following_url": "https://api.github.com/users/soltanmm/following{/other_user}",
      "gists_url": "https://api.github.com/users/soltanmm/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/soltanmm/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/soltanmm/subscriptions",
      "organizations_url": "https://api.github.com/users/soltanmm/orgs",
      "repos_url": "https://api.github.com/users/soltanmm/repos",
      "events_url": "https://api.github.com/users/soltanmm/events{/privacy}",
      "received_events_url": "https://api.github.com/users/soltanmm/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-11-09T07:01:11Z",
    "updated_at": "2014-11-09T07:01:41Z",
    "body": "Using the following code I cannot reproduce the error on Linux (w/ rustc from most recent commit: a2f303ad098844351d08800038a4f99fa2ff0817).\n\n```\n#![feature(non_ascii_idents)]\nfn main() {\n    fn simulate() -> Vec<Coord> { vec![] }\n    struct Coord { t: f64, \u03b8: f64 }\n    let data: Vec<Coord> = simulate();\n    let t = data.iter().map(|d| d.t);\n    let \u03b8 = data.iter().map(|d| d.\u03b8);\n}\n```\n",
    "author_association": "NONE",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/62293949/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/62306097",
    "html_url": "https://github.com/rust-lang/rust/issues/18791#issuecomment-62306097",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/18791",
    "id": 62306097,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYyMzA2MDk3",
    "user": {
      "login": "sourtin",
      "id": 3945901,
      "node_id": "MDQ6VXNlcjM5NDU5MDE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3945901?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sourtin",
      "html_url": "https://github.com/sourtin",
      "followers_url": "https://api.github.com/users/sourtin/followers",
      "following_url": "https://api.github.com/users/sourtin/following{/other_user}",
      "gists_url": "https://api.github.com/users/sourtin/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sourtin/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sourtin/subscriptions",
      "organizations_url": "https://api.github.com/users/sourtin/orgs",
      "repos_url": "https://api.github.com/users/sourtin/repos",
      "events_url": "https://api.github.com/users/sourtin/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sourtin/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-11-09T15:02:02Z",
    "updated_at": "2014-11-09T15:02:02Z",
    "body": "Hmm weird, rustc has no problem but cargo does. I'm using the rust-nightly and cargo-nightly packages from https://github.com/tomcheung789/homebrew-rust, which appear to download and compile the sources directly from https://static.rust-lang.org/dist/rust-nightly.tar.gz and https://github.com/rust-lang/cargo/archive/master.tar.gz respectively. \n\nThe full error I get is\n\n```\nerror: internal compiler error: unexpected panic\nnote: the compiler unexpectedly panicked. this is a bug.\nnote: we would appreciate a bug report: http://doc.rust-lang.org/complement-bugreport.html\nnote: run with `RUST_BACKTRACE=1` for a backtrace\ntask 'rustc' panicked at 'assertion failed: bpos.to_uint() >= mbc.pos.to_uint() + mbc.bytes', /private/tmp/rust-nightly-lvT20f/rust-nightly/src/libsyntax/codemap.rs:471\n```\n\nI assumed cargo used the same rustc binary. I ran cargo in verbose mode and found out that running `rustc -g` gave the same error. Are non-ascii identifiers compatible with DWARF debug information?\n",
    "author_association": "NONE",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/62306097/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/64745548",
    "html_url": "https://github.com/rust-lang/rust/issues/18791#issuecomment-64745548",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/18791",
    "id": 64745548,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY0NzQ1NTQ4",
    "user": {
      "login": "nodakai",
      "id": 90726,
      "node_id": "MDQ6VXNlcjkwNzI2",
      "avatar_url": "https://avatars.githubusercontent.com/u/90726?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nodakai",
      "html_url": "https://github.com/nodakai",
      "followers_url": "https://api.github.com/users/nodakai/followers",
      "following_url": "https://api.github.com/users/nodakai/following{/other_user}",
      "gists_url": "https://api.github.com/users/nodakai/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nodakai/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nodakai/subscriptions",
      "organizations_url": "https://api.github.com/users/nodakai/orgs",
      "repos_url": "https://api.github.com/users/nodakai/repos",
      "events_url": "https://api.github.com/users/nodakai/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nodakai/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-11-27T04:43:01Z",
    "updated_at": "2014-11-27T04:44:30Z",
    "body": "Minimized down to\n\n``` rust\n#![feature(non_ascii_idents)]\n\nstruct C { \u03b8: u8 }\nfn main() {\n    let x =  C { \u03b8: 0 };\n    (|c: C| c.\u03b8 )(x);\n}\n```\n\nThe backtrace is shown at the end of this post.\n\nInterestingly, we don't hit the ICE with this variation (note the braces to form a closure!)\n\n``` rust\n#![feature(non_ascii_idents)]\n\nstruct C { \u03b8: u8 }\nfn main() {\n    let x =  C { \u03b8: 0 };\n    (|c: C| {c.\u03b8} )(x);\n}\n```\n\nI suspect a closure w/o braces might violate the assumption of this piece of code in `src/librustc_trans/trans/debuginfo.rs`:\n\n``` rust\npub fn get_cleanup_debug_loc_for_ast_node(...\n...\n    let cleanup_span = if is_block {\n        Span {\n            lo: node_span.hi - codemap::BytePos(1), // closing brace should always be 1 byte...\n            hi: node_span.hi,\n            expn_id: node_span.expn_id\n        }\n...\n```\n\n@michaelwoerister Can you have a look at it?\n\n```\n$ RUST_BACKTRACE=1 rustc -g non-ascii.rs\nerror: internal compiler error: unexpected panic\nnote: the compiler unexpectedly panicked. this is a bug.\nnote: we would appreciate a bug report: http://doc.rust-lang.org/complement-bugreport.html\nnote: run with `RUST_BACKTRACE=1` for a backtrace\ntask 'rustc' panicked at 'assertion failed: bpos.to_uint() >= mbc.pos.to_uint() + mbc.bytes', /home/nodakai/src/rust-HEAD/src/libsyntax/codemap.rs:475\n\nstack backtrace:\n   1:     0x7ffe0c6fd270 - rt::backtrace::imp::write::ha585e5f8e2609f1519x\n   2:     0x7ffe0c700340 - failure::on_fail::h6dd1e7919800eb47kCy\n   3:     0x7ffe0c355c90 - unwind::begin_unwind_inner::hed0bde6d9fb3da6e0Qc\n   4:     0x7ffe0a1ad980 - unwind::begin_unwind::h14872294802461399175\n   5:     0x7ffe0a220390 - codemap::CodeMap::bytepos_to_file_charpos::he92e47167fafc5d7NkF\n   6:     0x7ffe0a21ea00 - codemap::CodeMap::lookup_char_pos::h8f67dae5c50d7de6jdF\n   7:     0x7ffe0cbc8820 - trans::debuginfo::set_source_location::hc856b9f5576c6f8cQmF\n   8:     0x7ffe0ccea490 - trans::cleanup::LifetimeEnd.Cleanup<'tcx>::trans::hf7be10cbd942b3ffWnN\n   9:     0x7ffe0cbc2350 - trans::cleanup::FunctionContext<'blk, 'tcx>.CleanupMethods<'blk, 'tcx>::pop_and_trans_custom_cleanup_scope::h98c60c7ce929177aLaM\n  10:     0x7ffe0cc64740 - trans::base::trans_closure::h2d576bfe5ee927a2tDu\n  11:     0x7ffe0cc0a8a0 - trans::closure::trans_expr_fn::h960d345b7bd90b29CZy\n  12:     0x7ffe0cbf48c0 - trans::expr::trans_rvalue_dps_unadjusted::hd6454136eddfd073wnj\n  13:     0x7ffe0cbb1030 - trans::expr::trans_into::h21ce62673084950ehQh\n  14:     0x7ffe0cbf48c0 - trans::expr::trans_rvalue_dps_unadjusted::hd6454136eddfd073wnj\n  15:     0x7ffe0cbf3100 - trans::expr::trans_unadjusted::he13d84d9b3d75b34iJi\n  16:     0x7ffe0cbb2960 - trans::expr::trans::h144c957bbc3b0c38dUh\n  17:     0x7ffe0cbd8720 - trans::callee::trans::datum_callee::h6ec536d9aa4c6b7ePmg\n  18:     0x7ffe0cbe62c0 - trans::callee::trans_call::closure.40864\n  19:     0x7ffe0cbb9df0 - trans::callee::trans_call_inner::h1d40ce239697ef3dY5g\n  20:     0x7ffe0cbe5ee0 - trans::callee::trans_call::h062189439456ee3ea0g\n  21:     0x7ffe0cbf48c0 - trans::expr::trans_rvalue_dps_unadjusted::hd6454136eddfd073wnj\n  22:     0x7ffe0cbb1030 - trans::expr::trans_into::h21ce62673084950ehQh\n  23:     0x7ffe0cbb0430 - trans::controlflow::trans_stmt_semi::h4397bf973f5f306br1d\n  24:     0x7ffe0cbaf9e0 - trans::controlflow::trans_stmt::h54ea715314dd2a99cXd\n  25:     0x7ffe0cbb1600 - trans::controlflow::trans_block::he5cc88c0ba3d6142k2d\n  26:     0x7ffe0cc64740 - trans::base::trans_closure::h2d576bfe5ee927a2tDu\n  27:     0x7ffe0cba3600 - trans::base::trans_fn::h45c22622c0be15d1jPu\n  28:     0x7ffe0cba05f0 - trans::base::trans_item::hfd6bcd0a16e07f623av\n  29:     0x7ffe0cc690c0 - trans::base::trans_mod::h696cd29b0c68c44fygv\n  30:     0x7ffe0cc6fee0 - trans::base::trans_crate::h71e6143e68c64059n9v\n  31:     0x7ffe0cd1ca50 - driver::driver::phase_4_translate_to_llvm::h102b402fb473e39bPvS\n  32:     0x7ffe0cd0a270 - driver::driver::compile_input::h5a8de67c93dd173512R\n  33:     0x7ffe0cd8e2f0 - driver::run_compiler::h87d0535582c0ee1690T\n  34:     0x7ffe0cd8e1e0 - driver::run::closure.59902\n  35:     0x7ffe0cb95c70 - task::TaskBuilder::try_future::closure.39018\n  36:     0x7ffe0c6cded0 - task::TaskBuilder::spawn_internal::closure.30320\n  37:     0x7ffe0c353a70 - task::Task::spawn::closure.5727\n  38:     0x7ffe0c3adde0 - rust_try_inner\n  39:     0x7ffe0c3addd0 - rust_try\n  40:     0x7ffe0c353b50 - unwind::try::hbf037d32604be4a0lFc\n  41:     0x7ffe0c353910 - task::Task::run::h72992392502d45b4eOb\n  42:     0x7ffe0c353500 - task::Task::spawn::closure.5703\n  43:     0x7ffe0c354f50 - thread::thread_start::h26578c9615c56832h6b\n  44:     0x7ffe0721cdc0 - start_thread\n  45:                0x0 - <unknown>\n```\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/64745548/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/64758704",
    "html_url": "https://github.com/rust-lang/rust/issues/18791#issuecomment-64758704",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/18791",
    "id": 64758704,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY0NzU4NzA0",
    "user": {
      "login": "michaelwoerister",
      "id": 1825894,
      "node_id": "MDQ6VXNlcjE4MjU4OTQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1825894?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/michaelwoerister",
      "html_url": "https://github.com/michaelwoerister",
      "followers_url": "https://api.github.com/users/michaelwoerister/followers",
      "following_url": "https://api.github.com/users/michaelwoerister/following{/other_user}",
      "gists_url": "https://api.github.com/users/michaelwoerister/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/michaelwoerister/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/michaelwoerister/subscriptions",
      "organizations_url": "https://api.github.com/users/michaelwoerister/orgs",
      "repos_url": "https://api.github.com/users/michaelwoerister/repos",
      "events_url": "https://api.github.com/users/michaelwoerister/events{/privacy}",
      "received_events_url": "https://api.github.com/users/michaelwoerister/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-11-27T08:22:49Z",
    "updated_at": "2014-11-27T08:22:49Z",
    "body": "Good catch, @nodakai!\nThis is indeed a case where we don't have a closing brace on a block and the `bytepos - 1` will point into the middle of a multibyte character, which causes the crash when trying to convert the byte offset to file/line/column format. I'll look into it.\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/64758704/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
