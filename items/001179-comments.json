[
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/2750093",
    "html_url": "https://github.com/rust-lang/rust/issues/1179#issuecomment-2750093",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/1179",
    "id": 2750093,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3NTAwOTM=",
    "user": {
      "login": "nikomatsakis",
      "id": 155238,
      "node_id": "MDQ6VXNlcjE1NTIzOA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/155238?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nikomatsakis",
      "html_url": "https://github.com/nikomatsakis",
      "followers_url": "https://api.github.com/users/nikomatsakis/followers",
      "following_url": "https://api.github.com/users/nikomatsakis/following{/other_user}",
      "gists_url": "https://api.github.com/users/nikomatsakis/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nikomatsakis/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nikomatsakis/subscriptions",
      "organizations_url": "https://api.github.com/users/nikomatsakis/orgs",
      "repos_url": "https://api.github.com/users/nikomatsakis/repos",
      "events_url": "https://api.github.com/users/nikomatsakis/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nikomatsakis/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2011-11-15T19:45:07Z",
    "updated_at": "2011-11-15T19:45:07Z",
    "body": "I am in favor.  This would solve #1174, #1058, and #1059.  I would be happy to implement it as well.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/2750093/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/2750369",
    "html_url": "https://github.com/rust-lang/rust/issues/1179#issuecomment-2750369",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/1179",
    "id": 2750369,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3NTAzNjk=",
    "user": {
      "login": "brson",
      "id": 147214,
      "node_id": "MDQ6VXNlcjE0NzIxNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/brson",
      "html_url": "https://github.com/brson",
      "followers_url": "https://api.github.com/users/brson/followers",
      "following_url": "https://api.github.com/users/brson/following{/other_user}",
      "gists_url": "https://api.github.com/users/brson/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/brson/subscriptions",
      "organizations_url": "https://api.github.com/users/brson/orgs",
      "repos_url": "https://api.github.com/users/brson/repos",
      "events_url": "https://api.github.com/users/brson/events{/privacy}",
      "received_events_url": "https://api.github.com/users/brson/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2011-11-15T20:04:21Z",
    "updated_at": "2011-11-15T20:04:21Z",
    "body": "This would mean that you can't get a pointer to a C function\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/2750369/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/2750401",
    "html_url": "https://github.com/rust-lang/rust/issues/1179#issuecomment-2750401",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/1179",
    "id": 2750401,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3NTA0MDE=",
    "user": {
      "login": "nikomatsakis",
      "id": 155238,
      "node_id": "MDQ6VXNlcjE1NTIzOA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/155238?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nikomatsakis",
      "html_url": "https://github.com/nikomatsakis",
      "followers_url": "https://api.github.com/users/nikomatsakis/followers",
      "following_url": "https://api.github.com/users/nikomatsakis/following{/other_user}",
      "gists_url": "https://api.github.com/users/nikomatsakis/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nikomatsakis/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nikomatsakis/subscriptions",
      "organizations_url": "https://api.github.com/users/nikomatsakis/orgs",
      "repos_url": "https://api.github.com/users/nikomatsakis/repos",
      "events_url": "https://api.github.com/users/nikomatsakis/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nikomatsakis/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2011-11-15T20:06:48Z",
    "updated_at": "2011-11-15T20:06:48Z",
    "body": "Yes, that is true.  I guess I can imagine that it might be useful to be able to get pointers to C functions for interop or something like that, but it's probably fairly uncommon.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/2750401/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/2757143",
    "html_url": "https://github.com/rust-lang/rust/issues/1179#issuecomment-2757143",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/1179",
    "id": 2757143,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3NTcxNDM=",
    "user": {
      "login": "marijnh",
      "id": 144427,
      "node_id": "MDQ6VXNlcjE0NDQyNw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/144427?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/marijnh",
      "html_url": "https://github.com/marijnh",
      "followers_url": "https://api.github.com/users/marijnh/followers",
      "following_url": "https://api.github.com/users/marijnh/following{/other_user}",
      "gists_url": "https://api.github.com/users/marijnh/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/marijnh/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/marijnh/subscriptions",
      "organizations_url": "https://api.github.com/users/marijnh/orgs",
      "repos_url": "https://api.github.com/users/marijnh/repos",
      "events_url": "https://api.github.com/users/marijnh/events{/privacy}",
      "received_events_url": "https://api.github.com/users/marijnh/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2011-11-16T08:44:40Z",
    "updated_at": "2011-11-16T08:44:40Z",
    "body": "I'd like a scheme where static calls to native functions directly use (when possible) the function's calling conventions, but taking the value of such a function generates a wrapper that follows our own calling convention. This imposes minimal run-time and code-size overhead, without complicating things for language users.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/2757143/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/2764572",
    "html_url": "https://github.com/rust-lang/rust/issues/1179#issuecomment-2764572",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/1179",
    "id": 2764572,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3NjQ1NzI=",
    "user": {
      "login": "nikomatsakis",
      "id": 155238,
      "node_id": "MDQ6VXNlcjE1NTIzOA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/155238?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nikomatsakis",
      "html_url": "https://github.com/nikomatsakis",
      "followers_url": "https://api.github.com/users/nikomatsakis/followers",
      "following_url": "https://api.github.com/users/nikomatsakis/following{/other_user}",
      "gists_url": "https://api.github.com/users/nikomatsakis/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nikomatsakis/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nikomatsakis/subscriptions",
      "organizations_url": "https://api.github.com/users/nikomatsakis/orgs",
      "repos_url": "https://api.github.com/users/nikomatsakis/repos",
      "events_url": "https://api.github.com/users/nikomatsakis/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nikomatsakis/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2011-11-16T17:21:52Z",
    "updated_at": "2011-11-16T17:21:52Z",
    "body": "Hmm... I do not think it would be very hard to implement a scheme like Marijn's.  That said, assuming native functions are called from multiple sites, wrappers would likely save code size overall because there is no need to inline the stack switching logic at each call site to a native function.  I would expect performance impact to be minimal, but it is harder to predict: it depends on the target architecture and the signature of the target method.  \n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/2764572/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/2764784",
    "html_url": "https://github.com/rust-lang/rust/issues/1179#issuecomment-2764784",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/1179",
    "id": 2764784,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3NjQ3ODQ=",
    "user": {
      "login": "brson",
      "id": 147214,
      "node_id": "MDQ6VXNlcjE0NzIxNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/brson",
      "html_url": "https://github.com/brson",
      "followers_url": "https://api.github.com/users/brson/followers",
      "following_url": "https://api.github.com/users/brson/following{/other_user}",
      "gists_url": "https://api.github.com/users/brson/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/brson/subscriptions",
      "organizations_url": "https://api.github.com/users/brson/orgs",
      "repos_url": "https://api.github.com/users/brson/repos",
      "events_url": "https://api.github.com/users/brson/events{/privacy}",
      "received_events_url": "https://api.github.com/users/brson/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2011-11-16T17:37:37Z",
    "updated_at": "2011-11-16T17:37:37Z",
    "body": "Allowing calls to use the native convention means we need to keep the ABI as part of the function type (or disallow calling native functions across crates), and I was hoping we could get rid of that. My reason for wanting to do that is pretty weak though - it's just because I'm making ABI an attribute of native modules, and it doesn't seem right to express type information as metadata.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/2764784/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/2765060",
    "html_url": "https://github.com/rust-lang/rust/issues/1179#issuecomment-2765060",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/1179",
    "id": 2765060,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3NjUwNjA=",
    "user": {
      "login": "marijnh",
      "id": 144427,
      "node_id": "MDQ6VXNlcjE0NDQyNw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/144427?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/marijnh",
      "html_url": "https://github.com/marijnh",
      "followers_url": "https://api.github.com/users/marijnh/followers",
      "following_url": "https://api.github.com/users/marijnh/following{/other_user}",
      "gists_url": "https://api.github.com/users/marijnh/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/marijnh/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/marijnh/subscriptions",
      "organizations_url": "https://api.github.com/users/marijnh/orgs",
      "repos_url": "https://api.github.com/users/marijnh/repos",
      "events_url": "https://api.github.com/users/marijnh/events{/privacy}",
      "received_events_url": "https://api.github.com/users/marijnh/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2011-11-16T17:54:30Z",
    "updated_at": "2011-11-16T17:54:30Z",
    "body": "It doesn't have to be part of the _type_, but to do direct native calls, calling conventions do have to be associated with static function names (def ids). That's not hard to orchestrate, though.\n\nNiko may be right that, for involved calling conventions, generating a wrapper might be cheaper.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/2765060/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/2765189",
    "html_url": "https://github.com/rust-lang/rust/issues/1179#issuecomment-2765189",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/1179",
    "id": 2765189,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3NjUxODk=",
    "user": {
      "login": "nikomatsakis",
      "id": 155238,
      "node_id": "MDQ6VXNlcjE1NTIzOA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/155238?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nikomatsakis",
      "html_url": "https://github.com/nikomatsakis",
      "followers_url": "https://api.github.com/users/nikomatsakis/followers",
      "following_url": "https://api.github.com/users/nikomatsakis/following{/other_user}",
      "gists_url": "https://api.github.com/users/nikomatsakis/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nikomatsakis/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nikomatsakis/subscriptions",
      "organizations_url": "https://api.github.com/users/nikomatsakis/orgs",
      "repos_url": "https://api.github.com/users/nikomatsakis/repos",
      "events_url": "https://api.github.com/users/nikomatsakis/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nikomatsakis/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2011-11-16T18:02:29Z",
    "updated_at": "2011-11-16T18:02:29Z",
    "body": "Even on a simple calling convention, we currently generate 2 function calls: one to allocate space for the arguments on the C stack, the other to the \"call on C stack\" function.  Actually, now that I think about it, allocating space on the C stack is not so important (currently), as we end up copying the data in the shim function.  It may be better, therefore, to have LLVM allocate the argument structure on the Rust stack, where the allocation is free as part of the initial stack frame allocation.  \n\nThat said, we may at some point want to special case the i386 architecture, in which case allocating the structure on the C stack (as we do today) is better, since it avoids a copy of the arguments.  \n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/2765189/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/2796220",
    "html_url": "https://github.com/rust-lang/rust/issues/1179#issuecomment-2796220",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/1179",
    "id": 2796220,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3OTYyMjA=",
    "user": {
      "login": "nikomatsakis",
      "id": 155238,
      "node_id": "MDQ6VXNlcjE1NTIzOA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/155238?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nikomatsakis",
      "html_url": "https://github.com/nikomatsakis",
      "followers_url": "https://api.github.com/users/nikomatsakis/followers",
      "following_url": "https://api.github.com/users/nikomatsakis/following{/other_user}",
      "gists_url": "https://api.github.com/users/nikomatsakis/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nikomatsakis/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nikomatsakis/subscriptions",
      "organizations_url": "https://api.github.com/users/nikomatsakis/orgs",
      "repos_url": "https://api.github.com/users/nikomatsakis/repos",
      "events_url": "https://api.github.com/users/nikomatsakis/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nikomatsakis/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2011-11-19T00:13:39Z",
    "updated_at": "2011-11-19T00:13:39Z",
    "body": "It occurs to me that if LLVM inlines the calls to the wrapper functions---as it could likely be convinced to do, as they are small and statically linked most of the time---then we would have the system that Marijn wanted without having to implement it ourselves (to get the code size reduction, though, we'd have to have the linker strip functions that are neither referenced nor exported, but that's something else we should be doing anyhow, I would think)\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/2796220/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/2796907",
    "html_url": "https://github.com/rust-lang/rust/issues/1179#issuecomment-2796907",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/1179",
    "id": 2796907,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3OTY5MDc=",
    "user": {
      "login": "nikomatsakis",
      "id": 155238,
      "node_id": "MDQ6VXNlcjE1NTIzOA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/155238?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nikomatsakis",
      "html_url": "https://github.com/nikomatsakis",
      "followers_url": "https://api.github.com/users/nikomatsakis/followers",
      "following_url": "https://api.github.com/users/nikomatsakis/following{/other_user}",
      "gists_url": "https://api.github.com/users/nikomatsakis/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nikomatsakis/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nikomatsakis/subscriptions",
      "organizations_url": "https://api.github.com/users/nikomatsakis/orgs",
      "repos_url": "https://api.github.com/users/nikomatsakis/repos",
      "events_url": "https://api.github.com/users/nikomatsakis/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nikomatsakis/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2011-11-19T02:04:55Z",
    "updated_at": "2011-11-19T02:04:55Z",
    "body": "Implemented wrappers in @b6af844.  Will open a follow-up bug to investigate inlining or other performance improvements.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/2796907/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
