[
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/19702942",
    "html_url": "https://github.com/rust-lang/rust/issues/7235#issuecomment-19702942",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/7235",
    "id": 19702942,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE5NzAyOTQy",
    "user": {
      "login": "graydon",
      "id": 14097,
      "node_id": "MDQ6VXNlcjE0MDk3",
      "avatar_url": "https://avatars.githubusercontent.com/u/14097?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/graydon",
      "html_url": "https://github.com/graydon",
      "followers_url": "https://api.github.com/users/graydon/followers",
      "following_url": "https://api.github.com/users/graydon/following{/other_user}",
      "gists_url": "https://api.github.com/users/graydon/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/graydon/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/graydon/subscriptions",
      "organizations_url": "https://api.github.com/users/graydon/orgs",
      "repos_url": "https://api.github.com/users/graydon/repos",
      "events_url": "https://api.github.com/users/graydon/events{/privacy}",
      "received_events_url": "https://api.github.com/users/graydon/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2013-06-19T18:17:14Z",
    "updated_at": "2013-06-19T18:17:14Z",
    "body": "nominating for backwards compatibility\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/19702942/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/19703023",
    "html_url": "https://github.com/rust-lang/rust/issues/7235#issuecomment-19703023",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/7235",
    "id": 19703023,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE5NzAzMDIz",
    "user": {
      "login": "lilyball",
      "id": 714,
      "node_id": "MDQ6VXNlcjcxNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/714?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/lilyball",
      "html_url": "https://github.com/lilyball",
      "followers_url": "https://api.github.com/users/lilyball/followers",
      "following_url": "https://api.github.com/users/lilyball/following{/other_user}",
      "gists_url": "https://api.github.com/users/lilyball/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/lilyball/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/lilyball/subscriptions",
      "organizations_url": "https://api.github.com/users/lilyball/orgs",
      "repos_url": "https://api.github.com/users/lilyball/repos",
      "events_url": "https://api.github.com/users/lilyball/events{/privacy}",
      "received_events_url": "https://api.github.com/users/lilyball/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2013-06-19T18:18:20Z",
    "updated_at": "2013-06-19T18:18:20Z",
    "body": "CStrings, by definition, are null-terminated, so I don't see any reason to change the name away from `.as_c_str()`.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/19703023/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/19703121",
    "html_url": "https://github.com/rust-lang/rust/issues/7235#issuecomment-19703121",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/7235",
    "id": 19703121,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE5NzAzMTIx",
    "user": {
      "login": "emberian",
      "id": 704250,
      "node_id": "MDQ6VXNlcjcwNDI1MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/704250?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/emberian",
      "html_url": "https://github.com/emberian",
      "followers_url": "https://api.github.com/users/emberian/followers",
      "following_url": "https://api.github.com/users/emberian/following{/other_user}",
      "gists_url": "https://api.github.com/users/emberian/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/emberian/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/emberian/subscriptions",
      "organizations_url": "https://api.github.com/users/emberian/orgs",
      "repos_url": "https://api.github.com/users/emberian/repos",
      "events_url": "https://api.github.com/users/emberian/events{/privacy}",
      "received_events_url": "https://api.github.com/users/emberian/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2013-06-19T18:19:45Z",
    "updated_at": "2013-06-19T18:19:45Z",
    "body": "@kballard because rust strings, as valid utf-8, can contain NUL. Thus, not all rust strings from as_c_str are the C string you would expect. Naming it away from as_c_str emphasizes this.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/19703121/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/19703150",
    "html_url": "https://github.com/rust-lang/rust/issues/7235#issuecomment-19703150",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/7235",
    "id": 19703150,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE5NzAzMTUw",
    "user": {
      "login": "thestinger",
      "id": 1505226,
      "node_id": "MDQ6VXNlcjE1MDUyMjY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1505226?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/thestinger",
      "html_url": "https://github.com/thestinger",
      "followers_url": "https://api.github.com/users/thestinger/followers",
      "following_url": "https://api.github.com/users/thestinger/following{/other_user}",
      "gists_url": "https://api.github.com/users/thestinger/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/thestinger/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/thestinger/subscriptions",
      "organizations_url": "https://api.github.com/users/thestinger/orgs",
      "repos_url": "https://api.github.com/users/thestinger/repos",
      "events_url": "https://api.github.com/users/thestinger/events{/privacy}",
      "received_events_url": "https://api.github.com/users/thestinger/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2013-06-19T18:20:09Z",
    "updated_at": "2013-06-19T18:25:52Z",
    "body": "I don't think we should have a shortcut for temporarily copying to a nul-terminated string at all. Anything using `\\0` as a string terminator doesn't support UTF-8, because they are valid characters in a Unicode string.\n\n The most common usage of nul-termination is likely to be paths, but those can't be represented with our string type because they aren't always valid Unicode so it's not something the string type can deal with.\n\nIn special cases where you really do want to abandon all hope of correctness, you can just push `\\0` to the end yourself or make a copy and push it. This is potentially a security issue, because string comparisons or other operations stopping at the `\\0` will be incorrect. Is there actually a use case for handling only a subset of possible strings correctly?\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/19703150/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/19703316",
    "html_url": "https://github.com/rust-lang/rust/issues/7235#issuecomment-19703316",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/7235",
    "id": 19703316,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE5NzAzMzE2",
    "user": {
      "login": "lilyball",
      "id": 714,
      "node_id": "MDQ6VXNlcjcxNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/714?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/lilyball",
      "html_url": "https://github.com/lilyball",
      "followers_url": "https://api.github.com/users/lilyball/followers",
      "following_url": "https://api.github.com/users/lilyball/following{/other_user}",
      "gists_url": "https://api.github.com/users/lilyball/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/lilyball/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/lilyball/subscriptions",
      "organizations_url": "https://api.github.com/users/lilyball/orgs",
      "repos_url": "https://api.github.com/users/lilyball/repos",
      "events_url": "https://api.github.com/users/lilyball/events{/privacy}",
      "received_events_url": "https://api.github.com/users/lilyball/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2013-06-19T18:22:18Z",
    "updated_at": "2013-06-19T18:22:18Z",
    "body": "@cmr: Naming it something like `.as_null_terminated_c_str()` doesn't change the fact that it could contain NUL.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/19703316/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/19706809",
    "html_url": "https://github.com/rust-lang/rust/issues/7235#issuecomment-19706809",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/7235",
    "id": 19706809,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE5NzA2ODA5",
    "user": {
      "login": "Kimundi",
      "id": 2903206,
      "node_id": "MDQ6VXNlcjI5MDMyMDY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2903206?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Kimundi",
      "html_url": "https://github.com/Kimundi",
      "followers_url": "https://api.github.com/users/Kimundi/followers",
      "following_url": "https://api.github.com/users/Kimundi/following{/other_user}",
      "gists_url": "https://api.github.com/users/Kimundi/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Kimundi/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Kimundi/subscriptions",
      "organizations_url": "https://api.github.com/users/Kimundi/orgs",
      "repos_url": "https://api.github.com/users/Kimundi/repos",
      "events_url": "https://api.github.com/users/Kimundi/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Kimundi/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2013-06-19T19:08:37Z",
    "updated_at": "2013-06-19T19:13:51Z",
    "body": "I wrote this under issue #6869, but seeing how there is more discussion here I'm moving it here:\n\n### Summary of the current situation\n- Every string allocation in rust is null terminated (`~str`, `&'static str` etc).\n- Just like a `&[u8]`, a `&str` is a tuple `(*u8, len)` that points at the start of a memory range of `len` bytes.\n- However, while a `&str` points at `len` bytes, **only `len-1` bytes of that are considered part of the utf-8 data**.\n- The last valid address a `&str` points at is the 'hidden' byte. \n- If you take a slice `(start, end)` of a string, you actually get a `&[u8]` slice of `(start, end+1)`. This is safe because there is always a byte after the end for a string allocation.\n- For example, if you take the slice of a whole allocated string, the hidden byte points at the null terminator.\n- And if you take a subslice of a that string, the hidden byte points at whatever byte of the string allocation comes next after the `end` you specified.\n\nAll this is done just for one reason: So that `as_c_str()` can take a `&str`, safely look at its hidden byte, and only if it's not `NULL` make a copy of the string for increased safety (The c side will find a null terminator in valid memory). This design has a few issues though:\n- Converting between `&str` and `&[u8]` is a pain. While `&str -> &[u8]` is perfectly fine, A `&[u8]` of size `N` can only be turned into a `&str` of length `N-1`, making a lot of low level conversions a pita/impossible without some sort of copy.\n- The difference is hard to explain and library devs stumble over it all the time.\n- Because `as_c_str()` only does a copy 'sometimes', it's hard to gauge its performance.\n- Valid utf8 can contain interior nulls, so even with a guaranteed null terminator you might have to do additional transformations on your string to get the behavior you want of `as_c_str()`\n\n### Making `&str` the same as `&[u8]`\n\nBecause of this issues, `&str`s one-off-ness really introduces more problem than it solves, and should be changed. This means changing all functions in the library and compiler that handle a `&str` to not tread it as `(*u8, len)` with a `len-1` long utf8 part and a hidden byte, but instead just as a `len` memory slice that points at valid utf8.\n\n### Changes to the C interface\n\nThe current `as_c_str()` should be replaced by a few specialized functions depending on your use case:\n- `(&str).as_terminated_c_str()` should assert that the last codepoint in it is '\\x00', and only then provide a `*u8` and `len-1` pair to the string data. The docs also need to mention that the data might contain interior nulls, so the C side might see a shorter string than intended.\n- `(&str).as_unterminated_c_str()` should provide a `*u8` and `len` pair to the string data. The docs need to be explicit that there is NO null termination guaranteed, but that the string might contain interior nulls, including at its end.\n- `(&mut ~str).null_terminate()` can be a convenience method to push a `'\\x00'` at the end if it's not there already.\n- `(&str).is_null_terminated()` returns `true` if the last byte is null.\n- `(&str).is_c_null_term_compatible()` returns `true` if the last byte is null and all other aren't.\n- `(&str).as_terminated_c_str_auto_copy()` should take a `&str`, see if it ends with a '\\x00', and if not make a copy of it, push a null, and then call `as_terminated_c_str()` on it (Like today's `as_c_str()`). For short copies it should include a smallvector buffer or similar anti-heap-allocation strategies.\n- `(~str).into_terminated_c_str() -> ~str` should take ownership of a `~str`, push a null, call `as_terminated_c_str` on it, pop the null and return the `~str` again, leveraging overallocation to prevent a copy.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/19706809/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/19707121",
    "html_url": "https://github.com/rust-lang/rust/issues/7235#issuecomment-19707121",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/7235",
    "id": 19707121,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE5NzA3MTIx",
    "user": {
      "login": "thestinger",
      "id": 1505226,
      "node_id": "MDQ6VXNlcjE1MDUyMjY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1505226?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/thestinger",
      "html_url": "https://github.com/thestinger",
      "followers_url": "https://api.github.com/users/thestinger/followers",
      "following_url": "https://api.github.com/users/thestinger/following{/other_user}",
      "gists_url": "https://api.github.com/users/thestinger/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/thestinger/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/thestinger/subscriptions",
      "organizations_url": "https://api.github.com/users/thestinger/orgs",
      "repos_url": "https://api.github.com/users/thestinger/repos",
      "events_url": "https://api.github.com/users/thestinger/events{/privacy}",
      "received_events_url": "https://api.github.com/users/thestinger/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2013-06-19T19:13:20Z",
    "updated_at": "2013-06-19T19:14:39Z",
    "body": "I really don't think it deserves even one method because it's completely incorrect to treat UTF-8 this way. We aren't using modified UTF-8, so we have to accept that it's not usable with C string APIs.\n\nCan someone point out a situation or use case where this would actually be correct/useful?\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/19707121/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/19707487",
    "html_url": "https://github.com/rust-lang/rust/issues/7235#issuecomment-19707487",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/7235",
    "id": 19707487,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE5NzA3NDg3",
    "user": {
      "login": "Kimundi",
      "id": 2903206,
      "node_id": "MDQ6VXNlcjI5MDMyMDY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2903206?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Kimundi",
      "html_url": "https://github.com/Kimundi",
      "followers_url": "https://api.github.com/users/Kimundi/followers",
      "following_url": "https://api.github.com/users/Kimundi/following{/other_user}",
      "gists_url": "https://api.github.com/users/Kimundi/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Kimundi/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Kimundi/subscriptions",
      "organizations_url": "https://api.github.com/users/Kimundi/orgs",
      "repos_url": "https://api.github.com/users/Kimundi/repos",
      "events_url": "https://api.github.com/users/Kimundi/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Kimundi/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2013-06-19T19:18:32Z",
    "updated_at": "2013-06-19T19:22:38Z",
    "body": "@thestinger good point, maybe the whole api should be based around `&[Ascii]` or `&[u8]`. \nHowever, most of the issues I listed above still apply at the boundaries where you convert to/from this type.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/19707487/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/19707533",
    "html_url": "https://github.com/rust-lang/rust/issues/7235#issuecomment-19707533",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/7235",
    "id": 19707533,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE5NzA3NTMz",
    "user": {
      "login": "lilyball",
      "id": 714,
      "node_id": "MDQ6VXNlcjcxNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/714?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/lilyball",
      "html_url": "https://github.com/lilyball",
      "followers_url": "https://api.github.com/users/lilyball/followers",
      "following_url": "https://api.github.com/users/lilyball/following{/other_user}",
      "gists_url": "https://api.github.com/users/lilyball/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/lilyball/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/lilyball/subscriptions",
      "organizations_url": "https://api.github.com/users/lilyball/orgs",
      "repos_url": "https://api.github.com/users/lilyball/repos",
      "events_url": "https://api.github.com/users/lilyball/events{/privacy}",
      "received_events_url": "https://api.github.com/users/lilyball/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2013-06-19T19:19:12Z",
    "updated_at": "2013-06-19T19:19:12Z",
    "body": "While UTF-8 allows NUL, most UTF-8 strings won't have interior NULs. And the fact of the matter is, it's awfully convenient to be able to construct a NUL-terminated C String when working with FFI functions. It would be nice not to have to copy the string to a `~[u8]` every time you want to work with an FFI function.\n\nFor reference, in Cocoa, `NSString` is a fully unicode-aware string class, which provides a convenience method `-UTF8String` which returns a NUL-terminated `char*`, and there's been no issues with this.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/19707533/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/19707895",
    "html_url": "https://github.com/rust-lang/rust/issues/7235#issuecomment-19707895",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/7235",
    "id": 19707895,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE5NzA3ODk1",
    "user": {
      "login": "lilyball",
      "id": 714,
      "node_id": "MDQ6VXNlcjcxNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/714?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/lilyball",
      "html_url": "https://github.com/lilyball",
      "followers_url": "https://api.github.com/users/lilyball/followers",
      "following_url": "https://api.github.com/users/lilyball/following{/other_user}",
      "gists_url": "https://api.github.com/users/lilyball/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/lilyball/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/lilyball/subscriptions",
      "organizations_url": "https://api.github.com/users/lilyball/orgs",
      "repos_url": "https://api.github.com/users/lilyball/repos",
      "events_url": "https://api.github.com/users/lilyball/events{/privacy}",
      "received_events_url": "https://api.github.com/users/lilyball/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2013-06-19T19:24:14Z",
    "updated_at": "2013-06-19T19:24:14Z",
    "body": "Perhaps we should just implement `.as_c_str()` on `~str` alone, and require `~str` to be NUL-terminated, but not provide this functionality at all on `&str`. Hopefully people will be using `as_buff()` anyway (which should be turned into a method).\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/19707895/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/19708346",
    "html_url": "https://github.com/rust-lang/rust/issues/7235#issuecomment-19708346",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/7235",
    "id": 19708346,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE5NzA4MzQ2",
    "user": {
      "login": "thestinger",
      "id": 1505226,
      "node_id": "MDQ6VXNlcjE1MDUyMjY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1505226?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/thestinger",
      "html_url": "https://github.com/thestinger",
      "followers_url": "https://api.github.com/users/thestinger/followers",
      "following_url": "https://api.github.com/users/thestinger/following{/other_user}",
      "gists_url": "https://api.github.com/users/thestinger/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/thestinger/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/thestinger/subscriptions",
      "organizations_url": "https://api.github.com/users/thestinger/orgs",
      "repos_url": "https://api.github.com/users/thestinger/repos",
      "events_url": "https://api.github.com/users/thestinger/events{/privacy}",
      "received_events_url": "https://api.github.com/users/thestinger/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2013-06-19T19:30:40Z",
    "updated_at": "2013-06-19T19:40:47Z",
    "body": "@kballard: so what's an example FFI API, where handling only a subset of strings correctly is still going to be okay? This kind of flaw can _easily_ become a security vulnerability and I don't see why every string should be a byte longer just to make it easier to write broken code.\n\nEncryption, compression, I/O and file paths are all byte based so the string representation having a `\\0` at the end isn't helpful/relevant because the bindings will use `[u8]`.\n\nNothing stops you from pushing a `\\0` to the end of a `~str` if you're determined to write code that only supports a subset of Unicode.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/19708346/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/19709147",
    "html_url": "https://github.com/rust-lang/rust/issues/7235#issuecomment-19709147",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/7235",
    "id": 19709147,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE5NzA5MTQ3",
    "user": {
      "login": "lilyball",
      "id": 714,
      "node_id": "MDQ6VXNlcjcxNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/714?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/lilyball",
      "html_url": "https://github.com/lilyball",
      "followers_url": "https://api.github.com/users/lilyball/followers",
      "following_url": "https://api.github.com/users/lilyball/following{/other_user}",
      "gists_url": "https://api.github.com/users/lilyball/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/lilyball/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/lilyball/subscriptions",
      "organizations_url": "https://api.github.com/users/lilyball/orgs",
      "repos_url": "https://api.github.com/users/lilyball/repos",
      "events_url": "https://api.github.com/users/lilyball/events{/privacy}",
      "received_events_url": "https://api.github.com/users/lilyball/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2013-06-19T19:41:09Z",
    "updated_at": "2013-06-19T19:41:09Z",
    "body": "My general feeling here is that, once you'e dealing with FFI, you're already in unsafe land, so instead of trying to be opinionated about what is safe and what is not, we should just provide the tools to do what's useful.\n\nThat said, the argument that making every string a byte longer when most of them are never going to touch FFI code (not that this is precisely what you said) is a good one. Although I wonder how much of an impact this will have in practice.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/19709147/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/19709273",
    "html_url": "https://github.com/rust-lang/rust/issues/7235#issuecomment-19709273",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/7235",
    "id": 19709273,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE5NzA5Mjcz",
    "user": {
      "login": "thestinger",
      "id": 1505226,
      "node_id": "MDQ6VXNlcjE1MDUyMjY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1505226?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/thestinger",
      "html_url": "https://github.com/thestinger",
      "followers_url": "https://api.github.com/users/thestinger/followers",
      "following_url": "https://api.github.com/users/thestinger/following{/other_user}",
      "gists_url": "https://api.github.com/users/thestinger/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/thestinger/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/thestinger/subscriptions",
      "organizations_url": "https://api.github.com/users/thestinger/orgs",
      "repos_url": "https://api.github.com/users/thestinger/repos",
      "events_url": "https://api.github.com/users/thestinger/events{/privacy}",
      "received_events_url": "https://api.github.com/users/thestinger/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2013-06-19T19:42:26Z",
    "updated_at": "2013-06-19T19:46:48Z",
    "body": "I don't think it's useful though. I can't think of any case where it would be okay/useful to use strings for stuff that's not actually Unicode. I was also against having any ASCII-only methods (like the now removed `to_lower` and `to_upper`) on strings for the same reason - it should be separate.\n\nIf we ever make a small string class, the impact will be that strings under 10 bytes are on the stack instead of strings under 11 bytes on 32-bit, and 22 instead of 23 on 64-bit. It can also push them into the next allocator size class.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/19709273/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/19713436",
    "html_url": "https://github.com/rust-lang/rust/issues/7235#issuecomment-19713436",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/7235",
    "id": 19713436,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE5NzEzNDM2",
    "user": {
      "login": "graydon",
      "id": 14097,
      "node_id": "MDQ6VXNlcjE0MDk3",
      "avatar_url": "https://avatars.githubusercontent.com/u/14097?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/graydon",
      "html_url": "https://github.com/graydon",
      "followers_url": "https://api.github.com/users/graydon/followers",
      "following_url": "https://api.github.com/users/graydon/following{/other_user}",
      "gists_url": "https://api.github.com/users/graydon/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/graydon/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/graydon/subscriptions",
      "organizations_url": "https://api.github.com/users/graydon/orgs",
      "repos_url": "https://api.github.com/users/graydon/repos",
      "events_url": "https://api.github.com/users/graydon/events{/privacy}",
      "received_events_url": "https://api.github.com/users/graydon/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2013-06-19T20:42:40Z",
    "updated_at": "2013-06-19T20:42:40Z",
    "body": "@thestinger suggests that we look at haskell's `Foreign.C.String :: CString` type (http://www.haskell.org/ghc/docs/latest/html/libraries/base/Foreign-C-String.html) and structure the library such that `&str` can be converted to such a `CString` which will ensure that it matches current C-string assumptions:\n- Encoded by current locale encoding\n- No interior nulls\n- One trailing null\n\nIMO this relates closely to having to figure out APIs for handling non-utf8 encodings. See #6164, #4837, etc. (there should be a metabug for overhauling unicode / absorbing libICU / something; but there isn't yet)\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/19713436/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
