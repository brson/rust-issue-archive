[
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/56762183",
    "html_url": "https://github.com/rust-lang/rust/issues/17526#issuecomment-56762183",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/17526",
    "id": 56762183,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU2NzYyMTgz",
    "user": {
      "login": "mahkoh",
      "id": 1882250,
      "node_id": "MDQ6VXNlcjE4ODIyNTA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1882250?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mahkoh",
      "html_url": "https://github.com/mahkoh",
      "followers_url": "https://api.github.com/users/mahkoh/followers",
      "following_url": "https://api.github.com/users/mahkoh/following{/other_user}",
      "gists_url": "https://api.github.com/users/mahkoh/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mahkoh/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mahkoh/subscriptions",
      "organizations_url": "https://api.github.com/users/mahkoh/orgs",
      "repos_url": "https://api.github.com/users/mahkoh/repos",
      "events_url": "https://api.github.com/users/mahkoh/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mahkoh/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-09-25T01:18:47Z",
    "updated_at": "2014-09-25T01:18:47Z",
    "body": "The problem is that this code contains two bugs and removing the `mut` fixes both at the same time. When we make the following change:\n\n``` rust\nfn test(iter: &mut ObjIter) {\n    for mut obj_ref in iter {\n        let obj = obj_ref.get_obj();\n    }\n}\n```\n\n`obj_ref` is mutable but you still get the same error. Now change the function above as follows:\n\n``` rust\nimpl<'a> ObjRef<'a> {\n    pub fn get_obj<'b>(&'b mut self) -> &'b int {\n        self.r\n    }\n}\n```\n\nand the error goes away.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/56762183/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/56766107",
    "html_url": "https://github.com/rust-lang/rust/issues/17526#issuecomment-56766107",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/17526",
    "id": 56766107,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU2NzY2MTA3",
    "user": {
      "login": "wizeman",
      "id": 168610,
      "node_id": "MDQ6VXNlcjE2ODYxMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/168610?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/wizeman",
      "html_url": "https://github.com/wizeman",
      "followers_url": "https://api.github.com/users/wizeman/followers",
      "following_url": "https://api.github.com/users/wizeman/following{/other_user}",
      "gists_url": "https://api.github.com/users/wizeman/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/wizeman/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/wizeman/subscriptions",
      "organizations_url": "https://api.github.com/users/wizeman/orgs",
      "repos_url": "https://api.github.com/users/wizeman/repos",
      "events_url": "https://api.github.com/users/wizeman/events{/privacy}",
      "received_events_url": "https://api.github.com/users/wizeman/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-09-25T02:23:45Z",
    "updated_at": "2014-09-25T02:23:45Z",
    "body": "@mahkoh Thanks, that does indeed work.\n\nSo you're saying that there were 2 errors:\n\n1) the obj_ref definition in the \"for\" loop was not mutable, and\n2) the lifetime in the \"&'a mut self\" parameter was too strict because it was tied to the lifetime of the struct instead of being a different lifetime ('b)?\n\nI understand the first error but I don't understand the second one.\n\nWhy does it compile fine if instead of fixing my first example code the way you did, I simply remove \"mut\" from get_obj() but still use the 'a lifetime? In other words, when using \"&'a self\" as the self parameter for that method, why doesn't that lead to the same lifetime error as when I use \"&'a mut self\"?\n\nBTW: I did not know that I could return a borrowed pointer field using a different lifetime than the one used in the struct. It would have been useful to me if this was mentioned in the lifetime guide. Even now I don't understand when I have to use a \"&'a self\" parameter or when I can use \"&'b self\" (or just \"&self\").\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/56766107/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/56819144",
    "html_url": "https://github.com/rust-lang/rust/issues/17526#issuecomment-56819144",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/17526",
    "id": 56819144,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU2ODE5MTQ0",
    "user": {
      "login": "mahkoh",
      "id": 1882250,
      "node_id": "MDQ6VXNlcjE4ODIyNTA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1882250?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mahkoh",
      "html_url": "https://github.com/mahkoh",
      "followers_url": "https://api.github.com/users/mahkoh/followers",
      "following_url": "https://api.github.com/users/mahkoh/following{/other_user}",
      "gists_url": "https://api.github.com/users/mahkoh/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mahkoh/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mahkoh/subscriptions",
      "organizations_url": "https://api.github.com/users/mahkoh/orgs",
      "repos_url": "https://api.github.com/users/mahkoh/repos",
      "events_url": "https://api.github.com/users/mahkoh/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mahkoh/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-09-25T13:37:13Z",
    "updated_at": "2014-09-25T13:37:25Z",
    "body": "I believe that the compiler doesn't care about this lifetime \"problem\" if it can prove that the code is safe in some other way. But I agree with you that your \"fix\" should not compile. I've written a smaller program explaining my thoughts: https://gist.github.com/anonymous/66c1774a0c35776939e4\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/56819144/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/56861659",
    "html_url": "https://github.com/rust-lang/rust/issues/17526#issuecomment-56861659",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/17526",
    "id": 56861659,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU2ODYxNjU5",
    "user": {
      "login": "arielb1",
      "id": 1830974,
      "node_id": "MDQ6VXNlcjE4MzA5NzQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1830974?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/arielb1",
      "html_url": "https://github.com/arielb1",
      "followers_url": "https://api.github.com/users/arielb1/followers",
      "following_url": "https://api.github.com/users/arielb1/following{/other_user}",
      "gists_url": "https://api.github.com/users/arielb1/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/arielb1/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/arielb1/subscriptions",
      "organizations_url": "https://api.github.com/users/arielb1/orgs",
      "repos_url": "https://api.github.com/users/arielb1/repos",
      "events_url": "https://api.github.com/users/arielb1/events{/privacy}",
      "received_events_url": "https://api.github.com/users/arielb1/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-09-25T18:23:40Z",
    "updated_at": "2014-09-25T18:27:17Z",
    "body": "@wizeman \n\nYou typically want to use a bound lifetime parameter - `<'s> &'s self -> &'s T`. Actually, if you don't write lifetime parameters at all it is inferred.\n\nUsing a free lifetime parameter (without the `<'a>`) implies that you want to borrow the struct _for the lifetime of its lifetime parameter_. Typically (as in your case), this does not semantically matter, as structures are **contravariant in their lifetime parameter** - if you reduce the span of the lifetime parameter you still have a valid struct. In your case, you merely met an inference limitation \u200f- rustc tries to borrow the obj_ref for them lifetime of the entire function, which of course fails as it is only valid in the for loop. However, the following variant of `test` does work with your original version of `get_obj`:\n\n``` Rust\nfn test(iter: &mut ObjIter) {\n    for obj_ref in iter {\n        let mut obj_ref = obj_ref; // Note the explicit reborrow\n        obj_ref.get_obj();\n    }\n}\n```\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/56861659/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/71693423",
    "html_url": "https://github.com/rust-lang/rust/issues/17526#issuecomment-71693423",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/17526",
    "id": 71693423,
    "node_id": "MDEyOklzc3VlQ29tbWVudDcxNjkzNDIz",
    "user": {
      "login": "steveklabnik",
      "id": 27786,
      "node_id": "MDQ6VXNlcjI3Nzg2",
      "avatar_url": "https://avatars.githubusercontent.com/u/27786?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/steveklabnik",
      "html_url": "https://github.com/steveklabnik",
      "followers_url": "https://api.github.com/users/steveklabnik/followers",
      "following_url": "https://api.github.com/users/steveklabnik/following{/other_user}",
      "gists_url": "https://api.github.com/users/steveklabnik/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/steveklabnik/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/steveklabnik/subscriptions",
      "organizations_url": "https://api.github.com/users/steveklabnik/orgs",
      "repos_url": "https://api.github.com/users/steveklabnik/repos",
      "events_url": "https://api.github.com/users/steveklabnik/events{/privacy}",
      "received_events_url": "https://api.github.com/users/steveklabnik/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-01-27T17:50:16Z",
    "updated_at": "2015-01-27T17:50:16Z",
    "body": "It seems this bug is fixed, but I'm tagging 'lifetimes' in case that example is wrong.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/71693423/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/151506858",
    "html_url": "https://github.com/rust-lang/rust/issues/17526#issuecomment-151506858",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/17526",
    "id": 151506858,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE1MTUwNjg1OA==",
    "user": {
      "login": "steveklabnik",
      "id": 27786,
      "node_id": "MDQ6VXNlcjI3Nzg2",
      "avatar_url": "https://avatars.githubusercontent.com/u/27786?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/steveklabnik",
      "html_url": "https://github.com/steveklabnik",
      "followers_url": "https://api.github.com/users/steveklabnik/followers",
      "following_url": "https://api.github.com/users/steveklabnik/following{/other_user}",
      "gists_url": "https://api.github.com/users/steveklabnik/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/steveklabnik/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/steveklabnik/subscriptions",
      "organizations_url": "https://api.github.com/users/steveklabnik/orgs",
      "repos_url": "https://api.github.com/users/steveklabnik/repos",
      "events_url": "https://api.github.com/users/steveklabnik/events{/privacy}",
      "received_events_url": "https://api.github.com/users/steveklabnik/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-10-27T14:07:12Z",
    "updated_at": "2015-10-27T14:07:12Z",
    "body": "It doesn't look like there's anything to do to fix this issue, so I'm giving it a close.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/151506858/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
