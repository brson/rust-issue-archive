[
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/147070647",
    "html_url": "https://github.com/rust-lang/rust/issues/28943#issuecomment-147070647",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28943",
    "id": 147070647,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE0NzA3MDY0Nw==",
    "user": {
      "login": "arielb1",
      "id": 1830974,
      "node_id": "MDQ6VXNlcjE4MzA5NzQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1830974?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/arielb1",
      "html_url": "https://github.com/arielb1",
      "followers_url": "https://api.github.com/users/arielb1/followers",
      "following_url": "https://api.github.com/users/arielb1/following{/other_user}",
      "gists_url": "https://api.github.com/users/arielb1/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/arielb1/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/arielb1/subscriptions",
      "organizations_url": "https://api.github.com/users/arielb1/orgs",
      "repos_url": "https://api.github.com/users/arielb1/repos",
      "events_url": "https://api.github.com/users/arielb1/events{/privacy}",
      "received_events_url": "https://api.github.com/users/arielb1/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-10-10T10:01:03Z",
    "updated_at": "2015-10-10T10:01:03Z",
    "body": "@Thiez \n\nThis is not adding more information, but rather using `result` before its type is known.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/147070647/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/147071531",
    "html_url": "https://github.com/rust-lang/rust/issues/28943#issuecomment-147071531",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28943",
    "id": 147071531,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE0NzA3MTUzMQ==",
    "user": {
      "login": "Thiez",
      "id": 204550,
      "node_id": "MDQ6VXNlcjIwNDU1MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/204550?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Thiez",
      "html_url": "https://github.com/Thiez",
      "followers_url": "https://api.github.com/users/Thiez/followers",
      "following_url": "https://api.github.com/users/Thiez/following{/other_user}",
      "gists_url": "https://api.github.com/users/Thiez/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Thiez/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Thiez/subscriptions",
      "organizations_url": "https://api.github.com/users/Thiez/orgs",
      "repos_url": "https://api.github.com/users/Thiez/repos",
      "events_url": "https://api.github.com/users/Thiez/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Thiez/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-10-10T10:19:42Z",
    "updated_at": "2015-10-10T10:19:42Z",
    "body": "I was under the impression that type inference took into account the entire function context, such as in this case:\n\n``` rust\nfn test() -> Vec<u8> {\n    fn print<T: std::fmt::Debug>(t: T) { println!(\"{:?}\", t); }\n    let x = 5;\n    print(x);\n    let y = x + x;\n    vec![y]\n}\n```\n\nWhy does type inference even have a concept of 'before'? A type can't change.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/147071531/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/147076357",
    "html_url": "https://github.com/rust-lang/rust/issues/28943#issuecomment-147076357",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28943",
    "id": 147076357,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE0NzA3NjM1Nw==",
    "user": {
      "login": "arielb1",
      "id": 1830974,
      "node_id": "MDQ6VXNlcjE4MzA5NzQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1830974?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/arielb1",
      "html_url": "https://github.com/arielb1",
      "followers_url": "https://api.github.com/users/arielb1/followers",
      "following_url": "https://api.github.com/users/arielb1/following{/other_user}",
      "gists_url": "https://api.github.com/users/arielb1/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/arielb1/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/arielb1/subscriptions",
      "organizations_url": "https://api.github.com/users/arielb1/orgs",
      "repos_url": "https://api.github.com/users/arielb1/repos",
      "events_url": "https://api.github.com/users/arielb1/events{/privacy}",
      "received_events_url": "https://api.github.com/users/arielb1/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-10-10T11:25:11Z",
    "updated_at": "2015-10-10T11:25:11Z",
    "body": "@Thiez \n\nBecause of overloading and type-directed lookup, rustc can't figure out which function named `clone` you meant unless it knows enough about the type.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/147076357/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/147099455",
    "html_url": "https://github.com/rust-lang/rust/issues/28943#issuecomment-147099455",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28943",
    "id": 147099455,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE0NzA5OTQ1NQ==",
    "user": {
      "login": "Thiez",
      "id": 204550,
      "node_id": "MDQ6VXNlcjIwNDU1MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/204550?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Thiez",
      "html_url": "https://github.com/Thiez",
      "followers_url": "https://api.github.com/users/Thiez/followers",
      "following_url": "https://api.github.com/users/Thiez/following{/other_user}",
      "gists_url": "https://api.github.com/users/Thiez/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Thiez/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Thiez/subscriptions",
      "organizations_url": "https://api.github.com/users/Thiez/orgs",
      "repos_url": "https://api.github.com/users/Thiez/repos",
      "events_url": "https://api.github.com/users/Thiez/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Thiez/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-10-10T15:22:42Z",
    "updated_at": "2015-10-10T15:22:42Z",
    "body": "Okay, so the real problem here is that Rust type inference is dumber than it could be, because it fails to take future information into account even though it easily could because types do not change? Should I rename the issue or create a new one?\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/147099455/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/147182512",
    "html_url": "https://github.com/rust-lang/rust/issues/28943#issuecomment-147182512",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28943",
    "id": 147182512,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE0NzE4MjUxMg==",
    "user": {
      "login": "arielb1",
      "id": 1830974,
      "node_id": "MDQ6VXNlcjE4MzA5NzQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1830974?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/arielb1",
      "html_url": "https://github.com/arielb1",
      "followers_url": "https://api.github.com/users/arielb1/followers",
      "following_url": "https://api.github.com/users/arielb1/following{/other_user}",
      "gists_url": "https://api.github.com/users/arielb1/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/arielb1/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/arielb1/subscriptions",
      "organizations_url": "https://api.github.com/users/arielb1/orgs",
      "repos_url": "https://api.github.com/users/arielb1/repos",
      "events_url": "https://api.github.com/users/arielb1/events{/privacy}",
      "received_events_url": "https://api.github.com/users/arielb1/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-10-11T11:11:46Z",
    "updated_at": "2015-10-11T11:11:46Z",
    "body": "@Thiez \n\nThis is a design limitation that is _really_ unlikely to be fixed in the future, especially as coercion etc. work eagerly.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/147182512/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/147184734",
    "html_url": "https://github.com/rust-lang/rust/issues/28943#issuecomment-147184734",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28943",
    "id": 147184734,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE0NzE4NDczNA==",
    "user": {
      "login": "Thiez",
      "id": 204550,
      "node_id": "MDQ6VXNlcjIwNDU1MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/204550?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Thiez",
      "html_url": "https://github.com/Thiez",
      "followers_url": "https://api.github.com/users/Thiez/followers",
      "following_url": "https://api.github.com/users/Thiez/following{/other_user}",
      "gists_url": "https://api.github.com/users/Thiez/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Thiez/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Thiez/subscriptions",
      "organizations_url": "https://api.github.com/users/Thiez/orgs",
      "repos_url": "https://api.github.com/users/Thiez/repos",
      "events_url": "https://api.github.com/users/Thiez/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Thiez/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-10-11T11:35:56Z",
    "updated_at": "2015-10-11T11:35:56Z",
    "body": "What I'm trying to say is that there _is_ sufficient information present to unambiguously determine the type of `result`. Could you please explain where the eager coercions could come in and how they affect type inference in this case? Because to me it just looks like the compiler chooses to remain ignorant about information 'in the future' even though types cannot change.\n\nCould you please explain why the following function compiles while the original does not, and what coercions have to do with that?\n\n``` rust\nfn test() -> Vec<u8> {\n    let result = Some(5).into_iter().collect();\n    if false { return result; }\n    &*result;\n    result.clone();\n    &result[..];\n    result\n}\n```\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/147184734/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/150364164",
    "html_url": "https://github.com/rust-lang/rust/issues/28943#issuecomment-150364164",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28943",
    "id": 150364164,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE1MDM2NDE2NA==",
    "user": {
      "login": "arielb1",
      "id": 1830974,
      "node_id": "MDQ6VXNlcjE4MzA5NzQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1830974?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/arielb1",
      "html_url": "https://github.com/arielb1",
      "followers_url": "https://api.github.com/users/arielb1/followers",
      "following_url": "https://api.github.com/users/arielb1/following{/other_user}",
      "gists_url": "https://api.github.com/users/arielb1/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/arielb1/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/arielb1/subscriptions",
      "organizations_url": "https://api.github.com/users/arielb1/orgs",
      "repos_url": "https://api.github.com/users/arielb1/repos",
      "events_url": "https://api.github.com/users/arielb1/events{/privacy}",
      "received_events_url": "https://api.github.com/users/arielb1/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-10-22T21:40:35Z",
    "updated_at": "2015-10-22T21:40:35Z",
    "body": "@Thiez \n\nThe return inside the \"if false\" informs rustc about the type to be assigned to `collect`.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/150364164/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/154544511",
    "html_url": "https://github.com/rust-lang/rust/issues/28943#issuecomment-154544511",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28943",
    "id": 154544511,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE1NDU0NDUxMQ==",
    "user": {
      "login": "rkjnsn",
      "id": 7364197,
      "node_id": "MDQ6VXNlcjczNjQxOTc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7364197?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/rkjnsn",
      "html_url": "https://github.com/rkjnsn",
      "followers_url": "https://api.github.com/users/rkjnsn/followers",
      "following_url": "https://api.github.com/users/rkjnsn/following{/other_user}",
      "gists_url": "https://api.github.com/users/rkjnsn/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/rkjnsn/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/rkjnsn/subscriptions",
      "organizations_url": "https://api.github.com/users/rkjnsn/orgs",
      "repos_url": "https://api.github.com/users/rkjnsn/repos",
      "events_url": "https://api.github.com/users/rkjnsn/events{/privacy}",
      "received_events_url": "https://api.github.com/users/rkjnsn/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-11-06T21:19:13Z",
    "updated_at": "2015-11-06T21:20:48Z",
    "body": "@arielb1\n\nI am also a bit confused as to why this should fail:\n\n```\nfn test() -> Vec<u8> {\n    let result = Some(5).into_iter().collect();\n    &*result;\n    result\n}\n```\n\nbut this should succeed:\n\n```\nfn test() -> Vec<u8> {\n    let result = Some(5).into_iter().collect();\n    if false { return result; }\n    &*result;\n    result\n}\n```\n\nBoth examples impose the exact same constraints on \"result\" by returning it.\n\n> The return inside the \"if false\" informs rustc about the type to be assigned to collect.\n\nThis is true, but the return at the end of the function provides the _exact same_ information, and is present in both examples.\n\nIt seems to me that it shouldn't make any different whether or not the return happens \"before\" (in terms of function execution) the dereference, since, as @Thiez notes, types are fixed and to not change as the function execution progresses. What I would expect to happen would be for the compiler to look at all of the usages of a value such as `result` in the function (the order of those usages wouldn't matter), and build up a set of constraints on the type. Only if the constraints conflicted or if they still left the type ambiguous would I expect to see an error.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/154544511/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
