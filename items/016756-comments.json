[
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/53367947",
    "html_url": "https://github.com/rust-lang/rust/pull/16756#issuecomment-53367947",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/16756",
    "id": 53367947,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUzMzY3OTQ3",
    "user": {
      "login": "Gankra",
      "id": 1136864,
      "node_id": "MDQ6VXNlcjExMzY4NjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1136864?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Gankra",
      "html_url": "https://github.com/Gankra",
      "followers_url": "https://api.github.com/users/Gankra/followers",
      "following_url": "https://api.github.com/users/Gankra/following{/other_user}",
      "gists_url": "https://api.github.com/users/Gankra/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Gankra/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Gankra/subscriptions",
      "organizations_url": "https://api.github.com/users/Gankra/orgs",
      "repos_url": "https://api.github.com/users/Gankra/repos",
      "events_url": "https://api.github.com/users/Gankra/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Gankra/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-08-26T02:33:06Z",
    "updated_at": "2014-08-26T02:33:06Z",
    "body": "Dunno if this is the sort of example you want, but you can write a nice little persistent list with Rc pretty simply (minimal adaption of my own impl elsewhere):\n\n```\n#![feature(unsafe_destructor)]\n\nuse std::rc::{try_unwrap, Rc};\n\nstruct Node<T> {\n    elem: T,\n    next: Option<Rc<Node<T>>>,\n}\n\nimpl<T> Node<T> {\n    #[inline]\n    fn new(elem: T) -> Node<T> {\n        Node { elem: elem, next: None }\n    }\n}\n\n/// An immutable singly-linked list, as seen in basically every functional language\npub struct ImmutSList<T> {\n    front: Option<Rc<Node<T>>>,\n    length: uint,\n}\n\nimpl<T> ImmutSList<T> {\n    /// Constructs a new, empty `ImmutSList`\n    #[inline]\n    pub fn new () -> ImmutSList<T> {\n        ImmutSList{ front: None, length: 0 }\n    }\n\n    /// Gets the length of the list\n    #[inline]\n    pub fn len(&self) -> uint {\n        self.length\n    }\n\n    /// Returns a copy of the list, with `elem` appended to the front\n    #[inline]\n    pub fn append (&self, elem: T) -> ImmutSList<T>{\n        let mut new_node = Node::new(elem);\n        new_node.next = self.front.clone();\n\n        ImmutSList{\n            front: Some(Rc::new(new_node)),\n            length: self.len() + 1,\n        }\n    }\n\n    /// Returns a reference to the first element in the list\n    #[inline]\n    pub fn head (&self) -> Option<&T> {\n        self.front.as_ref().map(|node| &node.elem)\n    }\n\n    /// Returns a copy of the list, with the first element removed\n    #[inline]\n    pub fn tail (&self) -> ImmutSList<T> {\n        let len = self.len();\n        if len <= 1 {\n            ImmutSList::new()\n        } else {\n            ImmutSList {\n                length: len - 1,\n                front: self.front.as_ref().unwrap().next.clone(),\n            }\n        }\n    }\n}\n\n#[unsafe_destructor]\nimpl<T> Drop for ImmutSList<T> {\n    fn drop (&mut self) {\n        // don't want to blow the stack with destructors,\n        // but also don't want to walk the whole list.\n        // So walk the list until we find a non-uniquely owned item\n        let mut head = self.front.take();\n        loop {\n            let temp = head;\n            match temp {\n                Some(node) => match try_unwrap(node) {\n                    Ok(mut node) => {\n                        head = node.next.take();\n                    }\n                    _ => return,\n                },\n                _ => return,\n            }\n        }\n    }\n}\n```\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/53367947/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/53368491",
    "html_url": "https://github.com/rust-lang/rust/pull/16756#issuecomment-53368491",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/16756",
    "id": 53368491,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUzMzY4NDkx",
    "user": {
      "login": "Gankra",
      "id": 1136864,
      "node_id": "MDQ6VXNlcjExMzY4NjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1136864?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Gankra",
      "html_url": "https://github.com/Gankra",
      "followers_url": "https://api.github.com/users/Gankra/followers",
      "following_url": "https://api.github.com/users/Gankra/following{/other_user}",
      "gists_url": "https://api.github.com/users/Gankra/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Gankra/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Gankra/subscriptions",
      "organizations_url": "https://api.github.com/users/Gankra/orgs",
      "repos_url": "https://api.github.com/users/Gankra/repos",
      "events_url": "https://api.github.com/users/Gankra/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Gankra/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-08-26T02:39:14Z",
    "updated_at": "2014-08-26T02:39:27Z",
    "body": "The [rc module](http://doc.rust-lang.org/std/rc/index.html) itself also features some ok examples.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/53368491/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/53496240",
    "html_url": "https://github.com/rust-lang/rust/pull/16756#issuecomment-53496240",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/16756",
    "id": 53496240,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUzNDk2MjQw",
    "user": {
      "login": "reem",
      "id": 4745181,
      "node_id": "MDQ6VXNlcjQ3NDUxODE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4745181?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/reem",
      "html_url": "https://github.com/reem",
      "followers_url": "https://api.github.com/users/reem/followers",
      "following_url": "https://api.github.com/users/reem/following{/other_user}",
      "gists_url": "https://api.github.com/users/reem/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/reem/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/reem/subscriptions",
      "organizations_url": "https://api.github.com/users/reem/orgs",
      "repos_url": "https://api.github.com/users/reem/repos",
      "events_url": "https://api.github.com/users/reem/events{/privacy}",
      "received_events_url": "https://api.github.com/users/reem/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-08-26T21:34:21Z",
    "updated_at": "2014-08-26T21:34:21Z",
    "body": "A persistent list is a great example, especially because you can easily create a concurrent abstraction with `Arc`, I have a version here: https://github.com/reem/adamantium/blob/master/src/list.rs\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/53496240/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/53501819",
    "html_url": "https://github.com/rust-lang/rust/pull/16756#issuecomment-53501819",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/16756",
    "id": 53501819,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUzNTAxODE5",
    "user": {
      "login": "Gankra",
      "id": 1136864,
      "node_id": "MDQ6VXNlcjExMzY4NjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1136864?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Gankra",
      "html_url": "https://github.com/Gankra",
      "followers_url": "https://api.github.com/users/Gankra/followers",
      "following_url": "https://api.github.com/users/Gankra/following{/other_user}",
      "gists_url": "https://api.github.com/users/Gankra/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Gankra/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Gankra/subscriptions",
      "organizations_url": "https://api.github.com/users/Gankra/orgs",
      "repos_url": "https://api.github.com/users/Gankra/repos",
      "events_url": "https://api.github.com/users/Gankra/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Gankra/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-08-26T22:20:10Z",
    "updated_at": "2014-08-26T22:20:10Z",
    "body": "@reem: Your version will blow the stack with recursive destructors if it becomes too large, right? (Not sure if Arc's are more magic than that)\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/53501819/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/53693530",
    "html_url": "https://github.com/rust-lang/rust/pull/16756#issuecomment-53693530",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/16756",
    "id": 53693530,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUzNjkzNTMw",
    "user": {
      "login": "reem",
      "id": 4745181,
      "node_id": "MDQ6VXNlcjQ3NDUxODE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4745181?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/reem",
      "html_url": "https://github.com/reem",
      "followers_url": "https://api.github.com/users/reem/followers",
      "following_url": "https://api.github.com/users/reem/following{/other_user}",
      "gists_url": "https://api.github.com/users/reem/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/reem/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/reem/subscriptions",
      "organizations_url": "https://api.github.com/users/reem/orgs",
      "repos_url": "https://api.github.com/users/reem/repos",
      "events_url": "https://api.github.com/users/reem/events{/privacy}",
      "received_events_url": "https://api.github.com/users/reem/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-08-28T09:22:10Z",
    "updated_at": "2014-08-28T09:22:10Z",
    "body": "@Gankro probably. I haven't had much time to work on making adamantium a really good library yet. How would you suggest I fix that?\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/53693530/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/53715481",
    "html_url": "https://github.com/rust-lang/rust/pull/16756#issuecomment-53715481",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/16756",
    "id": 53715481,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUzNzE1NDgx",
    "user": {
      "login": "Gankra",
      "id": 1136864,
      "node_id": "MDQ6VXNlcjExMzY4NjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1136864?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Gankra",
      "html_url": "https://github.com/Gankra",
      "followers_url": "https://api.github.com/users/Gankra/followers",
      "following_url": "https://api.github.com/users/Gankra/following{/other_user}",
      "gists_url": "https://api.github.com/users/Gankra/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Gankra/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Gankra/subscriptions",
      "organizations_url": "https://api.github.com/users/Gankra/orgs",
      "repos_url": "https://api.github.com/users/Gankra/repos",
      "events_url": "https://api.github.com/users/Gankra/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Gankra/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-08-28T12:56:51Z",
    "updated_at": "2014-08-28T12:56:51Z",
    "body": "@reem Check out the unsafe destructor in the sample I posted. Basically (assuming I wrote it write), you have to manually walk the nodes and claim ownership of them one at a time, so that when the parent node gets destroyed, it doesn't trigger the destructor of the child. Thankfully, you only have to walk to the next node while the reference you hold is unique, because any other kind of [A]rc won't trigger a recursive destructor on the child. Thus, even though you potentially walk the whole list every time, it's only amortized O(1) in the number of persistent appends you perform.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/53715481/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/53739469",
    "html_url": "https://github.com/rust-lang/rust/pull/16756#issuecomment-53739469",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/16756",
    "id": 53739469,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUzNzM5NDY5",
    "user": {
      "login": "steveklabnik",
      "id": 27786,
      "node_id": "MDQ6VXNlcjI3Nzg2",
      "avatar_url": "https://avatars.githubusercontent.com/u/27786?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/steveklabnik",
      "html_url": "https://github.com/steveklabnik",
      "followers_url": "https://api.github.com/users/steveklabnik/followers",
      "following_url": "https://api.github.com/users/steveklabnik/following{/other_user}",
      "gists_url": "https://api.github.com/users/steveklabnik/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/steveklabnik/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/steveklabnik/subscriptions",
      "organizations_url": "https://api.github.com/users/steveklabnik/orgs",
      "repos_url": "https://api.github.com/users/steveklabnik/repos",
      "events_url": "https://api.github.com/users/steveklabnik/events{/privacy}",
      "received_events_url": "https://api.github.com/users/steveklabnik/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-08-28T15:43:09Z",
    "updated_at": "2014-08-28T15:43:09Z",
    "body": "Was doing more work on this, and ran into https://github.com/rust-lang/rust/issues/16821, so this is on hold until that gets fixed.\n\nI am actually not happy with this draft anyway, so I'm just going to close this. Thanks though!\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/53739469/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
