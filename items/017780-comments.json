[
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/57921632",
    "html_url": "https://github.com/rust-lang/rust/issues/17780#issuecomment-57921632",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/17780",
    "id": 57921632,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU3OTIxNjMy",
    "user": {
      "login": "zwarich",
      "id": 440875,
      "node_id": "MDQ6VXNlcjQ0MDg3NQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/440875?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/zwarich",
      "html_url": "https://github.com/zwarich",
      "followers_url": "https://api.github.com/users/zwarich/followers",
      "following_url": "https://api.github.com/users/zwarich/following{/other_user}",
      "gists_url": "https://api.github.com/users/zwarich/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/zwarich/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/zwarich/subscriptions",
      "organizations_url": "https://api.github.com/users/zwarich/orgs",
      "repos_url": "https://api.github.com/users/zwarich/repos",
      "events_url": "https://api.github.com/users/zwarich/events{/privacy}",
      "received_events_url": "https://api.github.com/users/zwarich/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-10-04T23:25:43Z",
    "updated_at": "2014-10-04T23:25:43Z",
    "body": "This looks like the unboxed closure version of #17403. The comment by @nikomatsakis there suggests that the correct fix is a bit deeper than just requiring the upvars to be aliasable.\n",
    "author_association": "NONE",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/57921632/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/57922068",
    "html_url": "https://github.com/rust-lang/rust/issues/17780#issuecomment-57922068",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/17780",
    "id": 57922068,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU3OTIyMDY4",
    "user": {
      "login": "bkoropoff",
      "id": 2101303,
      "node_id": "MDQ6VXNlcjIxMDEzMDM=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2101303?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/bkoropoff",
      "html_url": "https://github.com/bkoropoff",
      "followers_url": "https://api.github.com/users/bkoropoff/followers",
      "following_url": "https://api.github.com/users/bkoropoff/following{/other_user}",
      "gists_url": "https://api.github.com/users/bkoropoff/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/bkoropoff/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/bkoropoff/subscriptions",
      "organizations_url": "https://api.github.com/users/bkoropoff/orgs",
      "repos_url": "https://api.github.com/users/bkoropoff/repos",
      "events_url": "https://api.github.com/users/bkoropoff/events{/privacy}",
      "received_events_url": "https://api.github.com/users/bkoropoff/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-10-04T23:50:18Z",
    "updated_at": "2014-10-04T23:50:18Z",
    "body": "I think there may be multiple issues.  Right now unboxed closures permit the moral equivalent of mutating through an `&&mut`.  It seems like borrowck should reject this out of hand regardless of the regions involved.  I'm still new to the compiler, though, so I could be totally off here.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/57922068/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/57922618",
    "html_url": "https://github.com/rust-lang/rust/issues/17780#issuecomment-57922618",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/17780",
    "id": 57922618,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU3OTIyNjE4",
    "user": {
      "login": "zwarich",
      "id": 440875,
      "node_id": "MDQ6VXNlcjQ0MDg3NQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/440875?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/zwarich",
      "html_url": "https://github.com/zwarich",
      "followers_url": "https://api.github.com/users/zwarich/followers",
      "following_url": "https://api.github.com/users/zwarich/following{/other_user}",
      "gists_url": "https://api.github.com/users/zwarich/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/zwarich/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/zwarich/subscriptions",
      "organizations_url": "https://api.github.com/users/zwarich/orgs",
      "repos_url": "https://api.github.com/users/zwarich/repos",
      "events_url": "https://api.github.com/users/zwarich/events{/privacy}",
      "received_events_url": "https://api.github.com/users/zwarich/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-10-05T00:22:26Z",
    "updated_at": "2014-10-05T00:22:26Z",
    "body": "@bkoropoff I meant that after your proposed fix there might be other soundness problems with unboxed closures, based on the fact that the inferred regions seem incorrect, but playing around for a bit I can't get any of them to happen.\n",
    "author_association": "NONE",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/57922618/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/57922687",
    "html_url": "https://github.com/rust-lang/rust/issues/17780#issuecomment-57922687",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/17780",
    "id": 57922687,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU3OTIyNjg3",
    "user": {
      "login": "bkoropoff",
      "id": 2101303,
      "node_id": "MDQ6VXNlcjIxMDEzMDM=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2101303?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/bkoropoff",
      "html_url": "https://github.com/bkoropoff",
      "followers_url": "https://api.github.com/users/bkoropoff/followers",
      "following_url": "https://api.github.com/users/bkoropoff/following{/other_user}",
      "gists_url": "https://api.github.com/users/bkoropoff/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/bkoropoff/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/bkoropoff/subscriptions",
      "organizations_url": "https://api.github.com/users/bkoropoff/orgs",
      "repos_url": "https://api.github.com/users/bkoropoff/repos",
      "events_url": "https://api.github.com/users/bkoropoff/events{/privacy}",
      "received_events_url": "https://api.github.com/users/bkoropoff/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-10-05T00:26:44Z",
    "updated_at": "2014-10-05T00:26:44Z",
    "body": "The following presently builds:\n\n``` rust\n#![feature(unboxed_closures, overloaded_calls)]\n\nfn main() {\n    let mut x = 0u;\n    let _f = |&:| x = 42;\n}\n```\n\nHowever, this is equivalent to writing:\n\n``` rust\nstruct F<'a> {\n    x: &'a mut uint\n}\n\nimpl<'a> Fn<(),()> for F<'a> {\n    #[rust_call_abi_hack]\n    fn call(&self, _: ()) {\n        *self.x = 42; // error: cannot assign to data in a `&` reference\n    }\n}\n\nfn main() {\n    let mut x = 0u;\n    let _f = F { x: &mut x };\n}\n```\n\nThe key is that `call` takes self immutably, which means the closure can be invoked through an immutable reference and wreak havoc.  Boxed closures can't be called through immutable references, so there isn't a problem here.\n\nMy patch fixes this, but it does not address the region issue.  I'll retitle the bug to make it clear that it only covers this unboxed-closure-specific issue.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/57922687/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/57925288",
    "html_url": "https://github.com/rust-lang/rust/issues/17780#issuecomment-57925288",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/17780",
    "id": 57925288,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU3OTI1Mjg4",
    "user": {
      "login": "zwarich",
      "id": 440875,
      "node_id": "MDQ6VXNlcjQ0MDg3NQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/440875?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/zwarich",
      "html_url": "https://github.com/zwarich",
      "followers_url": "https://api.github.com/users/zwarich/followers",
      "following_url": "https://api.github.com/users/zwarich/following{/other_user}",
      "gists_url": "https://api.github.com/users/zwarich/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/zwarich/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/zwarich/subscriptions",
      "organizations_url": "https://api.github.com/users/zwarich/orgs",
      "repos_url": "https://api.github.com/users/zwarich/repos",
      "events_url": "https://api.github.com/users/zwarich/events{/privacy}",
      "received_events_url": "https://api.github.com/users/zwarich/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-10-05T03:14:25Z",
    "updated_at": "2014-10-05T03:14:25Z",
    "body": "A variation of this example causes an ICE: https://github.com/rust-lang/rust/issues/17786\n",
    "author_association": "NONE",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/57925288/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/58578712",
    "html_url": "https://github.com/rust-lang/rust/issues/17780#issuecomment-58578712",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/17780",
    "id": 58578712,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU4NTc4NzEy",
    "user": {
      "login": "zwarich",
      "id": 440875,
      "node_id": "MDQ6VXNlcjQ0MDg3NQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/440875?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/zwarich",
      "html_url": "https://github.com/zwarich",
      "followers_url": "https://api.github.com/users/zwarich/followers",
      "following_url": "https://api.github.com/users/zwarich/following{/other_user}",
      "gists_url": "https://api.github.com/users/zwarich/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/zwarich/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/zwarich/subscriptions",
      "organizations_url": "https://api.github.com/users/zwarich/orgs",
      "repos_url": "https://api.github.com/users/zwarich/repos",
      "events_url": "https://api.github.com/users/zwarich/events{/privacy}",
      "received_events_url": "https://api.github.com/users/zwarich/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-10-09T21:13:27Z",
    "updated_at": "2014-10-09T21:13:27Z",
    "body": "#17784 is merged, so this is fixed.\n",
    "author_association": "NONE",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/58578712/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
