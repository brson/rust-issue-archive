[
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/50246309",
    "html_url": "https://github.com/rust-lang/rust/issues/16011#issuecomment-50246309",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/16011",
    "id": 50246309,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUwMjQ2MzA5",
    "user": {
      "login": "bluss",
      "id": 3209739,
      "node_id": "MDQ6VXNlcjMyMDk3Mzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3209739?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/bluss",
      "html_url": "https://github.com/bluss",
      "followers_url": "https://api.github.com/users/bluss/followers",
      "following_url": "https://api.github.com/users/bluss/following{/other_user}",
      "gists_url": "https://api.github.com/users/bluss/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/bluss/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/bluss/subscriptions",
      "organizations_url": "https://api.github.com/users/bluss/orgs",
      "repos_url": "https://api.github.com/users/bluss/repos",
      "events_url": "https://api.github.com/users/bluss/events{/privacy}",
      "received_events_url": "https://api.github.com/users/bluss/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-07-26T19:37:44Z",
    "updated_at": "2014-07-26T19:37:44Z",
    "body": "cc @pcwalton \n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/50246309/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/50251196",
    "html_url": "https://github.com/rust-lang/rust/issues/16011#issuecomment-50251196",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/16011",
    "id": 50251196,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUwMjUxMTk2",
    "user": {
      "login": "japaric",
      "id": 5018213,
      "node_id": "MDQ6VXNlcjUwMTgyMTM=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5018213?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/japaric",
      "html_url": "https://github.com/japaric",
      "followers_url": "https://api.github.com/users/japaric/followers",
      "following_url": "https://api.github.com/users/japaric/following{/other_user}",
      "gists_url": "https://api.github.com/users/japaric/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/japaric/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/japaric/subscriptions",
      "organizations_url": "https://api.github.com/users/japaric/orgs",
      "repos_url": "https://api.github.com/users/japaric/repos",
      "events_url": "https://api.github.com/users/japaric/events{/privacy}",
      "received_events_url": "https://api.github.com/users/japaric/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-07-26T23:15:10Z",
    "updated_at": "2014-07-26T23:15:10Z",
    "body": "@blake2-ppc\n\nThis looks like a regression in the borrow checker. You're not supposed to be able to mutably borrow `it` inside the `for` loop, because the `for i in it` already mutably borrows `it`.\n\nYou can confirm this is a regression by testing [your program in the playpen](http://is.gd/qpXZqm), but compiling it with the 0.11 snapshot, where it gets flagged as incorrect (reason: double mutable borrow).\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/50251196/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/50251266",
    "html_url": "https://github.com/rust-lang/rust/issues/16011#issuecomment-50251266",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/16011",
    "id": 50251266,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUwMjUxMjY2",
    "user": {
      "login": "thestinger",
      "id": 1505226,
      "node_id": "MDQ6VXNlcjE1MDUyMjY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1505226?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/thestinger",
      "html_url": "https://github.com/thestinger",
      "followers_url": "https://api.github.com/users/thestinger/followers",
      "following_url": "https://api.github.com/users/thestinger/following{/other_user}",
      "gists_url": "https://api.github.com/users/thestinger/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/thestinger/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/thestinger/subscriptions",
      "organizations_url": "https://api.github.com/users/thestinger/orgs",
      "repos_url": "https://api.github.com/users/thestinger/repos",
      "events_url": "https://api.github.com/users/thestinger/events{/privacy}",
      "received_events_url": "https://api.github.com/users/thestinger/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-07-26T23:19:58Z",
    "updated_at": "2014-07-26T23:20:23Z",
    "body": "It doesn't have to borrow it as `&mut`, it's only calling an `&mut self` method on it and the return value isn't tied to that `self`. It was borrowing it as `&mut` before due to the AST expansion hack.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/50251266/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/50257175",
    "html_url": "https://github.com/rust-lang/rust/issues/16011#issuecomment-50257175",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/16011",
    "id": 50257175,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUwMjU3MTc1",
    "user": {
      "login": "eddyb",
      "id": 77424,
      "node_id": "MDQ6VXNlcjc3NDI0",
      "avatar_url": "https://avatars.githubusercontent.com/u/77424?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/eddyb",
      "html_url": "https://github.com/eddyb",
      "followers_url": "https://api.github.com/users/eddyb/followers",
      "following_url": "https://api.github.com/users/eddyb/following{/other_user}",
      "gists_url": "https://api.github.com/users/eddyb/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/eddyb/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/eddyb/subscriptions",
      "organizations_url": "https://api.github.com/users/eddyb/orgs",
      "repos_url": "https://api.github.com/users/eddyb/repos",
      "events_url": "https://api.github.com/users/eddyb/events{/privacy}",
      "received_events_url": "https://api.github.com/users/eddyb/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-07-27T06:33:00Z",
    "updated_at": "2014-07-27T06:33:00Z",
    "body": "Interestingly enough, trying to reduce the IR by isolating the `println` call [produces the correct result](http://is.gd/MS164B) even with optimizations.\n\nYes, it does seem an optimized `println` call is important for this bug to manifest.\nIt reuses a pointer into the value of the `Option<uint>` that `next` returns, as part of the `for` loop, for printing.\nHowever... It all seems fine until you notice the LLVM lifetime intrinsics: that `Option` gets `llvm.lifetime.start` called for it before the loop (because of that pointer reuse thing) then after each iteration. There is no `llvm.lifetime.end` call for it.\ncc @dotdash\n\nOn a second thought, there are no such intrinsics without optimizations so they must've been added by inlining or other LLVM passes. I'll leave this to the experts.\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/50257175/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/50367698",
    "html_url": "https://github.com/rust-lang/rust/issues/16011#issuecomment-50367698",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/16011",
    "id": 50367698,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUwMzY3Njk4",
    "user": {
      "login": "dotdash",
      "id": 230962,
      "node_id": "MDQ6VXNlcjIzMDk2Mg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/230962?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dotdash",
      "html_url": "https://github.com/dotdash",
      "followers_url": "https://api.github.com/users/dotdash/followers",
      "following_url": "https://api.github.com/users/dotdash/following{/other_user}",
      "gists_url": "https://api.github.com/users/dotdash/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dotdash/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dotdash/subscriptions",
      "organizations_url": "https://api.github.com/users/dotdash/orgs",
      "repos_url": "https://api.github.com/users/dotdash/repos",
      "events_url": "https://api.github.com/users/dotdash/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dotdash/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-07-28T17:11:40Z",
    "updated_at": "2014-07-28T17:11:40Z",
    "body": "Looks like a mis-optimization.\n\n``` llvm\n; ModuleID = '<stdin>'\ntarget datalayout = \"e-i64:64-f80:128-n8:16:32:64-S128\"\ntarget triple = \"x86_64-unknown-linux-gnu\"\n\ndefine void @test(i1 %c) {\nentry-block:\n  %x = alloca i8\n  br label %loop_in\n\nloop_in:                                          ; preds = %loop_out, %loop_body, %entry-block\n  call void @llvm.lifetime.start(i64 8, i8* %x)\n  br label %loop_body\n\nloop_body:                                        ; preds = %loop_in\n  br i1 %c, label %loop_in, label %loop_out\n\nloop_out:                                         ; preds = %loop_body\n  call void @llvm.lifetime.end(i64 8, i8* %x)\n  br label %loop_in\n\nout:                                              ; No predecessors!\n  ret void\n}\n\n; Function Attrs: nounwind\ndeclare void @llvm.lifetime.start(i64, i8* nocapture) unnamed_addr #0\n\n; Function Attrs: nounwind\ndeclare void @llvm.lifetime.end(i64, i8* nocapture) unnamed_addr #0\n\nattributes #0 = { nounwind }\n```\n\nLooks like this after SimplifyCFG:\n\n``` llvm\n; ModuleID = 'test.no-opt.bc'\ntarget datalayout = \"e-i64:64-f80:128-n8:16:32:64-S128\"\ntarget triple = \"x86_64-unknown-linux-gnu\"\n\ndefine void @test(i1 %c) {\nentry-block:\n  %x = alloca i8\n  br label %loop_body\n\nloop_body:                                        ; preds = %loop_body, %entry-block\n  call void @llvm.lifetime.start(i64 8, i8* %x)\n  br label %loop_body\n}\n\n; Function Attrs: nounwind\ndeclare void @llvm.lifetime.start(i64, i8* nocapture) unnamed_addr #0\n\n; Function Attrs: nounwind\ndeclare void @llvm.lifetime.end(i64, i8* nocapture) unnamed_addr #0\n\nattributes #0 = { nounwind }\n```\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/50367698/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/50376678",
    "html_url": "https://github.com/rust-lang/rust/issues/16011#issuecomment-50376678",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/16011",
    "id": 50376678,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUwMzc2Njc4",
    "user": {
      "login": "dotdash",
      "id": 230962,
      "node_id": "MDQ6VXNlcjIzMDk2Mg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/230962?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dotdash",
      "html_url": "https://github.com/dotdash",
      "followers_url": "https://api.github.com/users/dotdash/followers",
      "following_url": "https://api.github.com/users/dotdash/following{/other_user}",
      "gists_url": "https://api.github.com/users/dotdash/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dotdash/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dotdash/subscriptions",
      "organizations_url": "https://api.github.com/users/dotdash/orgs",
      "repos_url": "https://api.github.com/users/dotdash/repos",
      "events_url": "https://api.github.com/users/dotdash/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dotdash/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-07-28T18:17:01Z",
    "updated_at": "2014-07-28T18:17:01Z",
    "body": "The above on its own isn't enough. In addition to that the loop rotate pass moves the lifetime start from the start of the loop to the end, and that kills it.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/50376678/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/50398622",
    "html_url": "https://github.com/rust-lang/rust/issues/16011#issuecomment-50398622",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/16011",
    "id": 50398622,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUwMzk4NjIy",
    "user": {
      "login": "dotdash",
      "id": 230962,
      "node_id": "MDQ6VXNlcjIzMDk2Mg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/230962?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dotdash",
      "html_url": "https://github.com/dotdash",
      "followers_url": "https://api.github.com/users/dotdash/followers",
      "following_url": "https://api.github.com/users/dotdash/following{/other_user}",
      "gists_url": "https://api.github.com/users/dotdash/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dotdash/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dotdash/subscriptions",
      "organizations_url": "https://api.github.com/users/dotdash/orgs",
      "repos_url": "https://api.github.com/users/dotdash/repos",
      "events_url": "https://api.github.com/users/dotdash/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dotdash/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-07-28T20:52:04Z",
    "updated_at": "2014-07-28T20:52:04Z",
    "body": "Fix submitted upstream at http://reviews.llvm.org/D4699\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/50398622/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/51020710",
    "html_url": "https://github.com/rust-lang/rust/issues/16011#issuecomment-51020710",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/16011",
    "id": 51020710,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUxMDIwNzEw",
    "user": {
      "login": "luqmana",
      "id": 287063,
      "node_id": "MDQ6VXNlcjI4NzA2Mw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/287063?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/luqmana",
      "html_url": "https://github.com/luqmana",
      "followers_url": "https://api.github.com/users/luqmana/followers",
      "following_url": "https://api.github.com/users/luqmana/following{/other_user}",
      "gists_url": "https://api.github.com/users/luqmana/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/luqmana/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/luqmana/subscriptions",
      "organizations_url": "https://api.github.com/users/luqmana/orgs",
      "repos_url": "https://api.github.com/users/luqmana/repos",
      "events_url": "https://api.github.com/users/luqmana/events{/privacy}",
      "received_events_url": "https://api.github.com/users/luqmana/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-08-04T06:09:10Z",
    "updated_at": "2014-08-04T06:09:10Z",
    "body": "Fixed by #16080.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/51020710/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
