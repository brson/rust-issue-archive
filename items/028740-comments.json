[
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/144229026",
    "html_url": "https://github.com/rust-lang/rust/issues/28740#issuecomment-144229026",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28740",
    "id": 144229026,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE0NDIyOTAyNg==",
    "user": {
      "login": "alexcrichton",
      "id": 64996,
      "node_id": "MDQ6VXNlcjY0OTk2",
      "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alexcrichton",
      "html_url": "https://github.com/alexcrichton",
      "followers_url": "https://api.github.com/users/alexcrichton/followers",
      "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}",
      "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions",
      "organizations_url": "https://api.github.com/users/alexcrichton/orgs",
      "repos_url": "https://api.github.com/users/alexcrichton/repos",
      "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alexcrichton/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-09-30T00:37:20Z",
    "updated_at": "2015-09-30T00:37:20Z",
    "body": "This is currently because the \"Rust\" ABI has an implementation of using the C ABI. These are distinct in the type system, however, because the definition of the Rust ABI may change over time (whereas C has a known definition). \n\nSo although `#[no_mangle] pub fn` may work today, it's always recommended for C-facing interfaces to use `extern` to have the \"C\" ABI.\n\nI believe this is working as intended though, so closing. Thanks for the report though!\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/144229026/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/144263237",
    "html_url": "https://github.com/rust-lang/rust/issues/28740#issuecomment-144263237",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28740",
    "id": 144263237,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE0NDI2MzIzNw==",
    "user": {
      "login": "m4b",
      "id": 1920204,
      "node_id": "MDQ6VXNlcjE5MjAyMDQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1920204?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/m4b",
      "html_url": "https://github.com/m4b",
      "followers_url": "https://api.github.com/users/m4b/followers",
      "following_url": "https://api.github.com/users/m4b/following{/other_user}",
      "gists_url": "https://api.github.com/users/m4b/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/m4b/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/m4b/subscriptions",
      "organizations_url": "https://api.github.com/users/m4b/orgs",
      "repos_url": "https://api.github.com/users/m4b/repos",
      "events_url": "https://api.github.com/users/m4b/events{/privacy}",
      "received_events_url": "https://api.github.com/users/m4b/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-09-30T02:37:29Z",
    "updated_at": "2015-09-30T02:37:29Z",
    "body": "Ok awesome, good to know.  So in the documentation might be good to perhaps mention your last point, with perhaps an example which could change in the future.  Thanks for the prompt reply!\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/144263237/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/144318761",
    "html_url": "https://github.com/rust-lang/rust/issues/28740#issuecomment-144318761",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28740",
    "id": 144318761,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE0NDMxODc2MQ==",
    "user": {
      "login": "dotdash",
      "id": 230962,
      "node_id": "MDQ6VXNlcjIzMDk2Mg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/230962?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dotdash",
      "html_url": "https://github.com/dotdash",
      "followers_url": "https://api.github.com/users/dotdash/followers",
      "following_url": "https://api.github.com/users/dotdash/following{/other_user}",
      "gists_url": "https://api.github.com/users/dotdash/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dotdash/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dotdash/subscriptions",
      "organizations_url": "https://api.github.com/users/dotdash/orgs",
      "repos_url": "https://api.github.com/users/dotdash/repos",
      "events_url": "https://api.github.com/users/dotdash/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dotdash/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-09-30T08:00:20Z",
    "updated_at": "2015-09-30T08:00:20Z",
    "body": "From the top of my head, I know two things where we currently differ from\nthe C ABI on x86_64. Both involve passing structs by value.\n\n```\nstruct Largish { a: i64, b: i64 }\n\nfn foo(l: Largish);\n```\n\nHere, `l` will be passed in registers in the C ABI, but Rust will put a\ncopy on the stack and pass a pointer to that copy in a register. Rust's ABI\nwill likely change here to do the same as the C ABI.\n\n```\nstruct Large { a: i64, b: i64, c: i64 }\n\nfn bar(l: Large);\n```\n\nHere, both ABIs will end create a copy on the stack, but the C ABI places\nit at a fixed offset from the stack pointer so the callee knows where to\nfind it, while Rust will pass in a pointer to the copy in a register. This\nmight change once we have fully working non-zeroing drop, which opens up a\nfew possibilities that will have to be explored.\nAm 30.09.2015 04:37 schrieb \"m4b\" notifications@github.com:\n\n> Ok awesome, good to know. So in the documentation might be good to perhaps\n> mention your last point, with perhaps an example which could change in the\n> future. Thanks for the prompt reply!\n> \n> \u2014\n> Reply to this email directly or view it on GitHub\n> https://github.com/rust-lang/rust/issues/28740#issuecomment-144263237.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/144318761/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/144479558",
    "html_url": "https://github.com/rust-lang/rust/issues/28740#issuecomment-144479558",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28740",
    "id": 144479558,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE0NDQ3OTU1OA==",
    "user": {
      "login": "m4b",
      "id": 1920204,
      "node_id": "MDQ6VXNlcjE5MjAyMDQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1920204?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/m4b",
      "html_url": "https://github.com/m4b",
      "followers_url": "https://api.github.com/users/m4b/followers",
      "following_url": "https://api.github.com/users/m4b/following{/other_user}",
      "gists_url": "https://api.github.com/users/m4b/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/m4b/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/m4b/subscriptions",
      "organizations_url": "https://api.github.com/users/m4b/orgs",
      "repos_url": "https://api.github.com/users/m4b/repos",
      "events_url": "https://api.github.com/users/m4b/events{/privacy}",
      "received_events_url": "https://api.github.com/users/m4b/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-09-30T17:10:36Z",
    "updated_at": "2015-09-30T17:10:36Z",
    "body": "@dotdash This is a very good example, thank you; I've verified it behaves exactly as you described.\n\nI know this issue is closed but this has brought to my mind perhaps the need for a guide/cheatsheet which outlines some of the differences between a rust ABI (obviously this will change) and a C ABI (this won't).\n\nIn particular, I'm wondering now if there are any rust constructs which just won't map to a C ABI, and if so, it might be prudent to avoid these constructions and use something simpler/known to map correctly.  For example, if someone is working on a completely C-compatible rust-source dynamic library, this would be essential.\n\nAre there currently any resources like this (I don't see anything in the Rustonomicon or the Book)?\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/144479558/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/144505411",
    "html_url": "https://github.com/rust-lang/rust/issues/28740#issuecomment-144505411",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28740",
    "id": 144505411,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE0NDUwNTQxMQ==",
    "user": {
      "login": "steveklabnik",
      "id": 27786,
      "node_id": "MDQ6VXNlcjI3Nzg2",
      "avatar_url": "https://avatars.githubusercontent.com/u/27786?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/steveklabnik",
      "html_url": "https://github.com/steveklabnik",
      "followers_url": "https://api.github.com/users/steveklabnik/followers",
      "following_url": "https://api.github.com/users/steveklabnik/following{/other_user}",
      "gists_url": "https://api.github.com/users/steveklabnik/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/steveklabnik/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/steveklabnik/subscriptions",
      "organizations_url": "https://api.github.com/users/steveklabnik/orgs",
      "repos_url": "https://api.github.com/users/steveklabnik/repos",
      "events_url": "https://api.github.com/users/steveklabnik/events{/privacy}",
      "received_events_url": "https://api.github.com/users/steveklabnik/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-09-30T18:51:02Z",
    "updated_at": "2015-09-30T18:51:02Z",
    "body": "We haven't wanted to document this stuff, because as soon as you document\nit, even if you say it's not stable, people start to rely on it.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/144505411/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/144508278",
    "html_url": "https://github.com/rust-lang/rust/issues/28740#issuecomment-144508278",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28740",
    "id": 144508278,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE0NDUwODI3OA==",
    "user": {
      "login": "m4b",
      "id": 1920204,
      "node_id": "MDQ6VXNlcjE5MjAyMDQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1920204?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/m4b",
      "html_url": "https://github.com/m4b",
      "followers_url": "https://api.github.com/users/m4b/followers",
      "following_url": "https://api.github.com/users/m4b/following{/other_user}",
      "gists_url": "https://api.github.com/users/m4b/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/m4b/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/m4b/subscriptions",
      "organizations_url": "https://api.github.com/users/m4b/orgs",
      "repos_url": "https://api.github.com/users/m4b/repos",
      "events_url": "https://api.github.com/users/m4b/events{/privacy}",
      "received_events_url": "https://api.github.com/users/m4b/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-09-30T19:03:11Z",
    "updated_at": "2015-09-30T19:03:11Z",
    "body": "Yes, agreed on the rust ABI aspect, but I was specifically referring to rust -> C ABI authors in my comment above.\n\nAgain, if I want to write a C-compatible dynamic library using rust, _and_ if there are rust constructs which don't map at all to a C ABI, then I need to know this, as the author.  Otherwise your FFI interface isn't reliable, in which case it shouldn't be documented either, for the same reasons you mentioned above.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/144508278/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/144509432",
    "html_url": "https://github.com/rust-lang/rust/issues/28740#issuecomment-144509432",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28740",
    "id": 144509432,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE0NDUwOTQzMg==",
    "user": {
      "login": "steveklabnik",
      "id": 27786,
      "node_id": "MDQ6VXNlcjI3Nzg2",
      "avatar_url": "https://avatars.githubusercontent.com/u/27786?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/steveklabnik",
      "html_url": "https://github.com/steveklabnik",
      "followers_url": "https://api.github.com/users/steveklabnik/followers",
      "following_url": "https://api.github.com/users/steveklabnik/following{/other_user}",
      "gists_url": "https://api.github.com/users/steveklabnik/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/steveklabnik/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/steveklabnik/subscriptions",
      "organizations_url": "https://api.github.com/users/steveklabnik/orgs",
      "repos_url": "https://api.github.com/users/steveklabnik/repos",
      "events_url": "https://api.github.com/users/steveklabnik/events{/privacy}",
      "received_events_url": "https://api.github.com/users/steveklabnik/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-09-30T19:08:08Z",
    "updated_at": "2015-09-30T19:08:08Z",
    "body": "Ah, yeah, I misunderstood that part.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/144509432/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
