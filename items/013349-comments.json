[
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/39654508",
    "html_url": "https://github.com/rust-lang/rust/pull/13349#issuecomment-39654508",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/13349",
    "id": 39654508,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM5NjU0NTA4",
    "user": {
      "login": "lilyball",
      "id": 714,
      "node_id": "MDQ6VXNlcjcxNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/714?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/lilyball",
      "html_url": "https://github.com/lilyball",
      "followers_url": "https://api.github.com/users/lilyball/followers",
      "following_url": "https://api.github.com/users/lilyball/following{/other_user}",
      "gists_url": "https://api.github.com/users/lilyball/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/lilyball/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/lilyball/subscriptions",
      "organizations_url": "https://api.github.com/users/lilyball/orgs",
      "repos_url": "https://api.github.com/users/lilyball/repos",
      "events_url": "https://api.github.com/users/lilyball/events{/privacy}",
      "received_events_url": "https://api.github.com/users/lilyball/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-04-05T23:50:30Z",
    "updated_at": "2014-04-05T23:50:30Z",
    "body": "I think you mean \u00b5s, not ps.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/39654508/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/39654529",
    "html_url": "https://github.com/rust-lang/rust/pull/13349#issuecomment-39654529",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/13349",
    "id": 39654529,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM5NjU0NTI5",
    "user": {
      "login": "lilyball",
      "id": 714,
      "node_id": "MDQ6VXNlcjcxNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/714?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/lilyball",
      "html_url": "https://github.com/lilyball",
      "followers_url": "https://api.github.com/users/lilyball/followers",
      "following_url": "https://api.github.com/users/lilyball/following{/other_user}",
      "gists_url": "https://api.github.com/users/lilyball/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/lilyball/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/lilyball/subscriptions",
      "organizations_url": "https://api.github.com/users/lilyball/orgs",
      "repos_url": "https://api.github.com/users/lilyball/repos",
      "events_url": "https://api.github.com/users/lilyball/events{/privacy}",
      "received_events_url": "https://api.github.com/users/lilyball/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-04-05T23:51:50Z",
    "updated_at": "2014-04-05T23:51:50Z",
    "body": "I'm also worried about correctness. Is a relaxed load here sufficient?\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/39654529/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/39654942",
    "html_url": "https://github.com/rust-lang/rust/pull/13349#issuecomment-39654942",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/13349",
    "id": 39654942,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM5NjU0OTQy",
    "user": {
      "login": "lilyball",
      "id": 714,
      "node_id": "MDQ6VXNlcjcxNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/714?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/lilyball",
      "html_url": "https://github.com/lilyball",
      "followers_url": "https://api.github.com/users/lilyball/followers",
      "following_url": "https://api.github.com/users/lilyball/following{/other_user}",
      "gists_url": "https://api.github.com/users/lilyball/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/lilyball/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/lilyball/subscriptions",
      "organizations_url": "https://api.github.com/users/lilyball/orgs",
      "repos_url": "https://api.github.com/users/lilyball/repos",
      "events_url": "https://api.github.com/users/lilyball/events{/privacy}",
      "received_events_url": "https://api.github.com/users/lilyball/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-04-06T00:16:18Z",
    "updated_at": "2014-04-06T00:16:18Z",
    "body": "A different change that's more likely to be safe is changing the `self.cnt.store(int::MIN, atomics::SeqCst)` to using `atomics::Relaxed`, since there's no ordering requirement there, it's only to prevent an infinite loop of doit's from behaving wrong.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/39654942/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/39655250",
    "html_url": "https://github.com/rust-lang/rust/pull/13349#issuecomment-39655250",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/13349",
    "id": 39655250,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM5NjU1MjUw",
    "user": {
      "login": "lilyball",
      "id": 714,
      "node_id": "MDQ6VXNlcjcxNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/714?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/lilyball",
      "html_url": "https://github.com/lilyball",
      "followers_url": "https://api.github.com/users/lilyball/followers",
      "following_url": "https://api.github.com/users/lilyball/following{/other_user}",
      "gists_url": "https://api.github.com/users/lilyball/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/lilyball/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/lilyball/subscriptions",
      "organizations_url": "https://api.github.com/users/lilyball/orgs",
      "repos_url": "https://api.github.com/users/lilyball/repos",
      "events_url": "https://api.github.com/users/lilyball/events{/privacy}",
      "received_events_url": "https://api.github.com/users/lilyball/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-04-06T00:34:23Z",
    "updated_at": "2014-04-06T00:34:31Z",
    "body": "BTW, your benchmarks are off. If you compiled your version of `once` in the same crate as your benchmark, optimization will screw with your actual timing.\n\nIn my tests, using a separate crate (and no LTO) to avoid the unwanted optimization, on a 3.4GHz Intel Core i7 iMac, I get approximately 13200\u00b5s for the libstd version, 3100\u00b5s for your version, and 9100\u00b5s for the version with my proposed conservative change.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/39655250/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/39655323",
    "html_url": "https://github.com/rust-lang/rust/pull/13349#issuecomment-39655323",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/13349",
    "id": 39655323,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM5NjU1MzIz",
    "user": {
      "login": "stepancheg",
      "id": 28969,
      "node_id": "MDQ6VXNlcjI4OTY5",
      "avatar_url": "https://avatars.githubusercontent.com/u/28969?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/stepancheg",
      "html_url": "https://github.com/stepancheg",
      "followers_url": "https://api.github.com/users/stepancheg/followers",
      "following_url": "https://api.github.com/users/stepancheg/following{/other_user}",
      "gists_url": "https://api.github.com/users/stepancheg/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/stepancheg/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/stepancheg/subscriptions",
      "organizations_url": "https://api.github.com/users/stepancheg/orgs",
      "repos_url": "https://api.github.com/users/stepancheg/repos",
      "events_url": "https://api.github.com/users/stepancheg/events{/privacy}",
      "received_events_url": "https://api.github.com/users/stepancheg/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-04-06T00:39:07Z",
    "updated_at": "2014-04-06T00:39:07Z",
    "body": "@kballard \n\n> I think you mean \u00b5s, not ps.\n\nI did mean ps. One call to `doit` takes less than 1ns, so I multiplied result by 1000.\n\n> I'm also worried about correctness. Is a relaxed load here sufficient?\n\nI'm not expert. I did more thinking and I think that \"relaxed\" guarantees that `doit` will be called exactly once, but does not provide guarantees that result of `doit` will be visible to another thread. So I'll change it to `SeqCst` in a minute.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/39655323/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/39655353",
    "html_url": "https://github.com/rust-lang/rust/pull/13349#issuecomment-39655353",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/13349",
    "id": 39655353,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM5NjU1MzUz",
    "user": {
      "login": "lilyball",
      "id": 714,
      "node_id": "MDQ6VXNlcjcxNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/714?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/lilyball",
      "html_url": "https://github.com/lilyball",
      "followers_url": "https://api.github.com/users/lilyball/followers",
      "following_url": "https://api.github.com/users/lilyball/following{/other_user}",
      "gists_url": "https://api.github.com/users/lilyball/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/lilyball/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/lilyball/subscriptions",
      "organizations_url": "https://api.github.com/users/lilyball/orgs",
      "repos_url": "https://api.github.com/users/lilyball/repos",
      "events_url": "https://api.github.com/users/lilyball/events{/privacy}",
      "received_events_url": "https://api.github.com/users/lilyball/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-04-06T00:40:51Z",
    "updated_at": "2014-04-06T00:40:51Z",
    "body": "@stepancheg Oops you're right. I misread the timing code. And actually thinking about it, \u00b5s is obviously wrong because that's too slow.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/39655353/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/39655374",
    "html_url": "https://github.com/rust-lang/rust/pull/13349#issuecomment-39655374",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/13349",
    "id": 39655374,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM5NjU1Mzc0",
    "user": {
      "login": "stepancheg",
      "id": 28969,
      "node_id": "MDQ6VXNlcjI4OTY5",
      "avatar_url": "https://avatars.githubusercontent.com/u/28969?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/stepancheg",
      "html_url": "https://github.com/stepancheg",
      "followers_url": "https://api.github.com/users/stepancheg/followers",
      "following_url": "https://api.github.com/users/stepancheg/following{/other_user}",
      "gists_url": "https://api.github.com/users/stepancheg/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/stepancheg/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/stepancheg/subscriptions",
      "organizations_url": "https://api.github.com/users/stepancheg/orgs",
      "repos_url": "https://api.github.com/users/stepancheg/repos",
      "events_url": "https://api.github.com/users/stepancheg/events{/privacy}",
      "received_events_url": "https://api.github.com/users/stepancheg/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-04-06T00:41:52Z",
    "updated_at": "2014-04-06T00:41:52Z",
    "body": "@kballard what is \"unwanted optimization\", and why would you turn off LTO?\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/39655374/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/39655436",
    "html_url": "https://github.com/rust-lang/rust/pull/13349#issuecomment-39655436",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/13349",
    "id": 39655436,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM5NjU1NDM2",
    "user": {
      "login": "lilyball",
      "id": 714,
      "node_id": "MDQ6VXNlcjcxNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/714?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/lilyball",
      "html_url": "https://github.com/lilyball",
      "followers_url": "https://api.github.com/users/lilyball/followers",
      "following_url": "https://api.github.com/users/lilyball/following{/other_user}",
      "gists_url": "https://api.github.com/users/lilyball/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/lilyball/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/lilyball/subscriptions",
      "organizations_url": "https://api.github.com/users/lilyball/orgs",
      "repos_url": "https://api.github.com/users/lilyball/repos",
      "events_url": "https://api.github.com/users/lilyball/events{/privacy}",
      "received_events_url": "https://api.github.com/users/lilyball/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-04-06T00:45:21Z",
    "updated_at": "2014-04-06T00:45:21Z",
    "body": "@stepancheg You're trying to time a delicate threading thing. In my tests, when the `once` code is in the same crate as the benchmarking code, I get approximately about 600ps from your code. But if I insert a single extra call to `doit` outside of your loop, the time per iter jumps to 3100ps. This is clearly nonsense, which means that extra call is preventing optimizations that rustc was doing. I'm assuming it was inlining the call to `doit()` (because it only had one call site), but the extra call made it reconsider.\n\nAnd turning off LTO is because LTO could enable it to start making those unwanted optimizations again.\n\nTaking optimization to its logical conclusion, if rustc could figure out not only that `doit()` was only called from one spot, but that this one spot was always on the same thread, it could ditch all the sequential consistency and memory barriers and see a massive speedup with no observable change to your code. But that's obviously terrible because we're explicitly trying to measure it with the memory barriers in place.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/39655436/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/39655557",
    "html_url": "https://github.com/rust-lang/rust/pull/13349#issuecomment-39655557",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/13349",
    "id": 39655557,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM5NjU1NTU3",
    "user": {
      "login": "stepancheg",
      "id": 28969,
      "node_id": "MDQ6VXNlcjI4OTY5",
      "avatar_url": "https://avatars.githubusercontent.com/u/28969?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/stepancheg",
      "html_url": "https://github.com/stepancheg",
      "followers_url": "https://api.github.com/users/stepancheg/followers",
      "following_url": "https://api.github.com/users/stepancheg/following{/other_user}",
      "gists_url": "https://api.github.com/users/stepancheg/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/stepancheg/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/stepancheg/subscriptions",
      "organizations_url": "https://api.github.com/users/stepancheg/orgs",
      "repos_url": "https://api.github.com/users/stepancheg/repos",
      "events_url": "https://api.github.com/users/stepancheg/events{/privacy}",
      "received_events_url": "https://api.github.com/users/stepancheg/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-04-06T00:54:02Z",
    "updated_at": "2014-04-06T00:54:02Z",
    "body": "@kballard that's interesting observation. Probably, `doit` should be split into two functions:\n\n```\n#[inline(always)]\nfn doit(...) {\n    if (load(...) < 0) {\n        return;\n    }\n    doit_slow(...);\n}\n\nfn doit_slow() { ... }\n```\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/39655557/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/39655852",
    "html_url": "https://github.com/rust-lang/rust/pull/13349#issuecomment-39655852",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/13349",
    "id": 39655852,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM5NjU1ODUy",
    "user": {
      "login": "lilyball",
      "id": 714,
      "node_id": "MDQ6VXNlcjcxNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/714?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/lilyball",
      "html_url": "https://github.com/lilyball",
      "followers_url": "https://api.github.com/users/lilyball/followers",
      "following_url": "https://api.github.com/users/lilyball/following{/other_user}",
      "gists_url": "https://api.github.com/users/lilyball/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/lilyball/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/lilyball/subscriptions",
      "organizations_url": "https://api.github.com/users/lilyball/orgs",
      "repos_url": "https://api.github.com/users/lilyball/repos",
      "events_url": "https://api.github.com/users/lilyball/events{/privacy}",
      "received_events_url": "https://api.github.com/users/lilyball/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-04-06T01:17:42Z",
    "updated_at": "2014-04-06T01:17:42Z",
    "body": "I've come up with a slightly different algorithm for `doit()` that I _believe_ is safe, and has the same performance as your code. Among other changes, it ditches `SeqCst` for proper acquire/release. However, being an atomic building block, it really needs a stringent review. I'll submit it as a separate PR.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/39655852/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/39655898",
    "html_url": "https://github.com/rust-lang/rust/pull/13349#issuecomment-39655898",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/13349",
    "id": 39655898,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM5NjU1ODk4",
    "user": {
      "login": "stepancheg",
      "id": 28969,
      "node_id": "MDQ6VXNlcjI4OTY5",
      "avatar_url": "https://avatars.githubusercontent.com/u/28969?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/stepancheg",
      "html_url": "https://github.com/stepancheg",
      "followers_url": "https://api.github.com/users/stepancheg/followers",
      "following_url": "https://api.github.com/users/stepancheg/following{/other_user}",
      "gists_url": "https://api.github.com/users/stepancheg/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/stepancheg/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/stepancheg/subscriptions",
      "organizations_url": "https://api.github.com/users/stepancheg/orgs",
      "repos_url": "https://api.github.com/users/stepancheg/repos",
      "events_url": "https://api.github.com/users/stepancheg/events{/privacy}",
      "received_events_url": "https://api.github.com/users/stepancheg/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-04-06T01:21:47Z",
    "updated_at": "2014-04-06T01:21:47Z",
    "body": "@kballard OK, waiting for your PR.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/39655898/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/39655913",
    "html_url": "https://github.com/rust-lang/rust/pull/13349#issuecomment-39655913",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/13349",
    "id": 39655913,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM5NjU1OTEz",
    "user": {
      "login": "stepancheg",
      "id": 28969,
      "node_id": "MDQ6VXNlcjI4OTY5",
      "avatar_url": "https://avatars.githubusercontent.com/u/28969?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/stepancheg",
      "html_url": "https://github.com/stepancheg",
      "followers_url": "https://api.github.com/users/stepancheg/followers",
      "following_url": "https://api.github.com/users/stepancheg/following{/other_user}",
      "gists_url": "https://api.github.com/users/stepancheg/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/stepancheg/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/stepancheg/subscriptions",
      "organizations_url": "https://api.github.com/users/stepancheg/orgs",
      "repos_url": "https://api.github.com/users/stepancheg/repos",
      "events_url": "https://api.github.com/users/stepancheg/events{/privacy}",
      "received_events_url": "https://api.github.com/users/stepancheg/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-04-06T01:22:59Z",
    "updated_at": "2014-04-06T01:22:59Z",
    "body": "BTW, I've uploaded new patch where `doit` split into two parts.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/39655913/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/39656018",
    "html_url": "https://github.com/rust-lang/rust/pull/13349#issuecomment-39656018",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/13349",
    "id": 39656018,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM5NjU2MDE4",
    "user": {
      "login": "lilyball",
      "id": 714,
      "node_id": "MDQ6VXNlcjcxNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/714?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/lilyball",
      "html_url": "https://github.com/lilyball",
      "followers_url": "https://api.github.com/users/lilyball/followers",
      "following_url": "https://api.github.com/users/lilyball/following{/other_user}",
      "gists_url": "https://api.github.com/users/lilyball/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/lilyball/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/lilyball/subscriptions",
      "organizations_url": "https://api.github.com/users/lilyball/orgs",
      "repos_url": "https://api.github.com/users/lilyball/repos",
      "events_url": "https://api.github.com/users/lilyball/events{/privacy}",
      "received_events_url": "https://api.github.com/users/lilyball/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-04-06T01:32:03Z",
    "updated_at": "2014-04-06T01:32:03Z",
    "body": "Filed as #13351.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/39656018/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/39656355",
    "html_url": "https://github.com/rust-lang/rust/pull/13349#issuecomment-39656355",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/13349",
    "id": 39656355,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM5NjU2MzU1",
    "user": {
      "login": "stepancheg",
      "id": 28969,
      "node_id": "MDQ6VXNlcjI4OTY5",
      "avatar_url": "https://avatars.githubusercontent.com/u/28969?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/stepancheg",
      "html_url": "https://github.com/stepancheg",
      "followers_url": "https://api.github.com/users/stepancheg/followers",
      "following_url": "https://api.github.com/users/stepancheg/following{/other_user}",
      "gists_url": "https://api.github.com/users/stepancheg/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/stepancheg/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/stepancheg/subscriptions",
      "organizations_url": "https://api.github.com/users/stepancheg/orgs",
      "repos_url": "https://api.github.com/users/stepancheg/repos",
      "events_url": "https://api.github.com/users/stepancheg/events{/privacy}",
      "received_events_url": "https://api.github.com/users/stepancheg/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-04-06T01:59:01Z",
    "updated_at": "2014-04-06T01:59:01Z",
    "body": "@kballard I'm not sure that your version is correct, but it is definitely easier to understand.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/39656355/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/41995556",
    "html_url": "https://github.com/rust-lang/rust/pull/13349#issuecomment-41995556",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/13349",
    "id": 41995556,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQxOTk1NTU2",
    "user": {
      "login": "huonw",
      "id": 1203825,
      "node_id": "MDQ6VXNlcjEyMDM4MjU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1203825?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/huonw",
      "html_url": "https://github.com/huonw",
      "followers_url": "https://api.github.com/users/huonw/followers",
      "following_url": "https://api.github.com/users/huonw/following{/other_user}",
      "gists_url": "https://api.github.com/users/huonw/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/huonw/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/huonw/subscriptions",
      "organizations_url": "https://api.github.com/users/huonw/orgs",
      "repos_url": "https://api.github.com/users/huonw/repos",
      "events_url": "https://api.github.com/users/huonw/events{/privacy}",
      "received_events_url": "https://api.github.com/users/huonw/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-05-02T06:38:05Z",
    "updated_at": "2014-05-02T06:38:05Z",
    "body": "Ping. This is just waiting on a decision vs. #13351, right?\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/41995556/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/41995663",
    "html_url": "https://github.com/rust-lang/rust/pull/13349#issuecomment-41995663",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/13349",
    "id": 41995663,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQxOTk1NjYz",
    "user": {
      "login": "lilyball",
      "id": 714,
      "node_id": "MDQ6VXNlcjcxNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/714?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/lilyball",
      "html_url": "https://github.com/lilyball",
      "followers_url": "https://api.github.com/users/lilyball/followers",
      "following_url": "https://api.github.com/users/lilyball/following{/other_user}",
      "gists_url": "https://api.github.com/users/lilyball/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/lilyball/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/lilyball/subscriptions",
      "organizations_url": "https://api.github.com/users/lilyball/orgs",
      "repos_url": "https://api.github.com/users/lilyball/repos",
      "events_url": "https://api.github.com/users/lilyball/events{/privacy}",
      "received_events_url": "https://api.github.com/users/lilyball/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-05-02T06:39:28Z",
    "updated_at": "2014-05-02T06:39:28Z",
    "body": "@huonw That's my assumption. I'm (obviously) still in favor of #13351, because I think the algorithm is easier to reason about (and of course it uses correct memory orderings so the slow path is faster, if that makes a difference).\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/41995663/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/42050872",
    "html_url": "https://github.com/rust-lang/rust/pull/13349#issuecomment-42050872",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/13349",
    "id": 42050872,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQyMDUwODcy",
    "user": {
      "login": "alexcrichton",
      "id": 64996,
      "node_id": "MDQ6VXNlcjY0OTk2",
      "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alexcrichton",
      "html_url": "https://github.com/alexcrichton",
      "followers_url": "https://api.github.com/users/alexcrichton/followers",
      "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}",
      "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions",
      "organizations_url": "https://api.github.com/users/alexcrichton/orgs",
      "repos_url": "https://api.github.com/users/alexcrichton/repos",
      "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alexcrichton/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-05-02T16:32:08Z",
    "updated_at": "2014-05-02T16:32:08Z",
    "body": "I suppose I mentioned this on #13351, but not this one, but I have yet to be convinced that the `foo` and `foo_slow` functions are necessary.\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/42050872/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/42051225",
    "html_url": "https://github.com/rust-lang/rust/pull/13349#issuecomment-42051225",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/13349",
    "id": 42051225,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQyMDUxMjI1",
    "user": {
      "login": "stepancheg",
      "id": 28969,
      "node_id": "MDQ6VXNlcjI4OTY5",
      "avatar_url": "https://avatars.githubusercontent.com/u/28969?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/stepancheg",
      "html_url": "https://github.com/stepancheg",
      "followers_url": "https://api.github.com/users/stepancheg/followers",
      "following_url": "https://api.github.com/users/stepancheg/following{/other_user}",
      "gists_url": "https://api.github.com/users/stepancheg/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/stepancheg/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/stepancheg/subscriptions",
      "organizations_url": "https://api.github.com/users/stepancheg/orgs",
      "repos_url": "https://api.github.com/users/stepancheg/repos",
      "events_url": "https://api.github.com/users/stepancheg/events{/privacy}",
      "received_events_url": "https://api.github.com/users/stepancheg/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-05-02T16:35:09Z",
    "updated_at": "2014-05-02T16:35:09Z",
    "body": "@alexcrichton `doit_slow` is needed to avoid marking whole `doit` as `#[inline]`.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/42051225/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/42051342",
    "html_url": "https://github.com/rust-lang/rust/pull/13349#issuecomment-42051342",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/13349",
    "id": 42051342,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQyMDUxMzQy",
    "user": {
      "login": "alexcrichton",
      "id": 64996,
      "node_id": "MDQ6VXNlcjY0OTk2",
      "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alexcrichton",
      "html_url": "https://github.com/alexcrichton",
      "followers_url": "https://api.github.com/users/alexcrichton/followers",
      "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}",
      "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions",
      "organizations_url": "https://api.github.com/users/alexcrichton/orgs",
      "repos_url": "https://api.github.com/users/alexcrichton/repos",
      "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alexcrichton/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-05-02T16:36:21Z",
    "updated_at": "2014-05-02T16:36:21Z",
    "body": "I do not disagree that `doit` should be inlined and `doit_slow` should not be inlined. I don't believe that there is sufficient data to start this trend of splitting functions into `foo` and `foo_slow`.\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/42051342/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/42052257",
    "html_url": "https://github.com/rust-lang/rust/pull/13349#issuecomment-42052257",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/13349",
    "id": 42052257,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQyMDUyMjU3",
    "user": {
      "login": "stepancheg",
      "id": 28969,
      "node_id": "MDQ6VXNlcjI4OTY5",
      "avatar_url": "https://avatars.githubusercontent.com/u/28969?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/stepancheg",
      "html_url": "https://github.com/stepancheg",
      "followers_url": "https://api.github.com/users/stepancheg/followers",
      "following_url": "https://api.github.com/users/stepancheg/following{/other_user}",
      "gists_url": "https://api.github.com/users/stepancheg/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/stepancheg/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/stepancheg/subscriptions",
      "organizations_url": "https://api.github.com/users/stepancheg/orgs",
      "repos_url": "https://api.github.com/users/stepancheg/repos",
      "events_url": "https://api.github.com/users/stepancheg/events{/privacy}",
      "received_events_url": "https://api.github.com/users/stepancheg/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-05-02T16:45:15Z",
    "updated_at": "2014-05-02T16:45:15Z",
    "body": "@alexcrichton well, for now I can simplify this patch by merging `doit` and `doit_slow` into one function, and keep common path optimization. `doit` can be split later.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/42052257/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/42052429",
    "html_url": "https://github.com/rust-lang/rust/pull/13349#issuecomment-42052429",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/13349",
    "id": 42052429,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQyMDUyNDI5",
    "user": {
      "login": "lilyball",
      "id": 714,
      "node_id": "MDQ6VXNlcjcxNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/714?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/lilyball",
      "html_url": "https://github.com/lilyball",
      "followers_url": "https://api.github.com/users/lilyball/followers",
      "following_url": "https://api.github.com/users/lilyball/following{/other_user}",
      "gists_url": "https://api.github.com/users/lilyball/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/lilyball/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/lilyball/subscriptions",
      "organizations_url": "https://api.github.com/users/lilyball/orgs",
      "repos_url": "https://api.github.com/users/lilyball/repos",
      "events_url": "https://api.github.com/users/lilyball/events{/privacy}",
      "received_events_url": "https://api.github.com/users/lilyball/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-05-02T16:46:45Z",
    "updated_at": "2014-05-02T16:46:45Z",
    "body": "What is the downside of keeping `doit` and `doit_slow` separate? The code has already been written.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/42052429/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/42052657",
    "html_url": "https://github.com/rust-lang/rust/pull/13349#issuecomment-42052657",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/13349",
    "id": 42052657,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQyMDUyNjU3",
    "user": {
      "login": "alexcrichton",
      "id": 64996,
      "node_id": "MDQ6VXNlcjY0OTk2",
      "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alexcrichton",
      "html_url": "https://github.com/alexcrichton",
      "followers_url": "https://api.github.com/users/alexcrichton/followers",
      "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}",
      "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions",
      "organizations_url": "https://api.github.com/users/alexcrichton/orgs",
      "repos_url": "https://api.github.com/users/alexcrichton/repos",
      "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alexcrichton/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-05-02T16:49:03Z",
    "updated_at": "2014-05-02T16:49:03Z",
    "body": "I view it as a premature optimization which hinders understanding what's going on. As I mentioned on the other PR, the optimization applies to many situations, none of which are doing this today.\n\nAdditionally, I don't remember seeing concrete data which shows definitively that a split version is better than a unified version.\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/42052657/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/42890606",
    "html_url": "https://github.com/rust-lang/rust/pull/13349#issuecomment-42890606",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/13349",
    "id": 42890606,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQyODkwNjA2",
    "user": {
      "login": "alexcrichton",
      "id": 64996,
      "node_id": "MDQ6VXNlcjY0OTk2",
      "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alexcrichton",
      "html_url": "https://github.com/alexcrichton",
      "followers_url": "https://api.github.com/users/alexcrichton/followers",
      "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}",
      "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions",
      "organizations_url": "https://api.github.com/users/alexcrichton/orgs",
      "repos_url": "https://api.github.com/users/alexcrichton/repos",
      "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alexcrichton/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-05-12T21:27:00Z",
    "updated_at": "2014-05-12T21:27:00Z",
    "body": "Closing due to inactivity, but feel free to reopen with the unification of `doit` and `doit_slot` back into one method.\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/42890606/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/42892908",
    "html_url": "https://github.com/rust-lang/rust/pull/13349#issuecomment-42892908",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/13349",
    "id": 42892908,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQyODkyOTA4",
    "user": {
      "login": "lilyball",
      "id": 714,
      "node_id": "MDQ6VXNlcjcxNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/714?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/lilyball",
      "html_url": "https://github.com/lilyball",
      "followers_url": "https://api.github.com/users/lilyball/followers",
      "following_url": "https://api.github.com/users/lilyball/following{/other_user}",
      "gists_url": "https://api.github.com/users/lilyball/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/lilyball/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/lilyball/subscriptions",
      "organizations_url": "https://api.github.com/users/lilyball/orgs",
      "repos_url": "https://api.github.com/users/lilyball/repos",
      "events_url": "https://api.github.com/users/lilyball/events{/privacy}",
      "received_events_url": "https://api.github.com/users/lilyball/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-05-12T21:49:14Z",
    "updated_at": "2014-05-12T23:31:16Z",
    "body": "@alexcrichton I just tested, and the split actually helps. Specifically, in my bench harness, if I call `once.doit()` twice (as in, two separate calls in code), with the split both calls are inlined and the non-contested case takes 0.5ns. But without the split, the calls aren't inlined and it takes 3ns intead. Without the split a single call to `once.doit()` also inlines, but it's a shame that adding a second call will suddenly make the first less efficient.\n\nI'm willing to resubmit my own version (#13351) without the split, but it seems like a flagrantly unnecessary 6x slowdown for no upside that I can see (you like to claim that it's more readable without the split, but that's entirely subjective and I do not agree).\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/42892908/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/42903154",
    "html_url": "https://github.com/rust-lang/rust/pull/13349#issuecomment-42903154",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/13349",
    "id": 42903154,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQyOTAzMTU0",
    "user": {
      "login": "alexcrichton",
      "id": 64996,
      "node_id": "MDQ6VXNlcjY0OTk2",
      "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alexcrichton",
      "html_url": "https://github.com/alexcrichton",
      "followers_url": "https://api.github.com/users/alexcrichton/followers",
      "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}",
      "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions",
      "organizations_url": "https://api.github.com/users/alexcrichton/orgs",
      "repos_url": "https://api.github.com/users/alexcrichton/repos",
      "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alexcrichton/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-05-12T23:58:09Z",
    "updated_at": "2014-05-12T23:58:09Z",
    "body": "On my machine, a call+ret instruction takes about 2ns. If you're invoking this in a tight loop, then it may make sense to split the two, but this is not the kind of function used in a tight loop. Let's keep it as one function.\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/42903154/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/42903273",
    "html_url": "https://github.com/rust-lang/rust/pull/13349#issuecomment-42903273",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/13349",
    "id": 42903273,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQyOTAzMjcz",
    "user": {
      "login": "lilyball",
      "id": 714,
      "node_id": "MDQ6VXNlcjcxNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/714?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/lilyball",
      "html_url": "https://github.com/lilyball",
      "followers_url": "https://api.github.com/users/lilyball/followers",
      "following_url": "https://api.github.com/users/lilyball/following{/other_user}",
      "gists_url": "https://api.github.com/users/lilyball/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/lilyball/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/lilyball/subscriptions",
      "organizations_url": "https://api.github.com/users/lilyball/orgs",
      "repos_url": "https://api.github.com/users/lilyball/repos",
      "events_url": "https://api.github.com/users/lilyball/events{/privacy}",
      "received_events_url": "https://api.github.com/users/lilyball/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-05-13T00:00:06Z",
    "updated_at": "2014-05-13T00:00:06Z",
    "body": "@alexcrichton No, but it's the kind of instruction that should be able to be used indiscriminately in other methods, and those methods may be called in a tight loop.\n\nI still don't understand why you want to keep it joined, though. You haven't provided any rationale at all aside from what amounts to 100% subjective personal preference.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/42903273/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/42903448",
    "html_url": "https://github.com/rust-lang/rust/pull/13349#issuecomment-42903448",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/13349",
    "id": 42903448,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQyOTAzNDQ4",
    "user": {
      "login": "lilyball",
      "id": 714,
      "node_id": "MDQ6VXNlcjcxNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/714?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/lilyball",
      "html_url": "https://github.com/lilyball",
      "followers_url": "https://api.github.com/users/lilyball/followers",
      "following_url": "https://api.github.com/users/lilyball/following{/other_user}",
      "gists_url": "https://api.github.com/users/lilyball/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/lilyball/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/lilyball/subscriptions",
      "organizations_url": "https://api.github.com/users/lilyball/orgs",
      "repos_url": "https://api.github.com/users/lilyball/repos",
      "events_url": "https://api.github.com/users/lilyball/events{/privacy}",
      "received_events_url": "https://api.github.com/users/lilyball/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-05-13T00:02:56Z",
    "updated_at": "2014-05-13T00:03:05Z",
    "body": "The entire purpose of `Once::doit()` is to be as low-overhead as possible. If overhead doesn't matter, then I may as well just use a `Mutex` + `bool`. Given that, it seems preposterous to intentionally take a 6x slowdown in the fastpath with no objective upside. And when talking about subjective upside, I actually think the `doit_slow` version is _more_ readable, because it makes it obvious that this is expected to be the slow path.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/42903448/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/42928123",
    "html_url": "https://github.com/rust-lang/rust/pull/13349#issuecomment-42928123",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/13349",
    "id": 42928123,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQyOTI4MTIz",
    "user": {
      "login": "stepancheg",
      "id": 28969,
      "node_id": "MDQ6VXNlcjI4OTY5",
      "avatar_url": "https://avatars.githubusercontent.com/u/28969?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/stepancheg",
      "html_url": "https://github.com/stepancheg",
      "followers_url": "https://api.github.com/users/stepancheg/followers",
      "following_url": "https://api.github.com/users/stepancheg/following{/other_user}",
      "gists_url": "https://api.github.com/users/stepancheg/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/stepancheg/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/stepancheg/subscriptions",
      "organizations_url": "https://api.github.com/users/stepancheg/orgs",
      "repos_url": "https://api.github.com/users/stepancheg/repos",
      "events_url": "https://api.github.com/users/stepancheg/events{/privacy}",
      "received_events_url": "https://api.github.com/users/stepancheg/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-05-13T08:09:43Z",
    "updated_at": "2014-05-13T08:09:43Z",
    "body": "@alexcrichton I was sure that it is exactly a function to be used in a tight loop. I use it in scenario like this:\n\n```\nstruct Foo { ... }\nstruct Bar { foo: Option<Foo> }\n\nimpl Bar {\n    // this function may be called frequently\n    fn get_foo<'a>(&'a self) -> &'a Foo {\n        if (foo.is_some()) {\n            foo.get_ref()\n        } else {\n            static mut foo_default_instance: *Foo = 0 as ...;\n            static once = ...\n            once.doit(initialize foo_default_instance);\n            cast::transmute(foo_default_instance)\n        }\n    }\n}\n```\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/42928123/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/42990970",
    "html_url": "https://github.com/rust-lang/rust/pull/13349#issuecomment-42990970",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/13349",
    "id": 42990970,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQyOTkwOTcw",
    "user": {
      "login": "lilyball",
      "id": 714,
      "node_id": "MDQ6VXNlcjcxNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/714?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/lilyball",
      "html_url": "https://github.com/lilyball",
      "followers_url": "https://api.github.com/users/lilyball/followers",
      "following_url": "https://api.github.com/users/lilyball/following{/other_user}",
      "gists_url": "https://api.github.com/users/lilyball/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/lilyball/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/lilyball/subscriptions",
      "organizations_url": "https://api.github.com/users/lilyball/orgs",
      "repos_url": "https://api.github.com/users/lilyball/repos",
      "events_url": "https://api.github.com/users/lilyball/events{/privacy}",
      "received_events_url": "https://api.github.com/users/lilyball/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-05-13T18:08:28Z",
    "updated_at": "2014-05-13T18:08:28Z",
    "body": "@alexcrichton Here's a perfect example of needing `Once` in a tight loop. I just tested and calling `mach_timebase_info()` takes about 131ns/iter on my machine. I'd like to tweak libtime to use `Once` to only call it once (because the timebase never changes). This would happen in `precise_time_ns()`. `precise_time_ns()` is something I can easily see being called multiple times in a loop, if you have any need to time only portions of your loop (e.g. you have  setup and a teardown that should be ignored from your benchmark).\n\nNot only that, but even if you're not calling it in a loop, `precise_time_ns()` should avoid any unnecessary overhead. Without the split I can take the `mach_timebase_info` overhead from 131ns down to 3ns (after the first call, of course), but I'd rather take it down to 0.5ns.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/42990970/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
