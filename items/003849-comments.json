[
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/9754264",
    "html_url": "https://github.com/rust-lang/rust/issues/3849#issuecomment-9754264",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/3849",
    "id": 9754264,
    "node_id": "MDEyOklzc3VlQ29tbWVudDk3NTQyNjQ=",
    "user": {
      "login": "nikomatsakis",
      "id": 155238,
      "node_id": "MDQ6VXNlcjE1NTIzOA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/155238?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nikomatsakis",
      "html_url": "https://github.com/nikomatsakis",
      "followers_url": "https://api.github.com/users/nikomatsakis/followers",
      "following_url": "https://api.github.com/users/nikomatsakis/following{/other_user}",
      "gists_url": "https://api.github.com/users/nikomatsakis/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nikomatsakis/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nikomatsakis/subscriptions",
      "organizations_url": "https://api.github.com/users/nikomatsakis/orgs",
      "repos_url": "https://api.github.com/users/nikomatsakis/repos",
      "events_url": "https://api.github.com/users/nikomatsakis/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nikomatsakis/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2012-10-24T20:03:48Z",
    "updated_at": "2012-10-24T20:03:48Z",
    "body": "This would be quite complex.  It's unlikely to happen purely automatically.  However, we could perhaps add a method like `borrow_all()`---it'd be interesting to see if we can push traits far enough to make this work for things like `~str`, `@str`, `~[]` and so forth.  Should be possible though it might take some improvement to our type inference.\n\nIncidentally, @pcwalton has made the case to remove borrowing for function arguments altogether.  I am not sure how I feel about it.  On the one hand, I do prefer to err on the side of less magic.  And borrowing and inference have the potential for surprising failures (though they seem to occur rarely in practice).  On the other hand, it'll mean strictly more sigils than we have now (i.e., to convert an `@T` to `&T` would be `&*x`), and I fear it will discourage the use of `&T`.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/9754264/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/9796622",
    "html_url": "https://github.com/rust-lang/rust/issues/3849#issuecomment-9796622",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/3849",
    "id": 9796622,
    "node_id": "MDEyOklzc3VlQ29tbWVudDk3OTY2MjI=",
    "user": {
      "login": "bblum",
      "id": 1820515,
      "node_id": "MDQ6VXNlcjE4MjA1MTU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1820515?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/bblum",
      "html_url": "https://github.com/bblum",
      "followers_url": "https://api.github.com/users/bblum/followers",
      "following_url": "https://api.github.com/users/bblum/following{/other_user}",
      "gists_url": "https://api.github.com/users/bblum/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/bblum/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/bblum/subscriptions",
      "organizations_url": "https://api.github.com/users/bblum/orgs",
      "repos_url": "https://api.github.com/users/bblum/repos",
      "events_url": "https://api.github.com/users/bblum/events{/privacy}",
      "received_events_url": "https://api.github.com/users/bblum/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2012-10-25T22:25:34Z",
    "updated_at": "2012-10-25T22:25:34Z",
    "body": "It couldn't happen automatically without special-case runtime support -- borrowing a ~ or @ into a & actually changes the value of the pointer (the &T skips past the refcount header). Borrowing the entire vector would have to mutate the contents of the whole vector.\n\nIt's a shame that using a function like \"borrow_all\" would require memory allocation, though.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/9796622/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/12120169",
    "html_url": "https://github.com/rust-lang/rust/issues/3849#issuecomment-12120169",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/3849",
    "id": 12120169,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEyMTIwMTY5",
    "user": {
      "login": "catamorphism",
      "id": 427212,
      "node_id": "MDQ6VXNlcjQyNzIxMg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/427212?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/catamorphism",
      "html_url": "https://github.com/catamorphism",
      "followers_url": "https://api.github.com/users/catamorphism/followers",
      "following_url": "https://api.github.com/users/catamorphism/following{/other_user}",
      "gists_url": "https://api.github.com/users/catamorphism/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/catamorphism/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/catamorphism/subscriptions",
      "organizations_url": "https://api.github.com/users/catamorphism/orgs",
      "repos_url": "https://api.github.com/users/catamorphism/repos",
      "events_url": "https://api.github.com/users/catamorphism/events{/privacy}",
      "received_events_url": "https://api.github.com/users/catamorphism/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2013-01-10T21:39:31Z",
    "updated_at": "2013-01-10T21:39:31Z",
    "body": "Since this is 3 months old and there wasn't much enthusiasm, I'm closing.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/12120169/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/12169778",
    "html_url": "https://github.com/rust-lang/rust/issues/3849#issuecomment-12169778",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/3849",
    "id": 12169778,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEyMTY5Nzc4",
    "user": {
      "login": "jruderman",
      "id": 692547,
      "node_id": "MDQ6VXNlcjY5MjU0Nw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/692547?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jruderman",
      "html_url": "https://github.com/jruderman",
      "followers_url": "https://api.github.com/users/jruderman/followers",
      "following_url": "https://api.github.com/users/jruderman/following{/other_user}",
      "gists_url": "https://api.github.com/users/jruderman/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jruderman/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jruderman/subscriptions",
      "organizations_url": "https://api.github.com/users/jruderman/orgs",
      "repos_url": "https://api.github.com/users/jruderman/repos",
      "events_url": "https://api.github.com/users/jruderman/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jruderman/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2013-01-12T00:12:41Z",
    "updated_at": "2013-01-12T00:12:41Z",
    "body": "Could we change the representation of @ and ~ so that borrowing it doesn't require changing its value?  (Subtract to reach the header, rather than add to reach the interior)\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/12169778/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/12177978",
    "html_url": "https://github.com/rust-lang/rust/issues/3849#issuecomment-12177978",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/3849",
    "id": 12177978,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEyMTc3OTc4",
    "user": {
      "login": "nikomatsakis",
      "id": 155238,
      "node_id": "MDQ6VXNlcjE1NTIzOA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/155238?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nikomatsakis",
      "html_url": "https://github.com/nikomatsakis",
      "followers_url": "https://api.github.com/users/nikomatsakis/followers",
      "following_url": "https://api.github.com/users/nikomatsakis/following{/other_user}",
      "gists_url": "https://api.github.com/users/nikomatsakis/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nikomatsakis/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nikomatsakis/subscriptions",
      "organizations_url": "https://api.github.com/users/nikomatsakis/orgs",
      "repos_url": "https://api.github.com/users/nikomatsakis/repos",
      "events_url": "https://api.github.com/users/nikomatsakis/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nikomatsakis/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2013-01-12T13:20:07Z",
    "updated_at": "2013-01-12T13:20:07Z",
    "body": "> Could we change the representation of @ and ~ so that borrowing it\n> doesn't require changing its value? (Subtract to reach the header,\n> rather than add to reach the interior)\n\nYes, I've thought about that from time to time. The only downside I can \nsee is that, if we ever manage to shrink the size of the header, it \nmight require more memory in order to ensure that the payload is always \nlocated at an appropriate alignment (particularly if we care about \nvector instructions like AVE2, which I believe can require up to 32-byte \nalignment). The reason is that the header would have to be located at a \nfixed offset from the payload since sometimes we don't know the type of \nthe payload, and we must load the header to determine that.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/12177978/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/12184423",
    "html_url": "https://github.com/rust-lang/rust/issues/3849#issuecomment-12184423",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/3849",
    "id": 12184423,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEyMTg0NDIz",
    "user": {
      "login": "jruderman",
      "id": 692547,
      "node_id": "MDQ6VXNlcjY5MjU0Nw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/692547?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jruderman",
      "html_url": "https://github.com/jruderman",
      "followers_url": "https://api.github.com/users/jruderman/followers",
      "following_url": "https://api.github.com/users/jruderman/following{/other_user}",
      "gists_url": "https://api.github.com/users/jruderman/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jruderman/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jruderman/subscriptions",
      "organizations_url": "https://api.github.com/users/jruderman/orgs",
      "repos_url": "https://api.github.com/users/jruderman/repos",
      "events_url": "https://api.github.com/users/jruderman/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jruderman/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2013-01-12T21:03:37Z",
    "updated_at": "2013-01-12T21:03:37Z",
    "body": "I don't see the connection between pointer representation (pointing at payload vs header) and payload alignment.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/12184423/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/12305458",
    "html_url": "https://github.com/rust-lang/rust/issues/3849#issuecomment-12305458",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/3849",
    "id": 12305458,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEyMzA1NDU4",
    "user": {
      "login": "nikomatsakis",
      "id": 155238,
      "node_id": "MDQ6VXNlcjE1NTIzOA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/155238?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nikomatsakis",
      "html_url": "https://github.com/nikomatsakis",
      "followers_url": "https://api.github.com/users/nikomatsakis/followers",
      "following_url": "https://api.github.com/users/nikomatsakis/following{/other_user}",
      "gists_url": "https://api.github.com/users/nikomatsakis/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nikomatsakis/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nikomatsakis/subscriptions",
      "organizations_url": "https://api.github.com/users/nikomatsakis/orgs",
      "repos_url": "https://api.github.com/users/nikomatsakis/repos",
      "events_url": "https://api.github.com/users/nikomatsakis/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nikomatsakis/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2013-01-16T05:25:06Z",
    "updated_at": "2013-01-16T13:36:38Z",
    "body": "So, imagine we had a one word header (I wish...) and a one character payload.  In that event, today, we could build a tightly packed struct like `struct BoxChar { void *header; char payload; }`.  If on the other hand the payload were 32-byte aligned, we would have `struct BoxChar { void *header; /*padding*/ vector payload; }`.  Basically we can insert padding as needed.\n\nBut if the pointer is always at the payload, then we have to be able to find the header at a fixed negative offset, because sometimes we don't know the type of the payload and so we need to consult the header to figure it out.  This means we'd have to always pad to the maximum supported alignment, regardless of the payload type.\n\nI'm not sure how big a problem this is in practice.  It's just the only complication I could think of.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/12305458/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/12305962",
    "html_url": "https://github.com/rust-lang/rust/issues/3849#issuecomment-12305962",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/3849",
    "id": 12305962,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEyMzA1OTYy",
    "user": {
      "login": "bblum",
      "id": 1820515,
      "node_id": "MDQ6VXNlcjE4MjA1MTU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1820515?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/bblum",
      "html_url": "https://github.com/bblum",
      "followers_url": "https://api.github.com/users/bblum/followers",
      "following_url": "https://api.github.com/users/bblum/following{/other_user}",
      "gists_url": "https://api.github.com/users/bblum/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/bblum/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/bblum/subscriptions",
      "organizations_url": "https://api.github.com/users/bblum/orgs",
      "repos_url": "https://api.github.com/users/bblum/repos",
      "events_url": "https://api.github.com/users/bblum/events{/privacy}",
      "received_events_url": "https://api.github.com/users/bblum/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2013-01-16T05:56:45Z",
    "updated_at": "2013-01-16T05:56:45Z",
    "body": "the BoxChar children\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/12305962/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
