[
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/38083274",
    "html_url": "https://github.com/rust-lang/rust/issues/13018#issuecomment-38083274",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/13018",
    "id": 38083274,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM4MDgzMjc0",
    "user": {
      "login": "alexcrichton",
      "id": 64996,
      "node_id": "MDQ6VXNlcjY0OTk2",
      "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alexcrichton",
      "html_url": "https://github.com/alexcrichton",
      "followers_url": "https://api.github.com/users/alexcrichton/followers",
      "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}",
      "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions",
      "organizations_url": "https://api.github.com/users/alexcrichton/orgs",
      "repos_url": "https://api.github.com/users/alexcrichton/repos",
      "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alexcrichton/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-03-19T17:42:18Z",
    "updated_at": "2014-03-19T17:42:18Z",
    "body": "I think that this is partly because LLVM doesn't understand that `&Rc<int>` will never alias `*RcBox<int>`, so this may just be a \"implement TBAA\" bug\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/38083274/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/38099532",
    "html_url": "https://github.com/rust-lang/rust/issues/13018#issuecomment-38099532",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/13018",
    "id": 38099532,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM4MDk5NTMy",
    "user": {
      "login": "thestinger",
      "id": 1505226,
      "node_id": "MDQ6VXNlcjE1MDUyMjY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1505226?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/thestinger",
      "html_url": "https://github.com/thestinger",
      "followers_url": "https://api.github.com/users/thestinger/followers",
      "following_url": "https://api.github.com/users/thestinger/following{/other_user}",
      "gists_url": "https://api.github.com/users/thestinger/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/thestinger/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/thestinger/subscriptions",
      "organizations_url": "https://api.github.com/users/thestinger/orgs",
      "repos_url": "https://api.github.com/users/thestinger/repos",
      "events_url": "https://api.github.com/users/thestinger/events{/privacy}",
      "received_events_url": "https://api.github.com/users/thestinger/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-03-19T20:00:02Z",
    "updated_at": "2014-03-19T20:00:02Z",
    "body": "The situation is improved with the parameter marked as `noalias`, but it still doesn't optimize out.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/38099532/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/49529839",
    "html_url": "https://github.com/rust-lang/rust/issues/13018#issuecomment-49529839",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/13018",
    "id": 49529839,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ5NTI5ODM5",
    "user": {
      "login": "dotdash",
      "id": 230962,
      "node_id": "MDQ6VXNlcjIzMDk2Mg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/230962?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dotdash",
      "html_url": "https://github.com/dotdash",
      "followers_url": "https://api.github.com/users/dotdash/followers",
      "following_url": "https://api.github.com/users/dotdash/following{/other_user}",
      "gists_url": "https://api.github.com/users/dotdash/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dotdash/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dotdash/subscriptions",
      "organizations_url": "https://api.github.com/users/dotdash/orgs",
      "repos_url": "https://api.github.com/users/dotdash/repos",
      "events_url": "https://api.github.com/users/dotdash/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dotdash/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-07-19T21:19:38Z",
    "updated_at": "2014-07-19T21:19:38Z",
    "body": "With aliasing out of the way, LLVM still can't know that the refcount isn't already 0 when entering the function, so it can't remove the code.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/49529839/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/49532087",
    "html_url": "https://github.com/rust-lang/rust/issues/13018#issuecomment-49532087",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/13018",
    "id": 49532087,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ5NTMyMDg3",
    "user": {
      "login": "thestinger",
      "id": 1505226,
      "node_id": "MDQ6VXNlcjE1MDUyMjY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1505226?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/thestinger",
      "html_url": "https://github.com/thestinger",
      "followers_url": "https://api.github.com/users/thestinger/followers",
      "following_url": "https://api.github.com/users/thestinger/following{/other_user}",
      "gists_url": "https://api.github.com/users/thestinger/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/thestinger/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/thestinger/subscriptions",
      "organizations_url": "https://api.github.com/users/thestinger/orgs",
      "repos_url": "https://api.github.com/users/thestinger/repos",
      "events_url": "https://api.github.com/users/thestinger/events{/privacy}",
      "received_events_url": "https://api.github.com/users/thestinger/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-07-19T23:16:18Z",
    "updated_at": "2014-07-19T23:16:18Z",
    "body": "Maybe an intrinsic for doing a load with a range assertion would work.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/49532087/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/49532869",
    "html_url": "https://github.com/rust-lang/rust/issues/13018#issuecomment-49532869",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/13018",
    "id": 49532869,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ5NTMyODY5",
    "user": {
      "login": "dotdash",
      "id": 230962,
      "node_id": "MDQ6VXNlcjIzMDk2Mg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/230962?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dotdash",
      "html_url": "https://github.com/dotdash",
      "followers_url": "https://api.github.com/users/dotdash/followers",
      "following_url": "https://api.github.com/users/dotdash/following{/other_user}",
      "gists_url": "https://api.github.com/users/dotdash/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dotdash/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dotdash/subscriptions",
      "organizations_url": "https://api.github.com/users/dotdash/orgs",
      "repos_url": "https://api.github.com/users/dotdash/repos",
      "events_url": "https://api.github.com/users/dotdash/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dotdash/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-07-20T00:02:33Z",
    "updated_at": "2014-07-20T00:02:33Z",
    "body": "Range asserts don't help here, they're not used to optimize the icmp away.\nAnd last time I tried to add support for that to LLVM, it affected some\nother optimizations in a bad way. Leading to worse results overall. Maybe I\njust messed up the implementation though\nAm 20.07.2014 01:16 schrieb \"Daniel Micay\" notifications@github.com:\n\n> Maybe an intrinsic for doing a load with a range assertion would work.\n> \n> \u2014\n> Reply to this email directly or view it on GitHub\n> https://github.com/rust-lang/rust/issues/13018#issuecomment-49532087.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/49532869/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/71058130",
    "html_url": "https://github.com/rust-lang/rust/issues/13018#issuecomment-71058130",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/13018",
    "id": 71058130,
    "node_id": "MDEyOklzc3VlQ29tbWVudDcxMDU4MTMw",
    "user": {
      "login": "alexcrichton",
      "id": 64996,
      "node_id": "MDQ6VXNlcjY0OTk2",
      "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alexcrichton",
      "html_url": "https://github.com/alexcrichton",
      "followers_url": "https://api.github.com/users/alexcrichton/followers",
      "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}",
      "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions",
      "organizations_url": "https://api.github.com/users/alexcrichton/orgs",
      "repos_url": "https://api.github.com/users/alexcrichton/repos",
      "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alexcrichton/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-01-22T17:15:57Z",
    "updated_at": "2015-01-22T17:15:57Z",
    "body": "#21418 didn't actually land :( (had to revert)\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/71058130/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/178697946",
    "html_url": "https://github.com/rust-lang/rust/issues/13018#issuecomment-178697946",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/13018",
    "id": 178697946,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE3ODY5Nzk0Ng==",
    "user": {
      "login": "steveklabnik",
      "id": 27786,
      "node_id": "MDQ6VXNlcjI3Nzg2",
      "avatar_url": "https://avatars.githubusercontent.com/u/27786?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/steveklabnik",
      "html_url": "https://github.com/steveklabnik",
      "followers_url": "https://api.github.com/users/steveklabnik/followers",
      "following_url": "https://api.github.com/users/steveklabnik/following{/other_user}",
      "gists_url": "https://api.github.com/users/steveklabnik/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/steveklabnik/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/steveklabnik/subscriptions",
      "organizations_url": "https://api.github.com/users/steveklabnik/orgs",
      "repos_url": "https://api.github.com/users/steveklabnik/repos",
      "events_url": "https://api.github.com/users/steveklabnik/events{/privacy}",
      "received_events_url": "https://api.github.com/users/steveklabnik/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2016-02-02T17:21:26Z",
    "updated_at": "2016-02-02T17:21:26Z",
    "body": "Triage: runnable code\n\n```\nuse std::rc::Rc;\n\n#[inline(never)]\nfn foo<T>(t: &Rc<T>) {\n    drop(t.clone());  \n}\n\nfn main() {\n    let r = Rc::new(5);\n\n    foo(&r);\n}\n```\n\nI'm not aware of any improvements in this area, nor am I good enough with LLVM IR to tell if things have changed.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/178697946/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/218364078",
    "html_url": "https://github.com/rust-lang/rust/issues/13018#issuecomment-218364078",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/13018",
    "id": 218364078,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIxODM2NDA3OA==",
    "user": {
      "login": "jruderman",
      "id": 692547,
      "node_id": "MDQ6VXNlcjY5MjU0Nw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/692547?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jruderman",
      "html_url": "https://github.com/jruderman",
      "followers_url": "https://api.github.com/users/jruderman/followers",
      "following_url": "https://api.github.com/users/jruderman/following{/other_user}",
      "gists_url": "https://api.github.com/users/jruderman/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jruderman/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jruderman/subscriptions",
      "organizations_url": "https://api.github.com/users/jruderman/orgs",
      "repos_url": "https://api.github.com/users/jruderman/repos",
      "events_url": "https://api.github.com/users/jruderman/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jruderman/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2016-05-11T05:18:03Z",
    "updated_at": "2016-05-11T05:18:03Z",
    "body": "> LLVM still can't know that the refcount isn't already 0\n\nAdding `assume(self.strong() != 0)` to the top of clone() might fix this. rc.rs already uses `assume` in other places so this wouldn't be unprecedented.\n\nEven with this change, the overflow check in inc_strong might _also_ prevent the optimization. Not sure what to do about that :/\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/218364078/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/218367197",
    "html_url": "https://github.com/rust-lang/rust/issues/13018#issuecomment-218367197",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/13018",
    "id": 218367197,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIxODM2NzE5Nw==",
    "user": {
      "login": "huonw",
      "id": 1203825,
      "node_id": "MDQ6VXNlcjEyMDM4MjU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1203825?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/huonw",
      "html_url": "https://github.com/huonw",
      "followers_url": "https://api.github.com/users/huonw/followers",
      "following_url": "https://api.github.com/users/huonw/following{/other_user}",
      "gists_url": "https://api.github.com/users/huonw/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/huonw/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/huonw/subscriptions",
      "organizations_url": "https://api.github.com/users/huonw/orgs",
      "repos_url": "https://api.github.com/users/huonw/repos",
      "events_url": "https://api.github.com/users/huonw/events{/privacy}",
      "received_events_url": "https://api.github.com/users/huonw/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2016-05-11T05:43:48Z",
    "updated_at": "2016-05-11T05:44:13Z",
    "body": "@jruderman that is similar to what was tried in #21418, but was found to be a serious compilation time hit (https://github.com/rust-lang/rust/pull/21418#issuecomment-70929449). The `assume`s there currently were added in https://github.com/rust-lang/rust/pull/21894.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/218367197/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/239319617",
    "html_url": "https://github.com/rust-lang/rust/issues/13018#issuecomment-239319617",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/13018",
    "id": 239319617,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIzOTMxOTYxNw==",
    "user": {
      "login": "nagisa",
      "id": 679122,
      "node_id": "MDQ6VXNlcjY3OTEyMg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/679122?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nagisa",
      "html_url": "https://github.com/nagisa",
      "followers_url": "https://api.github.com/users/nagisa/followers",
      "following_url": "https://api.github.com/users/nagisa/following{/other_user}",
      "gists_url": "https://api.github.com/users/nagisa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nagisa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nagisa/subscriptions",
      "organizations_url": "https://api.github.com/users/nagisa/orgs",
      "repos_url": "https://api.github.com/users/nagisa/repos",
      "events_url": "https://api.github.com/users/nagisa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nagisa/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2016-08-11T23:04:06Z",
    "updated_at": "2016-08-11T23:04:06Z",
    "body": "> I'm not aware of any improvements in this area, nor am I good enough with LLVM IR to tell if things have changed.\n\nLLVM IR we produce is still as junk as was before, even with MIR.\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/239319617/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/239319974",
    "html_url": "https://github.com/rust-lang/rust/issues/13018#issuecomment-239319974",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/13018",
    "id": 239319974,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIzOTMxOTk3NA==",
    "user": {
      "login": "nagisa",
      "id": 679122,
      "node_id": "MDQ6VXNlcjY3OTEyMg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/679122?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nagisa",
      "html_url": "https://github.com/nagisa",
      "followers_url": "https://api.github.com/users/nagisa/followers",
      "following_url": "https://api.github.com/users/nagisa/following{/other_user}",
      "gists_url": "https://api.github.com/users/nagisa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nagisa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nagisa/subscriptions",
      "organizations_url": "https://api.github.com/users/nagisa/orgs",
      "repos_url": "https://api.github.com/users/nagisa/repos",
      "events_url": "https://api.github.com/users/nagisa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nagisa/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2016-08-11T23:06:05Z",
    "updated_at": "2016-08-11T23:06:05Z",
    "body": "It might sense to attempt reapplying the assume stuff. A year and half has passed since first attempt, so LLVM might be able to handle it this time.\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/239319974/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/271930384",
    "html_url": "https://github.com/rust-lang/rust/issues/13018#issuecomment-271930384",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/13018",
    "id": 271930384,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3MTkzMDM4NA==",
    "user": {
      "login": "wdv4758h",
      "id": 2716047,
      "node_id": "MDQ6VXNlcjI3MTYwNDc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2716047?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/wdv4758h",
      "html_url": "https://github.com/wdv4758h",
      "followers_url": "https://api.github.com/users/wdv4758h/followers",
      "following_url": "https://api.github.com/users/wdv4758h/following{/other_user}",
      "gists_url": "https://api.github.com/users/wdv4758h/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/wdv4758h/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/wdv4758h/subscriptions",
      "organizations_url": "https://api.github.com/users/wdv4758h/orgs",
      "repos_url": "https://api.github.com/users/wdv4758h/repos",
      "events_url": "https://api.github.com/users/wdv4758h/events{/privacy}",
      "received_events_url": "https://api.github.com/users/wdv4758h/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2017-01-11T17:15:11Z",
    "updated_at": "2017-01-11T17:15:11Z",
    "body": "I just notice this issue when I'm reading `Rc`'s code.\r\n\r\nAs @jruderman mentioned, we are using `checked_add` in `inc_strong` now, and the overflow checking is preventing the optimization.\r\nRegardless the performance with the `assume` now, I'm afraid we can't make the original target code no-op.\r\n(and yes, adding the `assume` in original patch won't make it no-op)\r\n\r\nShould we think other solution or close the issue ?",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/271930384/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/377537357",
    "html_url": "https://github.com/rust-lang/rust/issues/13018#issuecomment-377537357",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/13018",
    "id": 377537357,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM3NzUzNzM1Nw==",
    "user": {
      "login": "nox",
      "id": 123095,
      "node_id": "MDQ6VXNlcjEyMzA5NQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/123095?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nox",
      "html_url": "https://github.com/nox",
      "followers_url": "https://api.github.com/users/nox/followers",
      "following_url": "https://api.github.com/users/nox/following{/other_user}",
      "gists_url": "https://api.github.com/users/nox/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nox/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nox/subscriptions",
      "organizations_url": "https://api.github.com/users/nox/orgs",
      "repos_url": "https://api.github.com/users/nox/repos",
      "events_url": "https://api.github.com/users/nox/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nox/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2018-03-30T14:35:53Z",
    "updated_at": "2018-03-30T14:41:53Z",
    "body": "The current LLVM IR for the snippet in the issue description is:\r\n<details><summary><em>Click to expand LLVM IR</em></summary>\r\n\r\n```llvm\r\n; ModuleID = 'playground0-3a317160927575f9dc8b26750a523322.rs'\r\nsource_filename = \"playground0-3a317160927575f9dc8b26750a523322.rs\"\r\ntarget datalayout = \"e-m:e-i64:64-f80:128-n8:16:32:64-S128\"\r\ntarget triple = \"x86_64-unknown-linux-gnu\"\r\n\r\n%\"unwind::libunwind::_Unwind_Exception\" = type { [0 x i64], i64, [0 x i64], void (i32, %\"unwind::libunwind::_Unwind_Exception\"*)*, [0 x i64], [6 x i64], [0 x i64] }\r\n%\"unwind::libunwind::_Unwind_Context\" = type { [0 x i8] }\r\n\r\n; Function Attrs: uwtable\r\ndefine void @foo(i64** noalias nocapture readonly dereferenceable(8) %t) unnamed_addr #0 personality i32 (i32, i32, i64, %\"unwind::libunwind::_Unwind_Exception\"*, %\"unwind::libunwind::_Unwind_Context\"*)* @rust_eh_personality {\r\nstart:\r\n  %t.val = load i64*, i64** %t, align 8\r\n  %.val.i.i.i = load i64, i64* %t.val, align 8\r\n  %0 = tail call { i64, i1 } @llvm.uadd.with.overflow.i64(i64 %.val.i.i.i, i64 1) #5\r\n  %1 = extractvalue { i64, i1 } %0, 1\r\n  br i1 %1, label %bb2.i.i.i, label %\"_ZN61_$LT$alloc..rc..Rc$LT$T$GT$$u20$as$u20$core..clone..Clone$GT$5clone17h127f785fcc974269E.exit\"\r\n\r\nbb2.i.i.i:                                        ; preds = %start\r\n  tail call void @llvm.trap() #5\r\n  unreachable\r\n\r\n\"_ZN61_$LT$alloc..rc..Rc$LT$T$GT$$u20$as$u20$core..clone..Clone$GT$5clone17h127f785fcc974269E.exit\": ; preds = %start\r\n  %2 = extractvalue { i64, i1 } %0, 0\r\n  %3 = add i64 %2, -1\r\n  store i64 %3, i64* %t.val, align 1\r\n  %4 = icmp eq i64 %3, 0\r\n  br i1 %4, label %bb4.i.i.i, label %_ZN4core3mem4drop17h222f528d1fa068ceE.exit\r\n\r\nbb4.i.i.i:                                        ; preds = %\"_ZN61_$LT$alloc..rc..Rc$LT$T$GT$$u20$as$u20$core..clone..Clone$GT$5clone17h127f785fcc974269E.exit\"\r\n  %5 = getelementptr inbounds i64, i64* %t.val, i64 1\r\n  %.val.i.i5.i.i.i = load i64, i64* %5, align 8\r\n  %6 = add i64 %.val.i.i5.i.i.i, -1\r\n  store i64 %6, i64* %5, align 1\r\n  %7 = icmp eq i64 %6, 0\r\n  br i1 %7, label %bb9.i.i.i, label %_ZN4core3mem4drop17h222f528d1fa068ceE.exit\r\n\r\nbb9.i.i.i:                                        ; preds = %bb4.i.i.i\r\n  %8 = bitcast i64* %t.val to i8*\r\n  tail call void @__rust_dealloc(i8* nonnull %8, i64 24, i64 8) #5\r\n  br label %_ZN4core3mem4drop17h222f528d1fa068ceE.exit\r\n\r\n_ZN4core3mem4drop17h222f528d1fa068ceE.exit:       ; preds = %\"_ZN61_$LT$alloc..rc..Rc$LT$T$GT$$u20$as$u20$core..clone..Clone$GT$5clone17h127f785fcc974269E.exit\", %bb4.i.i.i, %bb9.i.i.i\r\n  ret void\r\n}\r\n\r\ndeclare i32 @rust_eh_personality(i32, i32, i64, %\"unwind::libunwind::_Unwind_Exception\"*, %\"unwind::libunwind::_Unwind_Context\"*) unnamed_addr #1\r\n\r\n; Function Attrs: nounwind readnone speculatable\r\ndeclare { i64, i1 } @llvm.uadd.with.overflow.i64(i64, i64) #2\r\n\r\n; Function Attrs: noreturn nounwind\r\ndeclare void @llvm.trap() #3\r\n\r\n; Function Attrs: nounwind\r\ndeclare void @__rust_dealloc(i8*, i64, i64) unnamed_addr #4\r\n\r\nattributes #0 = { uwtable \"probe-stack\"=\"__rust_probestack\" }\r\nattributes #1 = { \"probe-stack\"=\"__rust_probestack\" }\r\nattributes #2 = { nounwind readnone speculatable }\r\nattributes #3 = { noreturn nounwind }\r\nattributes #4 = { nounwind \"probe-stack\"=\"__rust_probestack\" }\r\nattributes #5 = { nounwind }\r\n```\r\n</details><br>\r\n\r\n@eddyb said it's an LLVM bug and then walked off in the distance.\r\n\r\nCc @rust-lang/wg-codegen @rust-lang/wg-compiler-performance ",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/377537357/reactions",
      "total_count": 5,
      "+1": 0,
      "-1": 0,
      "laugh": 5,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/377538875",
    "html_url": "https://github.com/rust-lang/rust/issues/13018#issuecomment-377538875",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/13018",
    "id": 377538875,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM3NzUzODg3NQ==",
    "user": {
      "login": "eddyb",
      "id": 77424,
      "node_id": "MDQ6VXNlcjc3NDI0",
      "avatar_url": "https://avatars.githubusercontent.com/u/77424?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/eddyb",
      "html_url": "https://github.com/eddyb",
      "followers_url": "https://api.github.com/users/eddyb/followers",
      "following_url": "https://api.github.com/users/eddyb/following{/other_user}",
      "gists_url": "https://api.github.com/users/eddyb/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/eddyb/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/eddyb/subscriptions",
      "organizations_url": "https://api.github.com/users/eddyb/orgs",
      "repos_url": "https://api.github.com/users/eddyb/repos",
      "events_url": "https://api.github.com/users/eddyb/events{/privacy}",
      "received_events_url": "https://api.github.com/users/eddyb/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2018-03-30T14:43:21Z",
    "updated_at": "2018-03-30T14:43:21Z",
    "body": "Minimal example, which right now adds & subtracts instead of checking & returning the original `x`:\r\n```rust\r\n#![crate_type = \"lib\"]\r\n#[no_mangle]\r\npub fn assert_not_max_usize(x: usize) -> usize {\r\n    x.checked_add(1).unwrap().wrapping_sub(1)\r\n}\r\n```",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/377538875/reactions",
      "total_count": 1,
      "+1": 0,
      "-1": 0,
      "laugh": 1,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/408641133",
    "html_url": "https://github.com/rust-lang/rust/issues/13018#issuecomment-408641133",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/13018",
    "id": 408641133,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQwODY0MTEzMw==",
    "user": {
      "login": "Mark-Simulacrum",
      "id": 5047365,
      "node_id": "MDQ6VXNlcjUwNDczNjU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5047365?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Mark-Simulacrum",
      "html_url": "https://github.com/Mark-Simulacrum",
      "followers_url": "https://api.github.com/users/Mark-Simulacrum/followers",
      "following_url": "https://api.github.com/users/Mark-Simulacrum/following{/other_user}",
      "gists_url": "https://api.github.com/users/Mark-Simulacrum/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Mark-Simulacrum/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Mark-Simulacrum/subscriptions",
      "organizations_url": "https://api.github.com/users/Mark-Simulacrum/orgs",
      "repos_url": "https://api.github.com/users/Mark-Simulacrum/repos",
      "events_url": "https://api.github.com/users/Mark-Simulacrum/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Mark-Simulacrum/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2018-07-28T23:24:24Z",
    "updated_at": "2018-07-28T23:24:24Z",
    "body": "It's unclear to me that any optimizing compiler can remove the increment/decrement in this case -- we've specified that if the reference count overflows, we expect the program to abort (panic in eddyb's minimal example). LLVM cannot remove that; it would change the program's behavior. As such, it's not clear to me that this issue can ever be fixed, so I'm going to close it. ",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/408641133/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/408641242",
    "html_url": "https://github.com/rust-lang/rust/issues/13018#issuecomment-408641242",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/13018",
    "id": 408641242,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQwODY0MTI0Mg==",
    "user": {
      "login": "nox",
      "id": 123095,
      "node_id": "MDQ6VXNlcjEyMzA5NQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/123095?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nox",
      "html_url": "https://github.com/nox",
      "followers_url": "https://api.github.com/users/nox/followers",
      "following_url": "https://api.github.com/users/nox/following{/other_user}",
      "gists_url": "https://api.github.com/users/nox/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nox/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nox/subscriptions",
      "organizations_url": "https://api.github.com/users/nox/orgs",
      "repos_url": "https://api.github.com/users/nox/repos",
      "events_url": "https://api.github.com/users/nox/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nox/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2018-07-28T23:27:39Z",
    "updated_at": "2018-07-28T23:27:39Z",
    "body": "I don't think this issue should be closed, as shown in https://github.com/rust-lang/rust/issues/13018#issuecomment-377538875 this is not about changing the program behaviour but about making the compiler check whether the value is the maximum value instead of doing the increment-decrement dance.",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/408641242/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/408641420",
    "html_url": "https://github.com/rust-lang/rust/issues/13018#issuecomment-408641420",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/13018",
    "id": 408641420,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQwODY0MTQyMA==",
    "user": {
      "login": "Mark-Simulacrum",
      "id": 5047365,
      "node_id": "MDQ6VXNlcjUwNDczNjU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5047365?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Mark-Simulacrum",
      "html_url": "https://github.com/Mark-Simulacrum",
      "followers_url": "https://api.github.com/users/Mark-Simulacrum/followers",
      "following_url": "https://api.github.com/users/Mark-Simulacrum/following{/other_user}",
      "gists_url": "https://api.github.com/users/Mark-Simulacrum/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Mark-Simulacrum/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Mark-Simulacrum/subscriptions",
      "organizations_url": "https://api.github.com/users/Mark-Simulacrum/orgs",
      "repos_url": "https://api.github.com/users/Mark-Simulacrum/repos",
      "events_url": "https://api.github.com/users/Mark-Simulacrum/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Mark-Simulacrum/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2018-07-28T23:32:26Z",
    "updated_at": "2018-07-28T23:32:26Z",
    "body": "Right, but today that code snippet will panic if passed usize::max_value(); if we somehow make the compiler not do that then we've changed program behavior and fixed this bug. Maybe I'm wrong, but my understanding is that compilers aren't generally allowed to change that type of program behavior.",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/408641420/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/408641617",
    "html_url": "https://github.com/rust-lang/rust/issues/13018#issuecomment-408641617",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/13018",
    "id": 408641617,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQwODY0MTYxNw==",
    "user": {
      "login": "nox",
      "id": 123095,
      "node_id": "MDQ6VXNlcjEyMzA5NQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/123095?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nox",
      "html_url": "https://github.com/nox",
      "followers_url": "https://api.github.com/users/nox/followers",
      "following_url": "https://api.github.com/users/nox/following{/other_user}",
      "gists_url": "https://api.github.com/users/nox/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nox/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nox/subscriptions",
      "organizations_url": "https://api.github.com/users/nox/orgs",
      "repos_url": "https://api.github.com/users/nox/repos",
      "events_url": "https://api.github.com/users/nox/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nox/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2018-07-28T23:36:46Z",
    "updated_at": "2018-07-28T23:36:46Z",
    "body": "The optimisation improvement here is not about making the program not panicking (that would indeed be a behaviour change and thus shouldn't be done), but making it not increment and decrement the actual reference count and instead just panic if it is `usize::max_value()`. See discussion at \r\nhttps://github.com/rust-lang/rust/issues/13018#issuecomment-218364078.",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/408641617/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/408641765",
    "html_url": "https://github.com/rust-lang/rust/issues/13018#issuecomment-408641765",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/13018",
    "id": 408641765,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQwODY0MTc2NQ==",
    "user": {
      "login": "nox",
      "id": 123095,
      "node_id": "MDQ6VXNlcjEyMzA5NQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/123095?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nox",
      "html_url": "https://github.com/nox",
      "followers_url": "https://api.github.com/users/nox/followers",
      "following_url": "https://api.github.com/users/nox/following{/other_user}",
      "gists_url": "https://api.github.com/users/nox/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nox/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nox/subscriptions",
      "organizations_url": "https://api.github.com/users/nox/orgs",
      "repos_url": "https://api.github.com/users/nox/repos",
      "events_url": "https://api.github.com/users/nox/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nox/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2018-07-28T23:40:43Z",
    "updated_at": "2018-07-28T23:40:43Z",
    "body": "To be precise, something in the compiler toolchain could realise that:\r\n\r\n```rust\r\n#![crate_type = \"lib\"]\r\n#[no_mangle]\r\npub fn assert_not_max_usize(x: usize) -> usize {\r\n    x.checked_add(1).unwrap().wrapping_sub(1)\r\n}\r\n```\r\n\r\ncan become:\r\n\r\n```rust\r\n#![crate_type = \"lib\"]\r\n#[no_mangle]\r\npub fn assert_not_max_usize(x: usize) -> usize {\r\n    if x == usize::max_value() {\r\n        None.unwrap();\r\n    }\r\n    x\r\n}\r\n```",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/408641765/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/408642184",
    "html_url": "https://github.com/rust-lang/rust/issues/13018#issuecomment-408642184",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/13018",
    "id": 408642184,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQwODY0MjE4NA==",
    "user": {
      "login": "Mark-Simulacrum",
      "id": 5047365,
      "node_id": "MDQ6VXNlcjUwNDczNjU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5047365?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Mark-Simulacrum",
      "html_url": "https://github.com/Mark-Simulacrum",
      "followers_url": "https://api.github.com/users/Mark-Simulacrum/followers",
      "following_url": "https://api.github.com/users/Mark-Simulacrum/following{/other_user}",
      "gists_url": "https://api.github.com/users/Mark-Simulacrum/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Mark-Simulacrum/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Mark-Simulacrum/subscriptions",
      "organizations_url": "https://api.github.com/users/Mark-Simulacrum/orgs",
      "repos_url": "https://api.github.com/users/Mark-Simulacrum/repos",
      "events_url": "https://api.github.com/users/Mark-Simulacrum/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Mark-Simulacrum/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2018-07-28T23:52:13Z",
    "updated_at": "2018-07-28T23:52:13Z",
    "body": "Hm, okay, so looking at this more it seems that the answer is that LLVM can, we just need to help out a bit; it seems that LLVM can't quite handle the case where the abort is conditional on the add.\r\n\r\nIt almost looks like LLVM doesn't see that the overflow (and hence, abort) only occurs when usize is max_value.\r\n\r\nAnyway, reopening. I think we can switch the code in liballoc to explicitly check before hand and abort; that should help with this if at least the small test cases are accurate.\r\n\r\n```rust\r\npub fn check(x: usize) -> usize {\r\n    if x == usize::max_value() {\r\n        abort();\r\n    }\r\n    x.checked_add(1).unwrap().wrapping_sub(1)\r\n}\r\n```\r\n\r\nproduces\r\n\r\n```asm\r\ncheck:\r\n        push    rax\r\n        cmp     rdi, -1\r\n        je      .LBB0_1\r\n        mov     rax, rdi\r\n        pop     rcx\r\n        ret\r\n.LBB0_1:\r\n        call    std::process::abort@PLT\r\n        ud2\r\n```",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/408642184/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/417874794",
    "html_url": "https://github.com/rust-lang/rust/issues/13018#issuecomment-417874794",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/13018",
    "id": 417874794,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQxNzg3NDc5NA==",
    "user": {
      "login": "GabrielMajeri",
      "id": 3010346,
      "node_id": "MDQ6VXNlcjMwMTAzNDY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3010346?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/GabrielMajeri",
      "html_url": "https://github.com/GabrielMajeri",
      "followers_url": "https://api.github.com/users/GabrielMajeri/followers",
      "following_url": "https://api.github.com/users/GabrielMajeri/following{/other_user}",
      "gists_url": "https://api.github.com/users/GabrielMajeri/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/GabrielMajeri/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/GabrielMajeri/subscriptions",
      "organizations_url": "https://api.github.com/users/GabrielMajeri/orgs",
      "repos_url": "https://api.github.com/users/GabrielMajeri/repos",
      "events_url": "https://api.github.com/users/GabrielMajeri/events{/privacy}",
      "received_events_url": "https://api.github.com/users/GabrielMajeri/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2018-09-01T17:27:06Z",
    "updated_at": "2018-09-01T17:27:06Z",
    "body": "@alexcrichton considering #53080 has been merged, could this issue be closed?",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/417874794/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/417961589",
    "html_url": "https://github.com/rust-lang/rust/issues/13018#issuecomment-417961589",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/13018",
    "id": 417961589,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQxNzk2MTU4OQ==",
    "user": {
      "login": "alexcrichton",
      "id": 64996,
      "node_id": "MDQ6VXNlcjY0OTk2",
      "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alexcrichton",
      "html_url": "https://github.com/alexcrichton",
      "followers_url": "https://api.github.com/users/alexcrichton/followers",
      "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}",
      "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions",
      "organizations_url": "https://api.github.com/users/alexcrichton/orgs",
      "repos_url": "https://api.github.com/users/alexcrichton/repos",
      "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alexcrichton/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2018-09-02T21:37:57Z",
    "updated_at": "2018-09-02T21:37:57Z",
    "body": "Technically this is still an issue in that the above function doesn't optimize to nothing, but practically I think it's \"fixed enough\", so sure!",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/417961589/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
