[
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/57041092",
    "html_url": "https://github.com/rust-lang/rust/pull/17583#issuecomment-57041092",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/17583",
    "id": 57041092,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU3MDQxMDky",
    "user": {
      "login": "rust-highfive",
      "id": 7378925,
      "node_id": "MDQ6VXNlcjczNzg5MjU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7378925?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/rust-highfive",
      "html_url": "https://github.com/rust-highfive",
      "followers_url": "https://api.github.com/users/rust-highfive/followers",
      "following_url": "https://api.github.com/users/rust-highfive/following{/other_user}",
      "gists_url": "https://api.github.com/users/rust-highfive/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/rust-highfive/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/rust-highfive/subscriptions",
      "organizations_url": "https://api.github.com/users/rust-highfive/orgs",
      "repos_url": "https://api.github.com/users/rust-highfive/repos",
      "events_url": "https://api.github.com/users/rust-highfive/events{/privacy}",
      "received_events_url": "https://api.github.com/users/rust-highfive/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-09-27T03:39:31Z",
    "updated_at": "2014-09-27T03:39:31Z",
    "body": "<img src=\"http://www.joshmatthews.net/warning.svg\" alt=\"warning\" height=20> **Warning** <img src=\"http://www.joshmatthews.net/warning.svg\" alt=\"warning\" height=20>\n- These commits modify **unsafe code**. Please review it carefully!\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/57041092/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/57041146",
    "html_url": "https://github.com/rust-lang/rust/pull/17583#issuecomment-57041146",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/17583",
    "id": 57041146,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU3MDQxMTQ2",
    "user": {
      "login": "thestinger",
      "id": 1505226,
      "node_id": "MDQ6VXNlcjE1MDUyMjY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1505226?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/thestinger",
      "html_url": "https://github.com/thestinger",
      "followers_url": "https://api.github.com/users/thestinger/followers",
      "following_url": "https://api.github.com/users/thestinger/following{/other_user}",
      "gists_url": "https://api.github.com/users/thestinger/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/thestinger/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/thestinger/subscriptions",
      "organizations_url": "https://api.github.com/users/thestinger/orgs",
      "repos_url": "https://api.github.com/users/thestinger/repos",
      "events_url": "https://api.github.com/users/thestinger/events{/privacy}",
      "received_events_url": "https://api.github.com/users/thestinger/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-09-27T03:42:18Z",
    "updated_at": "2014-09-27T03:42:18Z",
    "body": "cc @aturon, @alexcrichton, @brson\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/57041146/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/57041183",
    "html_url": "https://github.com/rust-lang/rust/pull/17583#issuecomment-57041183",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/17583",
    "id": 57041183,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU3MDQxMTgz",
    "user": {
      "login": "thestinger",
      "id": 1505226,
      "node_id": "MDQ6VXNlcjE1MDUyMjY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1505226?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/thestinger",
      "html_url": "https://github.com/thestinger",
      "followers_url": "https://api.github.com/users/thestinger/followers",
      "following_url": "https://api.github.com/users/thestinger/following{/other_user}",
      "gists_url": "https://api.github.com/users/thestinger/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/thestinger/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/thestinger/subscriptions",
      "organizations_url": "https://api.github.com/users/thestinger/orgs",
      "repos_url": "https://api.github.com/users/thestinger/repos",
      "events_url": "https://api.github.com/users/thestinger/events{/privacy}",
      "received_events_url": "https://api.github.com/users/thestinger/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-09-27T03:43:58Z",
    "updated_at": "2014-09-27T03:46:41Z",
    "body": "I do have a working implementation of destructors for _recent_ Linux and OS X platforms, but I've left it out for now because I haven't written a slow fallback implementation or a way to deal with differences between platform versions via `cfg`. It looks like this at the moment:\n\n``` rust\n            #[cfg(target_os = \"macos\")]\n            extern {\n                fn _tlv_atexit(dtor: unsafe extern \"C\" fn(ptr: *mut c_void), ptr: *mut c_void);\n            }\n\n            #[cfg(target_os = \"linux\")]\n            extern {\n                static mut __dso_handle: i8;\n                fn __cxa_thread_atexit_impl(dtor: unsafe extern \"C\" fn(ptr: *mut c_void), ptr: *mut c_void,\n                                            dso_symbol: *mut i8);\n            }\n\n            #[thread_local]\n            pub static mut PTR: *mut $t = 0 as *mut $t;\n\n            unsafe extern \"C\" fn destructor(ptr: *mut c_void) {\n                ::std::ptr::read(ptr as *const $t);\n            }\n\n            #[inline(always)]\n            #[cfg(not(target_os = \"macos\"), not(target_os = \"linux\"))]\n            unsafe fn register_destructor() {\n                ::std::intrinsics::abort(); // TODO: not yet implemented\n            }\n\n            #[cfg(target_os = \"linux\")]\n            unsafe fn register_destructor() {\n                __cxa_thread_atexit_impl(destructor, PTR as *mut c_void, &mut __dso_handle);\n            }\n\n            #[cfg(target_os = \"macos\")]\n            unsafe fn register_destructor() {\n                _tlv_atexit(destructor, PTR as *mut c_void);\n            }\n\n            #[inline(always)]\n            fn init() {\n                unsafe {\n                    if PTR.is_null() {\n                        PTR = ::std::rt::heap::allocate(::std::mem::size_of::<$t>(),\n                                                          ::std::mem::align_of::<$t>()) as *mut $t;\n                        *PTR = $init;\n                        if ::std::intrinsics::needs_drop::<$t>() {\n                            register_destructor();\n                        }\n                    }\n                }\n            }\n```\n\nThe memory allocation is necessary due to lack of support for uninitialized mutable global variables and lack of a way to have global variables for types with destructors. The compiler wouldn't need to actually _call_ the destructor, it would just need to ignore it. I think allowing that with a lint warning about it would make sense. Most types with destructors don't provide a constant initializer anyway.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/57041183/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/57041783",
    "html_url": "https://github.com/rust-lang/rust/pull/17583#issuecomment-57041783",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/17583",
    "id": 57041783,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU3MDQxNzgz",
    "user": {
      "login": "pcwalton",
      "id": 157897,
      "node_id": "MDQ6VXNlcjE1Nzg5Nw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/157897?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/pcwalton",
      "html_url": "https://github.com/pcwalton",
      "followers_url": "https://api.github.com/users/pcwalton/followers",
      "following_url": "https://api.github.com/users/pcwalton/following{/other_user}",
      "gists_url": "https://api.github.com/users/pcwalton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/pcwalton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/pcwalton/subscriptions",
      "organizations_url": "https://api.github.com/users/pcwalton/orgs",
      "repos_url": "https://api.github.com/users/pcwalton/repos",
      "events_url": "https://api.github.com/users/pcwalton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/pcwalton/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-09-27T04:14:44Z",
    "updated_at": "2014-09-27T04:14:44Z",
    "body": "r? @alexcrichton \n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/57041783/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/57090547",
    "html_url": "https://github.com/rust-lang/rust/pull/17583#issuecomment-57090547",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/17583",
    "id": 57090547,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU3MDkwNTQ3",
    "user": {
      "login": "alexcrichton",
      "id": 64996,
      "node_id": "MDQ6VXNlcjY0OTk2",
      "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alexcrichton",
      "html_url": "https://github.com/alexcrichton",
      "followers_url": "https://api.github.com/users/alexcrichton/followers",
      "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}",
      "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions",
      "organizations_url": "https://api.github.com/users/alexcrichton/orgs",
      "repos_url": "https://api.github.com/users/alexcrichton/repos",
      "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alexcrichton/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-09-28T16:21:55Z",
    "updated_at": "2014-09-28T16:21:55Z",
    "body": "I'll take a closer look at this tomorrow when I have some more time, but as a high-level comment I'm a little wary about including bits in the standard distribution which don't really work across all platforms. We don't have much of a precedent for this beyond `liblibc` and some internal details of `libnative`, and I'd personally like to see the fallback implementation for platforms like android fleshed out before landing (but can certainly discuss this beforehand). \n\nAnother thing that I'm wary of is that the destructors for these values aren't ever run, and it's not super clear to me where they would be run. Opening an issue (#17572) about this is a great way to track it, but it's not immediately clear to me whether the proposed methods in the issue are feasible ways forward. I'd want to investigate scenarios like printing, failing, blocking, etc in destructors of TLS values in order to mark this api as safe.\n\nAt the last work week we also talked about a TLS implementation which did not take ownership of the value, but rather it was a sort of scope-based API where a value was only inserted into TLS for the scope of the lifetime of the object. That has a convenient side effect of not needing global initialization and destruction, which I found quite convenient! I'm not sure we took fantastic notes, but you can see [what we did take](https://github.com/rust-lang/meeting-minutes/blob/master/workweek-2014-08-18/libgreen-and-tls-redux.md). \n\nAs a final point, the distribution continues to officially support libgreen for the time being, and we want to consider other particular threading models when looking forward into the future. Currently these apis are not safe when used with libgreen, and it's unclear how they can be safe with any threading model other than 1:1 threads. This is largely just a point of whether these apis should be marked `unsafe` or not, but it is certainly something to consider.\n\nAnyway, I'll review in detail tomorrow!\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/57090547/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/57115059",
    "html_url": "https://github.com/rust-lang/rust/pull/17583#issuecomment-57115059",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/17583",
    "id": 57115059,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU3MTE1MDU5",
    "user": {
      "login": "thestinger",
      "id": 1505226,
      "node_id": "MDQ6VXNlcjE1MDUyMjY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1505226?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/thestinger",
      "html_url": "https://github.com/thestinger",
      "followers_url": "https://api.github.com/users/thestinger/followers",
      "following_url": "https://api.github.com/users/thestinger/following{/other_user}",
      "gists_url": "https://api.github.com/users/thestinger/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/thestinger/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/thestinger/subscriptions",
      "organizations_url": "https://api.github.com/users/thestinger/orgs",
      "repos_url": "https://api.github.com/users/thestinger/repos",
      "events_url": "https://api.github.com/users/thestinger/events{/privacy}",
      "received_events_url": "https://api.github.com/users/thestinger/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-09-29T04:06:54Z",
    "updated_at": "2014-09-29T06:57:42Z",
    "body": "> I'll take a closer look at this tomorrow when I have some more time, but as a high-level comment I'm a little wary about including bits in the standard distribution which don't really work across all platforms. We don't have much of a precedent for this beyond `liblibc` and some internal details of `libnative`, and I'd personally like to see the fallback implementation for platforms like android fleshed out before landing (but can certainly discuss this beforehand).\n\nAndroid does actually support static TLS and I've verified that C++11 `thread_local` works on the tablet I have access to (Android 4.4.4). 64-bit iOS supports it too, so the problem is going to fade away. Since it's part of C11 and C++11, it can be expected that all future hosted platforms provide it.\n\nI'll write the slow path for platforms without static TLS support (iOS, old Android versions) after the basics are in-tree and the API has been bikeshedded. There's nothing preventing an implementation of the current API on top of dynamic TLS, but the code is going to depend heavily on the API that's exposed. It's `#[experimental]` code so there is no backwards compatibility risk. There's no point in writing a bunch of low-level code for niche platforms that's likely going to need a complete rewrite. It will hold back improvements to the API.\n\n> Another thing that I'm wary of is that the destructors for these values aren't ever run, and it's not super clear to me where they would be run. Opening an issue (#17572) about this is a great way to track it, but it's not immediately clear to me whether the proposed methods in the issue are feasible ways forward. I'd want to investigate scenarios like printing, failing, blocking, etc in destructors of TLS values in order to mark this api as safe.\n\nTypes with destructors are not permitted in `static mut` variables so the API is entirely safe. C++11 implements static destruction for global and thread local variables in the compiler. Rust's compiler does not, so it would need to be done with separate macros using a dynamic allocation to hold the data and making use of dynamic TLS or lighter platform specific mechanisms (mentioned in the issue). I will implement destructor support in a follow-up pull request and it won't be hard to demonstrate that it is safe. As the issue states, support for TLS variables with destructors isn't implemented. It is not _broken_, although Rust's old `local_data` API **is** broken - it doesn't have memory safe destruction and there are other holes.\n\n> At the last work week we also talked about a TLS implementation which did not take ownership of the value, but rather it was a sort of scope-based API where a value was only inserted into TLS for the scope of the lifetime of the object. That has a convenient side effect of not needing global initialization and destruction, which I found quite convenient! I'm not sure we took fantastic notes, but you can see [what we did take](https://github.com/rust-lang/meeting-minutes/blob/master/workweek-2014-08-18/libgreen-and-tls-redux.md). \n\nThat may or may not be useful but it's not a replacement for this feature. Static thread-local storage is a hard requirement of a fast general purpose allocator and other library code reliant on thread caches for performance. A scoped implementation is an entirely different feature.\n\n> As a final point, the distribution continues to officially support libgreen for the time being, and we want to consider other particular threading models when looking forward into the future. Currently these apis are not safe when used with libgreen, and it's unclear how they can be safe with any threading model other than 1:1 threads. This is largely just a point of whether these apis should be marked `unsafe` or not, but it is certainly something to consider.\n\nSetting up registers correctly on context switches and implementing dynamic TLS support is the responsibility of the green threading library. Not setting up the thread-local storage register is not the only problem with how libgreen implements context switches. It's missing support for other registers too but we still enable passes like auto-vectorization and allow work on SIMD. It's entirely possible for it to handle this stuff just like the C standard library does for native threads. To quote RFC 62, which was accepted:\n\n> Finally, a guiding principle for the above work is uncompromising support for native system APIs, in terms of both functionality and performance. For example, it must be possible to use thread-local storage without significant overhead, which is very much not the case today. Any abstractions to support M:N threading models -- including the now-external libgreen package -- must respect this constraint.\n\nIt's no longer the responsibility of the standard library to hold back progress for libgreen. The memory unsafety is caused by fixable implementation issues in that library, not this one. Even if it wasn't possible for these to co-exist (it is), the RFC permits moving forwards regardless.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/57115059/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/57194341",
    "html_url": "https://github.com/rust-lang/rust/pull/17583#issuecomment-57194341",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/17583",
    "id": 57194341,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU3MTk0MzQx",
    "user": {
      "login": "alexcrichton",
      "id": 64996,
      "node_id": "MDQ6VXNlcjY0OTk2",
      "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alexcrichton",
      "html_url": "https://github.com/alexcrichton",
      "followers_url": "https://api.github.com/users/alexcrichton/followers",
      "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}",
      "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions",
      "organizations_url": "https://api.github.com/users/alexcrichton/orgs",
      "repos_url": "https://api.github.com/users/alexcrichton/repos",
      "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alexcrichton/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-09-29T17:11:25Z",
    "updated_at": "2014-09-29T17:11:25Z",
    "body": "If the intention of this is to be the lowest-level cross-platform implementation of a TLS value, then it may be worth having an unsafe primitive from which to build the other primitives on top of. It may not work out, but we've benefited in the past from stripping away all layers of abstraction (even `Cell` and `RefCell`) and exposing the underlying unsafe internals for manipulation. It may also help reduce duplication between these macros, provide an easy entrypoint for a non-`#[thread_local]` implementation, etc.\n\nWhat was the reasoning behind moving this to a separate crate? Was it because of the macros-in-prelude issues with the standard library?\n\nFrom an API point of view, it would be nice to unify all these macro invocations and rationalize them with the existing `statics`. I would personally think that declaring a TLS static would be very similar to the declaration of a normal static (or `static mut`). Considering https://github.com/rust-lang/rfcs/pull/246:\n\n``` rust\n// Thread-local static, not too useful because it can't be modified\ntls!(static FOO: uint = 3);\n\n// Thread-local unsafe cell, useful because it can be modified!\ntls!(static FOO: UnsafeCell<uint> = ...);\n\n// mutable, but still unsafe because borrows can be sent across threads\ntls!(static FOO: uint = 3);\n```\n\nThat's kinda just a sketch, it's more of conceptually what I might expect out of the TLS implementation from the standard distribution. I'm not sure how far along that tangent this can go, but it's also kinda just along the lines of an absolute bare-bones implementation which imposes 0 overhead, but may be unsafe still. From that perhaps we could build up a `tls_cell`/`tls_refcell` macro?\n\nJust some ideas, I'm curious what you think about them. Also, in general I don't really want to consider the standard distribution to be a ground where \"anything goes if it's experimental\". We're trying to _cut down_ in scope for a 1.0 release, and most things currently marked as experimental are either \"not triaged\" or \"triaged, and we'd really like to find a replacement, but we just can't remove this\". I suspect that a TLS implementation is in the category of \"we'd really like to have this\", but as long as it's backwards compatible to add it's not super urgent that it land _now_.\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/57194341/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/57358227",
    "html_url": "https://github.com/rust-lang/rust/pull/17583#issuecomment-57358227",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/17583",
    "id": 57358227,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU3MzU4MjI3",
    "user": {
      "login": "Valloric",
      "id": 919444,
      "node_id": "MDQ6VXNlcjkxOTQ0NA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/919444?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Valloric",
      "html_url": "https://github.com/Valloric",
      "followers_url": "https://api.github.com/users/Valloric/followers",
      "following_url": "https://api.github.com/users/Valloric/following{/other_user}",
      "gists_url": "https://api.github.com/users/Valloric/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Valloric/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Valloric/subscriptions",
      "organizations_url": "https://api.github.com/users/Valloric/orgs",
      "repos_url": "https://api.github.com/users/Valloric/repos",
      "events_url": "https://api.github.com/users/Valloric/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Valloric/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-09-30T18:18:18Z",
    "updated_at": "2014-09-30T18:18:18Z",
    "body": "You may want to reword the PR title to make it clear that this is about Thread Local Storage, not Transport Layer Security. It had me going for a minute.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/57358227/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/57433446",
    "html_url": "https://github.com/rust-lang/rust/pull/17583#issuecomment-57433446",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/17583",
    "id": 57433446,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU3NDMzNDQ2",
    "user": {
      "login": "thestinger",
      "id": 1505226,
      "node_id": "MDQ6VXNlcjE1MDUyMjY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1505226?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/thestinger",
      "html_url": "https://github.com/thestinger",
      "followers_url": "https://api.github.com/users/thestinger/followers",
      "following_url": "https://api.github.com/users/thestinger/following{/other_user}",
      "gists_url": "https://api.github.com/users/thestinger/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/thestinger/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/thestinger/subscriptions",
      "organizations_url": "https://api.github.com/users/thestinger/orgs",
      "repos_url": "https://api.github.com/users/thestinger/repos",
      "events_url": "https://api.github.com/users/thestinger/events{/privacy}",
      "received_events_url": "https://api.github.com/users/thestinger/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-10-01T08:26:57Z",
    "updated_at": "2014-10-01T08:28:21Z",
    "body": "> What was the reasoning behind moving this to a separate crate? Was it because of the macros-in-prelude issues with the standard library?\n\nYes, it's to work around not being able to mark macros as experimental. Instead, the crate as a whole can be marked experimental and then deprecated with the functionality moved to the standard library when it's finished.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/57433446/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/57435083",
    "html_url": "https://github.com/rust-lang/rust/pull/17583#issuecomment-57435083",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/17583",
    "id": 57435083,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU3NDM1MDgz",
    "user": {
      "login": "thestinger",
      "id": 1505226,
      "node_id": "MDQ6VXNlcjE1MDUyMjY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1505226?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/thestinger",
      "html_url": "https://github.com/thestinger",
      "followers_url": "https://api.github.com/users/thestinger/followers",
      "following_url": "https://api.github.com/users/thestinger/following{/other_user}",
      "gists_url": "https://api.github.com/users/thestinger/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/thestinger/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/thestinger/subscriptions",
      "organizations_url": "https://api.github.com/users/thestinger/orgs",
      "repos_url": "https://api.github.com/users/thestinger/repos",
      "events_url": "https://api.github.com/users/thestinger/events{/privacy}",
      "received_events_url": "https://api.github.com/users/thestinger/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-10-01T08:44:16Z",
    "updated_at": "2014-10-01T08:44:16Z",
    "body": "> That's kinda just a sketch, it's more of conceptually what I might expect out of the TLS implementation from the standard distribution. I'm not sure how far along that tangent this can go, but it's also kinda just along the lines of an absolute bare-bones implementation which imposes 0 overhead, but may be unsafe still. From that perhaps we could build up a `tls_cell`/`tls_refcell` macro?\n\nIt would make sense to factor out the portability shim for iOS / old Android like that. Since I hadn't started on it I didn't bother trying. The details of the portable implementation won't impact the higher-level safe wrappers but it would play into the design of the `unsafe` API.\n\n> Just some ideas, I'm curious what you think about them. Also, in general I don't really want to consider the standard distribution to be a ground where \"anything goes if it's experimental\". We're trying to _cut down_ in scope for a 1.0 release, and most things currently marked as experimental are either \"not triaged\" or \"triaged, and we'd really like to find a replacement, but we just can't remove this\". I suspect that a TLS implementation is in the category of \"we'd really like to have this\", but as long as it's backwards compatible to add it's not super urgent that it land _now_.\n\nRust is going to need thread-local storage, and developing it in-tree means the tests will be run to prevent regressions and it won't bitrot. It also makes it sane for more than one person to put work into it because it won't be getting rebased over and over.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/57435083/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/57435249",
    "html_url": "https://github.com/rust-lang/rust/pull/17583#issuecomment-57435249",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/17583",
    "id": 57435249,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU3NDM1MjQ5",
    "user": {
      "login": "thestinger",
      "id": 1505226,
      "node_id": "MDQ6VXNlcjE1MDUyMjY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1505226?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/thestinger",
      "html_url": "https://github.com/thestinger",
      "followers_url": "https://api.github.com/users/thestinger/followers",
      "following_url": "https://api.github.com/users/thestinger/following{/other_user}",
      "gists_url": "https://api.github.com/users/thestinger/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/thestinger/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/thestinger/subscriptions",
      "organizations_url": "https://api.github.com/users/thestinger/orgs",
      "repos_url": "https://api.github.com/users/thestinger/repos",
      "events_url": "https://api.github.com/users/thestinger/events{/privacy}",
      "received_events_url": "https://api.github.com/users/thestinger/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-10-01T08:46:00Z",
    "updated_at": "2014-10-01T08:47:22Z",
    "body": "> From an API point of view, it would be nice to unify all these macro invocations and rationalize them with the existing `statics`. I would personally think that declaring a TLS static would be very similar to the declaration of a normal static (or `static mut`). Considering https://github.com/rust-lang/rfcs/pull/246:\n\nIf having `static X: RefCell<TypeWithDestructor>` where you are allowed to store a type with a destructor is actually possible, then it could work. It can't be implemented that way right now though. The low-level shim will need to support implementing thread-local destructors on top, and ideally with minimal overhead like C++11 (no indirection via raw pointers).\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/57435249/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/57636853",
    "html_url": "https://github.com/rust-lang/rust/pull/17583#issuecomment-57636853",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/17583",
    "id": 57636853,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU3NjM2ODUz",
    "user": {
      "login": "alexcrichton",
      "id": 64996,
      "node_id": "MDQ6VXNlcjY0OTk2",
      "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alexcrichton",
      "html_url": "https://github.com/alexcrichton",
      "followers_url": "https://api.github.com/users/alexcrichton/followers",
      "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}",
      "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions",
      "organizations_url": "https://api.github.com/users/alexcrichton/orgs",
      "repos_url": "https://api.github.com/users/alexcrichton/repos",
      "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alexcrichton/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-10-02T14:23:22Z",
    "updated_at": "2014-10-02T14:23:22Z",
    "body": "With C++, you also have global initialization and destruction of statics, and I don't believe that we don't expose this for _technical reasons_, but moreso safety/engineering/etc reasons. I view this as similar to TLS statics in that where it is definitely possible, we may choose to not expose it at this time (to keep the two in sync).\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/57636853/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/58295601",
    "html_url": "https://github.com/rust-lang/rust/pull/17583#issuecomment-58295601",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/17583",
    "id": 58295601,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU4Mjk1NjAx",
    "user": {
      "login": "thestinger",
      "id": 1505226,
      "node_id": "MDQ6VXNlcjE1MDUyMjY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1505226?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/thestinger",
      "html_url": "https://github.com/thestinger",
      "followers_url": "https://api.github.com/users/thestinger/followers",
      "following_url": "https://api.github.com/users/thestinger/following{/other_user}",
      "gists_url": "https://api.github.com/users/thestinger/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/thestinger/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/thestinger/subscriptions",
      "organizations_url": "https://api.github.com/users/thestinger/orgs",
      "repos_url": "https://api.github.com/users/thestinger/repos",
      "events_url": "https://api.github.com/users/thestinger/events{/privacy}",
      "received_events_url": "https://api.github.com/users/thestinger/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-10-08T02:09:04Z",
    "updated_at": "2014-10-08T02:09:04Z",
    "body": "@alexcrichton: There are no safety or engineering reasons to avoid exposing destructors for TLS. It would make the API crippled relative to C++. It would be unusable for something like a general purpose allocator without a way to clean up the data. I don't see why Rust should settle for a lower quality TLS implementation than C++11.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/58295601/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/58296054",
    "html_url": "https://github.com/rust-lang/rust/pull/17583#issuecomment-58296054",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/17583",
    "id": 58296054,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU4Mjk2MDU0",
    "user": {
      "login": "thestinger",
      "id": 1505226,
      "node_id": "MDQ6VXNlcjE1MDUyMjY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1505226?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/thestinger",
      "html_url": "https://github.com/thestinger",
      "followers_url": "https://api.github.com/users/thestinger/followers",
      "following_url": "https://api.github.com/users/thestinger/following{/other_user}",
      "gists_url": "https://api.github.com/users/thestinger/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/thestinger/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/thestinger/subscriptions",
      "organizations_url": "https://api.github.com/users/thestinger/orgs",
      "repos_url": "https://api.github.com/users/thestinger/repos",
      "events_url": "https://api.github.com/users/thestinger/events{/privacy}",
      "received_events_url": "https://api.github.com/users/thestinger/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-10-08T02:14:15Z",
    "updated_at": "2014-10-08T02:15:08Z",
    "body": "Current Android versions and 64-bit iOS (iPhone 5S / iOS7 and later) support TLS so I don't consider the lack of a fallback to be a pressing issue. The only relevant versions of iOS for Rust will be 64-bit, so the only loss would be not working within legacy 32-bit software targeting a 64-bit OS.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/58296054/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/58299024",
    "html_url": "https://github.com/rust-lang/rust/pull/17583#issuecomment-58299024",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/17583",
    "id": 58299024,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU4Mjk5MDI0",
    "user": {
      "login": "thestinger",
      "id": 1505226,
      "node_id": "MDQ6VXNlcjE1MDUyMjY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1505226?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/thestinger",
      "html_url": "https://github.com/thestinger",
      "followers_url": "https://api.github.com/users/thestinger/followers",
      "following_url": "https://api.github.com/users/thestinger/following{/other_user}",
      "gists_url": "https://api.github.com/users/thestinger/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/thestinger/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/thestinger/subscriptions",
      "organizations_url": "https://api.github.com/users/thestinger/orgs",
      "repos_url": "https://api.github.com/users/thestinger/repos",
      "events_url": "https://api.github.com/users/thestinger/events{/privacy}",
      "received_events_url": "https://api.github.com/users/thestinger/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-10-08T02:47:36Z",
    "updated_at": "2014-10-08T02:47:44Z",
    "body": "I fixed the one soundness issue involving lack of `unsafe` hygiene. It's already a useful, safe API and I plan on continuing to expand / improve it once it's in-tree. Any further work on it is blocked on having an assurance that it won't be rejected or it being in-tree so I can iterate via new pull requests. I don't enjoy waiting weeks to progress anywhere on any non-trivial work.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/58299024/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/58300031",
    "html_url": "https://github.com/rust-lang/rust/pull/17583#issuecomment-58300031",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/17583",
    "id": 58300031,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU4MzAwMDMx",
    "user": {
      "login": "vhbit",
      "id": 140199,
      "node_id": "MDQ6VXNlcjE0MDE5OQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/140199?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vhbit",
      "html_url": "https://github.com/vhbit",
      "followers_url": "https://api.github.com/users/vhbit/followers",
      "following_url": "https://api.github.com/users/vhbit/following{/other_user}",
      "gists_url": "https://api.github.com/users/vhbit/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vhbit/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vhbit/subscriptions",
      "organizations_url": "https://api.github.com/users/vhbit/orgs",
      "repos_url": "https://api.github.com/users/vhbit/repos",
      "events_url": "https://api.github.com/users/vhbit/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vhbit/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-10-08T02:59:33Z",
    "updated_at": "2014-10-08T02:59:33Z",
    "body": "Currently the only supported iOS version is 32 bit and I think at\nleast till the next year it MUST be supported as 4S is still widely\nused\n\nBut since 32bit is fading away - I can suggest unsafe option, we had a\ndiscussion about it with Alex before merging - there is a faster TLS,\nundocumented method extracted from libc sources, definitely unsafe,\nbut considering timeframe of 32bit OS - it might be worth trying.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/58300031/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/58300572",
    "html_url": "https://github.com/rust-lang/rust/pull/17583#issuecomment-58300572",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/17583",
    "id": 58300572,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU4MzAwNTcy",
    "user": {
      "login": "thestinger",
      "id": 1505226,
      "node_id": "MDQ6VXNlcjE1MDUyMjY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1505226?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/thestinger",
      "html_url": "https://github.com/thestinger",
      "followers_url": "https://api.github.com/users/thestinger/followers",
      "following_url": "https://api.github.com/users/thestinger/following{/other_user}",
      "gists_url": "https://api.github.com/users/thestinger/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/thestinger/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/thestinger/subscriptions",
      "organizations_url": "https://api.github.com/users/thestinger/orgs",
      "repos_url": "https://api.github.com/users/thestinger/repos",
      "events_url": "https://api.github.com/users/thestinger/events{/privacy}",
      "received_events_url": "https://api.github.com/users/thestinger/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-10-08T03:06:16Z",
    "updated_at": "2014-10-08T03:06:37Z",
    "body": "I could implement this API for it, but I have no way to test it because there is no Rust bot. Someone with access to iOS can do it after this lands. In-tree development means people can collaborate. It seems that privilege is reserved for people who work for Mozilla though.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/58300572/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/58410554",
    "html_url": "https://github.com/rust-lang/rust/pull/17583#issuecomment-58410554",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/17583",
    "id": 58410554,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU4NDEwNTU0",
    "user": {
      "login": "vhbit",
      "id": 140199,
      "node_id": "MDQ6VXNlcjE0MDE5OQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/140199?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vhbit",
      "html_url": "https://github.com/vhbit",
      "followers_url": "https://api.github.com/users/vhbit/followers",
      "following_url": "https://api.github.com/users/vhbit/following{/other_user}",
      "gists_url": "https://api.github.com/users/vhbit/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vhbit/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vhbit/subscriptions",
      "organizations_url": "https://api.github.com/users/vhbit/orgs",
      "repos_url": "https://api.github.com/users/vhbit/repos",
      "events_url": "https://api.github.com/users/vhbit/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vhbit/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-10-08T19:10:06Z",
    "updated_at": "2014-10-08T19:10:06Z",
    "body": "I can test it on iOS 32 and I can do it out of tree - as I maintain iOS on\nworking state for internal projects and build it anyway.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/58410554/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/58751921",
    "html_url": "https://github.com/rust-lang/rust/pull/17583#issuecomment-58751921",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/17583",
    "id": 58751921,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU4NzUxOTIx",
    "user": {
      "login": "eddyb",
      "id": 77424,
      "node_id": "MDQ6VXNlcjc3NDI0",
      "avatar_url": "https://avatars.githubusercontent.com/u/77424?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/eddyb",
      "html_url": "https://github.com/eddyb",
      "followers_url": "https://api.github.com/users/eddyb/followers",
      "following_url": "https://api.github.com/users/eddyb/following{/other_user}",
      "gists_url": "https://api.github.com/users/eddyb/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/eddyb/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/eddyb/subscriptions",
      "organizations_url": "https://api.github.com/users/eddyb/orgs",
      "repos_url": "https://api.github.com/users/eddyb/repos",
      "events_url": "https://api.github.com/users/eddyb/events{/privacy}",
      "received_events_url": "https://api.github.com/users/eddyb/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-10-11T14:49:56Z",
    "updated_at": "2014-10-11T14:49:56Z",
    "body": "@alexcrichton @aturon Is there anything blocking this, or can it be merged as a first step?\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/58751921/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/58764899",
    "html_url": "https://github.com/rust-lang/rust/pull/17583#issuecomment-58764899",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/17583",
    "id": 58764899,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU4NzY0ODk5",
    "user": {
      "login": "alexcrichton",
      "id": 64996,
      "node_id": "MDQ6VXNlcjY0OTk2",
      "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alexcrichton",
      "html_url": "https://github.com/alexcrichton",
      "followers_url": "https://api.github.com/users/alexcrichton/followers",
      "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}",
      "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions",
      "organizations_url": "https://api.github.com/users/alexcrichton/orgs",
      "repos_url": "https://api.github.com/users/alexcrichton/repos",
      "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alexcrichton/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-10-11T21:19:48Z",
    "updated_at": "2014-10-11T21:19:48Z",
    "body": "@eddyb, I'd like to point out again that as part of library stabilization we're trying to _cut down_ on the surface area of the standard distribution. I, however, also believe that everyone is in alignment that we'd like to have a nice TLS implementation. \n\nI would also like to point out that there is nothing stopping this from being a cargo package which could be quickly iterated on. The benefit of being a cargo package is also that quicker iteration is allowed (bors isn't exactly speedy), versioning is independent from Rust itself, and other implementations can have more interoperability. The downsides, of course, of being a cargo package are that it is not updated automatically when breaking changes are made and discoverability is currently difficult. The breaking changes part will alleviate as Rust becomes more stable, and the discoverability will alleviate once we have a central Registry (working quite hard on it right now!).\n\nI'm not saying that this _shouldn't_ be in the standard distribution, I'd just like to point out that this implementation is not dead in the water if we don't merge it at this time.\n\n---\n\nSpecifically speaking, I don't think any of my concerns have been addressed, I'll reiterate them below for clarity. I hope this answers your question about what is blocking this PR. \n- Leveraging macros for generating the entire implementation\n  \n  > In general I'm not a huge fan of having a huge amount of code generated by macros, it's got downsides like being difficult to document, exposing implementation details, various hygiene issues, surprising access patterns, lack of macro import/export, etc.\n- Incorrect casting\n  \n  > Due to the compiler being able to re-order struct fields, I don't think that this is a valid cast.\n- Inconsistency with existing statics today\n  \n  > From an API point of view, it would be nice to unify all these macro invocations and rationalize them with the existing `statics`.\n\nThere are also some broader concerns which I was going to bring up once some of the above concerns were addressed:\n- There is no documentation as part of this PR\n- This is currently not cross-platform to all of Rust's supported platforms\n\nBoth of these points, while somewhat minor, are important in terms of being integrated with the standard distribution. There are also precisely where a cargo package may also help because arbitrary cargo packages don't have the same restriction requirements as the standard library.\n\n---\n\nAs-is, I would be uneasy to merge this mostly because of the inconsistency with existing statics today. This is duplicating exactly how `Cell` and `RefCell` work, but in statics. In the past when we've had duplicate functionality we have always found the need to consolidate it (such as `MutexArc` and `Arc`, for example). This seems like a pretty clear location where the storage (TLS) should be separated from the type itself (`Cell`/`RefCell`).\n\nIf there are technical problems blocking this goal, then those seem like challenges to overcome rather than to start officially supporting an API we would just wish to change later. Note that this is also precisely where a Cargo package helps because the package could have an entirely separate interface and be slowly deprecated over time if language changes elsewhere enable a better API.\n\nThat may sound all quite vague, so I would like to give an outline of an api which I think would address my concerns:\n\n``` rust\nuse std::cell::UnsafeCell;\n\n// Genric structure representing a slot in TLS, its definition changes\n// per-platform.\n//\n// Note that the inner field is private, and this would require some form of\n// macro hygiene to allow the macros below to initialize the fields without\n// allowing access to them. This is already highly desired for other structures\n// like, for example, UnsafeCell, Cell, and RefCell.\npub struct Tls<T> { inner: T }\n\n// If a platform didn't support #[thread_local], the definition would look more\n// like:\npub struct Tls<T> {\n    init: T,         // bit pattern to initialize thread statics with\n    key: AtomicUint, // init 0, lazily initialized\n}\n\n// These would be appropriately modified for platfors which didn't support\n// #[thread_local] as just normal `static`/`static mut` globals.\nmacro_rules! tls(\n    (static $name:ident: $t:ty = $init:expr) => (\n        #[thread_local]\n        static $name: Tls<$t> = Tls { inner: $init };\n    );\n    (static mut $name:ident: $t:ty = $init:expr) => (\n        #[thread_local]\n        static mut $name: Tls<$t> = Tls { inner: $init };\n    );\n)\nmacro_rules! cell(($e:expr) => (Cell { inner: UnsafeCell { value: $e } }))\nmacro_rules! refcell(($e:expr) => (...))\n\nimpl<T> Tls<T> {\n    pub fn get(&'static self) -> TlsRef<T> {\n        // On platforms which don't support #[thread_local], this would perform\n        // lazy initialization of the corresponding OS-based TLS key.\n        TlsRef { inner: &self.inner }\n    }\n\n    // This is a safe function, it should be unsafe to get a mutable reference\n    // in the first place.\n    pub fn get_mut(&'static mut self) -> TlsRefMut<T> {\n        TlsRefMut { inner: &self.inner }\n    }\n}\n\npub struct TlsRef<T> { inner: &'static T }\npub struct TlsRefMut<T> { inner: &'static mut T }\n\nimpl<T> Deref<T> for TlsRef<T> {\n    fn deref<'a>(&'a self) -> &'a T { self.inner }\n}\nimpl<T> Deref<T> for TlsRefMut<T> {\n    fn deref<'a>(&'a self) -> &'a T { &*self.inner }\n}\nimpl<T> DerefMut<T> for TlsRefMut<T> {\n    fn deref_mut<'a>(&'a mut self) -> &'a mut T { &mut *self.inner }\n}\n\n// Note that this is stored in a `static`, which normally requires `Sync`. The\n// compiler would understand that a `#[thread_local]` static does not require\n// `Sync`.\ntls!(static FOO: Cell<uint> = cell!(1));\ntls!(static BAR: RefCell<int> = refcell!(2));\n\nfn main() {\n    let foo = FOO.get();\n    assert_eq!(foo.get(), 1);\n    foo.set(1);\n\n    let mut bar = BAR.get();\n    assert_eq!(2, *bar.borrow());\n    *bar.borrow_mut() = 3;\n}\n```\n\nThis addresses these concerns:\n- The interface is easily documentable. The documentation is placed on the `Tls` struct as well as the `get` method, and then there are examples showing how the `Tls` struct may only be constructed via the macro. Also, bounds can be placed on `T` to ensure that it's `Copy` or doesn't have destructors, etc.\n- There is no longer a macro generating a wad of code in a different namespace. All expressions are evaluated in the namespace they're declared in.\n- This is composable with existing types. For example you can have a tls `UnsafeCell`, or you can have a totally unsafe `static mut` with tls. You're not forced into `Cell` or `RefCell` if you don't want to. The purpose of `Tls` is to provide a _bare bones_ abstraction over the platform's best TLS solution, be that `#[thread_local]`, pthreads, or `TlsGetValue`.\n- This continues (as does the current design) to provide a way to fall back to an OS-based TLS implementation.\n- The current story for stability of macros at 1.0 is somewhat in flux, and a type/struct-based solution (instead of a 100% macro-based solution) is more likely to be available than the macro-based version.\n\nThere are a number of tweaks which would have to be made to the compiler to make this work, however:\n- Privacy hygiene with respect to static initialization would have to be implemented. This is wanted regardless for `UnsafeCell<T>`, and it would provide a nice way to provide static constructors of generic items. For example there could be a static constructor of `Mutex<T>` through a macro. In general this is solve much better through CTFE (or something similar), but we may be able to settle for a macro-based solution for now.\n- Safe access to a non-`Sync` `#[thread_local]` static would have to be allowed, this is fairly trivial to do.\n\nAnd, of course, there are a number of cons to this solution:\n- This does not allow dynamic initialization or construction. Note, however, that this is consistent with the rest of Rust globals today. It is certainly an extension that can be added in the future, but I think we should add it to both static and thread local globals at the same time. Singling one out as special seems odd.\n\n---\n\nIn general I would like to reiterate that no one doesn't want a good TLS interface. The practice which we've been encouraging for new functionality in the standard library is for it to be developed out of tree, and then migrate it in-tree if possible. This helps us promote faster iteration of libraries such as this along with reducing the surface area of the standard library that needs to be stable for 1.0 (which is quite soon!).\n\n---\n\nAlso, @thestinger, after re-reading many of the comments in this thread I've noticed that you've added to them in many cases. Would you be ok pinging the issue when you update a comment? Github doesn't send out any notifications, so I won't know to check back on this thread if you update a past comment. I was, for example, completely unaware that you pasted bits and pieces about construction/destruction.\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/58764899/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/58766702",
    "html_url": "https://github.com/rust-lang/rust/pull/17583#issuecomment-58766702",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/17583",
    "id": 58766702,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU4NzY2NzAy",
    "user": {
      "login": "wycats",
      "id": 4,
      "node_id": "MDQ6VXNlcjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/wycats",
      "html_url": "https://github.com/wycats",
      "followers_url": "https://api.github.com/users/wycats/followers",
      "following_url": "https://api.github.com/users/wycats/following{/other_user}",
      "gists_url": "https://api.github.com/users/wycats/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/wycats/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/wycats/subscriptions",
      "organizations_url": "https://api.github.com/users/wycats/orgs",
      "repos_url": "https://api.github.com/users/wycats/repos",
      "events_url": "https://api.github.com/users/wycats/events{/privacy}",
      "received_events_url": "https://api.github.com/users/wycats/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-10-11T22:23:28Z",
    "updated_at": "2014-10-11T22:23:28Z",
    "body": "@thestinger docs and support for all supported platforms seem like blockers. Any reason not to iterate on this as a Cargo package?\n\nYou mentioned mandatory compiler support. Can you say more about that? Maybe you can get what you need on that front without having to do all the design and iteration on master.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/58766702/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/58766986",
    "html_url": "https://github.com/rust-lang/rust/pull/17583#issuecomment-58766986",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/17583",
    "id": 58766986,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU4NzY2OTg2",
    "user": {
      "login": "thestinger",
      "id": 1505226,
      "node_id": "MDQ6VXNlcjE1MDUyMjY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1505226?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/thestinger",
      "html_url": "https://github.com/thestinger",
      "followers_url": "https://api.github.com/users/thestinger/followers",
      "following_url": "https://api.github.com/users/thestinger/following{/other_user}",
      "gists_url": "https://api.github.com/users/thestinger/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/thestinger/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/thestinger/subscriptions",
      "organizations_url": "https://api.github.com/users/thestinger/orgs",
      "repos_url": "https://api.github.com/users/thestinger/repos",
      "events_url": "https://api.github.com/users/thestinger/events{/privacy}",
      "received_events_url": "https://api.github.com/users/thestinger/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-10-11T22:34:16Z",
    "updated_at": "2014-10-11T22:34:16Z",
    "body": "@wycats: The current TLS implementation in the repository needs to be replaced or removed. It's used throughout the implementation despite being incredibly slow and bloated. This does cover all officially supported platforms already - it works on Windows, OS X, Linux, and Android. It does not work on _32-bit iOS_ but that has never been officially supported / tested.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/58766986/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/58767077",
    "html_url": "https://github.com/rust-lang/rust/pull/17583#issuecomment-58767077",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/17583",
    "id": 58767077,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU4NzY3MDc3",
    "user": {
      "login": "wycats",
      "id": 4,
      "node_id": "MDQ6VXNlcjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/wycats",
      "html_url": "https://github.com/wycats",
      "followers_url": "https://api.github.com/users/wycats/followers",
      "following_url": "https://api.github.com/users/wycats/following{/other_user}",
      "gists_url": "https://api.github.com/users/wycats/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/wycats/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/wycats/subscriptions",
      "organizations_url": "https://api.github.com/users/wycats/orgs",
      "repos_url": "https://api.github.com/users/wycats/repos",
      "events_url": "https://api.github.com/users/wycats/events{/privacy}",
      "received_events_url": "https://api.github.com/users/wycats/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-10-11T22:37:46Z",
    "updated_at": "2014-10-11T22:37:46Z",
    "body": "@thestinger did you test it on Linux 2.6.18 and glibc 2.5 (the oldest supported platforms)?\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/58767077/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/58767101",
    "html_url": "https://github.com/rust-lang/rust/pull/17583#issuecomment-58767101",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/17583",
    "id": 58767101,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU4NzY3MTAx",
    "user": {
      "login": "thestinger",
      "id": 1505226,
      "node_id": "MDQ6VXNlcjE1MDUyMjY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1505226?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/thestinger",
      "html_url": "https://github.com/thestinger",
      "followers_url": "https://api.github.com/users/thestinger/followers",
      "following_url": "https://api.github.com/users/thestinger/following{/other_user}",
      "gists_url": "https://api.github.com/users/thestinger/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/thestinger/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/thestinger/subscriptions",
      "organizations_url": "https://api.github.com/users/thestinger/orgs",
      "repos_url": "https://api.github.com/users/thestinger/repos",
      "events_url": "https://api.github.com/users/thestinger/events{/privacy}",
      "received_events_url": "https://api.github.com/users/thestinger/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-10-11T22:38:53Z",
    "updated_at": "2014-10-11T22:38:53Z",
    "body": "@wycats: It passed tests on the Linux builder and `__thread` has been solid for _years_ on Linux.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/58767101/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/58767141",
    "html_url": "https://github.com/rust-lang/rust/pull/17583#issuecomment-58767141",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/17583",
    "id": 58767141,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU4NzY3MTQx",
    "user": {
      "login": "thestinger",
      "id": 1505226,
      "node_id": "MDQ6VXNlcjE1MDUyMjY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1505226?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/thestinger",
      "html_url": "https://github.com/thestinger",
      "followers_url": "https://api.github.com/users/thestinger/followers",
      "following_url": "https://api.github.com/users/thestinger/following{/other_user}",
      "gists_url": "https://api.github.com/users/thestinger/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/thestinger/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/thestinger/subscriptions",
      "organizations_url": "https://api.github.com/users/thestinger/orgs",
      "repos_url": "https://api.github.com/users/thestinger/repos",
      "events_url": "https://api.github.com/users/thestinger/events{/privacy}",
      "received_events_url": "https://api.github.com/users/thestinger/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-10-11T22:40:36Z",
    "updated_at": "2014-10-11T22:40:36Z",
    "body": "Static TLS on Linux dates back to 2001-2003. It is a standard feature in C11 and C++11 implemented on all major platforms. This is not bleeding edge stuff. It is a basic feature expected of a systems language, and Rust is falling far short of the competitors here.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/58767141/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/58767143",
    "html_url": "https://github.com/rust-lang/rust/pull/17583#issuecomment-58767143",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/17583",
    "id": 58767143,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU4NzY3MTQz",
    "user": {
      "login": "wycats",
      "id": 4,
      "node_id": "MDQ6VXNlcjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/wycats",
      "html_url": "https://github.com/wycats",
      "followers_url": "https://api.github.com/users/wycats/followers",
      "following_url": "https://api.github.com/users/wycats/following{/other_user}",
      "gists_url": "https://api.github.com/users/wycats/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/wycats/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/wycats/subscriptions",
      "organizations_url": "https://api.github.com/users/wycats/orgs",
      "repos_url": "https://api.github.com/users/wycats/repos",
      "events_url": "https://api.github.com/users/wycats/events{/privacy}",
      "received_events_url": "https://api.github.com/users/wycats/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-10-11T22:40:38Z",
    "updated_at": "2014-10-11T22:40:38Z",
    "body": "@thestinger also, it would be really helpful (at least to me) if you responded to @alexcrichton's specific questions. He did a pretty thorough review and your reply is pretty dismissive of what seems like a good-faith effort to have a discussion about your patch.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/58767143/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/58767175",
    "html_url": "https://github.com/rust-lang/rust/pull/17583#issuecomment-58767175",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/17583",
    "id": 58767175,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU4NzY3MTc1",
    "user": {
      "login": "thestinger",
      "id": 1505226,
      "node_id": "MDQ6VXNlcjE1MDUyMjY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1505226?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/thestinger",
      "html_url": "https://github.com/thestinger",
      "followers_url": "https://api.github.com/users/thestinger/followers",
      "following_url": "https://api.github.com/users/thestinger/following{/other_user}",
      "gists_url": "https://api.github.com/users/thestinger/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/thestinger/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/thestinger/subscriptions",
      "organizations_url": "https://api.github.com/users/thestinger/orgs",
      "repos_url": "https://api.github.com/users/thestinger/repos",
      "events_url": "https://api.github.com/users/thestinger/events{/privacy}",
      "received_events_url": "https://api.github.com/users/thestinger/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-10-11T22:41:54Z",
    "updated_at": "2014-10-11T22:49:49Z",
    "body": "@wycats: Can you please quote this reply you're calling \"dismissive\"?\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/58767175/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/58767507",
    "html_url": "https://github.com/rust-lang/rust/pull/17583#issuecomment-58767507",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/17583",
    "id": 58767507,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU4NzY3NTA3",
    "user": {
      "login": "wycats",
      "id": 4,
      "node_id": "MDQ6VXNlcjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/wycats",
      "html_url": "https://github.com/wycats",
      "followers_url": "https://api.github.com/users/wycats/followers",
      "following_url": "https://api.github.com/users/wycats/following{/other_user}",
      "gists_url": "https://api.github.com/users/wycats/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/wycats/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/wycats/subscriptions",
      "organizations_url": "https://api.github.com/users/wycats/orgs",
      "repos_url": "https://api.github.com/users/wycats/repos",
      "events_url": "https://api.github.com/users/wycats/events{/privacy}",
      "received_events_url": "https://api.github.com/users/wycats/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-10-11T22:56:44Z",
    "updated_at": "2014-10-11T22:56:44Z",
    "body": "@thestinger maybe \"dismissive\" means something stronger to you than I meant.\n\nWhat I meant was that @alexcrichton wrote a long, thoughtful and detailed review of your patch, and your response reiterated what everyone already knows: that the current implementation is not very good and needs to be replaced.\n\nI would honestly really appreciate responses to his specific review. \n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/58767507/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/58767522",
    "html_url": "https://github.com/rust-lang/rust/pull/17583#issuecomment-58767522",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/17583",
    "id": 58767522,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU4NzY3NTIy",
    "user": {
      "login": "thestinger",
      "id": 1505226,
      "node_id": "MDQ6VXNlcjE1MDUyMjY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1505226?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/thestinger",
      "html_url": "https://github.com/thestinger",
      "followers_url": "https://api.github.com/users/thestinger/followers",
      "following_url": "https://api.github.com/users/thestinger/following{/other_user}",
      "gists_url": "https://api.github.com/users/thestinger/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/thestinger/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/thestinger/subscriptions",
      "organizations_url": "https://api.github.com/users/thestinger/orgs",
      "repos_url": "https://api.github.com/users/thestinger/repos",
      "events_url": "https://api.github.com/users/thestinger/events{/privacy}",
      "received_events_url": "https://api.github.com/users/thestinger/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-10-11T22:57:30Z",
    "updated_at": "2014-10-11T22:57:30Z",
    "body": "@wycats: You haven't given me time to respond. I opened this thread and was going to respond to @alexcrichton until you started throwing accusations around.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/58767522/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/58767548",
    "html_url": "https://github.com/rust-lang/rust/pull/17583#issuecomment-58767548",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/17583",
    "id": 58767548,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU4NzY3NTQ4",
    "user": {
      "login": "alexcrichton",
      "id": 64996,
      "node_id": "MDQ6VXNlcjY0OTk2",
      "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alexcrichton",
      "html_url": "https://github.com/alexcrichton",
      "followers_url": "https://api.github.com/users/alexcrichton/followers",
      "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}",
      "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions",
      "organizations_url": "https://api.github.com/users/alexcrichton/orgs",
      "repos_url": "https://api.github.com/users/alexcrichton/repos",
      "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alexcrichton/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-10-11T22:58:41Z",
    "updated_at": "2014-10-11T22:58:41Z",
    "body": "Sadly our auto/try bots are not CentOS 5.10 (the old linux we test on), just the snapshot builders are. I have manually verified, however, that `#[thread_local]` at least passes a smoke test on CentOS 5.10 on both 32/64 bit. That should address @wycats's concern about 2.6.18\n\n@thestinger I know we've had trouble with `#[thread_local]` in the past on windows, so I tested this locally with the most recently night. A smoke test (thread local `static mut`, just prints it), ran fine on 64-bit windows, but it segfaulted on 32-bit windows. Did you verify both architectures? If so, perhaps my install of msys/msys2 is broken? If we need to tweak our mingw/msys requirements that's probably fine, but we just need to be prepared to do so ahead of time.\n\nI'd also like to point out that `std::local_data` is `#[experimental]` today, and it's highly unlikely that that will ever change (other than to become `#[deprecated]`). The continued usage of it is purely historical, and one of the current plans about the release channel of rust is to make it impossible to reach `#[experimental]` code, which would make it impossible to use `std::local_data` in stable code. Note, however, that these plans are developing over time.\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/58767548/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/58767736",
    "html_url": "https://github.com/rust-lang/rust/pull/17583#issuecomment-58767736",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/17583",
    "id": 58767736,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU4NzY3NzM2",
    "user": {
      "login": "wycats",
      "id": 4,
      "node_id": "MDQ6VXNlcjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/wycats",
      "html_url": "https://github.com/wycats",
      "followers_url": "https://api.github.com/users/wycats/followers",
      "following_url": "https://api.github.com/users/wycats/following{/other_user}",
      "gists_url": "https://api.github.com/users/wycats/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/wycats/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/wycats/subscriptions",
      "organizations_url": "https://api.github.com/users/wycats/orgs",
      "repos_url": "https://api.github.com/users/wycats/repos",
      "events_url": "https://api.github.com/users/wycats/events{/privacy}",
      "received_events_url": "https://api.github.com/users/wycats/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-10-11T23:06:54Z",
    "updated_at": "2014-10-11T23:06:54Z",
    "body": "@thestinger apologies if something I said looked accusatory. I was just making an observation that @alexcrichton wrote a fairly long review of the patch, and your reply to his comments seemed curt. It sounds like you didn't mean it that way, though!\n\nLooking forward to a fuller response. Like you, I would like to see a better TLS implementation in `libstd`.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/58767736/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/58767811",
    "html_url": "https://github.com/rust-lang/rust/pull/17583#issuecomment-58767811",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/17583",
    "id": 58767811,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU4NzY3ODEx",
    "user": {
      "login": "alexcrichton",
      "id": 64996,
      "node_id": "MDQ6VXNlcjY0OTk2",
      "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alexcrichton",
      "html_url": "https://github.com/alexcrichton",
      "followers_url": "https://api.github.com/users/alexcrichton/followers",
      "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}",
      "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions",
      "organizations_url": "https://api.github.com/users/alexcrichton/orgs",
      "repos_url": "https://api.github.com/users/alexcrichton/repos",
      "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alexcrichton/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-10-11T23:10:57Z",
    "updated_at": "2014-10-11T23:10:57Z",
    "body": "I also just tested this out on the android toolchain that I had lying around, it's the same smoke test of thread local `static mut` followed by a print, and I got this error:\n\n```\n$ ./x86_64-unknown-linux-gnu/stage2/bin/rustc foo.rs --target arm-linux-androideabi -C linker=$HOME/code/android/ndk_standalone/bin/arm-linux-androideabi-gcc \nerror: linking with `/home/alex/code/android/ndk_standalone/bin/arm-linux-androideabi-gcc` failed: exit code: 1\nnote: /home/alex/code/android/ndk_standalone/bin/arm-linux-androideabi-gcc '-marm' '-L' '/home/alex/code/rust2/x86_64-unknown-linux-gnu/stage2/lib/rustlib/arm-linux-androideabi/lib' '-o' 'foo' 'foo.o' '-Wl,--whole-archive' '-lmorestack' '-Wl,--no-whole-archive' '-nodefaultlibs' '-fno-lto' '-Wl,--gc-sections' '-Wl,--allow-multiple-definition' '/home/alex/code/rust2/x86_64-unknown-linux-gnu/stage2/lib/rustlib/arm-linux-androideabi/lib/libnative-4e7c5e5c.rlib' '/home/alex/code/rust2/x86_64-unknown-linux-gnu/stage2/lib/rustlib/arm-linux-androideabi/lib/libstd-4e7c5e5c.rlib' '/home/alex/code/rust2/x86_64-unknown-linux-gnu/stage2/lib/rustlib/arm-linux-androideabi/lib/libsync-4e7c5e5c.rlib' '/home/alex/code/rust2/x86_64-unknown-linux-gnu/stage2/lib/rustlib/arm-linux-androideabi/lib/librustrt-4e7c5e5c.rlib' '/home/alex/code/rust2/x86_64-unknown-linux-gnu/stage2/lib/rustlib/arm-linux-androideabi/lib/libcollections-4e7c5e5c.rlib' '/home/alex/code/rust2/x86_64-unknown-linux-gnu/stage2/lib/rustlib/arm-linux-androideabi/lib/librand-4e7c5e5c.rlib' '/home/alex/code/rust2/x86_64-unknown-linux-gnu/stage2/lib/rustlib/arm-linux-androideabi/lib/liballoc-4e7c5e5c.rlib' '/home/alex/code/rust2/x86_64-unknown-linux-gnu/stage2/lib/rustlib/arm-linux-androideabi/lib/libunicode-4e7c5e5c.rlib' '/home/alex/code/rust2/x86_64-unknown-linux-gnu/stage2/lib/rustlib/arm-linux-androideabi/lib/liblibc-4e7c5e5c.rlib' '/home/alex/code/rust2/x86_64-unknown-linux-gnu/stage2/lib/rustlib/arm-linux-androideabi/lib/libcore-4e7c5e5c.rlib' '-L' '/home/alex/code/rust2/.rust' '-L' '/home/alex/code/rust2' '-Wl,--whole-archive' '-Wl,-Bstatic' '-Wl,--no-whole-archive' '-Wl,-Bdynamic' '-ldl' '-llog' '-lgcc' '-lc' '-lm' '-lcompiler-rt'\nnote: /home/alex/code/android/ndk_standalone/bin/../lib/gcc/arm-linux-androideabi/4.6/../../../../arm-linux-androideabi/bin/ld: foo.o: in function main::h74429ed16fd18446iaa:foo.0.rs(.text._ZN4main20h74429ed16fd18446iaaE+0x64): error: undefined reference to '__tls_get_addr'\ncollect2: ld returned 1 exit status\n\nerror: aborting due to previous error\n```\n\nThe key part of the error I think being: `undefined reference to '__tls_get_addr'`. This seems quite similar to https://github.com/rust-lang/rust/issues/10842! We could take two courses of action here:\n1. Raise the minimum required android version. This would require figuring out precisely what version of android enabled `#[thread_local]` globals and making the decision from there (I know very little about android).\n2. Implement the fallback path\n\nI suspect the sub-question in in route 1 will give us more information and will help guide this decision. @thestinger, would you be ok figuring out what the minimum version of android is to implement TLS in this fashion?\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/58767811/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/58768083",
    "html_url": "https://github.com/rust-lang/rust/pull/17583#issuecomment-58768083",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/17583",
    "id": 58768083,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU4NzY4MDgz",
    "user": {
      "login": "thestinger",
      "id": 1505226,
      "node_id": "MDQ6VXNlcjE1MDUyMjY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1505226?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/thestinger",
      "html_url": "https://github.com/thestinger",
      "followers_url": "https://api.github.com/users/thestinger/followers",
      "following_url": "https://api.github.com/users/thestinger/following{/other_user}",
      "gists_url": "https://api.github.com/users/thestinger/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/thestinger/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/thestinger/subscriptions",
      "organizations_url": "https://api.github.com/users/thestinger/orgs",
      "repos_url": "https://api.github.com/users/thestinger/repos",
      "events_url": "https://api.github.com/users/thestinger/events{/privacy}",
      "received_events_url": "https://api.github.com/users/thestinger/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-10-11T23:24:26Z",
    "updated_at": "2014-10-11T23:24:26Z",
    "body": "@wycats: I didn't reply to his comments, I was replying to you.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/58768083/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/58768123",
    "html_url": "https://github.com/rust-lang/rust/pull/17583#issuecomment-58768123",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/17583",
    "id": 58768123,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU4NzY4MTIz",
    "user": {
      "login": "thestinger",
      "id": 1505226,
      "node_id": "MDQ6VXNlcjE1MDUyMjY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1505226?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/thestinger",
      "html_url": "https://github.com/thestinger",
      "followers_url": "https://api.github.com/users/thestinger/followers",
      "following_url": "https://api.github.com/users/thestinger/following{/other_user}",
      "gists_url": "https://api.github.com/users/thestinger/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/thestinger/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/thestinger/subscriptions",
      "organizations_url": "https://api.github.com/users/thestinger/orgs",
      "repos_url": "https://api.github.com/users/thestinger/repos",
      "events_url": "https://api.github.com/users/thestinger/events{/privacy}",
      "received_events_url": "https://api.github.com/users/thestinger/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-10-11T23:26:18Z",
    "updated_at": "2014-10-11T23:26:18Z",
    "body": "> I'd like to point out again that as part of library stabilization we're trying to cut down on the surface area of the standard distribution. I, however, also believe that everyone is in alignment that we'd like to have a nice TLS implementation.\n\nIt's far smaller than the surface area of the existing TLS implementation and will be able to replace it. It needs support for destructors to replace it and that's a bit tricky to do correctly - the existing implementation does it unsoundly. It deserves to be landed separately, and then there will be platform-specific optimizations to leverage features like `_tlv_atexit` on OS X that were added for C++11 support. This will certainly require compiler support because it's not currently possible to detect these features.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/58768123/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/58768141",
    "html_url": "https://github.com/rust-lang/rust/pull/17583#issuecomment-58768141",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/17583",
    "id": 58768141,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU4NzY4MTQx",
    "user": {
      "login": "thestinger",
      "id": 1505226,
      "node_id": "MDQ6VXNlcjE1MDUyMjY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1505226?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/thestinger",
      "html_url": "https://github.com/thestinger",
      "followers_url": "https://api.github.com/users/thestinger/followers",
      "following_url": "https://api.github.com/users/thestinger/following{/other_user}",
      "gists_url": "https://api.github.com/users/thestinger/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/thestinger/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/thestinger/subscriptions",
      "organizations_url": "https://api.github.com/users/thestinger/orgs",
      "repos_url": "https://api.github.com/users/thestinger/repos",
      "events_url": "https://api.github.com/users/thestinger/events{/privacy}",
      "received_events_url": "https://api.github.com/users/thestinger/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-10-11T23:27:31Z",
    "updated_at": "2014-10-11T23:27:31Z",
    "body": "> I would also like to point out that there is nothing stopping this from being a cargo package which could be quickly iterated on. The benefit of being a cargo package is also that quicker iteration is allowed (bors isn't exactly speedy), versioning is independent from Rust itself, and other implementations can have more interoperability. The downsides, of course, of being a cargo package are that it is not updated automatically when breaking changes are made and discoverability is currently difficult. The breaking changes part will alleviate as Rust becomes more stable, and the discoverability will alleviate once we have a central Registry (working quite hard on it right now!).\n\nTLS is used within the standard libraries (task-local RNG) and compiler. A replacement of the old TLS implementation needs to be done in-tree.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/58768141/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/58768196",
    "html_url": "https://github.com/rust-lang/rust/pull/17583#issuecomment-58768196",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/17583",
    "id": 58768196,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU4NzY4MTk2",
    "user": {
      "login": "thestinger",
      "id": 1505226,
      "node_id": "MDQ6VXNlcjE1MDUyMjY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1505226?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/thestinger",
      "html_url": "https://github.com/thestinger",
      "followers_url": "https://api.github.com/users/thestinger/followers",
      "following_url": "https://api.github.com/users/thestinger/following{/other_user}",
      "gists_url": "https://api.github.com/users/thestinger/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/thestinger/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/thestinger/subscriptions",
      "organizations_url": "https://api.github.com/users/thestinger/orgs",
      "repos_url": "https://api.github.com/users/thestinger/repos",
      "events_url": "https://api.github.com/users/thestinger/events{/privacy}",
      "received_events_url": "https://api.github.com/users/thestinger/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-10-11T23:29:57Z",
    "updated_at": "2014-10-11T23:29:57Z",
    "body": "> I'm not saying that this shouldn't be in the standard distribution, I'd just like to point out that this implementation is not dead in the water if we don't merge it at this time.\n\nIt's already in the standard distribution as `local_data_key!`, `local_ptr` and more. It's a replacement of the old implementation as part of removing the dynamic runtime and fixing unsoundness / performance issues, not a new feature.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/58768196/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/58768211",
    "html_url": "https://github.com/rust-lang/rust/pull/17583#issuecomment-58768211",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/17583",
    "id": 58768211,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU4NzY4MjEx",
    "user": {
      "login": "thestinger",
      "id": 1505226,
      "node_id": "MDQ6VXNlcjE1MDUyMjY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1505226?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/thestinger",
      "html_url": "https://github.com/thestinger",
      "followers_url": "https://api.github.com/users/thestinger/followers",
      "following_url": "https://api.github.com/users/thestinger/following{/other_user}",
      "gists_url": "https://api.github.com/users/thestinger/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/thestinger/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/thestinger/subscriptions",
      "organizations_url": "https://api.github.com/users/thestinger/orgs",
      "repos_url": "https://api.github.com/users/thestinger/repos",
      "events_url": "https://api.github.com/users/thestinger/events{/privacy}",
      "received_events_url": "https://api.github.com/users/thestinger/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-10-11T23:30:29Z",
    "updated_at": "2014-10-11T23:30:29Z",
    "body": "> Specifically speaking, I don't think any of my concerns have been addressed, I'll reiterate them below for clarity. I hope this answers your question about what is blocking this PR.\n\nI did address your concerns. Perhaps you weren't satisfied with the replies, but I'm not convinced that these are serious / blocking issues.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/58768211/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/58768273",
    "html_url": "https://github.com/rust-lang/rust/pull/17583#issuecomment-58768273",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/17583",
    "id": 58768273,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU4NzY4Mjcz",
    "user": {
      "login": "thestinger",
      "id": 1505226,
      "node_id": "MDQ6VXNlcjE1MDUyMjY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1505226?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/thestinger",
      "html_url": "https://github.com/thestinger",
      "followers_url": "https://api.github.com/users/thestinger/followers",
      "following_url": "https://api.github.com/users/thestinger/following{/other_user}",
      "gists_url": "https://api.github.com/users/thestinger/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/thestinger/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/thestinger/subscriptions",
      "organizations_url": "https://api.github.com/users/thestinger/orgs",
      "repos_url": "https://api.github.com/users/thestinger/repos",
      "events_url": "https://api.github.com/users/thestinger/events{/privacy}",
      "received_events_url": "https://api.github.com/users/thestinger/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-10-11T23:33:13Z",
    "updated_at": "2014-10-11T23:33:13Z",
    "body": "> Leveraging macros for generating the entire implementation\n\nThere isn't a proposed alternative with the same flexibility and performance. Using macros makes it possible to sanely support destructors and implement a fallback path. It's an `#[experimental]` API meant to be a step towards replacing the old TLS implementation, not a finalized / stable API based on lessons learned during implementation and usage.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/58768273/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/58768347",
    "html_url": "https://github.com/rust-lang/rust/pull/17583#issuecomment-58768347",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/17583",
    "id": 58768347,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU4NzY4MzQ3",
    "user": {
      "login": "thestinger",
      "id": 1505226,
      "node_id": "MDQ6VXNlcjE1MDUyMjY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1505226?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/thestinger",
      "html_url": "https://github.com/thestinger",
      "followers_url": "https://api.github.com/users/thestinger/followers",
      "following_url": "https://api.github.com/users/thestinger/following{/other_user}",
      "gists_url": "https://api.github.com/users/thestinger/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/thestinger/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/thestinger/subscriptions",
      "organizations_url": "https://api.github.com/users/thestinger/orgs",
      "repos_url": "https://api.github.com/users/thestinger/repos",
      "events_url": "https://api.github.com/users/thestinger/events{/privacy}",
      "received_events_url": "https://api.github.com/users/thestinger/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-10-11T23:37:04Z",
    "updated_at": "2014-10-11T23:37:04Z",
    "body": "> Incorrect casting\n\nI guess you weren't satisfied with my answer? As I pointed out, this is not incorrect with the current implementation of the compiler. It would not be incorrect if fields were reordered based on size and aligned. It's a workaround that's used throughout the standard libraries already and I think it would be unreasonable to change the compiler implementation in a way that would prevent working around issues like the inability to statically initialize a `RefCell`.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/58768347/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/58768479",
    "html_url": "https://github.com/rust-lang/rust/pull/17583#issuecomment-58768479",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/17583",
    "id": 58768479,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU4NzY4NDc5",
    "user": {
      "login": "thestinger",
      "id": 1505226,
      "node_id": "MDQ6VXNlcjE1MDUyMjY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1505226?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/thestinger",
      "html_url": "https://github.com/thestinger",
      "followers_url": "https://api.github.com/users/thestinger/followers",
      "following_url": "https://api.github.com/users/thestinger/following{/other_user}",
      "gists_url": "https://api.github.com/users/thestinger/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/thestinger/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/thestinger/subscriptions",
      "organizations_url": "https://api.github.com/users/thestinger/orgs",
      "repos_url": "https://api.github.com/users/thestinger/repos",
      "events_url": "https://api.github.com/users/thestinger/events{/privacy}",
      "received_events_url": "https://api.github.com/users/thestinger/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-10-11T23:42:37Z",
    "updated_at": "2014-10-11T23:42:37Z",
    "body": "> Inconsistency with existing statics today\n\nThe ultimate solution is a fully working `#[thread_local]`. It's provided by C, C++, D and other systems languages that Rust is competing with. It's a stopgap until that is possible (if it ever is) and could be reimplemented on top of it. You've proposed possible improvements but you need to take the destructor handling and other issues like efficiency into account. It's not possible to do things like creating an uninitialized global variable or statically initializing types from other modules with private fields so workarounds are necessary.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/58768479/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/58768572",
    "html_url": "https://github.com/rust-lang/rust/pull/17583#issuecomment-58768572",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/17583",
    "id": 58768572,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU4NzY4NTcy",
    "user": {
      "login": "thestinger",
      "id": 1505226,
      "node_id": "MDQ6VXNlcjE1MDUyMjY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1505226?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/thestinger",
      "html_url": "https://github.com/thestinger",
      "followers_url": "https://api.github.com/users/thestinger/followers",
      "following_url": "https://api.github.com/users/thestinger/following{/other_user}",
      "gists_url": "https://api.github.com/users/thestinger/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/thestinger/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/thestinger/subscriptions",
      "organizations_url": "https://api.github.com/users/thestinger/orgs",
      "repos_url": "https://api.github.com/users/thestinger/repos",
      "events_url": "https://api.github.com/users/thestinger/events{/privacy}",
      "received_events_url": "https://api.github.com/users/thestinger/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-10-11T23:47:39Z",
    "updated_at": "2014-10-11T23:47:39Z",
    "body": "> If there are technical problems blocking this goal, then those seem like challenges to overcome rather than to start officially supporting an API we would just wish to change later. Note that this is also precisely where a Cargo package helps because the package could have an entirely separate interface and be slowly deprecated over time if language changes elsewhere enable a better API.\n\nThere is already a TLS implementation in-tree and it needs to be replaced. It would be better to stabilize this API than the one we already have that's unsound and incredibly slow. However, this is explicitly marked as `#[experimental]` and I have stated that it is not the finalized API but rather a base to build on in the subsequent pull requests I already have lined up. I have destructor support and other improvements ready but it's too difficult to land it all at once.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/58768572/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/58768626",
    "html_url": "https://github.com/rust-lang/rust/pull/17583#issuecomment-58768626",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/17583",
    "id": 58768626,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU4NzY4NjI2",
    "user": {
      "login": "thestinger",
      "id": 1505226,
      "node_id": "MDQ6VXNlcjE1MDUyMjY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1505226?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/thestinger",
      "html_url": "https://github.com/thestinger",
      "followers_url": "https://api.github.com/users/thestinger/followers",
      "following_url": "https://api.github.com/users/thestinger/following{/other_user}",
      "gists_url": "https://api.github.com/users/thestinger/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/thestinger/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/thestinger/subscriptions",
      "organizations_url": "https://api.github.com/users/thestinger/orgs",
      "repos_url": "https://api.github.com/users/thestinger/repos",
      "events_url": "https://api.github.com/users/thestinger/events{/privacy}",
      "received_events_url": "https://api.github.com/users/thestinger/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-10-11T23:49:58Z",
    "updated_at": "2014-10-11T23:49:58Z",
    "body": "> This does not allow dynamic initialization or construction. Note, however, that this is consistent with the rest of Rust globals today. It is certainly an extension that can be added in the future, but I think we should add it to both static and thread local globals at the same time. Singling one out as special seems odd.\n\nTLS needs support for dynamic initialization and destruction to be usable. It is completely unrelated to those features in globals because the implementation and semantics are _much_ different. There are no safety or ordering issues with it. It is **required** to replace the current TLS implementation _which already supports those features_. Why are my pull requests singled out for the application of all of these strict double standards?\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/58768626/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/58769045",
    "html_url": "https://github.com/rust-lang/rust/pull/17583#issuecomment-58769045",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/17583",
    "id": 58769045,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU4NzY5MDQ1",
    "user": {
      "login": "thestinger",
      "id": 1505226,
      "node_id": "MDQ6VXNlcjE1MDUyMjY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1505226?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/thestinger",
      "html_url": "https://github.com/thestinger",
      "followers_url": "https://api.github.com/users/thestinger/followers",
      "following_url": "https://api.github.com/users/thestinger/following{/other_user}",
      "gists_url": "https://api.github.com/users/thestinger/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/thestinger/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/thestinger/subscriptions",
      "organizations_url": "https://api.github.com/users/thestinger/orgs",
      "repos_url": "https://api.github.com/users/thestinger/repos",
      "events_url": "https://api.github.com/users/thestinger/events{/privacy}",
      "received_events_url": "https://api.github.com/users/thestinger/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-10-12T00:10:28Z",
    "updated_at": "2014-10-12T00:10:28Z",
    "body": "> In general I would like to reiterate that no one doesn't want a good TLS interface. The practice which we've been encouraging for new functionality in the standard library is for it to be developed out of tree, and then migrate it in-tree if possible. This helps us promote faster iteration of libraries such as this along with reducing the surface area of the standard library that needs to be stable for 1.0 (which is quite soon!).\n\nTLS is already a feature that's in-tree and replacing the implementation was accepted in an RFC. I went ahead with a simplistic initial implementation to iterate on in-tree because I had already put substantial thought and effort into it. The surface area claim doesn't make any sense because it's going to replace a _far larger_ unsound TLS implementation.\n\nThe API is marked `#[experimental]` and I've explicitly stated that there are improvements I want to make to this after it lands. It's the base I am going to build on in the follow-up commits I had lined up to submit after this landed (destructor support, portability to old Android).\n\nMost possible improvements are blocked on fixing compiler bugs and compiler / language limitations such as the lack of a way to make an uninitialized global variable, inability to store a type with a destructor _directly_ in a `static mut` (calling the destructor is unnecessary, just allowing `Option<T>` initialized to `None` where `T` has a destructor) and various other issues.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/58769045/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/58769134",
    "html_url": "https://github.com/rust-lang/rust/pull/17583#issuecomment-58769134",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/17583",
    "id": 58769134,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU4NzY5MTM0",
    "user": {
      "login": "thestinger",
      "id": 1505226,
      "node_id": "MDQ6VXNlcjE1MDUyMjY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1505226?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/thestinger",
      "html_url": "https://github.com/thestinger",
      "followers_url": "https://api.github.com/users/thestinger/followers",
      "following_url": "https://api.github.com/users/thestinger/following{/other_user}",
      "gists_url": "https://api.github.com/users/thestinger/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/thestinger/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/thestinger/subscriptions",
      "organizations_url": "https://api.github.com/users/thestinger/orgs",
      "repos_url": "https://api.github.com/users/thestinger/repos",
      "events_url": "https://api.github.com/users/thestinger/events{/privacy}",
      "received_events_url": "https://api.github.com/users/thestinger/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-10-12T00:15:11Z",
    "updated_at": "2014-10-12T00:15:59Z",
    "body": "> @thestinger I know we've had trouble with #[thread_local] in the past on windows, so I tested this locally with the most recently night. A smoke test (thread local static mut, just prints it), ran fine on 64-bit windows, but it segfaulted on 32-bit windows. Did you verify both architectures? If so, perhaps my install of msys/msys2 is broken? If we need to tweak our mingw/msys requirements that's probably fine, but we just need to be prepared to do so ahead of time.\n\nI identified the problem on Windows and fixed it in 6bb648fadcc946f7cbce4644c0a7daa73fc0dab8. The problem was just that the MinGW-w64 linker's implementation of ASLR is thoroughly broken. It seems to work fine on 32-bit too...\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/58769134/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/58770763",
    "html_url": "https://github.com/rust-lang/rust/pull/17583#issuecomment-58770763",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/17583",
    "id": 58770763,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU4NzcwNzYz",
    "user": {
      "login": "thestinger",
      "id": 1505226,
      "node_id": "MDQ6VXNlcjE1MDUyMjY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1505226?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/thestinger",
      "html_url": "https://github.com/thestinger",
      "followers_url": "https://api.github.com/users/thestinger/followers",
      "following_url": "https://api.github.com/users/thestinger/following{/other_user}",
      "gists_url": "https://api.github.com/users/thestinger/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/thestinger/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/thestinger/subscriptions",
      "organizations_url": "https://api.github.com/users/thestinger/orgs",
      "repos_url": "https://api.github.com/users/thestinger/repos",
      "events_url": "https://api.github.com/users/thestinger/events{/privacy}",
      "received_events_url": "https://api.github.com/users/thestinger/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-10-12T01:46:49Z",
    "updated_at": "2014-10-12T01:48:07Z",
    "body": "@alexcrichton: I don't know which version of Android started having working TLS. I do know that the `__tls_get_addr` problem would be solved for TLS in executables and static libraries by telling LLVM when we are building an executable. It is not currently possible because the existing TLS implementation and libgreen depend on undefined behaviour that's broken by the optimizations LLVM uses when it's informed of that. If the existing TLS implementation was removed, my pull request changing that could land and you wouldn't get that error.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/58770763/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/58885577",
    "html_url": "https://github.com/rust-lang/rust/pull/17583#issuecomment-58885577",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/17583",
    "id": 58885577,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU4ODg1NTc3",
    "user": {
      "login": "thestinger",
      "id": 1505226,
      "node_id": "MDQ6VXNlcjE1MDUyMjY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1505226?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/thestinger",
      "html_url": "https://github.com/thestinger",
      "followers_url": "https://api.github.com/users/thestinger/followers",
      "following_url": "https://api.github.com/users/thestinger/following{/other_user}",
      "gists_url": "https://api.github.com/users/thestinger/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/thestinger/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/thestinger/subscriptions",
      "organizations_url": "https://api.github.com/users/thestinger/orgs",
      "repos_url": "https://api.github.com/users/thestinger/repos",
      "events_url": "https://api.github.com/users/thestinger/events{/privacy}",
      "received_events_url": "https://api.github.com/users/thestinger/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-10-13T12:34:13Z",
    "updated_at": "2014-10-13T12:34:25Z",
    "body": "@alexcrichton: `__tls_get_addr` is now limited dynamically linked Rust libraries. We could easily provide an implementation on top of POSIX TLS in that case for old versions of Android and legacy 32-bit iOS. AFAIK, `#[thread_local]` with static linking will now work even on old versions of Android.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/58885577/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/58891539",
    "html_url": "https://github.com/rust-lang/rust/pull/17583#issuecomment-58891539",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/17583",
    "id": 58891539,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU4ODkxNTM5",
    "user": {
      "login": "thestinger",
      "id": 1505226,
      "node_id": "MDQ6VXNlcjE1MDUyMjY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1505226?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/thestinger",
      "html_url": "https://github.com/thestinger",
      "followers_url": "https://api.github.com/users/thestinger/followers",
      "following_url": "https://api.github.com/users/thestinger/following{/other_user}",
      "gists_url": "https://api.github.com/users/thestinger/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/thestinger/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/thestinger/subscriptions",
      "organizations_url": "https://api.github.com/users/thestinger/orgs",
      "repos_url": "https://api.github.com/users/thestinger/repos",
      "events_url": "https://api.github.com/users/thestinger/events{/privacy}",
      "received_events_url": "https://api.github.com/users/thestinger/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-10-13T13:27:35Z",
    "updated_at": "2014-10-13T13:27:35Z",
    "body": "Closing for now. I've filed #18004 about this and will submit the same changes in a different order than I planned.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/58891539/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/58909778",
    "html_url": "https://github.com/rust-lang/rust/pull/17583#issuecomment-58909778",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/17583",
    "id": 58909778,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU4OTA5Nzc4",
    "user": {
      "login": "alexcrichton",
      "id": 64996,
      "node_id": "MDQ6VXNlcjY0OTk2",
      "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alexcrichton",
      "html_url": "https://github.com/alexcrichton",
      "followers_url": "https://api.github.com/users/alexcrichton/followers",
      "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}",
      "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions",
      "organizations_url": "https://api.github.com/users/alexcrichton/orgs",
      "repos_url": "https://api.github.com/users/alexcrichton/repos",
      "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alexcrichton/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-10-13T15:35:31Z",
    "updated_at": "2014-10-13T15:35:31Z",
    "body": "> It's far smaller than the surface area of the existing TLS implementation and will be able to replace it.\n\nI'd love to be able to replace the current `std::local_data`! I wouldn't exactly classify the API as large though, it's largely just a macro and two functions (replace/get).\n\n> It needs support for destructors to replace it and that's a bit tricky to do correctly.\n\nI agree! We may be able to get by without implementing destructor support, however, by using the scoped-approach that we laid out in the work week. The \"unsafe building block\" could serve as the foundation for that strategy of TLS. The compiler is essentially entirely scoped, and the other major use case I know about is the task-local RNG which could probably be implemented specially.\n\n>  the existing implementation does it unsoundly\n\nThat's not good! Can you open a bug on this?\n\n> There isn't a proposed alternative with the same flexibility and performance.\n\nCan you explain to me why you didn't think my example would provide either the flexibility or performance?\n\n> I guess you weren't satisfied with my answer? As I pointed out, this is not incorrect with the current implementation of the compiler.\n\nI didn't really see \"it's not a worry\" as an answer to the _fact_ that struct layout is undefined. We are reserving the right to reorder struct fields at will, not only for performance but perhaps randomly for security. Today a `Vec` is also three words, but we're also not encouraging transmuting from a `Vec` to three words and back. It was tough for me to see how we could _not_ rely the field orderings of the two structs being the same, so I was worried about coming to rely on this fact and being unable to pursue various optimizations in the future with struct field orderings.\n\n> You've proposed possible improvements but you need to take the destructor handling and other issues like efficiency into account\n\nCan you explain a little more about how a bare-bones layer over `#[thread_local]` and os-based TLS wouldn't provide the ability to support constructors/destructors in the future? I would expect this bare-bones layer to be present in basically any cross-platform implementation, so putting it at the base of the stack seems natural to me.\n\nCould you also explain how the example I gave was less efficient than the module-expansions you proposed here? I was under the impression that it's just a few pointers lying around and would optimize away completely.\n\n> However, this is explicitly marked as `#[experimental]` and I have stated that it is not the finalized API but rather a base to build on in the subsequent pull requests I already have lined up\n\nI'd like to note that while I personally do not feel that `#[experimental]` is the threshold for accepting code to std, others may feel differently. I'm just expressing my own personal opinion, I don't speak for everyone as a whole.\n\n> TLS needs support for dynamic initialization and destruction to be usable.\n\nRemember though that I'm not proposing an end-all be-all interface, this was just the bare bones interface to the rest of the TLS subsystem, it's likely that other abstractions, such as those with dynamic initialization/destruction are built on top.\n\n> It is required to replace the current TLS implementation which already supports those features.\n\nI do agree that to be a drop-in replacement it needs to support these features, but I think we may be able to get by with some unsafe code perhaps in the meantime and scoped TLS (which doesn't require dynamics). Long term, we definitely need to support this though!\n\n> Why are my pull requests singled out for the application of all of these strict double standards?\n\nI'm sorry you feel this way, and I apologize if any of my comments have led you to believe this. It is certainly not what I intended to convey. I may be a little more nitpickity at reviews, but I do not at all intend to single you out and apply a double standard.\n\n> It's the base I am going to build on in the follow-up commits I had lined up to submit after this landed (destructor support, portability to old Android).\n\nCurrently almost everything we provide in the standard distribution, apart from `liblibc`, is cross-platform, so I would consider the portability fallback to be required for a first-pass implementation.\n\n> inability to store a type with a destructor directly in a static mut (calling the destructor is unnecessary, just allowing Option<T> initialized to None where T has a destructor) and various other issues.\n\nCould you elaborate some more on these issues? Currently this code compiles:\n\n``` rust\nstatic FOO: Option<Box<int>> = None;\n\nfn main() {}\n```\n\n> I identified the problem on Windows and fixed it in 6bb648f. The problem was just that the MinGW-w64 linker's implementation of ASLR is thoroughly broken. It seems to work fine on 32-bit too...\n\nI think Saturday's nightly (the one I tested) had that commit. Have you tested recently on 32-bit? \n\n> Closing for now. I've filed #18004 about this and will submit the same changes in a different order than I planned.\n\nOk, I'm also fine if you want to leave this open! I wanted to talk more with others about this today and get their thoughts on this approach.\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/58909778/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/58910157",
    "html_url": "https://github.com/rust-lang/rust/pull/17583#issuecomment-58910157",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/17583",
    "id": 58910157,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU4OTEwMTU3",
    "user": {
      "login": "thestinger",
      "id": 1505226,
      "node_id": "MDQ6VXNlcjE1MDUyMjY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1505226?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/thestinger",
      "html_url": "https://github.com/thestinger",
      "followers_url": "https://api.github.com/users/thestinger/followers",
      "following_url": "https://api.github.com/users/thestinger/following{/other_user}",
      "gists_url": "https://api.github.com/users/thestinger/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/thestinger/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/thestinger/subscriptions",
      "organizations_url": "https://api.github.com/users/thestinger/orgs",
      "repos_url": "https://api.github.com/users/thestinger/repos",
      "events_url": "https://api.github.com/users/thestinger/events{/privacy}",
      "received_events_url": "https://api.github.com/users/thestinger/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-10-13T15:38:22Z",
    "updated_at": "2014-10-13T15:38:38Z",
    "body": "@alexcrichton: I'll start with an `unsafe` API providing a portable fallback for `#[thread_local]`.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/58910157/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/59155677",
    "html_url": "https://github.com/rust-lang/rust/pull/17583#issuecomment-59155677",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/17583",
    "id": 59155677,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU5MTU1Njc3",
    "user": {
      "login": "joakim-noah",
      "id": 5930876,
      "node_id": "MDQ6VXNlcjU5MzA4NzY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5930876?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/joakim-noah",
      "html_url": "https://github.com/joakim-noah",
      "followers_url": "https://api.github.com/users/joakim-noah/followers",
      "following_url": "https://api.github.com/users/joakim-noah/following{/other_user}",
      "gists_url": "https://api.github.com/users/joakim-noah/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/joakim-noah/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/joakim-noah/subscriptions",
      "organizations_url": "https://api.github.com/users/joakim-noah/orgs",
      "repos_url": "https://api.github.com/users/joakim-noah/repos",
      "events_url": "https://api.github.com/users/joakim-noah/events{/privacy}",
      "received_events_url": "https://api.github.com/users/joakim-noah/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-10-15T04:15:25Z",
    "updated_at": "2014-10-15T04:15:25Z",
    "body": "> Android does actually support static TLS and I've verified that C++11 thread_local works on the tablet I have access to (Android 4.4.4).\n\nHello, I was curious about the state of rust on Android and I stumbled across this thread.  Since D was mentioned earlier, I've been working on getting D on Android, hence my interest. :)\n\n@thestinger, I don't believe Android supports native TLS for apps even today.  [They're still storing the pointers for bionic's pthread TLS implementation in native TLS](https://android.googlesource.com/platform/bionic/+/l-preview/libc/bionic/pthread_key.cpp), so that's going to write over any data that apps put in there.  It is true that purely static TLS without any relocations will sometimes randomly work, which is why it might have worked for you when doing small tests with C++, but when I went over 4K in TLS data on Android/x86 it started to break.  That's because they did not take native TLS support for C/C++ out of their lightly patched gcc/clang/binutils/gold native toolchain in the NDK, but it's unsupported by bionic and the dynamic linker so native TLS won't work beyond such random corner cases.  I had to wrap `pthread_getspecific/setspecific` to get TLS to work for D, sounds like you have a similar fallback in mind.\n",
    "author_association": "NONE",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/59155677/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
