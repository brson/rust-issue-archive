[
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/20753055",
    "html_url": "https://github.com/rust-lang/rust/issues/7694#issuecomment-20753055",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/7694",
    "id": 20753055,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIwNzUzMDU1",
    "user": {
      "login": "thestinger",
      "id": 1505226,
      "node_id": "MDQ6VXNlcjE1MDUyMjY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1505226?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/thestinger",
      "html_url": "https://github.com/thestinger",
      "followers_url": "https://api.github.com/users/thestinger/followers",
      "following_url": "https://api.github.com/users/thestinger/following{/other_user}",
      "gists_url": "https://api.github.com/users/thestinger/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/thestinger/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/thestinger/subscriptions",
      "organizations_url": "https://api.github.com/users/thestinger/orgs",
      "repos_url": "https://api.github.com/users/thestinger/repos",
      "events_url": "https://api.github.com/users/thestinger/events{/privacy}",
      "received_events_url": "https://api.github.com/users/thestinger/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2013-07-10T16:05:28Z",
    "updated_at": "2013-07-10T16:07:04Z",
    "body": "I don't really see how it could be unsafe, because you can already create arbitrary dangling raw pointers from integers. Any interface taking a raw pointer and then dereferencing it at some point has to be marked `unsafe`.\n\nThe `CStr2` interface is unsafe because you can pass a dangling pointer in to `new_with_ownership` and it will call `free` on it.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/20753055/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/20758088",
    "html_url": "https://github.com/rust-lang/rust/issues/7694#issuecomment-20758088",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/7694",
    "id": 20758088,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIwNzU4MDg4",
    "user": {
      "login": "erickt",
      "id": 84711,
      "node_id": "MDQ6VXNlcjg0NzEx",
      "avatar_url": "https://avatars.githubusercontent.com/u/84711?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/erickt",
      "html_url": "https://github.com/erickt",
      "followers_url": "https://api.github.com/users/erickt/followers",
      "following_url": "https://api.github.com/users/erickt/following{/other_user}",
      "gists_url": "https://api.github.com/users/erickt/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/erickt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/erickt/subscriptions",
      "organizations_url": "https://api.github.com/users/erickt/orgs",
      "repos_url": "https://api.github.com/users/erickt/repos",
      "events_url": "https://api.github.com/users/erickt/events{/privacy}",
      "received_events_url": "https://api.github.com/users/erickt/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2013-07-10T17:18:09Z",
    "updated_at": "2013-07-10T17:31:06Z",
    "body": "@thestinger: I've updated my [gist](https://gist.github.com/erickt/5967320) to make the `CStr2` simpler and safe because it's not dealing with a dangling pointer. None of the functions are unsafe, but we still end up passing `baz` a dangling pointer.\n\nYes, the unsafe pointer is unsafe, and you need to be in an unsafe block to dereference it or pass it to a C function, but I don't think that means we should turn off all the safety features of Rust when in an unsafe block. If we can prevent this dangling pointer being created, I feel we should even in unsafe blocks. I'd rather force people to use `cast::transmute()` when they really know better than the borrow checker.\n\nSo my vote right now is that we:\n- Allow regions to be placed on a `*T` pointer.\n- Remove the ability to auto-coerce from `&'a T` to `*T`, but instead auto-coerce to `*'a T`.\n- Force users to use `cast::transmute()` to forget the region in `*'a T`.\n\nedit: I submitted this early and incomplete by accident.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/20758088/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/20764746",
    "html_url": "https://github.com/rust-lang/rust/issues/7694#issuecomment-20764746",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/7694",
    "id": 20764746,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIwNzY0NzQ2",
    "user": {
      "login": "nikomatsakis",
      "id": 155238,
      "node_id": "MDQ6VXNlcjE1NTIzOA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/155238?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nikomatsakis",
      "html_url": "https://github.com/nikomatsakis",
      "followers_url": "https://api.github.com/users/nikomatsakis/followers",
      "following_url": "https://api.github.com/users/nikomatsakis/following{/other_user}",
      "gists_url": "https://api.github.com/users/nikomatsakis/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nikomatsakis/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nikomatsakis/subscriptions",
      "organizations_url": "https://api.github.com/users/nikomatsakis/orgs",
      "repos_url": "https://api.github.com/users/nikomatsakis/repos",
      "events_url": "https://api.github.com/users/nikomatsakis/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nikomatsakis/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2013-07-10T18:58:09Z",
    "updated_at": "2013-07-10T18:58:09Z",
    "body": "I don't quite see the point of `*'a T`. How is this different from `&'a T`? It feels like the proper thing is to wrap the various C functions you want to expose so that they take `&'a T`. \n\nAlso, I think that the current \"rules\" regarding the lifetime of temporaries are too short, which makes it easier to footgun in examples like this one. All temporaries ought to live at least as love as the current statement, I think, what's unclear to me is if we should possibly infer a longer lifetime. (#3511)\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/20764746/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/20770569",
    "html_url": "https://github.com/rust-lang/rust/issues/7694#issuecomment-20770569",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/7694",
    "id": 20770569,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIwNzcwNTY5",
    "user": {
      "login": "erickt",
      "id": 84711,
      "node_id": "MDQ6VXNlcjg0NzEx",
      "avatar_url": "https://avatars.githubusercontent.com/u/84711?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/erickt",
      "html_url": "https://github.com/erickt",
      "followers_url": "https://api.github.com/users/erickt/followers",
      "following_url": "https://api.github.com/users/erickt/following{/other_user}",
      "gists_url": "https://api.github.com/users/erickt/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/erickt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/erickt/subscriptions",
      "organizations_url": "https://api.github.com/users/erickt/orgs",
      "repos_url": "https://api.github.com/users/erickt/repos",
      "events_url": "https://api.github.com/users/erickt/events{/privacy}",
      "received_events_url": "https://api.github.com/users/erickt/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2013-07-10T20:26:56Z",
    "updated_at": "2013-07-10T20:26:56Z",
    "body": "@nikomatsakis: We still have a footgun even if we make temporaries live to the end of the current statement. For example, if we take my gist and set main to:\n\n```\nfn main() {\n    let dangling_ptr: *u8 = CStr2::new(5).as_ref();\n    std::io::println(fmt!(\"here: %?\", dangling_ptr));\n}\n```\n\nEven if that temporary lives as long as the statement we'll still have a dangling pointer because of the auto-coercion from a `&int` to a `*int`.\n\nAs far as I know, there are two main differences between a `&T` and a `*T`. First, if it's safe do dereference the pointer. Or expressed another way, `*T` may be null, whereas `&T` should never be null. Second, if a pointer survives past the destruction of value it's pointing at. I don't see much value of that second property. Sure, once we pass that pointer to C a whole host of dumb things can happen to it, but up until we do pass it to C I'd like as much assistance as possible from Rust to protect me from myself, and only allow me to shoot myself in the foot if I explicitly ask to convert a `*'a T` to a `*T` with a `cast::transmute()` or something.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/20770569/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/20773914",
    "html_url": "https://github.com/rust-lang/rust/issues/7694#issuecomment-20773914",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/7694",
    "id": 20773914,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIwNzczOTE0",
    "user": {
      "login": "nikomatsakis",
      "id": 155238,
      "node_id": "MDQ6VXNlcjE1NTIzOA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/155238?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nikomatsakis",
      "html_url": "https://github.com/nikomatsakis",
      "followers_url": "https://api.github.com/users/nikomatsakis/followers",
      "following_url": "https://api.github.com/users/nikomatsakis/following{/other_user}",
      "gists_url": "https://api.github.com/users/nikomatsakis/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nikomatsakis/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nikomatsakis/subscriptions",
      "organizations_url": "https://api.github.com/users/nikomatsakis/orgs",
      "repos_url": "https://api.github.com/users/nikomatsakis/repos",
      "events_url": "https://api.github.com/users/nikomatsakis/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nikomatsakis/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2013-07-10T21:15:21Z",
    "updated_at": "2013-07-10T21:15:21Z",
    "body": "@erickt I agree it's not foolproof, but I don't consider that example to be the same level of footgun. \n\nStill, having a lifetime associated with unsafe pointers might have value. \n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/20773914/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/35330543",
    "html_url": "https://github.com/rust-lang/rust/issues/7694#issuecomment-35330543",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/7694",
    "id": 35330543,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM1MzMwNTQz",
    "user": {
      "login": "emberian",
      "id": 704250,
      "node_id": "MDQ6VXNlcjcwNDI1MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/704250?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/emberian",
      "html_url": "https://github.com/emberian",
      "followers_url": "https://api.github.com/users/emberian/followers",
      "following_url": "https://api.github.com/users/emberian/following{/other_user}",
      "gists_url": "https://api.github.com/users/emberian/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/emberian/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/emberian/subscriptions",
      "organizations_url": "https://api.github.com/users/emberian/orgs",
      "repos_url": "https://api.github.com/users/emberian/repos",
      "events_url": "https://api.github.com/users/emberian/events{/privacy}",
      "received_events_url": "https://api.github.com/users/emberian/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-02-17T22:52:11Z",
    "updated_at": "2014-02-17T22:52:11Z",
    "body": "@erickt do you think this can be closed?\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/35330543/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/55121483",
    "html_url": "https://github.com/rust-lang/rust/issues/7694#issuecomment-55121483",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/7694",
    "id": 55121483,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU1MTIxNDgz",
    "user": {
      "login": "treeman",
      "id": 162027,
      "node_id": "MDQ6VXNlcjE2MjAyNw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/162027?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/treeman",
      "html_url": "https://github.com/treeman",
      "followers_url": "https://api.github.com/users/treeman/followers",
      "following_url": "https://api.github.com/users/treeman/following{/other_user}",
      "gists_url": "https://api.github.com/users/treeman/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/treeman/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/treeman/subscriptions",
      "organizations_url": "https://api.github.com/users/treeman/orgs",
      "repos_url": "https://api.github.com/users/treeman/repos",
      "events_url": "https://api.github.com/users/treeman/events{/privacy}",
      "received_events_url": "https://api.github.com/users/treeman/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-09-10T14:18:34Z",
    "updated_at": "2014-09-10T14:18:34Z",
    "body": "Triage bump. \n\n@erickt status?\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/55121483/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/55691667",
    "html_url": "https://github.com/rust-lang/rust/issues/7694#issuecomment-55691667",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/7694",
    "id": 55691667,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU1NjkxNjY3",
    "user": {
      "login": "thestinger",
      "id": 1505226,
      "node_id": "MDQ6VXNlcjE1MDUyMjY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1505226?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/thestinger",
      "html_url": "https://github.com/thestinger",
      "followers_url": "https://api.github.com/users/thestinger/followers",
      "following_url": "https://api.github.com/users/thestinger/following{/other_user}",
      "gists_url": "https://api.github.com/users/thestinger/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/thestinger/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/thestinger/subscriptions",
      "organizations_url": "https://api.github.com/users/thestinger/orgs",
      "repos_url": "https://api.github.com/users/thestinger/repos",
      "events_url": "https://api.github.com/users/thestinger/events{/privacy}",
      "received_events_url": "https://api.github.com/users/thestinger/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-09-16T03:49:07Z",
    "updated_at": "2014-09-16T03:49:07Z",
    "body": "It's not actually memory `unsafe` by Rust's definition. It's part of the normal `unsafe` model where creating raw pointers is allowed in safe code, since they can become dangling for various reasons at after creation _anyway_. A language change that's not strictly a bug fix would need to go through an RFC now.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/55691667/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/55691976",
    "html_url": "https://github.com/rust-lang/rust/issues/7694#issuecomment-55691976",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/7694",
    "id": 55691976,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU1NjkxOTc2",
    "user": {
      "login": "erickt",
      "id": 84711,
      "node_id": "MDQ6VXNlcjg0NzEx",
      "avatar_url": "https://avatars.githubusercontent.com/u/84711?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/erickt",
      "html_url": "https://github.com/erickt",
      "followers_url": "https://api.github.com/users/erickt/followers",
      "following_url": "https://api.github.com/users/erickt/following{/other_user}",
      "gists_url": "https://api.github.com/users/erickt/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/erickt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/erickt/subscriptions",
      "organizations_url": "https://api.github.com/users/erickt/orgs",
      "repos_url": "https://api.github.com/users/erickt/repos",
      "events_url": "https://api.github.com/users/erickt/events{/privacy}",
      "received_events_url": "https://api.github.com/users/erickt/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-09-16T03:56:00Z",
    "updated_at": "2014-09-16T03:56:00Z",
    "body": "@thestinger is right in remembering why I thought this ticket was closed a long time ago. This unsafety just needs to be well documented. \n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/55691976/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
