{
  "url": "https://api.github.com/repos/rust-lang/rust/issues/22200",
  "repository_url": "https://api.github.com/repos/rust-lang/rust",
  "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/22200/labels{/name}",
  "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/22200/comments",
  "events_url": "https://api.github.com/repos/rust-lang/rust/issues/22200/events",
  "html_url": "https://github.com/rust-lang/rust/pull/22200",
  "id": 57401629,
  "node_id": "MDExOlB1bGxSZXF1ZXN0MjkxNDM2NzU=",
  "number": 22200,
  "title": "std: Optimize Vec::from_iter",
  "user": {
    "login": "alexcrichton",
    "id": 64996,
    "node_id": "MDQ6VXNlcjY0OTk2",
    "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/alexcrichton",
    "html_url": "https://github.com/alexcrichton",
    "followers_url": "https://api.github.com/users/alexcrichton/followers",
    "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}",
    "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions",
    "organizations_url": "https://api.github.com/users/alexcrichton/orgs",
    "repos_url": "https://api.github.com/users/alexcrichton/repos",
    "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}",
    "received_events_url": "https://api.github.com/users/alexcrichton/received_events",
    "type": "User",
    "user_view_type": "public",
    "site_admin": false
  },
  "labels": [],
  "state": "closed",
  "locked": false,
  "assignee": {
    "login": "huonw",
    "id": 1203825,
    "node_id": "MDQ6VXNlcjEyMDM4MjU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1203825?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/huonw",
    "html_url": "https://github.com/huonw",
    "followers_url": "https://api.github.com/users/huonw/followers",
    "following_url": "https://api.github.com/users/huonw/following{/other_user}",
    "gists_url": "https://api.github.com/users/huonw/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/huonw/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/huonw/subscriptions",
    "organizations_url": "https://api.github.com/users/huonw/orgs",
    "repos_url": "https://api.github.com/users/huonw/repos",
    "events_url": "https://api.github.com/users/huonw/events{/privacy}",
    "received_events_url": "https://api.github.com/users/huonw/received_events",
    "type": "User",
    "user_view_type": "public",
    "site_admin": false
  },
  "assignees": [
    {
      "login": "huonw",
      "id": 1203825,
      "node_id": "MDQ6VXNlcjEyMDM4MjU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1203825?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/huonw",
      "html_url": "https://github.com/huonw",
      "followers_url": "https://api.github.com/users/huonw/followers",
      "following_url": "https://api.github.com/users/huonw/following{/other_user}",
      "gists_url": "https://api.github.com/users/huonw/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/huonw/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/huonw/subscriptions",
      "organizations_url": "https://api.github.com/users/huonw/orgs",
      "repos_url": "https://api.github.com/users/huonw/repos",
      "events_url": "https://api.github.com/users/huonw/events{/privacy}",
      "received_events_url": "https://api.github.com/users/huonw/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    }
  ],
  "milestone": null,
  "comments": 13,
  "created_at": "2015-02-12T00:50:25Z",
  "updated_at": "2015-02-16T05:01:29Z",
  "closed_at": "2015-02-13T23:56:46Z",
  "author_association": "MEMBER",
  "type": null,
  "active_lock_reason": null,
  "draft": false,
  "pull_request": {
    "url": "https://api.github.com/repos/rust-lang/rust/pulls/22200",
    "html_url": "https://github.com/rust-lang/rust/pull/22200",
    "diff_url": "https://github.com/rust-lang/rust/pull/22200.diff",
    "patch_url": "https://github.com/rust-lang/rust/pull/22200.patch",
    "merged_at": "2015-02-13T23:56:46Z"
  },
  "body": "This PR is an optimization of the `FromIterator` implementation of `Vec`\n\nBenchmark: https://gist.github.com/alexcrichton/03d666159a28a80e7c70\n\nBefore:\n\n```\ntest macro_repeat1     ... bench:        57 ns/iter (+/- 1)\ntest macro_repeat2     ... bench:        56 ns/iter (+/- 1)\ntest map_clone1        ... bench:       828 ns/iter (+/- 13)\ntest map_clone2        ... bench:       828 ns/iter (+/- 8)\ntest repeat1           ... bench:      1104 ns/iter (+/- 10)\ntest repeat2           ... bench:      1106 ns/iter (+/- 11)\n```\n\nAfter:\n\n```\ntest macro_repeat1     ... bench:        75 ns/iter (+/- 21)\ntest macro_repeat2     ... bench:        59 ns/iter (+/- 31)\ntest map_clone1        ... bench:        34 ns/iter (+/- 22)\ntest map_clone2        ... bench:        52 ns/iter (+/- 21)\ntest repeat1           ... bench:        34 ns/iter (+/- 11)\ntest repeat2           ... bench:        33 ns/iter (+/- 12)\n```\n\nThe idea behind this optimization is to avoid all bounds checks for space\nalready allocated into the vector. This may involve running the iterator twice,\nbut the first run of the iterator should be optimizable to a memcpy or memset if\npossible.\n\nThe same treatment can in theory be applied to `Vec::extend` but the benchmarks\nfor that currently get _worse_ if the change is applied. This appears to be some\nLLVM optimizations going awry but it's seems prudent to land at least the\n`collect` portion beforehand.\n",
  "closed_by": {
    "login": "bors",
    "id": 3372342,
    "node_id": "MDQ6VXNlcjMzNzIzNDI=",
    "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/bors",
    "html_url": "https://github.com/bors",
    "followers_url": "https://api.github.com/users/bors/followers",
    "following_url": "https://api.github.com/users/bors/following{/other_user}",
    "gists_url": "https://api.github.com/users/bors/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/bors/subscriptions",
    "organizations_url": "https://api.github.com/users/bors/orgs",
    "repos_url": "https://api.github.com/users/bors/repos",
    "events_url": "https://api.github.com/users/bors/events{/privacy}",
    "received_events_url": "https://api.github.com/users/bors/received_events",
    "type": "User",
    "user_view_type": "public",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/22200/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/22200/timeline",
  "performed_via_github_app": null,
  "state_reason": null,
  "_meta": {
    "type": "pr"
  }
}
