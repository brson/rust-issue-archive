{
  "url": "https://api.github.com/repos/rust-lang/rust/issues/28497",
  "repository_url": "https://api.github.com/repos/rust-lang/rust",
  "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/28497/labels{/name}",
  "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/28497/comments",
  "events_url": "https://api.github.com/repos/rust-lang/rust/issues/28497/events",
  "html_url": "https://github.com/rust-lang/rust/pull/28497",
  "id": 107252775,
  "node_id": "MDExOlB1bGxSZXF1ZXN0NDU0MzczNzg=",
  "number": 28497,
  "title": "Avoid zero-sized leaf allocations in `BTreeMap`",
  "user": {
    "login": "apasel422",
    "id": 8644784,
    "node_id": "MDQ6VXNlcjg2NDQ3ODQ=",
    "avatar_url": "https://avatars.githubusercontent.com/u/8644784?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/apasel422",
    "html_url": "https://github.com/apasel422",
    "followers_url": "https://api.github.com/users/apasel422/followers",
    "following_url": "https://api.github.com/users/apasel422/following{/other_user}",
    "gists_url": "https://api.github.com/users/apasel422/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/apasel422/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/apasel422/subscriptions",
    "organizations_url": "https://api.github.com/users/apasel422/orgs",
    "repos_url": "https://api.github.com/users/apasel422/repos",
    "events_url": "https://api.github.com/users/apasel422/events{/privacy}",
    "received_events_url": "https://api.github.com/users/apasel422/received_events",
    "type": "User",
    "user_view_type": "public",
    "site_admin": false
  },
  "labels": [],
  "state": "closed",
  "locked": false,
  "assignee": {
    "login": "nikomatsakis",
    "id": 155238,
    "node_id": "MDQ6VXNlcjE1NTIzOA==",
    "avatar_url": "https://avatars.githubusercontent.com/u/155238?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/nikomatsakis",
    "html_url": "https://github.com/nikomatsakis",
    "followers_url": "https://api.github.com/users/nikomatsakis/followers",
    "following_url": "https://api.github.com/users/nikomatsakis/following{/other_user}",
    "gists_url": "https://api.github.com/users/nikomatsakis/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/nikomatsakis/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/nikomatsakis/subscriptions",
    "organizations_url": "https://api.github.com/users/nikomatsakis/orgs",
    "repos_url": "https://api.github.com/users/nikomatsakis/repos",
    "events_url": "https://api.github.com/users/nikomatsakis/events{/privacy}",
    "received_events_url": "https://api.github.com/users/nikomatsakis/received_events",
    "type": "User",
    "user_view_type": "public",
    "site_admin": false
  },
  "assignees": [
    {
      "login": "nikomatsakis",
      "id": 155238,
      "node_id": "MDQ6VXNlcjE1NTIzOA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/155238?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nikomatsakis",
      "html_url": "https://github.com/nikomatsakis",
      "followers_url": "https://api.github.com/users/nikomatsakis/followers",
      "following_url": "https://api.github.com/users/nikomatsakis/following{/other_user}",
      "gists_url": "https://api.github.com/users/nikomatsakis/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nikomatsakis/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nikomatsakis/subscriptions",
      "organizations_url": "https://api.github.com/users/nikomatsakis/orgs",
      "repos_url": "https://api.github.com/users/nikomatsakis/repos",
      "events_url": "https://api.github.com/users/nikomatsakis/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nikomatsakis/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    }
  ],
  "milestone": null,
  "comments": 10,
  "created_at": "2015-09-18T18:27:45Z",
  "updated_at": "2015-09-19T19:29:48Z",
  "closed_at": "2015-09-19T19:29:05Z",
  "author_association": "CONTRIBUTOR",
  "type": null,
  "active_lock_reason": null,
  "draft": false,
  "pull_request": {
    "url": "https://api.github.com/repos/rust-lang/rust/pulls/28497",
    "html_url": "https://github.com/rust-lang/rust/pull/28497",
    "diff_url": "https://github.com/rust-lang/rust/pull/28497.diff",
    "patch_url": "https://github.com/rust-lang/rust/pull/28497.patch",
    "merged_at": "2015-09-19T19:29:05Z"
  },
  "body": "When both the key and value types were zero-sized, `BTreeMap` previously\ncalled `heap::allocate` with `size == 0` for leaf nodes, which is\nundefined behavior, and jemalloc would attempt to read invalid memory,\ncrashing the process.\n\nThis avoids undefined behavior by allocating enough space to store one\nedge in leaf nodes that would otherwise have `size == 0`. Although this\nuses extra memory, maps with zero-sized key types that have sensible\nimplementations of the ordering traits can only contain a single\nkey-value pair (and therefore only a single leaf node), and maps with\nkey and value types that are both zero-sized have few uses, if any.\n\nFurthermore, this is a temporary fix that will likely be unnecessary\nonce the `BTreeMap` implementation is rewritten to use parent pointers.\n\nCloses #28493.\n",
  "closed_by": {
    "login": "bors",
    "id": 3372342,
    "node_id": "MDQ6VXNlcjMzNzIzNDI=",
    "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/bors",
    "html_url": "https://github.com/bors",
    "followers_url": "https://api.github.com/users/bors/followers",
    "following_url": "https://api.github.com/users/bors/following{/other_user}",
    "gists_url": "https://api.github.com/users/bors/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/bors/subscriptions",
    "organizations_url": "https://api.github.com/users/bors/orgs",
    "repos_url": "https://api.github.com/users/bors/repos",
    "events_url": "https://api.github.com/users/bors/events{/privacy}",
    "received_events_url": "https://api.github.com/users/bors/received_events",
    "type": "User",
    "user_view_type": "public",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/28497/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/28497/timeline",
  "performed_via_github_app": null,
  "state_reason": null,
  "_meta": {
    "type": "pr"
  }
}
