[
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/22366195",
    "html_url": "https://github.com/rust-lang/rust/issues/8406#issuecomment-22366195",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/8406",
    "id": 22366195,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIyMzY2MTk1",
    "user": {
      "login": "thestinger",
      "id": 1505226,
      "node_id": "MDQ6VXNlcjE1MDUyMjY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1505226?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/thestinger",
      "html_url": "https://github.com/thestinger",
      "followers_url": "https://api.github.com/users/thestinger/followers",
      "following_url": "https://api.github.com/users/thestinger/following{/other_user}",
      "gists_url": "https://api.github.com/users/thestinger/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/thestinger/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/thestinger/subscriptions",
      "organizations_url": "https://api.github.com/users/thestinger/orgs",
      "repos_url": "https://api.github.com/users/thestinger/repos",
      "events_url": "https://api.github.com/users/thestinger/events{/privacy}",
      "received_events_url": "https://api.github.com/users/thestinger/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2013-08-08T23:34:24Z",
    "updated_at": "2013-08-08T23:35:05Z",
    "body": "It's not possible to statically create a unique pointer or unique vector, because they represent a dynamic allocation from `malloc`/`free`. Consider a `static mut` where you swap out the value, and now it has `free` called on it.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/22366195/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/22366831",
    "html_url": "https://github.com/rust-lang/rust/issues/8406#issuecomment-22366831",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/8406",
    "id": 22366831,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIyMzY2ODMx",
    "user": {
      "login": "stepancheg",
      "id": 28969,
      "node_id": "MDQ6VXNlcjI4OTY5",
      "avatar_url": "https://avatars.githubusercontent.com/u/28969?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/stepancheg",
      "html_url": "https://github.com/stepancheg",
      "followers_url": "https://api.github.com/users/stepancheg/followers",
      "following_url": "https://api.github.com/users/stepancheg/following{/other_user}",
      "gists_url": "https://api.github.com/users/stepancheg/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/stepancheg/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/stepancheg/subscriptions",
      "organizations_url": "https://api.github.com/users/stepancheg/orgs",
      "repos_url": "https://api.github.com/users/stepancheg/repos",
      "events_url": "https://api.github.com/users/stepancheg/events{/privacy}",
      "received_events_url": "https://api.github.com/users/stepancheg/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2013-08-08T23:50:52Z",
    "updated_at": "2013-08-09T22:45:25Z",
    "body": "@thestinger it looks possible to me. It is not too much different from `&'static [u32]` constants.\n\nLLVM representation of `~[u32]` is\n\n```\n{i64 /* len in bytes */, i64 /* alloc in bytes */, [0 x i32] /* data */}*\n```\n\nSo for\n\n```\nstatic items: ~[u32] = ~[10, 20, 30];\n```\n\nbitcode would look like:\n\n```\n@items_data = private constant { i64, i64, [3 x i32] } { i64 12 /* len */, i64 12 /* allocated */, [3 x i32] [i32 10, i32 20, i32 30] }\n@items = internal constant { i64, i64, [0 x i32] }* bitcast( ... @items_data)\n```\n\nVector data and header are allocated statically, without `malloc`.\n\nAnd compiler must guarantee that `items` is immutable and not movable, e. g. in this code:\n\n```\nfn qux(items: ~[u32]) {}\n\nfn quux() {\n    qux(items); // must be compile-time error\n}\n```\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/22366831/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/22368117",
    "html_url": "https://github.com/rust-lang/rust/issues/8406#issuecomment-22368117",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/8406",
    "id": 22368117,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIyMzY4MTE3",
    "user": {
      "login": "thestinger",
      "id": 1505226,
      "node_id": "MDQ6VXNlcjE1MDUyMjY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1505226?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/thestinger",
      "html_url": "https://github.com/thestinger",
      "followers_url": "https://api.github.com/users/thestinger/followers",
      "following_url": "https://api.github.com/users/thestinger/following{/other_user}",
      "gists_url": "https://api.github.com/users/thestinger/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/thestinger/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/thestinger/subscriptions",
      "organizations_url": "https://api.github.com/users/thestinger/orgs",
      "repos_url": "https://api.github.com/users/thestinger/repos",
      "events_url": "https://api.github.com/users/thestinger/events{/privacy}",
      "received_events_url": "https://api.github.com/users/thestinger/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2013-08-09T00:23:52Z",
    "updated_at": "2013-08-09T00:23:52Z",
    "body": "So it would be a type you could include in `static` but _not_ in `static mut`.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/22368117/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/22427308",
    "html_url": "https://github.com/rust-lang/rust/issues/8406#issuecomment-22427308",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/8406",
    "id": 22427308,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIyNDI3MzA4",
    "user": {
      "login": "stepancheg",
      "id": 28969,
      "node_id": "MDQ6VXNlcjI4OTY5",
      "avatar_url": "https://avatars.githubusercontent.com/u/28969?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/stepancheg",
      "html_url": "https://github.com/stepancheg",
      "followers_url": "https://api.github.com/users/stepancheg/followers",
      "following_url": "https://api.github.com/users/stepancheg/following{/other_user}",
      "gists_url": "https://api.github.com/users/stepancheg/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/stepancheg/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/stepancheg/subscriptions",
      "organizations_url": "https://api.github.com/users/stepancheg/orgs",
      "repos_url": "https://api.github.com/users/stepancheg/repos",
      "events_url": "https://api.github.com/users/stepancheg/events{/privacy}",
      "received_events_url": "https://api.github.com/users/stepancheg/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2013-08-09T22:40:27Z",
    "updated_at": "2013-08-10T01:13:32Z",
    "body": "Done first part in 197b199da867cb61d2a828cb8e44b56c1b4b33c0: code is generated and works properly until I'm trying to move it:\n\n```\nstatic uniq: ~[u32] = ~[10, 20, 30];\n\nfn foo(v: ~[u32]) {\n}\n\nfn main() {\n    println(fmt!(\"%u\", uniq.len()));\n    println(fmt!(\"%d\", uniq[0] as int));\n    println(fmt!(\"%d\", uniq[1] as int));\n    println(fmt!(\"%d\", uniq[2] as int));\n    println(fmt!(\"%?\", uniq));\n    let view: &[u32] = uniq;\n    println(fmt!(\"%?\", view));\n    foo(uniq); // <-- crashes here in runtime, should be compile-time error \n}\n```\n\nProblem is that static constants of the same type should be copyable or movable depending on their content:\n\n```\nstatic some: Option<~uint> = None; // should be copyable or movable\nstatic some: Option<~uint> = Some(~1); // should be neither copyable nor movable\n```\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/22427308/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/22455579",
    "html_url": "https://github.com/rust-lang/rust/issues/8406#issuecomment-22455579",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/8406",
    "id": 22455579,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIyNDU1NTc5",
    "user": {
      "login": "nikomatsakis",
      "id": 155238,
      "node_id": "MDQ6VXNlcjE1NTIzOA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/155238?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nikomatsakis",
      "html_url": "https://github.com/nikomatsakis",
      "followers_url": "https://api.github.com/users/nikomatsakis/followers",
      "following_url": "https://api.github.com/users/nikomatsakis/following{/other_user}",
      "gists_url": "https://api.github.com/users/nikomatsakis/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nikomatsakis/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nikomatsakis/subscriptions",
      "organizations_url": "https://api.github.com/users/nikomatsakis/orgs",
      "repos_url": "https://api.github.com/users/nikomatsakis/repos",
      "events_url": "https://api.github.com/users/nikomatsakis/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nikomatsakis/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2013-08-11T10:23:42Z",
    "updated_at": "2013-08-11T10:23:42Z",
    "body": "I am not so sure about this. Ginning up a fake `~` value for an immutable static value seems ok, but what if that value is used in a `static mut`?\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/22455579/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/22458673",
    "html_url": "https://github.com/rust-lang/rust/issues/8406#issuecomment-22458673",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/8406",
    "id": 22458673,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIyNDU4Njcz",
    "user": {
      "login": "stepancheg",
      "id": 28969,
      "node_id": "MDQ6VXNlcjI4OTY5",
      "avatar_url": "https://avatars.githubusercontent.com/u/28969?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/stepancheg",
      "html_url": "https://github.com/stepancheg",
      "followers_url": "https://api.github.com/users/stepancheg/followers",
      "following_url": "https://api.github.com/users/stepancheg/following{/other_user}",
      "gists_url": "https://api.github.com/users/stepancheg/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/stepancheg/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/stepancheg/subscriptions",
      "organizations_url": "https://api.github.com/users/stepancheg/orgs",
      "repos_url": "https://api.github.com/users/stepancheg/repos",
      "events_url": "https://api.github.com/users/stepancheg/events{/privacy}",
      "received_events_url": "https://api.github.com/users/stepancheg/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2013-08-11T14:40:11Z",
    "updated_at": "2013-08-11T14:40:11Z",
    "body": "@nikomatsakis @thestinger if a value is stored in `static mut` then developer has to use `unsafe` code, so he knows what he is doing (developer can modify content, but cannot resize it).\n\nAnyway, it is OK to me to just prohibit `static mut` with unique pointers.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/22458673/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/27277677",
    "html_url": "https://github.com/rust-lang/rust/issues/8406#issuecomment-27277677",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/8406",
    "id": 27277677,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3Mjc3Njc3",
    "user": {
      "login": "catamorphism",
      "id": 427212,
      "node_id": "MDQ6VXNlcjQyNzIxMg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/427212?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/catamorphism",
      "html_url": "https://github.com/catamorphism",
      "followers_url": "https://api.github.com/users/catamorphism/followers",
      "following_url": "https://api.github.com/users/catamorphism/following{/other_user}",
      "gists_url": "https://api.github.com/users/catamorphism/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/catamorphism/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/catamorphism/subscriptions",
      "organizations_url": "https://api.github.com/users/catamorphism/orgs",
      "repos_url": "https://api.github.com/users/catamorphism/repos",
      "events_url": "https://api.github.com/users/catamorphism/events{/privacy}",
      "received_events_url": "https://api.github.com/users/catamorphism/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2013-10-29T04:17:16Z",
    "updated_at": "2013-10-29T04:17:16Z",
    "body": "This doesn't have recent activity and I kind of agree with @nikomatsakis and @thestinger . I'm going to close this, but if @stepancheg or somebody else wants to reopen it, you should add \"RFC:\" to the title and add the B-RFC label, since this would be a language change that requires consensus.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/27277677/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
