{
  "url": "https://api.github.com/repos/rust-lang/rust/issues/334",
  "repository_url": "https://api.github.com/repos/rust-lang/rust",
  "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/334/labels{/name}",
  "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/334/comments",
  "events_url": "https://api.github.com/repos/rust-lang/rust/issues/334/events",
  "html_url": "https://github.com/rust-lang/rust/pull/334",
  "id": 786472,
  "node_id": "MDExOlB1bGxSZXF1ZXN0MTIxMzM3",
  "number": 334,
  "title": "Handle nested items correctly in typestate_check",
  "user": {
    "login": "catamorphism",
    "id": 427212,
    "node_id": "MDQ6VXNlcjQyNzIxMg==",
    "avatar_url": "https://avatars.githubusercontent.com/u/427212?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/catamorphism",
    "html_url": "https://github.com/catamorphism",
    "followers_url": "https://api.github.com/users/catamorphism/followers",
    "following_url": "https://api.github.com/users/catamorphism/following{/other_user}",
    "gists_url": "https://api.github.com/users/catamorphism/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/catamorphism/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/catamorphism/subscriptions",
    "organizations_url": "https://api.github.com/users/catamorphism/orgs",
    "repos_url": "https://api.github.com/users/catamorphism/repos",
    "events_url": "https://api.github.com/users/catamorphism/events{/privacy}",
    "received_events_url": "https://api.github.com/users/catamorphism/received_events",
    "type": "User",
    "user_view_type": "public",
    "site_admin": false
  },
  "labels": [],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [],
  "milestone": null,
  "comments": 1,
  "created_at": "2011-04-18T22:52:34Z",
  "updated_at": "2014-07-05T08:04:36Z",
  "closed_at": "2011-04-19T22:05:09Z",
  "author_association": "CONTRIBUTOR",
  "type": null,
  "active_lock_reason": null,
  "draft": false,
  "pull_request": {
    "url": "https://api.github.com/repos/rust-lang/rust/pulls/334",
    "html_url": "https://github.com/rust-lang/rust/pull/334",
    "diff_url": "https://github.com/rust-lang/rust/pull/334.diff",
    "patch_url": "https://github.com/rust-lang/rust/pull/334.patch",
    "merged_at": null
  },
  "body": "Summary says it all. Actually, only nested objects and functions\nare handled, but that's better than before. The fold that I was using\nbefore to traverse a crate wasn't working correctly, because annotations\nhave to reflect the number of local variables of the nearest enclosing\nfunction (in turn, because annotations are represented as bit vectors).\nThe fold was traversing the AST in the wrong order, first filling in\nthe annotations correctly, but then re-traversing them with the bit\nvector length for any outer nested functions, and so on.\n\nRemedying this required writing a lot of tedious boilerplate code\nbecause I scrapped the idea of using a fold altogether.\n\nI also made typestate_check handle unary, field, alt, and fail.\n\nAlso, some miscellaneous changes:\n- added annotations to blocks in typeck\n- fix pprust so it can handle spawn\n- added more logging functions in util.common\n- fixed _vec.or\n- added maybe and from_maybe in option\n- removed fold_block field from ast_fold, since it was never used\n",
  "closed_by": {
    "login": "graydon",
    "id": 14097,
    "node_id": "MDQ6VXNlcjE0MDk3",
    "avatar_url": "https://avatars.githubusercontent.com/u/14097?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/graydon",
    "html_url": "https://github.com/graydon",
    "followers_url": "https://api.github.com/users/graydon/followers",
    "following_url": "https://api.github.com/users/graydon/following{/other_user}",
    "gists_url": "https://api.github.com/users/graydon/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/graydon/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/graydon/subscriptions",
    "organizations_url": "https://api.github.com/users/graydon/orgs",
    "repos_url": "https://api.github.com/users/graydon/repos",
    "events_url": "https://api.github.com/users/graydon/events{/privacy}",
    "received_events_url": "https://api.github.com/users/graydon/received_events",
    "type": "User",
    "user_view_type": "public",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/334/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/334/timeline",
  "performed_via_github_app": null,
  "state_reason": null,
  "_meta": {
    "type": "pr"
  }
}
