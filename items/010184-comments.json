[
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/27455168",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-27455168",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 27455168,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3NDU1MTY4",
    "user": {
      "login": "brson",
      "id": 147214,
      "node_id": "MDQ6VXNlcjE0NzIxNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/brson",
      "html_url": "https://github.com/brson",
      "followers_url": "https://api.github.com/users/brson/followers",
      "following_url": "https://api.github.com/users/brson/following{/other_user}",
      "gists_url": "https://api.github.com/users/brson/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/brson/subscriptions",
      "organizations_url": "https://api.github.com/users/brson/orgs",
      "repos_url": "https://api.github.com/users/brson/repos",
      "events_url": "https://api.github.com/users/brson/events{/privacy}",
      "received_events_url": "https://api.github.com/users/brson/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2013-10-31T01:42:50Z",
    "updated_at": "2013-10-31T01:42:50Z",
    "body": "Nominating\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/27455168/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/27994070",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-27994070",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 27994070,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3OTk0MDcw",
    "user": {
      "login": "pnkfelix",
      "id": 173127,
      "node_id": "MDQ6VXNlcjE3MzEyNw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/173127?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/pnkfelix",
      "html_url": "https://github.com/pnkfelix",
      "followers_url": "https://api.github.com/users/pnkfelix/followers",
      "following_url": "https://api.github.com/users/pnkfelix/following{/other_user}",
      "gists_url": "https://api.github.com/users/pnkfelix/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/pnkfelix/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/pnkfelix/subscriptions",
      "organizations_url": "https://api.github.com/users/pnkfelix/orgs",
      "repos_url": "https://api.github.com/users/pnkfelix/repos",
      "events_url": "https://api.github.com/users/pnkfelix/events{/privacy}",
      "received_events_url": "https://api.github.com/users/pnkfelix/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2013-11-07T18:44:41Z",
    "updated_at": "2013-11-07T18:44:41Z",
    "body": "accepted for P-high, same reasoning as #10183 \n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/27994070/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/29048708",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-29048708",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 29048708,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI5MDQ4NzA4",
    "user": {
      "login": "pcwalton",
      "id": 157897,
      "node_id": "MDQ6VXNlcjE1Nzg5Nw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/157897?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/pcwalton",
      "html_url": "https://github.com/pcwalton",
      "followers_url": "https://api.github.com/users/pcwalton/followers",
      "following_url": "https://api.github.com/users/pcwalton/following{/other_user}",
      "gists_url": "https://api.github.com/users/pcwalton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/pcwalton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/pcwalton/subscriptions",
      "organizations_url": "https://api.github.com/users/pcwalton/orgs",
      "repos_url": "https://api.github.com/users/pcwalton/repos",
      "events_url": "https://api.github.com/users/pcwalton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/pcwalton/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2013-11-22T04:45:46Z",
    "updated_at": "2013-11-22T04:45:46Z",
    "body": "I don't think this is backwards incompatible at a language level. It will not cause code that was working OK to stop working. Nominating.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/29048708/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/30954360",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-30954360",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 30954360,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMwOTU0MzYw",
    "user": {
      "login": "pnkfelix",
      "id": 173127,
      "node_id": "MDQ6VXNlcjE3MzEyNw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/173127?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/pnkfelix",
      "html_url": "https://github.com/pnkfelix",
      "followers_url": "https://api.github.com/users/pnkfelix/followers",
      "following_url": "https://api.github.com/users/pnkfelix/following{/other_user}",
      "gists_url": "https://api.github.com/users/pnkfelix/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/pnkfelix/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/pnkfelix/subscriptions",
      "organizations_url": "https://api.github.com/users/pnkfelix/orgs",
      "repos_url": "https://api.github.com/users/pnkfelix/repos",
      "events_url": "https://api.github.com/users/pnkfelix/events{/privacy}",
      "received_events_url": "https://api.github.com/users/pnkfelix/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2013-12-19T18:45:43Z",
    "updated_at": "2013-12-19T18:45:43Z",
    "body": "changing to P-high, same reasoning as #10183\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/30954360/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/55346467",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-55346467",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 55346467,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU1MzQ2NDY3",
    "user": {
      "login": "nrc",
      "id": 762626,
      "node_id": "MDQ6VXNlcjc2MjYyNg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/762626?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nrc",
      "html_url": "https://github.com/nrc",
      "followers_url": "https://api.github.com/users/nrc/followers",
      "following_url": "https://api.github.com/users/nrc/following{/other_user}",
      "gists_url": "https://api.github.com/users/nrc/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nrc/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nrc/subscriptions",
      "organizations_url": "https://api.github.com/users/nrc/orgs",
      "repos_url": "https://api.github.com/users/nrc/repos",
      "events_url": "https://api.github.com/users/nrc/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nrc/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-09-12T00:11:58Z",
    "updated_at": "2014-09-12T00:11:58Z",
    "body": "How do we propose to solve this and #10185? Since whether behaviour is defined or not depends on the dynamic value of the number being cast, it seems the only solution is to insert dynamic checks. We seem to agree we do not want to do that for arithmetic overflow, are we happy to do it for cast overflow?\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/55346467/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/55351990",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-55351990",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 55351990,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU1MzUxOTkw",
    "user": {
      "login": "pcwalton",
      "id": 157897,
      "node_id": "MDQ6VXNlcjE1Nzg5Nw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/157897?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/pcwalton",
      "html_url": "https://github.com/pcwalton",
      "followers_url": "https://api.github.com/users/pcwalton/followers",
      "following_url": "https://api.github.com/users/pcwalton/following{/other_user}",
      "gists_url": "https://api.github.com/users/pcwalton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/pcwalton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/pcwalton/subscriptions",
      "organizations_url": "https://api.github.com/users/pcwalton/orgs",
      "repos_url": "https://api.github.com/users/pcwalton/repos",
      "events_url": "https://api.github.com/users/pcwalton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/pcwalton/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-09-12T01:38:15Z",
    "updated_at": "2014-09-12T01:38:15Z",
    "body": "We could add an intrinsic to LLVM that performs a \"safe conversion\". @zwarich may have other ideas.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/55351990/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/55352088",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-55352088",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 55352088,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU1MzUyMDg4",
    "user": {
      "login": "zwarich",
      "id": 440875,
      "node_id": "MDQ6VXNlcjQ0MDg3NQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/440875?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/zwarich",
      "html_url": "https://github.com/zwarich",
      "followers_url": "https://api.github.com/users/zwarich/followers",
      "following_url": "https://api.github.com/users/zwarich/following{/other_user}",
      "gists_url": "https://api.github.com/users/zwarich/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/zwarich/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/zwarich/subscriptions",
      "organizations_url": "https://api.github.com/users/zwarich/orgs",
      "repos_url": "https://api.github.com/users/zwarich/repos",
      "events_url": "https://api.github.com/users/zwarich/events{/privacy}",
      "received_events_url": "https://api.github.com/users/zwarich/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-09-12T01:40:12Z",
    "updated_at": "2014-09-12T01:40:12Z",
    "body": "AFAIK the only solution at the moment is to use the target-specific intrinsics. That's what JavaScriptCore does, at least according to someone I asked.\n",
    "author_association": "NONE",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/55352088/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/55352713",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-55352713",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 55352713,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU1MzUyNzEz",
    "user": {
      "login": "pcwalton",
      "id": 157897,
      "node_id": "MDQ6VXNlcjE1Nzg5Nw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/157897?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/pcwalton",
      "html_url": "https://github.com/pcwalton",
      "followers_url": "https://api.github.com/users/pcwalton/followers",
      "following_url": "https://api.github.com/users/pcwalton/following{/other_user}",
      "gists_url": "https://api.github.com/users/pcwalton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/pcwalton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/pcwalton/subscriptions",
      "organizations_url": "https://api.github.com/users/pcwalton/orgs",
      "repos_url": "https://api.github.com/users/pcwalton/repos",
      "events_url": "https://api.github.com/users/pcwalton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/pcwalton/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-09-12T01:51:36Z",
    "updated_at": "2014-09-12T01:51:36Z",
    "body": "Oh, that's easy enough then.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/55352713/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/95736312",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-95736312",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 95736312,
    "node_id": "MDEyOklzc3VlQ29tbWVudDk1NzM2MzEy",
    "user": {
      "login": "nrc",
      "id": 762626,
      "node_id": "MDQ6VXNlcjc2MjYyNg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/762626?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nrc",
      "html_url": "https://github.com/nrc",
      "followers_url": "https://api.github.com/users/nrc/followers",
      "following_url": "https://api.github.com/users/nrc/following{/other_user}",
      "gists_url": "https://api.github.com/users/nrc/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nrc/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nrc/subscriptions",
      "organizations_url": "https://api.github.com/users/nrc/orgs",
      "repos_url": "https://api.github.com/users/nrc/repos",
      "events_url": "https://api.github.com/users/nrc/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nrc/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-04-23T22:35:09Z",
    "updated_at": "2015-04-23T22:35:09Z",
    "body": "ping @pnkfelix is this covered by the new overflow checking stuff?\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/95736312/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/100001729",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-100001729",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 100001729,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEwMDAwMTcyOQ==",
    "user": {
      "login": "bluss",
      "id": 3209739,
      "node_id": "MDQ6VXNlcjMyMDk3Mzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3209739?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/bluss",
      "html_url": "https://github.com/bluss",
      "followers_url": "https://api.github.com/users/bluss/followers",
      "following_url": "https://api.github.com/users/bluss/following{/other_user}",
      "gists_url": "https://api.github.com/users/bluss/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/bluss/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/bluss/subscriptions",
      "organizations_url": "https://api.github.com/users/bluss/orgs",
      "repos_url": "https://api.github.com/users/bluss/repos",
      "events_url": "https://api.github.com/users/bluss/events{/privacy}",
      "received_events_url": "https://api.github.com/users/bluss/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-05-07T20:09:15Z",
    "updated_at": "2016-02-21T20:51:54Z",
    "body": "These casts are not checked by rustc with debug assertions.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/100001729/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/139846704",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-139846704",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 139846704,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEzOTg0NjcwNA==",
    "user": {
      "login": "Aatch",
      "id": 342416,
      "node_id": "MDQ6VXNlcjM0MjQxNg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/342416?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Aatch",
      "html_url": "https://github.com/Aatch",
      "followers_url": "https://api.github.com/users/Aatch/followers",
      "following_url": "https://api.github.com/users/Aatch/following{/other_user}",
      "gists_url": "https://api.github.com/users/Aatch/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Aatch/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Aatch/subscriptions",
      "organizations_url": "https://api.github.com/users/Aatch/orgs",
      "repos_url": "https://api.github.com/users/Aatch/repos",
      "events_url": "https://api.github.com/users/Aatch/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Aatch/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-09-13T06:22:52Z",
    "updated_at": "2015-09-13T06:25:26Z",
    "body": "I'm happy to handle this, but I need a concrete solution. I personally think that it should be checked along with overflowing integer arithmetic, as it's a very similar issue. I don't really mind what we do though.\n\nNote that this issue is currently causing an ICE when used in certain constant expressions.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/139846704/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/139858153",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-139858153",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 139858153,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEzOTg1ODE1Mw==",
    "user": {
      "login": "bluss",
      "id": 3209739,
      "node_id": "MDQ6VXNlcjMyMDk3Mzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3209739?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/bluss",
      "html_url": "https://github.com/bluss",
      "followers_url": "https://api.github.com/users/bluss/followers",
      "following_url": "https://api.github.com/users/bluss/following{/other_user}",
      "gists_url": "https://api.github.com/users/bluss/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/bluss/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/bluss/subscriptions",
      "organizations_url": "https://api.github.com/users/bluss/orgs",
      "repos_url": "https://api.github.com/users/bluss/repos",
      "events_url": "https://api.github.com/users/bluss/events{/privacy}",
      "received_events_url": "https://api.github.com/users/bluss/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-09-13T10:22:04Z",
    "updated_at": "2015-09-13T10:22:04Z",
    "body": "This allows violating memory safety in safe rust, example [from this forum post](https://internals.rust-lang.org/t/tackling-undefined-behaviour-casts/2263/8):\n\n> Undefs, huh? Undefs are fun. They tend to propagate. After a few minutes of wrangling..\n\n``` rust\n#[inline(never)]\npub fn f(ary: &[u8; 5]) -> &[u8] {\n    let idx = 1e100f64 as usize;\n    &ary[idx..]\n}\n\nfn main() {\n    println!(\"{}\", f(&[1; 5])[0xdeadbeef]);\n}\n```\n\n> segfaults on my system (latest nightly) with -O.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/139858153/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/146563252",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-146563252",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 146563252,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE0NjU2MzI1Mg==",
    "user": {
      "login": "steveklabnik",
      "id": 27786,
      "node_id": "MDQ6VXNlcjI3Nzg2",
      "avatar_url": "https://avatars.githubusercontent.com/u/27786?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/steveklabnik",
      "html_url": "https://github.com/steveklabnik",
      "followers_url": "https://api.github.com/users/steveklabnik/followers",
      "following_url": "https://api.github.com/users/steveklabnik/following{/other_user}",
      "gists_url": "https://api.github.com/users/steveklabnik/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/steveklabnik/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/steveklabnik/subscriptions",
      "organizations_url": "https://api.github.com/users/steveklabnik/orgs",
      "repos_url": "https://api.github.com/users/steveklabnik/repos",
      "events_url": "https://api.github.com/users/steveklabnik/events{/privacy}",
      "received_events_url": "https://api.github.com/users/steveklabnik/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-10-08T14:28:03Z",
    "updated_at": "2015-10-08T14:28:03Z",
    "body": "Marking with I-unsound given the violation of memory safety in safe rust.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/146563252/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/152310379",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-152310379",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 152310379,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE1MjMxMDM3OQ==",
    "user": {
      "login": "steveklabnik",
      "id": 27786,
      "node_id": "MDQ6VXNlcjI3Nzg2",
      "avatar_url": "https://avatars.githubusercontent.com/u/27786?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/steveklabnik",
      "html_url": "https://github.com/steveklabnik",
      "followers_url": "https://api.github.com/users/steveklabnik/followers",
      "following_url": "https://api.github.com/users/steveklabnik/following{/other_user}",
      "gists_url": "https://api.github.com/users/steveklabnik/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/steveklabnik/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/steveklabnik/subscriptions",
      "organizations_url": "https://api.github.com/users/steveklabnik/orgs",
      "repos_url": "https://api.github.com/users/steveklabnik/repos",
      "events_url": "https://api.github.com/users/steveklabnik/events{/privacy}",
      "received_events_url": "https://api.github.com/users/steveklabnik/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-10-29T20:34:41Z",
    "updated_at": "2015-10-29T20:34:49Z",
    "body": "@bluss , this does not segfualt for me, just gives an assertion error. untagging since i was the one who added it\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/152310379/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/152310550",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-152310550",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 152310550,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE1MjMxMDU1MA==",
    "user": {
      "login": "steveklabnik",
      "id": 27786,
      "node_id": "MDQ6VXNlcjI3Nzg2",
      "avatar_url": "https://avatars.githubusercontent.com/u/27786?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/steveklabnik",
      "html_url": "https://github.com/steveklabnik",
      "followers_url": "https://api.github.com/users/steveklabnik/followers",
      "following_url": "https://api.github.com/users/steveklabnik/following{/other_user}",
      "gists_url": "https://api.github.com/users/steveklabnik/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/steveklabnik/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/steveklabnik/subscriptions",
      "organizations_url": "https://api.github.com/users/steveklabnik/orgs",
      "repos_url": "https://api.github.com/users/steveklabnik/repos",
      "events_url": "https://api.github.com/users/steveklabnik/events{/privacy}",
      "received_events_url": "https://api.github.com/users/steveklabnik/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-10-29T20:35:30Z",
    "updated_at": "2015-10-29T20:35:30Z",
    "body": "Sigh, I forgot the -O, re-tagging.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/152310550/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/186908716",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-186908716",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 186908716,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE4NjkwODcxNg==",
    "user": {
      "login": "nagisa",
      "id": 679122,
      "node_id": "MDQ6VXNlcjY3OTEyMg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/679122?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nagisa",
      "html_url": "https://github.com/nagisa",
      "followers_url": "https://api.github.com/users/nagisa/followers",
      "following_url": "https://api.github.com/users/nagisa/following{/other_user}",
      "gists_url": "https://api.github.com/users/nagisa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nagisa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nagisa/subscriptions",
      "organizations_url": "https://api.github.com/users/nagisa/orgs",
      "repos_url": "https://api.github.com/users/nagisa/repos",
      "events_url": "https://api.github.com/users/nagisa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nagisa/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2016-02-21T20:30:17Z",
    "updated_at": "2016-02-21T20:31:26Z",
    "body": "re-nominating for P-high. Apparently this was at some point P-high but got lower over time. This seems pretty important for correctness.\n\nEDIT: didn\u2019t react to triage comment, adding label manually.\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/186908716/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/188992213",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-188992213",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 188992213,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE4ODk5MjIxMw==",
    "user": {
      "login": "nikomatsakis",
      "id": 155238,
      "node_id": "MDQ6VXNlcjE1NTIzOA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/155238?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nikomatsakis",
      "html_url": "https://github.com/nikomatsakis",
      "followers_url": "https://api.github.com/users/nikomatsakis/followers",
      "following_url": "https://api.github.com/users/nikomatsakis/following{/other_user}",
      "gists_url": "https://api.github.com/users/nikomatsakis/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nikomatsakis/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nikomatsakis/subscriptions",
      "organizations_url": "https://api.github.com/users/nikomatsakis/orgs",
      "repos_url": "https://api.github.com/users/nikomatsakis/repos",
      "events_url": "https://api.github.com/users/nikomatsakis/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nikomatsakis/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2016-02-25T21:15:44Z",
    "updated_at": "2016-02-25T21:15:44Z",
    "body": "It seems like the precedent from the overflow stuff (e.g. for shifting) is to just settle on some behavior. Java seems to produce the result modulo the range, which seems not unreasonable; I'm not sure just what kind of LLVM code we'd need to handle that.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/188992213/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/189192800",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-189192800",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 189192800,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE4OTE5MjgwMA==",
    "user": {
      "login": "ranma42",
      "id": 1506030,
      "node_id": "MDQ6VXNlcjE1MDYwMzA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1506030?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ranma42",
      "html_url": "https://github.com/ranma42",
      "followers_url": "https://api.github.com/users/ranma42/followers",
      "following_url": "https://api.github.com/users/ranma42/following{/other_user}",
      "gists_url": "https://api.github.com/users/ranma42/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ranma42/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ranma42/subscriptions",
      "organizations_url": "https://api.github.com/users/ranma42/orgs",
      "repos_url": "https://api.github.com/users/ranma42/repos",
      "events_url": "https://api.github.com/users/ranma42/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ranma42/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2016-02-26T09:43:43Z",
    "updated_at": "2016-02-26T09:43:43Z",
    "body": "According to https://docs.oracle.com/javase/specs/jls/se7/html/jls-5.html#jls-5.1.3 Java also guarantees that `NaN` values are mapped to 0 and infinities to the minimum/maximum representable integer. Moreover the Java rule for the conversion is more complex than just wrapping, it can be a combination of saturation (for the conversion to `int` or `long`) and wrapping (for the conversion to smaller integral types, if needed). Replicating the whole conversion algorithm from Java is certainly possible, but it would require a fair amount of operations for every cast. In particular, in order to ensure that the result of a `fpto[us]i` operation in LLVM does not exhibit undefined behaviour, a range check would be needed.\n\nAs an alternative, I would suggest that float->int casts are guaranteed to only be valid if the truncation of the original value can be represented as a value of the destination type (or maybe as `[iu]size`?) and to have assertions on debug builds that trigger a panic when the value has not been represented faithfully.\n\nThe main advantages of the Java approach are that the conversion function is total, but this also means that unexpected behaviour might creep in: it would prevent undefined behaviour, but it would be easy to be tricked into not checking if the cast actually made any sense (this is unfortunately true also for the other casts :worried: ).\n\nThe other approach matches the one currently used for arithmetic operations: simple & efficient implementation in release, panics triggered by range checking in debug. Unfortunately unlike other `as` casts, this would make such conversion checked, which can be surprising to the user (although maybe the analogy to arithmetic operations can help here). This would also break some code, but AFAICT it should only happen for code which is currently relying on undefined behaviour (i.e. it would replace the undefined behaviour \"let's return any integer, you obviously don't care which\" with a panic).\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/189192800/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/189205562",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-189205562",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 189205562,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE4OTIwNTU2Mg==",
    "user": {
      "login": "retep998",
      "id": 666308,
      "node_id": "MDQ6VXNlcjY2NjMwOA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/666308?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/retep998",
      "html_url": "https://github.com/retep998",
      "followers_url": "https://api.github.com/users/retep998/followers",
      "following_url": "https://api.github.com/users/retep998/following{/other_user}",
      "gists_url": "https://api.github.com/users/retep998/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/retep998/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/retep998/subscriptions",
      "organizations_url": "https://api.github.com/users/retep998/orgs",
      "repos_url": "https://api.github.com/users/retep998/repos",
      "events_url": "https://api.github.com/users/retep998/events{/privacy}",
      "received_events_url": "https://api.github.com/users/retep998/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2016-02-26T10:18:29Z",
    "updated_at": "2016-02-26T10:18:29Z",
    "body": "The problem isn't \"let's return any integer, you obviously don't care which\", it is that it causes an undef which isn't a random value but rather a nasal demon value and LLVM is allowed to assume the undef never occurs enabling optimizations that do horrible incorrect things. If it was a random value, but crucially not undef, then that would be enough to fix the soundness issues. We don't need to define how unrepresentable values are represented, we just need to prevent undef.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/189205562/reactions",
      "total_count": 2,
      "+1": 2,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/191963344",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-191963344",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 191963344,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE5MTk2MzM0NA==",
    "user": {
      "login": "nikomatsakis",
      "id": 155238,
      "node_id": "MDQ6VXNlcjE1NTIzOA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/155238?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nikomatsakis",
      "html_url": "https://github.com/nikomatsakis",
      "followers_url": "https://api.github.com/users/nikomatsakis/followers",
      "following_url": "https://api.github.com/users/nikomatsakis/following{/other_user}",
      "gists_url": "https://api.github.com/users/nikomatsakis/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nikomatsakis/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nikomatsakis/subscriptions",
      "organizations_url": "https://api.github.com/users/nikomatsakis/orgs",
      "repos_url": "https://api.github.com/users/nikomatsakis/repos",
      "events_url": "https://api.github.com/users/nikomatsakis/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nikomatsakis/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2016-03-03T21:07:27Z",
    "updated_at": "2016-03-03T21:07:27Z",
    "body": "Discussed in @rust-lang/compiler meeting. The most consistent course of action remains:\n1. when overflow checks are enabled, check for illegal casts and panic.\n2. otherwise, we need a fallback behavior, it should be something which has minimal (ideally, zero) runtime cost for valid values, but the precise behavior is not that important, so long as it is not LLVM undef.\n\nThe main problem is that we need a concrete suggestion for option 2.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/191963344/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/191963791",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-191963791",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 191963791,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE5MTk2Mzc5MQ==",
    "user": {
      "login": "nikomatsakis",
      "id": 155238,
      "node_id": "MDQ6VXNlcjE1NTIzOA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/155238?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nikomatsakis",
      "html_url": "https://github.com/nikomatsakis",
      "followers_url": "https://api.github.com/users/nikomatsakis/followers",
      "following_url": "https://api.github.com/users/nikomatsakis/following{/other_user}",
      "gists_url": "https://api.github.com/users/nikomatsakis/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nikomatsakis/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nikomatsakis/subscriptions",
      "organizations_url": "https://api.github.com/users/nikomatsakis/orgs",
      "repos_url": "https://api.github.com/users/nikomatsakis/repos",
      "events_url": "https://api.github.com/users/nikomatsakis/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nikomatsakis/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2016-03-03T21:08:22Z",
    "updated_at": "2016-03-03T21:08:22Z",
    "body": "triage: P-medium\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/191963791/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/192625535",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-192625535",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 192625535,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE5MjYyNTUzNQ==",
    "user": {
      "login": "glaebhoerl",
      "id": 1216629,
      "node_id": "MDQ6VXNlcjEyMTY2Mjk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1216629?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/glaebhoerl",
      "html_url": "https://github.com/glaebhoerl",
      "followers_url": "https://api.github.com/users/glaebhoerl/followers",
      "following_url": "https://api.github.com/users/glaebhoerl/following{/other_user}",
      "gists_url": "https://api.github.com/users/glaebhoerl/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/glaebhoerl/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/glaebhoerl/subscriptions",
      "organizations_url": "https://api.github.com/users/glaebhoerl/orgs",
      "repos_url": "https://api.github.com/users/glaebhoerl/repos",
      "events_url": "https://api.github.com/users/glaebhoerl/events{/privacy}",
      "received_events_url": "https://api.github.com/users/glaebhoerl/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2016-03-05T11:47:22Z",
    "updated_at": "2016-03-05T11:47:22Z",
    "body": "@nikomatsakis Does `as` ever currently panic in debug builds? If it doesn't, for consistency and predictability it seems preferable to keep it that way. (I think it _should have_, just like arithmetic, but that's a separate, and past, debate.)\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/192625535/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/194218954",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-194218954",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 194218954,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE5NDIxODk1NA==",
    "user": {
      "login": "oli-obk",
      "id": 332036,
      "node_id": "MDQ6VXNlcjMzMjAzNg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/332036?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/oli-obk",
      "html_url": "https://github.com/oli-obk",
      "followers_url": "https://api.github.com/users/oli-obk/followers",
      "following_url": "https://api.github.com/users/oli-obk/following{/other_user}",
      "gists_url": "https://api.github.com/users/oli-obk/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/oli-obk/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/oli-obk/subscriptions",
      "organizations_url": "https://api.github.com/users/oli-obk/orgs",
      "repos_url": "https://api.github.com/users/oli-obk/repos",
      "events_url": "https://api.github.com/users/oli-obk/events{/privacy}",
      "received_events_url": "https://api.github.com/users/oli-obk/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2016-03-09T10:04:24Z",
    "updated_at": "2016-03-09T11:17:32Z",
    "body": "> otherwise, we need a fallback behavior, it should be something which has minimal (ideally, zero) runtime cost for valid values, but the precise behavior is not that important, so long as it is not LLVM undef.\n\nConcrete suggestion: extract digits and exponent as `u64` and bitshift digits by exponent.\n\n``` rust\nfn f64_as_u64(f: f64) -> u64 {\n    let (mantissa, exponent, _sign) = f.integer_decode();\n    mantissa >> ((-exponent) & 63)\n}\n```\n\nYes it's not zero cost, but it's somewhat optimizable (would be better if we marked [integer_decode](https://github.com/rust-lang/rust/blob/47cd3a4ae7d82775b74f8199139a020323375c06/src/libcore/num/f64.rs#L204-L216) `inline`) and at least deterministic. A future MIR-pass that expands a float->int cast could probably analyze whether the float is guaranteed to be ok to cast and skip this heavy conversion.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/194218954/reactions",
      "total_count": 1,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 1,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/194229858",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-194229858",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 194229858,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE5NDIyOTg1OA==",
    "user": {
      "login": "eddyb",
      "id": 77424,
      "node_id": "MDQ6VXNlcjc3NDI0",
      "avatar_url": "https://avatars.githubusercontent.com/u/77424?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/eddyb",
      "html_url": "https://github.com/eddyb",
      "followers_url": "https://api.github.com/users/eddyb/followers",
      "following_url": "https://api.github.com/users/eddyb/following{/other_user}",
      "gists_url": "https://api.github.com/users/eddyb/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/eddyb/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/eddyb/subscriptions",
      "organizations_url": "https://api.github.com/users/eddyb/orgs",
      "repos_url": "https://api.github.com/users/eddyb/repos",
      "events_url": "https://api.github.com/users/eddyb/events{/privacy}",
      "received_events_url": "https://api.github.com/users/eddyb/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2016-03-09T10:30:30Z",
    "updated_at": "2016-03-09T10:30:58Z",
    "body": "Does LLVM not have platform intrinsics for the conversion functions?\n\n**EDIT**: @zwarich said (a long time ago):\n\n> AFAIK the only solution at the moment is to use the target-specific intrinsics. That's what JavaScriptCore does, at least according to someone I asked.\n\nWhy even bother panicking? AFAIK, @glaebhoerl is correct, `as` is supposed to truncate/extend, _not_ check the operands.\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/194229858/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/194884082",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-194884082",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 194884082,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE5NDg4NDA4Mg==",
    "user": {
      "login": "nikomatsakis",
      "id": 155238,
      "node_id": "MDQ6VXNlcjE1NTIzOA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/155238?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nikomatsakis",
      "html_url": "https://github.com/nikomatsakis",
      "followers_url": "https://api.github.com/users/nikomatsakis/followers",
      "following_url": "https://api.github.com/users/nikomatsakis/following{/other_user}",
      "gists_url": "https://api.github.com/users/nikomatsakis/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nikomatsakis/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nikomatsakis/subscriptions",
      "organizations_url": "https://api.github.com/users/nikomatsakis/orgs",
      "repos_url": "https://api.github.com/users/nikomatsakis/repos",
      "events_url": "https://api.github.com/users/nikomatsakis/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nikomatsakis/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2016-03-10T14:51:20Z",
    "updated_at": "2016-03-10T14:51:20Z",
    "body": "On Sat, Mar 05, 2016 at 03:47:55AM -0800, G\u00e1bor Lehel wrote:\n\n> @nikomatsakis Does `as` ever currently panic in debug builds? If it doesn't, for consistency and predictability it seems preferable to keep it that way. (I think it _should have_, just like arithmetic, but that's a separate, and past, debate.)\n\nTrue. I find that persuasive.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/194884082/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/194885126",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-194885126",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 194885126,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE5NDg4NTEyNg==",
    "user": {
      "login": "nikomatsakis",
      "id": 155238,
      "node_id": "MDQ6VXNlcjE1NTIzOA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/155238?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nikomatsakis",
      "html_url": "https://github.com/nikomatsakis",
      "followers_url": "https://api.github.com/users/nikomatsakis/followers",
      "following_url": "https://api.github.com/users/nikomatsakis/following{/other_user}",
      "gists_url": "https://api.github.com/users/nikomatsakis/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nikomatsakis/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nikomatsakis/subscriptions",
      "organizations_url": "https://api.github.com/users/nikomatsakis/orgs",
      "repos_url": "https://api.github.com/users/nikomatsakis/repos",
      "events_url": "https://api.github.com/users/nikomatsakis/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nikomatsakis/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2016-03-10T14:52:57Z",
    "updated_at": "2016-03-10T14:52:57Z",
    "body": "On Wed, Mar 09, 2016 at 02:31:05AM -0800, Eduard-Mihai Burtescu wrote:\n\n> Does LLVM not have platform intrinsics for the conversion functions?\n> \n> **EDIT**:\n> \n> > AFAIK the only solution at the moment is to use the target-specific intrinsics. That's what JavaScriptCore does, at least according to someone I asked.\n> \n> Why even bother panicking? AFAIK, @glaebhoerl is correct, `as` is supposed to truncate/extend, _not_ check the operands.\n\nYes, I think I was mistaken before. `as` is the \"unchecked truncation\"\noperator, for better or worse, and it seems best to stay consistent\nwith that philosophy. Using target-specific intrinsics may be a perfectly\nfine solution though?\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/194885126/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/226770666",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-226770666",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 226770666,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIyNjc3MDY2Ng==",
    "user": {
      "login": "sanmai-NL",
      "id": 3374183,
      "node_id": "MDQ6VXNlcjMzNzQxODM=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3374183?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sanmai-NL",
      "html_url": "https://github.com/sanmai-NL",
      "followers_url": "https://api.github.com/users/sanmai-NL/followers",
      "following_url": "https://api.github.com/users/sanmai-NL/following{/other_user}",
      "gists_url": "https://api.github.com/users/sanmai-NL/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sanmai-NL/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sanmai-NL/subscriptions",
      "organizations_url": "https://api.github.com/users/sanmai-NL/orgs",
      "repos_url": "https://api.github.com/users/sanmai-NL/repos",
      "events_url": "https://api.github.com/users/sanmai-NL/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sanmai-NL/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2016-06-17T13:37:39Z",
    "updated_at": "2016-06-17T13:37:39Z",
    "body": "@nikomatsakis: it seems the behavior hasn't been defined yet? Can you give an update about the planning regarding that?\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/226770666/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/241233635",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-241233635",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 241233635,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI0MTIzMzYzNQ==",
    "user": {
      "login": "gmorenz",
      "id": 595972,
      "node_id": "MDQ6VXNlcjU5NTk3Mg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/595972?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gmorenz",
      "html_url": "https://github.com/gmorenz",
      "followers_url": "https://api.github.com/users/gmorenz/followers",
      "following_url": "https://api.github.com/users/gmorenz/following{/other_user}",
      "gists_url": "https://api.github.com/users/gmorenz/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gmorenz/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gmorenz/subscriptions",
      "organizations_url": "https://api.github.com/users/gmorenz/orgs",
      "repos_url": "https://api.github.com/users/gmorenz/repos",
      "events_url": "https://api.github.com/users/gmorenz/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gmorenz/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2016-08-21T01:35:33Z",
    "updated_at": "2016-08-21T01:35:33Z",
    "body": "Just ran into this with much smaller numbers\n\n``` rust\n    let x: f64 = -1.0;\n    x as u8\n```\n\nResults in 0, 16, etc. depending on optimizations, I was hoping it would be defined as 255 so I don't have to write `x as i16 as u8`.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/241233635/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/242011270",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-242011270",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 242011270,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI0MjAxMTI3MA==",
    "user": {
      "login": "vks",
      "id": 33460,
      "node_id": "MDQ6VXNlcjMzNDYw",
      "avatar_url": "https://avatars.githubusercontent.com/u/33460?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vks",
      "html_url": "https://github.com/vks",
      "followers_url": "https://api.github.com/users/vks/followers",
      "following_url": "https://api.github.com/users/vks/following{/other_user}",
      "gists_url": "https://api.github.com/users/vks/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vks/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vks/subscriptions",
      "organizations_url": "https://api.github.com/users/vks/orgs",
      "repos_url": "https://api.github.com/users/vks/repos",
      "events_url": "https://api.github.com/users/vks/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vks/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2016-08-24T09:46:52Z",
    "updated_at": "2016-08-24T09:46:52Z",
    "body": "@gmorenz Did you try `!0u8`?\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/242011270/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/242068561",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-242068561",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 242068561,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI0MjA2ODU2MQ==",
    "user": {
      "login": "gmorenz",
      "id": 595972,
      "node_id": "MDQ6VXNlcjU5NTk3Mg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/595972?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gmorenz",
      "html_url": "https://github.com/gmorenz",
      "followers_url": "https://api.github.com/users/gmorenz/followers",
      "following_url": "https://api.github.com/users/gmorenz/following{/other_user}",
      "gists_url": "https://api.github.com/users/gmorenz/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gmorenz/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gmorenz/subscriptions",
      "organizations_url": "https://api.github.com/users/gmorenz/orgs",
      "repos_url": "https://api.github.com/users/gmorenz/repos",
      "events_url": "https://api.github.com/users/gmorenz/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gmorenz/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2016-08-24T13:44:17Z",
    "updated_at": "2016-08-24T13:44:17Z",
    "body": "In context that wouldn't make sense, I was getting the f64 from a transformation on data sent over the network, with a range of [-255, 255]. I was hoping it would wrap nicely (in the exact way that `<i32> as u8` wraps).\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/242068561/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/254722066",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-254722066",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 254722066,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI1NDcyMjA2Ng==",
    "user": {
      "login": "bstrie",
      "id": 865233,
      "node_id": "MDQ6VXNlcjg2NTIzMw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/865233?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/bstrie",
      "html_url": "https://github.com/bstrie",
      "followers_url": "https://api.github.com/users/bstrie/followers",
      "following_url": "https://api.github.com/users/bstrie/following{/other_user}",
      "gists_url": "https://api.github.com/users/bstrie/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/bstrie/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/bstrie/subscriptions",
      "organizations_url": "https://api.github.com/users/bstrie/orgs",
      "repos_url": "https://api.github.com/users/bstrie/repos",
      "events_url": "https://api.github.com/users/bstrie/events{/privacy}",
      "received_events_url": "https://api.github.com/users/bstrie/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2016-10-19T06:26:32Z",
    "updated_at": "2016-10-19T06:26:32Z",
    "body": "Here's a recent LLVM proposal to \"kill undef\" http://lists.llvm.org/pipermail/llvm-dev/2016-October/106182.html , though I'm hardly knowledgeable enough to know whether or not this would automagically resolve this issue.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/254722066/reactions",
      "total_count": 1,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 1,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/263156513",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-263156513",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 263156513,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI2MzE1NjUxMw==",
    "user": {
      "login": "notriddle",
      "id": 1593513,
      "node_id": "MDQ6VXNlcjE1OTM1MTM=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1593513?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/notriddle",
      "html_url": "https://github.com/notriddle",
      "followers_url": "https://api.github.com/users/notriddle/followers",
      "following_url": "https://api.github.com/users/notriddle/following{/other_user}",
      "gists_url": "https://api.github.com/users/notriddle/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/notriddle/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/notriddle/subscriptions",
      "organizations_url": "https://api.github.com/users/notriddle/orgs",
      "repos_url": "https://api.github.com/users/notriddle/repos",
      "events_url": "https://api.github.com/users/notriddle/events{/privacy}",
      "received_events_url": "https://api.github.com/users/notriddle/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2016-11-27T23:38:59Z",
    "updated_at": "2016-11-27T23:38:59Z",
    "body": "They're replacing undef with poison, the semantics being slightly different. It's not going to make int -> float casts defined behavior.",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/263156513/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/264480359",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-264480359",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 264480359,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI2NDQ4MDM1OQ==",
    "user": {
      "login": "nagisa",
      "id": 679122,
      "node_id": "MDQ6VXNlcjY3OTEyMg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/679122?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nagisa",
      "html_url": "https://github.com/nagisa",
      "followers_url": "https://api.github.com/users/nagisa/followers",
      "following_url": "https://api.github.com/users/nagisa/following{/other_user}",
      "gists_url": "https://api.github.com/users/nagisa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nagisa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nagisa/subscriptions",
      "organizations_url": "https://api.github.com/users/nagisa/orgs",
      "repos_url": "https://api.github.com/users/nagisa/repos",
      "events_url": "https://api.github.com/users/nagisa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nagisa/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2016-12-02T15:28:48Z",
    "updated_at": "2016-12-02T15:28:48Z",
    "body": "We probably should provide *some* explicit way to do a saturating cast? I\u2019ve wanted that exact behaviour just now.",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/264480359/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/266164708",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-266164708",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 266164708,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI2NjE2NDcwOA==",
    "user": {
      "login": "jorendorff",
      "id": 283361,
      "node_id": "MDQ6VXNlcjI4MzM2MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/283361?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jorendorff",
      "html_url": "https://github.com/jorendorff",
      "followers_url": "https://api.github.com/users/jorendorff/followers",
      "following_url": "https://api.github.com/users/jorendorff/following{/other_user}",
      "gists_url": "https://api.github.com/users/jorendorff/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jorendorff/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jorendorff/subscriptions",
      "organizations_url": "https://api.github.com/users/jorendorff/orgs",
      "repos_url": "https://api.github.com/users/jorendorff/repos",
      "events_url": "https://api.github.com/users/jorendorff/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jorendorff/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": true
    },
    "created_at": "2016-12-10T01:01:08Z",
    "updated_at": "2016-12-10T01:01:08Z",
    "body": "Seems like this should be marked I-crash, given https://github.com/rust-lang/rust/issues/10184#issuecomment-139858153 .",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/266164708/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/282458867",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-282458867",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 282458867,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI4MjQ1ODg2Nw==",
    "user": {
      "login": "steveklabnik",
      "id": 27786,
      "node_id": "MDQ6VXNlcjI3Nzg2",
      "avatar_url": "https://avatars.githubusercontent.com/u/27786?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/steveklabnik",
      "html_url": "https://github.com/steveklabnik",
      "followers_url": "https://api.github.com/users/steveklabnik/followers",
      "following_url": "https://api.github.com/users/steveklabnik/following{/other_user}",
      "gists_url": "https://api.github.com/users/steveklabnik/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/steveklabnik/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/steveklabnik/subscriptions",
      "organizations_url": "https://api.github.com/users/steveklabnik/orgs",
      "repos_url": "https://api.github.com/users/steveklabnik/repos",
      "events_url": "https://api.github.com/users/steveklabnik/events{/privacy}",
      "received_events_url": "https://api.github.com/users/steveklabnik/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2017-02-25T04:21:07Z",
    "updated_at": "2017-02-25T04:21:07Z",
    "body": "We had a question about this in `#rust-beginners` today, someone ran into it in the wild.",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/282458867/reactions",
      "total_count": 3,
      "+1": 0,
      "-1": 0,
      "laugh": 3,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/298956308",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-298956308",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 298956308,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI5ODk1NjMwOA==",
    "user": {
      "login": "jorendorff",
      "id": 283361,
      "node_id": "MDQ6VXNlcjI4MzM2MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/283361?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jorendorff",
      "html_url": "https://github.com/jorendorff",
      "followers_url": "https://api.github.com/users/jorendorff/followers",
      "following_url": "https://api.github.com/users/jorendorff/following{/other_user}",
      "gists_url": "https://api.github.com/users/jorendorff/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jorendorff/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jorendorff/subscriptions",
      "organizations_url": "https://api.github.com/users/jorendorff/orgs",
      "repos_url": "https://api.github.com/users/jorendorff/repos",
      "events_url": "https://api.github.com/users/jorendorff/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jorendorff/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": true
    },
    "created_at": "2017-05-03T16:01:42Z",
    "updated_at": "2017-05-03T16:01:42Z",
    "body": "The book I'm writing with @jimblandy, _Programming Rust_, mentions this bug.\r\n\r\n> Several kinds of casts are permitted.\r\n>\r\n> *   Numbers may be cast from any of the built-in numeric types to any other.\r\n>\r\n>     (...)\r\n>\r\n>     However, as of this writing, casting a large floating-point value to an integer type that is too small to represent it can lead to undefined behavior. This can cause crashes even in safe Rust. It is a bug in the compiler, [github.com/rust-lang/rust/issues/10184](https://github.com/rust-lang/rust/issues/10184).\r\n\r\nOur deadline for this chapter is May 19. I'd love to delete that last paragraph, but I feel like we should at least have some kind of plan here first.\r\n\r\nApparently [current JavaScriptCore uses an interesting hack](http://trac.webkit.org/browser/webkit/trunk/Source/JavaScriptCore/runtime/MathCommon.h?rev=215516#L69) on x86. They use the CVTTSD2SI instruction, then fall back on some hairy C++ if the value is out of range. Since out-of-range values currently explode, using that instruction (with no fallback!) would be an improvement on what we have now, albeit only for one architecture.",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/298956308/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/298959937",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-298959937",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 298959937,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI5ODk1OTkzNw==",
    "user": {
      "login": "vks",
      "id": 33460,
      "node_id": "MDQ6VXNlcjMzNDYw",
      "avatar_url": "https://avatars.githubusercontent.com/u/33460?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vks",
      "html_url": "https://github.com/vks",
      "followers_url": "https://api.github.com/users/vks/followers",
      "following_url": "https://api.github.com/users/vks/following{/other_user}",
      "gists_url": "https://api.github.com/users/vks/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vks/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vks/subscriptions",
      "organizations_url": "https://api.github.com/users/vks/orgs",
      "repos_url": "https://api.github.com/users/vks/repos",
      "events_url": "https://api.github.com/users/vks/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vks/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2017-05-03T16:14:38Z",
    "updated_at": "2017-05-03T16:14:38Z",
    "body": "Honestly I think we should deprecate numeric casts with `as` and use `From` and `TryFrom` or something like the conv crate instead.",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/298959937/reactions",
      "total_count": 12,
      "+1": 8,
      "-1": 4,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/298968518",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-298968518",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 298968518,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI5ODk2ODUxOA==",
    "user": {
      "login": "jorendorff",
      "id": 283361,
      "node_id": "MDQ6VXNlcjI4MzM2MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/283361?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jorendorff",
      "html_url": "https://github.com/jorendorff",
      "followers_url": "https://api.github.com/users/jorendorff/followers",
      "following_url": "https://api.github.com/users/jorendorff/following{/other_user}",
      "gists_url": "https://api.github.com/users/jorendorff/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jorendorff/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jorendorff/subscriptions",
      "organizations_url": "https://api.github.com/users/jorendorff/orgs",
      "repos_url": "https://api.github.com/users/jorendorff/repos",
      "events_url": "https://api.github.com/users/jorendorff/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jorendorff/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": true
    },
    "created_at": "2017-05-03T16:46:42Z",
    "updated_at": "2017-05-03T16:46:42Z",
    "body": "Maybe so, but that seems orthogonal to me.",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/298968518/reactions",
      "total_count": 5,
      "+1": 5,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/299215573",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-299215573",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 299215573,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI5OTIxNTU3Mw==",
    "user": {
      "login": "nikomatsakis",
      "id": 155238,
      "node_id": "MDQ6VXNlcjE1NTIzOA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/155238?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nikomatsakis",
      "html_url": "https://github.com/nikomatsakis",
      "followers_url": "https://api.github.com/users/nikomatsakis/followers",
      "following_url": "https://api.github.com/users/nikomatsakis/following{/other_user}",
      "gists_url": "https://api.github.com/users/nikomatsakis/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nikomatsakis/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nikomatsakis/subscriptions",
      "organizations_url": "https://api.github.com/users/nikomatsakis/orgs",
      "repos_url": "https://api.github.com/users/nikomatsakis/repos",
      "events_url": "https://api.github.com/users/nikomatsakis/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nikomatsakis/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2017-05-04T15:12:47Z",
    "updated_at": "2017-05-04T15:12:47Z",
    "body": "OK, I've just re-read this whole conversation. I think there is agreement that this operation should not panic (for general consistency with `as`). There are two leading contenders for what the behavior ought to be:\r\n\r\n- Some sort of **defined result**\r\n    - Pro: This I think is **maximally consistent** with our general philosophy thus far. \r\n    - Con: There doesn't seem to be a truly portable way to produce any particular defined result in this case. This implies that we would be using platform-specific intrinsics with some sort of fallback for out of range values (for example, falling back to [saturation](https://github.com/rust-lang/rust/issues/10184#issuecomment-264480359), [this function that @oli-obk proposed](https://github.com/rust-lang/rust/issues/10184#issuecomment-194218954), to [Java's definition](https://github.com/rust-lang/rust/issues/10184#issuecomment-189192800), or to [whatever \"hairy C++\" JSC uses](https://github.com/rust-lang/rust/issues/10184#issuecomment-298956308).\r\n    - At worst, we can just insert some ifs for the \"out of range\" cases. \r\n- An **undefined value** (not undefined behavior)\r\n    - Pro: This lets us just use the platform-specific intrinsics that are available on each platform.\r\n    - Con: It's a portability hazard. In general, I feel like we've not made use of undefined results very often, at least in the *language* (I'm sure we do in the libs in various places).\r\n\r\nIt's not clear to me if there is a clear precedent for what the result **ought** to be in the first case?",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/299215573/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/299217627",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-299217627",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 299217627,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI5OTIxNzYyNw==",
    "user": {
      "login": "nikomatsakis",
      "id": 155238,
      "node_id": "MDQ6VXNlcjE1NTIzOA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/155238?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nikomatsakis",
      "html_url": "https://github.com/nikomatsakis",
      "followers_url": "https://api.github.com/users/nikomatsakis/followers",
      "following_url": "https://api.github.com/users/nikomatsakis/following{/other_user}",
      "gists_url": "https://api.github.com/users/nikomatsakis/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nikomatsakis/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nikomatsakis/subscriptions",
      "organizations_url": "https://api.github.com/users/nikomatsakis/orgs",
      "repos_url": "https://api.github.com/users/nikomatsakis/repos",
      "events_url": "https://api.github.com/users/nikomatsakis/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nikomatsakis/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2017-05-04T15:18:38Z",
    "updated_at": "2017-05-04T15:18:38Z",
    "body": "After having written that out, my preference would be to maintain a deterministic result. I feel like every place that we can hold the line on determinism is a win. I am not really sure *what* the result ought to be though.\r\n\r\nI like saturation because I can understand it and it seems useful, but it seems somehow incongruent with the way that `u64 as u32` does truncation. So perhaps some sort of result based on truncation makes sense, which I guess is [probably what @oli-obk proposed](https://github.com/rust-lang/rust/issues/10184#issuecomment-194218954) -- I don't fully understand what that code is intended to do. =)",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/299217627/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/299224360",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-299224360",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 299224360,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI5OTIyNDM2MA==",
    "user": {
      "login": "oli-obk",
      "id": 332036,
      "node_id": "MDQ6VXNlcjMzMjAzNg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/332036?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/oli-obk",
      "html_url": "https://github.com/oli-obk",
      "followers_url": "https://api.github.com/users/oli-obk/followers",
      "following_url": "https://api.github.com/users/oli-obk/following{/other_user}",
      "gists_url": "https://api.github.com/users/oli-obk/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/oli-obk/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/oli-obk/subscriptions",
      "organizations_url": "https://api.github.com/users/oli-obk/orgs",
      "repos_url": "https://api.github.com/users/oli-obk/repos",
      "events_url": "https://api.github.com/users/oli-obk/events{/privacy}",
      "received_events_url": "https://api.github.com/users/oli-obk/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2017-05-04T15:41:01Z",
    "updated_at": "2017-05-04T15:41:01Z",
    "body": "My code gives the correct value for things in the range 0..2^64 and deterministic but bogus values for everything else.\r\n\r\nfloats are represented by mantissa ^ exponent, e.g. `1.0` is `(2 << 52) ^ -52` and since bitshifts and exponents are the same thing in binary, we can just reverse the shift (thus the negation of the exponent and the right shift).",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/299224360/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/299229143",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-299229143",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 299229143,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI5OTIyOTE0Mw==",
    "user": {
      "login": "jorendorff",
      "id": 283361,
      "node_id": "MDQ6VXNlcjI4MzM2MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/283361?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jorendorff",
      "html_url": "https://github.com/jorendorff",
      "followers_url": "https://api.github.com/users/jorendorff/followers",
      "following_url": "https://api.github.com/users/jorendorff/following{/other_user}",
      "gists_url": "https://api.github.com/users/jorendorff/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jorendorff/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jorendorff/subscriptions",
      "organizations_url": "https://api.github.com/users/jorendorff/orgs",
      "repos_url": "https://api.github.com/users/jorendorff/repos",
      "events_url": "https://api.github.com/users/jorendorff/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jorendorff/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": true
    },
    "created_at": "2017-05-04T15:56:44Z",
    "updated_at": "2017-05-04T15:58:09Z",
    "body": "+1 for determinism.\r\n\r\nI see two semantics that make good sense for humans, and I think we should pick whichever one is faster **for values that are in range, when the compiler can't optimize away any of the computation**. (When the compiler knows that a value is in range, both options give the same results, so they are equally optimize-able.)\r\n\r\n* Saturation (out-of-range values become `IntType::max_value()`/`min_value()`)\r\n* Modulo (out-of-range values are treated as if by converting to a bigint first, then truncating)\r\n\r\nThe table below is meant to specify both options fully. `T` is any machine integer type. Tmin and Tmax are `T::min_value()` and `T::max_value()`. RTZ(v) means take the mathematical value of v and Round Toward Zero to get a mathematical integer.\r\n\r\n`v` | `v as T` (saturation) | `v as T` (modulo)\r\n---- | ---- | ----\r\nin range (Tmin <= v <= Tmax) | RTZ(v) | RTZ(v)\r\nnegative zero | 0 | 0\r\nNaN | 0 | 0\r\nInfinity | Tmax | 0\r\n-Infinity | Tmin | 0\r\nv > Tmax | Tmax | RTZ(v) truncated to fit T\r\nv &lt; Tmin | Tmin | RTZ(v) truncated to fit T\r\n\r\nThe ECMAScript standard specifies operations [ToInt32](https://tc39.github.io/ecma262/#sec-toint32), ToUint32, ToInt16, ToUint16, ToInt8, ToUint8, and my intent with the \"modulo\" option above is to match those operations in every case.\r\n\r\nECMAScript also specifies [ToInt8Clamp](https://tc39.github.io/ecma262/#sec-touint8clamp) which does *not* match either case above: it does \"round half to even\" rounding on fractional values rather than \"round to zero\".\r\n\r\n@oli-obk's suggestion is a third way, worth considering if it's faster to compute, for values that are in range.",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/299229143/reactions",
      "total_count": 3,
      "+1": 2,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 1,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/299230786",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-299230786",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 299230786,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI5OTIzMDc4Ng==",
    "user": {
      "login": "jorendorff",
      "id": 283361,
      "node_id": "MDQ6VXNlcjI4MzM2MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/283361?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jorendorff",
      "html_url": "https://github.com/jorendorff",
      "followers_url": "https://api.github.com/users/jorendorff/followers",
      "following_url": "https://api.github.com/users/jorendorff/following{/other_user}",
      "gists_url": "https://api.github.com/users/jorendorff/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jorendorff/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jorendorff/subscriptions",
      "organizations_url": "https://api.github.com/users/jorendorff/orgs",
      "repos_url": "https://api.github.com/users/jorendorff/repos",
      "events_url": "https://api.github.com/users/jorendorff/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jorendorff/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": true
    },
    "created_at": "2017-05-04T16:02:06Z",
    "updated_at": "2017-05-04T16:02:06Z",
    "body": "@oli-obk What about signed integer types?",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/299230786/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/299678208",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-299678208",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 299678208,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI5OTY3ODIwOA==",
    "user": {
      "login": "est31",
      "id": 8872119,
      "node_id": "MDQ6VXNlcjg4NzIxMTk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8872119?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/est31",
      "html_url": "https://github.com/est31",
      "followers_url": "https://api.github.com/users/est31/followers",
      "following_url": "https://api.github.com/users/est31/following{/other_user}",
      "gists_url": "https://api.github.com/users/est31/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/est31/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/est31/subscriptions",
      "organizations_url": "https://api.github.com/users/est31/orgs",
      "repos_url": "https://api.github.com/users/est31/repos",
      "events_url": "https://api.github.com/users/est31/events{/privacy}",
      "received_events_url": "https://api.github.com/users/est31/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2017-05-07T02:32:29Z",
    "updated_at": "2017-05-07T02:32:29Z",
    "body": "Related https://github.com/rust-lang/rust/issues/41799",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/299678208/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/299897115",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-299897115",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 299897115,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI5OTg5NzExNQ==",
    "user": {
      "login": "Manishearth",
      "id": 1617736,
      "node_id": "MDQ6VXNlcjE2MTc3MzY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1617736?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Manishearth",
      "html_url": "https://github.com/Manishearth",
      "followers_url": "https://api.github.com/users/Manishearth/followers",
      "following_url": "https://api.github.com/users/Manishearth/following{/other_user}",
      "gists_url": "https://api.github.com/users/Manishearth/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Manishearth/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Manishearth/subscriptions",
      "organizations_url": "https://api.github.com/users/Manishearth/orgs",
      "repos_url": "https://api.github.com/users/Manishearth/repos",
      "events_url": "https://api.github.com/users/Manishearth/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Manishearth/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2017-05-08T15:18:23Z",
    "updated_at": "2017-05-08T15:18:23Z",
    "body": "Throwing another proposal into the mix: Mark u128 casts to floats as unsafe and force folks to explicitly choose a way of handling it. u128 is pretty rare currently.",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/299897115/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/299899311",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-299899311",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 299899311,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI5OTg5OTMxMQ==",
    "user": {
      "login": "nagisa",
      "id": 679122,
      "node_id": "MDQ6VXNlcjY3OTEyMg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/679122?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nagisa",
      "html_url": "https://github.com/nagisa",
      "followers_url": "https://api.github.com/users/nagisa/followers",
      "following_url": "https://api.github.com/users/nagisa/following{/other_user}",
      "gists_url": "https://api.github.com/users/nagisa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nagisa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nagisa/subscriptions",
      "organizations_url": "https://api.github.com/users/nagisa/orgs",
      "repos_url": "https://api.github.com/users/nagisa/repos",
      "events_url": "https://api.github.com/users/nagisa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nagisa/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2017-05-08T15:24:58Z",
    "updated_at": "2017-05-08T15:36:21Z",
    "body": "@Manishearth I\u2019d hope for similar semantics integers \u2192 floats as floats \u2192 integers. Since both are UB-ful, and we cannot make float\u2192integer unsafe anymore, we should probably avoid making integer\u2192float unsafe as well.\r\n\r\nFor float\u2192integer saturating will be faster AFAICT (resulting in a sequence of `and`, ~~test+jump~~ float comparison and jump, all for ~~0.66 or 0.5~~ 2-3 cycles on modern arches). I personally couldn\u2019t care less for what exact behaviour we decide on as long as the in-range values are as fast as they possibly could be.",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/299899311/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/299900220",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-299900220",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 299900220,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI5OTkwMDIyMA==",
    "user": {
      "login": "CryZe",
      "id": 1451630,
      "node_id": "MDQ6VXNlcjE0NTE2MzA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1451630?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/CryZe",
      "html_url": "https://github.com/CryZe",
      "followers_url": "https://api.github.com/users/CryZe/followers",
      "following_url": "https://api.github.com/users/CryZe/following{/other_user}",
      "gists_url": "https://api.github.com/users/CryZe/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/CryZe/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/CryZe/subscriptions",
      "organizations_url": "https://api.github.com/users/CryZe/orgs",
      "repos_url": "https://api.github.com/users/CryZe/repos",
      "events_url": "https://api.github.com/users/CryZe/events{/privacy}",
      "received_events_url": "https://api.github.com/users/CryZe/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2017-05-08T15:27:36Z",
    "updated_at": "2017-05-08T15:27:36Z",
    "body": "Wouldn't it make sense to make it behave like overflow? So in a debug build it would panic if you do a cast with undefined behaviour. Then you could have methods for specifying the casting behaviour like `1.04E+17.saturating_cast::<u8>()`, `unsafe { 1.04E+17.unsafe_cast::<u8>() }` and potentially others.",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/299900220/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/299901482",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-299901482",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 299901482,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI5OTkwMTQ4Mg==",
    "user": {
      "login": "Manishearth",
      "id": 1617736,
      "node_id": "MDQ6VXNlcjE2MTc3MzY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1617736?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Manishearth",
      "html_url": "https://github.com/Manishearth",
      "followers_url": "https://api.github.com/users/Manishearth/followers",
      "following_url": "https://api.github.com/users/Manishearth/following{/other_user}",
      "gists_url": "https://api.github.com/users/Manishearth/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Manishearth/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Manishearth/subscriptions",
      "organizations_url": "https://api.github.com/users/Manishearth/orgs",
      "repos_url": "https://api.github.com/users/Manishearth/repos",
      "events_url": "https://api.github.com/users/Manishearth/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Manishearth/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2017-05-08T15:31:25Z",
    "updated_at": "2017-05-08T15:31:25Z",
    "body": "Oh, I thought the issue was only for u128, and we can make that unsafe both ways.\r\n\r\n@cryze UB should not exist even in release mode in safe code. The overflow stuff is still defined behavior.\r\n\r\nThat said, panic on debug, and <some safe solution> on release would be great.",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/299901482/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/299905048",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-299905048",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 299905048,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI5OTkwNTA0OA==",
    "user": {
      "login": "Gankra",
      "id": 1136864,
      "node_id": "MDQ6VXNlcjExMzY4NjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1136864?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Gankra",
      "html_url": "https://github.com/Gankra",
      "followers_url": "https://api.github.com/users/Gankra/followers",
      "following_url": "https://api.github.com/users/Gankra/following{/other_user}",
      "gists_url": "https://api.github.com/users/Gankra/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Gankra/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Gankra/subscriptions",
      "organizations_url": "https://api.github.com/users/Gankra/orgs",
      "repos_url": "https://api.github.com/users/Gankra/repos",
      "events_url": "https://api.github.com/users/Gankra/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Gankra/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2017-05-08T15:42:53Z",
    "updated_at": "2017-05-08T15:46:39Z",
    "body": "This affects:\r\n\r\n* `f32 -> u8, u16, u32, u64, u128, usize` (`-1f32 as _` for all, `f32::MAX as _` for all but u128) \r\n* `f32 -> i8, i16, i32, i64, i128, isize` (`f32::MAX as _` for all)\r\n* `f64` -> all ints (`f64::MAX as _` for all)",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/299905048/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/299907719",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-299907719",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 299907719,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI5OTkwNzcxOQ==",
    "user": {
      "login": "nagisa",
      "id": 679122,
      "node_id": "MDQ6VXNlcjY3OTEyMg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/679122?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nagisa",
      "html_url": "https://github.com/nagisa",
      "followers_url": "https://api.github.com/users/nagisa/followers",
      "following_url": "https://api.github.com/users/nagisa/following{/other_user}",
      "gists_url": "https://api.github.com/users/nagisa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nagisa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nagisa/subscriptions",
      "organizations_url": "https://api.github.com/users/nagisa/orgs",
      "repos_url": "https://api.github.com/users/nagisa/repos",
      "events_url": "https://api.github.com/users/nagisa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nagisa/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2017-05-08T15:52:08Z",
    "updated_at": "2017-05-08T15:52:08Z",
    "body": "`f32::INFINITY as u128` is also UB",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/299907719/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/299954667",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-299954667",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 299954667,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI5OTk1NDY2Nw==",
    "user": {
      "login": "nikomatsakis",
      "id": 155238,
      "node_id": "MDQ6VXNlcjE1NTIzOA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/155238?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nikomatsakis",
      "html_url": "https://github.com/nikomatsakis",
      "followers_url": "https://api.github.com/users/nikomatsakis/followers",
      "following_url": "https://api.github.com/users/nikomatsakis/following{/other_user}",
      "gists_url": "https://api.github.com/users/nikomatsakis/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nikomatsakis/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nikomatsakis/subscriptions",
      "organizations_url": "https://api.github.com/users/nikomatsakis/orgs",
      "repos_url": "https://api.github.com/users/nikomatsakis/repos",
      "events_url": "https://api.github.com/users/nikomatsakis/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nikomatsakis/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2017-05-08T18:42:58Z",
    "updated_at": "2017-05-08T18:43:41Z",
    "body": "@CryZe \r\n\r\n> Wouldn't it make sense to make it behave like overflow?  So in a debug build it would panic if you do a cast with undefined behaviour.\r\n\r\nThis is what I thought initially, but I was reminded that `as` conversions never panic at present (we don't do overflow checking with `as`, for better or worse). So the most analogous thing is for it to \"do something defined\".",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/299954667/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/299975401",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-299975401",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 299975401,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI5OTk3NTQwMQ==",
    "user": {
      "login": "comex",
      "id": 47517,
      "node_id": "MDQ6VXNlcjQ3NTE3",
      "avatar_url": "https://avatars.githubusercontent.com/u/47517?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/comex",
      "html_url": "https://github.com/comex",
      "followers_url": "https://api.github.com/users/comex/followers",
      "following_url": "https://api.github.com/users/comex/following{/other_user}",
      "gists_url": "https://api.github.com/users/comex/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/comex/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/comex/subscriptions",
      "organizations_url": "https://api.github.com/users/comex/orgs",
      "repos_url": "https://api.github.com/users/comex/repos",
      "events_url": "https://api.github.com/users/comex/events{/privacy}",
      "received_events_url": "https://api.github.com/users/comex/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2017-05-08T20:05:47Z",
    "updated_at": "2017-05-08T20:05:47Z",
    "body": "FWIW, the \"kill undef\" thing would, in fact,  provide a way to fix the memory unsafety, but leaving the result nondeterministic.  One of the key components is:\r\n\r\n> 3) Create a new instruction, '%y = freeze %x', that stops propagation of\r\npoison.  If the input is poison, then it returns an arbitrary, but fixed,\r\nvalue. (like old undef, but each use gets the *same* value), otherwise it\r\njust returns its input value.\r\n\r\nThe reason undefs can be used to violate memory safety today is that they can magically change values between uses: in particular, between a bounds check and subsequent pointer arithmetic.  If rustc added a freeze after every dangerous cast, you would just get an unknown but otherwise well-behaved value.  Performance-wise, freeze is basically free here, since of course the machine instruction corresponding to the cast produces a single value, not a fluctuating one; even if the optimizer feels like duplicating the cast instruction for some reason, it should be safe to do so because the result for out-of-range inputs is usually deterministic on a given architecture.\r\n\r\n...But not deterministic across architectures, if anyone was wondering.  x86 returns 0x80000000 for all bad inputs; ARM saturates for out-of-range inputs and (if I'm reading this pseudocode right) returns 0 for NaN.  So if the goal is to produce a deterministic and *platform-independent result*, it's not enough to just use the platform's fp-to-int intrinsic; at least on ARM you also need to check the status register for an exception.  This may have some overhead in itself, and certainly prevents autovectorization in the unlikely event that using the intrinsic didn't already.  Alternately, I guess you could explicitly test for in-range values using regular compare operations and then use a regular float-to-int.  That sounds a lot nicer on the optimizer\u2026",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/299975401/reactions",
      "total_count": 5,
      "+1": 5,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/300879438",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-300879438",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 300879438,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMwMDg3OTQzOA==",
    "user": {
      "login": "SimonSapin",
      "id": 291359,
      "node_id": "MDQ6VXNlcjI5MTM1OQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/291359?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/SimonSapin",
      "html_url": "https://github.com/SimonSapin",
      "followers_url": "https://api.github.com/users/SimonSapin/followers",
      "following_url": "https://api.github.com/users/SimonSapin/following{/other_user}",
      "gists_url": "https://api.github.com/users/SimonSapin/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/SimonSapin/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/SimonSapin/subscriptions",
      "organizations_url": "https://api.github.com/users/SimonSapin/orgs",
      "repos_url": "https://api.github.com/users/SimonSapin/repos",
      "events_url": "https://api.github.com/users/SimonSapin/events{/privacy}",
      "received_events_url": "https://api.github.com/users/SimonSapin/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2017-05-11T18:37:08Z",
    "updated_at": "2017-05-11T18:37:08Z",
    "body": "> `as` conversions never panic at present\r\n\r\nAt some point we changed `+` to panic (on debug mode). I wouldn\u2019t be shocked to see `as` panic in cases that were previously UB.",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/300879438/reactions",
      "total_count": 6,
      "+1": 6,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/301309507",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-301309507",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 301309507,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMwMTMwOTUwNw==",
    "user": {
      "login": "glaebhoerl",
      "id": 1216629,
      "node_id": "MDQ6VXNlcjEyMTY2Mjk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1216629?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/glaebhoerl",
      "html_url": "https://github.com/glaebhoerl",
      "followers_url": "https://api.github.com/users/glaebhoerl/followers",
      "following_url": "https://api.github.com/users/glaebhoerl/following{/other_user}",
      "gists_url": "https://api.github.com/users/glaebhoerl/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/glaebhoerl/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/glaebhoerl/subscriptions",
      "organizations_url": "https://api.github.com/users/glaebhoerl/orgs",
      "repos_url": "https://api.github.com/users/glaebhoerl/repos",
      "events_url": "https://api.github.com/users/glaebhoerl/events{/privacy}",
      "received_events_url": "https://api.github.com/users/glaebhoerl/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2017-05-14T12:34:46Z",
    "updated_at": "2017-05-14T12:34:46Z",
    "body": "If we care about checking (which we should), then we should either deprecate `as` (is there any use case where it's the only good option?) or at least advise against using it, and move people onto things like `TryFrom` and `TryInto` instead, which is what we [said](https://internals.rust-lang.org/t/on-casts-and-checked-overflow/1710/44) we were planning to do back when it was decided to leave `as` as-is. I don't feel that the cases under discussion are qualitatively different, *in the abstract*, from the cases where `as` is already defined not to do any checks. The difference is just that *in practice* the implementation for these cases is currently incomplete and has UB. A world where you can't rely on `as` doing checks (because for most types, it doesn't), *and* you can't rely on it not panicking (because for some types, it would), *and* it's not consistent, *and* we still haven't deprecated it seems like the worst of all of them to me.\r\n\r\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/301309507/reactions",
      "total_count": 3,
      "+1": 3,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/302198137",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-302198137",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 302198137,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMwMjE5ODEzNw==",
    "user": {
      "login": "nikomatsakis",
      "id": 155238,
      "node_id": "MDQ6VXNlcjE1NTIzOA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/155238?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nikomatsakis",
      "html_url": "https://github.com/nikomatsakis",
      "followers_url": "https://api.github.com/users/nikomatsakis/followers",
      "following_url": "https://api.github.com/users/nikomatsakis/following{/other_user}",
      "gists_url": "https://api.github.com/users/nikomatsakis/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nikomatsakis/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nikomatsakis/subscriptions",
      "organizations_url": "https://api.github.com/users/nikomatsakis/orgs",
      "repos_url": "https://api.github.com/users/nikomatsakis/repos",
      "events_url": "https://api.github.com/users/nikomatsakis/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nikomatsakis/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2017-05-17T19:08:21Z",
    "updated_at": "2017-05-17T19:08:21Z",
    "body": "So, I think at this point @jorendorff basically enumerated [what seems to me to be the best plan](https://github.com/rust-lang/rust/issues/10184#issuecomment-299229143):\r\n\r\n- `as` will have some deterministic behavior;\r\n- we'll pick a behavior based on a combination of how sensible it is, and how efficient it is\r\n\r\nHe enumerated three possibilities. I think the remaining work is to investigate those possibilities -- or at least investigate **one** of them. That is, actually implement it, and try to get some feeling for how \"slow\" or \"fast\" it is. \r\n\r\nIs there anyone out there who feels motivated to take a stab at that? I'm going to tag this as `E-help-wanted` in hopes of attracting some a person. (@oli-obk?)",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/302198137/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/307390680",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-307390680",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 307390680,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMwNzM5MDY4MA==",
    "user": {
      "login": "kornelski",
      "id": 72159,
      "node_id": "MDQ6VXNlcjcyMTU5",
      "avatar_url": "https://avatars.githubusercontent.com/u/72159?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/kornelski",
      "html_url": "https://github.com/kornelski",
      "followers_url": "https://api.github.com/users/kornelski/followers",
      "following_url": "https://api.github.com/users/kornelski/following{/other_user}",
      "gists_url": "https://api.github.com/users/kornelski/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/kornelski/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kornelski/subscriptions",
      "organizations_url": "https://api.github.com/users/kornelski/orgs",
      "repos_url": "https://api.github.com/users/kornelski/repos",
      "events_url": "https://api.github.com/users/kornelski/events{/privacy}",
      "received_events_url": "https://api.github.com/users/kornelski/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2017-06-09T13:37:24Z",
    "updated_at": "2017-06-09T13:38:16Z",
    "body": "Uh, I'd rather not pay price for *cross-platform* consistency :/ It's garbage-in, I don't care what garbage goes out (however a debug assertion would be super helpful).\r\n\r\nCurrently all rounding/truncating functions in Rust are very slow (function calls with painstakingly precise implementations), so the `as` is my last resort hack for fast float rounding.\r\n\r\nIf you're going to make `as` anything more than bare `cvttss2si`, please also add a stable alternative that is just that.",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/307390680/reactions",
      "total_count": 3,
      "+1": 3,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/307420456",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-307420456",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 307420456,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMwNzQyMDQ1Ng==",
    "user": {
      "login": "est31",
      "id": 8872119,
      "node_id": "MDQ6VXNlcjg4NzIxMTk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8872119?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/est31",
      "html_url": "https://github.com/est31",
      "followers_url": "https://api.github.com/users/est31/followers",
      "following_url": "https://api.github.com/users/est31/following{/other_user}",
      "gists_url": "https://api.github.com/users/est31/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/est31/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/est31/subscriptions",
      "organizations_url": "https://api.github.com/users/est31/orgs",
      "repos_url": "https://api.github.com/users/est31/repos",
      "events_url": "https://api.github.com/users/est31/events{/privacy}",
      "received_events_url": "https://api.github.com/users/est31/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2017-06-09T15:28:12Z",
    "updated_at": "2017-06-09T15:28:12Z",
    "body": "@pornel this isn't just UB of the theoretic kind where stuff is okay if you ignore that it is ub, it has real world implications. I've extracted #41799 from a real world code example.",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/307420456/reactions",
      "total_count": 3,
      "+1": 3,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/307435788",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-307435788",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 307435788,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMwNzQzNTc4OA==",
    "user": {
      "login": "kornelski",
      "id": 72159,
      "node_id": "MDQ6VXNlcjcyMTU5",
      "avatar_url": "https://avatars.githubusercontent.com/u/72159?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/kornelski",
      "html_url": "https://github.com/kornelski",
      "followers_url": "https://api.github.com/users/kornelski/followers",
      "following_url": "https://api.github.com/users/kornelski/following{/other_user}",
      "gists_url": "https://api.github.com/users/kornelski/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/kornelski/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kornelski/subscriptions",
      "organizations_url": "https://api.github.com/users/kornelski/orgs",
      "repos_url": "https://api.github.com/users/kornelski/repos",
      "events_url": "https://api.github.com/users/kornelski/events{/privacy}",
      "received_events_url": "https://api.github.com/users/kornelski/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2017-06-09T16:26:59Z",
    "updated_at": "2017-06-09T16:28:33Z",
    "body": "@est31 I agree that leaving it as UB is wrong, but I've seen `freeze` proposed as a solution to UB. AFAIK that makes it a defined deterministic value, you just don't get to say which. That behavior is fine with me. \r\n\r\nSo I'd be fine if e.g. `u128::MAX as f32` deterministically produced `17.5` on x86, and `999.0` on x86-64, and `-555` on ARM. ",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/307435788/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/307437745",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-307437745",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 307437745,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMwNzQzNzc0NQ==",
    "user": {
      "login": "hanna-kruppe",
      "id": 2311707,
      "node_id": "MDQ6VXNlcjIzMTE3MDc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2311707?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hanna-kruppe",
      "html_url": "https://github.com/hanna-kruppe",
      "followers_url": "https://api.github.com/users/hanna-kruppe/followers",
      "following_url": "https://api.github.com/users/hanna-kruppe/following{/other_user}",
      "gists_url": "https://api.github.com/users/hanna-kruppe/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hanna-kruppe/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hanna-kruppe/subscriptions",
      "organizations_url": "https://api.github.com/users/hanna-kruppe/orgs",
      "repos_url": "https://api.github.com/users/hanna-kruppe/repos",
      "events_url": "https://api.github.com/users/hanna-kruppe/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hanna-kruppe/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2017-06-09T16:34:54Z",
    "updated_at": "2017-06-09T16:35:05Z",
    "body": "`freeze` would not produce a defined, deterministic, unspecified value. Its result is still \"any bit pattern the compiler likes\", and it is consistent only across uses of the same operation. This may sidestep the UB-producing examples people have collected above, but it would not give this:\r\n\r\n> u128::MAX as f32 deterministically produced 17.5 on x86, and 999.0 on x86-64, and -555 on ARM.\r\n\r\nFor example, if LLVM notices that `u128::MAX as f32` overflows and replaces it with `freeze poison`, a valid lowering of `fn foo() -> f32 { u128::MAX as f32 }` on x86_64 might be this:\r\n\r\n```\r\nfoo:\r\n  ret\r\n```\r\n\r\n(that is, just return whatever was last stored in the return register)",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/307437745/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/307438868",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-307438868",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 307438868,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMwNzQzODg2OA==",
    "user": {
      "login": "kornelski",
      "id": 72159,
      "node_id": "MDQ6VXNlcjcyMTU5",
      "avatar_url": "https://avatars.githubusercontent.com/u/72159?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/kornelski",
      "html_url": "https://github.com/kornelski",
      "followers_url": "https://api.github.com/users/kornelski/followers",
      "following_url": "https://api.github.com/users/kornelski/following{/other_user}",
      "gists_url": "https://api.github.com/users/kornelski/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/kornelski/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kornelski/subscriptions",
      "organizations_url": "https://api.github.com/users/kornelski/orgs",
      "repos_url": "https://api.github.com/users/kornelski/repos",
      "events_url": "https://api.github.com/users/kornelski/events{/privacy}",
      "received_events_url": "https://api.github.com/users/kornelski/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2017-06-09T16:39:56Z",
    "updated_at": "2017-06-09T16:39:56Z",
    "body": "I see. That's still acceptable for my uses (for cases where I expect out of range values, I do clamping beforehand. Where I expect values in range, but they aren't, then I'm not going to get a correct result no matter what).",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/307438868/reactions",
      "total_count": 2,
      "+1": 2,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/307447573",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-307447573",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 307447573,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMwNzQ0NzU3Mw==",
    "user": {
      "login": "retep998",
      "id": 666308,
      "node_id": "MDQ6VXNlcjY2NjMwOA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/666308?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/retep998",
      "html_url": "https://github.com/retep998",
      "followers_url": "https://api.github.com/users/retep998/followers",
      "following_url": "https://api.github.com/users/retep998/following{/other_user}",
      "gists_url": "https://api.github.com/users/retep998/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/retep998/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/retep998/subscriptions",
      "organizations_url": "https://api.github.com/users/retep998/orgs",
      "repos_url": "https://api.github.com/users/retep998/repos",
      "events_url": "https://api.github.com/users/retep998/events{/privacy}",
      "received_events_url": "https://api.github.com/users/retep998/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2017-06-09T17:16:25Z",
    "updated_at": "2017-06-09T17:16:25Z",
    "body": "I have no problem with out of range float casts returning arbitrary values as long as the values are frozen so they can't cause further undefined behavior.",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/307447573/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/307504504",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-307504504",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 307504504,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMwNzUwNDUwNA==",
    "user": {
      "login": "nikomatsakis",
      "id": 155238,
      "node_id": "MDQ6VXNlcjE1NTIzOA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/155238?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nikomatsakis",
      "html_url": "https://github.com/nikomatsakis",
      "followers_url": "https://api.github.com/users/nikomatsakis/followers",
      "following_url": "https://api.github.com/users/nikomatsakis/following{/other_user}",
      "gists_url": "https://api.github.com/users/nikomatsakis/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nikomatsakis/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nikomatsakis/subscriptions",
      "organizations_url": "https://api.github.com/users/nikomatsakis/orgs",
      "repos_url": "https://api.github.com/users/nikomatsakis/repos",
      "events_url": "https://api.github.com/users/nikomatsakis/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nikomatsakis/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2017-06-09T21:30:07Z",
    "updated_at": "2017-06-09T21:30:07Z",
    "body": "Is something like `freeze` available on LLVM? I thought that was a purely theoretical construct.",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/307504504/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/307505101",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-307505101",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 307505101,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMwNzUwNTEwMQ==",
    "user": {
      "login": "eddyb",
      "id": 77424,
      "node_id": "MDQ6VXNlcjc3NDI0",
      "avatar_url": "https://avatars.githubusercontent.com/u/77424?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/eddyb",
      "html_url": "https://github.com/eddyb",
      "followers_url": "https://api.github.com/users/eddyb/followers",
      "following_url": "https://api.github.com/users/eddyb/following{/other_user}",
      "gists_url": "https://api.github.com/users/eddyb/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/eddyb/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/eddyb/subscriptions",
      "organizations_url": "https://api.github.com/users/eddyb/orgs",
      "repos_url": "https://api.github.com/users/eddyb/repos",
      "events_url": "https://api.github.com/users/eddyb/events{/privacy}",
      "received_events_url": "https://api.github.com/users/eddyb/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2017-06-09T21:33:29Z",
    "updated_at": "2017-06-09T21:33:29Z",
    "body": "@nikomatsakis I've never seen it used like that (unlike `poison`) - it's a planned revamp of poison/undef.",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/307505101/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/307505840",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-307505840",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 307505840,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMwNzUwNTg0MA==",
    "user": {
      "login": "hanna-kruppe",
      "id": 2311707,
      "node_id": "MDQ6VXNlcjIzMTE3MDc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2311707?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hanna-kruppe",
      "html_url": "https://github.com/hanna-kruppe",
      "followers_url": "https://api.github.com/users/hanna-kruppe/followers",
      "following_url": "https://api.github.com/users/hanna-kruppe/following{/other_user}",
      "gists_url": "https://api.github.com/users/hanna-kruppe/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hanna-kruppe/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hanna-kruppe/subscriptions",
      "organizations_url": "https://api.github.com/users/hanna-kruppe/orgs",
      "repos_url": "https://api.github.com/users/hanna-kruppe/repos",
      "events_url": "https://api.github.com/users/hanna-kruppe/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hanna-kruppe/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2017-06-09T21:37:37Z",
    "updated_at": "2017-06-09T21:37:37Z",
    "body": "`freeze` does not exist at all in LLVM today. It's only been proposed ([this PLDI paper](http://www.cs.utah.edu/~regehr/papers/undef-pldi17.pdf) is a self-contained version, but it's also been discussed a lot on the mailing list). The proposal seems to have considerable buy-in, but of course that is no guarantee it will be adopted, much less adopted in a timely manner. (Removing the pointee types from pointer types has been accepted for years and it's still not done.)",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/307505840/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/308484940",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-308484940",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 308484940,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMwODQ4NDk0MA==",
    "user": {
      "login": "bstrie",
      "id": 865233,
      "node_id": "MDQ6VXNlcjg2NTIzMw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/865233?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/bstrie",
      "html_url": "https://github.com/bstrie",
      "followers_url": "https://api.github.com/users/bstrie/followers",
      "following_url": "https://api.github.com/users/bstrie/following{/other_user}",
      "gists_url": "https://api.github.com/users/bstrie/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/bstrie/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/bstrie/subscriptions",
      "organizations_url": "https://api.github.com/users/bstrie/orgs",
      "repos_url": "https://api.github.com/users/bstrie/repos",
      "events_url": "https://api.github.com/users/bstrie/events{/privacy}",
      "received_events_url": "https://api.github.com/users/bstrie/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2017-06-14T16:25:56Z",
    "updated_at": "2017-06-14T16:25:56Z",
    "body": "Do we want to open up an RFC to get more widespread discussion on the changes being proposed here? IMO, anything that potentially impacts the performance of `as` is going to be contentious, but it will be doubly contentious if we don't give people the chance to make their voice heard.",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/308484940/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/308558398",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-308558398",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 308558398,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMwODU1ODM5OA==",
    "user": {
      "login": "simonbyrne",
      "id": 1692009,
      "node_id": "MDQ6VXNlcjE2OTIwMDk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1692009?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/simonbyrne",
      "html_url": "https://github.com/simonbyrne",
      "followers_url": "https://api.github.com/users/simonbyrne/followers",
      "following_url": "https://api.github.com/users/simonbyrne/following{/other_user}",
      "gists_url": "https://api.github.com/users/simonbyrne/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/simonbyrne/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/simonbyrne/subscriptions",
      "organizations_url": "https://api.github.com/users/simonbyrne/orgs",
      "repos_url": "https://api.github.com/users/simonbyrne/repos",
      "events_url": "https://api.github.com/users/simonbyrne/events{/privacy}",
      "received_events_url": "https://api.github.com/users/simonbyrne/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2017-06-14T21:07:06Z",
    "updated_at": "2017-06-14T21:07:06Z",
    "body": "I'm a Julia developer, and I've been following this issue for a while, as we share the same LLVM backend and so have similar issues. In case it's of interest, here is what we have settled on (with approximate timings for a single function on my machine):\r\n* `unsafe_trunc(Int64, x)` maps directly to the corresponding LLVM intrinsic `fptosi` (1.5 ns)\r\n* `trunc(Int64, x)` throws an exception for out of range values (3 ns)\r\n* `convert(Int64, x)` throws an exception for out of range or non-integer values (6 ns)\r\n\r\nAlso, I have [asked on the mailing list](http://lists.llvm.org/pipermail/llvm-dev/2016-January/094405.html) about making the undefined behaviour a little more defined, but did not receive a very promising response.",
    "author_association": "NONE",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/308558398/reactions",
      "total_count": 22,
      "+1": 6,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 16,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/308570586",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-308570586",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 308570586,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMwODU3MDU4Ng==",
    "user": {
      "login": "nikomatsakis",
      "id": 155238,
      "node_id": "MDQ6VXNlcjE1NTIzOA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/155238?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nikomatsakis",
      "html_url": "https://github.com/nikomatsakis",
      "followers_url": "https://api.github.com/users/nikomatsakis/followers",
      "following_url": "https://api.github.com/users/nikomatsakis/following{/other_user}",
      "gists_url": "https://api.github.com/users/nikomatsakis/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nikomatsakis/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nikomatsakis/subscriptions",
      "organizations_url": "https://api.github.com/users/nikomatsakis/orgs",
      "repos_url": "https://api.github.com/users/nikomatsakis/repos",
      "events_url": "https://api.github.com/users/nikomatsakis/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nikomatsakis/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2017-06-14T21:59:39Z",
    "updated_at": "2017-06-14T21:59:39Z",
    "body": "@bstrie I'm fine with an RFC, but I think it'd definitely be useful to have data! @simonbyrne's comment is super helpful in that regard, however.",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/308570586/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/326725066",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-326725066",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 326725066,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMyNjcyNTA2Ng==",
    "user": {
      "login": "alexcrichton",
      "id": 64996,
      "node_id": "MDQ6VXNlcjY0OTk2",
      "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alexcrichton",
      "html_url": "https://github.com/alexcrichton",
      "followers_url": "https://api.github.com/users/alexcrichton/followers",
      "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}",
      "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions",
      "organizations_url": "https://api.github.com/users/alexcrichton/orgs",
      "repos_url": "https://api.github.com/users/alexcrichton/repos",
      "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alexcrichton/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2017-09-02T06:11:17Z",
    "updated_at": "2017-09-02T06:11:17Z",
    "body": "I've toyed around with [JS semantics](https://jsfiddle.net/5vxe5zbr/) (the modulo @jorendorff mentioned) and the [Java semantics](https://ideone.com/lLxCSa) which appear to be the \"saturation\" column. In case those links expire it's [JS](https://gist.github.com/alexcrichton/c49d960f631fcb78e1fcb53c79e8fe91) and [Java](https://gist.github.com/alexcrichton/cfadf366b00f7ca9a78ddc6c1fb1437d).\r\n\r\nI also whipped up a [quick implementation of saturation in Rust](https://gist.github.com/aed8ef41b605aed133ddaec22fd87102) which I think (?) is correct. And got some [benchmark numbers](https://gist.github.com/4ba4aa188bffbc568dea737067ad213e) as well. Interestingly I'm seeing that the saturating implementation is 2-3x slower than the intrinsic, which is different from what @simonbyrne found with only 2x slower.\r\n\r\nI'm not entirely sure how to implement the \"mod\" semantics in Rust...\r\n\r\nTo me, though, it seems clear that we'll need a slew of `f32::as_u32_unchecked()` methods and such for those who need the performance.",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/326725066/reactions",
      "total_count": 1,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 1,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/326727004",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-326727004",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 326727004,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMyNjcyNzAwNA==",
    "user": {
      "login": "eddyb",
      "id": 77424,
      "node_id": "MDQ6VXNlcjc3NDI0",
      "avatar_url": "https://avatars.githubusercontent.com/u/77424?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/eddyb",
      "html_url": "https://github.com/eddyb",
      "followers_url": "https://api.github.com/users/eddyb/followers",
      "following_url": "https://api.github.com/users/eddyb/following{/other_user}",
      "gists_url": "https://api.github.com/users/eddyb/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/eddyb/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/eddyb/subscriptions",
      "organizations_url": "https://api.github.com/users/eddyb/orgs",
      "repos_url": "https://api.github.com/users/eddyb/repos",
      "events_url": "https://api.github.com/users/eddyb/events{/privacy}",
      "received_events_url": "https://api.github.com/users/eddyb/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2017-09-02T07:00:12Z",
    "updated_at": "2017-09-02T07:00:12Z",
    "body": "> it seems clear that we'll need a slew of `f32::as_u32_unchecked()` methods and such for those who need the performance.\r\n\r\nThat's a bummer - or do you mean a safe but implementation-defined variant?",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/326727004/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/326727975",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-326727975",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 326727975,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMyNjcyNzk3NQ==",
    "user": {
      "login": "Manishearth",
      "id": 1617736,
      "node_id": "MDQ6VXNlcjE2MTc3MzY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1617736?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Manishearth",
      "html_url": "https://github.com/Manishearth",
      "followers_url": "https://api.github.com/users/Manishearth/followers",
      "following_url": "https://api.github.com/users/Manishearth/following{/other_user}",
      "gists_url": "https://api.github.com/users/Manishearth/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Manishearth/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Manishearth/subscriptions",
      "organizations_url": "https://api.github.com/users/Manishearth/orgs",
      "repos_url": "https://api.github.com/users/Manishearth/repos",
      "events_url": "https://api.github.com/users/Manishearth/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Manishearth/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2017-09-02T07:24:04Z",
    "updated_at": "2017-09-02T07:24:04Z",
    "body": "Is there no option for an implementation defined fast default?",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/326727975/reactions",
      "total_count": 4,
      "+1": 4,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/326752357",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-326752357",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 326752357,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMyNjc1MjM1Nw==",
    "user": {
      "login": "alexcrichton",
      "id": 64996,
      "node_id": "MDQ6VXNlcjY0OTk2",
      "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alexcrichton",
      "html_url": "https://github.com/alexcrichton",
      "followers_url": "https://api.github.com/users/alexcrichton/followers",
      "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}",
      "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions",
      "organizations_url": "https://api.github.com/users/alexcrichton/orgs",
      "repos_url": "https://api.github.com/users/alexcrichton/repos",
      "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alexcrichton/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2017-09-02T15:51:57Z",
    "updated_at": "2017-09-02T15:51:57Z",
    "body": "@eddyb I was thinking that we'd just have `unsafe fn as_u32_unchecked(self) -> u32` on `f32` and such which is a direct analog to what `as` is today.\r\n\r\nI'm certainly not going to claim that the Rust implementation I wrote is optimal, but I was under the impression that when reading this thread determinism and safety were more important than speed in this context most of the time. The `unsafe` escape hatch is for those on the other side of the fence.",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/326752357/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/326752780",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-326752780",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 326752780,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMyNjc1Mjc4MA==",
    "user": {
      "login": "eddyb",
      "id": 77424,
      "node_id": "MDQ6VXNlcjc3NDI0",
      "avatar_url": "https://avatars.githubusercontent.com/u/77424?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/eddyb",
      "html_url": "https://github.com/eddyb",
      "followers_url": "https://api.github.com/users/eddyb/followers",
      "following_url": "https://api.github.com/users/eddyb/following{/other_user}",
      "gists_url": "https://api.github.com/users/eddyb/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/eddyb/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/eddyb/subscriptions",
      "organizations_url": "https://api.github.com/users/eddyb/orgs",
      "repos_url": "https://api.github.com/users/eddyb/repos",
      "events_url": "https://api.github.com/users/eddyb/events{/privacy}",
      "received_events_url": "https://api.github.com/users/eddyb/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2017-09-02T15:58:50Z",
    "updated_at": "2017-09-02T15:58:50Z",
    "body": "So there's no cheap platform-dependent variant? I want something that's fast, gives an unspecified value when outside of bounds *and* is safe. I don't want UB for some inputs and I think that's too dangerous for common use, *if* we can do better.",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/326752780/reactions",
      "total_count": 2,
      "+1": 2,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/326753371",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-326753371",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 326753371,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMyNjc1MzM3MQ==",
    "user": {
      "login": "hanna-kruppe",
      "id": 2311707,
      "node_id": "MDQ6VXNlcjIzMTE3MDc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2311707?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hanna-kruppe",
      "html_url": "https://github.com/hanna-kruppe",
      "followers_url": "https://api.github.com/users/hanna-kruppe/followers",
      "following_url": "https://api.github.com/users/hanna-kruppe/following{/other_user}",
      "gists_url": "https://api.github.com/users/hanna-kruppe/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hanna-kruppe/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hanna-kruppe/subscriptions",
      "organizations_url": "https://api.github.com/users/hanna-kruppe/orgs",
      "repos_url": "https://api.github.com/users/hanna-kruppe/repos",
      "events_url": "https://api.github.com/users/hanna-kruppe/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hanna-kruppe/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2017-09-02T16:07:48Z",
    "updated_at": "2017-09-02T16:14:38Z",
    "body": "As far as I am aware, on most if not all platforms the canonical way to implement this conversion does *something* to out-of-range inputs that isn't UB. But LLVM does not seem to have any way to pick that option (whatever it may be) over UB. If we could convince LLVM developers to introduce an intrinsic that yields an \"unspecified but not `undef`/`poison`\" result on out-of-range inputs, we could use that.\r\n\r\nBut I'd estimate that someone in this thread would have to write a convincing RFC (on the llvm-dev list), get buy-in, and implement it (in backends we care about, and with a fall-back implementation for other targets). Probably easier than convincing llvm-dev to make the existing casts not-UB (because it side-steps questions like \"will this make any C and C++ programs slower\"), but still not very easy.",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/326753371/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/331427487",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-331427487",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 331427487,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMzMTQyNzQ4Nw==",
    "user": {
      "login": "sp-1234",
      "id": 19407943,
      "node_id": "MDQ6VXNlcjE5NDA3OTQz",
      "avatar_url": "https://avatars.githubusercontent.com/u/19407943?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sp-1234",
      "html_url": "https://github.com/sp-1234",
      "followers_url": "https://api.github.com/users/sp-1234/followers",
      "following_url": "https://api.github.com/users/sp-1234/following{/other_user}",
      "gists_url": "https://api.github.com/users/sp-1234/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sp-1234/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sp-1234/subscriptions",
      "organizations_url": "https://api.github.com/users/sp-1234/orgs",
      "repos_url": "https://api.github.com/users/sp-1234/repos",
      "events_url": "https://api.github.com/users/sp-1234/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sp-1234/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2017-09-22T11:58:32Z",
    "updated_at": "2017-09-22T11:58:32Z",
    "body": "Just in case you will be choosing between these:\r\n\r\n>    Saturation (out-of-range values become IntType::max_value()/min_value())\r\n>    Modulo (out-of-range values are treated as if by converting to a bigint first, then truncating)\r\n\r\nIMO only saturation would make sense here, because absolute precision of floating point quickly drops as values get large, so at some point the modulo would be something useless like all zeroes.\r\n",
    "author_association": "NONE",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/331427487/reactions",
      "total_count": 3,
      "+1": 3,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/331471708",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-331471708",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 331471708,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMzMTQ3MTcwOA==",
    "user": {
      "login": "nikomatsakis",
      "id": 155238,
      "node_id": "MDQ6VXNlcjE1NTIzOA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/155238?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nikomatsakis",
      "html_url": "https://github.com/nikomatsakis",
      "followers_url": "https://api.github.com/users/nikomatsakis/followers",
      "following_url": "https://api.github.com/users/nikomatsakis/following{/other_user}",
      "gists_url": "https://api.github.com/users/nikomatsakis/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nikomatsakis/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nikomatsakis/subscriptions",
      "organizations_url": "https://api.github.com/users/nikomatsakis/orgs",
      "repos_url": "https://api.github.com/users/nikomatsakis/repos",
      "events_url": "https://api.github.com/users/nikomatsakis/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nikomatsakis/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2017-09-22T15:00:18Z",
    "updated_at": "2017-09-22T15:00:18Z",
    "body": "I marked this as `E-needs-mentor` and tagged it with `WG-compiler-middle` since it seems the impl period might be a great time to investigate this further! My existing [notes on the plan of record are pretty sparse though](https://github.com/rust-lang/rust/issues/10184#issuecomment-302198137), so it'd be great if someone from @rust-lang/compiler wanted to help elaborate a those a bit further!",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/331471708/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/331703452",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-331703452",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 331703452,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMzMTcwMzQ1Mg==",
    "user": {
      "login": "arielb1",
      "id": 1830974,
      "node_id": "MDQ6VXNlcjE4MzA5NzQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1830974?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/arielb1",
      "html_url": "https://github.com/arielb1",
      "followers_url": "https://api.github.com/users/arielb1/followers",
      "following_url": "https://api.github.com/users/arielb1/following{/other_user}",
      "gists_url": "https://api.github.com/users/arielb1/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/arielb1/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/arielb1/subscriptions",
      "organizations_url": "https://api.github.com/users/arielb1/orgs",
      "repos_url": "https://api.github.com/users/arielb1/repos",
      "events_url": "https://api.github.com/users/arielb1/events{/privacy}",
      "received_events_url": "https://api.github.com/users/arielb1/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2017-09-24T11:23:11Z",
    "updated_at": "2017-09-24T11:23:11Z",
    "body": "@nikomatsakis \r\n\r\nIIRC LLVM are planning to eventually implement `freeze`, which should allow us to deal with the UB by doing a `freeze`.",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/331703452/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/331712427",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-331712427",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 331712427,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMzMTcxMjQyNw==",
    "user": {
      "login": "ghost",
      "id": 10137,
      "node_id": "MDQ6VXNlcjEwMTM3",
      "avatar_url": "https://avatars.githubusercontent.com/u/10137?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ghost",
      "html_url": "https://github.com/ghost",
      "followers_url": "https://api.github.com/users/ghost/followers",
      "following_url": "https://api.github.com/users/ghost/following{/other_user}",
      "gists_url": "https://api.github.com/users/ghost/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ghost/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ghost/subscriptions",
      "organizations_url": "https://api.github.com/users/ghost/orgs",
      "repos_url": "https://api.github.com/users/ghost/repos",
      "events_url": "https://api.github.com/users/ghost/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ghost/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2017-09-24T14:07:25Z",
    "updated_at": "2017-09-24T14:24:52Z",
    "body": "My results so far: https://gist.github.com/s3bk/4bdfbe2acca30fcf587006ebb4811744\r\n\r\nThe _array variants run a loop of 1024 values.\r\n_cast: `x as i32`\r\n_clip: x.min(MAX).max(MIN) as i32\r\n_panic: panics if x is out of bounds\r\n_zero: sets the result to zero if out of bounds\r\n\r\n```\r\ntest bench_array_cast       ... bench:       1,840 ns/iter (+/- 37)\r\ntest bench_array_cast_clip  ... bench:       2,657 ns/iter (+/- 13)\r\ntest bench_array_cast_panic ... bench:       2,397 ns/iter (+/- 20)\r\ntest bench_array_cast_zero  ... bench:       2,671 ns/iter (+/- 19)\r\ntest bench_cast             ... bench:           2 ns/iter (+/- 0)\r\ntest bench_cast_clip        ... bench:           2 ns/iter (+/- 0)\r\ntest bench_cast_panic       ... bench:           2 ns/iter (+/- 0)\r\ntest bench_cast_zero        ... bench:           2 ns/iter (+/- 0)\r\n```",
    "author_association": "NONE",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/331712427/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/331804085",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-331804085",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 331804085,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMzMTgwNDA4NQ==",
    "user": {
      "login": "sp-1234",
      "id": 19407943,
      "node_id": "MDQ6VXNlcjE5NDA3OTQz",
      "avatar_url": "https://avatars.githubusercontent.com/u/19407943?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sp-1234",
      "html_url": "https://github.com/sp-1234",
      "followers_url": "https://api.github.com/users/sp-1234/followers",
      "following_url": "https://api.github.com/users/sp-1234/following{/other_user}",
      "gists_url": "https://api.github.com/users/sp-1234/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sp-1234/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sp-1234/subscriptions",
      "organizations_url": "https://api.github.com/users/sp-1234/orgs",
      "repos_url": "https://api.github.com/users/sp-1234/repos",
      "events_url": "https://api.github.com/users/sp-1234/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sp-1234/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2017-09-25T07:52:54Z",
    "updated_at": "2017-09-25T07:52:54Z",
    "body": "Perhaps you need not round the results to integer for individual operations. Clearly there must be some difference behind these 2 ns/iter. Or is it really like this, _exactly_ 2 ns for all 4 variants?",
    "author_association": "NONE",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/331804085/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/331804710",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-331804710",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 331804710,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMzMTgwNDcxMA==",
    "user": {
      "login": "eddyb",
      "id": 77424,
      "node_id": "MDQ6VXNlcjc3NDI0",
      "avatar_url": "https://avatars.githubusercontent.com/u/77424?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/eddyb",
      "html_url": "https://github.com/eddyb",
      "followers_url": "https://api.github.com/users/eddyb/followers",
      "following_url": "https://api.github.com/users/eddyb/following{/other_user}",
      "gists_url": "https://api.github.com/users/eddyb/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/eddyb/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/eddyb/subscriptions",
      "organizations_url": "https://api.github.com/users/eddyb/orgs",
      "repos_url": "https://api.github.com/users/eddyb/repos",
      "events_url": "https://api.github.com/users/eddyb/events{/privacy}",
      "received_events_url": "https://api.github.com/users/eddyb/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2017-09-25T07:55:49Z",
    "updated_at": "2017-09-25T07:55:49Z",
    "body": "@sp-1234 I wonder if it's partially optimized out.",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/331804710/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/331828955",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-331828955",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 331828955,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMzMTgyODk1NQ==",
    "user": {
      "login": "ghost",
      "id": 10137,
      "node_id": "MDQ6VXNlcjEwMTM3",
      "avatar_url": "https://avatars.githubusercontent.com/u/10137?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ghost",
      "html_url": "https://github.com/ghost",
      "followers_url": "https://api.github.com/users/ghost/followers",
      "following_url": "https://api.github.com/users/ghost/following{/other_user}",
      "gists_url": "https://api.github.com/users/ghost/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ghost/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ghost/subscriptions",
      "organizations_url": "https://api.github.com/users/ghost/orgs",
      "repos_url": "https://api.github.com/users/ghost/repos",
      "events_url": "https://api.github.com/users/ghost/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ghost/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2017-09-25T09:35:50Z",
    "updated_at": "2017-09-25T09:39:41Z",
    "body": "@sp-1234 It is too fast to measure. The non-array benchmarks are basically useless.\r\nIf you force the single-value functions to be functions via `#[inline(never)]`, you get 2ns vs 3ns.",
    "author_association": "NONE",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/331828955/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/331833177",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-331833177",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 331833177,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMzMTgzMzE3Nw==",
    "user": {
      "login": "Amanieu",
      "id": 278509,
      "node_id": "MDQ6VXNlcjI3ODUwOQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/278509?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Amanieu",
      "html_url": "https://github.com/Amanieu",
      "followers_url": "https://api.github.com/users/Amanieu/followers",
      "following_url": "https://api.github.com/users/Amanieu/following{/other_user}",
      "gists_url": "https://api.github.com/users/Amanieu/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Amanieu/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Amanieu/subscriptions",
      "organizations_url": "https://api.github.com/users/Amanieu/orgs",
      "repos_url": "https://api.github.com/users/Amanieu/repos",
      "events_url": "https://api.github.com/users/Amanieu/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Amanieu/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2017-09-25T09:52:58Z",
    "updated_at": "2017-09-25T09:52:58Z",
    "body": "@arielb1 \r\nI have some reservations regarding `freeze`. If I understand correctly, a frozen `undef` can still contain any arbitrary value, it just won't change between uses. In practice, the compiler will probably reuse a register or stack slot.\r\n\r\nHowever this means that we can now read uninitialized memory from safe code. This could lead to secret data being leaked, somewhat like Heartbleed. It's debatable whether this is truly considered UB from the point of view of Rust, but it clearly seems undesirable.",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/331833177/reactions",
      "total_count": 5,
      "+1": 5,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/332139418",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-332139418",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 332139418,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMzMjEzOTQxOA==",
    "user": {
      "login": "hanna-kruppe",
      "id": 2311707,
      "node_id": "MDQ6VXNlcjIzMTE3MDc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2311707?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hanna-kruppe",
      "html_url": "https://github.com/hanna-kruppe",
      "followers_url": "https://api.github.com/users/hanna-kruppe/followers",
      "following_url": "https://api.github.com/users/hanna-kruppe/following{/other_user}",
      "gists_url": "https://api.github.com/users/hanna-kruppe/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hanna-kruppe/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hanna-kruppe/subscriptions",
      "organizations_url": "https://api.github.com/users/hanna-kruppe/orgs",
      "repos_url": "https://api.github.com/users/hanna-kruppe/repos",
      "events_url": "https://api.github.com/users/hanna-kruppe/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hanna-kruppe/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2017-09-26T09:21:33Z",
    "updated_at": "2017-09-26T09:25:43Z",
    "body": "I ran @s3bk's benchmark locally. I can confirm the scalar versions are optimized out completely, and the asm for the array variants also looks suspiciously well-optimized: for example, the loops are vectorized, which is nice but makes it hard to extrapolate performance to scalar code.\r\n\r\nUnfortunately, spamming `black_box` doesn't seem to help. I do see the asm doing useful work, but running the benchmark still consistently gives 0ns for the scalar benchmarks (except `cast_zero`, which shows 1ns). I see that @alexcrichton performed the comparison 100 times in their benchmarks, so I adopted the same hack. I'm now seeing these numbers ([source code](https://gist.github.com/rkruppe/202dd7eb9f8d2a5ff1e02a911f51dacf)):\r\n\r\n```\r\ntest bench_cast             ... bench:          53 ns/iter (+/- 0)\r\ntest bench_cast_clip        ... bench:         164 ns/iter (+/- 1)\r\ntest bench_cast_panic       ... bench:         172 ns/iter (+/- 2)\r\ntest bench_cast_zero        ... bench:         100 ns/iter (+/- 0)\r\n```\r\n\r\nThe array benchmarks vary too much for me to trust them. Well, truth to be told, I'm skeptical of the `test` benchmarking infrastructure anyway, especially after seeing the above numbers compared to the flat 0ns I got previously. Furthermore, even just 100 iterations of `black_box(x);` (as a baseline) takes 34ns, which makes it even harder to reliably interpret those numbers.\r\n\r\nTwo points worth noting:\r\n- Despite not handling NaN specifically (it returns -inf instead of 0?), the `cast_clip` implementation appears to be slower than @alexcrichton's saturating cast (note that their run and mine have roughly the same timing for `as` casts, 53-54ns).\r\n- Unlike @s3bk's array results, I'm seeing `cast_panic` being slower than the other checked casts. I also see an even greater slowdown on the array benchmarks. Maybe these things are just highly dependent on microarchitectural details and/or optimizer mood?\r\n\r\nFor the record, I've measured with rustc 1.21.0-nightly (d692a91fa 2017-08-04), `-C opt-level=3`, on an i7-6700K under light load.\r\n\r\n---\r\n\r\nIn conclusion, I conclude that don't have reliable data so far and that getting more reliable data seems hard. Furthermore, I strongly doubt that any real application spends even 1% of its wall clock time on this operation. Therefore, I would suggest to move forward by **implementing saturating `as` casts in rustc**, behind a `-Z` flag, and then running some non-artificial benchmarks with and without this flag to determine the impact on realistic applications.\r\n\r\nEdit: I would also recommend to run such benchmarks on a variety of architectures (e.g., including ARM) and microarchitectures, if at all possible.",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/332139418/reactions",
      "total_count": 4,
      "+1": 4,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/332620378",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-332620378",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 332620378,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMzMjYyMDM3OA==",
    "user": {
      "login": "simonbyrne",
      "id": 1692009,
      "node_id": "MDQ6VXNlcjE2OTIwMDk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1692009?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/simonbyrne",
      "html_url": "https://github.com/simonbyrne",
      "followers_url": "https://api.github.com/users/simonbyrne/followers",
      "following_url": "https://api.github.com/users/simonbyrne/following{/other_user}",
      "gists_url": "https://api.github.com/users/simonbyrne/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/simonbyrne/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/simonbyrne/subscriptions",
      "organizations_url": "https://api.github.com/users/simonbyrne/orgs",
      "repos_url": "https://api.github.com/users/simonbyrne/repos",
      "events_url": "https://api.github.com/users/simonbyrne/events{/privacy}",
      "received_events_url": "https://api.github.com/users/simonbyrne/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2017-09-27T18:52:23Z",
    "updated_at": "2017-09-27T18:52:23Z",
    "body": "I admit I'm not that familiar with rust, but I think [this line](https://gist.github.com/rkruppe/202dd7eb9f8d2a5ff1e02a911f51dacf#file-cvt-rs-L12) is subtly incorrect: `std::i32::MAX` (2^31-1) is not exactly representable as a Float32, so `std::i32::MAX as f32` will be rounded to the nearest representable value (2^31). If this value is used as the argument `x`, the result is technically undefined. Replacing with a strict inequality should fix this case.",
    "author_association": "NONE",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/332620378/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/332623866",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-332623866",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 332623866,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMzMjYyMzg2Ng==",
    "user": {
      "login": "Manishearth",
      "id": 1617736,
      "node_id": "MDQ6VXNlcjE2MTc3MzY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1617736?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Manishearth",
      "html_url": "https://github.com/Manishearth",
      "followers_url": "https://api.github.com/users/Manishearth/followers",
      "following_url": "https://api.github.com/users/Manishearth/following{/other_user}",
      "gists_url": "https://api.github.com/users/Manishearth/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Manishearth/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Manishearth/subscriptions",
      "organizations_url": "https://api.github.com/users/Manishearth/orgs",
      "repos_url": "https://api.github.com/users/Manishearth/repos",
      "events_url": "https://api.github.com/users/Manishearth/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Manishearth/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2017-09-27T19:05:10Z",
    "updated_at": "2017-09-27T19:05:10Z",
    "body": "Yeah, we had exactly that problem in Servo before. The final solution was to cast to f64 and then clamp.\r\n\r\nThere are other solutions but they're pretty tricky and rust doesn't expose nice APIs for dealing with this well.",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/332623866/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/332631986",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-332631986",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 332631986,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMzMjYzMTk4Ng==",
    "user": {
      "login": "ghost",
      "id": 10137,
      "node_id": "MDQ6VXNlcjEwMTM3",
      "avatar_url": "https://avatars.githubusercontent.com/u/10137?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ghost",
      "html_url": "https://github.com/ghost",
      "followers_url": "https://api.github.com/users/ghost/followers",
      "following_url": "https://api.github.com/users/ghost/following{/other_user}",
      "gists_url": "https://api.github.com/users/ghost/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ghost/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ghost/subscriptions",
      "organizations_url": "https://api.github.com/users/ghost/orgs",
      "repos_url": "https://api.github.com/users/ghost/repos",
      "events_url": "https://api.github.com/users/ghost/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ghost/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2017-09-27T19:35:50Z",
    "updated_at": "2017-09-27T20:11:02Z",
    "body": "using 0x7FFF_FF80i32 as upper limit and -0x8000_0000i32 should solve this without casting to f64.\r\nedit: use the correct value.",
    "author_association": "NONE",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/332631986/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/332638453",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-332638453",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 332638453,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMzMjYzODQ1Mw==",
    "user": {
      "login": "simonbyrne",
      "id": 1692009,
      "node_id": "MDQ6VXNlcjE2OTIwMDk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1692009?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/simonbyrne",
      "html_url": "https://github.com/simonbyrne",
      "followers_url": "https://api.github.com/users/simonbyrne/followers",
      "following_url": "https://api.github.com/users/simonbyrne/following{/other_user}",
      "gists_url": "https://api.github.com/users/simonbyrne/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/simonbyrne/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/simonbyrne/subscriptions",
      "organizations_url": "https://api.github.com/users/simonbyrne/orgs",
      "repos_url": "https://api.github.com/users/simonbyrne/repos",
      "events_url": "https://api.github.com/users/simonbyrne/events{/privacy}",
      "received_events_url": "https://api.github.com/users/simonbyrne/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2017-09-27T20:00:51Z",
    "updated_at": "2017-09-27T20:00:51Z",
    "body": "I think you mean `0x7fff_ff80`, but simply using a strict inequality would probably make the intention of the code clearer.",
    "author_association": "NONE",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/332638453/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/332641175",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-332641175",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 332641175,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMzMjY0MTE3NQ==",
    "user": {
      "login": "ghost",
      "id": 10137,
      "node_id": "MDQ6VXNlcjEwMTM3",
      "avatar_url": "https://avatars.githubusercontent.com/u/10137?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ghost",
      "html_url": "https://github.com/ghost",
      "followers_url": "https://api.github.com/users/ghost/followers",
      "following_url": "https://api.github.com/users/ghost/following{/other_user}",
      "gists_url": "https://api.github.com/users/ghost/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ghost/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ghost/subscriptions",
      "organizations_url": "https://api.github.com/users/ghost/orgs",
      "repos_url": "https://api.github.com/users/ghost/repos",
      "events_url": "https://api.github.com/users/ghost/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ghost/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2017-09-27T20:12:11Z",
    "updated_at": "2017-09-27T20:12:11Z",
    "body": "as in `x < 0x8000_0000u32 as f32` ? That would probably be a good idea.",
    "author_association": "NONE",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/332641175/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/332959979",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-332959979",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 332959979,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMzMjk1OTk3OQ==",
    "user": {
      "login": "ActuallyaDeviloper",
      "id": 18053943,
      "node_id": "MDQ6VXNlcjE4MDUzOTQz",
      "avatar_url": "https://avatars.githubusercontent.com/u/18053943?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ActuallyaDeviloper",
      "html_url": "https://github.com/ActuallyaDeviloper",
      "followers_url": "https://api.github.com/users/ActuallyaDeviloper/followers",
      "following_url": "https://api.github.com/users/ActuallyaDeviloper/following{/other_user}",
      "gists_url": "https://api.github.com/users/ActuallyaDeviloper/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ActuallyaDeviloper/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ActuallyaDeviloper/subscriptions",
      "organizations_url": "https://api.github.com/users/ActuallyaDeviloper/orgs",
      "repos_url": "https://api.github.com/users/ActuallyaDeviloper/repos",
      "events_url": "https://api.github.com/users/ActuallyaDeviloper/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ActuallyaDeviloper/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2017-09-28T20:50:32Z",
    "updated_at": "2017-09-28T23:35:17Z",
    "body": "I think of all the suggested deterministic options, clamping is geneally most useful one because I think it's done often anyway. If the conversion type would actually be documentated to be saturating, manual clamping would become unnecessary.\r\n\r\nI am only a little worried about the suggested implementation because it doesn't properly translate to machine instructions and it relies heavily on branching. Branching makes the performance dependent on specific data patterns. In the test cases given above everything looks (comparatively) fast because the same branch is taken always and the processor has good branch prediction data from many previous loop iterations. The real world will probably not look like that. Additionally the branching hurts the ability of the compiler to vectorize the code. I disagree with the opinion of @rkruppe , that the operation shouldn't also be tested in combination with vectorization. Vectorization is important in high performance code and being able to vectorize simple casts on common architectures should be a crucial requirement.\r\n\r\nFor the reasons given above, I played around with an alternative branchless and data flow oriented version of @alexcrichton 's cast with saturation semantics and @simonbyrne 's fix. I implemented it for [u16](https://gist.github.com/ActuallyaDeviloper/2a1b84554b0d9e9ff8f14fa5c1b0bcce#file-lib-rs-L24), [i16](https://gist.github.com/ActuallyaDeviloper/2a1b84554b0d9e9ff8f14fa5c1b0bcce#file-lib-rs-L155) and [i32](https://gist.github.com/ActuallyaDeviloper/2a1b84554b0d9e9ff8f14fa5c1b0bcce#file-lib-rs-L295) since they all have to cover slightly different cases which result in varying performance.\r\n\r\nThe results:\r\n```\r\ntest i16_bench_array_cast       ... bench:          99 ns/iter (+/- 2)\r\ntest i16_bench_array_cast_clip  ... bench:         197 ns/iter (+/- 3)\r\ntest i16_bench_array_cast_clip2 ... bench:         113 ns/iter (+/- 3)\r\ntest i16_bench_cast             ... bench:          76 ns/iter (+/- 1)\r\ntest i16_bench_cast_clip        ... bench:         218 ns/iter (+/- 25)\r\ntest i16_bench_cast_clip2       ... bench:         148 ns/iter (+/- 4)\r\ntest i16_bench_rng_cast         ... bench:       1,181 ns/iter (+/- 17)\r\ntest i16_bench_rng_cast_clip    ... bench:       1,952 ns/iter (+/- 27)\r\ntest i16_bench_rng_cast_clip2   ... bench:       1,287 ns/iter (+/- 19)\r\n\r\ntest i32_bench_array_cast       ... bench:         114 ns/iter (+/- 1)\r\ntest i32_bench_array_cast_clip  ... bench:         200 ns/iter (+/- 3)\r\ntest i32_bench_array_cast_clip2 ... bench:         128 ns/iter (+/- 3)\r\ntest i32_bench_cast             ... bench:          74 ns/iter (+/- 1)\r\ntest i32_bench_cast_clip        ... bench:         168 ns/iter (+/- 3)\r\ntest i32_bench_cast_clip2       ... bench:         189 ns/iter (+/- 3)\r\ntest i32_bench_rng_cast         ... bench:       1,184 ns/iter (+/- 13)\r\ntest i32_bench_rng_cast_clip    ... bench:       2,398 ns/iter (+/- 41)\r\ntest i32_bench_rng_cast_clip2   ... bench:       1,349 ns/iter (+/- 19)\r\n\r\ntest u16_bench_array_cast       ... bench:          99 ns/iter (+/- 1)\r\ntest u16_bench_array_cast_clip  ... bench:         136 ns/iter (+/- 3)\r\ntest u16_bench_array_cast_clip2 ... bench:         105 ns/iter (+/- 3)\r\ntest u16_bench_cast             ... bench:          76 ns/iter (+/- 2)\r\ntest u16_bench_cast_clip        ... bench:         184 ns/iter (+/- 7)\r\ntest u16_bench_cast_clip2       ... bench:         110 ns/iter (+/- 0)\r\ntest u16_bench_rng_cast         ... bench:       1,178 ns/iter (+/- 22)\r\ntest u16_bench_rng_cast_clip    ... bench:       1,336 ns/iter (+/- 26)\r\ntest u16_bench_rng_cast_clip2   ... bench:       1,207 ns/iter (+/- 21)\r\n```\r\n\r\nThe test was run on an Intel Haswell i5-4570 CPU and Rust 1.22.0-nightly.\r\n`clip2` is the new branchless implementation. It agrees with `clip` on all 2^32 possible f32 input values.\r\n\r\nFor the `rng` benchmarks, random input values are used that hit different cases often. This uncovers the _extreme_ performance cost (roughly 10 times the normal cost!!!) that occurs if branch prediction fails. I think it is _very_ important to consider this. It's not the average real world performance either, but it's still a possible case and some applications will hit this. People will expect a f32 cast to have consistent performance.\r\n\r\nAssmbly comparison on x86: https://godbolt.org/g/AhdF71\r\nThe branchless version very nicely maps to the minss/maxss instructions.\r\n\r\nUnfortunately I wasn't able to make godbolt generate ARM assembly from Rust, but here is a ARM comparison of the methods with Clang: https://godbolt.org/g/s7ronw\r\nWithout being able to test the code and knowing much of ARM: The code size seems smaller too and LLVM mostly generates vmax/vmin which looks promising. Maybe LLVM could be teached eventually to fold most of the code into a single instruction?",
    "author_association": "NONE",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/332959979/reactions",
      "total_count": 6,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 6,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/332968002",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-332968002",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 332968002,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMzMjk2ODAwMg==",
    "user": {
      "login": "hanna-kruppe",
      "id": 2311707,
      "node_id": "MDQ6VXNlcjIzMTE3MDc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2311707?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hanna-kruppe",
      "html_url": "https://github.com/hanna-kruppe",
      "followers_url": "https://api.github.com/users/hanna-kruppe/followers",
      "following_url": "https://api.github.com/users/hanna-kruppe/following{/other_user}",
      "gists_url": "https://api.github.com/users/hanna-kruppe/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hanna-kruppe/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hanna-kruppe/subscriptions",
      "organizations_url": "https://api.github.com/users/hanna-kruppe/orgs",
      "repos_url": "https://api.github.com/users/hanna-kruppe/repos",
      "events_url": "https://api.github.com/users/hanna-kruppe/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hanna-kruppe/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2017-09-28T21:23:34Z",
    "updated_at": "2017-09-28T21:23:34Z",
    "body": "@ActuallyaDeviloper The asm and the benchmark results look very good! Furthermore, branchless code like yours is probably easier to generate in `rustc` than the nested conditionals of other solutions (for the record, I am assuming we want to generate inline IR instead of calling a lang item function). Thank you so much for writing this.\r\n\r\nI have a question about `u16_cast_clip2`: it doesn't seem to handle NaN?! There is a comment talking about NaN, but I believe the function will pass NaN through unmodified and attempt to cast it to `f32` (and even if it didn't, it would produce one of the boundary values rather than 0).\r\n\r\nPS: To be clear, I was not trying to imply that it's unimportant whether the cast can be vectorized. It clearly is important if the surrounding code is otherwise vectorizable. But scalar performance is *also* important, as vectorization is often not applicable, and the benchmarks I was commenting on were not making any statement about scalar performance. Out of interest, have you checked the asm of the `*array*` benchmarks to see if they're still vectorized with your implementation?",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/332968002/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/332994147",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-332994147",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 332994147,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMzMjk5NDE0Nw==",
    "user": {
      "login": "ActuallyaDeviloper",
      "id": 18053943,
      "node_id": "MDQ6VXNlcjE4MDUzOTQz",
      "avatar_url": "https://avatars.githubusercontent.com/u/18053943?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ActuallyaDeviloper",
      "html_url": "https://github.com/ActuallyaDeviloper",
      "followers_url": "https://api.github.com/users/ActuallyaDeviloper/followers",
      "following_url": "https://api.github.com/users/ActuallyaDeviloper/following{/other_user}",
      "gists_url": "https://api.github.com/users/ActuallyaDeviloper/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ActuallyaDeviloper/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ActuallyaDeviloper/subscriptions",
      "organizations_url": "https://api.github.com/users/ActuallyaDeviloper/orgs",
      "repos_url": "https://api.github.com/users/ActuallyaDeviloper/repos",
      "events_url": "https://api.github.com/users/ActuallyaDeviloper/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ActuallyaDeviloper/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2017-09-28T23:52:19Z",
    "updated_at": "2017-09-28T23:52:19Z",
    "body": "@rkruppe You are right, I accidently swapped the sides of the `if` and forgot about that. `f32 as u16` happend to do the right thing by truncating the upper 0x8000 away, so the tests didn't catch it either. I fixed the problem now by swapping the branches again and testing all methods with `if (y.is_nan()) { panic!(\"NaN\"); }` this time.\r\n\r\nI updated my previous post. The x86 code did not change significantly at all but unfortunately the change stops LLVM from generating `vmax` in the `u16` ARM case for some reason. I assume this has to do with some details about NaN handling of that ARM instruction or maybe it's a LLVM limitation. \r\n\r\nFor why it works, notice that the lower boundary value is actually 0 for unsigned values. So NaN and the lower bound can be catched at the same time.\r\n\r\nThe array versions are vectorized.\r\nGodbolt: https://godbolt.org/g/HnmsSV\r\n\r\n\r\n",
    "author_association": "NONE",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/332994147/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/333156425",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-333156425",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 333156425,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMzMzE1NjQyNQ==",
    "user": {
      "login": "hanna-kruppe",
      "id": 2311707,
      "node_id": "MDQ6VXNlcjIzMTE3MDc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2311707?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hanna-kruppe",
      "html_url": "https://github.com/hanna-kruppe",
      "followers_url": "https://api.github.com/users/hanna-kruppe/followers",
      "following_url": "https://api.github.com/users/hanna-kruppe/following{/other_user}",
      "gists_url": "https://api.github.com/users/hanna-kruppe/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hanna-kruppe/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hanna-kruppe/subscriptions",
      "organizations_url": "https://api.github.com/users/hanna-kruppe/orgs",
      "repos_url": "https://api.github.com/users/hanna-kruppe/repos",
      "events_url": "https://api.github.com/users/hanna-kruppe/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hanna-kruppe/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2017-09-29T15:21:33Z",
    "updated_at": "2017-09-29T15:21:33Z",
    "body": "Re: [the ARM asm](https://godbolt.org/g/s7ronw), I believe the reason `vmax` is not used any more is that [it returns NaN if either operand is NaN](http://infocenter.arm.com/help/index.jsp?topic=/com.arm.doc.dui0489h/CIHDEEBE.html). The code is still branchless, though, it just uses predicated moves (`vmovgt`, referring to to the result of the earlier `vcmp` with 0).\r\n\r\n> For why it works, notice that the lower boundary value is actually 0 for unsigned values. So NaN and the lower bound can be catched at the same time.\r\n\r\nOhhh, right. Nice.",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/333156425/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/335046154",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-335046154",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 335046154,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMzNTA0NjE1NA==",
    "user": {
      "login": "hanna-kruppe",
      "id": 2311707,
      "node_id": "MDQ6VXNlcjIzMTE3MDc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2311707?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hanna-kruppe",
      "html_url": "https://github.com/hanna-kruppe",
      "followers_url": "https://api.github.com/users/hanna-kruppe/followers",
      "following_url": "https://api.github.com/users/hanna-kruppe/following{/other_user}",
      "gists_url": "https://api.github.com/users/hanna-kruppe/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hanna-kruppe/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hanna-kruppe/subscriptions",
      "organizations_url": "https://api.github.com/users/hanna-kruppe/orgs",
      "repos_url": "https://api.github.com/users/hanna-kruppe/repos",
      "events_url": "https://api.github.com/users/hanna-kruppe/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hanna-kruppe/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2017-10-08T23:20:10Z",
    "updated_at": "2017-10-08T23:20:10Z",
    "body": "> I would suggest to move forward by implementing saturating as casts in rustc, behind a -Z flag\r\n\r\nI have implemented this and will file a PR once I also fixed #41799 and have a lot more tests.",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/335046154/reactions",
      "total_count": 10,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 10,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/335296453",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-335296453",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 335296453,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMzNTI5NjQ1Mw==",
    "user": {
      "login": "hanna-kruppe",
      "id": 2311707,
      "node_id": "MDQ6VXNlcjIzMTE3MDc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2311707?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hanna-kruppe",
      "html_url": "https://github.com/hanna-kruppe",
      "followers_url": "https://api.github.com/users/hanna-kruppe/followers",
      "following_url": "https://api.github.com/users/hanna-kruppe/following{/other_user}",
      "gists_url": "https://api.github.com/users/hanna-kruppe/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hanna-kruppe/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hanna-kruppe/subscriptions",
      "organizations_url": "https://api.github.com/users/hanna-kruppe/orgs",
      "repos_url": "https://api.github.com/users/hanna-kruppe/repos",
      "events_url": "https://api.github.com/users/hanna-kruppe/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hanna-kruppe/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2017-10-09T21:31:50Z",
    "updated_at": "2017-10-09T21:31:50Z",
    "body": "#45134 has pointed out a code path that I missed (generation of LLVM constant expressions &ndash; this is separate from rustc's own constant evaluation). I'll roll a fix for that into the same PR, but it will take a little while longer.",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/335296453/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/335534104",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-335534104",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 335534104,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMzNTUzNDEwNA==",
    "user": {
      "login": "eddyb",
      "id": 77424,
      "node_id": "MDQ6VXNlcjc3NDI0",
      "avatar_url": "https://avatars.githubusercontent.com/u/77424?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/eddyb",
      "html_url": "https://github.com/eddyb",
      "followers_url": "https://api.github.com/users/eddyb/followers",
      "following_url": "https://api.github.com/users/eddyb/following{/other_user}",
      "gists_url": "https://api.github.com/users/eddyb/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/eddyb/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/eddyb/subscriptions",
      "organizations_url": "https://api.github.com/users/eddyb/orgs",
      "repos_url": "https://api.github.com/users/eddyb/repos",
      "events_url": "https://api.github.com/users/eddyb/events{/privacy}",
      "received_events_url": "https://api.github.com/users/eddyb/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2017-10-10T16:39:48Z",
    "updated_at": "2017-10-10T16:39:48Z",
    "body": "@rkruppe You should coordinate with @oli-obk so that miri ends up with the same changes.",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/335534104/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/335868916",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-335868916",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 335868916,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMzNTg2ODkxNg==",
    "user": {
      "login": "hanna-kruppe",
      "id": 2311707,
      "node_id": "MDQ6VXNlcjIzMTE3MDc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2311707?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hanna-kruppe",
      "html_url": "https://github.com/hanna-kruppe",
      "followers_url": "https://api.github.com/users/hanna-kruppe/followers",
      "following_url": "https://api.github.com/users/hanna-kruppe/following{/other_user}",
      "gists_url": "https://api.github.com/users/hanna-kruppe/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hanna-kruppe/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hanna-kruppe/subscriptions",
      "organizations_url": "https://api.github.com/users/hanna-kruppe/orgs",
      "repos_url": "https://api.github.com/users/hanna-kruppe/repos",
      "events_url": "https://api.github.com/users/hanna-kruppe/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hanna-kruppe/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2017-10-11T16:31:44Z",
    "updated_at": "2017-10-11T16:31:44Z",
    "body": "Pull request is up: #45205",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/335868916/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/342987617",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-342987617",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 342987617,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM0Mjk4NzYxNw==",
    "user": {
      "login": "hanna-kruppe",
      "id": 2311707,
      "node_id": "MDQ6VXNlcjIzMTE3MDc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2311707?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hanna-kruppe",
      "html_url": "https://github.com/hanna-kruppe",
      "followers_url": "https://api.github.com/users/hanna-kruppe/followers",
      "following_url": "https://api.github.com/users/hanna-kruppe/following{/other_user}",
      "gists_url": "https://api.github.com/users/hanna-kruppe/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hanna-kruppe/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hanna-kruppe/subscriptions",
      "organizations_url": "https://api.github.com/users/hanna-kruppe/orgs",
      "repos_url": "https://api.github.com/users/hanna-kruppe/repos",
      "events_url": "https://api.github.com/users/hanna-kruppe/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hanna-kruppe/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2017-11-08T22:49:14Z",
    "updated_at": "2017-11-08T22:54:54Z",
    "body": "#45205 has been merged, so anyone can now (well, starting with the next nightly) **measure the performance impact of saturation** by passing  `-Z saturating-float-casts` via `RUSTFLAGS`. [1] Such measurements would be very valuable for deciding how to proceed with this issue.\r\n\r\n[1] Strictly speaking, this won't affect the non-generic, non-`#[inline]` portions of the standard library, so to be 100% accurate you'd want to locally build std with Xargo. However, I don't expect that there will be a lot of code affected by this (the various conversion trait impls are `#[inline]`, for example).",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/342987617/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/342990246",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-342990246",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 342990246,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM0Mjk5MDI0Ng==",
    "user": {
      "login": "Gankra",
      "id": 1136864,
      "node_id": "MDQ6VXNlcjExMzY4NjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1136864?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Gankra",
      "html_url": "https://github.com/Gankra",
      "followers_url": "https://api.github.com/users/Gankra/followers",
      "following_url": "https://api.github.com/users/Gankra/following{/other_user}",
      "gists_url": "https://api.github.com/users/Gankra/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Gankra/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Gankra/subscriptions",
      "organizations_url": "https://api.github.com/users/Gankra/orgs",
      "repos_url": "https://api.github.com/users/Gankra/repos",
      "events_url": "https://api.github.com/users/Gankra/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Gankra/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2017-11-08T23:00:17Z",
    "updated_at": "2017-11-08T23:05:51Z",
    "body": "@rkruppe I suggest starting an internals/users page to collect data, in the same vein as https://internals.rust-lang.org/t/help-us-benchmark-incremental-compilation/6153/ (we can then also link people to that, rather than some random comments in our issue tracker)",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/342990246/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/342991516",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-342991516",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 342991516,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM0Mjk5MTUxNg==",
    "user": {
      "login": "est31",
      "id": 8872119,
      "node_id": "MDQ6VXNlcjg4NzIxMTk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8872119?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/est31",
      "html_url": "https://github.com/est31",
      "followers_url": "https://api.github.com/users/est31/followers",
      "following_url": "https://api.github.com/users/est31/following{/other_user}",
      "gists_url": "https://api.github.com/users/est31/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/est31/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/est31/subscriptions",
      "organizations_url": "https://api.github.com/users/est31/orgs",
      "repos_url": "https://api.github.com/users/est31/repos",
      "events_url": "https://api.github.com/users/est31/events{/privacy}",
      "received_events_url": "https://api.github.com/users/est31/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2017-11-08T23:05:35Z",
    "updated_at": "2017-11-08T23:05:35Z",
    "body": "@rkruppe you should create a tracking issue. This discussion is split up into two issues already. That's not good!",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/342991516/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/343002731",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-343002731",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 343002731,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM0MzAwMjczMQ==",
    "user": {
      "login": "hanna-kruppe",
      "id": 2311707,
      "node_id": "MDQ6VXNlcjIzMTE3MDc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2311707?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hanna-kruppe",
      "html_url": "https://github.com/hanna-kruppe",
      "followers_url": "https://api.github.com/users/hanna-kruppe/followers",
      "following_url": "https://api.github.com/users/hanna-kruppe/following{/other_user}",
      "gists_url": "https://api.github.com/users/hanna-kruppe/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hanna-kruppe/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hanna-kruppe/subscriptions",
      "organizations_url": "https://api.github.com/users/hanna-kruppe/orgs",
      "repos_url": "https://api.github.com/users/hanna-kruppe/repos",
      "events_url": "https://api.github.com/users/hanna-kruppe/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hanna-kruppe/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2017-11-09T00:01:55Z",
    "updated_at": "2017-11-09T00:01:55Z",
    "body": "@Gankro Yeah I agree, but it may be a few days before I find the time to write that post properly, so I figured I'd solicit feedback from the people subscribed to this issue in the mean time.\r\n\r\n@est31 Hmm. Although the -Z flag covers both cast directions (which may have been a mistake, in retrospect), it seems unlikely that we'll flip the switch on both at the same time, and there's little overlap between the two in terms of what must be discussed (e.g., this issue hinges on the performance of saturation, while in #41799 it's agreed upon what the right solution is).\r\nIt *is* a bit silly that benchmarks primarily targeted at this issue would also measure the impact of the fix to #41799, but that can at most lead to overreporting of performance regressions, so I'm sort of okay with that. (But if anyone is motivated to split the -Z flag into two, go ahead.)\r\n\r\nI've considered a tracking issue for the task of removing the flag once it has outlived its usefulness, but I don't see the need to merging the discussions occuring here and in #41799.",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/343002731/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/343244086",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-343244086",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 343244086,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM0MzI0NDA4Ng==",
    "user": {
      "login": "Gankra",
      "id": 1136864,
      "node_id": "MDQ6VXNlcjExMzY4NjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1136864?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Gankra",
      "html_url": "https://github.com/Gankra",
      "followers_url": "https://api.github.com/users/Gankra/followers",
      "following_url": "https://api.github.com/users/Gankra/following{/other_user}",
      "gists_url": "https://api.github.com/users/Gankra/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Gankra/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Gankra/subscriptions",
      "organizations_url": "https://api.github.com/users/Gankra/orgs",
      "repos_url": "https://api.github.com/users/Gankra/repos",
      "events_url": "https://api.github.com/users/Gankra/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Gankra/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2017-11-09T18:18:49Z",
    "updated_at": "2017-11-09T18:18:49Z",
    "body": "I have drafted up an internals post: https://gist.github.com/Gankro/feab9fb0c42881984caf93c7ad494ebd\r\n\r\nFeel free to copy that, or just give me notes so I can post it. (note I'm a bit confused about the `const fn` behaviour)",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/343244086/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/343255388",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-343255388",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 343255388,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM0MzI1NTM4OA==",
    "user": {
      "login": "sunfishcode",
      "id": 4503403,
      "node_id": "MDQ6VXNlcjQ1MDM0MDM=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4503403?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sunfishcode",
      "html_url": "https://github.com/sunfishcode",
      "followers_url": "https://api.github.com/users/sunfishcode/followers",
      "following_url": "https://api.github.com/users/sunfishcode/following{/other_user}",
      "gists_url": "https://api.github.com/users/sunfishcode/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sunfishcode/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sunfishcode/subscriptions",
      "organizations_url": "https://api.github.com/users/sunfishcode/orgs",
      "repos_url": "https://api.github.com/users/sunfishcode/repos",
      "events_url": "https://api.github.com/users/sunfishcode/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sunfishcode/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2017-11-09T18:57:20Z",
    "updated_at": "2017-11-09T19:22:50Z",
    "body": "One additional tidbit is that the cost of float->int conversions is specific to the current implementation, rather than being fundamental. On x86, ~~`cvtss2si`~~`cvttss2si` returns 0x80000000 in the too-low, too-high, and nan cases, so one could implement `-Zsaturating-float-casts` with a ~~`cvtss2si`~~`cvttss2si` followed by special code in the 0x80000000 case, so it could be just a single compare-and-predictable-branch in the common case. On ARM, `vcvt.s32.f32`  has the `-Zsaturating-float-casts` semantics already. LLVM doesn't currently optimize the extra checks away in either case.",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/343255388/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/343314481",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-343314481",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 343314481,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM0MzMxNDQ4MQ==",
    "user": {
      "login": "hanna-kruppe",
      "id": 2311707,
      "node_id": "MDQ6VXNlcjIzMTE3MDc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2311707?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hanna-kruppe",
      "html_url": "https://github.com/hanna-kruppe",
      "followers_url": "https://api.github.com/users/hanna-kruppe/followers",
      "following_url": "https://api.github.com/users/hanna-kruppe/following{/other_user}",
      "gists_url": "https://api.github.com/users/hanna-kruppe/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hanna-kruppe/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hanna-kruppe/subscriptions",
      "organizations_url": "https://api.github.com/users/hanna-kruppe/orgs",
      "repos_url": "https://api.github.com/users/hanna-kruppe/repos",
      "events_url": "https://api.github.com/users/hanna-kruppe/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hanna-kruppe/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2017-11-09T22:35:26Z",
    "updated_at": "2017-11-09T22:35:26Z",
    "body": "@Gankro \r\n\r\nAwesome, thanks a lot! I left a few notes on the gist. After reading this, I'd like to take a stab at separating u128->f32 casts from the -Z flag. Just for the sake of getting rid of the distracting caveat about the flag covering two orthogonal features.",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/343314481/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/343327759",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-343327759",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 343327759,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM0MzMyNzc1OQ==",
    "user": {
      "login": "hanna-kruppe",
      "id": 2311707,
      "node_id": "MDQ6VXNlcjIzMTE3MDc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2311707?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hanna-kruppe",
      "html_url": "https://github.com/hanna-kruppe",
      "followers_url": "https://api.github.com/users/hanna-kruppe/followers",
      "following_url": "https://api.github.com/users/hanna-kruppe/following{/other_user}",
      "gists_url": "https://api.github.com/users/hanna-kruppe/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hanna-kruppe/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hanna-kruppe/subscriptions",
      "organizations_url": "https://api.github.com/users/hanna-kruppe/orgs",
      "repos_url": "https://api.github.com/users/hanna-kruppe/repos",
      "events_url": "https://api.github.com/users/hanna-kruppe/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hanna-kruppe/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2017-11-09T23:38:13Z",
    "updated_at": "2017-11-09T23:38:13Z",
    "body": "(I've filed #45900 to refocus the -Z flag so that it only covers the float->int issue)",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/343327759/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/343341376",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-343341376",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 343341376,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM0MzM0MTM3Ng==",
    "user": {
      "login": "comex",
      "id": 47517,
      "node_id": "MDQ6VXNlcjQ3NTE3",
      "avatar_url": "https://avatars.githubusercontent.com/u/47517?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/comex",
      "html_url": "https://github.com/comex",
      "followers_url": "https://api.github.com/users/comex/followers",
      "following_url": "https://api.github.com/users/comex/following{/other_user}",
      "gists_url": "https://api.github.com/users/comex/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/comex/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/comex/subscriptions",
      "organizations_url": "https://api.github.com/users/comex/orgs",
      "repos_url": "https://api.github.com/users/comex/repos",
      "events_url": "https://api.github.com/users/comex/events{/privacy}",
      "received_events_url": "https://api.github.com/users/comex/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2017-11-10T00:54:27Z",
    "updated_at": "2017-11-10T00:56:55Z",
    "body": "It would be nice if we could get platform-specific implementations a la @sunfishcode (at least for x86) before asking for mass benchmarking.  It shouldn't be very difficult.",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/343341376/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/343350168",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-343350168",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 343350168,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM0MzM1MDE2OA==",
    "user": {
      "login": "sunfishcode",
      "id": 4503403,
      "node_id": "MDQ6VXNlcjQ1MDM0MDM=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4503403?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sunfishcode",
      "html_url": "https://github.com/sunfishcode",
      "followers_url": "https://api.github.com/users/sunfishcode/followers",
      "following_url": "https://api.github.com/users/sunfishcode/following{/other_user}",
      "gists_url": "https://api.github.com/users/sunfishcode/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sunfishcode/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sunfishcode/subscriptions",
      "organizations_url": "https://api.github.com/users/sunfishcode/orgs",
      "repos_url": "https://api.github.com/users/sunfishcode/repos",
      "events_url": "https://api.github.com/users/sunfishcode/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sunfishcode/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2017-11-10T01:46:35Z",
    "updated_at": "2017-11-10T01:46:35Z",
    "body": "The problem is that LLVM doesn't currently provide a way to do this, as far as I know, except maybe with inline asm which I wouldn't necessarily recommend for a release.",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/343350168/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/343356577",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-343356577",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 343356577,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM0MzM1NjU3Nw==",
    "user": {
      "login": "Gankra",
      "id": 1136864,
      "node_id": "MDQ6VXNlcjExMzY4NjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1136864?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Gankra",
      "html_url": "https://github.com/Gankra",
      "followers_url": "https://api.github.com/users/Gankra/followers",
      "following_url": "https://api.github.com/users/Gankra/following{/other_user}",
      "gists_url": "https://api.github.com/users/Gankra/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Gankra/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Gankra/subscriptions",
      "organizations_url": "https://api.github.com/users/Gankra/orgs",
      "repos_url": "https://api.github.com/users/Gankra/repos",
      "events_url": "https://api.github.com/users/Gankra/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Gankra/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2017-11-10T02:28:19Z",
    "updated_at": "2017-11-10T02:28:34Z",
    "body": "I have updated the draft to reflect discussion (basically ripping out any inline mention of u128 -> f32 to an extra section at the end).",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/343356577/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/343364252",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-343364252",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 343364252,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM0MzM2NDI1Mg==",
    "user": {
      "login": "comex",
      "id": 47517,
      "node_id": "MDQ6VXNlcjQ3NTE3",
      "avatar_url": "https://avatars.githubusercontent.com/u/47517?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/comex",
      "html_url": "https://github.com/comex",
      "followers_url": "https://api.github.com/users/comex/followers",
      "following_url": "https://api.github.com/users/comex/following{/other_user}",
      "gists_url": "https://api.github.com/users/comex/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/comex/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/comex/subscriptions",
      "organizations_url": "https://api.github.com/users/comex/orgs",
      "repos_url": "https://api.github.com/users/comex/repos",
      "events_url": "https://api.github.com/users/comex/events{/privacy}",
      "received_events_url": "https://api.github.com/users/comex/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2017-11-10T03:23:50Z",
    "updated_at": "2017-11-10T03:23:50Z",
    "body": "@sunfishcode Are you sure?  Isn't the `llvm.x86.sse.cvttss2si` intrinsic what you're looking for?\r\n\r\nHere is a playground link that uses it:\r\n\r\nhttps://play.rust-lang.org/?gist=33cf9e0871df2eb2475b845af4f1b574&version=nightly\r\n\r\nIn release mode, `float_to_int_with_intrinsic` and `float_to_int_with_as` both compile down to a single instruction.  (In debug mode, `float_to_int_with_intrinsic` wastes a few instructions putting zero into the high, but it's not too bad.)\r\n\r\nIt even seems to do constant folding correctly.  For example,\r\n```rust\r\nfloat_to_int_with_intrinsic(42.0)\r\n```\r\nbecomes\r\n```asm\r\nmovl\t$42, %eax\r\n```\r\nBut an out-of-range value,\r\n```rust\r\nfloat_to_int_with_intrinsic(42.0e33)\r\n```\r\ndoes not get folded:\r\n```asm\r\ncvttss2si\t.LCPI2_0(%rip), %eax\r\n```\r\n(Ideally it would fold to constant 0x80000000, but that's no big deal.  The important thing is that it doesn't produce undef.)",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/343364252/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/343373815",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-343373815",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 343373815,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM0MzM3MzgxNQ==",
    "user": {
      "login": "sunfishcode",
      "id": 4503403,
      "node_id": "MDQ6VXNlcjQ1MDM0MDM=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4503403?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sunfishcode",
      "html_url": "https://github.com/sunfishcode",
      "followers_url": "https://api.github.com/users/sunfishcode/followers",
      "following_url": "https://api.github.com/users/sunfishcode/following{/other_user}",
      "gists_url": "https://api.github.com/users/sunfishcode/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sunfishcode/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sunfishcode/subscriptions",
      "organizations_url": "https://api.github.com/users/sunfishcode/orgs",
      "repos_url": "https://api.github.com/users/sunfishcode/repos",
      "events_url": "https://api.github.com/users/sunfishcode/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sunfishcode/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2017-11-10T04:46:15Z",
    "updated_at": "2017-11-10T04:46:15Z",
    "body": "Oh, cool. It looks like that would work!",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/343373815/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/343425404",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-343425404",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 343425404,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM0MzQyNTQwNA==",
    "user": {
      "login": "hanna-kruppe",
      "id": 2311707,
      "node_id": "MDQ6VXNlcjIzMTE3MDc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2311707?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hanna-kruppe",
      "html_url": "https://github.com/hanna-kruppe",
      "followers_url": "https://api.github.com/users/hanna-kruppe/followers",
      "following_url": "https://api.github.com/users/hanna-kruppe/following{/other_user}",
      "gists_url": "https://api.github.com/users/hanna-kruppe/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hanna-kruppe/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hanna-kruppe/subscriptions",
      "organizations_url": "https://api.github.com/users/hanna-kruppe/orgs",
      "repos_url": "https://api.github.com/users/hanna-kruppe/repos",
      "events_url": "https://api.github.com/users/hanna-kruppe/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hanna-kruppe/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2017-11-10T09:40:44Z",
    "updated_at": "2017-11-10T09:43:12Z",
    "body": "It's cool to know that we do, after all, have a way to build on `cvttss2si`. However, I do not agree that it's clearly better to change the implementation to use it before we call for benchmarks:\r\n\r\nMost people will benchmark on x86, so if we special case x86, we'll get far less data on the general implementation, which will still be used on most other targets. Admittedly, it's already difficult to infer anything about other architectures, but a wholly different implementation makes it outright impossible.\r\n\r\nSecond, if we collect benchmarks now, with the \"simple\" solution, and find that there are no performance regressions in real code (and tbh that's what I expect), then we don't even need to go through the trouble of trying to optimize this code path further.\r\n\r\nFinally, I'm not even sure building on `cvttss2si` will be faster than what we have now (though on ARM, just using the appropriate instruction is clearly better):\r\n\r\n- You need a compare to notice that the conversion returns 0x80000000, and if that's the case you still need another compare (of the input value) to know whether you should return int::MIN or int::MAX. And if it's a signed integer type, I don't see how to avoid a third compare to distinguish NaN. So in the worst case:\r\n  - you don't save in the number of compares/selects\r\n  - you're trading a float compare for an int compare, which *might* be nice for OoO cores (if you're bottlenecked on FUs that can do compares, which seems like a relatively big if), but that compare is also dependent on the float->int comparison, while the comparisons in the current implementation are all independent, so it's far from obvious that this is a win.\r\n- Vectorization probably becomes more difficult or impossible. I don't expect that the loop vectorizer handles this intrinsic at all.\r\n- It's also worth noting that (AFAIK) this strategy only applies to some integer types. f32 -> u8, for example, will need additional fixups of the result, which make this strategy pretty clearly unprofitable. I'm not quite sure which types are affected by this (e.g., I don't know if there's an instruction for f32 -> u32), but an application that uses only those types won't benefit at all.\r\n- You could do a branching solution with only one compare in the happy path (as opposed to two or three compares, and thus branches, as previous solutions did). However, as @ActuallyaDeviloper argued earlier, branching may not be desirable: Performance now becomes even more workload-dependent and branch-prediction-dependent.",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/343425404/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/343634681",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-343634681",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 343634681,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM0MzYzNDY4MQ==",
    "user": {
      "login": "bstrie",
      "id": 865233,
      "node_id": "MDQ6VXNlcjg2NTIzMw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/865233?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/bstrie",
      "html_url": "https://github.com/bstrie",
      "followers_url": "https://api.github.com/users/bstrie/followers",
      "following_url": "https://api.github.com/users/bstrie/following{/other_user}",
      "gists_url": "https://api.github.com/users/bstrie/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/bstrie/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/bstrie/subscriptions",
      "organizations_url": "https://api.github.com/users/bstrie/orgs",
      "repos_url": "https://api.github.com/users/bstrie/repos",
      "events_url": "https://api.github.com/users/bstrie/events{/privacy}",
      "received_events_url": "https://api.github.com/users/bstrie/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2017-11-11T02:44:01Z",
    "updated_at": "2017-11-11T02:44:01Z",
    "body": "Is it safe to assume that we're going to need a slew of `unsafe fn as_u32_unchecked(self) -> u32` and friends regardless of what the benchmarking shows? What other potential recourse would someone have if they *did* end up observing a slowdown?",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/343634681/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/343635139",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-343635139",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 343635139,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM0MzYzNTEzOQ==",
    "user": {
      "login": "ssokolow",
      "id": 46915,
      "node_id": "MDQ6VXNlcjQ2OTE1",
      "avatar_url": "https://avatars.githubusercontent.com/u/46915?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ssokolow",
      "html_url": "https://github.com/ssokolow",
      "followers_url": "https://api.github.com/users/ssokolow/followers",
      "following_url": "https://api.github.com/users/ssokolow/following{/other_user}",
      "gists_url": "https://api.github.com/users/ssokolow/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ssokolow/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ssokolow/subscriptions",
      "organizations_url": "https://api.github.com/users/ssokolow/orgs",
      "repos_url": "https://api.github.com/users/ssokolow/repos",
      "events_url": "https://api.github.com/users/ssokolow/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ssokolow/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2017-11-11T02:52:50Z",
    "updated_at": "2017-11-11T02:52:50Z",
    "body": "@bstrie I think it'd make more sense, in a case like that, to do something like extending the syntax to `as <type> [unchecked]` and requiring the `unchecked` only be present in `unsafe` contexts.\r\n\r\nAs I see it, a forest of `_unchecked` functions as variants of `as` casting would be a wart, both as far as intuitiveness goes, and when it comes to generating clean, usable documentation.",
    "author_association": "NONE",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/343635139/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/343640417",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-343640417",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 343640417,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM0MzY0MDQxNw==",
    "user": {
      "login": "bstrie",
      "id": 865233,
      "node_id": "MDQ6VXNlcjg2NTIzMw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/865233?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/bstrie",
      "html_url": "https://github.com/bstrie",
      "followers_url": "https://api.github.com/users/bstrie/followers",
      "following_url": "https://api.github.com/users/bstrie/following{/other_user}",
      "gists_url": "https://api.github.com/users/bstrie/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/bstrie/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/bstrie/subscriptions",
      "organizations_url": "https://api.github.com/users/bstrie/orgs",
      "repos_url": "https://api.github.com/users/bstrie/repos",
      "events_url": "https://api.github.com/users/bstrie/events{/privacy}",
      "received_events_url": "https://api.github.com/users/bstrie/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2017-11-11T04:42:41Z",
    "updated_at": "2017-11-11T04:42:41Z",
    "body": "@ssokolow Adding syntax should always be a last resort, especially if all of this can be taken care of with just ten rote functions. Even having a generic `foo.as_unchecked::<u32>()` would be preferable to syntactic changes (and the concomitant interminable bikeshed), especially since we ought to be reducing, not increasing, the number of things that `unsafe` unlocks.",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/343640417/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/343640822",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-343640822",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 343640822,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM0MzY0MDgyMg==",
    "user": {
      "login": "ssokolow",
      "id": 46915,
      "node_id": "MDQ6VXNlcjQ2OTE1",
      "avatar_url": "https://avatars.githubusercontent.com/u/46915?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ssokolow",
      "html_url": "https://github.com/ssokolow",
      "followers_url": "https://api.github.com/users/ssokolow/followers",
      "following_url": "https://api.github.com/users/ssokolow/following{/other_user}",
      "gists_url": "https://api.github.com/users/ssokolow/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ssokolow/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ssokolow/subscriptions",
      "organizations_url": "https://api.github.com/users/ssokolow/orgs",
      "repos_url": "https://api.github.com/users/ssokolow/repos",
      "events_url": "https://api.github.com/users/ssokolow/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ssokolow/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2017-11-11T04:53:25Z",
    "updated_at": "2017-11-11T04:53:25Z",
    "body": "Point. The turbofish slipped my mind when considering options and, in hindsight, I'm not exactly firing on all cylinders this evening either, so I should have been more cautious about commenting on design decisions.\r\n\r\nThat said, it feels wrong to bake the destination type into the function name... inelegant and a potential burden on future evolution of the language. The turbofish feels like a better option.",
    "author_association": "NONE",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/343640822/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/343644466",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-343644466",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 343644466,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM0MzY0NDQ2Ng==",
    "user": {
      "login": "SimonSapin",
      "id": 291359,
      "node_id": "MDQ6VXNlcjI5MTM1OQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/291359?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/SimonSapin",
      "html_url": "https://github.com/SimonSapin",
      "followers_url": "https://api.github.com/users/SimonSapin/followers",
      "following_url": "https://api.github.com/users/SimonSapin/following{/other_user}",
      "gists_url": "https://api.github.com/users/SimonSapin/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/SimonSapin/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/SimonSapin/subscriptions",
      "organizations_url": "https://api.github.com/users/SimonSapin/orgs",
      "repos_url": "https://api.github.com/users/SimonSapin/repos",
      "events_url": "https://api.github.com/users/SimonSapin/events{/privacy}",
      "received_events_url": "https://api.github.com/users/SimonSapin/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2017-11-11T06:28:00Z",
    "updated_at": "2017-11-11T06:28:00Z",
    "body": "A generic method could be supported by a new set of `UncheckedFrom` / `UncheckedInto` traits with `unsafe fn` methods, joining the `From` / `Into` and `TryFrom` / `TryInto` collection.",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/343644466/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/343654146",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-343654146",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 343654146,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM0MzY1NDE0Ng==",
    "user": {
      "login": "hanna-kruppe",
      "id": 2311707,
      "node_id": "MDQ6VXNlcjIzMTE3MDc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2311707?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hanna-kruppe",
      "html_url": "https://github.com/hanna-kruppe",
      "followers_url": "https://api.github.com/users/hanna-kruppe/followers",
      "following_url": "https://api.github.com/users/hanna-kruppe/following{/other_user}",
      "gists_url": "https://api.github.com/users/hanna-kruppe/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hanna-kruppe/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hanna-kruppe/subscriptions",
      "organizations_url": "https://api.github.com/users/hanna-kruppe/orgs",
      "repos_url": "https://api.github.com/users/hanna-kruppe/repos",
      "events_url": "https://api.github.com/users/hanna-kruppe/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hanna-kruppe/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2017-11-11T10:09:04Z",
    "updated_at": "2017-11-11T10:10:30Z",
    "body": "@bstrie One alternative solution for people whose code got slower could be to use an intrinsic (e.g., via stdsimd) to access the underlying hardware instruction. I argued earlier that this has downsides for the optimizer &ndash; auto-vectorization likely suffers, and LLVM can't exploit it returning `undef` on out-of-range inputs &ndash; but it does offer a way to do the cast without any extra work at run time. I can't decide if this is good enough, but it seems at least plausible that it might be.",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/343654146/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/343705010",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-343705010",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 343705010,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM0MzcwNTAxMA==",
    "user": {
      "login": "comex",
      "id": 47517,
      "node_id": "MDQ6VXNlcjQ3NTE3",
      "avatar_url": "https://avatars.githubusercontent.com/u/47517?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/comex",
      "html_url": "https://github.com/comex",
      "followers_url": "https://api.github.com/users/comex/followers",
      "following_url": "https://api.github.com/users/comex/following{/other_user}",
      "gists_url": "https://api.github.com/users/comex/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/comex/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/comex/subscriptions",
      "organizations_url": "https://api.github.com/users/comex/orgs",
      "repos_url": "https://api.github.com/users/comex/repos",
      "events_url": "https://api.github.com/users/comex/events{/privacy}",
      "received_events_url": "https://api.github.com/users/comex/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2017-11-12T00:37:26Z",
    "updated_at": "2017-11-12T00:38:06Z",
    "body": "Some notes on conversions in the x86 instruction set:\r\n\r\nSSE2 is actually relatively limited in which conversion operations it gives you.  You have:\r\n\r\n- CVTTSS2SI family with 32-bit register: converts single float to `i32`\r\n- CVTTSS2SI family with 64-bit register: converts single float to `i64` (x86-64 only)\r\n- CVTTPS2PI family: converts two floats to two `i32s`\r\n\r\nEach of those has variants for `f32` and `f64` (as well as variants that round instead of truncating, but that's useless here).\r\n\r\nBut there is nothing for unsigned integers, nothing for sizes smaller than 32, and if you're on 32-bit x86, nothing for 64-bit.  Later instruction set extensions add more functionality, but it seems barely anybody compiles for those.\r\n\r\nAs a result, the existing ('unsafe') behavior:\r\n- To convert to u32, compilers convert to i64 and truncate the resulting integer.  (This produces odd behavior for out-of-range values, but that's UB so who cares.)\r\n- To convert to anything 16-bit or 8-bit, compilers convert to i64 or i32 and truncate the resulting integer.\r\n- To convert to u64, compilers generate a morass of instructions.  For f32 to u64 GCC and LLVM generate an equivalent of:\r\n```rust\r\nfn f32_to_u64(f: f32) -> u64 {\r\n    const CUTOFF: f32 = 0x8000000000000000 as f32; // 2^63 exactly\r\n    if !(f >= CUTOFF) { // less, or NaN\r\n        // just use the signed conversion\r\n        f as i64 as u64\r\n    } else {\r\n        0x8000000000000000u64 + ((f - CUTOFF) as i64 as u64)\r\n    }\r\n}\r\n```\r\n\r\nUnrelated fun fact: \"Convert-than-truncate\" code generation is what causes the \"[parallel universes](https://www.youtube.com/watch?v=kpk2tdsPh0A)\" glitch in Super Mario 64.  The collision detection code first MIPS instruction to convert f32 coordinates to i32, then truncates to i16; thus, coordinates that fit in i16 but not i32 'wrap', e.g. going to coordinate 65536.0 gets you collision detection for 0.0.\r\n\r\nAnyway, conclusions:\r\n- \"Test for 0x80000000 and have special handler\" only works for conversions to i32 and i64.\r\n- For conversions to u32, u/i16, and u/i8, however, \"test if truncated/sign-extended output differs from original\" is an equivalent.  (This would scoop up both integers that were in range for the original conversion but out of range for the final type, and 0x8000000000000000, the indicator that the float was NaN or out of range for the original conversion.)\r\n- But the cost of a branch and a bunch of extra code for that case is probably overkill.  It may be OK if branches can be avoided.\r\n\r\n- @ActuallyaDeviloper's minss/maxss based approach is not so bad!  The minimal form,\r\n```\r\nminss %xmm2, %xmm1\r\nmaxss %xmm3, %xmm1\r\ncvttss2si %rax, %xmm1\r\n```\r\nis only three instructions (which have decent code size and throughput/latency) and no branches.\r\n\r\nHowever:\r\n- The pure-Rust version needs an extra test for NaN.  For conversions to 32-bit or smaller, that can be avoided using intrinsics, by using 64-bit cvttss2si and truncating the result.  If the input was not NaN, the min/max ensure that integer is unchanged by truncation.  If the input was NaN, the integer is 0x8000000000000000 which truncates to 0.\r\n- I didn't include the cost of loading 2147483647.0 and -2148473648.0 into the registers, typically one mov from memory each.\r\n- For f32, 2147483647.0 cannot be represented exactly, so that doesn't actually work: you need another check.  That makes things much worse.  Ditto for f64 to u/i64, but f64 to u/i32 doesn't have this problem.\r\n\r\nI suggest a compromise between the two approaches:\r\n- For f32/f64 to u/i16 and u/i8, and f64 to u/i32, go with min/max + truncation, as above, e.g.:\r\n```rust\r\n    let f = if f > 32767.0 { 32767.0 } else { f };\r\n    let f = if f < -32768.0 { -32768.0 } else { f };\r\n    cvttss2si(f) as i16\r\n```\r\n(For u/i16 and u/i8, the original conversion can be to i32; for f64 to u/i32, it needs to be to i64.)\r\n\r\n- For f32/64 to u32,\r\n```rust\r\n    let r = cvttss2si64(f) as u32;\r\n    if f >= 4294967296.0 { 4294967295 } else { r }\r\n```\r\nis only a few instructions and no branches:\r\n```\r\n\tcvttss2si\t%xmm0, %rcx\r\n\tucomiss\t.LCPI0_0(%rip), %xmm0\r\n\tmovl\t$-1, %eax\r\n\tcmovbl\t%ecx, %eax\r\n```\r\n- For f32/64 to i64, maybe\r\n```rust\r\n    let r = cvttss2si64(f);\r\n    if f >= 9223372036854775808. {\r\n        9223372036854775807 \r\n    } else if f != f {\r\n        0\r\n    } else {\r\n        r\r\n    }\r\n```\r\nThis produces a longer (still branchless) sequence:\r\n```\r\n\tcvttss2si\t%xmm0, %rax\r\n\txorl\t%ecx, %ecx\r\n\tucomiss\t%xmm0, %xmm0\r\n\tcmovnpq\t%rax, %rcx\r\n\tucomiss\t.LCPI0_0(%rip), %xmm0\r\n\tmovabsq\t$9223372036854775807, %rax\r\n\tcmovbq\t%rcx, %rax\r\n```\r\n\u2026but at least we save one comparison compared to the naive approach, as if `f` is too small, 0x8000000000000000 is already the correct answer (i.e. i64::MIN).\r\n\r\n- For f32 to i32, not sure whether it would be preferable to do the same as previous, or just convert to f64 first and then do the shorter min/max thing.\r\n\r\n- `u64` is a mess I don't feel like thinking about. :p\r\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/343705010/reactions",
      "total_count": 10,
      "+1": 2,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 8,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/343993400",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-343993400",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 343993400,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM0Mzk5MzQwMA==",
    "user": {
      "login": "hanna-kruppe",
      "id": 2311707,
      "node_id": "MDQ6VXNlcjIzMTE3MDc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2311707?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hanna-kruppe",
      "html_url": "https://github.com/hanna-kruppe",
      "followers_url": "https://api.github.com/users/hanna-kruppe/followers",
      "following_url": "https://api.github.com/users/hanna-kruppe/following{/other_user}",
      "gists_url": "https://api.github.com/users/hanna-kruppe/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hanna-kruppe/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hanna-kruppe/subscriptions",
      "organizations_url": "https://api.github.com/users/hanna-kruppe/orgs",
      "repos_url": "https://api.github.com/users/hanna-kruppe/repos",
      "events_url": "https://api.github.com/users/hanna-kruppe/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hanna-kruppe/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2017-11-13T17:26:34Z",
    "updated_at": "2017-11-13T17:26:34Z",
    "body": "Call for benchmarks is up: https://internals.rust-lang.org/t/help-us-benchmark-saturating-float-casts/6231",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/343993400/reactions",
      "total_count": 3,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 3,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/345479698",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-345479698",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 345479698,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM0NTQ3OTY5OA==",
    "user": {
      "login": "hanna-kruppe",
      "id": 2311707,
      "node_id": "MDQ6VXNlcjIzMTE3MDc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2311707?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hanna-kruppe",
      "html_url": "https://github.com/hanna-kruppe",
      "followers_url": "https://api.github.com/users/hanna-kruppe/followers",
      "following_url": "https://api.github.com/users/hanna-kruppe/following{/other_user}",
      "gists_url": "https://api.github.com/users/hanna-kruppe/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hanna-kruppe/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hanna-kruppe/subscriptions",
      "organizations_url": "https://api.github.com/users/hanna-kruppe/orgs",
      "repos_url": "https://api.github.com/users/hanna-kruppe/repos",
      "events_url": "https://api.github.com/users/hanna-kruppe/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hanna-kruppe/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2017-11-18T23:38:45Z",
    "updated_at": "2017-11-18T23:42:09Z",
    "body": "In https://internals.rust-lang.org/t/help-us-benchmark-saturating-float-casts/6231/14 someone reported a measurable and significant slowdown on JPEG encoding with the image crate. I've minimized the program so that it's self-contained and mostly focused on the parts that are related to the slowdown: https://gist.github.com/rkruppe/4e7972a209f74654ebd872eb4bc57722 (this program shows ~ 15% slowdown for me with saturating casts).\r\n\r\nNote that the casts are f32->u8 (`rgb_to_ycbcr`) and f32->i32 (`encode_rgb`, \"Quantization\" loop) in equal proportions. It also looks like the inputs are all in range, i.e., saturation never actually kicks in, but in the case of the f32->u8 this can only be verified by calculating the minimum and maximum of a polynominal and accounting for rounding error, which is a lot to ask. The f32->i32 casts are more obviously in range for i32, but only because the elements of `self.tables` are nonzero, which is (apparently?) not that easy for the optimizer to show, especially in the original program. tl;dr: The saturation checks are there to stay, the only hope is making them faster.\r\n\r\nI've also poked at the LLVM IR some -- it appears literally the only difference are the comparisons and selects from the saturating casts. A quick look indicates the asm has corresponding instructions and of course a bunch more live values (which lead to more spills).\r\n\r\n@comex Do you think f32->u8 and f32->i32 casts can be made measurably faster with CVTTSS2SI?",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/345479698/reactions",
      "total_count": 4,
      "+1": 3,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 1,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/390406769",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-390406769",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 390406769,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM5MDQwNjc2OQ==",
    "user": {
      "login": "kennytm",
      "id": 103023,
      "node_id": "MDQ6VXNlcjEwMzAyMw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/103023?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/kennytm",
      "html_url": "https://github.com/kennytm",
      "followers_url": "https://api.github.com/users/kennytm/followers",
      "following_url": "https://api.github.com/users/kennytm/following{/other_user}",
      "gists_url": "https://api.github.com/users/kennytm/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/kennytm/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kennytm/subscriptions",
      "organizations_url": "https://api.github.com/users/kennytm/orgs",
      "repos_url": "https://api.github.com/users/kennytm/repos",
      "events_url": "https://api.github.com/users/kennytm/events{/privacy}",
      "received_events_url": "https://api.github.com/users/kennytm/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2018-05-19T13:58:18Z",
    "updated_at": "2018-05-19T13:58:18Z",
    "body": "Minor update, as of `rustc 1.28.0-nightly (952f344cd 2018-05-18)`, the `-Zsaturating-float-casts` flag still causes the code in https://github.com/rust-lang/rust/issues/10184#issuecomment-345479698 to be ~20% slower on x86_64. Which means LLVM 6 hasn't changed anything.\r\n\r\n| Flags | Timing |\r\n|-------|-------:|\r\n| -Copt-level=3 -Ctarget-cpu=native | 325,699 ns/iter (+/- 7,607) |\r\n| -Copt-level=3 -Ctarget-cpu=native -Zsaturating-float-casts | 386,962 ns/iter (+/- 11,601)<br>(19% slower) | \r\n| -Copt-level=3 | 331,521 ns/iter (+/- 14,096) |\r\n| -Copt-level=3 -Zsaturating-float-casts | 413,572 ns/iter (+/- 19,183)<br> (25% slower) |",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/390406769/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/399271282",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-399271282",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 399271282,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM5OTI3MTI4Mg==",
    "user": {
      "login": "bstrie",
      "id": 865233,
      "node_id": "MDQ6VXNlcjg2NTIzMw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/865233?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/bstrie",
      "html_url": "https://github.com/bstrie",
      "followers_url": "https://api.github.com/users/bstrie/followers",
      "following_url": "https://api.github.com/users/bstrie/following{/other_user}",
      "gists_url": "https://api.github.com/users/bstrie/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/bstrie/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/bstrie/subscriptions",
      "organizations_url": "https://api.github.com/users/bstrie/orgs",
      "repos_url": "https://api.github.com/users/bstrie/repos",
      "events_url": "https://api.github.com/users/bstrie/events{/privacy}",
      "received_events_url": "https://api.github.com/users/bstrie/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2018-06-21T23:09:33Z",
    "updated_at": "2018-06-21T23:09:33Z",
    "body": "@kennytm Did we expect LLVM 6 to change something? Are they discussing a particular enhancement that would benefit this use case? If so, what's the ticket number?",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/399271282/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/406461164",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-406461164",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 406461164,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQwNjQ2MTE2NA==",
    "user": {
      "login": "shepmaster",
      "id": 174509,
      "node_id": "MDQ6VXNlcjE3NDUwOQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/174509?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/shepmaster",
      "html_url": "https://github.com/shepmaster",
      "followers_url": "https://api.github.com/users/shepmaster/followers",
      "following_url": "https://api.github.com/users/shepmaster/following{/other_user}",
      "gists_url": "https://api.github.com/users/shepmaster/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/shepmaster/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/shepmaster/subscriptions",
      "organizations_url": "https://api.github.com/users/shepmaster/orgs",
      "repos_url": "https://api.github.com/users/shepmaster/repos",
      "events_url": "https://api.github.com/users/shepmaster/events{/privacy}",
      "received_events_url": "https://api.github.com/users/shepmaster/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2018-07-20T01:25:01Z",
    "updated_at": "2018-07-20T02:16:13Z",
    "body": "@insanitybit It... appears to still be open...?\r\n\r\n![image](https://user-images.githubusercontent.com/174509/42978296-26950c28-8b9a-11e8-9bdc-1f713b310d7a.png)\r\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/406461164/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/406462053",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-406462053",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 406462053,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQwNjQ2MjA1Mw==",
    "user": {
      "login": "insanitybit",
      "id": 4956357,
      "node_id": "MDQ6VXNlcjQ5NTYzNTc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4956357?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/insanitybit",
      "html_url": "https://github.com/insanitybit",
      "followers_url": "https://api.github.com/users/insanitybit/followers",
      "following_url": "https://api.github.com/users/insanitybit/following{/other_user}",
      "gists_url": "https://api.github.com/users/insanitybit/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/insanitybit/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/insanitybit/subscriptions",
      "organizations_url": "https://api.github.com/users/insanitybit/orgs",
      "repos_url": "https://api.github.com/users/insanitybit/repos",
      "events_url": "https://api.github.com/users/insanitybit/events{/privacy}",
      "received_events_url": "https://api.github.com/users/insanitybit/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2018-07-20T01:31:20Z",
    "updated_at": "2018-07-20T02:16:20Z",
    "body": "Welp, no clue what I was looking at. Thanks!",
    "author_association": "NONE",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/406462053/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/406487807",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-406487807",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 406487807,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQwNjQ4NzgwNw==",
    "user": {
      "login": "nagisa",
      "id": 679122,
      "node_id": "MDQ6VXNlcjY3OTEyMg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/679122?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nagisa",
      "html_url": "https://github.com/nagisa",
      "followers_url": "https://api.github.com/users/nagisa/followers",
      "following_url": "https://api.github.com/users/nagisa/following{/other_user}",
      "gists_url": "https://api.github.com/users/nagisa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nagisa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nagisa/subscriptions",
      "organizations_url": "https://api.github.com/users/nagisa/orgs",
      "repos_url": "https://api.github.com/users/nagisa/repos",
      "events_url": "https://api.github.com/users/nagisa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nagisa/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2018-07-20T04:46:04Z",
    "updated_at": "2018-07-20T04:46:04Z",
    "body": "@rkruppe didn't we ensure that float to int casts are no longer UB in LLVM\n(by changing docs)?\n\nOn Jul 20, 2018 4:31 AM, \"Colin\" <notifications@github.com> wrote:\n\nWelp, no clue what I was looking at.\n\n\u2014\nYou are receiving this because you are subscribed to this thread.\nReply to this email directly, view it on GitHub\n<https://github.com/rust-lang/rust/issues/10184#issuecomment-406462053>,\nor mute\nthe thread\n<https://github.com/notifications/unsubscribe-auth/AApc0v3rJHhZMD7Kv7RC8xkGOiIhkGB1ks5uITMHgaJpZM4BJ45C>\n.\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/406487807/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/406542410",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-406542410",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 406542410,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQwNjU0MjQxMA==",
    "user": {
      "login": "SimonSapin",
      "id": 291359,
      "node_id": "MDQ6VXNlcjI5MTM1OQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/291359?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/SimonSapin",
      "html_url": "https://github.com/SimonSapin",
      "followers_url": "https://api.github.com/users/SimonSapin/followers",
      "following_url": "https://api.github.com/users/SimonSapin/following{/other_user}",
      "gists_url": "https://api.github.com/users/SimonSapin/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/SimonSapin/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/SimonSapin/subscriptions",
      "organizations_url": "https://api.github.com/users/SimonSapin/orgs",
      "repos_url": "https://api.github.com/users/SimonSapin/repos",
      "events_url": "https://api.github.com/users/SimonSapin/events{/privacy}",
      "received_events_url": "https://api.github.com/users/SimonSapin/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2018-07-20T09:22:15Z",
    "updated_at": "2018-07-20T09:22:15Z",
    "body": "@nagisa Maybe you\u2019re thinking of `f32::from_bits(v: u32) -> f32` (and similarly `f64`)? It used to do some normalization of NaNs but now is just `transmute`.\r\n\r\nThis issue is about `as` conversions which try to approximate the numerical value.",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/406542410/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/406542903",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-406542903",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 406542903,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQwNjU0MjkwMw==",
    "user": {
      "login": "hanna-kruppe",
      "id": 2311707,
      "node_id": "MDQ6VXNlcjIzMTE3MDc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2311707?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hanna-kruppe",
      "html_url": "https://github.com/hanna-kruppe",
      "followers_url": "https://api.github.com/users/hanna-kruppe/followers",
      "following_url": "https://api.github.com/users/hanna-kruppe/following{/other_user}",
      "gists_url": "https://api.github.com/users/hanna-kruppe/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hanna-kruppe/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hanna-kruppe/subscriptions",
      "organizations_url": "https://api.github.com/users/hanna-kruppe/orgs",
      "repos_url": "https://api.github.com/users/hanna-kruppe/repos",
      "events_url": "https://api.github.com/users/hanna-kruppe/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hanna-kruppe/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2018-07-20T09:24:08Z",
    "updated_at": "2018-07-20T09:24:08Z",
    "body": "@nagisa You might be thinking of float->float casts, see #15536 and https://github.com/rust-lang-nursery/nomicon/pull/65.",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/406542903/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/406549316",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-406549316",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 406549316,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQwNjU0OTMxNg==",
    "user": {
      "login": "nagisa",
      "id": 679122,
      "node_id": "MDQ6VXNlcjY3OTEyMg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/679122?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nagisa",
      "html_url": "https://github.com/nagisa",
      "followers_url": "https://api.github.com/users/nagisa/followers",
      "following_url": "https://api.github.com/users/nagisa/following{/other_user}",
      "gists_url": "https://api.github.com/users/nagisa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nagisa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nagisa/subscriptions",
      "organizations_url": "https://api.github.com/users/nagisa/orgs",
      "repos_url": "https://api.github.com/users/nagisa/repos",
      "events_url": "https://api.github.com/users/nagisa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nagisa/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2018-07-20T09:47:14Z",
    "updated_at": "2018-07-20T09:47:14Z",
    "body": "Ah, yes, that was float to float.\n\nOn Fri, Jul 20, 2018, 12:24 Robin Kruppe <notifications@github.com> wrote:\n\n> @nagisa <https://github.com/nagisa> You might be thinking of float->float\n> casts, see #15536 <https://github.com/rust-lang/rust/issues/15536> and\n> rust-lang-nursery/nomicon#65\n> <https://github.com/rust-lang-nursery/nomicon/pull/65>.\n>\n> \u2014\n> You are receiving this because you were mentioned.\n> Reply to this email directly, view it on GitHub\n> <https://github.com/rust-lang/rust/issues/10184#issuecomment-406542903>,\n> or mute the thread\n> <https://github.com/notifications/unsubscribe-auth/AApc0gA24Hz8ndnYhRXCyacd3HdUSZjYks5uIaHegaJpZM4BJ45C>\n> .\n>\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/406549316/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/422871925",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-422871925",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 422871925,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQyMjg3MTkyNQ==",
    "user": {
      "login": "bstrie",
      "id": 865233,
      "node_id": "MDQ6VXNlcjg2NTIzMw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/865233?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/bstrie",
      "html_url": "https://github.com/bstrie",
      "followers_url": "https://api.github.com/users/bstrie/followers",
      "following_url": "https://api.github.com/users/bstrie/following{/other_user}",
      "gists_url": "https://api.github.com/users/bstrie/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/bstrie/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/bstrie/subscriptions",
      "organizations_url": "https://api.github.com/users/bstrie/orgs",
      "repos_url": "https://api.github.com/users/bstrie/repos",
      "events_url": "https://api.github.com/users/bstrie/events{/privacy}",
      "received_events_url": "https://api.github.com/users/bstrie/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2018-09-19T16:37:31Z",
    "updated_at": "2018-09-19T16:37:31Z",
    "body": "LLVM 7 release notes mention something:\r\n\r\n> Optimization of floating-point casts is improved. This may cause surprising results for code that is relying on the undefined behavior of overflowing casts. The optimization can be disabled by specifying a function attribute: \"strict-float-cast-overflow\"=\"false\". This attribute may be created by the clang option -fno-strict-float-cast-overflow. Code sanitizers can be used to detect affected patterns. The clang option for detecting this problem alone is -fsanitize=float-cast-overflow:\r\n\r\nDoes that have any bearing on this issue?",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/422871925/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/422876360",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-422876360",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 422876360,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQyMjg3NjM2MA==",
    "user": {
      "login": "retep998",
      "id": 666308,
      "node_id": "MDQ6VXNlcjY2NjMwOA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/666308?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/retep998",
      "html_url": "https://github.com/retep998",
      "followers_url": "https://api.github.com/users/retep998/followers",
      "following_url": "https://api.github.com/users/retep998/following{/other_user}",
      "gists_url": "https://api.github.com/users/retep998/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/retep998/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/retep998/subscriptions",
      "organizations_url": "https://api.github.com/users/retep998/orgs",
      "repos_url": "https://api.github.com/users/retep998/repos",
      "events_url": "https://api.github.com/users/retep998/events{/privacy}",
      "received_events_url": "https://api.github.com/users/retep998/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2018-09-19T16:50:28Z",
    "updated_at": "2018-09-19T16:50:28Z",
    "body": "We shouldn't care what LLVM does for overflowing casts, as long as it isn't unsafe undefined behavior. The result can be garbage as long as it can't cause unsound behavior.",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/422876360/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/422955316",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-422955316",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 422955316,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQyMjk1NTMxNg==",
    "user": {
      "login": "hanna-kruppe",
      "id": 2311707,
      "node_id": "MDQ6VXNlcjIzMTE3MDc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2311707?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hanna-kruppe",
      "html_url": "https://github.com/hanna-kruppe",
      "followers_url": "https://api.github.com/users/hanna-kruppe/followers",
      "following_url": "https://api.github.com/users/hanna-kruppe/following{/other_user}",
      "gists_url": "https://api.github.com/users/hanna-kruppe/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hanna-kruppe/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hanna-kruppe/subscriptions",
      "organizations_url": "https://api.github.com/users/hanna-kruppe/orgs",
      "repos_url": "https://api.github.com/users/hanna-kruppe/repos",
      "events_url": "https://api.github.com/users/hanna-kruppe/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hanna-kruppe/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2018-09-19T20:55:41Z",
    "updated_at": "2018-09-19T20:55:41Z",
    "body": "> Does that have any bearing on this issue?\r\n\r\nNot really. The UB did not change, LLVM got even more aggressive about exploiting it, which makes it easier to be affected by it in practice, but the soundness issue is unchanged. In particular, the new attribute does *not* remove the UB or affect any optimizations that existed before LLVM 7.",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/422955316/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/429659576",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-429659576",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 429659576,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQyOTY1OTU3Ng==",
    "user": {
      "login": "alexcrichton",
      "id": 64996,
      "node_id": "MDQ6VXNlcjY0OTk2",
      "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alexcrichton",
      "html_url": "https://github.com/alexcrichton",
      "followers_url": "https://api.github.com/users/alexcrichton/followers",
      "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}",
      "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions",
      "organizations_url": "https://api.github.com/users/alexcrichton/orgs",
      "repos_url": "https://api.github.com/users/alexcrichton/repos",
      "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alexcrichton/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2018-10-14T20:28:09Z",
    "updated_at": "2018-10-14T20:28:09Z",
    "body": "@rkruppe out of curiosity, has this sort of fallen by the wayside? It seems like https://internals.rust-lang.org/t/help-us-benchmark-saturating-float-casts/6231/14 went well enough and the implementation hasn't had too many bugs. It seems that a slight performance regression was always expected, but to compile correctly seems like a worthwhile tradeoff.\r\n\r\nIs this just waiting to be pushed across the finish line? Or are there other known blockers?",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/429659576/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/429663706",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-429663706",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 429663706,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQyOTY2MzcwNg==",
    "user": {
      "login": "hanna-kruppe",
      "id": 2311707,
      "node_id": "MDQ6VXNlcjIzMTE3MDc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2311707?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hanna-kruppe",
      "html_url": "https://github.com/hanna-kruppe",
      "followers_url": "https://api.github.com/users/hanna-kruppe/followers",
      "following_url": "https://api.github.com/users/hanna-kruppe/following{/other_user}",
      "gists_url": "https://api.github.com/users/hanna-kruppe/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hanna-kruppe/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hanna-kruppe/subscriptions",
      "organizations_url": "https://api.github.com/users/hanna-kruppe/orgs",
      "repos_url": "https://api.github.com/users/hanna-kruppe/repos",
      "events_url": "https://api.github.com/users/hanna-kruppe/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hanna-kruppe/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2018-10-14T21:20:49Z",
    "updated_at": "2018-10-14T21:22:36Z",
    "body": "Mostly I've been distracted / busy with other things, but a x0.82 regression in RBG JPEG encoding seems more than \"slight\", a rather bitter pill to swallow (although it's reassuring that other kinds of workload don't seem affected). It's not severe enough that I would object to turning saturation on by default, but enough that I'm hesitant to push for it myself before we've tried the \"also provide a conversion function that's faster than saturation but may generate (safe) garbage\" option discussed before. I haven't gotten to that, and apparently nobody else has either, so this has fallen by the wayside.",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/429663706/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/430673259",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-430673259",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 430673259,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQzMDY3MzI1OQ==",
    "user": {
      "login": "alexcrichton",
      "id": 64996,
      "node_id": "MDQ6VXNlcjY0OTk2",
      "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alexcrichton",
      "html_url": "https://github.com/alexcrichton",
      "followers_url": "https://api.github.com/users/alexcrichton/followers",
      "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}",
      "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions",
      "organizations_url": "https://api.github.com/users/alexcrichton/orgs",
      "repos_url": "https://api.github.com/users/alexcrichton/repos",
      "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alexcrichton/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2018-10-17T15:23:46Z",
    "updated_at": "2018-10-17T15:23:46Z",
    "body": "Ok cool thanks for the update @rkruppe! I'm curious though if there's actually an implementation of the safe garbage option? I could imagine us easily providing something like `unsafe fn i32::unchecked_from_f32(...)` and such, but it sounds like you're thinking that should be a *safe* function. Is that possible with LLVM today?",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/430673259/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/430677749",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-430677749",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 430677749,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQzMDY3Nzc0OQ==",
    "user": {
      "login": "hanna-kruppe",
      "id": 2311707,
      "node_id": "MDQ6VXNlcjIzMTE3MDc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2311707?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hanna-kruppe",
      "html_url": "https://github.com/hanna-kruppe",
      "followers_url": "https://api.github.com/users/hanna-kruppe/followers",
      "following_url": "https://api.github.com/users/hanna-kruppe/following{/other_user}",
      "gists_url": "https://api.github.com/users/hanna-kruppe/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hanna-kruppe/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hanna-kruppe/subscriptions",
      "organizations_url": "https://api.github.com/users/hanna-kruppe/orgs",
      "repos_url": "https://api.github.com/users/hanna-kruppe/repos",
      "events_url": "https://api.github.com/users/hanna-kruppe/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hanna-kruppe/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2018-10-17T15:35:07Z",
    "updated_at": "2018-10-17T15:35:07Z",
    "body": "There's no `freeze` yet but it is possible to use inline assembly to access the target architecture's instruction for converting floats to integers (with a fallback to e.g. saturating `as`). While this can inhibit some optimizations, it may be good enough to mostly fix the regression in some benchmarks.\r\n\r\nAn `unsafe` function that keeps the UB that this issue is about (and is codegen'd in the same way as `as` is today) is another option, but a much less attractive one, I'd prefer a safe function if it can get the job done.",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/430677749/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/430681835",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-430681835",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 430681835,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQzMDY4MTgzNQ==",
    "user": {
      "login": "sunfishcode",
      "id": 4503403,
      "node_id": "MDQ6VXNlcjQ1MDM0MDM=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4503403?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sunfishcode",
      "html_url": "https://github.com/sunfishcode",
      "followers_url": "https://api.github.com/users/sunfishcode/followers",
      "following_url": "https://api.github.com/users/sunfishcode/following{/other_user}",
      "gists_url": "https://api.github.com/users/sunfishcode/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sunfishcode/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sunfishcode/subscriptions",
      "organizations_url": "https://api.github.com/users/sunfishcode/orgs",
      "repos_url": "https://api.github.com/users/sunfishcode/repos",
      "events_url": "https://api.github.com/users/sunfishcode/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sunfishcode/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2018-10-17T15:45:41Z",
    "updated_at": "2018-10-17T15:46:24Z",
    "body": "There's also significant room for [improvement in the safe saturating float-to-int sequence](https://internals.rust-lang.org/t/help-us-benchmark-saturating-float-casts/6231/3). LLVM today doesn't have anything specifically for this, but if inline asm solutions are on the table, it wouldn't be difficult to do something like this:\r\n\r\n```asm\r\n     cvttsd2si %xmm0, %eax   # x86's cvttsd2si returns 0x80000000 on overflow and invalid cases\r\n     cmp $1, %eax            # a compact way to test whether %eax is equal to 0x80000000\r\n     jno ok\r\n     ...  # slow path: check for and handle overflow and invalid cases\r\nok:\r\n```\r\nwhich should be significantly faster than what [rustc currently does](https://github.com/rust-lang/rust/blob/master/src/librustc_codegen_llvm/mir/rvalue.rs#L947).",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/430681835/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/430697714",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-430697714",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 430697714,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQzMDY5NzcxNA==",
    "user": {
      "login": "alexcrichton",
      "id": 64996,
      "node_id": "MDQ6VXNlcjY0OTk2",
      "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alexcrichton",
      "html_url": "https://github.com/alexcrichton",
      "followers_url": "https://api.github.com/users/alexcrichton/followers",
      "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}",
      "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions",
      "organizations_url": "https://api.github.com/users/alexcrichton/orgs",
      "repos_url": "https://api.github.com/users/alexcrichton/repos",
      "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alexcrichton/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2018-10-17T16:30:11Z",
    "updated_at": "2018-10-17T16:30:11Z",
    "body": "Ok I just wanted to be sure to clarify, thanks! I figured that inline asm solutions aren't workable as defaults as it'd inhibit other optimizations too much, but I haven't tried out myself. I'd personally prefer that we close this unsound hole by defining some reasonable behavior (like exactly today's saturating casts). If necessary we can always preserve today's fast/unsound implementation as an unsafe function, and in the limit of time given infinite resources we can even drastically improve the default and/or add other specialized conversion functions (like a safe conversion where out of bounds isn't UB but just a garbage bit pattern)\r\n\r\nWould others be opposed to such a strategy? Do we think that this isn't important enough to fix in the meantime?",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/430697714/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/430713830",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-430713830",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 430713830,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQzMDcxMzgzMA==",
    "user": {
      "login": "hanna-kruppe",
      "id": 2311707,
      "node_id": "MDQ6VXNlcjIzMTE3MDc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2311707?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hanna-kruppe",
      "html_url": "https://github.com/hanna-kruppe",
      "followers_url": "https://api.github.com/users/hanna-kruppe/followers",
      "following_url": "https://api.github.com/users/hanna-kruppe/following{/other_user}",
      "gists_url": "https://api.github.com/users/hanna-kruppe/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hanna-kruppe/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hanna-kruppe/subscriptions",
      "organizations_url": "https://api.github.com/users/hanna-kruppe/orgs",
      "repos_url": "https://api.github.com/users/hanna-kruppe/repos",
      "events_url": "https://api.github.com/users/hanna-kruppe/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hanna-kruppe/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2018-10-17T17:18:07Z",
    "updated_at": "2018-10-17T17:18:07Z",
    "body": "I think inline assembly should be tolerable for `cvttsd2si` (or similar instructions) specifically because that inline asm would not access memory or have side effects, so it's just an opaque black box that can be removed if unused and doesn't inhibit optimizations *around* it very much, LLVM just can't reason about the internals and result value of the inline asm. That last bit is why I would be skeptical about e.g. using inline asm for the code sequence @sunfishcode suggests for saturation: the checks introduced for saturation can occasionally be removed today if they're redundant, but the branches in an inline asm block can't be simplified.\r\n\r\n> Would others be opposed to such a strategy? Do we think that this isn't important enough to fix in the meantime?\r\n\r\nI do not object to flipping on saturating now and possibly adding alternatives later, I just don't want to be the one who has to drum up the consensus for it and justify it to users whose code got slower \ud83d\ude05 ",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/430713830/reactions",
      "total_count": 4,
      "+1": 4,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/442624107",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-442624107",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 442624107,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ0MjYyNDEwNw==",
    "user": {
      "login": "nikic",
      "id": 216080,
      "node_id": "MDQ6VXNlcjIxNjA4MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/216080?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nikic",
      "html_url": "https://github.com/nikic",
      "followers_url": "https://api.github.com/users/nikic/followers",
      "following_url": "https://api.github.com/users/nikic/following{/other_user}",
      "gists_url": "https://api.github.com/users/nikic/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nikic/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nikic/subscriptions",
      "organizations_url": "https://api.github.com/users/nikic/orgs",
      "repos_url": "https://api.github.com/users/nikic/repos",
      "events_url": "https://api.github.com/users/nikic/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nikic/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2018-11-28T22:10:01Z",
    "updated_at": "2018-11-28T22:10:01Z",
    "body": "I've started some work to implement intrinsics for saturating float to int casts in LLVM: https://reviews.llvm.org/D54749\r\n\r\nIf that goes anywhere, it will provide a relatively low-overhead way of getting the saturating semantics.",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/442624107/reactions",
      "total_count": 25,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 25,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/468719768",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-468719768",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 468719768,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ2ODcxOTc2OA==",
    "user": {
      "login": "AaronM04",
      "id": 829076,
      "node_id": "MDQ6VXNlcjgyOTA3Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/829076?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AaronM04",
      "html_url": "https://github.com/AaronM04",
      "followers_url": "https://api.github.com/users/AaronM04/followers",
      "following_url": "https://api.github.com/users/AaronM04/following{/other_user}",
      "gists_url": "https://api.github.com/users/AaronM04/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AaronM04/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AaronM04/subscriptions",
      "organizations_url": "https://api.github.com/users/AaronM04/orgs",
      "repos_url": "https://api.github.com/users/AaronM04/repos",
      "events_url": "https://api.github.com/users/AaronM04/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AaronM04/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2019-03-01T16:16:50Z",
    "updated_at": "2019-03-01T16:16:50Z",
    "body": "How does one reproduce this undefined behavior? I tried the example in the comment but the result was `255`, which seems OK to me:\r\n```rust\r\nprintln!(\"{}\", 1.04E+17 as u8);\r\n```",
    "author_association": "NONE",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/468719768/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/468721903",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-468721903",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 468721903,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ2ODcyMTkwMw==",
    "user": {
      "login": "Manishearth",
      "id": 1617736,
      "node_id": "MDQ6VXNlcjE2MTc3MzY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1617736?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Manishearth",
      "html_url": "https://github.com/Manishearth",
      "followers_url": "https://api.github.com/users/Manishearth/followers",
      "following_url": "https://api.github.com/users/Manishearth/following{/other_user}",
      "gists_url": "https://api.github.com/users/Manishearth/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Manishearth/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Manishearth/subscriptions",
      "organizations_url": "https://api.github.com/users/Manishearth/orgs",
      "repos_url": "https://api.github.com/users/Manishearth/repos",
      "events_url": "https://api.github.com/users/Manishearth/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Manishearth/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2019-03-01T16:22:38Z",
    "updated_at": "2019-03-01T16:22:38Z",
    "body": "Undefined behavior can't be reliably observed that way, sometimes it gives you what you expect but in more complex situations breaks down.\r\n\r\nIn short, the code generation engine (LLVM) we use is allowed to assume that this doesn't happen, and thus it may generate bad code if it ever relies on this assumption.",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/468721903/reactions",
      "total_count": 3,
      "+1": 3,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/473353350",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-473353350",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 473353350,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ3MzM1MzM1MA==",
    "user": {
      "login": "lovasoa",
      "id": 552629,
      "node_id": "MDQ6VXNlcjU1MjYyOQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/552629?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/lovasoa",
      "html_url": "https://github.com/lovasoa",
      "followers_url": "https://api.github.com/users/lovasoa/followers",
      "following_url": "https://api.github.com/users/lovasoa/following{/other_user}",
      "gists_url": "https://api.github.com/users/lovasoa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/lovasoa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/lovasoa/subscriptions",
      "organizations_url": "https://api.github.com/users/lovasoa/orgs",
      "repos_url": "https://api.github.com/users/lovasoa/repos",
      "events_url": "https://api.github.com/users/lovasoa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/lovasoa/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2019-03-15T16:27:35Z",
    "updated_at": "2019-03-16T15:06:35Z",
    "body": "@AaronM04 an example of reproducible undefined behavior was [posted on reddit](https://www.reddit.com/r/rust/comments/b1efl5/why_do_these_3_numerical_conversions_f32_as_u8/) today:\r\n\r\n```rust\r\nfn main() {\r\n    let a = 360.0f32;\r\n    println!(\"{}\", a as u8);\r\n\r\n    let a = 360.0f32 as u8;\r\n    println!(\"{}\", a);\r\n\r\n    println!(\"{}\", 360.0f32 as u8);\r\n}\r\n```\r\n(see [playground](https://play.rust-lang.org/?version=stable&mode=debug&edition=2018&gist=c56d728658c2be88b26fb9f9c4d25c46))",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/473353350/reactions",
      "total_count": 22,
      "+1": 19,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 2,
      "rocket": 0,
      "eyes": 1
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/473537830",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-473537830",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 473537830,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ3MzUzNzgzMA==",
    "user": {
      "login": "shepmaster",
      "id": 174509,
      "node_id": "MDQ6VXNlcjE3NDUwOQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/174509?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/shepmaster",
      "html_url": "https://github.com/shepmaster",
      "followers_url": "https://api.github.com/users/shepmaster/followers",
      "following_url": "https://api.github.com/users/shepmaster/following{/other_user}",
      "gists_url": "https://api.github.com/users/shepmaster/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/shepmaster/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/shepmaster/subscriptions",
      "organizations_url": "https://api.github.com/users/shepmaster/orgs",
      "repos_url": "https://api.github.com/users/shepmaster/repos",
      "events_url": "https://api.github.com/users/shepmaster/events{/privacy}",
      "received_events_url": "https://api.github.com/users/shepmaster/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2019-03-16T14:53:47Z",
    "updated_at": "2019-03-16T14:53:47Z",
    "body": "I assume that last comment was meant for @AaronM04, in reference to [their previous comment](https://github.com/rust-lang/rust/issues/10184#issuecomment-468719768).",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/473537830/reactions",
      "total_count": 5,
      "+1": 2,
      "-1": 0,
      "laugh": 3,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/506032940",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-506032940",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 506032940,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUwNjAzMjk0MA==",
    "user": {
      "login": "popovdenys",
      "id": 35589034,
      "node_id": "MDQ6VXNlcjM1NTg5MDM0",
      "avatar_url": "https://avatars.githubusercontent.com/u/35589034?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/popovdenys",
      "html_url": "https://github.com/popovdenys",
      "followers_url": "https://api.github.com/users/popovdenys/followers",
      "following_url": "https://api.github.com/users/popovdenys/following{/other_user}",
      "gists_url": "https://api.github.com/users/popovdenys/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/popovdenys/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/popovdenys/subscriptions",
      "organizations_url": "https://api.github.com/users/popovdenys/orgs",
      "repos_url": "https://api.github.com/users/popovdenys/repos",
      "events_url": "https://api.github.com/users/popovdenys/events{/privacy}",
      "received_events_url": "https://api.github.com/users/popovdenys/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2019-06-26T20:30:09Z",
    "updated_at": "2019-06-26T20:30:09Z",
    "body": " \"Oh, that's easy enough then.\"\r\n - @pcwalton, 2014\r\n\r\nSorry, I've read very carefully all this 6-year history of good intentions. But, seriously, 6 long years out of 10!!! Had it been a politician forum one would have anticipated some blazing sabotage around here.\r\n\r\nSo, please, can anybody explain, in simple words, what does it make the process of looking for a solution more interesting than the solution itself?",
    "author_association": "NONE",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/506032940/reactions",
      "total_count": 3,
      "+1": 0,
      "-1": 2,
      "laugh": 0,
      "hooray": 0,
      "confused": 1,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/506035477",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-506035477",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 506035477,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUwNjAzNTQ3Nw==",
    "user": {
      "login": "Manishearth",
      "id": 1617736,
      "node_id": "MDQ6VXNlcjE2MTc3MzY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1617736?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Manishearth",
      "html_url": "https://github.com/Manishearth",
      "followers_url": "https://api.github.com/users/Manishearth/followers",
      "following_url": "https://api.github.com/users/Manishearth/following{/other_user}",
      "gists_url": "https://api.github.com/users/Manishearth/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Manishearth/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Manishearth/subscriptions",
      "organizations_url": "https://api.github.com/users/Manishearth/orgs",
      "repos_url": "https://api.github.com/users/Manishearth/repos",
      "events_url": "https://api.github.com/users/Manishearth/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Manishearth/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2019-06-26T20:37:59Z",
    "updated_at": "2019-06-26T20:37:59Z",
    "body": "Because it's harder than it seemed initially and needs LLVM changes.",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/506035477/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/506040688",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-506040688",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 506040688,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUwNjA0MDY4OA==",
    "user": {
      "login": "popovdenys",
      "id": 35589034,
      "node_id": "MDQ6VXNlcjM1NTg5MDM0",
      "avatar_url": "https://avatars.githubusercontent.com/u/35589034?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/popovdenys",
      "html_url": "https://github.com/popovdenys",
      "followers_url": "https://api.github.com/users/popovdenys/followers",
      "following_url": "https://api.github.com/users/popovdenys/following{/other_user}",
      "gists_url": "https://api.github.com/users/popovdenys/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/popovdenys/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/popovdenys/subscriptions",
      "organizations_url": "https://api.github.com/users/popovdenys/orgs",
      "repos_url": "https://api.github.com/users/popovdenys/repos",
      "events_url": "https://api.github.com/users/popovdenys/events{/privacy}",
      "received_events_url": "https://api.github.com/users/popovdenys/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2019-06-26T20:54:25Z",
    "updated_at": "2019-06-26T20:54:25Z",
    "body": "Ok, but it was not God who has made this LLVM on his second week, and moving in the same direction it might take another 15 years to resolve this fundamental problem.\r\n\r\nReally, I have no attention to hurt somebody, and I'm new to Rust infrastructure to help suddenly but when I've learned about this case I was just stunned.",
    "author_association": "NONE",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/506040688/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/506048602",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-506048602",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 506048602,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUwNjA0ODYwMg==",
    "user": {
      "login": "RalfJung",
      "id": 330628,
      "node_id": "MDQ6VXNlcjMzMDYyOA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/330628?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/RalfJung",
      "html_url": "https://github.com/RalfJung",
      "followers_url": "https://api.github.com/users/RalfJung/followers",
      "following_url": "https://api.github.com/users/RalfJung/following{/other_user}",
      "gists_url": "https://api.github.com/users/RalfJung/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/RalfJung/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/RalfJung/subscriptions",
      "organizations_url": "https://api.github.com/users/RalfJung/orgs",
      "repos_url": "https://api.github.com/users/RalfJung/repos",
      "events_url": "https://api.github.com/users/RalfJung/events{/privacy}",
      "received_events_url": "https://api.github.com/users/RalfJung/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2019-06-26T21:17:11Z",
    "updated_at": "2019-06-26T21:17:11Z",
    "body": "This issue tracker is for discussing how to solve this problem, and stating the obvious makes no progress in that direction. So if you want to help solve the problem or have some new information to contribute, please do, but otherwise your comments are not going to magically make the fix appear. :)",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/506048602/reactions",
      "total_count": 6,
      "+1": 0,
      "-1": 1,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 5,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/506063849",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-506063849",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 506063849,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUwNjA2Mzg0OQ==",
    "user": {
      "login": "IGBC",
      "id": 8123843,
      "node_id": "MDQ6VXNlcjgxMjM4NDM=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8123843?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/IGBC",
      "html_url": "https://github.com/IGBC",
      "followers_url": "https://api.github.com/users/IGBC/followers",
      "following_url": "https://api.github.com/users/IGBC/following{/other_user}",
      "gists_url": "https://api.github.com/users/IGBC/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/IGBC/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/IGBC/subscriptions",
      "organizations_url": "https://api.github.com/users/IGBC/orgs",
      "repos_url": "https://api.github.com/users/IGBC/repos",
      "events_url": "https://api.github.com/users/IGBC/events{/privacy}",
      "received_events_url": "https://api.github.com/users/IGBC/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2019-06-26T22:10:56Z",
    "updated_at": "2019-06-26T22:11:33Z",
    "body": "I think the assumption that this requires changes in LLVM is premature.\r\n\r\nI think we can do it in the language with mimimal performance cost. Would it be a breaking change **** yea but it could be done, and should be done. \r\n\r\nMy go to solution would be to define float to int casts as `unsafe` then provide some helper functions in the, standard lib to provide results bound in `Result` Types.\r\n\r\nIt's an unsexy fix and it's a breaking change, but ultimately it is what every developer has to code themselves to work around the existing UB already. This is the correct rust approach. \r\n\r\n\r\n\r\n\r\n\r\n",
    "author_association": "NONE",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/506063849/reactions",
      "total_count": 1,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 1,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/506075679",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-506075679",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 506075679,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUwNjA3NTY3OQ==",
    "user": {
      "login": "popovdenys",
      "id": 35589034,
      "node_id": "MDQ6VXNlcjM1NTg5MDM0",
      "avatar_url": "https://avatars.githubusercontent.com/u/35589034?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/popovdenys",
      "html_url": "https://github.com/popovdenys",
      "followers_url": "https://api.github.com/users/popovdenys/followers",
      "following_url": "https://api.github.com/users/popovdenys/following{/other_user}",
      "gists_url": "https://api.github.com/users/popovdenys/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/popovdenys/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/popovdenys/subscriptions",
      "organizations_url": "https://api.github.com/users/popovdenys/orgs",
      "repos_url": "https://api.github.com/users/popovdenys/repos",
      "events_url": "https://api.github.com/users/popovdenys/events{/privacy}",
      "received_events_url": "https://api.github.com/users/popovdenys/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2019-06-26T23:01:40Z",
    "updated_at": "2019-06-26T23:01:40Z",
    "body": "Thank you, @RalfJung, to make me understand it. I had no intention to insult anybody or scornfully intervene in the productive brainstorming process. Being new in rust, it is true, there is not so much I can do. Nevertheless, it helps me and maybe others, who try to enter into rust, learn more about its unsolved flaws and make the relevant output: is it worth to dig deeper or it is better to choose something else for now. But I'm already glad that removal of \"my useless comments\" will be much easier.",
    "author_association": "NONE",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/506075679/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/506092841",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-506092841",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 506092841,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUwNjA5Mjg0MQ==",
    "user": {
      "login": "Gankra",
      "id": 1136864,
      "node_id": "MDQ6VXNlcjExMzY4NjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1136864?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Gankra",
      "html_url": "https://github.com/Gankra",
      "followers_url": "https://api.github.com/users/Gankra/followers",
      "following_url": "https://api.github.com/users/Gankra/following{/other_user}",
      "gists_url": "https://api.github.com/users/Gankra/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Gankra/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Gankra/subscriptions",
      "organizations_url": "https://api.github.com/users/Gankra/orgs",
      "repos_url": "https://api.github.com/users/Gankra/repos",
      "events_url": "https://api.github.com/users/Gankra/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Gankra/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2019-06-27T00:32:23Z",
    "updated_at": "2019-06-27T00:33:13Z",
    "body": "As noted earlier in the thread, this is slowly but surely being fixed the Right Way by fixing llvm to support the necessary semantics, as the relevant teams have long ago agreed.\r\n\r\nNothing more can really be added to this discussion.\r\n\r\nhttps://reviews.llvm.org/D54749",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/506092841/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/528779814",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-528779814",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 528779814,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUyODc3OTgxNA==",
    "user": {
      "login": "Centril",
      "id": 855702,
      "node_id": "MDQ6VXNlcjg1NTcwMg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/855702?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Centril",
      "html_url": "https://github.com/Centril",
      "followers_url": "https://api.github.com/users/Centril/followers",
      "following_url": "https://api.github.com/users/Centril/following{/other_user}",
      "gists_url": "https://api.github.com/users/Centril/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Centril/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Centril/subscriptions",
      "organizations_url": "https://api.github.com/users/Centril/orgs",
      "repos_url": "https://api.github.com/users/Centril/repos",
      "events_url": "https://api.github.com/users/Centril/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Centril/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2019-09-06T09:17:25Z",
    "updated_at": "2019-09-06T09:17:25Z",
    "body": "@nikic Seems like progress on LLVM's side has stalled, could you give a brief update if possible? Thanks.",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/528779814/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/546744187",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-546744187",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 546744187,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU0Njc0NDE4Nw==",
    "user": {
      "login": "SimonSapin",
      "id": 291359,
      "node_id": "MDQ6VXNlcjI5MTM1OQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/291359?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/SimonSapin",
      "html_url": "https://github.com/SimonSapin",
      "followers_url": "https://api.github.com/users/SimonSapin/followers",
      "following_url": "https://api.github.com/users/SimonSapin/following{/other_user}",
      "gists_url": "https://api.github.com/users/SimonSapin/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/SimonSapin/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/SimonSapin/subscriptions",
      "organizations_url": "https://api.github.com/users/SimonSapin/orgs",
      "repos_url": "https://api.github.com/users/SimonSapin/repos",
      "events_url": "https://api.github.com/users/SimonSapin/events{/privacy}",
      "received_events_url": "https://api.github.com/users/SimonSapin/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2019-10-27T23:02:57Z",
    "updated_at": "2019-10-27T23:02:57Z",
    "body": "Can the saturating cast be implemented as a library function that users could opt into, if they are willing to take some pref regression to get soundess? I\u2019m reading the compiler\u2019s implementation but it seems quite subtle:\r\n\r\nhttps://github.com/rust-lang/rust/blob/625451e376bb2e5283fc4741caa0a3e8a2ca4d54/src/librustc_codegen_ssa/mir/rvalue.rs#L774-L901",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/546744187/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/546906494",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-546906494",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 546906494,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU0NjkwNjQ5NA==",
    "user": {
      "login": "hanna-kruppe",
      "id": 2311707,
      "node_id": "MDQ6VXNlcjIzMTE3MDc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2311707?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hanna-kruppe",
      "html_url": "https://github.com/hanna-kruppe",
      "followers_url": "https://api.github.com/users/hanna-kruppe/followers",
      "following_url": "https://api.github.com/users/hanna-kruppe/following{/other_user}",
      "gists_url": "https://api.github.com/users/hanna-kruppe/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hanna-kruppe/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hanna-kruppe/subscriptions",
      "organizations_url": "https://api.github.com/users/hanna-kruppe/orgs",
      "repos_url": "https://api.github.com/users/hanna-kruppe/repos",
      "events_url": "https://api.github.com/users/hanna-kruppe/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hanna-kruppe/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2019-10-28T11:33:28Z",
    "updated_at": "2019-10-28T11:33:28Z",
    "body": "We could expose an intrinsic that generates the LLVM IR for saturation (whether that be the current open-coded IR or `llvm.fpto[su]i.sat` in the future) independent of the `-Z` flag. That is not difficult at all to do.\r\n\r\nHowever, I'm concerned whether it's the best course of action. When (if?) saturation becomes the default semantics of `as` casts, such an API becomes redundant. It also seems ungreat to tell users that they should choose for themselves whether they want soundness or performance, even if it's only temporary.\r\n\r\nAt the same time, the current situation is clearly even worse. If we're thinking about adding library APIs, I'm warning up more and more to just enable saturation by default and offer an `unsafe` intrinsics that has UB on NaN and out-of-range numbers (and lowers to a plain `fpto[su]i`). That would still offer basically the same choice, but defaulting to soundness, and the new API would likely not become redundant in the future.",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/546906494/reactions",
      "total_count": 5,
      "+1": 5,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/547086075",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-547086075",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 547086075,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU0NzA4NjA3NQ==",
    "user": {
      "login": "Centril",
      "id": 855702,
      "node_id": "MDQ6VXNlcjg1NTcwMg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/855702?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Centril",
      "html_url": "https://github.com/Centril",
      "followers_url": "https://api.github.com/users/Centril/followers",
      "following_url": "https://api.github.com/users/Centril/following{/other_user}",
      "gists_url": "https://api.github.com/users/Centril/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Centril/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Centril/subscriptions",
      "organizations_url": "https://api.github.com/users/Centril/orgs",
      "repos_url": "https://api.github.com/users/Centril/repos",
      "events_url": "https://api.github.com/users/Centril/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Centril/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2019-10-28T18:33:08Z",
    "updated_at": "2019-10-28T18:33:08Z",
    "body": "Switching to sound by default sounds good. I think we can offer the intrinsic lazily upon request rather than from the get-go. Also, will const eval do the saturation as well in this case? (cc @RalfJung @eddyb @oli-obk)",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/547086075/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/547089904",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-547089904",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 547089904,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU0NzA4OTkwNA==",
    "user": {
      "login": "hanna-kruppe",
      "id": 2311707,
      "node_id": "MDQ6VXNlcjIzMTE3MDc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2311707?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hanna-kruppe",
      "html_url": "https://github.com/hanna-kruppe",
      "followers_url": "https://api.github.com/users/hanna-kruppe/followers",
      "following_url": "https://api.github.com/users/hanna-kruppe/following{/other_user}",
      "gists_url": "https://api.github.com/users/hanna-kruppe/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hanna-kruppe/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hanna-kruppe/subscriptions",
      "organizations_url": "https://api.github.com/users/hanna-kruppe/orgs",
      "repos_url": "https://api.github.com/users/hanna-kruppe/repos",
      "events_url": "https://api.github.com/users/hanna-kruppe/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hanna-kruppe/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2019-10-28T18:41:42Z",
    "updated_at": "2019-10-28T18:41:42Z",
    "body": "Const eval us already doing saturation and has done so for ages, I think even before miri (I distinctly remember changing it in the old `llvm::Constant`-based evaluator). ",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/547089904/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/547091410",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-547091410",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 547091410,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU0NzA5MTQxMA==",
    "user": {
      "login": "Centril",
      "id": 855702,
      "node_id": "MDQ6VXNlcjg1NTcwMg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/855702?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Centril",
      "html_url": "https://github.com/Centril",
      "followers_url": "https://api.github.com/users/Centril/followers",
      "following_url": "https://api.github.com/users/Centril/following{/other_user}",
      "gists_url": "https://api.github.com/users/Centril/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Centril/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Centril/subscriptions",
      "organizations_url": "https://api.github.com/users/Centril/orgs",
      "repos_url": "https://api.github.com/users/Centril/repos",
      "events_url": "https://api.github.com/users/Centril/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Centril/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2019-10-28T18:45:20Z",
    "updated_at": "2019-10-28T18:45:20Z",
    "body": "@rkruppe Awesome! Since you are familiar with the code in question, would you like to spearhead switching the defaults?",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/547091410/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/547379935",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-547379935",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 547379935,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU0NzM3OTkzNQ==",
    "user": {
      "login": "SimonSapin",
      "id": 291359,
      "node_id": "MDQ6VXNlcjI5MTM1OQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/291359?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/SimonSapin",
      "html_url": "https://github.com/SimonSapin",
      "followers_url": "https://api.github.com/users/SimonSapin/followers",
      "following_url": "https://api.github.com/users/SimonSapin/following{/other_user}",
      "gists_url": "https://api.github.com/users/SimonSapin/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/SimonSapin/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/SimonSapin/subscriptions",
      "organizations_url": "https://api.github.com/users/SimonSapin/orgs",
      "repos_url": "https://api.github.com/users/SimonSapin/repos",
      "events_url": "https://api.github.com/users/SimonSapin/events{/privacy}",
      "received_events_url": "https://api.github.com/users/SimonSapin/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2019-10-29T11:39:52Z",
    "updated_at": "2019-10-29T11:39:52Z",
    "body": "@rkruppe \r\n> We could expose an intrinsic that generates the LLVM IR for saturation\r\n\r\nThis may need to be 10 or 12 separate intrinsics, for each combination of source and destination type.",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/547379935/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/547382241",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-547382241",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 547382241,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU0NzM4MjI0MQ==",
    "user": {
      "login": "SimonSapin",
      "id": 291359,
      "node_id": "MDQ6VXNlcjI5MTM1OQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/291359?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/SimonSapin",
      "html_url": "https://github.com/SimonSapin",
      "followers_url": "https://api.github.com/users/SimonSapin/followers",
      "following_url": "https://api.github.com/users/SimonSapin/following{/other_user}",
      "gists_url": "https://api.github.com/users/SimonSapin/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/SimonSapin/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/SimonSapin/subscriptions",
      "organizations_url": "https://api.github.com/users/SimonSapin/orgs",
      "repos_url": "https://api.github.com/users/SimonSapin/repos",
      "events_url": "https://api.github.com/users/SimonSapin/events{/privacy}",
      "received_events_url": "https://api.github.com/users/SimonSapin/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2019-10-29T11:47:09Z",
    "updated_at": "2019-10-29T11:47:09Z",
    "body": "@Centril \r\n> Switching to sound by default sounds good. I think we can offer the intrinsic lazily upon request rather than from the get-go.\r\n\r\nI assume that unlike in other comments, \u201cthe intrinsic\u201d in your comment means something that would have less pref regression when `as` does saturation.\r\n\r\nI don\u2019t think this is a good approach to deal with *known* significant regressions. For some users the performance loss might be a real problem, while their algorithm ensure the input is always in range. If they\u2019re not subscribed to this thread they might only realize they are affected when the change reaches the Stable channel. At that point they might be stuck for 6 to 12 weeks even if we land an unsafe API immediately upon request.\r\n\r\nI\u2019d much rather we follow the pattern already established for deprecation warnings: only make the switch in Nightly after the alternative has been available in Stable for some time.",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/547382241/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/547385121",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-547385121",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 547385121,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU0NzM4NTEyMQ==",
    "user": {
      "login": "hanna-kruppe",
      "id": 2311707,
      "node_id": "MDQ6VXNlcjIzMTE3MDc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2311707?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hanna-kruppe",
      "html_url": "https://github.com/hanna-kruppe",
      "followers_url": "https://api.github.com/users/hanna-kruppe/followers",
      "following_url": "https://api.github.com/users/hanna-kruppe/following{/other_user}",
      "gists_url": "https://api.github.com/users/hanna-kruppe/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hanna-kruppe/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hanna-kruppe/subscriptions",
      "organizations_url": "https://api.github.com/users/hanna-kruppe/orgs",
      "repos_url": "https://api.github.com/users/hanna-kruppe/repos",
      "events_url": "https://api.github.com/users/hanna-kruppe/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hanna-kruppe/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2019-10-29T11:55:58Z",
    "updated_at": "2019-10-29T11:55:58Z",
    "body": "> This may need to be 10 or 12 separate intrinsics, for each combination of source and destination type.\r\n\r\nFine, you got me, but I don't see how that's relevant? Let it be 30 intrinsics, it's stilll trivial to add them. But in reality, it's even easier to have a single generic intrinsic used by N thin wrappers. The number also doesn't change if we choose the \"make `as` sound and introduce an `unsafe` cast API\" option.\r\n\r\n\r\n\r\n> I don\u2019t think this is a good approach to deal with _known_ significant regressions. For some users the performance loss might be a real problem, while their algorithm ensure the input is always in range. If they\u2019re not subscribed to this thread they might only realize they are affected when the change reaches the Stable channel. At that point they might be stuck for 6 to 12 weeks even if we land an unsafe API immediately upon request.\r\n\r\n+1\r\n\r\nI'm not sure whether the procedure for deprecation warnings (only deprecate on nightly once the replacement is stable) is necessary since it seems less important to remain perf-regression-free across all release channels than to remain warning-free across all release channels, but then again, waiting 12 more weeks is basically a rounding error with how long this issue has been around.\r\n\r\nWe can also leave the `-Zsaturating-float-casts` around (just changing the default) which means any nightly users can still opt out of the cange for a while.",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/547385121/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/547423383",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-547423383",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 547423383,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU0NzQyMzM4Mw==",
    "user": {
      "login": "SimonSapin",
      "id": 291359,
      "node_id": "MDQ6VXNlcjI5MTM1OQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/291359?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/SimonSapin",
      "html_url": "https://github.com/SimonSapin",
      "followers_url": "https://api.github.com/users/SimonSapin/followers",
      "following_url": "https://api.github.com/users/SimonSapin/following{/other_user}",
      "gists_url": "https://api.github.com/users/SimonSapin/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/SimonSapin/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/SimonSapin/subscriptions",
      "organizations_url": "https://api.github.com/users/SimonSapin/orgs",
      "repos_url": "https://api.github.com/users/SimonSapin/repos",
      "events_url": "https://api.github.com/users/SimonSapin/events{/privacy}",
      "received_events_url": "https://api.github.com/users/SimonSapin/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2019-10-29T13:37:58Z",
    "updated_at": "2019-10-29T13:37:58Z",
    "body": "(Yes the number of intrinsics is just an implementation detail and was not meant as an argument for or against anything.)",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/547423383/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/556995980",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-556995980",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 556995980,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU1Njk5NTk4MA==",
    "user": {
      "login": "pnkfelix",
      "id": 173127,
      "node_id": "MDQ6VXNlcjE3MzEyNw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/173127?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/pnkfelix",
      "html_url": "https://github.com/pnkfelix",
      "followers_url": "https://api.github.com/users/pnkfelix/followers",
      "following_url": "https://api.github.com/users/pnkfelix/following{/other_user}",
      "gists_url": "https://api.github.com/users/pnkfelix/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/pnkfelix/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/pnkfelix/subscriptions",
      "organizations_url": "https://api.github.com/users/pnkfelix/orgs",
      "repos_url": "https://api.github.com/users/pnkfelix/repos",
      "events_url": "https://api.github.com/users/pnkfelix/events{/privacy}",
      "received_events_url": "https://api.github.com/users/pnkfelix/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2019-11-21T09:26:16Z",
    "updated_at": "2019-11-21T09:26:16Z",
    "body": "@rkruppe I cannot claim to have digested all of the comments here, but I am under the impression that LLVM [now](https://github.com/llvm/llvm-project/commit/58acbce3def63a207b8f5a69318a9966) *does* have a freeze instruction, which was the item blocking the \"shortest path\" to eliminating UB here, right?\r\n\r\nThough I guess `freeze` is so new that it may not be available in our own version of LLVM, right? Still, seems like something we should be exploring development on, perhaps during the first half of 2020?\r\n\r\nNominating for discussion at T-compiler meeting, to try to get rough consensus on our desired path at this point.",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/556995980/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/557020602",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-557020602",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 557020602,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU1NzAyMDYwMg==",
    "user": {
      "login": "RalfJung",
      "id": 330628,
      "node_id": "MDQ6VXNlcjMzMDYyOA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/330628?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/RalfJung",
      "html_url": "https://github.com/RalfJung",
      "followers_url": "https://api.github.com/users/RalfJung/followers",
      "following_url": "https://api.github.com/users/RalfJung/following{/other_user}",
      "gists_url": "https://api.github.com/users/RalfJung/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/RalfJung/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/RalfJung/subscriptions",
      "organizations_url": "https://api.github.com/users/RalfJung/orgs",
      "repos_url": "https://api.github.com/users/RalfJung/repos",
      "events_url": "https://api.github.com/users/RalfJung/events{/privacy}",
      "received_events_url": "https://api.github.com/users/RalfJung/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2019-11-21T10:26:50Z",
    "updated_at": "2019-11-21T10:26:50Z",
    "body": "Using `freeze` is still problematic though for all the reasons [referenced here](https://www.reddit.com/r/rust/comments/apreqi/ucgmiri_allhands_2019_recap/egarzl8/). I am not sure how realistic such concerns are with using freeze for these casts, but in principle they apply. Basically, expect `freeze` to return either random garbage or your secret key, whatever is worse. (I read this online somewhere and really like it has a summary. :D )\r\n\r\nAnd anyway, even returning random garbage seems rather bad for an `as` cast. It makes sense to have faster operations for speed where needed, similar to `unchecked_add`, but making that the *default* seems quite strongly against Rust's spirit.\r\n\r\n@SimonSapin you proposed the opposite approach first (default to unsound/\"weird\" semantics and provide an explicitly sound method); I cannot tell from your later comments whether you think defaulting to soundness (after a suitable transition period) is also reasonable / better?",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/557020602/reactions",
      "total_count": 2,
      "+1": 2,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/557022386",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-557022386",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 557022386,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU1NzAyMjM4Ng==",
    "user": {
      "login": "hanna-kruppe",
      "id": 2311707,
      "node_id": "MDQ6VXNlcjIzMTE3MDc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2311707?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hanna-kruppe",
      "html_url": "https://github.com/hanna-kruppe",
      "followers_url": "https://api.github.com/users/hanna-kruppe/followers",
      "following_url": "https://api.github.com/users/hanna-kruppe/following{/other_user}",
      "gists_url": "https://api.github.com/users/hanna-kruppe/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hanna-kruppe/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hanna-kruppe/subscriptions",
      "organizations_url": "https://api.github.com/users/hanna-kruppe/orgs",
      "repos_url": "https://api.github.com/users/hanna-kruppe/repos",
      "events_url": "https://api.github.com/users/hanna-kruppe/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hanna-kruppe/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2019-11-21T10:31:21Z",
    "updated_at": "2019-11-21T10:31:58Z",
    "body": "@pnkfelix \r\n> I am under the impression that LLVM now does have a freeze instruction, which was the item blocking the \"shortest path\" to eliminating UB here, right?\r\n\r\nThere are some caveats. Most importantly, even if all we care about is getting rid of UB and we update our bundled LLVM to include `freeze` (which we could do at any time), we support several older versions (back to LLVM 6 at the moment) and we'd need some fallback implementation for those to actually get rid of the UB for all users.\r\n\r\nSecond, of course, is the question whether \"just not UB\" is all we care about while we're at it. In particular, I want to highlight again that a `freeze(fptosi %x)` behaves extremely counter-intuitively: it's non-deterministic and can return a different result (even one taken from sensitive memory as @RalfJung said) every time it's executed. I don't want to go into debating this again now but it's worth considering in the meeting if we'd rather do a little more work to make saturation the default and unchecked (either unsafe or `freeze`-using) conversions the non-default option.",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/557022386/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/557028359",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-557028359",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 557028359,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU1NzAyODM1OQ==",
    "user": {
      "login": "SimonSapin",
      "id": 291359,
      "node_id": "MDQ6VXNlcjI5MTM1OQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/291359?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/SimonSapin",
      "html_url": "https://github.com/SimonSapin",
      "followers_url": "https://api.github.com/users/SimonSapin/followers",
      "following_url": "https://api.github.com/users/SimonSapin/following{/other_user}",
      "gists_url": "https://api.github.com/users/SimonSapin/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/SimonSapin/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/SimonSapin/subscriptions",
      "organizations_url": "https://api.github.com/users/SimonSapin/orgs",
      "repos_url": "https://api.github.com/users/SimonSapin/repos",
      "events_url": "https://api.github.com/users/SimonSapin/events{/privacy}",
      "received_events_url": "https://api.github.com/users/SimonSapin/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2019-11-21T10:47:06Z",
    "updated_at": "2019-11-21T10:47:06Z",
    "body": "@RalfJung My position is that `as` is best avoided entirely regardless of this issue, because it can have wildly different semantics (truncating, saturating, rounding, \u2026) depending on the input and output type, and those are not always obvious when reading code. (Even the latter can be inferred with `foo as _`.) So I have a draft pre-RFC for proposing various explicitly-named conversion methods that cover the cases that `as` does today (and maybe more).\r\n\r\nI think `as` should definitely not have UB, since it can be used outside of `unsafe`. Returning garbage doesn\u2019t sound good either. But we should probably have some kind of mitigation/transition/alternative for known cases of performance regression caused by saturating cast. I only asked about a library implementation of saturating cast in order to not block this draft RFC on that transition.",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/557028359/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/557035612",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-557035612",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 557035612,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU1NzAzNTYxMg==",
    "user": {
      "login": "RalfJung",
      "id": 330628,
      "node_id": "MDQ6VXNlcjMzMDYyOA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/330628?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/RalfJung",
      "html_url": "https://github.com/RalfJung",
      "followers_url": "https://api.github.com/users/RalfJung/followers",
      "following_url": "https://api.github.com/users/RalfJung/following{/other_user}",
      "gists_url": "https://api.github.com/users/RalfJung/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/RalfJung/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/RalfJung/subscriptions",
      "organizations_url": "https://api.github.com/users/RalfJung/orgs",
      "repos_url": "https://api.github.com/users/RalfJung/repos",
      "events_url": "https://api.github.com/users/RalfJung/events{/privacy}",
      "received_events_url": "https://api.github.com/users/RalfJung/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2019-11-21T11:06:11Z",
    "updated_at": "2019-11-21T11:06:54Z",
    "body": "@SimonSapin \r\n> My position is that as is best avoided entirely regardless of this issue, because it can have wildly different semantics (truncating, saturating, rounding, \u2026)\r\n\r\nAgreed. But that doesn't really help us with this issue.\r\n\r\n(Also, I am happy that you are working towards making `as` not needed. Looking forward to that. :D )\r\n\r\n> I think as should definitely not have UB, since it can be used outside of unsafe. Returning garbage doesn\u2019t sound good either. But we should probably have some kind of mitigation/transition/alternative for known cases of performance regression caused by saturating cast. I only asked about a library implementation of saturating cast in order to not block this draft RFC on that transition.\r\n\r\nSo we seem to agree that the final state should be that float-to-int `as` saturates? I am happy with any transition plan as long as that is the end goal we are moving towards.",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/557035612/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/557037025",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-557037025",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 557037025,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU1NzAzNzAyNQ==",
    "user": {
      "login": "SimonSapin",
      "id": 291359,
      "node_id": "MDQ6VXNlcjI5MTM1OQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/291359?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/SimonSapin",
      "html_url": "https://github.com/SimonSapin",
      "followers_url": "https://api.github.com/users/SimonSapin/followers",
      "following_url": "https://api.github.com/users/SimonSapin/following{/other_user}",
      "gists_url": "https://api.github.com/users/SimonSapin/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/SimonSapin/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/SimonSapin/subscriptions",
      "organizations_url": "https://api.github.com/users/SimonSapin/orgs",
      "repos_url": "https://api.github.com/users/SimonSapin/repos",
      "events_url": "https://api.github.com/users/SimonSapin/events{/privacy}",
      "received_events_url": "https://api.github.com/users/SimonSapin/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2019-11-21T11:10:21Z",
    "updated_at": "2019-11-21T11:10:21Z",
    "body": "That end goal sounds good to me.",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/557037025/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/557038601",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-557038601",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 557038601,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU1NzAzODYwMQ==",
    "user": {
      "login": "Centril",
      "id": 855702,
      "node_id": "MDQ6VXNlcjg1NTcwMg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/855702?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Centril",
      "html_url": "https://github.com/Centril",
      "followers_url": "https://api.github.com/users/Centril/followers",
      "following_url": "https://api.github.com/users/Centril/following{/other_user}",
      "gists_url": "https://api.github.com/users/Centril/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Centril/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Centril/subscriptions",
      "organizations_url": "https://api.github.com/users/Centril/orgs",
      "repos_url": "https://api.github.com/users/Centril/repos",
      "events_url": "https://api.github.com/users/Centril/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Centril/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2019-11-21T11:14:38Z",
    "updated_at": "2019-11-21T11:18:41Z",
    "body": "> I don\u2019t think this is a good approach to deal with _known_ significant regressions. For some users the performance loss might be a real problem, while their algorithm ensure the input is always in range. If they\u2019re not subscribed to this thread they might only realize they are affected when the change reaches the Stable channel. At that point they might be stuck for 6 to 12 weeks even if we land an unsafe API immediately upon request.\r\n\r\nIn my view, it would not be the end of the world if those users wait with upgrading their rustc for those 6-12 weeks -- they might not need anything from the upcoming releases in either case, or their libraries may have MSRV constraints to uphold.\r\n\r\nMeanwhile, users, who are also not subscribed to the thread might be getting miscompilations just as they might be getting performance losses. Which should we prioritize? We give guarantees about stability and we give guarantees about safety -- but to my knowledge, no such guarantees are given about performance (e.g. RFC 1122 doesn't mention perf at all).\r\n\r\n> I\u2019d much rather we follow the pattern already established for deprecation warnings: only make the switch in Nightly after the alternative has been available in Stable for some time.\r\n\r\nIn the case of deprecation warnings, the consequence of waiting with the deprecation until there's a stable alternative is not, at least as far as I know, soundness holes during the waiting period. (Also, while intrinsics can be provided here, in the general case, we might not be able to reasonably offer alternatives when fixing soundness holes. So I don't think having alternatives on stable can be a hard requirement.)\r\n\r\n> Fine, you got me, but I don't see how that's relevant? Let it be 30 intrinsics, it's stilll trivial to add them. But in reality, it's even easier to have a single generic intrinsic used by N thin wrappers. The number also doesn't change if we choose the \"make `as` sound and introduce an `unsafe` cast API\" option.\r\n\r\nWon't that single generic intrinsic requires separate implementations in the compiler for those 12/30 specific monomorphic instantiations?\r\n\r\nIt might be trivial to add intrinsics to the compiler, because LLVM has already done most of the work, but that is also far from the full cost. In addition, there's the implementation in Miri, Cranelift, as well as the eventual work needed in a specification. So I don't think we should add intrinsics on the off-chance someone needs them.\r\n\r\n*I am however not opposed to exposing more intrinsics, but if someone needs them, they should make a proposal (e.g. as a PR with some elaborate description), and justify the addition with some benchmarking numbers or some such. I don't think that should block fixing the soundness hole meanwhile.*\r\n\r\n> We can also leave the `-Zsaturating-float-casts` around (just changing the default) which means any nightly users can still opt out of the cange for a while.\r\n\r\nThis seems fine to me, but I would suggest renaming the flag to `-Zunsaturating-float-casts` to avoid changing semantics towards unsoundness for those who already use this flag.",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/557038601/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/557043852",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-557043852",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 557043852,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU1NzA0Mzg1Mg==",
    "user": {
      "login": "hanna-kruppe",
      "id": 2311707,
      "node_id": "MDQ6VXNlcjIzMTE3MDc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2311707?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hanna-kruppe",
      "html_url": "https://github.com/hanna-kruppe",
      "followers_url": "https://api.github.com/users/hanna-kruppe/followers",
      "following_url": "https://api.github.com/users/hanna-kruppe/following{/other_user}",
      "gists_url": "https://api.github.com/users/hanna-kruppe/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hanna-kruppe/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hanna-kruppe/subscriptions",
      "organizations_url": "https://api.github.com/users/hanna-kruppe/orgs",
      "repos_url": "https://api.github.com/users/hanna-kruppe/repos",
      "events_url": "https://api.github.com/users/hanna-kruppe/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hanna-kruppe/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2019-11-21T11:29:00Z",
    "updated_at": "2019-11-21T11:31:25Z",
    "body": "@Centril\r\n\r\n> Won't that single generic intrinsic requires separate implementations in the compiler for those 12/30 specific monomorphic instantiations?\r\n\r\nNo, most of the implementation can be and already is shared by parametrizing over the source and destination bit widths. Only a few bits need case distinctions. The same applies to the implementaton in miri and most likely also to other implementations and to specifications.\r\n\r\n(Edit: to be clear, this sharing can happen even if there's N distinct intrinsics, but a single generic intrinsic cuts down on the boilerplate required per-intrinsic.)\r\n\r\n> So I don't think we should add intrinsics on the off-chance someone needs them.\r\n\r\n> I am however not opposed to exposing more intrinsics, but if someone needs them, they should make a proposal (e.g. as a PR with some elaborate description), and justify the addition with some benchmarking numbers or some such. I don't think that should block fixing the soundness hole meanwhile.\r\n\r\nWe already have some benchmarking numbers. We know from the call for benchmarks long ago that [JPEG encoding gets significantly slower on x86_64](https://internals.rust-lang.org/t/help-us-benchmark-saturating-float-casts/6231/14) with saturating casts. Someone could re-run those but I feel confident predicting that this hasn't changed (although of course the specific numbers won't be identical) and see no reason why future changes to how saturation is implemented (like switching to inline asm or the LLVM intrinsics @nikic worked on) would fundamentally change that. While it's hard to be sure about the future, my educated guess is that the only plausible way to get that performance back is to use something that generates code without range checks, like an `unsafe` conversion or something using `freeze`.",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/557043852/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/557071185",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-557071185",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 557071185,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU1NzA3MTE4NQ==",
    "user": {
      "login": "Centril",
      "id": 855702,
      "node_id": "MDQ6VXNlcjg1NTcwMg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/855702?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Centril",
      "html_url": "https://github.com/Centril",
      "followers_url": "https://api.github.com/users/Centril/followers",
      "following_url": "https://api.github.com/users/Centril/following{/other_user}",
      "gists_url": "https://api.github.com/users/Centril/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Centril/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Centril/subscriptions",
      "organizations_url": "https://api.github.com/users/Centril/orgs",
      "repos_url": "https://api.github.com/users/Centril/repos",
      "events_url": "https://api.github.com/users/Centril/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Centril/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2019-11-21T12:51:53Z",
    "updated_at": "2019-11-21T12:51:53Z",
    "body": "OK so from the existing benchmarking numbers, it seems like there is an active desire for said intrinsics. If so, I would propose the following action plan:\r\n\r\n1. Concurrently:\r\n   - Introduce the intrinsics exposed on nightly through `#[unstable(...)]` functions.\r\n   - Remove `-Zsaturating-float-casts` and introduce `-Zunsaturating-float-casts`.\r\n   - Switch the default to what `-Zsaturating-float-casts` does.\r\n2. We stabilize the intrinsics after some time; we can fast-track a bit.\r\n3. Remove `-Zunsaturating-float-casts` after a while.",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/557071185/reactions",
      "total_count": 3,
      "+1": 3,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/557078205",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-557078205",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 557078205,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU1NzA3ODIwNQ==",
    "user": {
      "login": "SimonSapin",
      "id": 291359,
      "node_id": "MDQ6VXNlcjI5MTM1OQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/291359?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/SimonSapin",
      "html_url": "https://github.com/SimonSapin",
      "followers_url": "https://api.github.com/users/SimonSapin/followers",
      "following_url": "https://api.github.com/users/SimonSapin/following{/other_user}",
      "gists_url": "https://api.github.com/users/SimonSapin/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/SimonSapin/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/SimonSapin/subscriptions",
      "organizations_url": "https://api.github.com/users/SimonSapin/orgs",
      "repos_url": "https://api.github.com/users/SimonSapin/repos",
      "events_url": "https://api.github.com/users/SimonSapin/events{/privacy}",
      "received_events_url": "https://api.github.com/users/SimonSapin/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2019-11-21T13:11:49Z",
    "updated_at": "2019-11-21T13:14:24Z",
    "body": "Sounds good. Except that intrinsics are implementation details of some public API, probably methods on `f32` and `f64`. They could be either:\r\n\r\n* Methods of a generic trait (with a parameter for the conversion\u2019s integer return type), optionally in the prelude\r\n* Inherent methods with a supporting trait (similar to `str::parse` and `FromStr`) in order to support different return types\r\n* Multiple non-generic inherent methods with the target type in the name",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/557078205/reactions",
      "total_count": 2,
      "+1": 2,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/557118247",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-557118247",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 557118247,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU1NzExODI0Nw==",
    "user": {
      "login": "Centril",
      "id": 855702,
      "node_id": "MDQ6VXNlcjg1NTcwMg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/855702?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Centril",
      "html_url": "https://github.com/Centril",
      "followers_url": "https://api.github.com/users/Centril/followers",
      "following_url": "https://api.github.com/users/Centril/following{/other_user}",
      "gists_url": "https://api.github.com/users/Centril/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Centril/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Centril/subscriptions",
      "organizations_url": "https://api.github.com/users/Centril/orgs",
      "repos_url": "https://api.github.com/users/Centril/repos",
      "events_url": "https://api.github.com/users/Centril/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Centril/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2019-11-21T14:49:55Z",
    "updated_at": "2019-11-21T14:49:55Z",
    "body": "Yea, I meant exposing the intrinsics via methods or some such.\r\n\r\n> Multiple non-generic inherent methods with the target type in the name\r\n\r\nThis feels like the usual thing we do - any objections to this option?",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/557118247/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/557195927",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-557195927",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 557195927,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU1NzE5NTkyNw==",
    "user": {
      "login": "SimonSapin",
      "id": 291359,
      "node_id": "MDQ6VXNlcjI5MTM1OQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/291359?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/SimonSapin",
      "html_url": "https://github.com/SimonSapin",
      "followers_url": "https://api.github.com/users/SimonSapin/followers",
      "following_url": "https://api.github.com/users/SimonSapin/following{/other_user}",
      "gists_url": "https://api.github.com/users/SimonSapin/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/SimonSapin/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/SimonSapin/subscriptions",
      "organizations_url": "https://api.github.com/users/SimonSapin/orgs",
      "repos_url": "https://api.github.com/users/SimonSapin/repos",
      "events_url": "https://api.github.com/users/SimonSapin/events{/privacy}",
      "received_events_url": "https://api.github.com/users/SimonSapin/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2019-11-21T17:43:24Z",
    "updated_at": "2019-11-21T17:43:24Z",
    "body": "Is it though? I feel that when have the name of a type (of the signature) as part of the name of a method it\u2019s ad-hoc \u201cone of a kind\u201d conversions (like `Vec::as_slice` and `[T]::to_vec`), or a series of conversions where the difference is not a type (like `to_ne_bytes`, `to_be_bytes`, `to_le_bytes`). But part of the motivation for `std::convert`\u2019s traits was to avoid dozens of separate methods like `u8::to_u16`, `u8::to_u32`, `u8::to_u64`, etc.",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/557195927/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/557219953",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-557219953",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 557219953,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU1NzIxOTk1Mw==",
    "user": {
      "login": "Centril",
      "id": 855702,
      "node_id": "MDQ6VXNlcjg1NTcwMg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/855702?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Centril",
      "html_url": "https://github.com/Centril",
      "followers_url": "https://api.github.com/users/Centril/followers",
      "following_url": "https://api.github.com/users/Centril/following{/other_user}",
      "gists_url": "https://api.github.com/users/Centril/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Centril/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Centril/subscriptions",
      "organizations_url": "https://api.github.com/users/Centril/orgs",
      "repos_url": "https://api.github.com/users/Centril/repos",
      "events_url": "https://api.github.com/users/Centril/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Centril/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2019-11-21T18:45:54Z",
    "updated_at": "2019-11-21T18:45:54Z",
    "body": "My wonder is whether this would be naturally generalizable to a trait given that the methods need to be `unsafe fn`. If we do add inherent methods, then you can always delegate to those in trait implementations and whatnot.",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/557219953/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/557272544",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-557272544",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 557272544,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU1NzI3MjU0NA==",
    "user": {
      "login": "withoutboats",
      "id": 9063376,
      "node_id": "MDQ6VXNlcjkwNjMzNzY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/9063376?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/withoutboats",
      "html_url": "https://github.com/withoutboats",
      "followers_url": "https://api.github.com/users/withoutboats/followers",
      "following_url": "https://api.github.com/users/withoutboats/following{/other_user}",
      "gists_url": "https://api.github.com/users/withoutboats/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/withoutboats/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/withoutboats/subscriptions",
      "organizations_url": "https://api.github.com/users/withoutboats/orgs",
      "repos_url": "https://api.github.com/users/withoutboats/repos",
      "events_url": "https://api.github.com/users/withoutboats/events{/privacy}",
      "received_events_url": "https://api.github.com/users/withoutboats/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2019-11-21T21:08:21Z",
    "updated_at": "2019-11-21T21:08:21Z",
    "body": "It does seem odd to me to add traits for unsafe conversions, but I guess probably Simon is thinking about the fact that we'd possibly need a different method for each combination of floating point and integer type (e.g. `f32::to_u8_unsaturated`, `f32::to_u16_unsaturated`, etc).\r\n\r\nNot to weigh in on a long thread I haven't read in total ignorance, but is that desired or is it sufficient to have e.g. `f32::to_integer_unsaturated` which converts to `u32`or something? Is there an obvious choice for the target type for the unsafe conversion?",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/557272544/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/557292994",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-557292994",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 557292994,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU1NzI5Mjk5NA==",
    "user": {
      "login": "hanna-kruppe",
      "id": 2311707,
      "node_id": "MDQ6VXNlcjIzMTE3MDc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2311707?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hanna-kruppe",
      "html_url": "https://github.com/hanna-kruppe",
      "followers_url": "https://api.github.com/users/hanna-kruppe/followers",
      "following_url": "https://api.github.com/users/hanna-kruppe/following{/other_user}",
      "gists_url": "https://api.github.com/users/hanna-kruppe/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hanna-kruppe/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hanna-kruppe/subscriptions",
      "organizations_url": "https://api.github.com/users/hanna-kruppe/orgs",
      "repos_url": "https://api.github.com/users/hanna-kruppe/repos",
      "events_url": "https://api.github.com/users/hanna-kruppe/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hanna-kruppe/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2019-11-21T22:03:12Z",
    "updated_at": "2019-11-21T22:03:12Z",
    "body": "Providing unsafe conversions only to i32/u32 (for example) completely excludes all integer types whose value range isn't strictly smaller, and that's definitely sometimes needed. Going smaller (down to u8, as in JPEG encoding) is also often needed but can be emulated by converting to a wider integer type and truncating with `as` (which is cheap though not usually free).\r\n\r\nBut we can't very well only provide conversion to the largest integer size. Those are not always natively supported (hence, slow) and optimizations can't fix that: it's unsound to optimize \"convert to large int, then truncate\" into \"convert to smaller int directly\" because the latter has UB (in LLVM IR) / different results (on machine code level, on most architectures) in the cases where the original conversion result would have wrapped around when truncating.\r\n\r\nNote that even pragmatically excluding 128 bit integers and focusing on 64 bit integers will still be bad for common 32 bit targets.",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/557292994/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/559298292",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-559298292",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 559298292,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU1OTI5ODI5Mg==",
    "user": {
      "login": "admilazz",
      "id": 32494910,
      "node_id": "MDQ6VXNlcjMyNDk0OTEw",
      "avatar_url": "https://avatars.githubusercontent.com/u/32494910?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/admilazz",
      "html_url": "https://github.com/admilazz",
      "followers_url": "https://api.github.com/users/admilazz/followers",
      "following_url": "https://api.github.com/users/admilazz/following{/other_user}",
      "gists_url": "https://api.github.com/users/admilazz/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/admilazz/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/admilazz/subscriptions",
      "organizations_url": "https://api.github.com/users/admilazz/orgs",
      "repos_url": "https://api.github.com/users/admilazz/repos",
      "events_url": "https://api.github.com/users/admilazz/events{/privacy}",
      "received_events_url": "https://api.github.com/users/admilazz/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2019-11-28T00:45:40Z",
    "updated_at": "2019-11-28T03:04:23Z",
    "body": "I'm new to this conversation but not to programming. I'm curious as to why people think saturating conversions and converting NaN to zero are reasonable default behaviors. I understand that Java does this (although wrapping around seems much more common), but there is no integer value for which NaN can really be said to be a correct conversion. Similarly, converting 1000000.0 into 65535 (u16), for example, seems wrong. There is simply no u16 that's clearly the right answer. At least, I don't see it as being any better than the current behavior of converting it to 16960, which is at least a behavior shared with C/C++, C#, go, and others, and thus at least somewhat unsurprising.\r\n\r\nVarious people have commented on the similarity with overflow checking, and I agree with them. It's also similar to integer division by zero. I think invalid conversions should panic just like invalid arithmetic. Relying on NaN -> 0 and 1000000.0 -> 65535 (or 16960) seems just as error-prone as relying on integer overflow or a hypothetical n / 0 == 0. It's the kind of thing that should produce an error by default. (In release builds, rust can elide the error checking, just as it does with integer arithmetic.) And in the rare cases when you _want_ to convert NaN to zero or have floating point saturation, you should have to opt into it, just like you have to opt into integer overflow.\r\n\r\nAs for performance, it seems like the highest general performance would come from doing a plain conversion and relying on hardware faults. Both x86 and ARM, for example, raise hardware exceptions when a floating-point-to-integer conversion cannot be represented correctly (including both NaN and out-of-range cases). This solution is zero-cost except for invalid conversions, except when converting directly from floating-point to small integer types in debug builds - a rare case - where it should still be comparatively cheap. (On theoretical hardware that doesn't support these exceptions, then it can be emulated in software, but again only in debug builds.) I imagine that hardware exceptions are exactly how detecting integer division by zero is implemented today. I saw a lot of talk of LLVM, so maybe you're constrained here, but it'd be unfortunate to have software emulation in every floating point conversion even in release builds in order to provide dubious alternative behaviors for inherently invalid conversions.",
    "author_association": "NONE",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/559298292/reactions",
      "total_count": 2,
      "+1": 2,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/559358458",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-559358458",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 559358458,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU1OTM1ODQ1OA==",
    "user": {
      "login": "lambda-fairy",
      "id": 1572323,
      "node_id": "MDQ6VXNlcjE1NzIzMjM=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1572323?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/lambda-fairy",
      "html_url": "https://github.com/lambda-fairy",
      "followers_url": "https://api.github.com/users/lambda-fairy/followers",
      "following_url": "https://api.github.com/users/lambda-fairy/following{/other_user}",
      "gists_url": "https://api.github.com/users/lambda-fairy/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/lambda-fairy/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/lambda-fairy/subscriptions",
      "organizations_url": "https://api.github.com/users/lambda-fairy/orgs",
      "repos_url": "https://api.github.com/users/lambda-fairy/repos",
      "events_url": "https://api.github.com/users/lambda-fairy/events{/privacy}",
      "received_events_url": "https://api.github.com/users/lambda-fairy/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2019-11-28T06:20:38Z",
    "updated_at": "2019-11-28T06:20:38Z",
    "body": "@admilazz We are constrained by what LLVM can do, and currently LLVM does not expose a method to efficiently convert floats to integers without the risk of undefined behavior.\r\n\r\nThe saturation is because the language defines `as` casts to always succeed, and so we can't change the operator to panic instead.",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/559358458/reactions",
      "total_count": 2,
      "+1": 2,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/559400656",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-559400656",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 559400656,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU1OTQwMDY1Ng==",
    "user": {
      "login": "SimonSapin",
      "id": 291359,
      "node_id": "MDQ6VXNlcjI5MTM1OQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/291359?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/SimonSapin",
      "html_url": "https://github.com/SimonSapin",
      "followers_url": "https://api.github.com/users/SimonSapin/followers",
      "following_url": "https://api.github.com/users/SimonSapin/following{/other_user}",
      "gists_url": "https://api.github.com/users/SimonSapin/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/SimonSapin/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/SimonSapin/subscriptions",
      "organizations_url": "https://api.github.com/users/SimonSapin/orgs",
      "repos_url": "https://api.github.com/users/SimonSapin/repos",
      "events_url": "https://api.github.com/users/SimonSapin/events{/privacy}",
      "received_events_url": "https://api.github.com/users/SimonSapin/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2019-11-28T08:56:28Z",
    "updated_at": "2019-11-28T10:12:57Z",
    "body": "> Similarly, converting 1000000.0 into 65535 (u16), for example, seems wrong. There is simply no u16 that's clearly the right answer. At least, I don't see it as being any better than the current behavior of converting it to 16960,\r\n\r\nIt wasn\u2019t obvious to me so I think it\u2019s worth pointing out: 16960 is the result of converting 1000000.0 to a sufficently-wide integer, then truncating to keep the 16 lower bits.\r\n\r\nThis is ~not an option that has been suggested before in this thread, and it\u2019s~ (Edit: I was wrong here, sorry I didn\u2019t find it) not the current behavior either. The current behavior in Rust is that out-of-range float-to-integer conversion is Undefined Behavior. In practice this often leads to a garbage value, on principle it could cause miscompilations and vulnerabilities. This thread is all about fixing that. When I run the program below in Rust 1.39.0 I get a different value every time:\r\n\r\n```rust\r\nfn main() {\r\n    dbg!(1000000.0 as u16);\r\n}\r\n```\r\n\r\n[Playground](https://play.rust-lang.org/?version=stable&mode=debug&edition=2018&gist=6a9b193148533e42557a87f8d4d7fcc1). Example output:\r\n\r\n```\r\n[src/main.rs:2] 1000000.0 as u16 = 49072\r\n```\r\n\r\nI personally think integer-like truncation is no better or worse than saturation, they\u2019re both numerically wrong for out-of-range values. An infallible conversion has its place, as long as it\u2019s deterministic and not UB. You might already know from your algorithm that values are in range, or might not care about such cases.\r\n\r\nI think we should *also* add fallible conversion APIs that return a `Result`, but I still need to finish writing that draft pre-RFC :)",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/559400656/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/559426015",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-559426015",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 559426015,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU1OTQyNjAxNQ==",
    "user": {
      "login": "hanna-kruppe",
      "id": 2311707,
      "node_id": "MDQ6VXNlcjIzMTE3MDc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2311707?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hanna-kruppe",
      "html_url": "https://github.com/hanna-kruppe",
      "followers_url": "https://api.github.com/users/hanna-kruppe/followers",
      "following_url": "https://api.github.com/users/hanna-kruppe/following{/other_user}",
      "gists_url": "https://api.github.com/users/hanna-kruppe/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hanna-kruppe/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hanna-kruppe/subscriptions",
      "organizations_url": "https://api.github.com/users/hanna-kruppe/orgs",
      "repos_url": "https://api.github.com/users/hanna-kruppe/repos",
      "events_url": "https://api.github.com/users/hanna-kruppe/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hanna-kruppe/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2019-11-28T10:00:53Z",
    "updated_at": "2019-11-28T10:00:53Z",
    "body": "The \"convert to mathematical integer, then truncate to target width\" or \"wraparound\" semantics *have* been suggested before in this thread (https://github.com/rust-lang/rust/issues/10184#issuecomment-299229143). I don't particularly like it:\r\n\r\n- I think it's slightly less sensible than saturation. Saturation doesn't *generally* gives sensible results for numbers far out of range, but:\r\n  *  it behaves more sensibly than wraparound when numbers are *slightly* out of range (e.g. due to accumulated rounding error). In contrast, a cast that wraps around can amplify a mild rounding error in the float computation to the maximal possible error in the integer domain.\r\n  * it's somewhat commonly used in digital signal processing, so there are at least some applications where it is actually desired. In contrast, I do not know of a single algorithm that benefits from wraparound semantics.\r\n- AFAIK the only reason to *prefer* wraparound semantics is the efficency of software emulation, but this seems like an unproven assumption to me. I'd be happy to be proven wrong but at a cursory glance wraparound seem to require such a long chain of ALU instructions (plus branches to handle infinities and NaNs separately) that I don't feel like it's clear one will be clearly better for performance than the other.\r\n- While the question of what to do for `NaN` is an ugly problem for any conversion to integer, saturation at least does not require any special casing (neither in semantics nor in most implementations) for infinity. But for wraparound, what's the integer equivalent is +/- infinity supposed to be? JavaScript says it's 0, and I suppose if we made `as` panic on NaN then it could also panic on infinity, but either way this seems like it'll make wraparound harder to make fast than looking at normal and denormal numbers alone would suggest.",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/559426015/reactions",
      "total_count": 2,
      "+1": 2,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/559430257",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-559430257",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 559430257,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU1OTQzMDI1Nw==",
    "user": {
      "login": "lnicola",
      "id": 308347,
      "node_id": "MDQ6VXNlcjMwODM0Nw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/308347?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/lnicola",
      "html_url": "https://github.com/lnicola",
      "followers_url": "https://api.github.com/users/lnicola/followers",
      "following_url": "https://api.github.com/users/lnicola/following{/other_user}",
      "gists_url": "https://api.github.com/users/lnicola/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/lnicola/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/lnicola/subscriptions",
      "organizations_url": "https://api.github.com/users/lnicola/orgs",
      "repos_url": "https://api.github.com/users/lnicola/repos",
      "events_url": "https://api.github.com/users/lnicola/events{/privacy}",
      "received_events_url": "https://api.github.com/users/lnicola/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2019-11-28T10:12:01Z",
    "updated_at": "2019-11-28T10:12:01Z",
    "body": "I suspect that most of the code regressed by the saturation semantics for conversion would be better off using SIMD. So while unfortunate, this change won't prevent high-performance code from being written (especially if intrinsic with different semantics are provided), and might even nudge some projects towards a faster (if less portable) implementation.\r\n\r\nIf so, some slight performance regressions shouldn't be used as justification to avoid closing a soundness hole.",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/559430257/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/559522285",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-559522285",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 559522285,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU1OTUyMjI4NQ==",
    "user": {
      "login": "SimonSapin",
      "id": 291359,
      "node_id": "MDQ6VXNlcjI5MTM1OQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/291359?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/SimonSapin",
      "html_url": "https://github.com/SimonSapin",
      "followers_url": "https://api.github.com/users/SimonSapin/followers",
      "following_url": "https://api.github.com/users/SimonSapin/following{/other_user}",
      "gists_url": "https://api.github.com/users/SimonSapin/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/SimonSapin/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/SimonSapin/subscriptions",
      "organizations_url": "https://api.github.com/users/SimonSapin/orgs",
      "repos_url": "https://api.github.com/users/SimonSapin/repos",
      "events_url": "https://api.github.com/users/SimonSapin/events{/privacy}",
      "received_events_url": "https://api.github.com/users/SimonSapin/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2019-11-28T14:51:34Z",
    "updated_at": "2019-11-28T14:51:34Z",
    "body": "https://github.com/rust-lang/rust/pull/66841 adds `unsafe fn` methods that convert with LLVM\u2019s `fptoui` and `fptosi`, for those cases where values are known to be in range and saturating is a measurable performance regression.\r\n\r\nAfter that lands I think it\u2019s fine to switch the default for `as` (and perhaps add another `-Z` flag to opt out?), although that should probably be a formal Lang team decision.",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/559522285/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/559538629",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-559538629",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 559538629,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU1OTUzODYyOQ==",
    "user": {
      "login": "Centril",
      "id": 855702,
      "node_id": "MDQ6VXNlcjg1NTcwMg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/855702?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Centril",
      "html_url": "https://github.com/Centril",
      "followers_url": "https://api.github.com/users/Centril/followers",
      "following_url": "https://api.github.com/users/Centril/following{/other_user}",
      "gists_url": "https://api.github.com/users/Centril/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Centril/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Centril/subscriptions",
      "organizations_url": "https://api.github.com/users/Centril/orgs",
      "repos_url": "https://api.github.com/users/Centril/repos",
      "events_url": "https://api.github.com/users/Centril/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Centril/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2019-11-28T15:41:20Z",
    "updated_at": "2019-11-28T15:41:20Z",
    "body": "> After that lands I think it\u2019s fine to switch the default for `as` (and perhaps add another `-Z` flag to opt out?), although that should probably be a formal Lang team decision.\r\n\r\nSo we (language team, with the people that were there at least) discussed this in https://github.com/rust-lang/lang-team/blob/master/minutes/2019-11-21.md and we thought adding new intrinsics + adding `-Zunsaturated-float-casts` would be good first steps.\r\n\r\nI think it would be good to switch the default as part of that or shortly after, possibly with FCP if necessary.",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/559538629/reactions",
      "total_count": 2,
      "+1": 2,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/559541539",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-559541539",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 559541539,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU1OTU0MTUzOQ==",
    "user": {
      "login": "SimonSapin",
      "id": 291359,
      "node_id": "MDQ6VXNlcjI5MTM1OQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/291359?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/SimonSapin",
      "html_url": "https://github.com/SimonSapin",
      "followers_url": "https://api.github.com/users/SimonSapin/followers",
      "following_url": "https://api.github.com/users/SimonSapin/following{/other_user}",
      "gists_url": "https://api.github.com/users/SimonSapin/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/SimonSapin/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/SimonSapin/subscriptions",
      "organizations_url": "https://api.github.com/users/SimonSapin/orgs",
      "repos_url": "https://api.github.com/users/SimonSapin/repos",
      "events_url": "https://api.github.com/users/SimonSapin/events{/privacy}",
      "received_events_url": "https://api.github.com/users/SimonSapin/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2019-11-28T15:50:18Z",
    "updated_at": "2019-11-28T15:50:18Z",
    "body": "I assume that by new intrinsics you mean something like https://github.com/rust-lang/rust/pull/66841\r\n\r\nWhat does it mean to add `-Z unsaturated-float-casts` without changing the default? Accept it as no-op rather than emitting \"error: unknown debugging option\"?",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/559541539/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/559542352",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-559542352",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 559542352,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU1OTU0MjM1Mg==",
    "user": {
      "login": "Centril",
      "id": 855702,
      "node_id": "MDQ6VXNlcjg1NTcwMg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/855702?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Centril",
      "html_url": "https://github.com/Centril",
      "followers_url": "https://api.github.com/users/Centril/followers",
      "following_url": "https://api.github.com/users/Centril/following{/other_user}",
      "gists_url": "https://api.github.com/users/Centril/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Centril/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Centril/subscriptions",
      "organizations_url": "https://api.github.com/users/Centril/orgs",
      "repos_url": "https://api.github.com/users/Centril/repos",
      "events_url": "https://api.github.com/users/Centril/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Centril/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2019-11-28T15:52:52Z",
    "updated_at": "2019-11-28T15:52:52Z",
    "body": "> I assume that by new intrinsics you mean something like #66841\r\n\r\nYep \ud83d\udc4d -- thanks for spearheading that.\r\n\r\n> What does it mean to add `-Z unsaturated-float-casts` without changing the default? Accept it as no-op rather than emitting \"error: unknown debugging option\"?\r\n\r\nYeah basically. Alternatively, we remove `-Z saturated-float-casts` in favor of `-Z unsaturated-float-casts` and switch the default directly, but it should lead to the same result over fewer PRs.",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/559542352/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/559576870",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-559576870",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 559576870,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU1OTU3Njg3MA==",
    "user": {
      "login": "hanna-kruppe",
      "id": 2311707,
      "node_id": "MDQ6VXNlcjIzMTE3MDc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2311707?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hanna-kruppe",
      "html_url": "https://github.com/hanna-kruppe",
      "followers_url": "https://api.github.com/users/hanna-kruppe/followers",
      "following_url": "https://api.github.com/users/hanna-kruppe/following{/other_user}",
      "gists_url": "https://api.github.com/users/hanna-kruppe/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hanna-kruppe/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hanna-kruppe/subscriptions",
      "organizations_url": "https://api.github.com/users/hanna-kruppe/orgs",
      "repos_url": "https://api.github.com/users/hanna-kruppe/repos",
      "events_url": "https://api.github.com/users/hanna-kruppe/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hanna-kruppe/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2019-11-28T18:12:38Z",
    "updated_at": "2019-11-28T18:12:38Z",
    "body": "I really don't understand the \"unsaturated\" suggestion. If the goal is just to provide a knob to opt out of the new default, it's easier to just change the default of the existing flag and do nothing more. If the goal is to pick a new name that is more clear about the trade-off (unsoundness), then \"unsaturating\" is awful at that &mdash; I'd instead suggest a name that includes \"unsafe\" or \"UB\" or a similarly scary word, for example `-Z fix-float-cast-ub`.",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/559576870/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/559577634",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-559577634",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 559577634,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU1OTU3NzYzNA==",
    "user": {
      "login": "SimonSapin",
      "id": 291359,
      "node_id": "MDQ6VXNlcjI5MTM1OQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/291359?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/SimonSapin",
      "html_url": "https://github.com/SimonSapin",
      "followers_url": "https://api.github.com/users/SimonSapin/followers",
      "following_url": "https://api.github.com/users/SimonSapin/following{/other_user}",
      "gists_url": "https://api.github.com/users/SimonSapin/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/SimonSapin/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/SimonSapin/subscriptions",
      "organizations_url": "https://api.github.com/users/SimonSapin/orgs",
      "repos_url": "https://api.github.com/users/SimonSapin/repos",
      "events_url": "https://api.github.com/users/SimonSapin/events{/privacy}",
      "received_events_url": "https://api.github.com/users/SimonSapin/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2019-11-28T18:16:49Z",
    "updated_at": "2019-11-28T18:16:49Z",
    "body": "`unchecked` is the term with some precedent in API names.",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/559577634/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/559590250",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-559590250",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 559590250,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU1OTU5MDI1MA==",
    "user": {
      "login": "admilazz",
      "id": 32494910,
      "node_id": "MDQ6VXNlcjMyNDk0OTEw",
      "avatar_url": "https://avatars.githubusercontent.com/u/32494910?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/admilazz",
      "html_url": "https://github.com/admilazz",
      "followers_url": "https://api.github.com/users/admilazz/followers",
      "following_url": "https://api.github.com/users/admilazz/following{/other_user}",
      "gists_url": "https://api.github.com/users/admilazz/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/admilazz/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/admilazz/subscriptions",
      "organizations_url": "https://api.github.com/users/admilazz/orgs",
      "repos_url": "https://api.github.com/users/admilazz/repos",
      "events_url": "https://api.github.com/users/admilazz/events{/privacy}",
      "received_events_url": "https://api.github.com/users/admilazz/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2019-11-28T19:34:53Z",
    "updated_at": "2019-11-28T19:51:27Z",
    "body": "> @admilazz We are constrained by what LLVM can do, and currently LLVM does not expose a method to efficiently convert floats to integers without the risk of undefined behavior.\r\n\r\nBut presumably you can add runtime checks only in debug builds, as you do for integer overflow.\r\n\r\n> AFAIK the only reason to prefer wraparound semantics is the efficency of software emulation\r\n\r\nI don't think we should prefer either wraparound or saturation, since both are wrong, but wraparound at least has the benefit of being the method used by many languages similar to rust: C/C++, C#, go, probably D, and surely more, and of also being rust's current behavior (at least sometimes). That said, I think \"panic on invalid conversions (possibly in debug builds only)\" is ideal, just like we do for integer overflow and invalid arithmetic like division by zero.\r\n\r\n(Interestingly, I did get 16960 in the [playground](https://play.rust-lang.org/?version=stable&mode=debug&edition=2018&gist=244aee080af6cc6e548d95f7c1d114f3). But I see from other examples posted that sometimes rust does it differently...)\r\n\r\n> The saturation is because the language defines as casts to always succeed, and so we can't change the operator to panic instead.\r\n\r\nChanging what the operation evaluates to is already a breaking change, insofar as we care about the results of people already doing this. This no-panic behavior could change too.\r\n\r\n> I suppose if we made as panic on NaN then it could also panic on infinity, but either way this seems like it'll make wraparound harder to make fast\r\n\r\nIf it's only checked in debug builds, as integer overflow is, then I think we can get the best of both worlds: conversions are guaranteed to be correct (in debug builds), user errors are more likely to be caught, you can opt in to weird behaviors like wraparound and/or saturation if you like, and performance is as good as it can be.\r\n\r\nAlso, it seems strange to control this stuff via a command-line switch. That's a big hammer. Surely the desired behavior of an out-of-range conversion depends on the specifics of the algorithm, so it's something that should be controlled on a per-conversion basis. I'd suggest f.to_u16_sat() and f.to_u16_wrap() or similar as the opt-ins, and not having any command-line option that changes the semantics of code. That would make it hard to mix and match different pieces of code, and you can't understand what something does by reading it...\r\n\r\nAnd, if it's truly unacceptable to make \"panic if invalid\" the default behavior, it would be nice to have an intrinsic method that implements it but only performs the validity check in debug builds so we can ensure our conversions are correct in the (vast majority of?) cases when we expect to get the same number after the conversion, but without paying any penalty in release builds.",
    "author_association": "NONE",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/559590250/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/559594720",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-559594720",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 559594720,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU1OTU5NDcyMA==",
    "user": {
      "login": "SimonSapin",
      "id": 291359,
      "node_id": "MDQ6VXNlcjI5MTM1OQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/291359?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/SimonSapin",
      "html_url": "https://github.com/SimonSapin",
      "followers_url": "https://api.github.com/users/SimonSapin/followers",
      "following_url": "https://api.github.com/users/SimonSapin/following{/other_user}",
      "gists_url": "https://api.github.com/users/SimonSapin/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/SimonSapin/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/SimonSapin/subscriptions",
      "organizations_url": "https://api.github.com/users/SimonSapin/orgs",
      "repos_url": "https://api.github.com/users/SimonSapin/repos",
      "events_url": "https://api.github.com/users/SimonSapin/events{/privacy}",
      "received_events_url": "https://api.github.com/users/SimonSapin/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2019-11-28T20:05:19Z",
    "updated_at": "2019-11-28T20:05:19Z",
    "body": "> Interestingly, I did get 16960 in the playground. \r\n\r\nThis is how Undefined Behavior works: depending on the exact formulation of the program and the exact compiler version and the exact compilation flags, you might get deterministic behavior, or a garbage value that changes on every run, or miscompilations. The compiler is allowed to do anything.\r\n\r\n> wraparound at least has the benefit of being the method used by many languages similar to rust: C/C++, C#, go, probably D, and surely more,\r\n\r\nDoes it really? At least not in C and C++, they have the same Undefined Behavior as Rust. This is not a coincidence, we use LLVM which is primarily built for clang implementing C and C++. Are you sure about C# and go?\r\n\r\nC11 standard https://port70.net/~nsz/c/c11/n1570.html#6.3.1.4\r\n>  When a finite value of real floating type is converted to an integer type other than _Bool, the fractional part is discarded (i.e., the value is truncated toward zero). If the value of the integral part cannot be represented by the integer type, the behavior is undefined.\r\n\r\n> The remaindering operation performed when a value of integer type is converted to unsigned type need not be performed when a value of real floating type is converted to unsigned type. Thus, the range of portable real floating values is (-1, Utype_MAX+1). \r\n\r\nC++17 standard http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2017/n4659.pdf#section.7.10\r\n> A prvalue of a floating-point type can be converted to a prvalue of an integer type. The conversion truncates;that is, the fractional part is discarded. The behavior is undefined if the truncated value cannot be represented in the destination type. ",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/559594720/reactions",
      "total_count": 2,
      "+1": 2,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/559602432",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-559602432",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 559602432,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU1OTYwMjQzMg==",
    "user": {
      "login": "Amanieu",
      "id": 278509,
      "node_id": "MDQ6VXNlcjI3ODUwOQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/278509?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Amanieu",
      "html_url": "https://github.com/Amanieu",
      "followers_url": "https://api.github.com/users/Amanieu/followers",
      "following_url": "https://api.github.com/users/Amanieu/following{/other_user}",
      "gists_url": "https://api.github.com/users/Amanieu/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Amanieu/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Amanieu/subscriptions",
      "organizations_url": "https://api.github.com/users/Amanieu/orgs",
      "repos_url": "https://api.github.com/users/Amanieu/repos",
      "events_url": "https://api.github.com/users/Amanieu/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Amanieu/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2019-11-28T21:02:27Z",
    "updated_at": "2019-11-28T21:02:27Z",
    "body": "C# reference https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/builtin-types/numeric-conversions\r\n> When you convert a double or float value to an integral type, this value is rounded towards zero to the nearest integral value. If the resulting integral value is outside the range of the destination type, the result depends on the overflow checking context. In a checked context, an OverflowException is thrown, while in an unchecked context, the result is an unspecified value of the destination type.\r\n\r\nSo it's not UB, just an \"unspecified value\".",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/559602432/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/559622763",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-559622763",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 559622763,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU1OTYyMjc2Mw==",
    "user": {
      "login": "Pauan",
      "id": 97238,
      "node_id": "MDQ6VXNlcjk3MjM4",
      "avatar_url": "https://avatars.githubusercontent.com/u/97238?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Pauan",
      "html_url": "https://github.com/Pauan",
      "followers_url": "https://api.github.com/users/Pauan/followers",
      "following_url": "https://api.github.com/users/Pauan/following{/other_user}",
      "gists_url": "https://api.github.com/users/Pauan/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Pauan/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Pauan/subscriptions",
      "organizations_url": "https://api.github.com/users/Pauan/orgs",
      "repos_url": "https://api.github.com/users/Pauan/repos",
      "events_url": "https://api.github.com/users/Pauan/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Pauan/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2019-11-29T00:13:30Z",
    "updated_at": "2019-11-29T00:13:30Z",
    "body": "@admilazz There's a huge difference between this and integer overflow: integer overflow is *undesirable* but *well defined*. Floating point casts are *undefined behavior*.\r\n\r\nWhat you are asking for is similar to turning off `Vec` bounds checking in release mode, but that would be wrong because that would allow for undefined behavior.\r\n\r\nAllowing undefined behavior in safe code is not acceptable, even if it only happens in release mode. So any fix must apply to both release and debug mode.\r\n\r\nOf course it's possible to have a *more restrictive* fix in debug mode, but the fix for release mode must still be well defined.",
    "author_association": "NONE",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/559622763/reactions",
      "total_count": 2,
      "+1": 2,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/559670477",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-559670477",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 559670477,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU1OTY3MDQ3Nw==",
    "user": {
      "login": "admilazz",
      "id": 32494910,
      "node_id": "MDQ6VXNlcjMyNDk0OTEw",
      "avatar_url": "https://avatars.githubusercontent.com/u/32494910?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/admilazz",
      "html_url": "https://github.com/admilazz",
      "followers_url": "https://api.github.com/users/admilazz/followers",
      "following_url": "https://api.github.com/users/admilazz/following{/other_user}",
      "gists_url": "https://api.github.com/users/admilazz/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/admilazz/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/admilazz/subscriptions",
      "organizations_url": "https://api.github.com/users/admilazz/orgs",
      "repos_url": "https://api.github.com/users/admilazz/repos",
      "events_url": "https://api.github.com/users/admilazz/events{/privacy}",
      "received_events_url": "https://api.github.com/users/admilazz/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2019-11-29T06:06:36Z",
    "updated_at": "2019-11-29T06:14:37Z",
    "body": "> @admilazz There's a huge difference between this and integer overflow: integer overflow is undesirable but well defined. Floating point casts are undefined behavior.\r\n\r\nSure, but this thread is about defining the behavior. If it was defined as producing \"an unspecified value of the destination type\", as in the C# spec that Amanieu helpfully referenced above, then it would no longer be undefined (in any dangerous way). You can't easily make use of the well-defined nature of integer overflow in practical programs because it will still panic in debug builds. Similarly, the value produced by an invalid cast in release builds needn't be predictable or particularly useful because programs couldn't practically make use of it anyway if it panicked in debug builds. This actually gives maximum scope to the compiler for optimizations, whereas picking a behavior like saturation constrains the compiler and could be significantly slower on hardware without native saturating conversion instructions. (And it's not like saturation is clearly correct.)\r\n\r\n> What you are asking for is similar to turning off Vec bounds checking in release mode, but that would be wrong because that would allow for undefined behavior. Allowing undefined behavior in safe code is not acceptable...\r\n\r\nNot all undefined behavior is alike. Undefined behavior just means it's up to the compiler implementer to decide what happens. As long as there is no way to violate rust's safety guarantees by casting a float to an int, then I don't think it's similar to allowing people to write to arbitrary memory locations. Nonetheless, of course I agree that it should be defined in the sense of being guaranteed safe even if not necessarily predictable.\r\n\r\n> Does it really? At least not in C and C++, they have the same Undefined Behavior as Rust... Are you sure about C# and go?\r\n\r\nFair enough. I did not read all their specs; I just tested various compilers. You're right that saying \"all the compilers I tried do it this way\" is different from saying \"the language specifications define it to be this way\". But I'm not arguing in favor of overflow anyway, only pointing out that it seems to be the most common. I'm really arguing in favor of having a conversion that 1) protects against \"wrong\" results like 1000000.0 becoming 65535 or 16960 for the same reason that we protect against integer overflow - it's most likely a bug so users should have to opt into it, and 2) allows maximum performance in release builds.",
    "author_association": "NONE",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/559670477/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/559671944",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-559671944",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 559671944,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU1OTY3MTk0NA==",
    "user": {
      "login": "ssokolow",
      "id": 46915,
      "node_id": "MDQ6VXNlcjQ2OTE1",
      "avatar_url": "https://avatars.githubusercontent.com/u/46915?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ssokolow",
      "html_url": "https://github.com/ssokolow",
      "followers_url": "https://api.github.com/users/ssokolow/followers",
      "following_url": "https://api.github.com/users/ssokolow/following{/other_user}",
      "gists_url": "https://api.github.com/users/ssokolow/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ssokolow/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ssokolow/subscriptions",
      "organizations_url": "https://api.github.com/users/ssokolow/orgs",
      "repos_url": "https://api.github.com/users/ssokolow/repos",
      "events_url": "https://api.github.com/users/ssokolow/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ssokolow/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2019-11-29T06:14:03Z",
    "updated_at": "2019-11-29T06:18:23Z",
    "body": "> Not all undefined behavior is alike. Undefined behavior just means it's up to the compiler implementer to decide what happens. As long as there is no way to violate rust's safety guarantees by casting a float to an int, then I don't think it's similar to allowing people to write to arbitrary memory locations. Nonetheless, of course I agree that it should be defined: defined, but not necessarily predictable.\r\n\r\nUndefined behaviour means the optimizers (which are provided by LLVM developers focused on C and C++) are free to assume it can never happen and transform the code based on that assumption, including deleting chunks of code which are only reachable by passing through the undefined cast or, as [this example](https://gcc.godbolt.org/z/0ubnbS) shows, assuming that an assignment must have been called, even though it actually wasn't, because invoking code that *is* called without first calling it would be undefined behaviour.\r\n\r\nEven if it *were* reasonable to prove that composing the different optimization passes doesn't produce dangerous emergent behaviours, the LLVM developers won't make any conscious effort to preserve that.\r\n\r\nI'd argue that all undefined behaviour *is* alike on that basis.",
    "author_association": "NONE",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/559671944/reactions",
      "total_count": 2,
      "+1": 2,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/559675007",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-559675007",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 559675007,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU1OTY3NTAwNw==",
    "user": {
      "login": "admilazz",
      "id": 32494910,
      "node_id": "MDQ6VXNlcjMyNDk0OTEw",
      "avatar_url": "https://avatars.githubusercontent.com/u/32494910?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/admilazz",
      "html_url": "https://github.com/admilazz",
      "followers_url": "https://api.github.com/users/admilazz/followers",
      "following_url": "https://api.github.com/users/admilazz/following{/other_user}",
      "gists_url": "https://api.github.com/users/admilazz/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/admilazz/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/admilazz/subscriptions",
      "organizations_url": "https://api.github.com/users/admilazz/orgs",
      "repos_url": "https://api.github.com/users/admilazz/repos",
      "events_url": "https://api.github.com/users/admilazz/events{/privacy}",
      "received_events_url": "https://api.github.com/users/admilazz/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2019-11-29T06:29:26Z",
    "updated_at": "2019-11-29T06:34:57Z",
    "body": "> Even if it were reasonable to prove that composing the different optimization passes doesn't produce dangerous emergent behaviours, the LLVM developers won't make any conscious effort to preserve that.\r\n\r\nWell, it's unfortunate that LLVM impinges on rust's design in this way, but I did just read some of the LLVM instruction reference and it mentions the \"freeze\" operation mentioned above (\"... another is to wait for LLVM to add a freeze concept \u2026\") which would prevent undefined behavior at the LLVM level. Is rust tied to an old version of LLVM? If not, we could use it. Their documentation is unclear about the exact behavior, though.\r\n\r\n> If the argument is undef or poison, \u2018freeze\u2019 returns an arbitrary, but fixed, value of type \u2018ty\u2019. Otherwise, this instruction is a no-op and returns the input argument. All uses of a value returned by the same \u2018freeze\u2019 instruction are guaranteed to always observe the same value, while different \u2018freeze\u2019 instructions may yield different values.\r\n\r\nI don't know what they mean by \"fixed value\" or \"the same 'freeze' instruction\". I think ideally it would compile to a no-op and give an unpredictable integer, but it sounds like it might possibly do something expensive. Has anyone tried this freeze operation?",
    "author_association": "NONE",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/559675007/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/559676343",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-559676343",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 559676343,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU1OTY3NjM0Mw==",
    "user": {
      "login": "ssokolow",
      "id": 46915,
      "node_id": "MDQ6VXNlcjQ2OTE1",
      "avatar_url": "https://avatars.githubusercontent.com/u/46915?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ssokolow",
      "html_url": "https://github.com/ssokolow",
      "followers_url": "https://api.github.com/users/ssokolow/followers",
      "following_url": "https://api.github.com/users/ssokolow/following{/other_user}",
      "gists_url": "https://api.github.com/users/ssokolow/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ssokolow/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ssokolow/subscriptions",
      "organizations_url": "https://api.github.com/users/ssokolow/orgs",
      "repos_url": "https://api.github.com/users/ssokolow/repos",
      "events_url": "https://api.github.com/users/ssokolow/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ssokolow/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2019-11-29T06:35:58Z",
    "updated_at": "2019-11-29T06:35:58Z",
    "body": "> Well, it's unfortunate that LLVM impinges on rust's design in this way\r\n\r\nIt's not just that LLVM developers write the optimizers. It's that, even if the rustc developers wrote the optimizers, flirting with undefinedness is inherently a huge footgun because of the emergent properties of chaining up optimizers. The human brain simply didn't evolve to \"intuit the potential magnitude of the rounding error\" when the rounding in question is emergent behaviour built up by chaining optimization passes.",
    "author_association": "NONE",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/559676343/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/559676983",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-559676983",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 559676983,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU1OTY3Njk4Mw==",
    "user": {
      "login": "admilazz",
      "id": 32494910,
      "node_id": "MDQ6VXNlcjMyNDk0OTEw",
      "avatar_url": "https://avatars.githubusercontent.com/u/32494910?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/admilazz",
      "html_url": "https://github.com/admilazz",
      "followers_url": "https://api.github.com/users/admilazz/followers",
      "following_url": "https://api.github.com/users/admilazz/following{/other_user}",
      "gists_url": "https://api.github.com/users/admilazz/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/admilazz/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/admilazz/subscriptions",
      "organizations_url": "https://api.github.com/users/admilazz/orgs",
      "repos_url": "https://api.github.com/users/admilazz/repos",
      "events_url": "https://api.github.com/users/admilazz/events{/privacy}",
      "received_events_url": "https://api.github.com/users/admilazz/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2019-11-29T06:39:08Z",
    "updated_at": "2019-11-29T06:39:08Z",
    "body": "I'm not gonna disagree with you there. :-)  I do hope this LLVM \"freeze\" instruction provides a zero-cost way to avoid this undefined behavior.",
    "author_association": "NONE",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/559676983/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/559705611",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-559705611",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 559705611,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU1OTcwNTYxMQ==",
    "user": {
      "login": "RalfJung",
      "id": 330628,
      "node_id": "MDQ6VXNlcjMzMDYyOA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/330628?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/RalfJung",
      "html_url": "https://github.com/RalfJung",
      "followers_url": "https://api.github.com/users/RalfJung/followers",
      "following_url": "https://api.github.com/users/RalfJung/following{/other_user}",
      "gists_url": "https://api.github.com/users/RalfJung/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/RalfJung/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/RalfJung/subscriptions",
      "organizations_url": "https://api.github.com/users/RalfJung/orgs",
      "repos_url": "https://api.github.com/users/RalfJung/repos",
      "events_url": "https://api.github.com/users/RalfJung/events{/privacy}",
      "received_events_url": "https://api.github.com/users/RalfJung/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2019-11-29T08:34:16Z",
    "updated_at": "2019-11-29T08:34:16Z",
    "body": "That was discussed above and the conclusion was that while casting-then-freezing is *defined* behavior, it is not at all *reasonable* behavior. In release mode, such casts would return arbitrary results for out-of-bound inputs (in entirely safe code). That's not a good semantics for something as innocent-looking as `as`.\r\n\r\nIMO such a semantics would be bad language design that we would rather avoid.",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/559705611/reactions",
      "total_count": 4,
      "+1": 4,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/559792152",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-559792152",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 559792152,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU1OTc5MjE1Mg==",
    "user": {
      "login": "SimonSapin",
      "id": 291359,
      "node_id": "MDQ6VXNlcjI5MTM1OQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/291359?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/SimonSapin",
      "html_url": "https://github.com/SimonSapin",
      "followers_url": "https://api.github.com/users/SimonSapin/followers",
      "following_url": "https://api.github.com/users/SimonSapin/following{/other_user}",
      "gists_url": "https://api.github.com/users/SimonSapin/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/SimonSapin/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/SimonSapin/subscriptions",
      "organizations_url": "https://api.github.com/users/SimonSapin/orgs",
      "repos_url": "https://api.github.com/users/SimonSapin/repos",
      "events_url": "https://api.github.com/users/SimonSapin/events{/privacy}",
      "received_events_url": "https://api.github.com/users/SimonSapin/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2019-11-29T13:36:07Z",
    "updated_at": "2019-11-29T13:36:07Z",
    "body": "> My position is that `as` is best avoided entirely regardless of this issue, because it can have wildly different semantics (truncating, saturating, rounding, \u2026) depending on the input and output type, and those are not always obvious when reading code. (Even the latter can be inferred with `foo as _`.) So I have a draft pre-RFC for proposing various explicitly-named conversion methods that cover the cases that `as` does today (and maybe more).\r\n\r\nI finished that draft! https://internals.rust-lang.org/t/pre-rfc-add-explicitly-named-numeric-conversion-apis/11395\r\n\r\nAny feedback is very welcome, but please give it in the internals threads rather than here.",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/559792152/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/559851818",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-559851818",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 559851818,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU1OTg1MTgxOA==",
    "user": {
      "login": "admilazz",
      "id": 32494910,
      "node_id": "MDQ6VXNlcjMyNDk0OTEw",
      "avatar_url": "https://avatars.githubusercontent.com/u/32494910?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/admilazz",
      "html_url": "https://github.com/admilazz",
      "followers_url": "https://api.github.com/users/admilazz/followers",
      "following_url": "https://api.github.com/users/admilazz/following{/other_user}",
      "gists_url": "https://api.github.com/users/admilazz/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/admilazz/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/admilazz/subscriptions",
      "organizations_url": "https://api.github.com/users/admilazz/orgs",
      "repos_url": "https://api.github.com/users/admilazz/repos",
      "events_url": "https://api.github.com/users/admilazz/events{/privacy}",
      "received_events_url": "https://api.github.com/users/admilazz/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2019-11-29T17:33:26Z",
    "updated_at": "2019-11-29T17:33:26Z",
    "body": "> In release mode, such casts would return arbitrary results for out-of-bound inputs (in entirely safe code). That's not a good semantics for something as innocent-looking as as.\r\n\r\nSorry to repeat myself, but I think this same argument applies to integer overflow. If you multiply some numbers and the result overflows, you're going to get a wildly wrong result that will almost certainly invalidate the calculation you were trying to perform, but it panics in debug builds and therefore the bug is likely to be caught. I would say that a numeric conversion that gives wildly wrong results should also panic because there's a very high chance it represents a bug in the user's code. (The case of typical floating-point inaccuracy is already handled. If a calculation produces 65535.3 it's already valid to convert that to u16. To get an out-of-bounds conversion you usually need a bug in your code, and if I have a bug I want to be notified so I can fix it.)\r\n\r\nThe ability for release builds to give arbitrary but defined results for invalid conversions also allows maximum performance, which is important, in my opinion, for something as fundamental as numeric conversions. Always saturating has a significant performance impact, hides bugs, and rarely makes a calculation that unexpectedly encounters it give the right result.",
    "author_association": "NONE",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/559851818/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/559855013",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-559855013",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 559855013,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU1OTg1NTAxMw==",
    "user": {
      "login": "RalfJung",
      "id": 330628,
      "node_id": "MDQ6VXNlcjMzMDYyOA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/330628?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/RalfJung",
      "html_url": "https://github.com/RalfJung",
      "followers_url": "https://api.github.com/users/RalfJung/followers",
      "following_url": "https://api.github.com/users/RalfJung/following{/other_user}",
      "gists_url": "https://api.github.com/users/RalfJung/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/RalfJung/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/RalfJung/subscriptions",
      "organizations_url": "https://api.github.com/users/RalfJung/orgs",
      "repos_url": "https://api.github.com/users/RalfJung/repos",
      "events_url": "https://api.github.com/users/RalfJung/events{/privacy}",
      "received_events_url": "https://api.github.com/users/RalfJung/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2019-11-29T17:52:06Z",
    "updated_at": "2019-11-29T17:53:13Z",
    "body": "> Sorry to repeat myself, but I think this same argument applies to integer overflow. If you multiply some numbers and the result overflows, you're going to get a wildly wrong result that will almost certainly invalidate the calculation you were trying to perform\r\n\r\nWe are not talking about multiplication though, we are talking about casts. And yes, the same applies to integer overflow: int-to-int casts never panic, even when they overflow. This is because `as`, by design, never panics, not even in debug builds. Deviating from this for floating point casts is surprising at best and dangerous at worst, as the correctness and safety on unsafe code can depend on certain operations not panicking.\r\n\r\nIf you want to argue that the design of `as` is flawed because it provides infallible conversion between types where proper conversion is not always possible, I think most of us will agree. But that is entirely out of scope for this thread, which is about fixing float-to-int conversions *inside the existing framework of `as` casts*. These have to be infallible, they must not panic, not even in debug builds. So please either propose some *reasonable* (not involving `freeze`), *non-panicking* semantics for float-to-int casts, or else try to start a new discussion about re-designing `as` to permit panicking when the cast is lossy (and do so consistently for int-to-int and float-to-int casts) -- but the latter is off-topic in this issue, so please open a new thread (pre-RFC-style) for that.",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/559855013/reactions",
      "total_count": 4,
      "+1": 4,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/559865392",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-559865392",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 559865392,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU1OTg2NTM5Mg==",
    "user": {
      "login": "retep998",
      "id": 666308,
      "node_id": "MDQ6VXNlcjY2NjMwOA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/666308?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/retep998",
      "html_url": "https://github.com/retep998",
      "followers_url": "https://api.github.com/users/retep998/followers",
      "following_url": "https://api.github.com/users/retep998/following{/other_user}",
      "gists_url": "https://api.github.com/users/retep998/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/retep998/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/retep998/subscriptions",
      "organizations_url": "https://api.github.com/users/retep998/orgs",
      "repos_url": "https://api.github.com/users/retep998/repos",
      "events_url": "https://api.github.com/users/retep998/events{/privacy}",
      "received_events_url": "https://api.github.com/users/retep998/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2019-11-29T19:03:05Z",
    "updated_at": "2019-11-29T19:03:05Z",
    "body": "How about we start by just implementing `freeze` semantics *now* to fix the UB, and then we can have all the time in the world to agree on what semantics we actually want since any semantics we choose will be backwards compatible with `freeze` semantics.",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/559865392/reactions",
      "total_count": 3,
      "+1": 3,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/559976686",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-559976686",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 559976686,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU1OTk3NjY4Ng==",
    "user": {
      "login": "hanna-kruppe",
      "id": 2311707,
      "node_id": "MDQ6VXNlcjIzMTE3MDc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2311707?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hanna-kruppe",
      "html_url": "https://github.com/hanna-kruppe",
      "followers_url": "https://api.github.com/users/hanna-kruppe/followers",
      "following_url": "https://api.github.com/users/hanna-kruppe/following{/other_user}",
      "gists_url": "https://api.github.com/users/hanna-kruppe/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hanna-kruppe/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hanna-kruppe/subscriptions",
      "organizations_url": "https://api.github.com/users/hanna-kruppe/orgs",
      "repos_url": "https://api.github.com/users/hanna-kruppe/repos",
      "events_url": "https://api.github.com/users/hanna-kruppe/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hanna-kruppe/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2019-11-30T14:42:40Z",
    "updated_at": "2019-11-30T14:42:40Z",
    "body": "> How about we start by just implementing `freeze` semantics _now_ to fix the UB, and then we can have all the time in the world to agree on what semantics we actually want since any semantics we choose will be backwards compatible with `freeze` semantics.\r\n\r\n1. Panicking is not backwards compatible with freezing, so we'd need to reject at least all proposals that involve panicking. Moving from UB to panicking is less obviously incompatible, though as discussed above there are some other reasons to not make `as` panic.\r\n2. [As I wrote before](https://github.com/rust-lang/rust/issues/10184#issuecomment-557022386), \r\n    > we support several older versions (back to LLVM 6 at the moment) and we'd need some fallback implementation for those to actually get rid of the UB for all users.\r\n\r\n---\r\n\r\nI agree with @RalfJung that making only some `as` casts panicking is highly undesirable, but that aside I don't think this point @admilazz made is obviously correct:\r\n\r\n> (The case of typical floating-point inaccuracy is already handled. If a calculation produces 65535.3 it's already valid to convert that to u16. To get an out-of-bounds conversion you usually need a bug in your code, and if I have a bug I want to be notified so I can fix it.)\r\n\r\nFor f32->u16 it may be true that you need extraordinarily large rounding error to drop out of the u16 range just from rounding error, but for conversions from f32 to 32 bit integers that is not so obviously true. `i32::MAX` is not representable exactly in f32, the closest representable number is *47* off from `i32::MAX`. So if you have a calculation that should mathematically result in a number up to `i32::MAX`, any error >= 1 ULP away from zero will put you out of bounds. And it gets much worse once we consider lower precision floats (IEEE 754 binary16, or the non-standard bfloat16).",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/559976686/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/561308499",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-561308499",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 561308499,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU2MTMwODQ5OQ==",
    "user": {
      "login": "admilazz",
      "id": 32494910,
      "node_id": "MDQ6VXNlcjMyNDk0OTEw",
      "avatar_url": "https://avatars.githubusercontent.com/u/32494910?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/admilazz",
      "html_url": "https://github.com/admilazz",
      "followers_url": "https://api.github.com/users/admilazz/followers",
      "following_url": "https://api.github.com/users/admilazz/following{/other_user}",
      "gists_url": "https://api.github.com/users/admilazz/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/admilazz/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/admilazz/subscriptions",
      "organizations_url": "https://api.github.com/users/admilazz/orgs",
      "repos_url": "https://api.github.com/users/admilazz/repos",
      "events_url": "https://api.github.com/users/admilazz/events{/privacy}",
      "received_events_url": "https://api.github.com/users/admilazz/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2019-12-03T18:59:55Z",
    "updated_at": "2019-12-03T19:32:17Z",
    "body": "> We are not talking about multiplication though, we are talking about casts\r\n\r\nWell, floating-point to integer conversions are used almost exclusively in the same context as multiplication: numerical calculations, and I do think there's a useful parallel with the behavior of integer overflow.\r\n\r\n> And yes, the same applies to integer overflow: int-to-int casts never panic, even when they overflow... Deviating from this for floating point casts is surprising at best and dangerous at worst, as the correctness and safety on unsafe code can depend on certain operations not panicking.\r\n\r\nI would argue that the inconsistency here is justified by common practice and wouldn't be so surprising. Truncating and chopping up integers with shifts, masks, and casts - effectively using casts as a form of bitwise AND plus a size change - is very common and has a long history in systems programming. It's something I do several times a week at least. But over the past 30+ years, I can't recall ever expecting to get a reasonable result out of converting NaN, Infinity, or an out-of-range floating-point value to integer. (Every instance of that I can recall has been a bug in the calculation that produced the value.) So I don't think the case of integer -> integer casts and floating-point -> integer casts must be treated identically. That said, I can understand that some decisions have already been set in stone.\r\n\r\n> please \u2026 propose some reasonable (not involving freeze), non-panicking semantics for float-to-int casts\r\n\r\nWell, my proposal is:\r\n\r\n1. Don't use global compilation switches that effect significant changes to semantics. (I assume -Zsaturating-float-casts is a command-line parameter or similar.) Code that depends on saturation behavior, say, would be broken if compiled without it. Presumably code with different expectations couldn't be mixed together in the same project. There should be some local way for a calculation to specify the desired semantics, probably something like [this pre-RFC](https://internals.rust-lang.org/t/pre-rfc-add-explicitly-named-numeric-conversion-apis/11395).\r\n2. Make `as` casts have maximum performance by default, as would be expected from a cast.\r\n    * I think this should be done via freeze on LLVM versions that support it and any other conversion semantics on LLVM versions that don't (e.g. truncation, saturation, etc). I expect the 'freeze could leak values from sensitive memory' claim is purely hypothetical. (Or, if `y = freeze(fptosi(x))` merely leaves `y` unchanged, thus leaking uninitialized memory, that could be fixed by clearing `y` first.)\r\n    * If `as` will be relatively slow by default (e.g. because it saturates), provide some way to obtain maximum performance (e.g. a method - unsafe if necessary - that uses freeze).",
    "author_association": "NONE",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/561308499/reactions",
      "total_count": 1,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 1,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/561329036",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-561329036",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 561329036,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU2MTMyOTAzNg==",
    "user": {
      "login": "hanna-kruppe",
      "id": 2311707,
      "node_id": "MDQ6VXNlcjIzMTE3MDc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2311707?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hanna-kruppe",
      "html_url": "https://github.com/hanna-kruppe",
      "followers_url": "https://api.github.com/users/hanna-kruppe/followers",
      "following_url": "https://api.github.com/users/hanna-kruppe/following{/other_user}",
      "gists_url": "https://api.github.com/users/hanna-kruppe/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hanna-kruppe/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hanna-kruppe/subscriptions",
      "organizations_url": "https://api.github.com/users/hanna-kruppe/orgs",
      "repos_url": "https://api.github.com/users/hanna-kruppe/repos",
      "events_url": "https://api.github.com/users/hanna-kruppe/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hanna-kruppe/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2019-12-03T19:51:59Z",
    "updated_at": "2019-12-03T19:51:59Z",
    "body": "> 1. Don't use global compilation switches that effect significant changes to semantics. (I assume -Zsaturating-float-casts is a command-line parameter or similar.)\r\n\r\nTo be clear, I don't think anyone disagrees. This flag was only ever proposed as a short-term tool to more easily measure and work around performance regressions while libraries are getting updated to fix those regressions.",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/561329036/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/561341815",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-561341815",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 561341815,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU2MTM0MTgxNQ==",
    "user": {
      "login": "admilazz",
      "id": 32494910,
      "node_id": "MDQ6VXNlcjMyNDk0OTEw",
      "avatar_url": "https://avatars.githubusercontent.com/u/32494910?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/admilazz",
      "html_url": "https://github.com/admilazz",
      "followers_url": "https://api.github.com/users/admilazz/followers",
      "following_url": "https://api.github.com/users/admilazz/following{/other_user}",
      "gists_url": "https://api.github.com/users/admilazz/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/admilazz/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/admilazz/subscriptions",
      "organizations_url": "https://api.github.com/users/admilazz/orgs",
      "repos_url": "https://api.github.com/users/admilazz/repos",
      "events_url": "https://api.github.com/users/admilazz/events{/privacy}",
      "received_events_url": "https://api.github.com/users/admilazz/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2019-12-03T20:25:09Z",
    "updated_at": "2019-12-03T20:34:11Z",
    "body": "> For f32->u16 it may be true that you need extraordinarily large rounding error to drop out of the u16 range just from rounding error, but for conversions from f32 to 32 bit integers that is not so obviously true. i32::MAX is not representable exactly in f32, the closest representable number is 47 off from i32::MAX. So if you have a calculation that should mathematically result in a number up to i32::MAX, any error >= 1 ULP away from zero will put you out of bounds\r\n\r\nThis is getting a bit off-topic, but let's say you have this hypothetical algorithm that's supposed to mathematically produce f32s up to 2^31-1 (but should _not_ produce 2^31 or higher, except possibly due to rounding error). It seems to be flawed already.\r\n1. I think the closest representable i32 is actually 127 below i32::MAX, so even in a perfect world with no floating-point imprecision the algorithm which you expect to be producing values up to 2^31-1 can in fact only produce (legal) values up to 2^31-128. Perhaps that's a bug already. I'm not sure it makes sense to talk about error measured from 2^31-1 when that number is not possible to represent. You'd have to be off by 64 from the nearest representable number (considering rounding) to get out of bounds. Granted, that's not much percentage-wise when you're near 2^32.\r\n2. You shouldn't expect discrimination of values that are 1 apart (i.e. 2^31-1 but not 2^31) when the closest representable values are 128 apart. Furthermore, only 3.5% of i32s are representable as f32 (and <2% of u32s). You can't get that kind of range while also having that kind of precision with an f32. The algorithm sounds like it's using the wrong tool for the job.\r\n\r\nI suppose any practical algorithm that does what you describe will be intimately tied to integers somehow. For example, if you convert a random i32 to f32 and back, it can fail if it's above i32::MAX-64. But that degrades your precision badly and I don't know why you'd do such a thing. Pretty much any i32 -> f32 -> i32 calculation that outputs the full i32 range can be expressed faster and more accurately with integer math, and if not there's f64.\r\n\r\nAnyway, while I'm sure it's possible to find some cases where algorithms that perform out-of-bounds conversions would be fixed by saturation, I think they're rare - rare enough that we shouldn't slow down _all_ conversions to accommodate them. And, I'd argue that such algorithms are probably still flawed and should be fixed. And if an algorithm can't be fixed, it can always do a bounds check before the possibly-out-of-bounds conversion (or call a saturating conversion function). That way the expense of bounding the result is paid only where needed.\r\n\r\nP.S. Belated happy Thanksgiving to everyone.",
    "author_association": "NONE",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/561341815/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/561353315",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-561353315",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 561353315,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU2MTM1MzMxNQ==",
    "user": {
      "login": "admilazz",
      "id": 32494910,
      "node_id": "MDQ6VXNlcjMyNDk0OTEw",
      "avatar_url": "https://avatars.githubusercontent.com/u/32494910?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/admilazz",
      "html_url": "https://github.com/admilazz",
      "followers_url": "https://api.github.com/users/admilazz/followers",
      "following_url": "https://api.github.com/users/admilazz/following{/other_user}",
      "gists_url": "https://api.github.com/users/admilazz/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/admilazz/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/admilazz/subscriptions",
      "organizations_url": "https://api.github.com/users/admilazz/orgs",
      "repos_url": "https://api.github.com/users/admilazz/repos",
      "events_url": "https://api.github.com/users/admilazz/events{/privacy}",
      "received_events_url": "https://api.github.com/users/admilazz/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2019-12-03T20:56:39Z",
    "updated_at": "2019-12-03T20:56:39Z",
    "body": "> To be clear, I don't think anyone disagrees. This flag was only ever proposed as a short-term tool...\r\n\r\nI was primarily referring to the proposal to replace -Zsaturated-float-casts with -Zunsaturated-float-casts. Even if saturation becomes the default, flags like -Zunsaturated-float-casts seem bad for compatibility, but if it's also intended to be temporary, then okay, never mind. :-)\r\n\r\nAnyway, I'm sure everyone hopes I've said enough on this issue - myself included. I know the Rust team has traditionally sought to provide multiple ways to do things so people can make their own choices between performance and safety. I've shared my perspective and trust that you guys will come up with a good solution in the end. Take care!",
    "author_association": "NONE",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/561353315/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/561361011",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-561361011",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 561361011,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU2MTM2MTAxMQ==",
    "user": {
      "login": "SimonSapin",
      "id": 291359,
      "node_id": "MDQ6VXNlcjI5MTM1OQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/291359?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/SimonSapin",
      "html_url": "https://github.com/SimonSapin",
      "followers_url": "https://api.github.com/users/SimonSapin/followers",
      "following_url": "https://api.github.com/users/SimonSapin/following{/other_user}",
      "gists_url": "https://api.github.com/users/SimonSapin/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/SimonSapin/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/SimonSapin/subscriptions",
      "organizations_url": "https://api.github.com/users/SimonSapin/orgs",
      "repos_url": "https://api.github.com/users/SimonSapin/repos",
      "events_url": "https://api.github.com/users/SimonSapin/events{/privacy}",
      "received_events_url": "https://api.github.com/users/SimonSapin/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2019-12-03T21:17:33Z",
    "updated_at": "2019-12-03T21:17:33Z",
    "body": "I assumed that `-Zunsaturated-float-casts` would only exist temporarily, and would be removed at some point. That it\u2019s a `-Z` option (only available on Nightly) rather than `-C` suggests it, at least.",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/561361011/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/561415415",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-561415415",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 561415415,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU2MTQxNTQxNQ==",
    "user": {
      "login": "comex",
      "id": 47517,
      "node_id": "MDQ6VXNlcjQ3NTE3",
      "avatar_url": "https://avatars.githubusercontent.com/u/47517?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/comex",
      "html_url": "https://github.com/comex",
      "followers_url": "https://api.github.com/users/comex/followers",
      "following_url": "https://api.github.com/users/comex/following{/other_user}",
      "gists_url": "https://api.github.com/users/comex/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/comex/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/comex/subscriptions",
      "organizations_url": "https://api.github.com/users/comex/orgs",
      "repos_url": "https://api.github.com/users/comex/repos",
      "events_url": "https://api.github.com/users/comex/events{/privacy}",
      "received_events_url": "https://api.github.com/users/comex/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2019-12-04T00:12:00Z",
    "updated_at": "2019-12-04T00:12:00Z",
    "body": "For what it's worth, saturation and UB are not the only choices.  Another possibility is to change LLVM to add a variant of `fptosi` that uses the CPU's native overflow behavior \u2013 i.e. the behavior on overflow wouldn't be portable across architectures, but it would be well-defined on any given architecture (e.g. returning 0x80000000 on x86), and it would never return poison or uninitialized memory.  Even if the default becomes saturating, it would be nice to have that as an option.  After all, whereas saturating casts have inherent overhead on architectures where they're not the default behavior, \"do what the CPU does\" only has overhead if it inhibits some specific compiler optimization.  I'm not sure, but I suspect that any optimizations enabled by treating float-to-int overflow as UB are niche and not applicable to most code.\r\n\r\nThat said, one issue might be if an architecture has multiple float-to-int instructions that return different values on overflow.  In this case, the compiler choosing one or the other would affect observable behavior, which isn't a problem by itself, but might become one if a single `fptosi` is duplicated and the two copies end up behaving differently.  But I'm not sure whether this kind of divergence actually exists on any popular architectures.  And the same issue applies to other floating-point optimizations, including [floating-point contraction](https://github.com/rust-lang/rfcs/pull/2686)...",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/561415415/reactions",
      "total_count": 2,
      "+1": 2,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/561561144",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-561561144",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 561561144,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU2MTU2MTE0NA==",
    "user": {
      "login": "kennytm",
      "id": 103023,
      "node_id": "MDQ6VXNlcjEwMzAyMw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/103023?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/kennytm",
      "html_url": "https://github.com/kennytm",
      "followers_url": "https://api.github.com/users/kennytm/followers",
      "following_url": "https://api.github.com/users/kennytm/following{/other_user}",
      "gists_url": "https://api.github.com/users/kennytm/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/kennytm/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kennytm/subscriptions",
      "organizations_url": "https://api.github.com/users/kennytm/orgs",
      "repos_url": "https://api.github.com/users/kennytm/repos",
      "events_url": "https://api.github.com/users/kennytm/events{/privacy}",
      "received_events_url": "https://api.github.com/users/kennytm/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2019-12-04T09:48:45Z",
    "updated_at": "2019-12-04T09:48:45Z",
    "body": "`const fn` (miri) has already chosen the saturated-cast behavior since Rust 1.26 though (assuming we want CTFE and RTFE result to be consistent) (before 1.26 the overflowing compile-time cast returns 0)\r\n\r\n```rust\r\nconst fn g(a: f32) -> i32 {\r\n    a as i32\r\n}\r\n\r\nconst Q: i32 = g(1e+12);\r\n\r\nfn main() {\r\n    println!(\"{}\", Q); // always 2147483647\r\n    println!(\"{}\", g(1e+12)); // unspecified value, but always 2147483647 in miri\r\n}\r\n```\r\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/561561144/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/561566413",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-561566413",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 561566413,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU2MTU2NjQxMw==",
    "user": {
      "login": "RalfJung",
      "id": 330628,
      "node_id": "MDQ6VXNlcjMzMDYyOA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/330628?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/RalfJung",
      "html_url": "https://github.com/RalfJung",
      "followers_url": "https://api.github.com/users/RalfJung/followers",
      "following_url": "https://api.github.com/users/RalfJung/following{/other_user}",
      "gists_url": "https://api.github.com/users/RalfJung/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/RalfJung/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/RalfJung/subscriptions",
      "organizations_url": "https://api.github.com/users/RalfJung/orgs",
      "repos_url": "https://api.github.com/users/RalfJung/repos",
      "events_url": "https://api.github.com/users/RalfJung/events{/privacy}",
      "received_events_url": "https://api.github.com/users/RalfJung/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2019-12-04T10:02:14Z",
    "updated_at": "2019-12-04T10:02:47Z",
    "body": "Miri/CTFE uses apfloat's [`to_u128`/`to_i128` methods](https://doc.rust-lang.org/nightly/nightly-rustc/rustc_apfloat/trait.Float.html#method.to_i128) to do the conversion. But I am not sure if this is a stable guarantee -- given in particular that it seems to have changed before (which we were not aware of when implementing that stuff in Miri).\r\n\r\nI think we could adjust this to whatever codegen ends up picking. But the fact that LLVM's apfloat (of which the Rust version is a direct port) uses saturation is a good indicator that this is some kind of \"reasonable default\".",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/561566413/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/561575469",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-561575469",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 561575469,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU2MTU3NTQ2OQ==",
    "user": {
      "login": "dns2utf8",
      "id": 739070,
      "node_id": "MDQ6VXNlcjczOTA3MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/739070?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dns2utf8",
      "html_url": "https://github.com/dns2utf8",
      "followers_url": "https://api.github.com/users/dns2utf8/followers",
      "following_url": "https://api.github.com/users/dns2utf8/following{/other_user}",
      "gists_url": "https://api.github.com/users/dns2utf8/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dns2utf8/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dns2utf8/subscriptions",
      "organizations_url": "https://api.github.com/users/dns2utf8/orgs",
      "repos_url": "https://api.github.com/users/dns2utf8/repos",
      "events_url": "https://api.github.com/users/dns2utf8/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dns2utf8/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2019-12-04T10:25:09Z",
    "updated_at": "2019-12-04T10:25:09Z",
    "body": "One solution to the observable behavior could be to randomly choose one of the available methods at build time of the compiler or the resulting binary.\r\nThen have functions like `a.saturating_cast::<i32>()` for users that require a specific behavior.",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/561575469/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/561585167",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-561585167",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 561585167,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU2MTU4NTE2Nw==",
    "user": {
      "login": "ssokolow",
      "id": 46915,
      "node_id": "MDQ6VXNlcjQ2OTE1",
      "avatar_url": "https://avatars.githubusercontent.com/u/46915?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ssokolow",
      "html_url": "https://github.com/ssokolow",
      "followers_url": "https://api.github.com/users/ssokolow/followers",
      "following_url": "https://api.github.com/users/ssokolow/following{/other_user}",
      "gists_url": "https://api.github.com/users/ssokolow/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ssokolow/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ssokolow/subscriptions",
      "organizations_url": "https://api.github.com/users/ssokolow/orgs",
      "repos_url": "https://api.github.com/users/ssokolow/repos",
      "events_url": "https://api.github.com/users/ssokolow/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ssokolow/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2019-12-04T10:42:44Z",
    "updated_at": "2019-12-04T10:42:44Z",
    "body": "@dns2utf8 \r\n\r\nThe word \"randomly\" would run counter to the effort to get reproducible builds and, if it's predictable within a compiler version, you know *someone* will decide depend on it not changing.",
    "author_association": "NONE",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/561585167/reactions",
      "total_count": 3,
      "+1": 3,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/561824303",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-561824303",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 561824303,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU2MTgyNDMwMw==",
    "user": {
      "login": "hanna-kruppe",
      "id": 2311707,
      "node_id": "MDQ6VXNlcjIzMTE3MDc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2311707?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hanna-kruppe",
      "html_url": "https://github.com/hanna-kruppe",
      "followers_url": "https://api.github.com/users/hanna-kruppe/followers",
      "following_url": "https://api.github.com/users/hanna-kruppe/following{/other_user}",
      "gists_url": "https://api.github.com/users/hanna-kruppe/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hanna-kruppe/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hanna-kruppe/subscriptions",
      "organizations_url": "https://api.github.com/users/hanna-kruppe/orgs",
      "repos_url": "https://api.github.com/users/hanna-kruppe/repos",
      "events_url": "https://api.github.com/users/hanna-kruppe/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hanna-kruppe/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2019-12-04T20:26:22Z",
    "updated_at": "2019-12-04T20:26:22Z",
    "body": "IMO what @comex described (not novel to this thread IIRC, everything old is new again) this is the next best option if we don't want saturation. Note that we don't even need any LLVM changes to test that out, we can use inline asm (on architectures where such instructions exist).\r\n\r\n> That said, one issue might be if an architecture has multiple float-to-int instructions that return different values on overflow. In this case, the compiler choosing one or the other would affect observable behavior, which isn't a problem by itself, but might become one if a single `fptosi` is duplicated and the two copies end up behaving differently.\r\n\r\nIMO such non-determinism would give up almost all practical advantages compared to `freeze`. If we do this, we should pick one instruction per architecture and stick to it, both for determinism and so that programs can actually rely on the behavior of the instruction when it makes sense for them. If this is not possible on some architecture, then we could fall back to a software implementation (but as you say this is entirely hypothetical).\r\n\r\nThis is easiest if we don't delegate this decision to LLVM but implement the operation with inline asm instead. Which incidentially would also be much easier than changing LLVM to add new intrinsics and lowering for them in every backend.",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/561824303/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/561830169",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-561830169",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 561830169,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU2MTgzMDE2OQ==",
    "user": {
      "login": "aykevl",
      "id": 729697,
      "node_id": "MDQ6VXNlcjcyOTY5Nw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/729697?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/aykevl",
      "html_url": "https://github.com/aykevl",
      "followers_url": "https://api.github.com/users/aykevl/followers",
      "following_url": "https://api.github.com/users/aykevl/following{/other_user}",
      "gists_url": "https://api.github.com/users/aykevl/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/aykevl/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/aykevl/subscriptions",
      "organizations_url": "https://api.github.com/users/aykevl/orgs",
      "repos_url": "https://api.github.com/users/aykevl/repos",
      "events_url": "https://api.github.com/users/aykevl/events{/privacy}",
      "received_events_url": "https://api.github.com/users/aykevl/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2019-12-04T20:42:21Z",
    "updated_at": "2019-12-04T20:42:21Z",
    "body": "@rkruppe \r\n\r\n> [...] Which incidentially would also be much easier than changing LLVM to add new intrinsics and lowering for them in every backend.\r\n\r\nAdditionally, LLVM isn't exactly happy about intrinsics with target-dependent semantics:\r\n\r\n> However, if you want the casts to be well defined, then you should define their behavior. \"Do some fast thing\" is not really a definition, and I don't believe that we should give target-independent constructs target-dependent behavior.\r\n\r\nhttps://groups.google.com/forum/m/#!msg/llvm-dev/cgDFaBmCnDQ/CZAIMj4IBAA",
    "author_association": "NONE",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/561830169/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/562153346",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-562153346",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 562153346,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU2MjE1MzM0Ng==",
    "user": {
      "login": "pnkfelix",
      "id": 173127,
      "node_id": "MDQ6VXNlcjE3MzEyNw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/173127?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/pnkfelix",
      "html_url": "https://github.com/pnkfelix",
      "followers_url": "https://api.github.com/users/pnkfelix/followers",
      "following_url": "https://api.github.com/users/pnkfelix/following{/other_user}",
      "gists_url": "https://api.github.com/users/pnkfelix/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/pnkfelix/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/pnkfelix/subscriptions",
      "organizations_url": "https://api.github.com/users/pnkfelix/orgs",
      "repos_url": "https://api.github.com/users/pnkfelix/repos",
      "events_url": "https://api.github.com/users/pnkfelix/events{/privacy}",
      "received_events_url": "https://api.github.com/users/pnkfelix/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2019-12-05T14:30:56Z",
    "updated_at": "2019-12-05T14:30:56Z",
    "body": "I'm going retag  #10184 as solely T-lang: I think the issues to be resolved there are semantic choices about what `float as int` *means*\r\n\r\n(i.e. whether we are willing to let it have a panicking semantics or not, whether we are willing to let it have a `freeze`-based underspecification or not, etc)\r\n\r\nthese are questions better aimed at the T-lang team, not T-compiler, at least for the initial discussion, IMO",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/562153346/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/565585034",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-565585034",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 565585034,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU2NTU4NTAzNA==",
    "user": {
      "login": "agalakhov",
      "id": 1681335,
      "node_id": "MDQ6VXNlcjE2ODEzMzU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1681335?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/agalakhov",
      "html_url": "https://github.com/agalakhov",
      "followers_url": "https://api.github.com/users/agalakhov/followers",
      "following_url": "https://api.github.com/users/agalakhov/following{/other_user}",
      "gists_url": "https://api.github.com/users/agalakhov/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/agalakhov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/agalakhov/subscriptions",
      "organizations_url": "https://api.github.com/users/agalakhov/orgs",
      "repos_url": "https://api.github.com/users/agalakhov/repos",
      "events_url": "https://api.github.com/users/agalakhov/events{/privacy}",
      "received_events_url": "https://api.github.com/users/agalakhov/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2019-12-13T19:52:04Z",
    "updated_at": "2019-12-13T19:52:04Z",
    "body": "Just ran into this issue producing results that are _irreproducible between runs_ even without recompiling. The `as` operator seems to fetch some garbage from memory in such cases.\r\n\r\nI suggest just to completely disallow using `as` for \"float as int\" and rely on specific rounding methods instead. Reasoning: `as` is not lossy for other types.",
    "author_association": "NONE",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/565585034/reactions",
      "total_count": 3,
      "+1": 2,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 1,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/565587215",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-565587215",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 565587215,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU2NTU4NzIxNQ==",
    "user": {
      "login": "daniel-abramov",
      "id": 2765698,
      "node_id": "MDQ6VXNlcjI3NjU2OTg=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2765698?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/daniel-abramov",
      "html_url": "https://github.com/daniel-abramov",
      "followers_url": "https://api.github.com/users/daniel-abramov/followers",
      "following_url": "https://api.github.com/users/daniel-abramov/following{/other_user}",
      "gists_url": "https://api.github.com/users/daniel-abramov/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/daniel-abramov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/daniel-abramov/subscriptions",
      "organizations_url": "https://api.github.com/users/daniel-abramov/orgs",
      "repos_url": "https://api.github.com/users/daniel-abramov/repos",
      "events_url": "https://api.github.com/users/daniel-abramov/events{/privacy}",
      "received_events_url": "https://api.github.com/users/daniel-abramov/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2019-12-13T19:58:42Z",
    "updated_at": "2019-12-13T19:58:42Z",
    "body": "> Reasoning: as is not lossy for other types.\r\n\r\nIs it?\r\n\r\nBased on [Rust Book](https://doc.rust-lang.org/1.30.0/book/first-edition/casting-between-types.html) I may assume that it's lossless only in certain cases (namely in cases where the `From<X>` is defined for a type Y), i.e. you can cast `u8` to `u32` using `From`, but not the other way around.",
    "author_association": "NONE",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/565587215/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/565592408",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-565592408",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 565592408,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU2NTU5MjQwOA==",
    "user": {
      "login": "agalakhov",
      "id": 1681335,
      "node_id": "MDQ6VXNlcjE2ODEzMzU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1681335?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/agalakhov",
      "html_url": "https://github.com/agalakhov",
      "followers_url": "https://api.github.com/users/agalakhov/followers",
      "following_url": "https://api.github.com/users/agalakhov/following{/other_user}",
      "gists_url": "https://api.github.com/users/agalakhov/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/agalakhov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/agalakhov/subscriptions",
      "organizations_url": "https://api.github.com/users/agalakhov/orgs",
      "repos_url": "https://api.github.com/users/agalakhov/repos",
      "events_url": "https://api.github.com/users/agalakhov/events{/privacy}",
      "received_events_url": "https://api.github.com/users/agalakhov/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2019-12-13T20:13:44Z",
    "updated_at": "2019-12-13T20:30:53Z",
    "body": "By \"not lossy\" I mean casting of values that are small enough to fit. Example: `1_u64 as u8` is not lossy, thus `u8 as u64 as u8` is not lossy. For floats there is no simple definition of \"fits\" since `20000000000000000000000000000_u128 as f32` is not lossy while `20000001_u32  as f32` is, so neither `float as int` nor `int as float` are lossless.",
    "author_association": "NONE",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/565592408/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/565611132",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-565611132",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 565611132,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU2NTYxMTEzMg==",
    "user": {
      "login": "RalfJung",
      "id": 330628,
      "node_id": "MDQ6VXNlcjMzMDYyOA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/330628?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/RalfJung",
      "html_url": "https://github.com/RalfJung",
      "followers_url": "https://api.github.com/users/RalfJung/followers",
      "following_url": "https://api.github.com/users/RalfJung/following{/other_user}",
      "gists_url": "https://api.github.com/users/RalfJung/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/RalfJung/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/RalfJung/subscriptions",
      "organizations_url": "https://api.github.com/users/RalfJung/orgs",
      "repos_url": "https://api.github.com/users/RalfJung/repos",
      "events_url": "https://api.github.com/users/RalfJung/events{/privacy}",
      "received_events_url": "https://api.github.com/users/RalfJung/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2019-12-13T21:15:39Z",
    "updated_at": "2019-12-13T21:15:39Z",
    "body": "`256u64 as u8` is lossy though.",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/565611132/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/565617265",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-565617265",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 565617265,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU2NTYxNzI2NQ==",
    "user": {
      "login": "agalakhov",
      "id": 1681335,
      "node_id": "MDQ6VXNlcjE2ODEzMzU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1681335?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/agalakhov",
      "html_url": "https://github.com/agalakhov",
      "followers_url": "https://api.github.com/users/agalakhov/followers",
      "following_url": "https://api.github.com/users/agalakhov/following{/other_user}",
      "gists_url": "https://api.github.com/users/agalakhov/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/agalakhov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/agalakhov/subscriptions",
      "organizations_url": "https://api.github.com/users/agalakhov/orgs",
      "repos_url": "https://api.github.com/users/agalakhov/repos",
      "events_url": "https://api.github.com/users/agalakhov/events{/privacy}",
      "received_events_url": "https://api.github.com/users/agalakhov/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2019-12-13T21:36:25Z",
    "updated_at": "2019-12-13T21:36:25Z",
    "body": "But `<anything>_u8 as u64 as u8` is not. ",
    "author_association": "NONE",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/565617265/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/565666608",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-565666608",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 565666608,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU2NTY2NjYwOA==",
    "user": {
      "login": "admilazz",
      "id": 32494910,
      "node_id": "MDQ6VXNlcjMyNDk0OTEw",
      "avatar_url": "https://avatars.githubusercontent.com/u/32494910?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/admilazz",
      "html_url": "https://github.com/admilazz",
      "followers_url": "https://api.github.com/users/admilazz/followers",
      "following_url": "https://api.github.com/users/admilazz/following{/other_user}",
      "gists_url": "https://api.github.com/users/admilazz/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/admilazz/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/admilazz/subscriptions",
      "organizations_url": "https://api.github.com/users/admilazz/orgs",
      "repos_url": "https://api.github.com/users/admilazz/repos",
      "events_url": "https://api.github.com/users/admilazz/events{/privacy}",
      "received_events_url": "https://api.github.com/users/admilazz/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2019-12-14T01:22:46Z",
    "updated_at": "2019-12-14T01:27:01Z",
    "body": "I think lossiness is normal and expected with casts, and not a problem. Truncating integers with casts (e.g. `u32 as u8`) is a common operation with a well-understood meaning that's consistent across all C-like languages that I'm aware of (at least on architectures that use two's complement integer representations, which is basically all of them these days). Valid floating-point conversions (i.e. where the integral part fits in the destination) also have well-understood and agreed-upon semantics. `1.6 as u32` is lossy, but all C-like languages that I know of agree that the result should be 1. Both of those cases flow out of the consensus among hardware manufacturers on how those conversions should work and the convention in C-like languages that casts should be high-performance, \"I know what I'm doing\" kinds of operators.\r\n\r\nSo I don't think we should consider those problematic in the same way that invalid floating-point conversions are, since those don't have any agreed-upon semantics in C-like languages or in hardware (but they typically result in error states or hardware exceptions) and almost always indicate bugs (in my experience) and are therefore usually nonexistent in correct code.\r\n\r\n> Just ran into this issue producing results that are irreproducible between runs even without recompiling. The `as` operator seems to fetch some garbage from memory in such cases.\r\n\r\nPersonally I think that's fine as long as it only happens when the conversion is invalid and it doesn't have any side effects besides producing a garbage value. If you really need an otherwise invalid conversion in a piece of code you can handle the invalid case yourself with whatever semantics you think it should have.",
    "author_association": "NONE",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/565666608/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/565671572",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-565671572",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 565671572,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU2NTY3MTU3Mg==",
    "user": {
      "login": "agalakhov",
      "id": 1681335,
      "node_id": "MDQ6VXNlcjE2ODEzMzU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1681335?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/agalakhov",
      "html_url": "https://github.com/agalakhov",
      "followers_url": "https://api.github.com/users/agalakhov/followers",
      "following_url": "https://api.github.com/users/agalakhov/following{/other_user}",
      "gists_url": "https://api.github.com/users/agalakhov/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/agalakhov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/agalakhov/subscriptions",
      "organizations_url": "https://api.github.com/users/agalakhov/orgs",
      "repos_url": "https://api.github.com/users/agalakhov/repos",
      "events_url": "https://api.github.com/users/agalakhov/events{/privacy}",
      "received_events_url": "https://api.github.com/users/agalakhov/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2019-12-14T02:13:24Z",
    "updated_at": "2019-12-14T02:34:25Z",
    "body": "> and it doesn't have any side effects besides producing a garbage value\r\n\r\nThe side effect is, garbage value originates somewhere in memory and reveals some (possibly sensitive) data. Returning \"random\" value computed solely from float itself would be fine, but the current behaviour is not.\r\n\r\n> Valid floating-point conversions (i.e. where the integral part fits in the destination) also have well-understood and agreed-upon semantics.\r\n\r\nAre there any use cases of float-to-int conversions not accompanied by explicit `trunc()`, `round()`, `floor()` or `ceil()`? The current rounding strategy of `as` is \"undefined\", making `as` barely usable for non-rounded numbers. I believe that in most cases the one who writes `x as u32` actually wants `x.round() as u32`.\r\n\r\n> I think lossiness is normal and expected with casts, and not a problem. \r\n\r\nI agree, but only if lossiness is easily predictable. For integers, the conditions of lossy conversion are obvious. For floats they are obscure. They are lossless for some very big numbers but lossy for some smaller ones, even if they are round. My personal preference is having two different operators for lossy and lossless conversions to avoid introducing lossy conversion by mistake, but I'm also fine with only one operator provided that I can tell if it is lossy or not.",
    "author_association": "NONE",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/565671572/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/565676885",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-565676885",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 565676885,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU2NTY3Njg4NQ==",
    "user": {
      "login": "admilazz",
      "id": 32494910,
      "node_id": "MDQ6VXNlcjMyNDk0OTEw",
      "avatar_url": "https://avatars.githubusercontent.com/u/32494910?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/admilazz",
      "html_url": "https://github.com/admilazz",
      "followers_url": "https://api.github.com/users/admilazz/followers",
      "following_url": "https://api.github.com/users/admilazz/following{/other_user}",
      "gists_url": "https://api.github.com/users/admilazz/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/admilazz/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/admilazz/subscriptions",
      "organizations_url": "https://api.github.com/users/admilazz/orgs",
      "repos_url": "https://api.github.com/users/admilazz/repos",
      "events_url": "https://api.github.com/users/admilazz/events{/privacy}",
      "received_events_url": "https://api.github.com/users/admilazz/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2019-12-14T03:18:38Z",
    "updated_at": "2019-12-14T03:18:38Z",
    "body": "> The side effect is, garbage value originates somewhere in memory and reveals some (possibly sensitive) data.\r\n\r\nI would expect it to just leave the destination unchanged or whatever, but if that's really a problem it could be zeroed first.\r\n\r\n> Are there any use cases of float-to-int conversions not accompanied by explicit trunc(), round(), floor() or ceil()? The current rounding strategy of `as` is \"undefined\", making as barely usable for non-rounded numbers.\r\n\r\nIf the rounding strategy is really undefined then that'd be a surprise to me, and I'd agree that the operator is barely useful unless you're giving it an integer already. I'd expect it to truncate toward zero.\r\n\r\n> I believe that in most cases the one who writes `x as u32` actually wants `x.round() as u32`.\r\n\r\nI guess it depends on the domain, but I expect `x.trunc() as u32` is also quite commonly desired.\r\n\r\n> I agree, but only if lossiness is easily predictable.\r\n\r\nI definitely agree. Whether `1.6 as u32` becomes 1 or 2 should not be undefined, for instance.",
    "author_association": "NONE",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/565676885/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/565695158",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-565695158",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 565695158,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU2NTY5NTE1OA==",
    "user": {
      "login": "SimonSapin",
      "id": 291359,
      "node_id": "MDQ6VXNlcjI5MTM1OQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/291359?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/SimonSapin",
      "html_url": "https://github.com/SimonSapin",
      "followers_url": "https://api.github.com/users/SimonSapin/followers",
      "following_url": "https://api.github.com/users/SimonSapin/following{/other_user}",
      "gists_url": "https://api.github.com/users/SimonSapin/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/SimonSapin/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/SimonSapin/subscriptions",
      "organizations_url": "https://api.github.com/users/SimonSapin/orgs",
      "repos_url": "https://api.github.com/users/SimonSapin/repos",
      "events_url": "https://api.github.com/users/SimonSapin/events{/privacy}",
      "received_events_url": "https://api.github.com/users/SimonSapin/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2019-12-14T08:21:13Z",
    "updated_at": "2019-12-14T08:21:13Z",
    "body": "https://doc.rust-lang.org/nightly/reference/expressions/operator-expr.html#type-cast-expressions\r\n> Casting from a float to an integer will round the float towards zero \r\n> NOTE: currently this will cause Undefined Behavior if the rounded value cannot be represented by the target integer type. This includes Inf and NaN. This is a bug and will be fixed.\r\n\r\nThe note links here.\r\n\r\nRounding of values that \u201cfit\u201d is well-defined, that\u2019s not what this issue is about. This thread is already long, it would be nice not to take it into speculating tangents about facts that are already established and documented. Thanks.\r\n\r\nWhat remains to decide is how to define `f as $Int` in the following cases:\r\n\r\n* `f.trunc() > $Int::MAX` (including positive infinity)\r\n* `f.trunc() < $Int::MIN` (including negative infinity)\r\n* `f.is_nan()`\r\n\r\nOne option that\u2019s already implemented and available in Nightly with the `-Z saturating-casts` compiler flag is to define them to return respectively: `$Int::MAX`, `$Int::MIN`, and zero. But it\u2019s still possible pick some other behavior.\r\n\r\nMy view is that the behavior should definitely be deterministic and return some integer value (rather than panic for example), but the exact value is not too important and users who care about these cases should rather use conversion methods that I\u2019m separately proposing we add: https://internals.rust-lang.org/t/pre-rfc-add-explicitly-named-numeric-conversion-apis/11395",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/565695158/reactions",
      "total_count": 4,
      "+1": 4,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/565722056",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-565722056",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 565722056,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU2NTcyMjA1Ng==",
    "user": {
      "login": "agalakhov",
      "id": 1681335,
      "node_id": "MDQ6VXNlcjE2ODEzMzU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1681335?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/agalakhov",
      "html_url": "https://github.com/agalakhov",
      "followers_url": "https://api.github.com/users/agalakhov/followers",
      "following_url": "https://api.github.com/users/agalakhov/following{/other_user}",
      "gists_url": "https://api.github.com/users/agalakhov/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/agalakhov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/agalakhov/subscriptions",
      "organizations_url": "https://api.github.com/users/agalakhov/orgs",
      "repos_url": "https://api.github.com/users/agalakhov/repos",
      "events_url": "https://api.github.com/users/agalakhov/events{/privacy}",
      "received_events_url": "https://api.github.com/users/agalakhov/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2019-12-14T14:19:48Z",
    "updated_at": "2019-12-14T14:23:08Z",
    "body": "> I guess it depends on the domain, but I expect `x.trunc() as u32` is also quite commonly desired.\r\n\r\nCorrect. In general, `x.anything() as u32`, most likely `round()`, but could also be `trunc()`, `floor()`, `ceil()`. Just `x as u32` without specifying concrete rounding procedure is most likely a mistake.\r\n\r\n> My view is that the behavior should definitely be deterministic and return some integer value (rather than panic for example), but the exact value is not too important\r\n\r\nI personally am fine even with \"undefined\" value provided that it does not depend on anything but float itself and, most important, does not expose any unrelated register and memory contents.",
    "author_association": "NONE",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/565722056/reactions",
      "total_count": 2,
      "+1": 2,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/612167970",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-612167970",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 612167970,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYxMjE2Nzk3MA==",
    "user": {
      "login": "mawis",
      "id": 2042030,
      "node_id": "MDQ6VXNlcjIwNDIwMzA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2042030?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mawis",
      "html_url": "https://github.com/mawis",
      "followers_url": "https://api.github.com/users/mawis/followers",
      "following_url": "https://api.github.com/users/mawis/following{/other_user}",
      "gists_url": "https://api.github.com/users/mawis/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mawis/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mawis/subscriptions",
      "organizations_url": "https://api.github.com/users/mawis/orgs",
      "repos_url": "https://api.github.com/users/mawis/repos",
      "events_url": "https://api.github.com/users/mawis/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mawis/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2020-04-10T18:51:43Z",
    "updated_at": "2020-04-10T18:51:43Z",
    "body": "> One option that\u2019s already implemented and available in Nightly with the `-Z saturating-casts` compiler flag is to define them to return respectively: `$Int::MAX`, `$Int::MIN`, and zero. But it\u2019s still possible pick some other behavior.\r\n\r\nThe behavior I would expect to get for `f.trunc() > $Int::MAX` and `f.trunc() < $Int::MIN` is the same as when the floating point number imaginary gets converted to an infinite sized integer number and then the lowest significant bits of that are returned (as in the conversion of integer types). Technically this would be some bits of the significant shifted to the left depending on the exponent (for positive numbers, negative numbers need inversion according to the two's complement).\r\n\r\nSo for example I would expect really big numbers to convert to `0`.\r\n\r\nIt seems to be harder/more arbitrary to define what infinity and NaN converts to.",
    "author_association": "NONE",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/612167970/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/612173204",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-612173204",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 612173204,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYxMjE3MzIwNA==",
    "user": {
      "login": "CryZe",
      "id": 1451630,
      "node_id": "MDQ6VXNlcjE0NTE2MzA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1451630?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/CryZe",
      "html_url": "https://github.com/CryZe",
      "followers_url": "https://api.github.com/users/CryZe/followers",
      "following_url": "https://api.github.com/users/CryZe/following{/other_user}",
      "gists_url": "https://api.github.com/users/CryZe/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/CryZe/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/CryZe/subscriptions",
      "organizations_url": "https://api.github.com/users/CryZe/orgs",
      "repos_url": "https://api.github.com/users/CryZe/repos",
      "events_url": "https://api.github.com/users/CryZe/events{/privacy}",
      "received_events_url": "https://api.github.com/users/CryZe/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2020-04-10T19:03:38Z",
    "updated_at": "2020-04-10T19:03:38Z",
    "body": "WebAssembly just stabilized saturating casts with the following semantics: \r\n\r\nhttps://github.com/WebAssembly/nontrapping-float-to-int-conversions/blob/master/proposals/nontrapping-float-to-int-conversion/Overview.md#design",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/612173204/reactions",
      "total_count": 3,
      "+1": 2,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 1,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/612244778",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-612244778",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 612244778,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYxMjI0NDc3OA==",
    "user": {
      "login": "RalfJung",
      "id": 330628,
      "node_id": "MDQ6VXNlcjMzMDYyOA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/330628?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/RalfJung",
      "html_url": "https://github.com/RalfJung",
      "followers_url": "https://api.github.com/users/RalfJung/followers",
      "following_url": "https://api.github.com/users/RalfJung/following{/other_user}",
      "gists_url": "https://api.github.com/users/RalfJung/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/RalfJung/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/RalfJung/subscriptions",
      "organizations_url": "https://api.github.com/users/RalfJung/orgs",
      "repos_url": "https://api.github.com/users/RalfJung/repos",
      "events_url": "https://api.github.com/users/RalfJung/events{/privacy}",
      "received_events_url": "https://api.github.com/users/RalfJung/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2020-04-10T22:25:19Z",
    "updated_at": "2020-04-10T22:25:19Z",
    "body": "@CryZe so if I read that correctly, that matches `-Z saturating-casts` (and what Miri already implements)?",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/612244778/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/612266371",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-612266371",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 612266371,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYxMjI2NjM3MQ==",
    "user": {
      "login": "sunfishcode",
      "id": 4503403,
      "node_id": "MDQ6VXNlcjQ1MDM0MDM=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4503403?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sunfishcode",
      "html_url": "https://github.com/sunfishcode",
      "followers_url": "https://api.github.com/users/sunfishcode/followers",
      "following_url": "https://api.github.com/users/sunfishcode/following{/other_user}",
      "gists_url": "https://api.github.com/users/sunfishcode/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sunfishcode/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sunfishcode/subscriptions",
      "organizations_url": "https://api.github.com/users/sunfishcode/orgs",
      "repos_url": "https://api.github.com/users/sunfishcode/repos",
      "events_url": "https://api.github.com/users/sunfishcode/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sunfishcode/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2020-04-10T23:36:53Z",
    "updated_at": "2020-04-10T23:36:53Z",
    "body": "@RalfJung That's correct. \r\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/612266371/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/612346190",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-612346190",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 612346190,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYxMjM0NjE5MA==",
    "user": {
      "login": "RalfJung",
      "id": 330628,
      "node_id": "MDQ6VXNlcjMzMDYyOA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/330628?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/RalfJung",
      "html_url": "https://github.com/RalfJung",
      "followers_url": "https://api.github.com/users/RalfJung/followers",
      "following_url": "https://api.github.com/users/RalfJung/following{/other_user}",
      "gists_url": "https://api.github.com/users/RalfJung/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/RalfJung/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/RalfJung/subscriptions",
      "organizations_url": "https://api.github.com/users/RalfJung/orgs",
      "repos_url": "https://api.github.com/users/RalfJung/repos",
      "events_url": "https://api.github.com/users/RalfJung/events{/privacy}",
      "received_events_url": "https://api.github.com/users/RalfJung/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2020-04-11T06:39:52Z",
    "updated_at": "2020-04-11T06:39:52Z",
    "body": "Awesome, I'll copy https://github.com/WebAssembly/testsuite/blob/master/conversions.wast (with traps replaced by the specified results) to Miri's test suite then. :)",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/612346190/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/612409513",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-612409513",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 612409513,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYxMjQwOTUxMw==",
    "user": {
      "login": "sunfishcode",
      "id": 4503403,
      "node_id": "MDQ6VXNlcjQ1MDM0MDM=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4503403?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sunfishcode",
      "html_url": "https://github.com/sunfishcode",
      "followers_url": "https://api.github.com/users/sunfishcode/followers",
      "following_url": "https://api.github.com/users/sunfishcode/following{/other_user}",
      "gists_url": "https://api.github.com/users/sunfishcode/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sunfishcode/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sunfishcode/subscriptions",
      "organizations_url": "https://api.github.com/users/sunfishcode/orgs",
      "repos_url": "https://api.github.com/users/sunfishcode/repos",
      "events_url": "https://api.github.com/users/sunfishcode/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sunfishcode/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2020-04-11T12:26:51Z",
    "updated_at": "2020-04-11T12:26:51Z",
    "body": "@RalfJung Please update to the latest version of conversions.wast, which was just updated to include tests for the new saturating conversion operators. The new operators have \"_sat\" in their names, and they don't have trapping so you shouldn't need to replace anything.",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/612409513/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/612410597",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-612410597",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 612410597,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYxMjQxMDU5Nw==",
    "user": {
      "login": "RalfJung",
      "id": 330628,
      "node_id": "MDQ6VXNlcjMzMDYyOA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/330628?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/RalfJung",
      "html_url": "https://github.com/RalfJung",
      "followers_url": "https://api.github.com/users/RalfJung/followers",
      "following_url": "https://api.github.com/users/RalfJung/following{/other_user}",
      "gists_url": "https://api.github.com/users/RalfJung/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/RalfJung/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/RalfJung/subscriptions",
      "organizations_url": "https://api.github.com/users/RalfJung/orgs",
      "repos_url": "https://api.github.com/users/RalfJung/repos",
      "events_url": "https://api.github.com/users/RalfJung/events{/privacy}",
      "received_events_url": "https://api.github.com/users/RalfJung/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2020-04-11T12:31:46Z",
    "updated_at": "2020-04-11T12:33:00Z",
    "body": "@sunfishcode thanks for updating! I have to translate the tests to Rust anyway so I still have to replace many things. ;)\r\n\r\nAre the `_sat` tests any different in terms of the values being tested? (EDIT: there's a comment there saying the values are the same.) For Rust's saturating casts I took many of these values and added them in https://github.com/rust-lang/miri/pull/1321. I was too lazy to do it for all of them... but I think this means that there is nothing to change right now with the updated file.\r\n\r\nFor the UB intrinsic, the traps on the wasm side should then become compile-fail tests in Miri I think.",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/612410597/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/612421369",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-612421369",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 612421369,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYxMjQyMTM2OQ==",
    "user": {
      "login": "sunfishcode",
      "id": 4503403,
      "node_id": "MDQ6VXNlcjQ1MDM0MDM=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4503403?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sunfishcode",
      "html_url": "https://github.com/sunfishcode",
      "followers_url": "https://api.github.com/users/sunfishcode/followers",
      "following_url": "https://api.github.com/users/sunfishcode/following{/other_user}",
      "gists_url": "https://api.github.com/users/sunfishcode/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sunfishcode/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sunfishcode/subscriptions",
      "organizations_url": "https://api.github.com/users/sunfishcode/orgs",
      "repos_url": "https://api.github.com/users/sunfishcode/repos",
      "events_url": "https://api.github.com/users/sunfishcode/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sunfishcode/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2020-04-11T13:28:23Z",
    "updated_at": "2020-04-11T13:28:23Z",
    "body": "The input values are all the same, the only difference is that `_sat` operators have expected output values on inputs where the trapping operators have expected traps.",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/612421369/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/612592001",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-612592001",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 612592001,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYxMjU5MjAwMQ==",
    "user": {
      "login": "RalfJung",
      "id": 330628,
      "node_id": "MDQ6VXNlcjMzMDYyOA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/330628?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/RalfJung",
      "html_url": "https://github.com/RalfJung",
      "followers_url": "https://api.github.com/users/RalfJung/followers",
      "following_url": "https://api.github.com/users/RalfJung/following{/other_user}",
      "gists_url": "https://api.github.com/users/RalfJung/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/RalfJung/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/RalfJung/subscriptions",
      "organizations_url": "https://api.github.com/users/RalfJung/orgs",
      "repos_url": "https://api.github.com/users/RalfJung/repos",
      "events_url": "https://api.github.com/users/RalfJung/events{/privacy}",
      "received_events_url": "https://api.github.com/users/RalfJung/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2020-04-12T10:10:17Z",
    "updated_at": "2020-04-12T10:10:17Z",
    "body": "Tests for Miri (and thus also the Rust CTFE engine) were added in https://github.com/rust-lang/miri/pull/1321. I locally checked that `rustc -Zmir-opt-level=0 -Zsaturating-float-casts` also passes the tests in that file.\r\nI now also implemented the unchecked intrinsic in Miri, see https://github.com/rust-lang/miri/pull/1325.",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/612592001/reactions",
      "total_count": 1,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 1,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/615537571",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-615537571",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 615537571,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYxNTUzNzU3MQ==",
    "user": {
      "login": "Mark-Simulacrum",
      "id": 5047365,
      "node_id": "MDQ6VXNlcjUwNDczNjU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5047365?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Mark-Simulacrum",
      "html_url": "https://github.com/Mark-Simulacrum",
      "followers_url": "https://api.github.com/users/Mark-Simulacrum/followers",
      "following_url": "https://api.github.com/users/Mark-Simulacrum/following{/other_user}",
      "gists_url": "https://api.github.com/users/Mark-Simulacrum/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Mark-Simulacrum/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Mark-Simulacrum/subscriptions",
      "organizations_url": "https://api.github.com/users/Mark-Simulacrum/orgs",
      "repos_url": "https://api.github.com/users/Mark-Simulacrum/repos",
      "events_url": "https://api.github.com/users/Mark-Simulacrum/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Mark-Simulacrum/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2020-04-18T01:56:32Z",
    "updated_at": "2020-04-18T01:56:32Z",
    "body": "I've posted https://github.com/rust-lang/rust/pull/71269#issuecomment-615537137 which documents the current state as I understood it and that PR also moves to stabilize the behavior of the saturating -Z flag.\r\n\r\nGiven the length of this thread I think if folks feel that I've missed anything in that comment, I would direct commentary to the PR, or, if it's minor, feel free to ping me on Zulip or Discord (simulacrum) and I can fix things up to avoid unnecessary noise on the PR thread.\r\n\r\nI expect that someone on the language team will likely start an FCP proposal on that PR soon, and merging it will automatically close this issue out :)",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/615537571/reactions",
      "total_count": 2,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 2,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/617912573",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-617912573",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 617912573,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYxNzkxMjU3Mw==",
    "user": {
      "login": "federicomenaquintero",
      "id": 7617,
      "node_id": "MDQ6VXNlcjc2MTc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7617?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/federicomenaquintero",
      "html_url": "https://github.com/federicomenaquintero",
      "followers_url": "https://api.github.com/users/federicomenaquintero/followers",
      "following_url": "https://api.github.com/users/federicomenaquintero/following{/other_user}",
      "gists_url": "https://api.github.com/users/federicomenaquintero/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/federicomenaquintero/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/federicomenaquintero/subscriptions",
      "organizations_url": "https://api.github.com/users/federicomenaquintero/orgs",
      "repos_url": "https://api.github.com/users/federicomenaquintero/repos",
      "events_url": "https://api.github.com/users/federicomenaquintero/events{/privacy}",
      "received_events_url": "https://api.github.com/users/federicomenaquintero/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2020-04-22T17:13:54Z",
    "updated_at": "2020-04-22T17:13:54Z",
    "body": "Are there plans for checked conversions?  Something like `fn i32::checked_from(f64) -> Result<i32, DoesntFit>`?",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/617912573/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/617924148",
    "html_url": "https://github.com/rust-lang/rust/issues/10184#issuecomment-617924148",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10184",
    "id": 617924148,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYxNzkyNDE0OA==",
    "user": {
      "login": "kennytm",
      "id": 103023,
      "node_id": "MDQ6VXNlcjEwMzAyMw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/103023?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/kennytm",
      "html_url": "https://github.com/kennytm",
      "followers_url": "https://api.github.com/users/kennytm/followers",
      "following_url": "https://api.github.com/users/kennytm/following{/other_user}",
      "gists_url": "https://api.github.com/users/kennytm/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/kennytm/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kennytm/subscriptions",
      "organizations_url": "https://api.github.com/users/kennytm/orgs",
      "repos_url": "https://api.github.com/users/kennytm/repos",
      "events_url": "https://api.github.com/users/kennytm/events{/privacy}",
      "received_events_url": "https://api.github.com/users/kennytm/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2020-04-22T17:34:41Z",
    "updated_at": "2020-04-22T17:34:41Z",
    "body": "You'll need to consider what should `i32::checked_from(4.5)` return.",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/617924148/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
