[
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/102747420",
    "html_url": "https://github.com/rust-lang/rust/issues/25505#issuecomment-102747420",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/25505",
    "id": 102747420,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEwMjc0NzQyMA==",
    "user": {
      "login": "alexcrichton",
      "id": 64996,
      "node_id": "MDQ6VXNlcjY0OTk2",
      "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alexcrichton",
      "html_url": "https://github.com/alexcrichton",
      "followers_url": "https://api.github.com/users/alexcrichton/followers",
      "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}",
      "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions",
      "organizations_url": "https://api.github.com/users/alexcrichton/orgs",
      "repos_url": "https://api.github.com/users/alexcrichton/repos",
      "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alexcrichton/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-05-17T04:53:42Z",
    "updated_at": "2015-05-17T04:53:42Z",
    "body": "Yeah this is an unfortunate limitation of running with `gcc` from MinGW, it appears it just fundamentally doesn't understand all kinds of windows paths (for example the `\\\\?\\` syntax you've run into).\n\nThis path is introduced from the [call to `fs::canonicalize`](https://github.com/rust-lang/rust/blob/4f83c4b8513fe77ab27e1f8d07cf5c7d577a1fe2/src/librustc/metadata/loader.rs#L432-L436) and we actually [already have some code](https://github.com/rust-lang/rust/blob/4f83c4b8513fe77ab27e1f8d07cf5c7d577a1fe2/src/librustc/util/fs.rs#L14-L38) to fix this case as well. \n\nOut of curiosity, do you know what the non-verbatim path of this looks like? We probably just need to handle another case for `fix_windows_verbatim_for_gcc` and that should do the trick!\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/102747420/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/102876737",
    "html_url": "https://github.com/rust-lang/rust/issues/25505#issuecomment-102876737",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/25505",
    "id": 102876737,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEwMjg3NjczNw==",
    "user": {
      "login": "yonran",
      "id": 483060,
      "node_id": "MDQ6VXNlcjQ4MzA2MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/483060?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/yonran",
      "html_url": "https://github.com/yonran",
      "followers_url": "https://api.github.com/users/yonran/followers",
      "following_url": "https://api.github.com/users/yonran/following{/other_user}",
      "gists_url": "https://api.github.com/users/yonran/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/yonran/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/yonran/subscriptions",
      "organizations_url": "https://api.github.com/users/yonran/orgs",
      "repos_url": "https://api.github.com/users/yonran/repos",
      "events_url": "https://api.github.com/users/yonran/events{/privacy}",
      "received_events_url": "https://api.github.com/users/yonran/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-05-18T00:25:17Z",
    "updated_at": "2015-05-18T00:25:17Z",
    "body": "For `std::path::Prefix::VerbatimUNC`, I think `fix_windows_verbatim_for_gcc` should convert it to `std::path::Prefix::UNC`. GCC seems to accept the `\\\\server\\share` syntax.\n\nI thought that gcc was mangling the `\\\\?\\UNC\\server\\share` argument, but after poking around in windbg for a long time and looking at it in ProcessMonitor I realized that it\u2019s not GCC\u2019s fault; it\u2019s msvcrt.dll! For some reason, when you run a command line program built with msvcrt.dll ([which new programs are not supposed to link](http://blogs.msdn.com/b/oldnewthing/archive/2014/04/11/10516280.aspx), but mingw does anyway because they don\u2019t want to rewrite the C runtime), msvcrt.dll will scan your verbatim `\\\\?\\path\\filename` args and replace them with useless `\\\\filename` strings if the path exists.\n\nFor example, if you compile this test program with cl.exe (with the latest C runtime, msvcr120) and run it as `echo.exe \\\\?\\C:\\Windows\\System32\\calc.exe`, it will output `\\\\?\\C:\\Windows\\System32\\calc.exe` as expected. But if you compile it with mingw (and the old msvcrt.dll), it will bizarrely output `\\\\calc.exe`!\n\n```\n#include <stdio.h>\nint main(int argc, char *argv[]) {\n    for (int i = 1; i < argc; i++) {\n        printf(\"%s\\n\", argv[i]);\n    }\n}\n```\n\nNote: the stack of the call to FindFirstFileA when msvcrt.dll is determining whether to destroy your argument is\n\n```\n00 00000000`0023fca8 00007ff9`f813cc61 KERNELBASE!FindFirstFileA\n01 00000000`0023fcb0 00007ff9`f813cd59 msvcrt!find+0x61\n02 00000000`0023fce0 00007ff9`f8118293 msvcrt!match+0xa1\n03 00000000`0023fd50 00007ff9`f80f0903 msvcrt!cwild+0x45\n04 00000000`0023fd80 00007ff9`f80f080c msvcrt!_setargv+0xd6\n05 00000000`0023fdc0 00000000`0040116d msvcrt!_getmainargs+0x31\n06 00000000`0023fdf0 00007ff9`f80d4e6d image00000000_00400000+0x116d\n07 00000000`0023fe30 00000000`00401440 msvcrt!initterm+0x2d\n08 00000000`0023fe60 00000000`004014e8 image00000000_00400000+0x1440\n```\n\nI am testing this on Windows 8.1.\n",
    "author_association": "NONE",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/102876737/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/106630891",
    "html_url": "https://github.com/rust-lang/rust/issues/25505#issuecomment-106630891",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/25505",
    "id": 106630891,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEwNjYzMDg5MQ==",
    "user": {
      "login": "alexcrichton",
      "id": 64996,
      "node_id": "MDQ6VXNlcjY0OTk2",
      "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alexcrichton",
      "html_url": "https://github.com/alexcrichton",
      "followers_url": "https://api.github.com/users/alexcrichton/followers",
      "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}",
      "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions",
      "organizations_url": "https://api.github.com/users/alexcrichton/orgs",
      "repos_url": "https://api.github.com/users/alexcrichton/repos",
      "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alexcrichton/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-05-28T23:49:46Z",
    "updated_at": "2015-05-28T23:49:46Z",
    "body": "Wow, that is some fascinating investigation @yonran! Thanks so much for digging this up!\n\nI've opened a PR to handle this case for now in https://github.com/rust-lang/rust/pull/25868.\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/106630891/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
