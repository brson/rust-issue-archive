[
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/33087497",
    "html_url": "https://github.com/rust-lang/rust/pull/11725#issuecomment-33087497",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/11725",
    "id": 33087497,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMzMDg3NDk3",
    "user": {
      "login": "brson",
      "id": 147214,
      "node_id": "MDQ6VXNlcjE0NzIxNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/brson",
      "html_url": "https://github.com/brson",
      "followers_url": "https://api.github.com/users/brson/followers",
      "following_url": "https://api.github.com/users/brson/following{/other_user}",
      "gists_url": "https://api.github.com/users/brson/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/brson/subscriptions",
      "organizations_url": "https://api.github.com/users/brson/orgs",
      "repos_url": "https://api.github.com/users/brson/repos",
      "events_url": "https://api.github.com/users/brson/events{/privacy}",
      "received_events_url": "https://api.github.com/users/brson/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-01-23T01:03:56Z",
    "updated_at": "2014-01-23T01:03:56Z",
    "body": "Are there other libraries we can look to for the names of these types? These don't do what I expected from the names: I figured a 'barrier' would be a memory barrier and I wouldn't be able to guess what a double barrier is. Googling doesn't turn up hits for 'double barrier'. Seems like the documentation could be beefed up a lot too since I had to read the code to understand what these do.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/33087497/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/33092734",
    "html_url": "https://github.com/rust-lang/rust/pull/11725#issuecomment-33092734",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/11725",
    "id": 33092734,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMzMDkyNzM0",
    "user": {
      "login": "derekchiang",
      "id": 1535686,
      "node_id": "MDQ6VXNlcjE1MzU2ODY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1535686?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/derekchiang",
      "html_url": "https://github.com/derekchiang",
      "followers_url": "https://api.github.com/users/derekchiang/followers",
      "following_url": "https://api.github.com/users/derekchiang/following{/other_user}",
      "gists_url": "https://api.github.com/users/derekchiang/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/derekchiang/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/derekchiang/subscriptions",
      "organizations_url": "https://api.github.com/users/derekchiang/orgs",
      "repos_url": "https://api.github.com/users/derekchiang/repos",
      "events_url": "https://api.github.com/users/derekchiang/events{/privacy}",
      "received_events_url": "https://api.github.com/users/derekchiang/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-01-23T02:49:46Z",
    "updated_at": "2014-01-23T02:51:21Z",
    "body": "For reference, these are the two places I have seen that discuss double barriers:\n1. [The Zookeeper documentation](https://zookeeper.apache.org/doc/r3.1.2/recipes.html#sc_doubleBarriers) and [the paper (page 6)](https://www.usenix.org/legacy/event/usenix10/tech/full_papers/Hunt.pdf)\n2. [The Little Book of Semaphores (section 3.5)](http://www.cs.ucr.edu/~kishore/papers/semaphores.pdf)\n\nPer @alexcrichton's previous comments, I added some comments and code examples.  Also, my previous implementation was flatly wrong, as I overlooked the issue of spurious wakeups.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/33092734/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/33094239",
    "html_url": "https://github.com/rust-lang/rust/pull/11725#issuecomment-33094239",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/11725",
    "id": 33094239,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMzMDk0MjM5",
    "user": {
      "login": "alexcrichton",
      "id": 64996,
      "node_id": "MDQ6VXNlcjY0OTk2",
      "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alexcrichton",
      "html_url": "https://github.com/alexcrichton",
      "followers_url": "https://api.github.com/users/alexcrichton/followers",
      "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}",
      "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions",
      "organizations_url": "https://api.github.com/users/alexcrichton/orgs",
      "repos_url": "https://api.github.com/users/alexcrichton/repos",
      "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alexcrichton/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-01-23T03:30:00Z",
    "updated_at": "2014-01-23T03:30:00Z",
    "body": "What do you think about only implementing `Barrier`, but allowing re-use as you do now? I would think that a `DoubleBarrier` is just trivially two waits on a single barrier.\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/33094239/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/33094485",
    "html_url": "https://github.com/rust-lang/rust/pull/11725#issuecomment-33094485",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/11725",
    "id": 33094485,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMzMDk0NDg1",
    "user": {
      "login": "derekchiang",
      "id": 1535686,
      "node_id": "MDQ6VXNlcjE1MzU2ODY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1535686?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/derekchiang",
      "html_url": "https://github.com/derekchiang",
      "followers_url": "https://api.github.com/users/derekchiang/followers",
      "following_url": "https://api.github.com/users/derekchiang/following{/other_user}",
      "gists_url": "https://api.github.com/users/derekchiang/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/derekchiang/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/derekchiang/subscriptions",
      "organizations_url": "https://api.github.com/users/derekchiang/orgs",
      "repos_url": "https://api.github.com/users/derekchiang/repos",
      "events_url": "https://api.github.com/users/derekchiang/events{/privacy}",
      "received_events_url": "https://api.github.com/users/derekchiang/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-01-23T03:36:39Z",
    "updated_at": "2014-01-23T03:36:39Z",
    "body": "Do you mean: rename `DoubleBarrier` to `Barrier`, and implement `DoubleBarrier` such that both `enter` and `exit` just call `wait`?\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/33094485/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/33094585",
    "html_url": "https://github.com/rust-lang/rust/pull/11725#issuecomment-33094585",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/11725",
    "id": 33094585,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMzMDk0NTg1",
    "user": {
      "login": "alexcrichton",
      "id": 64996,
      "node_id": "MDQ6VXNlcjY0OTk2",
      "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alexcrichton",
      "html_url": "https://github.com/alexcrichton",
      "followers_url": "https://api.github.com/users/alexcrichton/followers",
      "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}",
      "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions",
      "organizations_url": "https://api.github.com/users/alexcrichton/orgs",
      "repos_url": "https://api.github.com/users/alexcrichton/repos",
      "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alexcrichton/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-01-23T03:39:32Z",
    "updated_at": "2014-01-23T03:39:32Z",
    "body": "Not quite. I would imagine this sequence of events:\n- Remove `Barrier`\n- Rename `DoubleBarrier` to `Barrier`\n- Remove `exit`\n- Rename `enter` to `wait`\n- Modify the broadcast() in `wait` to also reset the count.\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/33094585/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/33123414",
    "html_url": "https://github.com/rust-lang/rust/pull/11725#issuecomment-33123414",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/11725",
    "id": 33123414,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMzMTIzNDE0",
    "user": {
      "login": "c-a",
      "id": 804040,
      "node_id": "MDQ6VXNlcjgwNDA0MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/804040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/c-a",
      "html_url": "https://github.com/c-a",
      "followers_url": "https://api.github.com/users/c-a/followers",
      "following_url": "https://api.github.com/users/c-a/following{/other_user}",
      "gists_url": "https://api.github.com/users/c-a/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/c-a/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/c-a/subscriptions",
      "organizations_url": "https://api.github.com/users/c-a/orgs",
      "repos_url": "https://api.github.com/users/c-a/repos",
      "events_url": "https://api.github.com/users/c-a/events{/privacy}",
      "received_events_url": "https://api.github.com/users/c-a/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-01-23T13:29:46Z",
    "updated_at": "2014-01-23T13:29:46Z",
    "body": "> Not quite. I would imagine this sequence of events:\n> \n> ```\n> Remove Barrier\n> Rename DoubleBarrier to Barrier\n> Remove exit\n> Rename enter to wait\n> Modify the broadcast() in wait to also reset the count.\n> ```\n\nFWIW, this seems to be the behaviour the Pthreads barrier has: http://linux.die.net/man/3/pthread_barrier_wait\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/33123414/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/33196459",
    "html_url": "https://github.com/rust-lang/rust/pull/11725#issuecomment-33196459",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/11725",
    "id": 33196459,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMzMTk2NDU5",
    "user": {
      "login": "derekchiang",
      "id": 1535686,
      "node_id": "MDQ6VXNlcjE1MzU2ODY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1535686?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/derekchiang",
      "html_url": "https://github.com/derekchiang",
      "followers_url": "https://api.github.com/users/derekchiang/followers",
      "following_url": "https://api.github.com/users/derekchiang/following{/other_user}",
      "gists_url": "https://api.github.com/users/derekchiang/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/derekchiang/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/derekchiang/subscriptions",
      "organizations_url": "https://api.github.com/users/derekchiang/orgs",
      "repos_url": "https://api.github.com/users/derekchiang/repos",
      "events_url": "https://api.github.com/users/derekchiang/events{/privacy}",
      "received_events_url": "https://api.github.com/users/derekchiang/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-01-24T04:23:30Z",
    "updated_at": "2014-01-24T04:23:30Z",
    "body": "@alexcrichton The standard implementation of a barrier, like that given in the [The Little Book of Semaphores (page 44)](http://www.cs.ucr.edu/~kishore/papers/semaphores.pdf), is to have two phases (which correspond to `enter` and `exit` in my implementation) and have the `wait()` call the two phases.  Note that the implementation on the book uses semaphores, while mine uses condition variables, but conceptually they are the same.\n\nIf you think about it, you can't simply reset the count.  Consider this code:\n\n``` rust\npub fn enter(&self) {\n    self.arc.access_cond(|state, cond| {\n        state.count += 1;\n        if state.count < self.num_tasks {\n            cond.wait();\n        } else {\n            state.count = 0;\n            cond.broadcast();\n        }\n    });\n}\n```\n\nThe problem with this code is that it doesn't guard against [spurious wakeup](http://en.wikipedia.org/wiki/Spurious_wakeup).  As a standard practice, condition variables should wait only in a while loop which checks for a condition, to prevent a thread from accidentally waking up when the condition has not become true yet.  So, the code above could be rewritten like this:\n\n``` rust\npub fn enter(&self) {\n    self.arc.access_cond(|state, cond| {\n        state.count += 1;\n        if state.count < self.num_tasks {\n            while state.count < self.num_tasks {\n                cond.wait();\n            }\n        } else {\n            state.count = 0;\n            cond.broadcast();\n        }\n    });\n}\n```\n\nHowever, since we are reseting the counter to 0, the tasks being woken up might not be able to escape the while loop.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/33196459/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/33198738",
    "html_url": "https://github.com/rust-lang/rust/pull/11725#issuecomment-33198738",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/11725",
    "id": 33198738,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMzMTk4NzM4",
    "user": {
      "login": "alexcrichton",
      "id": 64996,
      "node_id": "MDQ6VXNlcjY0OTk2",
      "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alexcrichton",
      "html_url": "https://github.com/alexcrichton",
      "followers_url": "https://api.github.com/users/alexcrichton/followers",
      "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}",
      "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions",
      "organizations_url": "https://api.github.com/users/alexcrichton/orgs",
      "repos_url": "https://api.github.com/users/alexcrichton/repos",
      "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alexcrichton/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-01-24T05:36:09Z",
    "updated_at": "2014-01-24T05:36:09Z",
    "body": "It's true that condition variables are often susceptible to spurious wakeups, but remember that it is an implementation detail that isn't necessarily true in all circumstances. Notably our condition variables are not susceptible spurious wakeups.\n\nAdditionally, I believe that it's still possible to write a generic `wait` function:\n\n``` rust\nfn wait(&mut self) {\n    self.arc.access_cond(|state, cond| {\n        let id = state.generation_id;\n        state.count += 1;\n        if state.count < self.num_tasks {\n            while state.generation_id == id && state.count < self.num_tasks {\n                cond.wait();\n            }\n        } else {\n            state.count = 0;\n            state.generation_id += 1;\n            cond.broadcast();\n        }\n    });\n}\n```\n\nThe generation id ensures that a thread only waits in one usage of the a barrier. With our condition variables as-is I don't believe that this is necessary, but we may be susceptible to spurious wakeups at some point.\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/33198738/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/33246589",
    "html_url": "https://github.com/rust-lang/rust/pull/11725#issuecomment-33246589",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/11725",
    "id": 33246589,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMzMjQ2NTg5",
    "user": {
      "login": "derekchiang",
      "id": 1535686,
      "node_id": "MDQ6VXNlcjE1MzU2ODY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1535686?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/derekchiang",
      "html_url": "https://github.com/derekchiang",
      "followers_url": "https://api.github.com/users/derekchiang/followers",
      "following_url": "https://api.github.com/users/derekchiang/following{/other_user}",
      "gists_url": "https://api.github.com/users/derekchiang/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/derekchiang/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/derekchiang/subscriptions",
      "organizations_url": "https://api.github.com/users/derekchiang/orgs",
      "repos_url": "https://api.github.com/users/derekchiang/repos",
      "events_url": "https://api.github.com/users/derekchiang/events{/privacy}",
      "received_events_url": "https://api.github.com/users/derekchiang/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-01-24T18:10:05Z",
    "updated_at": "2014-01-24T18:10:05Z",
    "body": "From my understanding, spurious wakeup is an inherent problem of `pthread`, so I'm not sure how Rust could avoid it.  Could you explain a bit?\n\nAnyway, I changed the code according to your instruction.  Note that instead of using `generation_id`, I'm using a boolean flag to make the barrier truly reusable.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/33246589/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/33247359",
    "html_url": "https://github.com/rust-lang/rust/pull/11725#issuecomment-33247359",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/11725",
    "id": 33247359,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMzMjQ3MzU5",
    "user": {
      "login": "alexcrichton",
      "id": 64996,
      "node_id": "MDQ6VXNlcjY0OTk2",
      "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alexcrichton",
      "html_url": "https://github.com/alexcrichton",
      "followers_url": "https://api.github.com/users/alexcrichton/followers",
      "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}",
      "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions",
      "organizations_url": "https://api.github.com/users/alexcrichton/orgs",
      "repos_url": "https://api.github.com/users/alexcrichton/repos",
      "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alexcrichton/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-01-24T18:19:58Z",
    "updated_at": "2014-01-24T18:19:58Z",
    "body": "We can get around spurious wakeups in two ways:\n1. Don't use pthreads. We have scheduling primitives on the tasks themselves, so we can use those to implement a cvar\n2. Have fine-grained knowledge about how a cvar is being used. For example, native tasks right now use a pthread cvar in order to implement `deschedule`, and they're able to protect against spurious wakeups because they have detailed knowledge about the usage pattern of the wakeup procedure (`reawaken`)\n\nI think we may want to stick with an integer generation, though. Consider a sequence of events like this with a barrier of count 2:\n1. Thread A blocks with the generation of `false`.\n2. Thread B finishes the generation, waking up A, the generation is now `true`.\n3. Threads C and D sleep on the barrier, flipping it back to `false`.\n4. Thread A wakes up, sees the generation is still `false`, and the count is `0`, so it goes back to sleep.\n\nEssentially you don't know how many generations have passed since when you were signaled and when you've actually woken up. If we use an integer it's pretty unlikely to have 4 billion generations between when you were signaled and when you woke up, but I think it would be more likely to have 1 generation happen in that span of time.\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/33247359/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/33270846",
    "html_url": "https://github.com/rust-lang/rust/pull/11725#issuecomment-33270846",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/11725",
    "id": 33270846,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMzMjcwODQ2",
    "user": {
      "login": "derekchiang",
      "id": 1535686,
      "node_id": "MDQ6VXNlcjE1MzU2ODY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1535686?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/derekchiang",
      "html_url": "https://github.com/derekchiang",
      "followers_url": "https://api.github.com/users/derekchiang/followers",
      "following_url": "https://api.github.com/users/derekchiang/following{/other_user}",
      "gists_url": "https://api.github.com/users/derekchiang/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/derekchiang/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/derekchiang/subscriptions",
      "organizations_url": "https://api.github.com/users/derekchiang/orgs",
      "repos_url": "https://api.github.com/users/derekchiang/repos",
      "events_url": "https://api.github.com/users/derekchiang/events{/privacy}",
      "received_events_url": "https://api.github.com/users/derekchiang/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-01-24T23:11:24Z",
    "updated_at": "2014-01-24T23:11:24Z",
    "body": "You are absolutely correct.  I missed the fact that it doesn't matter if `generation_id` overflows.  Fixed.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/33270846/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/33282721",
    "html_url": "https://github.com/rust-lang/rust/pull/11725#issuecomment-33282721",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/11725",
    "id": 33282721,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMzMjgyNzIx",
    "user": {
      "login": "derekchiang",
      "id": 1535686,
      "node_id": "MDQ6VXNlcjE1MzU2ODY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1535686?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/derekchiang",
      "html_url": "https://github.com/derekchiang",
      "followers_url": "https://api.github.com/users/derekchiang/followers",
      "following_url": "https://api.github.com/users/derekchiang/following{/other_user}",
      "gists_url": "https://api.github.com/users/derekchiang/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/derekchiang/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/derekchiang/subscriptions",
      "organizations_url": "https://api.github.com/users/derekchiang/orgs",
      "repos_url": "https://api.github.com/users/derekchiang/repos",
      "events_url": "https://api.github.com/users/derekchiang/events{/privacy}",
      "received_events_url": "https://api.github.com/users/derekchiang/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-01-25T06:53:04Z",
    "updated_at": "2014-01-25T06:53:04Z",
    "body": "Thanks for reviewing.  Fixed.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/33282721/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/33282763",
    "html_url": "https://github.com/rust-lang/rust/pull/11725#issuecomment-33282763",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/11725",
    "id": 33282763,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMzMjgyNzYz",
    "user": {
      "login": "alexcrichton",
      "id": 64996,
      "node_id": "MDQ6VXNlcjY0OTk2",
      "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alexcrichton",
      "html_url": "https://github.com/alexcrichton",
      "followers_url": "https://api.github.com/users/alexcrichton/followers",
      "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}",
      "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions",
      "organizations_url": "https://api.github.com/users/alexcrichton/orgs",
      "repos_url": "https://api.github.com/users/alexcrichton/repos",
      "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alexcrichton/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-01-25T06:55:41Z",
    "updated_at": "2014-01-25T06:55:41Z",
    "body": "Could you rebase these commits into one? Other than that, this looks good to me!\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/33282763/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/33282851",
    "html_url": "https://github.com/rust-lang/rust/pull/11725#issuecomment-33282851",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/11725",
    "id": 33282851,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMzMjgyODUx",
    "user": {
      "login": "derekchiang",
      "id": 1535686,
      "node_id": "MDQ6VXNlcjE1MzU2ODY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1535686?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/derekchiang",
      "html_url": "https://github.com/derekchiang",
      "followers_url": "https://api.github.com/users/derekchiang/followers",
      "following_url": "https://api.github.com/users/derekchiang/following{/other_user}",
      "gists_url": "https://api.github.com/users/derekchiang/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/derekchiang/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/derekchiang/subscriptions",
      "organizations_url": "https://api.github.com/users/derekchiang/orgs",
      "repos_url": "https://api.github.com/users/derekchiang/repos",
      "events_url": "https://api.github.com/users/derekchiang/events{/privacy}",
      "received_events_url": "https://api.github.com/users/derekchiang/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-01-25T07:02:24Z",
    "updated_at": "2014-01-25T07:02:24Z",
    "body": "@alexcrichton done.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/33282851/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/33293724",
    "html_url": "https://github.com/rust-lang/rust/pull/11725#issuecomment-33293724",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/11725",
    "id": 33293724,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMzMjkzNzI0",
    "user": {
      "login": "derekchiang",
      "id": 1535686,
      "node_id": "MDQ6VXNlcjE1MzU2ODY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1535686?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/derekchiang",
      "html_url": "https://github.com/derekchiang",
      "followers_url": "https://api.github.com/users/derekchiang/followers",
      "following_url": "https://api.github.com/users/derekchiang/following{/other_user}",
      "gists_url": "https://api.github.com/users/derekchiang/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/derekchiang/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/derekchiang/subscriptions",
      "organizations_url": "https://api.github.com/users/derekchiang/orgs",
      "repos_url": "https://api.github.com/users/derekchiang/repos",
      "events_url": "https://api.github.com/users/derekchiang/events{/privacy}",
      "received_events_url": "https://api.github.com/users/derekchiang/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-01-25T17:01:46Z",
    "updated_at": "2014-01-25T17:01:46Z",
    "body": "@alexcrichton Fixed formatting issues.  Retry?\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/33293724/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
