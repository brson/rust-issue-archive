[
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/33579197",
    "html_url": "https://github.com/rust-lang/rust/pull/11905#issuecomment-33579197",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/11905",
    "id": 33579197,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMzNTc5MTk3",
    "user": {
      "login": "huonw",
      "id": 1203825,
      "node_id": "MDQ6VXNlcjEyMDM4MjU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1203825?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/huonw",
      "html_url": "https://github.com/huonw",
      "followers_url": "https://api.github.com/users/huonw/followers",
      "following_url": "https://api.github.com/users/huonw/following{/other_user}",
      "gists_url": "https://api.github.com/users/huonw/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/huonw/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/huonw/subscriptions",
      "organizations_url": "https://api.github.com/users/huonw/orgs",
      "repos_url": "https://api.github.com/users/huonw/repos",
      "events_url": "https://api.github.com/users/huonw/events{/privacy}",
      "received_events_url": "https://api.github.com/users/huonw/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-01-29T12:12:12Z",
    "updated_at": "2014-01-29T12:12:12Z",
    "body": "I feel like the name of this could be improved; I just borrowed it from D without much thought.\n\nMaybe something like `on_exit!(...)` or `at_scope_end!(...)`. Does anyone have any other suggestions?\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/33579197/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/33579349",
    "html_url": "https://github.com/rust-lang/rust/pull/11905#issuecomment-33579349",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/11905",
    "id": 33579349,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMzNTc5MzQ5",
    "user": {
      "login": "ghost",
      "id": 10137,
      "node_id": "MDQ6VXNlcjEwMTM3",
      "avatar_url": "https://avatars.githubusercontent.com/u/10137?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ghost",
      "html_url": "https://github.com/ghost",
      "followers_url": "https://api.github.com/users/ghost/followers",
      "following_url": "https://api.github.com/users/ghost/following{/other_user}",
      "gists_url": "https://api.github.com/users/ghost/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ghost/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ghost/subscriptions",
      "organizations_url": "https://api.github.com/users/ghost/orgs",
      "repos_url": "https://api.github.com/users/ghost/repos",
      "events_url": "https://api.github.com/users/ghost/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ghost/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-01-29T12:15:13Z",
    "updated_at": "2014-01-29T12:15:13Z",
    "body": "Go uses the `defer` keyword.\n",
    "author_association": "NONE",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/33579349/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/33580067",
    "html_url": "https://github.com/rust-lang/rust/pull/11905#issuecomment-33580067",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/11905",
    "id": 33580067,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMzNTgwMDY3",
    "user": {
      "login": "zr40",
      "id": 616299,
      "node_id": "MDQ6VXNlcjYxNjI5OQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/616299?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/zr40",
      "html_url": "https://github.com/zr40",
      "followers_url": "https://api.github.com/users/zr40/followers",
      "following_url": "https://api.github.com/users/zr40/following{/other_user}",
      "gists_url": "https://api.github.com/users/zr40/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/zr40/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/zr40/subscriptions",
      "organizations_url": "https://api.github.com/users/zr40/orgs",
      "repos_url": "https://api.github.com/users/zr40/repos",
      "events_url": "https://api.github.com/users/zr40/events{/privacy}",
      "received_events_url": "https://api.github.com/users/zr40/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-01-29T12:27:03Z",
    "updated_at": "2014-01-29T12:27:03Z",
    "body": "-1 for `on_exit` -- one might think the code would be called when the process is about to exit.\n\nMy suggestions: `leaving_scope` or `exiting_scope`.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/33580067/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/33583584",
    "html_url": "https://github.com/rust-lang/rust/pull/11905#issuecomment-33583584",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/11905",
    "id": 33583584,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMzNTgzNTg0",
    "user": {
      "login": "thestinger",
      "id": 1505226,
      "node_id": "MDQ6VXNlcjE1MDUyMjY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1505226?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/thestinger",
      "html_url": "https://github.com/thestinger",
      "followers_url": "https://api.github.com/users/thestinger/followers",
      "following_url": "https://api.github.com/users/thestinger/following{/other_user}",
      "gists_url": "https://api.github.com/users/thestinger/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/thestinger/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/thestinger/subscriptions",
      "organizations_url": "https://api.github.com/users/thestinger/orgs",
      "repos_url": "https://api.github.com/users/thestinger/repos",
      "events_url": "https://api.github.com/users/thestinger/events{/privacy}",
      "received_events_url": "https://api.github.com/users/thestinger/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-01-29T13:22:09Z",
    "updated_at": "2014-01-29T13:22:09Z",
    "body": "@Jurily: The `defer` keyword in Go is based on functions rather than block scoping, so it's not really the same thing.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/33583584/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/33584506",
    "html_url": "https://github.com/rust-lang/rust/pull/11905#issuecomment-33584506",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/11905",
    "id": 33584506,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMzNTg0NTA2",
    "user": {
      "login": "omasanori",
      "id": 167209,
      "node_id": "MDQ6VXNlcjE2NzIwOQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/167209?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/omasanori",
      "html_url": "https://github.com/omasanori",
      "followers_url": "https://api.github.com/users/omasanori/followers",
      "following_url": "https://api.github.com/users/omasanori/following{/other_user}",
      "gists_url": "https://api.github.com/users/omasanori/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/omasanori/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/omasanori/subscriptions",
      "organizations_url": "https://api.github.com/users/omasanori/orgs",
      "repos_url": "https://api.github.com/users/omasanori/repos",
      "events_url": "https://api.github.com/users/omasanori/events{/privacy}",
      "received_events_url": "https://api.github.com/users/omasanori/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-01-29T13:35:56Z",
    "updated_at": "2014-01-29T13:35:56Z",
    "body": "I'd suggest `scope_exit!` (for similarity with D's `scope(exit)`) in addition to the candidates that have been suggested already.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/33584506/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/33601789",
    "html_url": "https://github.com/rust-lang/rust/pull/11905#issuecomment-33601789",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/11905",
    "id": 33601789,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMzNjAxNzg5",
    "user": {
      "login": "alexcrichton",
      "id": 64996,
      "node_id": "MDQ6VXNlcjY0OTk2",
      "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alexcrichton",
      "html_url": "https://github.com/alexcrichton",
      "followers_url": "https://api.github.com/users/alexcrichton/followers",
      "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}",
      "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions",
      "organizations_url": "https://api.github.com/users/alexcrichton/orgs",
      "repos_url": "https://api.github.com/users/alexcrichton/repos",
      "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alexcrichton/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-01-29T16:35:04Z",
    "updated_at": "2014-01-29T16:35:04Z",
    "body": "cc #9842, which sounds like there may be soundness issues around this strategy. That being said, this is the same strategy as `finally`, so I don't think we should block on that.\n\nWhen we initially discussed scope awhile back (and with #9842), it gave us the ability to run functions on exit, failing, or success, and that seems like useful functionality. I suppose the macro could include the literal `exit` `fail` or `success` tokens. It does seem a little odd when reading for the first time:\n\n```\nfoo.lock();\nscope!(foo.unlock());\n```\n\nIt doesn't quite look like the `foo.unlock()` will happen at the _end_ of the scope.\n\n```\nscope!(exit, foo.unlock());\n```\n\nThat also looks a little silly because there's no indication of what `exit` is, sadly. All in all, this is probably worth munging for a bit to see if we can get happy with the names/syntax, but I think we should definitely merge this.\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/33601789/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/33627728",
    "html_url": "https://github.com/rust-lang/rust/pull/11905#issuecomment-33627728",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/11905",
    "id": 33627728,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMzNjI3NzI4",
    "user": {
      "login": "lilyball",
      "id": 714,
      "node_id": "MDQ6VXNlcjcxNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/714?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/lilyball",
      "html_url": "https://github.com/lilyball",
      "followers_url": "https://api.github.com/users/lilyball/followers",
      "following_url": "https://api.github.com/users/lilyball/following{/other_user}",
      "gists_url": "https://api.github.com/users/lilyball/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/lilyball/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/lilyball/subscriptions",
      "organizations_url": "https://api.github.com/users/lilyball/orgs",
      "repos_url": "https://api.github.com/users/lilyball/repos",
      "events_url": "https://api.github.com/users/lilyball/events{/privacy}",
      "received_events_url": "https://api.github.com/users/lilyball/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-01-29T20:36:01Z",
    "updated_at": "2014-01-29T20:36:01Z",
    "body": "Maybe just call it `finally!()`? Or alternatively, using `defer!()` is not terrible, even though it isn't quite the same as Go's `defer` keyword.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/33627728/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/33628053",
    "html_url": "https://github.com/rust-lang/rust/pull/11905#issuecomment-33628053",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/11905",
    "id": 33628053,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMzNjI4MDUz",
    "user": {
      "login": "lilyball",
      "id": 714,
      "node_id": "MDQ6VXNlcjcxNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/714?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/lilyball",
      "html_url": "https://github.com/lilyball",
      "followers_url": "https://api.github.com/users/lilyball/followers",
      "following_url": "https://api.github.com/users/lilyball/following{/other_user}",
      "gists_url": "https://api.github.com/users/lilyball/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/lilyball/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/lilyball/subscriptions",
      "organizations_url": "https://api.github.com/users/lilyball/orgs",
      "repos_url": "https://api.github.com/users/lilyball/repos",
      "events_url": "https://api.github.com/users/lilyball/events{/privacy}",
      "received_events_url": "https://api.github.com/users/lilyball/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-01-29T20:39:30Z",
    "updated_at": "2014-01-29T20:39:45Z",
    "body": "Reading #6801 (referenced from #9842), it sounds like fixing that issue will make this approach significantly less useful, because any upvalues referenced in the closure will become active borrows for the lifetime of the closure. This may be the same strategy as `finally`, but that was in `std::unstable` whereas this PR makes the functionality public.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/33628053/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/33646214",
    "html_url": "https://github.com/rust-lang/rust/pull/11905#issuecomment-33646214",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/11905",
    "id": 33646214,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMzNjQ2MjE0",
    "user": {
      "login": "brson",
      "id": 147214,
      "node_id": "MDQ6VXNlcjE0NzIxNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/brson",
      "html_url": "https://github.com/brson",
      "followers_url": "https://api.github.com/users/brson/followers",
      "following_url": "https://api.github.com/users/brson/following{/other_user}",
      "gists_url": "https://api.github.com/users/brson/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/brson/subscriptions",
      "organizations_url": "https://api.github.com/users/brson/orgs",
      "repos_url": "https://api.github.com/users/brson/repos",
      "events_url": "https://api.github.com/users/brson/events{/privacy}",
      "received_events_url": "https://api.github.com/users/brson/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-01-29T23:56:00Z",
    "updated_at": "2014-01-29T23:56:00Z",
    "body": "I personally prefer `finally` to `defer`. I don't understand why one would want to write their code backwards.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/33646214/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/33646456",
    "html_url": "https://github.com/rust-lang/rust/pull/11905#issuecomment-33646456",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/11905",
    "id": 33646456,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMzNjQ2NDU2",
    "user": {
      "login": "thestinger",
      "id": 1505226,
      "node_id": "MDQ6VXNlcjE1MDUyMjY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1505226?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/thestinger",
      "html_url": "https://github.com/thestinger",
      "followers_url": "https://api.github.com/users/thestinger/followers",
      "following_url": "https://api.github.com/users/thestinger/following{/other_user}",
      "gists_url": "https://api.github.com/users/thestinger/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/thestinger/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/thestinger/subscriptions",
      "organizations_url": "https://api.github.com/users/thestinger/orgs",
      "repos_url": "https://api.github.com/users/thestinger/repos",
      "events_url": "https://api.github.com/users/thestinger/events{/privacy}",
      "received_events_url": "https://api.github.com/users/thestinger/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-01-29T23:58:56Z",
    "updated_at": "2014-01-29T23:58:56Z",
    "body": "The nice thing about the D/Go style is not requiring any additional nesting.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/33646456/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/33646538",
    "html_url": "https://github.com/rust-lang/rust/pull/11905#issuecomment-33646538",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/11905",
    "id": 33646538,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMzNjQ2NTM4",
    "user": {
      "login": "brson",
      "id": 147214,
      "node_id": "MDQ6VXNlcjE0NzIxNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/brson",
      "html_url": "https://github.com/brson",
      "followers_url": "https://api.github.com/users/brson/followers",
      "following_url": "https://api.github.com/users/brson/following{/other_user}",
      "gists_url": "https://api.github.com/users/brson/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/brson/subscriptions",
      "organizations_url": "https://api.github.com/users/brson/orgs",
      "repos_url": "https://api.github.com/users/brson/repos",
      "events_url": "https://api.github.com/users/brson/events{/privacy}",
      "received_events_url": "https://api.github.com/users/brson/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-01-30T00:00:00Z",
    "updated_at": "2014-01-30T00:01:00Z",
    "body": "In some of the replacements here `scope!` comes first, and in some it is written last. Where it's written last it looks nice, but where it's written first it really looks confusing:\n\n```\n// Yay!\nlock.lock();\ndo_something_under_lock();\nscope!(lock.unlock())\n```\n\n```\n// Boo!\nscope!(lock.unlock())\nlock.lock();\ndo_something_under_lock();\n```\n\nAre there cases where borrowing forces it to come first?\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/33646538/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/33646752",
    "html_url": "https://github.com/rust-lang/rust/pull/11905#issuecomment-33646752",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/11905",
    "id": 33646752,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMzNjQ2NzUy",
    "user": {
      "login": "brson",
      "id": 147214,
      "node_id": "MDQ6VXNlcjE0NzIxNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/brson",
      "html_url": "https://github.com/brson",
      "followers_url": "https://api.github.com/users/brson/followers",
      "following_url": "https://api.github.com/users/brson/following{/other_user}",
      "gists_url": "https://api.github.com/users/brson/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/brson/subscriptions",
      "organizations_url": "https://api.github.com/users/brson/orgs",
      "repos_url": "https://api.github.com/users/brson/repos",
      "events_url": "https://api.github.com/users/brson/events{/privacy}",
      "received_events_url": "https://api.github.com/users/brson/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-01-30T00:02:55Z",
    "updated_at": "2014-01-30T00:02:55Z",
    "body": "The second isn't really even correct:\n\n```\nscope!(lock.unlock());\n// what if we fail here? the lock isn't locked\nlock.lock();\n```\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/33646752/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/33646890",
    "html_url": "https://github.com/rust-lang/rust/pull/11905#issuecomment-33646890",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/11905",
    "id": 33646890,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMzNjQ2ODkw",
    "user": {
      "login": "thestinger",
      "id": 1505226,
      "node_id": "MDQ6VXNlcjE1MDUyMjY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1505226?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/thestinger",
      "html_url": "https://github.com/thestinger",
      "followers_url": "https://api.github.com/users/thestinger/followers",
      "following_url": "https://api.github.com/users/thestinger/following{/other_user}",
      "gists_url": "https://api.github.com/users/thestinger/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/thestinger/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/thestinger/subscriptions",
      "organizations_url": "https://api.github.com/users/thestinger/orgs",
      "repos_url": "https://api.github.com/users/thestinger/repos",
      "events_url": "https://api.github.com/users/thestinger/events{/privacy}",
      "received_events_url": "https://api.github.com/users/thestinger/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-01-30T00:04:51Z",
    "updated_at": "2014-01-30T00:04:51Z",
    "body": "@brson: The first could also fail in `do_something_under_lock`. It needs to be directly before or directly after the `lock` call. It would definitely be a lot nicer to use custom destructors in any cases where it's a reused pattern.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/33646890/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/33649053",
    "html_url": "https://github.com/rust-lang/rust/pull/11905#issuecomment-33649053",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/11905",
    "id": 33649053,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMzNjQ5MDUz",
    "user": {
      "login": "huonw",
      "id": 1203825,
      "node_id": "MDQ6VXNlcjEyMDM4MjU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1203825?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/huonw",
      "html_url": "https://github.com/huonw",
      "followers_url": "https://api.github.com/users/huonw/followers",
      "following_url": "https://api.github.com/users/huonw/following{/other_user}",
      "gists_url": "https://api.github.com/users/huonw/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/huonw/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/huonw/subscriptions",
      "organizations_url": "https://api.github.com/users/huonw/orgs",
      "repos_url": "https://api.github.com/users/huonw/repos",
      "events_url": "https://api.github.com/users/huonw/events{/privacy}",
      "received_events_url": "https://api.github.com/users/huonw/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-01-30T00:38:51Z",
    "updated_at": "2014-01-30T00:38:51Z",
    "body": "The second example could be (using `finally`):\n\n``` rust\nlock.lock();\nfinally!(lock.unlock())\n\ndo_something_under_lock();\n```\n\nwhich isn't _entirely_ horrible (it's certainly better than putting it before the `.lock`).\n\n(And I completely agree with using RAII/custom destructors where it happens a lot; certainly mutex lock/unlock code would be cleaner & safer with it.)\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/33649053/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/33649787",
    "html_url": "https://github.com/rust-lang/rust/pull/11905#issuecomment-33649787",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/11905",
    "id": 33649787,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMzNjQ5Nzg3",
    "user": {
      "login": "flaper87",
      "id": 13816,
      "node_id": "MDQ6VXNlcjEzODE2",
      "avatar_url": "https://avatars.githubusercontent.com/u/13816?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/flaper87",
      "html_url": "https://github.com/flaper87",
      "followers_url": "https://api.github.com/users/flaper87/followers",
      "following_url": "https://api.github.com/users/flaper87/following{/other_user}",
      "gists_url": "https://api.github.com/users/flaper87/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/flaper87/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/flaper87/subscriptions",
      "organizations_url": "https://api.github.com/users/flaper87/orgs",
      "repos_url": "https://api.github.com/users/flaper87/repos",
      "events_url": "https://api.github.com/users/flaper87/events{/privacy}",
      "received_events_url": "https://api.github.com/users/flaper87/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-01-30T00:50:55Z",
    "updated_at": "2014-01-30T00:50:55Z",
    "body": "FWIW, I prefer `finally` as well!\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/33649787/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/33662238",
    "html_url": "https://github.com/rust-lang/rust/pull/11905#issuecomment-33662238",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/11905",
    "id": 33662238,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMzNjYyMjM4",
    "user": {
      "login": "huonw",
      "id": 1203825,
      "node_id": "MDQ6VXNlcjEyMDM4MjU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1203825?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/huonw",
      "html_url": "https://github.com/huonw",
      "followers_url": "https://api.github.com/users/huonw/followers",
      "following_url": "https://api.github.com/users/huonw/following{/other_user}",
      "gists_url": "https://api.github.com/users/huonw/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/huonw/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/huonw/subscriptions",
      "organizations_url": "https://api.github.com/users/huonw/orgs",
      "repos_url": "https://api.github.com/users/huonw/repos",
      "events_url": "https://api.github.com/users/huonw/events{/privacy}",
      "received_events_url": "https://api.github.com/users/huonw/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-01-30T05:53:56Z",
    "updated_at": "2014-01-30T05:53:56Z",
    "body": "Also, I decided to avoid `scope!(exit, ..);`, `scope!(failing, ...)` etc. to mirror D, because I thought that just using `if task::failing() {... }` (and its negation) was short enough and more flexible.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/33662238/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/33672403",
    "html_url": "https://github.com/rust-lang/rust/pull/11905#issuecomment-33672403",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/11905",
    "id": 33672403,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMzNjcyNDAz",
    "user": {
      "login": "adrientetar",
      "id": 1250894,
      "node_id": "MDQ6VXNlcjEyNTA4OTQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1250894?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/adrientetar",
      "html_url": "https://github.com/adrientetar",
      "followers_url": "https://api.github.com/users/adrientetar/followers",
      "following_url": "https://api.github.com/users/adrientetar/following{/other_user}",
      "gists_url": "https://api.github.com/users/adrientetar/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/adrientetar/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/adrientetar/subscriptions",
      "organizations_url": "https://api.github.com/users/adrientetar/orgs",
      "repos_url": "https://api.github.com/users/adrientetar/repos",
      "events_url": "https://api.github.com/users/adrientetar/events{/privacy}",
      "received_events_url": "https://api.github.com/users/adrientetar/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-01-30T09:34:54Z",
    "updated_at": "2014-01-30T09:34:54Z",
    "body": "Not speaking in terms of functionality but I like `finally` as well.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/33672403/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/33787810",
    "html_url": "https://github.com/rust-lang/rust/pull/11905#issuecomment-33787810",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/11905",
    "id": 33787810,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMzNzg3ODEw",
    "user": {
      "login": "huonw",
      "id": 1203825,
      "node_id": "MDQ6VXNlcjEyMDM4MjU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1203825?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/huonw",
      "html_url": "https://github.com/huonw",
      "followers_url": "https://api.github.com/users/huonw/followers",
      "following_url": "https://api.github.com/users/huonw/following{/other_user}",
      "gists_url": "https://api.github.com/users/huonw/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/huonw/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/huonw/subscriptions",
      "organizations_url": "https://api.github.com/users/huonw/orgs",
      "repos_url": "https://api.github.com/users/huonw/repos",
      "events_url": "https://api.github.com/users/huonw/events{/privacy}",
      "received_events_url": "https://api.github.com/users/huonw/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-01-31T11:43:41Z",
    "updated_at": "2014-01-31T11:43:41Z",
    "body": "Updated with it renamed to `finally!`, and changed the instance of the silly backward `finally!(self.release()); self.acquire()` ordering to have the `finally!` second.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/33787810/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/33860534",
    "html_url": "https://github.com/rust-lang/rust/pull/11905#issuecomment-33860534",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/11905",
    "id": 33860534,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMzODYwNTM0",
    "user": {
      "login": "lilyball",
      "id": 714,
      "node_id": "MDQ6VXNlcjcxNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/714?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/lilyball",
      "html_url": "https://github.com/lilyball",
      "followers_url": "https://api.github.com/users/lilyball/followers",
      "following_url": "https://api.github.com/users/lilyball/following{/other_user}",
      "gists_url": "https://api.github.com/users/lilyball/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/lilyball/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/lilyball/subscriptions",
      "organizations_url": "https://api.github.com/users/lilyball/orgs",
      "repos_url": "https://api.github.com/users/lilyball/repos",
      "events_url": "https://api.github.com/users/lilyball/events{/privacy}",
      "received_events_url": "https://api.github.com/users/lilyball/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-02-01T02:14:09Z",
    "updated_at": "2014-02-01T02:14:09Z",
    "body": "@nikomatsakis says he has a patch for #6801. I'm expecting it to impact `finally!()`. It would be a good idea to see how `finally!()` behaves with his patch before committing it.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/33860534/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/33860598",
    "html_url": "https://github.com/rust-lang/rust/pull/11905#issuecomment-33860598",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/11905",
    "id": 33860598,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMzODYwNTk4",
    "user": {
      "login": "huonw",
      "id": 1203825,
      "node_id": "MDQ6VXNlcjEyMDM4MjU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1203825?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/huonw",
      "html_url": "https://github.com/huonw",
      "followers_url": "https://api.github.com/users/huonw/followers",
      "following_url": "https://api.github.com/users/huonw/following{/other_user}",
      "gists_url": "https://api.github.com/users/huonw/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/huonw/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/huonw/subscriptions",
      "organizations_url": "https://api.github.com/users/huonw/orgs",
      "repos_url": "https://api.github.com/users/huonw/repos",
      "events_url": "https://api.github.com/users/huonw/events{/privacy}",
      "received_events_url": "https://api.github.com/users/huonw/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-02-01T02:16:55Z",
    "updated_at": "2014-02-01T02:16:55Z",
    "body": "Sounds good (also, this has been added to the meeting agenda).\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/33860598/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/33886236",
    "html_url": "https://github.com/rust-lang/rust/pull/11905#issuecomment-33886236",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/11905",
    "id": 33886236,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMzODg2MjM2",
    "user": {
      "login": "emberian",
      "id": 704250,
      "node_id": "MDQ6VXNlcjcwNDI1MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/704250?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/emberian",
      "html_url": "https://github.com/emberian",
      "followers_url": "https://api.github.com/users/emberian/followers",
      "following_url": "https://api.github.com/users/emberian/following{/other_user}",
      "gists_url": "https://api.github.com/users/emberian/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/emberian/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/emberian/subscriptions",
      "organizations_url": "https://api.github.com/users/emberian/orgs",
      "repos_url": "https://api.github.com/users/emberian/repos",
      "events_url": "https://api.github.com/users/emberian/events{/privacy}",
      "received_events_url": "https://api.github.com/users/emberian/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-02-01T23:07:00Z",
    "updated_at": "2014-02-01T23:07:00Z",
    "body": "The macro I wrote to do this was called `defer`: https://gist.github.com/cmr/8401403\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/33886236/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/33886973",
    "html_url": "https://github.com/rust-lang/rust/pull/11905#issuecomment-33886973",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/11905",
    "id": 33886973,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMzODg2OTcz",
    "user": {
      "login": "brson",
      "id": 147214,
      "node_id": "MDQ6VXNlcjE0NzIxNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/brson",
      "html_url": "https://github.com/brson",
      "followers_url": "https://api.github.com/users/brson/followers",
      "following_url": "https://api.github.com/users/brson/following{/other_user}",
      "gists_url": "https://api.github.com/users/brson/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/brson/subscriptions",
      "organizations_url": "https://api.github.com/users/brson/orgs",
      "repos_url": "https://api.github.com/users/brson/repos",
      "events_url": "https://api.github.com/users/brson/events{/privacy}",
      "received_events_url": "https://api.github.com/users/brson/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-02-01T23:39:28Z",
    "updated_at": "2014-02-01T23:39:28Z",
    "body": "To be clear, I prefer finally blocks to the defer pattern. I don't know whether I prefer `finally!` as the name of this macro.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/33886973/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/33887023",
    "html_url": "https://github.com/rust-lang/rust/pull/11905#issuecomment-33887023",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/11905",
    "id": 33887023,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMzODg3MDIz",
    "user": {
      "login": "emberian",
      "id": 704250,
      "node_id": "MDQ6VXNlcjcwNDI1MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/704250?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/emberian",
      "html_url": "https://github.com/emberian",
      "followers_url": "https://api.github.com/users/emberian/followers",
      "following_url": "https://api.github.com/users/emberian/following{/other_user}",
      "gists_url": "https://api.github.com/users/emberian/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/emberian/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/emberian/subscriptions",
      "organizations_url": "https://api.github.com/users/emberian/orgs",
      "repos_url": "https://api.github.com/users/emberian/repos",
      "events_url": "https://api.github.com/users/emberian/events{/privacy}",
      "received_events_url": "https://api.github.com/users/emberian/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-02-01T23:41:27Z",
    "updated_at": "2014-02-01T23:41:27Z",
    "body": "I don't know what the defer pattern is, it just seemed like the obvious\nname to me.\n\nOn Sat, Feb 1, 2014 at 6:39 PM, Brian Anderson notifications@github.comwrote:\n\n> To be clear, I prefer finally blocks to the defer pattern. I don't know\n> whether I prefer finally! as the name of this macro.\n> \n> \u2014\n> Reply to this email directly or view it on GitHubhttps://github.com/mozilla/rust/pull/11905#issuecomment-33886973\n> .\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/33887023/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/33887112",
    "html_url": "https://github.com/rust-lang/rust/pull/11905#issuecomment-33887112",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/11905",
    "id": 33887112,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMzODg3MTEy",
    "user": {
      "login": "huonw",
      "id": 1203825,
      "node_id": "MDQ6VXNlcjEyMDM4MjU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1203825?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/huonw",
      "html_url": "https://github.com/huonw",
      "followers_url": "https://api.github.com/users/huonw/followers",
      "following_url": "https://api.github.com/users/huonw/following{/other_user}",
      "gists_url": "https://api.github.com/users/huonw/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/huonw/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/huonw/subscriptions",
      "organizations_url": "https://api.github.com/users/huonw/orgs",
      "repos_url": "https://api.github.com/users/huonw/repos",
      "events_url": "https://api.github.com/users/huonw/events{/privacy}",
      "received_events_url": "https://api.github.com/users/huonw/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-02-01T23:45:08Z",
    "updated_at": "2014-02-01T23:45:08Z",
    "body": "One disadvantage of the (current) implementation of `std::unstable::finally` is it requires putting the \"normal\" code in a closure as well as the always-run part (so, e.g., `return` doesn't work), I guess something else that could work, and mirrors in the current `std::unstable::finally` more closely, is\n\n``` rust\nfinally!(/* run this */, /* then always run this*/)\n```\n\n(where the first part is expanded inline, without requiring a closure.)\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/33887112/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/33887113",
    "html_url": "https://github.com/rust-lang/rust/pull/11905#issuecomment-33887113",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/11905",
    "id": 33887113,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMzODg3MTEz",
    "user": {
      "login": "zkamsler",
      "id": 944662,
      "node_id": "MDQ6VXNlcjk0NDY2Mg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/944662?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/zkamsler",
      "html_url": "https://github.com/zkamsler",
      "followers_url": "https://api.github.com/users/zkamsler/followers",
      "following_url": "https://api.github.com/users/zkamsler/following{/other_user}",
      "gists_url": "https://api.github.com/users/zkamsler/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/zkamsler/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/zkamsler/subscriptions",
      "organizations_url": "https://api.github.com/users/zkamsler/orgs",
      "repos_url": "https://api.github.com/users/zkamsler/repos",
      "events_url": "https://api.github.com/users/zkamsler/events{/privacy}",
      "received_events_url": "https://api.github.com/users/zkamsler/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-02-01T23:45:08Z",
    "updated_at": "2014-02-01T23:45:08Z",
    "body": "I think there is a definite risk of confusion in calling it `finally`, as people may expect it to behave the same as in other languages and put it after the thing that might fail or return (as in brsons's \"Yay!\" example).\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/33887113/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/33887208",
    "html_url": "https://github.com/rust-lang/rust/pull/11905#issuecomment-33887208",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/11905",
    "id": 33887208,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMzODg3MjA4",
    "user": {
      "login": "brson",
      "id": 147214,
      "node_id": "MDQ6VXNlcjE0NzIxNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/brson",
      "html_url": "https://github.com/brson",
      "followers_url": "https://api.github.com/users/brson/followers",
      "following_url": "https://api.github.com/users/brson/following{/other_user}",
      "gists_url": "https://api.github.com/users/brson/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/brson/subscriptions",
      "organizations_url": "https://api.github.com/users/brson/orgs",
      "repos_url": "https://api.github.com/users/brson/repos",
      "events_url": "https://api.github.com/users/brson/events{/privacy}",
      "received_events_url": "https://api.github.com/users/brson/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-02-01T23:48:59Z",
    "updated_at": "2014-02-01T23:48:59Z",
    "body": "The examples here do look better as written, and most are easy to understand. It seems like where with try/finally you would write:\n\n```\ndo_thing_that_needs_to_be_reversed();\ntry {\n   do_other_stuff();\n} finally {\n    reverse_thing();\n}\n```\n\nNow you would write\n\n```\ndo_thing_that_needs_to_be_reversed();\n{\n    finally!(reverse_thing());\n    do_other_stuff();\n}\n```\n\nThis is more concise, and I can see how in these common cases it is also possibly even more clear than try/finally on a top-down reading.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/33887208/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/33944607",
    "html_url": "https://github.com/rust-lang/rust/pull/11905#issuecomment-33944607",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/11905",
    "id": 33944607,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMzOTQ0NjA3",
    "user": {
      "login": "nikomatsakis",
      "id": 155238,
      "node_id": "MDQ6VXNlcjE1NTIzOA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/155238?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nikomatsakis",
      "html_url": "https://github.com/nikomatsakis",
      "followers_url": "https://api.github.com/users/nikomatsakis/followers",
      "following_url": "https://api.github.com/users/nikomatsakis/following{/other_user}",
      "gists_url": "https://api.github.com/users/nikomatsakis/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nikomatsakis/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nikomatsakis/subscriptions",
      "organizations_url": "https://api.github.com/users/nikomatsakis/orgs",
      "repos_url": "https://api.github.com/users/nikomatsakis/repos",
      "events_url": "https://api.github.com/users/nikomatsakis/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nikomatsakis/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-02-03T11:35:17Z",
    "updated_at": "2014-02-03T11:35:17Z",
    "body": "The changes for #2202 (actually #6801) to be more precise require that if a variable is mutable, it is effectively captured by the closure. This impacts try-finally patterns that update a variable in the try block and then access it in the finally block.\n\nFor example, code like this would not compile:\n\n```\nlet mut i = 0;\n(|| {\n   ... i += 1; ...\n}).finally(|| {\n    use(i);\n});\n```\n\nI wound up adding a new `try_finally` function that worked like this:\n\n```\n/// Invokes `try_fn(v)` and then `finally_fn(v)`. Always invokes\n/// `finally_fn(v)`, even if `try_fn(v)` fails.\nfn try_finally<A>(v: &mut A, try_fn: |&mut A|, finally_fn: |&mut A|) {...}\n```\n\nThen you can translate the above code into:\n\n```\nlet mut i = 0;\ntry_finally(\n    &mut i, \n    |i| { ... *i += 1; ... },\n    |i| { ... *i ... });\n```\n\nYou can extend this to multiple variables using a tuple or some such but I never had to. An alternative is to use a `Cell` to share data. I'm not sure how this interacts with the proposed macro.\n\nI hope to write up the details in a blog post but I thought I'd put up a summary here briefly. There _is_ a bit of wiggle room here -- in an earlier version, I permitted (in some cases) variables to be mutated in one closure but read in another, so long as they were not mutated in both, this was effectively bringing back const (read-only but not immutable) borrows. But I eventually removed it because it wasn't used that frequently. This is something I had hoped to write up and discuss, there are some tradeoffs involved.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/33944607/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/33952462",
    "html_url": "https://github.com/rust-lang/rust/pull/11905#issuecomment-33952462",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/11905",
    "id": 33952462,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMzOTUyNDYy",
    "user": {
      "login": "ghost",
      "id": 10137,
      "node_id": "MDQ6VXNlcjEwMTM3",
      "avatar_url": "https://avatars.githubusercontent.com/u/10137?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ghost",
      "html_url": "https://github.com/ghost",
      "followers_url": "https://api.github.com/users/ghost/followers",
      "following_url": "https://api.github.com/users/ghost/following{/other_user}",
      "gists_url": "https://api.github.com/users/ghost/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ghost/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ghost/subscriptions",
      "organizations_url": "https://api.github.com/users/ghost/orgs",
      "repos_url": "https://api.github.com/users/ghost/repos",
      "events_url": "https://api.github.com/users/ghost/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ghost/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-02-03T13:06:37Z",
    "updated_at": "2014-02-03T13:09:24Z",
    "body": "Since we're going for RAII semantics here, why not call it `raii!` or even `drop!`?\n",
    "author_association": "NONE",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/33952462/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/34792136",
    "html_url": "https://github.com/rust-lang/rust/pull/11905#issuecomment-34792136",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/11905",
    "id": 34792136,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM0NzkyMTM2",
    "user": {
      "login": "alexcrichton",
      "id": 64996,
      "node_id": "MDQ6VXNlcjY0OTk2",
      "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alexcrichton",
      "html_url": "https://github.com/alexcrichton",
      "followers_url": "https://api.github.com/users/alexcrichton/followers",
      "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}",
      "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions",
      "organizations_url": "https://api.github.com/users/alexcrichton/orgs",
      "repos_url": "https://api.github.com/users/alexcrichton/repos",
      "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alexcrichton/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-02-11T19:03:49Z",
    "updated_at": "2014-02-11T19:03:49Z",
    "body": "We [decided in today's meeting](https://github.com/mozilla/rust/wiki/Meeting-weekly-2014-02-11#wiki-finally-macro) to move towards this macro, but call it `defer!` instead.\n\n@huonw, are you ok implementing that change?\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/34792136/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/34815300",
    "html_url": "https://github.com/rust-lang/rust/pull/11905#issuecomment-34815300",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/11905",
    "id": 34815300,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM0ODE1MzAw",
    "user": {
      "login": "ben0x539",
      "id": 24142,
      "node_id": "MDQ6VXNlcjI0MTQy",
      "avatar_url": "https://avatars.githubusercontent.com/u/24142?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ben0x539",
      "html_url": "https://github.com/ben0x539",
      "followers_url": "https://api.github.com/users/ben0x539/followers",
      "following_url": "https://api.github.com/users/ben0x539/following{/other_user}",
      "gists_url": "https://api.github.com/users/ben0x539/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ben0x539/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ben0x539/subscriptions",
      "organizations_url": "https://api.github.com/users/ben0x539/orgs",
      "repos_url": "https://api.github.com/users/ben0x539/repos",
      "events_url": "https://api.github.com/users/ben0x539/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ben0x539/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-02-11T22:19:28Z",
    "updated_at": "2014-02-11T22:19:28Z",
    "body": "Are you strongly opposed to a built-in `try`-`finally` construct? The complexity of having to move or borrow values into closures might justify special-casing this arguably common pattern.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/34815300/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/34815589",
    "html_url": "https://github.com/rust-lang/rust/pull/11905#issuecomment-34815589",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/11905",
    "id": 34815589,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM0ODE1NTg5",
    "user": {
      "login": "thestinger",
      "id": 1505226,
      "node_id": "MDQ6VXNlcjE1MDUyMjY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1505226?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/thestinger",
      "html_url": "https://github.com/thestinger",
      "followers_url": "https://api.github.com/users/thestinger/followers",
      "following_url": "https://api.github.com/users/thestinger/following{/other_user}",
      "gists_url": "https://api.github.com/users/thestinger/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/thestinger/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/thestinger/subscriptions",
      "organizations_url": "https://api.github.com/users/thestinger/orgs",
      "repos_url": "https://api.github.com/users/thestinger/repos",
      "events_url": "https://api.github.com/users/thestinger/events{/privacy}",
      "received_events_url": "https://api.github.com/users/thestinger/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-02-11T22:22:12Z",
    "updated_at": "2014-02-11T22:25:32Z",
    "body": "I think built-in scope guards would make sense, but not another block-based control structure. Rust shouldn't take a step backwards from D and Go by requiring a bunch of nesting for this. Stack-based once functions are going to feel like a missing feature if closures are used for RAII patterns like this. They were left out with the rationale that we weren't going to do this anymore...\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/34815589/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/34817970",
    "html_url": "https://github.com/rust-lang/rust/pull/11905#issuecomment-34817970",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/11905",
    "id": 34817970,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM0ODE3OTcw",
    "user": {
      "login": "ben0x539",
      "id": 24142,
      "node_id": "MDQ6VXNlcjI0MTQy",
      "avatar_url": "https://avatars.githubusercontent.com/u/24142?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ben0x539",
      "html_url": "https://github.com/ben0x539",
      "followers_url": "https://api.github.com/users/ben0x539/followers",
      "following_url": "https://api.github.com/users/ben0x539/following{/other_user}",
      "gists_url": "https://api.github.com/users/ben0x539/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ben0x539/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ben0x539/subscriptions",
      "organizations_url": "https://api.github.com/users/ben0x539/orgs",
      "repos_url": "https://api.github.com/users/ben0x539/repos",
      "events_url": "https://api.github.com/users/ben0x539/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ben0x539/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-02-11T22:46:16Z",
    "updated_at": "2014-02-11T22:46:16Z",
    "body": "`finally` blocks have the advantage of being familiar and also of coming after the code they get executed after. :/\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/34817970/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/34818953",
    "html_url": "https://github.com/rust-lang/rust/pull/11905#issuecomment-34818953",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/11905",
    "id": 34818953,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM0ODE4OTUz",
    "user": {
      "login": "thestinger",
      "id": 1505226,
      "node_id": "MDQ6VXNlcjE1MDUyMjY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1505226?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/thestinger",
      "html_url": "https://github.com/thestinger",
      "followers_url": "https://api.github.com/users/thestinger/followers",
      "following_url": "https://api.github.com/users/thestinger/following{/other_user}",
      "gists_url": "https://api.github.com/users/thestinger/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/thestinger/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/thestinger/subscriptions",
      "organizations_url": "https://api.github.com/users/thestinger/orgs",
      "repos_url": "https://api.github.com/users/thestinger/repos",
      "events_url": "https://api.github.com/users/thestinger/events{/privacy}",
      "received_events_url": "https://api.github.com/users/thestinger/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-02-11T22:56:43Z",
    "updated_at": "2014-02-11T22:58:23Z",
    "body": "C++ doesn't have `finally`, but scope guards do exist as an idiom there. A `finally` block may be more familiar to Java or Python programmers but it's less familiar to a D, Go or C++ programmer. I don't think it's a valid argument, especially since Rust wants to appeal to C++ programmers.\n\nRust already has destructors, so the RAII idiom is already part of the language. Stack-based destructors are an idiom every Rust programmer is familiar with.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/34818953/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/34821477",
    "html_url": "https://github.com/rust-lang/rust/pull/11905#issuecomment-34821477",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/11905",
    "id": 34821477,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM0ODIxNDc3",
    "user": {
      "login": "ben0x539",
      "id": 24142,
      "node_id": "MDQ6VXNlcjI0MTQy",
      "avatar_url": "https://avatars.githubusercontent.com/u/24142?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ben0x539",
      "html_url": "https://github.com/ben0x539",
      "followers_url": "https://api.github.com/users/ben0x539/followers",
      "following_url": "https://api.github.com/users/ben0x539/following{/other_user}",
      "gists_url": "https://api.github.com/users/ben0x539/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ben0x539/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ben0x539/subscriptions",
      "organizations_url": "https://api.github.com/users/ben0x539/orgs",
      "repos_url": "https://api.github.com/users/ben0x539/repos",
      "events_url": "https://api.github.com/users/ben0x539/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ben0x539/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-02-11T23:26:30Z",
    "updated_at": "2014-02-11T23:26:30Z",
    "body": "I'd expect C++ programmers to be familiar with `finally` from casual exposure to either of Java, C#, Javascript, Python, PHP, D, a dozen others I'm not aware of, moral equivalents in Ruby and maybe Haskell, etc, and to have written C++ code to emulate `finally` one way or the other.\n\nOn the other hand, non-C++ programmers potentially interested in Rust are a lot less likely to be familiar/comfortable with the hoops C++ programmers jump through to emulate `finally`.\n\nOf course maybe I'm completely off base with that, or maybe C++ programmers make up such an overwhelming majority of the Rust demographic that it doesn't matter anyway, but I think it's worth considering just as one aspect among many contributing to this decision.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/34821477/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/34822556",
    "html_url": "https://github.com/rust-lang/rust/pull/11905#issuecomment-34822556",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/11905",
    "id": 34822556,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM0ODIyNTU2",
    "user": {
      "login": "thestinger",
      "id": 1505226,
      "node_id": "MDQ6VXNlcjE1MDUyMjY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1505226?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/thestinger",
      "html_url": "https://github.com/thestinger",
      "followers_url": "https://api.github.com/users/thestinger/followers",
      "following_url": "https://api.github.com/users/thestinger/following{/other_user}",
      "gists_url": "https://api.github.com/users/thestinger/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/thestinger/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/thestinger/subscriptions",
      "organizations_url": "https://api.github.com/users/thestinger/orgs",
      "repos_url": "https://api.github.com/users/thestinger/repos",
      "events_url": "https://api.github.com/users/thestinger/events{/privacy}",
      "received_events_url": "https://api.github.com/users/thestinger/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-02-11T23:40:43Z",
    "updated_at": "2014-02-11T23:43:07Z",
    "body": "> On the other hand, non-C++ programmers potentially interested in Rust are a lot less likely to be familiar/comfortable with the hoops C++ programmers jump through to emulate `finally`.\n\nThat's a mischaracterization of scope guards. They're not an _emulation_ of `finally` but rather a way of running code at the end of any block without introducing extra nesting.\n\n> Java, C#, Javascript, Python, PHP, D\n\nD has scope guards and they're almost always regarded as a far better option than `try` by the D community. Avoiding nesting and keeping the cleanup code near the initialization is a good thing. Python has `with` statements which are somewhat similar too, but don't work for ad-hoc cases like scope guards so they're more like explicit destructors.\n\n> Of course maybe I'm completely off base with that, or maybe C++ programmers make up such an overwhelming majority of the Rust demographic that it doesn't matter anyway, but I think it's worth considering just as one aspect among many contributing to this decision.\n\nScope guards avoid nesting, are more familiar to C++ programmers and would only require one keyword if they were included in the language rather than as a macro. What is the advantage of `finally`, beyond your familiarity with it?\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/34822556/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/34830585",
    "html_url": "https://github.com/rust-lang/rust/pull/11905#issuecomment-34830585",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/11905",
    "id": 34830585,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM0ODMwNTg1",
    "user": {
      "login": "ben0x539",
      "id": 24142,
      "node_id": "MDQ6VXNlcjI0MTQy",
      "avatar_url": "https://avatars.githubusercontent.com/u/24142?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ben0x539",
      "html_url": "https://github.com/ben0x539",
      "followers_url": "https://api.github.com/users/ben0x539/followers",
      "following_url": "https://api.github.com/users/ben0x539/following{/other_user}",
      "gists_url": "https://api.github.com/users/ben0x539/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ben0x539/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ben0x539/subscriptions",
      "organizations_url": "https://api.github.com/users/ben0x539/orgs",
      "repos_url": "https://api.github.com/users/ben0x539/repos",
      "events_url": "https://api.github.com/users/ben0x539/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ben0x539/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-02-12T01:48:28Z",
    "updated_at": "2014-02-12T01:48:28Z",
    "body": "@thestinger I don't have anything to add beyond comments already made in this thread.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/34830585/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/34854749",
    "html_url": "https://github.com/rust-lang/rust/pull/11905#issuecomment-34854749",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/11905",
    "id": 34854749,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM0ODU0NzQ5",
    "user": {
      "login": "huonw",
      "id": 1203825,
      "node_id": "MDQ6VXNlcjEyMDM4MjU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1203825?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/huonw",
      "html_url": "https://github.com/huonw",
      "followers_url": "https://api.github.com/users/huonw/followers",
      "following_url": "https://api.github.com/users/huonw/following{/other_user}",
      "gists_url": "https://api.github.com/users/huonw/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/huonw/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/huonw/subscriptions",
      "organizations_url": "https://api.github.com/users/huonw/orgs",
      "repos_url": "https://api.github.com/users/huonw/repos",
      "events_url": "https://api.github.com/users/huonw/events{/privacy}",
      "received_events_url": "https://api.github.com/users/huonw/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-02-12T10:07:51Z",
    "updated_at": "2014-02-12T10:07:51Z",
    "body": "> We decided in today's meeting to move towards this macro, but call it defer! instead.\n> \n> @huonw, are you ok implementing that change?\n\nYes, although I guess https://github.com/mozilla/rust/pull/12158 will make this less useful unless the macro changes to mirror the `try_finally` function defined there.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/34854749/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/34946861",
    "html_url": "https://github.com/rust-lang/rust/pull/11905#issuecomment-34946861",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/11905",
    "id": 34946861,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM0OTQ2ODYx",
    "user": {
      "login": "huonw",
      "id": 1203825,
      "node_id": "MDQ6VXNlcjEyMDM4MjU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1203825?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/huonw",
      "html_url": "https://github.com/huonw",
      "followers_url": "https://api.github.com/users/huonw/followers",
      "following_url": "https://api.github.com/users/huonw/following{/other_user}",
      "gists_url": "https://api.github.com/users/huonw/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/huonw/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/huonw/subscriptions",
      "organizations_url": "https://api.github.com/users/huonw/orgs",
      "repos_url": "https://api.github.com/users/huonw/repos",
      "events_url": "https://api.github.com/users/huonw/events{/privacy}",
      "received_events_url": "https://api.github.com/users/huonw/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-02-13T04:12:32Z",
    "updated_at": "2014-02-13T04:12:32Z",
    "body": "> although I guess #12158 will make this less useful unless the macro changes to mirror the try_finally function defined there.\n\nI was correct: it seems like the fact that closures are now correct(er) has sunk the neatness of this macro. Possible solutions:\n- Capture the state explicitly, returning a mutable reference.\n  \n  ``` rust\n  (|| { loop { i += 1; /* ... */ } }).finally(|| println!(\"i = {}\", i));\n  // becomes\n  let mut i = 0;\n  let ptr_to_i = defer!(i, println!(\"I = {}\", i));\n  loop {\n      *ptr_to_i += 1;\n      // ...\n  }\n  ```\n  \n  (Probably won't actually work, since I don't think there's a way to get the guard to last long enough, or get the `i` references inside the `defer!` code to be rewritten to point to the correct variable.)\n- Require the use of `Cell` (same example as before):\n  \n  ``` rust\n  let mut i = Cell::new(0);\n  defer!(println!(\"i = {}\", i.get()));\n  loop { \n      i.set(i.get() + 1);\n      // ...\n  }\n  ```\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/34946861/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/34988782",
    "html_url": "https://github.com/rust-lang/rust/pull/11905#issuecomment-34988782",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/11905",
    "id": 34988782,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM0OTg4Nzgy",
    "user": {
      "login": "nikomatsakis",
      "id": 155238,
      "node_id": "MDQ6VXNlcjE1NTIzOA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/155238?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nikomatsakis",
      "html_url": "https://github.com/nikomatsakis",
      "followers_url": "https://api.github.com/users/nikomatsakis/followers",
      "following_url": "https://api.github.com/users/nikomatsakis/following{/other_user}",
      "gists_url": "https://api.github.com/users/nikomatsakis/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nikomatsakis/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nikomatsakis/subscriptions",
      "organizations_url": "https://api.github.com/users/nikomatsakis/orgs",
      "repos_url": "https://api.github.com/users/nikomatsakis/repos",
      "events_url": "https://api.github.com/users/nikomatsakis/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nikomatsakis/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-02-13T15:27:16Z",
    "updated_at": "2014-02-13T15:27:16Z",
    "body": "@huonw Yeah, it's unfortunate, though I don't anticipate an easy solution. In the meeting we had assumed the macro would only apply to cases where there is no mutable state shared between the two. Possibly the \"call out the mutate state\" approach could be possibly made to work, though I expect you'd have to write `*i` inside the macro (as you noted).\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/34988782/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/35058612",
    "html_url": "https://github.com/rust-lang/rust/pull/11905#issuecomment-35058612",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/11905",
    "id": 35058612,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM1MDU4NjEy",
    "user": {
      "login": "huonw",
      "id": 1203825,
      "node_id": "MDQ6VXNlcjEyMDM4MjU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1203825?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/huonw",
      "html_url": "https://github.com/huonw",
      "followers_url": "https://api.github.com/users/huonw/followers",
      "following_url": "https://api.github.com/users/huonw/following{/other_user}",
      "gists_url": "https://api.github.com/users/huonw/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/huonw/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/huonw/subscriptions",
      "organizations_url": "https://api.github.com/users/huonw/orgs",
      "repos_url": "https://api.github.com/users/huonw/repos",
      "events_url": "https://api.github.com/users/huonw/events{/privacy}",
      "received_events_url": "https://api.github.com/users/huonw/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-02-14T05:57:55Z",
    "updated_at": "2014-02-14T05:57:55Z",
    "body": "I think this is less valuable now, and is better effected by changes like https://github.com/mozilla/rust/pull/12235.\n\n(Also, the queue is huge and I'm not going to update this right now... closing.)\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/35058612/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
