{
  "url": "https://api.github.com/repos/rust-lang/rust/issues/4070",
  "repository_url": "https://api.github.com/repos/rust-lang/rust",
  "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/4070/labels{/name}",
  "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/4070/comments",
  "events_url": "https://api.github.com/repos/rust-lang/rust/issues/4070/events",
  "html_url": "https://github.com/rust-lang/rust/pull/4070",
  "id": 8825664,
  "node_id": "MDExOlB1bGxSZXF1ZXN0MzE3ODE0Mw==",
  "number": 4070,
  "title": "Trait inheritance for bounded type parameters",
  "user": {
    "login": "brson",
    "id": 147214,
    "node_id": "MDQ6VXNlcjE0NzIxNA==",
    "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/brson",
    "html_url": "https://github.com/brson",
    "followers_url": "https://api.github.com/users/brson/followers",
    "following_url": "https://api.github.com/users/brson/following{/other_user}",
    "gists_url": "https://api.github.com/users/brson/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/brson/subscriptions",
    "organizations_url": "https://api.github.com/users/brson/orgs",
    "repos_url": "https://api.github.com/users/brson/repos",
    "events_url": "https://api.github.com/users/brson/events{/privacy}",
    "received_events_url": "https://api.github.com/users/brson/received_events",
    "type": "User",
    "user_view_type": "public",
    "site_admin": false
  },
  "labels": [],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [],
  "milestone": null,
  "comments": 9,
  "created_at": "2012-11-29T19:35:35Z",
  "updated_at": "2014-07-27T22:21:46Z",
  "closed_at": "2012-11-30T02:17:03Z",
  "author_association": "CONTRIBUTOR",
  "type": null,
  "active_lock_reason": null,
  "draft": false,
  "pull_request": {
    "url": "https://api.github.com/repos/rust-lang/rust/pulls/4070",
    "html_url": "https://github.com/rust-lang/rust/pull/4070",
    "diff_url": "https://github.com/rust-lang/rust/pull/4070.diff",
    "patch_url": "https://github.com/rust-lang/rust/pull/4070.patch",
    "merged_at": null
  },
  "body": "r? @pcwalton\n\nThis makes trait inheritance work for lots of test cases involving bounded type parameters, type substitutions and static methods.\n\nHere's one with type substitutions: https://github.com/brson/rust/blob/39dbf4fe74925b1c238c8bc82911e85fd91c3d0b/src/test/run-pass/trait-inheritance-overloading.rs\n\nAnd one with static methods: https://github.com/brson/rust/blob/39dbf4fe74925b1c238c8bc82911e85fd91c3d0b/src/test/run-pass/trait-inheritance-static2.rs\n\nThe basic strategy it uses is to expand bound lists to include their supertraits, in\n\n```\ntrait A { } trait B: A { }\nfn<T: B>() { }\n```\n\n`<T: B>` is treated in the internal vtable calculations as `<T: B A>`. This is made easier and more obvious by the limitation that each impl implements a single trait, not that trait and its supertraits.\n\n```\ntrait A { fn f() }\ntrait B: A { fn g() }\n\nimpl S: A { fn f() }\nimpl S: B { fn g() }\n```\n\nThis limitation makes the implementation straightforword and has no new implications for coherence. `trait B: A` just means that to instantiate B there must also be an impl of A. The trait inheritance list has strong parallels to the bounded typaram list.\n\nI still don't understand type substitutions and why [`lookup_vtables`](https://github.com/brson/rust/blob/39dbf4fe74925b1c238c8bc82911e85fd91c3d0b/src/librustc/middle/typeck/check/vtable.rs#L52) and [`push_inherent_candidates_for_param`](https://github.com/brson/rust/blob/39dbf4fe74925b1c238c8bc82911e85fd91c3d0b/src/librustc/middle/typeck/check/method.rs#L308) do their substitutions differently. You can see that `push_inherent_candidates_for_param` is the only code that does the trait hierarchy traversal that doesn't use the new `iter_bound_traits_and_supertraits` code because it needs to thread substitutions through. I could keep going and try to abstract `iter_bound_traits_and_supertraits` into a generic fold but I figure now is the time to get review and see if this is looking ok.\n\nFuture work:\n- Ensure that all supertraits have impls when implementing a trait. i.e. if I define `impl S: B { }` there should also be an `impl S: A { }` somewhere. This isn't required for soundness since the lack of A will be detected when somebody tries to actually use `S` as `A`, but it makes sense to enforce.\n- Objects and inheritance. They don't work yet.\n- Failure test cases\n",
  "closed_by": {
    "login": "brson",
    "id": 147214,
    "node_id": "MDQ6VXNlcjE0NzIxNA==",
    "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/brson",
    "html_url": "https://github.com/brson",
    "followers_url": "https://api.github.com/users/brson/followers",
    "following_url": "https://api.github.com/users/brson/following{/other_user}",
    "gists_url": "https://api.github.com/users/brson/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/brson/subscriptions",
    "organizations_url": "https://api.github.com/users/brson/orgs",
    "repos_url": "https://api.github.com/users/brson/repos",
    "events_url": "https://api.github.com/users/brson/events{/privacy}",
    "received_events_url": "https://api.github.com/users/brson/received_events",
    "type": "User",
    "user_view_type": "public",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/4070/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/4070/timeline",
  "performed_via_github_app": null,
  "state_reason": null,
  "_meta": {
    "type": "pr"
  }
}
