[
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/144067199",
    "html_url": "https://github.com/rust-lang/rust/issues/28728#issuecomment-144067199",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28728",
    "id": 144067199,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE0NDA2NzE5OQ==",
    "user": {
      "login": "ranma42",
      "id": 1506030,
      "node_id": "MDQ6VXNlcjE1MDYwMzA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1506030?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ranma42",
      "html_url": "https://github.com/ranma42",
      "followers_url": "https://api.github.com/users/ranma42/followers",
      "following_url": "https://api.github.com/users/ranma42/following{/other_user}",
      "gists_url": "https://api.github.com/users/ranma42/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ranma42/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ranma42/subscriptions",
      "organizations_url": "https://api.github.com/users/ranma42/orgs",
      "repos_url": "https://api.github.com/users/ranma42/repos",
      "events_url": "https://api.github.com/users/ranma42/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ranma42/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-09-29T13:51:38Z",
    "updated_at": "2015-09-29T13:51:38Z",
    "body": "The LLVM IR of the optimised code is\n\n``` llvm\n; Function Attrs: noreturn nounwind readnone uwtable\ndefine internal void @_ZN4main20h5ec738167109b800UaaE() unnamed_addr #0 {\nentry-block:\n  unreachable\n}\n```\n\nThis kind of optimisation breaks the main assumption that should normally hold on uninhabited types: it should be impossible to have a value of that type.\nrust-lang/rfcs#1216 proposes to explicitly handle such types in Rust. It might be effective in ensuring that LLVM never has to handle them and in injecting the appropriate code to ensure divergence when needed (IIUIC this could be achieved with appropriate attributes or intrinsic calls).\nThis topic has also been recently discussed in the LLVM mailing list: http://lists.llvm.org/pipermail/llvm-dev/2015-July/088095.html\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/144067199/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/144102428",
    "html_url": "https://github.com/rust-lang/rust/issues/28728#issuecomment-144102428",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28728",
    "id": 144102428,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE0NDEwMjQyOA==",
    "user": {
      "login": "alexcrichton",
      "id": 64996,
      "node_id": "MDQ6VXNlcjY0OTk2",
      "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alexcrichton",
      "html_url": "https://github.com/alexcrichton",
      "followers_url": "https://api.github.com/users/alexcrichton/followers",
      "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}",
      "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions",
      "organizations_url": "https://api.github.com/users/alexcrichton/orgs",
      "repos_url": "https://api.github.com/users/alexcrichton/repos",
      "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alexcrichton/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-09-29T15:57:11Z",
    "updated_at": "2015-09-29T15:57:11Z",
    "body": "triage: I-nominated\n\nSeems bad! If LLVM doesn't have a way to say \"yes, this loop really is infinite\" though then we may just have to sit-and-wait for the upstream discussion to settle.\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/144102428/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/144110367",
    "html_url": "https://github.com/rust-lang/rust/issues/28728#issuecomment-144110367",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28728",
    "id": 144110367,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE0NDExMDM2Nw==",
    "user": {
      "login": "ranma42",
      "id": 1506030,
      "node_id": "MDQ6VXNlcjE1MDYwMzA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1506030?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ranma42",
      "html_url": "https://github.com/ranma42",
      "followers_url": "https://api.github.com/users/ranma42/followers",
      "following_url": "https://api.github.com/users/ranma42/following{/other_user}",
      "gists_url": "https://api.github.com/users/ranma42/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ranma42/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ranma42/subscriptions",
      "organizations_url": "https://api.github.com/users/ranma42/orgs",
      "repos_url": "https://api.github.com/users/ranma42/repos",
      "events_url": "https://api.github.com/users/ranma42/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ranma42/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-09-29T16:22:22Z",
    "updated_at": "2015-09-29T16:32:31Z",
    "body": "A way to prevent infinite loops from being optimised away is to add `unsafe {asm!(\"\" :::: \"volatile\")}` inside of them. This is similar to the `llvm.noop.sideeffect` intrinsic that has been proposed in the LLVM mailing list, but it might prevent some optimisations.\nIn order to avoid the performance loss and to still guarantee that diverging functions/loops are not optimised away, I believe that it should be sufficient to insert an empty non-optimisable loop (i.e. `loop { unsafe { asm!(\"\" :::: \"volatile\") } }`) if uninhabited values are in scope.\nIf LLVM optimises the code which should diverge to the point that it does not diverge anymore, such loops will ensure that the control flow is still unable to proceed.\nIn \"lucky\" case in which LLVM is unable to optimise the diverging code, such loop will be removed by DCE.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/144110367/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/144116122",
    "html_url": "https://github.com/rust-lang/rust/issues/28728#issuecomment-144116122",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28728",
    "id": 144116122,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE0NDExNjEyMg==",
    "user": {
      "login": "geofft",
      "id": 74644,
      "node_id": "MDQ6VXNlcjc0NjQ0",
      "avatar_url": "https://avatars.githubusercontent.com/u/74644?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/geofft",
      "html_url": "https://github.com/geofft",
      "followers_url": "https://api.github.com/users/geofft/followers",
      "following_url": "https://api.github.com/users/geofft/following{/other_user}",
      "gists_url": "https://api.github.com/users/geofft/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/geofft/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/geofft/subscriptions",
      "organizations_url": "https://api.github.com/users/geofft/orgs",
      "repos_url": "https://api.github.com/users/geofft/repos",
      "events_url": "https://api.github.com/users/geofft/events{/privacy}",
      "received_events_url": "https://api.github.com/users/geofft/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-09-29T16:44:47Z",
    "updated_at": "2015-09-29T16:44:47Z",
    "body": "Is this related to #18785? That one's about infinite recursion to be UB, but it sounds like the fundamental cause might be similar: LLVM doesn't consider not halting to be a side effect, so if a function has no side effects other than not halting, it's happy to optimize it away.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/144116122/reactions",
      "total_count": 4,
      "+1": 4,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/144117083",
    "html_url": "https://github.com/rust-lang/rust/issues/28728#issuecomment-144117083",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28728",
    "id": 144117083,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE0NDExNzA4Mw==",
    "user": {
      "login": "arielb1",
      "id": 1830974,
      "node_id": "MDQ6VXNlcjE4MzA5NzQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1830974?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/arielb1",
      "html_url": "https://github.com/arielb1",
      "followers_url": "https://api.github.com/users/arielb1/followers",
      "following_url": "https://api.github.com/users/arielb1/following{/other_user}",
      "gists_url": "https://api.github.com/users/arielb1/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/arielb1/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/arielb1/subscriptions",
      "organizations_url": "https://api.github.com/users/arielb1/orgs",
      "repos_url": "https://api.github.com/users/arielb1/repos",
      "events_url": "https://api.github.com/users/arielb1/events{/privacy}",
      "received_events_url": "https://api.github.com/users/arielb1/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-09-29T16:46:37Z",
    "updated_at": "2015-09-29T16:46:37Z",
    "body": "@geofft \n\nIt's the same issue.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/144117083/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/144117572",
    "html_url": "https://github.com/rust-lang/rust/issues/28728#issuecomment-144117572",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28728",
    "id": 144117572,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE0NDExNzU3Mg==",
    "user": {
      "login": "RalfJung",
      "id": 330628,
      "node_id": "MDQ6VXNlcjMzMDYyOA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/330628?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/RalfJung",
      "html_url": "https://github.com/RalfJung",
      "followers_url": "https://api.github.com/users/RalfJung/followers",
      "following_url": "https://api.github.com/users/RalfJung/following{/other_user}",
      "gists_url": "https://api.github.com/users/RalfJung/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/RalfJung/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/RalfJung/subscriptions",
      "organizations_url": "https://api.github.com/users/RalfJung/orgs",
      "repos_url": "https://api.github.com/users/RalfJung/repos",
      "events_url": "https://api.github.com/users/RalfJung/events{/privacy}",
      "received_events_url": "https://api.github.com/users/RalfJung/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-09-29T16:48:21Z",
    "updated_at": "2015-09-29T16:48:21Z",
    "body": "Yes, looks like it's the same. Further down that issue, they show how to get `undef`, from which I assume it's not hard to make a (seemingly safe) program crash.\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/144117572/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/144147027",
    "html_url": "https://github.com/rust-lang/rust/issues/28728#issuecomment-144147027",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28728",
    "id": 144147027,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE0NDE0NzAyNw==",
    "user": {
      "login": "simnalamburt",
      "id": 4435445,
      "node_id": "MDQ6VXNlcjQ0MzU0NDU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4435445?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/simnalamburt",
      "html_url": "https://github.com/simnalamburt",
      "followers_url": "https://api.github.com/users/simnalamburt/followers",
      "following_url": "https://api.github.com/users/simnalamburt/following{/other_user}",
      "gists_url": "https://api.github.com/users/simnalamburt/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/simnalamburt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/simnalamburt/subscriptions",
      "organizations_url": "https://api.github.com/users/simnalamburt/orgs",
      "repos_url": "https://api.github.com/users/simnalamburt/repos",
      "events_url": "https://api.github.com/users/simnalamburt/events{/privacy}",
      "received_events_url": "https://api.github.com/users/simnalamburt/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-09-29T18:27:29Z",
    "updated_at": "2015-09-29T18:27:29Z",
    "body": ":+1:\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/144147027/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/144166095",
    "html_url": "https://github.com/rust-lang/rust/issues/28728#issuecomment-144166095",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28728",
    "id": 144166095,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE0NDE2NjA5NQ==",
    "user": {
      "login": "ranma42",
      "id": 1506030,
      "node_id": "MDQ6VXNlcjE1MDYwMzA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1506030?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ranma42",
      "html_url": "https://github.com/ranma42",
      "followers_url": "https://api.github.com/users/ranma42/followers",
      "following_url": "https://api.github.com/users/ranma42/following{/other_user}",
      "gists_url": "https://api.github.com/users/ranma42/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ranma42/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ranma42/subscriptions",
      "organizations_url": "https://api.github.com/users/ranma42/orgs",
      "repos_url": "https://api.github.com/users/ranma42/repos",
      "events_url": "https://api.github.com/users/ranma42/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ranma42/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-09-29T19:36:31Z",
    "updated_at": "2015-09-29T19:36:31Z",
    "body": "Crash, or, possibly even worse heartbleed https://play.rust-lang.org/?gist=15a325a795244192bdce&version=stable\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/144166095/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/144834056",
    "html_url": "https://github.com/rust-lang/rust/issues/28728#issuecomment-144834056",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28728",
    "id": 144834056,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE0NDgzNDA1Ng==",
    "user": {
      "login": "nikomatsakis",
      "id": 155238,
      "node_id": "MDQ6VXNlcjE1NTIzOA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/155238?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nikomatsakis",
      "html_url": "https://github.com/nikomatsakis",
      "followers_url": "https://api.github.com/users/nikomatsakis/followers",
      "following_url": "https://api.github.com/users/nikomatsakis/following{/other_user}",
      "gists_url": "https://api.github.com/users/nikomatsakis/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nikomatsakis/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nikomatsakis/subscriptions",
      "organizations_url": "https://api.github.com/users/nikomatsakis/orgs",
      "repos_url": "https://api.github.com/users/nikomatsakis/repos",
      "events_url": "https://api.github.com/users/nikomatsakis/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nikomatsakis/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-10-01T20:10:23Z",
    "updated_at": "2015-10-01T20:10:23Z",
    "body": "So I've been wondering how long until somebody reports this. :) In my opinion, the best solution would of course be if we could tell LLVM not to be so aggressive about potentially infinite loops. Otherwise, the only thing I think we can do is to do a conservative analysis in Rust itself that determines whether:\n1. the loop will terminate OR\n2. the loop will have side-effects (I/O operations etc, I forget precisely how this is defined in C)\n\nEither of this should be enough to avoid undefined behavior.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/144834056/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/144834431",
    "html_url": "https://github.com/rust-lang/rust/issues/28728#issuecomment-144834431",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28728",
    "id": 144834431,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE0NDgzNDQzMQ==",
    "user": {
      "login": "nikomatsakis",
      "id": 155238,
      "node_id": "MDQ6VXNlcjE1NTIzOA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/155238?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nikomatsakis",
      "html_url": "https://github.com/nikomatsakis",
      "followers_url": "https://api.github.com/users/nikomatsakis/followers",
      "following_url": "https://api.github.com/users/nikomatsakis/following{/other_user}",
      "gists_url": "https://api.github.com/users/nikomatsakis/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nikomatsakis/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nikomatsakis/subscriptions",
      "organizations_url": "https://api.github.com/users/nikomatsakis/orgs",
      "repos_url": "https://api.github.com/users/nikomatsakis/repos",
      "events_url": "https://api.github.com/users/nikomatsakis/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nikomatsakis/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-10-01T20:12:06Z",
    "updated_at": "2015-10-01T20:12:06Z",
    "body": "triage: P-medium\n\nWe'd like to see what LLVM will do before we invest a lot of effort on our side, and this seems relatively unlikely to cause problems in practice (though I have personally hit this while developing the compiler as well). There are no backwards incomatibility issues to be concerned about.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/144834431/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/144834539",
    "html_url": "https://github.com/rust-lang/rust/issues/28728#issuecomment-144834539",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28728",
    "id": 144834539,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE0NDgzNDUzOQ==",
    "user": {
      "login": "dotdash",
      "id": 230962,
      "node_id": "MDQ6VXNlcjIzMDk2Mg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/230962?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dotdash",
      "html_url": "https://github.com/dotdash",
      "followers_url": "https://api.github.com/users/dotdash/followers",
      "following_url": "https://api.github.com/users/dotdash/following{/other_user}",
      "gists_url": "https://api.github.com/users/dotdash/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dotdash/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dotdash/subscriptions",
      "organizations_url": "https://api.github.com/users/dotdash/orgs",
      "repos_url": "https://api.github.com/users/dotdash/repos",
      "events_url": "https://api.github.com/users/dotdash/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dotdash/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-10-01T20:12:26Z",
    "updated_at": "2015-10-01T20:12:26Z",
    "body": "Quoting from the LLVM mailing list discussion:\n\n```\n The implementation may assume that any thread will eventually do one of the following:\n   - terminate\n   - make a call to a library I/O function\n   - access or modify a volatile object, or\n   - perform a synchronization operation or an atomic operation\n\n [Note: This is intended to allow compiler transformations such as removal of empty loops, even\n  when termination cannot be proven. \u2014 end note ]\n```\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/144834539/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/144880942",
    "html_url": "https://github.com/rust-lang/rust/issues/28728#issuecomment-144880942",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28728",
    "id": 144880942,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE0NDg4MDk0Mg==",
    "user": {
      "login": "ranma42",
      "id": 1506030,
      "node_id": "MDQ6VXNlcjE1MDYwMzA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1506030?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ranma42",
      "html_url": "https://github.com/ranma42",
      "followers_url": "https://api.github.com/users/ranma42/followers",
      "following_url": "https://api.github.com/users/ranma42/following{/other_user}",
      "gists_url": "https://api.github.com/users/ranma42/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ranma42/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ranma42/subscriptions",
      "organizations_url": "https://api.github.com/users/ranma42/orgs",
      "repos_url": "https://api.github.com/users/ranma42/repos",
      "events_url": "https://api.github.com/users/ranma42/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ranma42/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-10-02T00:01:20Z",
    "updated_at": "2015-10-02T00:01:20Z",
    "body": "@dotdash The excerpt you are quoting comes from the C++ specification; it is basically the answer to \"how it  [having side effects] is defined in C\" (also confirmed by the standard committee: http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1528.htm ). \n\nRegarding what is the expected behaviour of the LLVM IR there is some confusion. https://llvm.org/bugs/show_bug.cgi?id=24078 shows that there seems to be no accurate & explicit specification of the semantics of infinite loops in LLVM IR. It aligns with the semantics of C++, most likely for historical reasons and for convenience (I only managed to track down https://groups.google.com/forum/#!topic/llvm-dev/j2vlIECKkdE which apparently refers to a time when infinite loops were not optimised away, some time before the C/C++ specs were updated to allow it).\n\nFrom the thread it is clear that there is the desire to optimise C++ code as effectively as possible (i.e. also taking into account the opportunity to remove infinite loops), but in the same thread several developers (including some that actively contribute to LLVM) have shown interest in the ability to preserve infinite loops, as they are needed for other languages.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/144880942/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/144983477",
    "html_url": "https://github.com/rust-lang/rust/issues/28728#issuecomment-144983477",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28728",
    "id": 144983477,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE0NDk4MzQ3Nw==",
    "user": {
      "login": "dotdash",
      "id": 230962,
      "node_id": "MDQ6VXNlcjIzMDk2Mg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/230962?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dotdash",
      "html_url": "https://github.com/dotdash",
      "followers_url": "https://api.github.com/users/dotdash/followers",
      "following_url": "https://api.github.com/users/dotdash/following{/other_user}",
      "gists_url": "https://api.github.com/users/dotdash/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dotdash/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dotdash/subscriptions",
      "organizations_url": "https://api.github.com/users/dotdash/orgs",
      "repos_url": "https://api.github.com/users/dotdash/repos",
      "events_url": "https://api.github.com/users/dotdash/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dotdash/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-10-02T10:16:37Z",
    "updated_at": "2015-10-02T10:16:37Z",
    "body": "@ranma42 I'm aware of that, I just quoted that for reference, because one possibility to work-around this would be to detect such loops in rust and add one of the above to it to stop LLVM from performing this optimization.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/144983477/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/160503310",
    "html_url": "https://github.com/rust-lang/rust/issues/28728#issuecomment-160503310",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28728",
    "id": 160503310,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE2MDUwMzMxMA==",
    "user": {
      "login": "bstrie",
      "id": 865233,
      "node_id": "MDQ6VXNlcjg2NTIzMw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/865233?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/bstrie",
      "html_url": "https://github.com/bstrie",
      "followers_url": "https://api.github.com/users/bstrie/followers",
      "following_url": "https://api.github.com/users/bstrie/following{/other_user}",
      "gists_url": "https://api.github.com/users/bstrie/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/bstrie/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/bstrie/subscriptions",
      "organizations_url": "https://api.github.com/users/bstrie/orgs",
      "repos_url": "https://api.github.com/users/bstrie/repos",
      "events_url": "https://api.github.com/users/bstrie/events{/privacy}",
      "received_events_url": "https://api.github.com/users/bstrie/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-11-30T02:42:25Z",
    "updated_at": "2015-11-30T02:42:25Z",
    "body": "Is this a soundness issue? If so, we should tag it as such.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/160503310/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/160504492",
    "html_url": "https://github.com/rust-lang/rust/issues/28728#issuecomment-160504492",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28728",
    "id": 160504492,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE2MDUwNDQ5Mg==",
    "user": {
      "login": "bluss",
      "id": 3209739,
      "node_id": "MDQ6VXNlcjMyMDk3Mzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3209739?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/bluss",
      "html_url": "https://github.com/bluss",
      "followers_url": "https://api.github.com/users/bluss/followers",
      "following_url": "https://api.github.com/users/bluss/following{/other_user}",
      "gists_url": "https://api.github.com/users/bluss/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/bluss/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/bluss/subscriptions",
      "organizations_url": "https://api.github.com/users/bluss/orgs",
      "repos_url": "https://api.github.com/users/bluss/repos",
      "events_url": "https://api.github.com/users/bluss/events{/privacy}",
      "received_events_url": "https://api.github.com/users/bluss/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-11-30T02:56:35Z",
    "updated_at": "2015-11-30T02:56:35Z",
    "body": "Yes, following @ranma42's example, this way shows how it readily defeats array bounds checks. [playground link](https://play.rust-lang.org/?gist=af822ff34d7bacc6dbf9&version=nightly)\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/160504492/reactions",
      "total_count": 5,
      "+1": 5,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/161414774",
    "html_url": "https://github.com/rust-lang/rust/issues/28728#issuecomment-161414774",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28728",
    "id": 161414774,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE2MTQxNDc3NA==",
    "user": {
      "login": "arielb1",
      "id": 1830974,
      "node_id": "MDQ6VXNlcjE4MzA5NzQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1830974?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/arielb1",
      "html_url": "https://github.com/arielb1",
      "followers_url": "https://api.github.com/users/arielb1/followers",
      "following_url": "https://api.github.com/users/arielb1/following{/other_user}",
      "gists_url": "https://api.github.com/users/arielb1/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/arielb1/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/arielb1/subscriptions",
      "organizations_url": "https://api.github.com/users/arielb1/orgs",
      "repos_url": "https://api.github.com/users/arielb1/repos",
      "events_url": "https://api.github.com/users/arielb1/events{/privacy}",
      "received_events_url": "https://api.github.com/users/arielb1/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-12-02T19:56:42Z",
    "updated_at": "2015-12-02T19:56:42Z",
    "body": "@bluss\n\nThe policy is that wrong-code issues that are also soundness issues (i.e. most of them) should be tagged `I-wrong`.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/161414774/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/237615354",
    "html_url": "https://github.com/rust-lang/rust/issues/28728#issuecomment-237615354",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28728",
    "id": 237615354,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIzNzYxNTM1NA==",
    "user": {
      "login": "nikomatsakis",
      "id": 155238,
      "node_id": "MDQ6VXNlcjE1NTIzOA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/155238?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nikomatsakis",
      "html_url": "https://github.com/nikomatsakis",
      "followers_url": "https://api.github.com/users/nikomatsakis/followers",
      "following_url": "https://api.github.com/users/nikomatsakis/following{/other_user}",
      "gists_url": "https://api.github.com/users/nikomatsakis/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nikomatsakis/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nikomatsakis/subscriptions",
      "organizations_url": "https://api.github.com/users/nikomatsakis/orgs",
      "repos_url": "https://api.github.com/users/nikomatsakis/repos",
      "events_url": "https://api.github.com/users/nikomatsakis/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nikomatsakis/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2016-08-04T16:57:49Z",
    "updated_at": "2016-08-04T16:57:49Z",
    "body": "So just to recap prior discussion, there are really two choices here that I can see:\n- Wait for LLVM to provide a solution.\n- Introduce no-op asm statements wherever there may be an infinite loop or infinite recursion (#18785).\n\nThe latter is kind of bad because it can inhibit optimization, so we'd want to do it somewhat sparingly -- basically wherever we can't prove termination ourselves. You could also imaging tying it a bit more to how LLVM optimizes -- i.e., introducing only if we can detect a scenario that LLVM might consider to be an infinite loop/recursion -- but that would (a) require tracking LLVM and (b) require deeper knowledge than I, at least, possess.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/237615354/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/244033679",
    "html_url": "https://github.com/rust-lang/rust/issues/28728#issuecomment-244033679",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28728",
    "id": 244033679,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI0NDAzMzY3OQ==",
    "user": {
      "login": "gnzlbg",
      "id": 904614,
      "node_id": "MDQ6VXNlcjkwNDYxNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/904614?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gnzlbg",
      "html_url": "https://github.com/gnzlbg",
      "followers_url": "https://api.github.com/users/gnzlbg/followers",
      "following_url": "https://api.github.com/users/gnzlbg/following{/other_user}",
      "gists_url": "https://api.github.com/users/gnzlbg/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gnzlbg/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gnzlbg/subscriptions",
      "organizations_url": "https://api.github.com/users/gnzlbg/orgs",
      "repos_url": "https://api.github.com/users/gnzlbg/repos",
      "events_url": "https://api.github.com/users/gnzlbg/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gnzlbg/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2016-09-01T10:01:16Z",
    "updated_at": "2016-09-01T10:01:16Z",
    "body": "> Wait for LLVM to provide a solution.\n\nWhat is the LLVM bug tracking this issue?\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/244033679/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/252941963",
    "html_url": "https://github.com/rust-lang/rust/issues/28728#issuecomment-252941963",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28728",
    "id": 252941963,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI1Mjk0MTk2Mw==",
    "user": {
      "login": "oli-obk",
      "id": 332036,
      "node_id": "MDQ6VXNlcjMzMjAzNg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/332036?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/oli-obk",
      "html_url": "https://github.com/oli-obk",
      "followers_url": "https://api.github.com/users/oli-obk/followers",
      "following_url": "https://api.github.com/users/oli-obk/following{/other_user}",
      "gists_url": "https://api.github.com/users/oli-obk/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/oli-obk/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/oli-obk/subscriptions",
      "organizations_url": "https://api.github.com/users/oli-obk/orgs",
      "repos_url": "https://api.github.com/users/oli-obk/repos",
      "events_url": "https://api.github.com/users/oli-obk/events{/privacy}",
      "received_events_url": "https://api.github.com/users/oli-obk/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2016-10-11T14:56:15Z",
    "updated_at": "2016-10-11T14:56:15Z",
    "body": "side-note: `while true {}` [exhibits this behaviour](https://is.gd/SQPS6H). Maybe the lint should be upgraded to error-by-default and get a note stating that this currently can exhibit undefined behaviour?\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/252941963/reactions",
      "total_count": 2,
      "+1": 2,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/263742266",
    "html_url": "https://github.com/rust-lang/rust/issues/28728#issuecomment-263742266",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28728",
    "id": 263742266,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI2Mzc0MjI2Ng==",
    "user": {
      "login": "strega-nil",
      "id": 3479021,
      "node_id": "MDQ6VXNlcjM0NzkwMjE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3479021?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/strega-nil",
      "html_url": "https://github.com/strega-nil",
      "followers_url": "https://api.github.com/users/strega-nil/followers",
      "following_url": "https://api.github.com/users/strega-nil/following{/other_user}",
      "gists_url": "https://api.github.com/users/strega-nil/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/strega-nil/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/strega-nil/subscriptions",
      "organizations_url": "https://api.github.com/users/strega-nil/orgs",
      "repos_url": "https://api.github.com/users/strega-nil/repos",
      "events_url": "https://api.github.com/users/strega-nil/events{/privacy}",
      "received_events_url": "https://api.github.com/users/strega-nil/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2016-11-30T00:13:13Z",
    "updated_at": "2016-11-30T00:19:59Z",
    "body": "Also, note that this is invalid for C. LLVM making this argument means that there is a bug in clang.\r\n\r\n```C\r\nvoid foo() { while (1) { } }\r\n\r\nvoid create_null() {\r\n        foo();\r\n\r\n        int i = 0;\r\n        while (i < 100) { i += 1; }\r\n}\r\n\r\n__attribute__((noreturn))\r\nvoid use_null() {\r\n        __builtin_unreachable();\r\n}\r\n\r\n\r\nint main() {\r\n        create_null();\r\n        use_null();\r\n}\r\n```\r\n\r\nThis crashes with optimizations; this is *invalid behavior* under the C11 standard:\r\n\r\n```\r\nAn iteration statement whose controlling expression is not a constant\r\nexpression, [note 156] that performs no  input/output  operations,\r\ndoes  not  access  volatile  objects,  and  performs  no synchronization or\r\natomic operations in its body, controlling expression, or (in the case of\r\na for statement) its expression-3, may be   assumed   by   the\r\nimplementation to terminate. [note 157]\r\n\r\n156: An omitted controlling expression is replaced by a nonzero constant,\r\n     which is a constant expression.\r\n157: This  is  intended  to  allow  compiler  transformations  such  as\r\n     removal  of  empty  loops  even  when termination cannot be proven. \r\n```\r\n\r\nNote the \"whose controlling expression is not a constant expression\" - `while (1) { }`, `1` is a constant expression, and thus *may not be removed*.",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/263742266/reactions",
      "total_count": 13,
      "+1": 13,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/263805000",
    "html_url": "https://github.com/rust-lang/rust/issues/28728#issuecomment-263805000",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28728",
    "id": 263805000,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI2MzgwNTAwMA==",
    "user": {
      "login": "oli-obk",
      "id": 332036,
      "node_id": "MDQ6VXNlcjMzMjAzNg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/332036?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/oli-obk",
      "html_url": "https://github.com/oli-obk",
      "followers_url": "https://api.github.com/users/oli-obk/followers",
      "following_url": "https://api.github.com/users/oli-obk/following{/other_user}",
      "gists_url": "https://api.github.com/users/oli-obk/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/oli-obk/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/oli-obk/subscriptions",
      "organizations_url": "https://api.github.com/users/oli-obk/orgs",
      "repos_url": "https://api.github.com/users/oli-obk/repos",
      "events_url": "https://api.github.com/users/oli-obk/events{/privacy}",
      "received_events_url": "https://api.github.com/users/oli-obk/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2016-11-30T07:43:34Z",
    "updated_at": "2016-11-30T07:43:34Z",
    "body": "Is the loop removal an optimization pass that we could simply remove?",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/263805000/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/263861395",
    "html_url": "https://github.com/rust-lang/rust/issues/28728#issuecomment-263861395",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28728",
    "id": 263861395,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI2Mzg2MTM5NQ==",
    "user": {
      "login": "gnzlbg",
      "id": 904614,
      "node_id": "MDQ6VXNlcjkwNDYxNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/904614?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gnzlbg",
      "html_url": "https://github.com/gnzlbg",
      "followers_url": "https://api.github.com/users/gnzlbg/followers",
      "following_url": "https://api.github.com/users/gnzlbg/following{/other_user}",
      "gists_url": "https://api.github.com/users/gnzlbg/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gnzlbg/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gnzlbg/subscriptions",
      "organizations_url": "https://api.github.com/users/gnzlbg/orgs",
      "repos_url": "https://api.github.com/users/gnzlbg/repos",
      "events_url": "https://api.github.com/users/gnzlbg/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gnzlbg/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2016-11-30T12:25:27Z",
    "updated_at": "2016-11-30T12:25:27Z",
    "body": "@ubsan\r\n\r\nDid you find a bug report for that in LLVM's bugzilla or filled one? It seems that in C++ infinite loops that _can_ never terminate are undefined behavior, but in C they are defined behavior (either they can be safely removed in some cases, or they cannot in others).",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/263861395/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/263956134",
    "html_url": "https://github.com/rust-lang/rust/issues/28728#issuecomment-263956134",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28728",
    "id": 263956134,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI2Mzk1NjEzNA==",
    "user": {
      "login": "strega-nil",
      "id": 3479021,
      "node_id": "MDQ6VXNlcjM0NzkwMjE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3479021?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/strega-nil",
      "html_url": "https://github.com/strega-nil",
      "followers_url": "https://api.github.com/users/strega-nil/followers",
      "following_url": "https://api.github.com/users/strega-nil/following{/other_user}",
      "gists_url": "https://api.github.com/users/strega-nil/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/strega-nil/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/strega-nil/subscriptions",
      "organizations_url": "https://api.github.com/users/strega-nil/orgs",
      "repos_url": "https://api.github.com/users/strega-nil/repos",
      "events_url": "https://api.github.com/users/strega-nil/events{/privacy}",
      "received_events_url": "https://api.github.com/users/strega-nil/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2016-11-30T18:37:24Z",
    "updated_at": "2016-11-30T18:44:18Z",
    "body": "@gnzlbg I'm filing a bug now.\r\n\r\nhttps://llvm.org/bugs/show_bug.cgi?id=31217",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/263956134/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/301507632",
    "html_url": "https://github.com/rust-lang/rust/issues/28728#issuecomment-301507632",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28728",
    "id": 301507632,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMwMTUwNzYzMg==",
    "user": {
      "login": "zackw",
      "id": 325899,
      "node_id": "MDQ6VXNlcjMyNTg5OQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/325899?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/zackw",
      "html_url": "https://github.com/zackw",
      "followers_url": "https://api.github.com/users/zackw/followers",
      "following_url": "https://api.github.com/users/zackw/following{/other_user}",
      "gists_url": "https://api.github.com/users/zackw/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/zackw/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/zackw/subscriptions",
      "organizations_url": "https://api.github.com/users/zackw/orgs",
      "repos_url": "https://api.github.com/users/zackw/repos",
      "events_url": "https://api.github.com/users/zackw/events{/privacy}",
      "received_events_url": "https://api.github.com/users/zackw/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2017-05-15T15:18:22Z",
    "updated_at": "2017-05-15T15:18:22Z",
    "body": "Repeating myself from #42009: this bug can, under some circumstances, cause the emission of an externally callable function containing no machine instructions at all.  This should never happen.  If LLVM deduces that a `pub fn` can never be called by correct code, it should emit at least a trap instruction as the body of that function.",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/301507632/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/331239827",
    "html_url": "https://github.com/rust-lang/rust/issues/28728#issuecomment-331239827",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28728",
    "id": 331239827,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMzMTIzOTgyNw==",
    "user": {
      "login": "steveklabnik",
      "id": 27786,
      "node_id": "MDQ6VXNlcjI3Nzg2",
      "avatar_url": "https://avatars.githubusercontent.com/u/27786?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/steveklabnik",
      "html_url": "https://github.com/steveklabnik",
      "followers_url": "https://api.github.com/users/steveklabnik/followers",
      "following_url": "https://api.github.com/users/steveklabnik/following{/other_user}",
      "gists_url": "https://api.github.com/users/steveklabnik/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/steveklabnik/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/steveklabnik/subscriptions",
      "organizations_url": "https://api.github.com/users/steveklabnik/orgs",
      "repos_url": "https://api.github.com/users/steveklabnik/repos",
      "events_url": "https://api.github.com/users/steveklabnik/events{/privacy}",
      "received_events_url": "https://api.github.com/users/steveklabnik/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2017-09-21T18:19:29Z",
    "updated_at": "2017-09-21T18:19:29Z",
    "body": "This was brought up in this blog post today: https://blog.rom1v.com/2017/09/gnirehtet-rewritten-in-rust/\r\n\r\nWith a simpler reproduction: https://play.rust-lang.org/?gist=e622f8a672fbc57ecc63eb4450d2fc0a&version=stable",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/331239827/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/331460667",
    "html_url": "https://github.com/rust-lang/rust/issues/28728#issuecomment-331460667",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28728",
    "id": 331460667,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMzMTQ2MDY2Nw==",
    "user": {
      "login": "sunfishcode",
      "id": 4503403,
      "node_id": "MDQ6VXNlcjQ1MDM0MDM=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4503403?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sunfishcode",
      "html_url": "https://github.com/sunfishcode",
      "followers_url": "https://api.github.com/users/sunfishcode/followers",
      "following_url": "https://api.github.com/users/sunfishcode/following{/other_user}",
      "gists_url": "https://api.github.com/users/sunfishcode/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sunfishcode/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sunfishcode/subscriptions",
      "organizations_url": "https://api.github.com/users/sunfishcode/orgs",
      "repos_url": "https://api.github.com/users/sunfishcode/repos",
      "events_url": "https://api.github.com/users/sunfishcode/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sunfishcode/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2017-09-22T14:20:34Z",
    "updated_at": "2017-09-22T14:20:34Z",
    "body": "The LLVM bug for this is https://bugs.llvm.org/show_bug.cgi?id=965 (opened in 2006).",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/331460667/reactions",
      "total_count": 9,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 9,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/332581533",
    "html_url": "https://github.com/rust-lang/rust/issues/28728#issuecomment-332581533",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28728",
    "id": 332581533,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMzMjU4MTUzMw==",
    "user": {
      "login": "sunfishcode",
      "id": 4503403,
      "node_id": "MDQ6VXNlcjQ1MDM0MDM=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4503403?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sunfishcode",
      "html_url": "https://github.com/sunfishcode",
      "followers_url": "https://api.github.com/users/sunfishcode/followers",
      "following_url": "https://api.github.com/users/sunfishcode/following{/other_user}",
      "gists_url": "https://api.github.com/users/sunfishcode/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sunfishcode/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sunfishcode/subscriptions",
      "organizations_url": "https://api.github.com/users/sunfishcode/orgs",
      "repos_url": "https://api.github.com/users/sunfishcode/repos",
      "events_url": "https://api.github.com/users/sunfishcode/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sunfishcode/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2017-09-27T16:37:48Z",
    "updated_at": "2017-09-27T16:37:48Z",
    "body": "@zackw LLVM has a flag for that: `TrapUnreachable`. I haven't tested this, but it looks adding `Options.TrapUnreachable = true;` to [`LLVMRustCreateTargetMachine`](https://github.com/rust-lang/rust/blob/4cdb36262b93390c8733a1ce44665619d9348981/src/rustllvm/PassWrapper.cpp#L370) ought to address your concern. It's likely that this has a low enough cost that it could be done by default, though I haven't made any measurements.\r\n\r\n@oli-obk It's unfortunately not just a loop-deletion pass. The problem arises from broad assumptions, for example: (a) branches have no side effects, (b) functions that contain no instructions with side effects have no side effects, and (c) calls to functions with no side effects can be moved or deleted.\r\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/332581533/reactions",
      "total_count": 2,
      "+1": 2,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/332926932",
    "html_url": "https://github.com/rust-lang/rust/issues/28728#issuecomment-332926932",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28728",
    "id": 332926932,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMzMjkyNjkzMg==",
    "user": {
      "login": "steveklabnik",
      "id": 27786,
      "node_id": "MDQ6VXNlcjI3Nzg2",
      "avatar_url": "https://avatars.githubusercontent.com/u/27786?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/steveklabnik",
      "html_url": "https://github.com/steveklabnik",
      "followers_url": "https://api.github.com/users/steveklabnik/followers",
      "following_url": "https://api.github.com/users/steveklabnik/following{/other_user}",
      "gists_url": "https://api.github.com/users/steveklabnik/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/steveklabnik/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/steveklabnik/subscriptions",
      "organizations_url": "https://api.github.com/users/steveklabnik/orgs",
      "repos_url": "https://api.github.com/users/steveklabnik/repos",
      "events_url": "https://api.github.com/users/steveklabnik/events{/privacy}",
      "received_events_url": "https://api.github.com/users/steveklabnik/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2017-09-28T18:40:06Z",
    "updated_at": "2017-09-28T18:40:06Z",
    "body": "Looks like there's a patch: https://reviews.llvm.org/D38336",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/332926932/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/341467532",
    "html_url": "https://github.com/rust-lang/rust/issues/28728#issuecomment-341467532",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28728",
    "id": 341467532,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM0MTQ2NzUzMg==",
    "user": {
      "login": "bstrie",
      "id": 865233,
      "node_id": "MDQ6VXNlcjg2NTIzMw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/865233?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/bstrie",
      "html_url": "https://github.com/bstrie",
      "followers_url": "https://api.github.com/users/bstrie/followers",
      "following_url": "https://api.github.com/users/bstrie/following{/other_user}",
      "gists_url": "https://api.github.com/users/bstrie/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/bstrie/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/bstrie/subscriptions",
      "organizations_url": "https://api.github.com/users/bstrie/orgs",
      "repos_url": "https://api.github.com/users/bstrie/repos",
      "events_url": "https://api.github.com/users/bstrie/events{/privacy}",
      "received_events_url": "https://api.github.com/users/bstrie/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2017-11-02T15:54:22Z",
    "updated_at": "2017-11-02T15:54:22Z",
    "body": "@sunfishcode , looks like your LLVM patch at https://reviews.llvm.org/D38336 was \"accepted\" on October 3, can you give an update on what that means regarding LLVM's release process? What's the next step beyond acceptance, and do you have an idea of what future LLVM release will contain this patch?",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/341467532/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/341554036",
    "html_url": "https://github.com/rust-lang/rust/issues/28728#issuecomment-341554036",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28728",
    "id": 341554036,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM0MTU1NDAzNg==",
    "user": {
      "login": "sunfishcode",
      "id": 4503403,
      "node_id": "MDQ6VXNlcjQ1MDM0MDM=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4503403?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sunfishcode",
      "html_url": "https://github.com/sunfishcode",
      "followers_url": "https://api.github.com/users/sunfishcode/followers",
      "following_url": "https://api.github.com/users/sunfishcode/following{/other_user}",
      "gists_url": "https://api.github.com/users/sunfishcode/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sunfishcode/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sunfishcode/subscriptions",
      "organizations_url": "https://api.github.com/users/sunfishcode/orgs",
      "repos_url": "https://api.github.com/users/sunfishcode/repos",
      "events_url": "https://api.github.com/users/sunfishcode/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sunfishcode/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2017-11-02T20:50:59Z",
    "updated_at": "2017-11-02T20:50:59Z",
    "body": "I talked with some people offline who suggested we have an llvmdev thread. The thread is here:\r\n\r\nhttp://lists.llvm.org/pipermail/llvm-dev/2017-October/118558.html\r\n\r\nIt's now concluded, with the result being that I need to make additional changes. I think the changes will be good, though they'll take me a little more time to do.",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/341554036/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/341571559",
    "html_url": "https://github.com/rust-lang/rust/issues/28728#issuecomment-341571559",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28728",
    "id": 341571559,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM0MTU3MTU1OQ==",
    "user": {
      "login": "bstrie",
      "id": 865233,
      "node_id": "MDQ6VXNlcjg2NTIzMw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/865233?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/bstrie",
      "html_url": "https://github.com/bstrie",
      "followers_url": "https://api.github.com/users/bstrie/followers",
      "following_url": "https://api.github.com/users/bstrie/following{/other_user}",
      "gists_url": "https://api.github.com/users/bstrie/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/bstrie/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/bstrie/subscriptions",
      "organizations_url": "https://api.github.com/users/bstrie/orgs",
      "repos_url": "https://api.github.com/users/bstrie/repos",
      "events_url": "https://api.github.com/users/bstrie/events{/privacy}",
      "received_events_url": "https://api.github.com/users/bstrie/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2017-11-02T22:02:20Z",
    "updated_at": "2017-11-02T22:02:20Z",
    "body": "Thanks for the update, and thanks so much for your efforts!",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/341571559/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/343284066",
    "html_url": "https://github.com/rust-lang/rust/issues/28728#issuecomment-343284066",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28728",
    "id": 343284066,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM0MzI4NDA2Ng==",
    "user": {
      "login": "bstrie",
      "id": 865233,
      "node_id": "MDQ6VXNlcjg2NTIzMw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/865233?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/bstrie",
      "html_url": "https://github.com/bstrie",
      "followers_url": "https://api.github.com/users/bstrie/followers",
      "following_url": "https://api.github.com/users/bstrie/following{/other_user}",
      "gists_url": "https://api.github.com/users/bstrie/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/bstrie/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/bstrie/subscriptions",
      "organizations_url": "https://api.github.com/users/bstrie/orgs",
      "repos_url": "https://api.github.com/users/bstrie/repos",
      "events_url": "https://api.github.com/users/bstrie/events{/privacy}",
      "received_events_url": "https://api.github.com/users/bstrie/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2017-11-09T20:38:51Z",
    "updated_at": "2017-11-09T20:38:51Z",
    "body": "Note that https://reviews.llvm.org/rL317729 has landed in LLVM. This patch is planned to have a follow-up patch which makes infinite loops exhibit defined behavior by default, so AFAICT all we need to do is wait and eventually this will be resolved for us upstream.",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/343284066/reactions",
      "total_count": 2,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 2,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/343572489",
    "html_url": "https://github.com/rust-lang/rust/issues/28728#issuecomment-343572489",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28728",
    "id": 343572489,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM0MzU3MjQ4OQ==",
    "user": {
      "login": "sunfishcode",
      "id": 4503403,
      "node_id": "MDQ6VXNlcjQ1MDM0MDM=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4503403?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sunfishcode",
      "html_url": "https://github.com/sunfishcode",
      "followers_url": "https://api.github.com/users/sunfishcode/followers",
      "following_url": "https://api.github.com/users/sunfishcode/following{/other_user}",
      "gists_url": "https://api.github.com/users/sunfishcode/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sunfishcode/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sunfishcode/subscriptions",
      "organizations_url": "https://api.github.com/users/sunfishcode/orgs",
      "repos_url": "https://api.github.com/users/sunfishcode/repos",
      "events_url": "https://api.github.com/users/sunfishcode/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sunfishcode/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2017-11-10T20:04:39Z",
    "updated_at": "2017-11-10T20:04:39Z",
    "body": "@zackw I've now created #45920 to fix the problem of functions containing no code.\r\n\r\n@bstrie Yes, the first step is landed, and I'm working on the second step of making LLVM give infinite loops defined behavior by default. It's a complex change, and I don't yet know how long it'll take to finish, but I'll post updates here.",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/343572489/reactions",
      "total_count": 6,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 6,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/364141617",
    "html_url": "https://github.com/rust-lang/rust/issues/28728#issuecomment-364141617",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28728",
    "id": 364141617,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM2NDE0MTYxNw==",
    "user": {
      "login": "jsgf",
      "id": 147966,
      "node_id": "MDQ6VXNlcjE0Nzk2Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/147966?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jsgf",
      "html_url": "https://github.com/jsgf",
      "followers_url": "https://api.github.com/users/jsgf/followers",
      "following_url": "https://api.github.com/users/jsgf/following{/other_user}",
      "gists_url": "https://api.github.com/users/jsgf/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jsgf/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jsgf/subscriptions",
      "organizations_url": "https://api.github.com/users/jsgf/orgs",
      "repos_url": "https://api.github.com/users/jsgf/repos",
      "events_url": "https://api.github.com/users/jsgf/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jsgf/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2018-02-08T15:12:13Z",
    "updated_at": "2018-02-08T15:12:13Z",
    "body": "I couldn't repro this just now: https://play.rust-lang.org/?gist=529bd5ab326f7b627e559f64d514312f&version=stable",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/364141617/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/364143837",
    "html_url": "https://github.com/rust-lang/rust/issues/28728#issuecomment-364143837",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28728",
    "id": 364143837,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM2NDE0MzgzNw==",
    "user": {
      "login": "kennytm",
      "id": 103023,
      "node_id": "MDQ6VXNlcjEwMzAyMw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/103023?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/kennytm",
      "html_url": "https://github.com/kennytm",
      "followers_url": "https://api.github.com/users/kennytm/followers",
      "following_url": "https://api.github.com/users/kennytm/following{/other_user}",
      "gists_url": "https://api.github.com/users/kennytm/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/kennytm/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kennytm/subscriptions",
      "organizations_url": "https://api.github.com/users/kennytm/orgs",
      "repos_url": "https://api.github.com/users/kennytm/repos",
      "events_url": "https://api.github.com/users/kennytm/events{/privacy}",
      "received_events_url": "https://api.github.com/users/kennytm/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2018-02-08T15:18:56Z",
    "updated_at": "2018-02-08T15:18:56Z",
    "body": "@jsgf Still repro. Have you selected Release mode?",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/364143837/reactions",
      "total_count": 2,
      "+1": 2,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/365796258",
    "html_url": "https://github.com/rust-lang/rust/issues/28728#issuecomment-365796258",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28728",
    "id": 365796258,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM2NTc5NjI1OA==",
    "user": {
      "login": "jsgf",
      "id": 147966,
      "node_id": "MDQ6VXNlcjE0Nzk2Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/147966?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jsgf",
      "html_url": "https://github.com/jsgf",
      "followers_url": "https://api.github.com/users/jsgf/followers",
      "following_url": "https://api.github.com/users/jsgf/following{/other_user}",
      "gists_url": "https://api.github.com/users/jsgf/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jsgf/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jsgf/subscriptions",
      "organizations_url": "https://api.github.com/users/jsgf/orgs",
      "repos_url": "https://api.github.com/users/jsgf/repos",
      "events_url": "https://api.github.com/users/jsgf/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jsgf/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2018-02-15T01:05:08Z",
    "updated_at": "2018-02-15T01:05:08Z",
    "body": "@kennytm Woops, never mind.",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/365796258/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/411193164",
    "html_url": "https://github.com/rust-lang/rust/issues/28728#issuecomment-411193164",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28728",
    "id": 411193164,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQxMTE5MzE2NA==",
    "user": {
      "login": "japaric",
      "id": 5018213,
      "node_id": "MDQ6VXNlcjUwMTgyMTM=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5018213?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/japaric",
      "html_url": "https://github.com/japaric",
      "followers_url": "https://api.github.com/users/japaric/followers",
      "following_url": "https://api.github.com/users/japaric/following{/other_user}",
      "gists_url": "https://api.github.com/users/japaric/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/japaric/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/japaric/subscriptions",
      "organizations_url": "https://api.github.com/users/japaric/orgs",
      "repos_url": "https://api.github.com/users/japaric/repos",
      "events_url": "https://api.github.com/users/japaric/events{/privacy}",
      "received_events_url": "https://api.github.com/users/japaric/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2018-08-07T20:35:08Z",
    "updated_at": "2018-08-07T20:35:08Z",
    "body": "> Note that https://reviews.llvm.org/rL317729 has landed in LLVM. This patch is planned to have a follow-up patch which makes infinite loops exhibit defined behavior by default, so AFAICT all we need to do is wait and eventually this will be resolved for us upstream.\r\n\r\nIt has been several months since this comment. Anyone knows if the follow-up patch happened or will still happen?\r\n\r\nAlternatively, it seems that the `llvm.sideeffect` intrinsic exists in the LLVM version we are using: could we fix this ourselves by translating Rust infinite loops into LLVM loops that contain the sideeffect intrinsic?",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/411193164/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/421383689",
    "html_url": "https://github.com/rust-lang/rust/issues/28728#issuecomment-421383689",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28728",
    "id": 421383689,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQyMTM4MzY4OQ==",
    "user": {
      "login": "Ekleog",
      "id": 411447,
      "node_id": "MDQ6VXNlcjQxMTQ0Nw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/411447?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Ekleog",
      "html_url": "https://github.com/Ekleog",
      "followers_url": "https://api.github.com/users/Ekleog/followers",
      "following_url": "https://api.github.com/users/Ekleog/following{/other_user}",
      "gists_url": "https://api.github.com/users/Ekleog/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Ekleog/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Ekleog/subscriptions",
      "organizations_url": "https://api.github.com/users/Ekleog/orgs",
      "repos_url": "https://api.github.com/users/Ekleog/repos",
      "events_url": "https://api.github.com/users/Ekleog/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Ekleog/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2018-09-14T14:52:12Z",
    "updated_at": "2018-09-14T14:52:27Z",
    "body": "As seen is https://github.com/rust-lang/rust/issues/38136 and https://github.com/rust-lang/rust/issues/54214 , this is especially bad with the upcoming `panic_implementation`, as a logical implementation of it will be `loop {}`, and this would make all occurrences of `panic!` UB without any `unsafe` code. Which\u2026 is maybe the worse that could happen.",
    "author_association": "NONE",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/421383689/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/425039966",
    "html_url": "https://github.com/rust-lang/rust/issues/28728#issuecomment-425039966",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28728",
    "id": 425039966,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQyNTAzOTk2Ng==",
    "user": {
      "login": "SergioBenitez",
      "id": 1480321,
      "node_id": "MDQ6VXNlcjE0ODAzMjE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1480321?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/SergioBenitez",
      "html_url": "https://github.com/SergioBenitez",
      "followers_url": "https://api.github.com/users/SergioBenitez/followers",
      "following_url": "https://api.github.com/users/SergioBenitez/following{/other_user}",
      "gists_url": "https://api.github.com/users/SergioBenitez/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/SergioBenitez/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/SergioBenitez/subscriptions",
      "organizations_url": "https://api.github.com/users/SergioBenitez/orgs",
      "repos_url": "https://api.github.com/users/SergioBenitez/repos",
      "events_url": "https://api.github.com/users/SergioBenitez/events{/privacy}",
      "received_events_url": "https://api.github.com/users/SergioBenitez/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2018-09-27T10:26:35Z",
    "updated_at": "2018-09-27T10:26:35Z",
    "body": "Just came across this issue in another light. Here's an example:\r\n\r\n```rust\r\npub struct Container<'f> {\r\n    string: &'f str,\r\n    num: usize,\r\n}\r\n\r\nimpl<'f> From<&'f str> for Container<'f> {\r\n    #[inline(always)]\r\n    fn from(string: &'f str) -> Container<'f> {\r\n        Container::from(string)\r\n    }\r\n}\r\n\r\nfn main() {\r\n    let x = Container::from(\"hello\");\r\n    println!(\"{} {}\", x.string, x.num);\r\n    \r\n    let y = Container::from(\"hi\");\r\n    println!(\"{} {}\", y.string, y.num);\r\n    \r\n    let z = Container::from(\"hello\");\r\n    println!(\"{} {}\", z.string, z.num);\r\n}\r\n```\r\n\r\nThis example reliably segfaults on stable, beta, and nightly, and shows how easy it is to construct uninitialized values of any type. Here it is [on the playground](https://play.rust-lang.org/?gist=8c96296e031cac9246c61fb4ccb07158&version=nightly&mode=release&edition=2018).",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/425039966/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/425043176",
    "html_url": "https://github.com/rust-lang/rust/issues/28728#issuecomment-425043176",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28728",
    "id": 425043176,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQyNTA0MzE3Ng==",
    "user": {
      "login": "gnzlbg",
      "id": 904614,
      "node_id": "MDQ6VXNlcjkwNDYxNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/904614?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gnzlbg",
      "html_url": "https://github.com/gnzlbg",
      "followers_url": "https://api.github.com/users/gnzlbg/followers",
      "following_url": "https://api.github.com/users/gnzlbg/following{/other_user}",
      "gists_url": "https://api.github.com/users/gnzlbg/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gnzlbg/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gnzlbg/subscriptions",
      "organizations_url": "https://api.github.com/users/gnzlbg/orgs",
      "repos_url": "https://api.github.com/users/gnzlbg/repos",
      "events_url": "https://api.github.com/users/gnzlbg/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gnzlbg/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2018-09-27T10:39:00Z",
    "updated_at": "2018-09-27T10:44:09Z",
    "body": "@SergioBenitez that program does not segfault, it terminates with a stack overflow (you need to run it in debug mode). This is the correct behavior, since your program just recurses infinitely requiring an infinite amount of stack space, which at some point is going to exceed the stack space available. [Minimal working example](https://play.rust-lang.org/?gist=5ee571a6398dd1cff260bb12269e935c&version=nightly&mode=debug&edition=2018). \r\n\r\nIn release builds, LLVM can assume that you don't have infinite recursion, and optimizes that away ([mwe](https://play.rust-lang.org/?gist=5d813dd2b4b8abce4586269d0e987380&version=nightly&mode=release&edition=2018)). This has nothing to do with loops AFAICT, but rather with https://stackoverflow.com/a/5905171/1422197",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/425043176/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/425163459",
    "html_url": "https://github.com/rust-lang/rust/issues/28728#issuecomment-425163459",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28728",
    "id": 425163459,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQyNTE2MzQ1OQ==",
    "user": {
      "login": "SergioBenitez",
      "id": 1480321,
      "node_id": "MDQ6VXNlcjE0ODAzMjE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1480321?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/SergioBenitez",
      "html_url": "https://github.com/SergioBenitez",
      "followers_url": "https://api.github.com/users/SergioBenitez/followers",
      "following_url": "https://api.github.com/users/SergioBenitez/following{/other_user}",
      "gists_url": "https://api.github.com/users/SergioBenitez/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/SergioBenitez/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/SergioBenitez/subscriptions",
      "organizations_url": "https://api.github.com/users/SergioBenitez/orgs",
      "repos_url": "https://api.github.com/users/SergioBenitez/repos",
      "events_url": "https://api.github.com/users/SergioBenitez/events{/privacy}",
      "received_events_url": "https://api.github.com/users/SergioBenitez/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2018-09-27T16:47:36Z",
    "updated_at": "2018-09-27T16:47:36Z",
    "body": "@gnzlbg Sorry, but you're not correct.\n\nThe program segfaults in release mode. That's the entire point; that an optimization results in unsound behavior - that LLVM and Rust's semantics are not in agreement here - that I can write and compile a safe Rust program with rustc that allows me to use uninitialized memory, inspect arbitrary memory, and arbitrarily cast between types, violating the semantics of the language. That's the same point being illustrated in this thread. Note that the original program also doesn't segfault in debug mode.\n\nYou also seem to be proposing that there is a _different_, non-loop optimization taking place here. That's unlikely, though largely irrelevant, albeit it might warrant a separate issue if it is the case. My guess is that LLVM is noticing the tail recursion, treating it as an infinite loop, and optimizing it away, again, exactly what this issue is about. ",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/425163459/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/425163683",
    "html_url": "https://github.com/rust-lang/rust/issues/28728#issuecomment-425163683",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28728",
    "id": 425163683,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQyNTE2MzY4Mw==",
    "user": {
      "login": "Ekleog",
      "id": 411447,
      "node_id": "MDQ6VXNlcjQxMTQ0Nw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/411447?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Ekleog",
      "html_url": "https://github.com/Ekleog",
      "followers_url": "https://api.github.com/users/Ekleog/followers",
      "following_url": "https://api.github.com/users/Ekleog/following{/other_user}",
      "gists_url": "https://api.github.com/users/Ekleog/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Ekleog/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Ekleog/subscriptions",
      "organizations_url": "https://api.github.com/users/Ekleog/orgs",
      "repos_url": "https://api.github.com/users/Ekleog/repos",
      "events_url": "https://api.github.com/users/Ekleog/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Ekleog/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2018-09-27T16:48:13Z",
    "updated_at": "2018-09-27T16:50:13Z",
    "body": "@gnzlbg Well, slightly changing your mwe of optimization away of infinite recursion ([here](https://play.rust-lang.org/?gist=f576b877971ca8380decc2ade256207a&version=nightly&mode=release&edition=2018)), it does generate an uninitialized value of `NonZeroUsize` (which turns out to be\u2026 0, thus an invalid value).\r\n\r\nAnd that is what @SergioBenitez also did with their example, except it's with pointers, and thus generates a segfault.",
    "author_association": "NONE",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/425163683/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/425165038",
    "html_url": "https://github.com/rust-lang/rust/issues/28728#issuecomment-425165038",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28728",
    "id": 425165038,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQyNTE2NTAzOA==",
    "user": {
      "login": "gnzlbg",
      "id": 904614,
      "node_id": "MDQ6VXNlcjkwNDYxNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/904614?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gnzlbg",
      "html_url": "https://github.com/gnzlbg",
      "followers_url": "https://api.github.com/users/gnzlbg/followers",
      "following_url": "https://api.github.com/users/gnzlbg/following{/other_user}",
      "gists_url": "https://api.github.com/users/gnzlbg/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gnzlbg/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gnzlbg/subscriptions",
      "organizations_url": "https://api.github.com/users/gnzlbg/orgs",
      "repos_url": "https://api.github.com/users/gnzlbg/repos",
      "events_url": "https://api.github.com/users/gnzlbg/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gnzlbg/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2018-09-27T16:52:22Z",
    "updated_at": "2018-09-27T16:57:59Z",
    "body": "Are we in agreement that @SergioBenitez  program has a stack overflow in both debug and release? \r\n\r\nIf so, I cannot find any `loop`s in @SergioBenitez example, so I don't know how this issue would apply to it (this issue is about infinite `loop`s after all). If I am wrong, please point me to the `loop` in your example.\r\n\r\nAs mentioned, LLVM assumes that infinite recursion cannot happen (it assumes that all threads eventually terminate), but that would be a different issue from this one. ",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/425165038/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/425165452",
    "html_url": "https://github.com/rust-lang/rust/issues/28728#issuecomment-425165452",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28728",
    "id": 425165452,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQyNTE2NTQ1Mg==",
    "user": {
      "login": "hanna-kruppe",
      "id": 2311707,
      "node_id": "MDQ6VXNlcjIzMTE3MDc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2311707?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hanna-kruppe",
      "html_url": "https://github.com/hanna-kruppe",
      "followers_url": "https://api.github.com/users/hanna-kruppe/followers",
      "following_url": "https://api.github.com/users/hanna-kruppe/following{/other_user}",
      "gists_url": "https://api.github.com/users/hanna-kruppe/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hanna-kruppe/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hanna-kruppe/subscriptions",
      "organizations_url": "https://api.github.com/users/hanna-kruppe/orgs",
      "repos_url": "https://api.github.com/users/hanna-kruppe/repos",
      "events_url": "https://api.github.com/users/hanna-kruppe/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hanna-kruppe/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2018-09-27T16:53:45Z",
    "updated_at": "2018-09-27T16:53:45Z",
    "body": "I have not inspected the optimizations LLVM does or the generated code for either of the programs, but do note that a segfault is not unsound, if the segfault is all that happens. In particular, stack overflows that are caught (by stack probing + an unmapped guard page after the end of the stack) and don't cause any memory safety problems also show up as segfaults. Of course, segfaults *can also* indicate memory corruption or wild writes/reads or other soundness problems.",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/425165452/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/425167410",
    "html_url": "https://github.com/rust-lang/rust/issues/28728#issuecomment-425167410",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28728",
    "id": 425167410,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQyNTE2NzQxMA==",
    "user": {
      "login": "SergioBenitez",
      "id": 1480321,
      "node_id": "MDQ6VXNlcjE0ODAzMjE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1480321?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/SergioBenitez",
      "html_url": "https://github.com/SergioBenitez",
      "followers_url": "https://api.github.com/users/SergioBenitez/followers",
      "following_url": "https://api.github.com/users/SergioBenitez/following{/other_user}",
      "gists_url": "https://api.github.com/users/SergioBenitez/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/SergioBenitez/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/SergioBenitez/subscriptions",
      "organizations_url": "https://api.github.com/users/SergioBenitez/orgs",
      "repos_url": "https://api.github.com/users/SergioBenitez/repos",
      "events_url": "https://api.github.com/users/SergioBenitez/events{/privacy}",
      "received_events_url": "https://api.github.com/users/SergioBenitez/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2018-09-27T16:59:53Z",
    "updated_at": "2018-09-27T16:59:53Z",
    "body": "@rkruppe My program segfaults because a reference to a random memory location was allowed to be constructed, and the reference was subsequently read. The program can be trivially modified to instead write a random memory location, and without too much difficulty, read/write a _particular_ memory location.\n\n@gnzlbg The program _does not_ stack overflow in release mode. In release mode, the program makes zero function calls; the stack is pushed onto a finite number of times, purely to allocate locals.",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/425167410/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/425168514",
    "html_url": "https://github.com/rust-lang/rust/issues/28728#issuecomment-425168514",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28728",
    "id": 425168514,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQyNTE2ODUxNA==",
    "user": {
      "login": "gnzlbg",
      "id": 904614,
      "node_id": "MDQ6VXNlcjkwNDYxNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/904614?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gnzlbg",
      "html_url": "https://github.com/gnzlbg",
      "followers_url": "https://api.github.com/users/gnzlbg/followers",
      "following_url": "https://api.github.com/users/gnzlbg/following{/other_user}",
      "gists_url": "https://api.github.com/users/gnzlbg/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gnzlbg/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gnzlbg/subscriptions",
      "organizations_url": "https://api.github.com/users/gnzlbg/orgs",
      "repos_url": "https://api.github.com/users/gnzlbg/repos",
      "events_url": "https://api.github.com/users/gnzlbg/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gnzlbg/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2018-09-27T17:03:13Z",
    "updated_at": "2018-09-27T17:05:17Z",
    "body": "> The program does not stack overflow in release mode.\r\n\r\nSo? The only thing that matters is that the example program, which is basically `fn foo() { foo() }`, has infinite recursion, which is not allowed by LLVM.",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/425168514/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/425169361",
    "html_url": "https://github.com/rust-lang/rust/issues/28728#issuecomment-425169361",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28728",
    "id": 425169361,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQyNTE2OTM2MQ==",
    "user": {
      "login": "hanna-kruppe",
      "id": 2311707,
      "node_id": "MDQ6VXNlcjIzMTE3MDc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2311707?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hanna-kruppe",
      "html_url": "https://github.com/hanna-kruppe",
      "followers_url": "https://api.github.com/users/hanna-kruppe/followers",
      "following_url": "https://api.github.com/users/hanna-kruppe/following{/other_user}",
      "gists_url": "https://api.github.com/users/hanna-kruppe/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hanna-kruppe/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hanna-kruppe/subscriptions",
      "organizations_url": "https://api.github.com/users/hanna-kruppe/orgs",
      "repos_url": "https://api.github.com/users/hanna-kruppe/repos",
      "events_url": "https://api.github.com/users/hanna-kruppe/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hanna-kruppe/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2018-09-27T17:05:59Z",
    "updated_at": "2018-09-27T17:05:59Z",
    "body": "> The only thing that matters is that the example program, which is basically fn foo() { foo() }, has infinite recursion, which is not allowed by LLVM.\r\n\r\nI don't know why you're saying this like it resolves anything. LLVM considering infinite recursion and loops UB and optimizing accordingly, yet it being safe in Rust, is the entire point of this whole issue!",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/425169361/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/425170965",
    "html_url": "https://github.com/rust-lang/rust/issues/28728#issuecomment-425170965",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28728",
    "id": 425170965,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQyNTE3MDk2NQ==",
    "user": {
      "login": "sunfishcode",
      "id": 4503403,
      "node_id": "MDQ6VXNlcjQ1MDM0MDM=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4503403?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sunfishcode",
      "html_url": "https://github.com/sunfishcode",
      "followers_url": "https://api.github.com/users/sunfishcode/followers",
      "following_url": "https://api.github.com/users/sunfishcode/following{/other_user}",
      "gists_url": "https://api.github.com/users/sunfishcode/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sunfishcode/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sunfishcode/subscriptions",
      "organizations_url": "https://api.github.com/users/sunfishcode/orgs",
      "repos_url": "https://api.github.com/users/sunfishcode/repos",
      "events_url": "https://api.github.com/users/sunfishcode/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sunfishcode/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2018-09-27T17:11:16Z",
    "updated_at": "2018-09-27T17:11:16Z",
    "body": "Author of https://reviews.llvm.org/rL317729 here, confirming that I have not yet implemented the follow-up patch.\r\n\r\nYou can insert an `@llvm.sideeffect` calls today to ensure that loops are not optimized away. That might disable some optimizations, but in theory not too many, since the major optimizations have been taught how to understand it. If one puts `@llvm.sideeffect` calls in all loops or things which might turn into loops (recursion, unwinding, [inline asm](https://gcc.gnu.org/onlinedocs/gcc/Extended-Asm.html#GotoLabels), others?), that's theoretically sufficient to fix the problem here.\r\n\r\nObviously it would be nicer to have the second patch in place, so that it's not necessary to do this. I don't know when I'll get back to implementing that.",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/425170965/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/425178068",
    "html_url": "https://github.com/rust-lang/rust/issues/28728#issuecomment-425178068",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28728",
    "id": 425178068,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQyNTE3ODA2OA==",
    "user": {
      "login": "shepmaster",
      "id": 174509,
      "node_id": "MDQ6VXNlcjE3NDUwOQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/174509?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/shepmaster",
      "html_url": "https://github.com/shepmaster",
      "followers_url": "https://api.github.com/users/shepmaster/followers",
      "following_url": "https://api.github.com/users/shepmaster/following{/other_user}",
      "gists_url": "https://api.github.com/users/shepmaster/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/shepmaster/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/shepmaster/subscriptions",
      "organizations_url": "https://api.github.com/users/shepmaster/orgs",
      "repos_url": "https://api.github.com/users/shepmaster/repos",
      "events_url": "https://api.github.com/users/shepmaster/events{/privacy}",
      "received_events_url": "https://api.github.com/users/shepmaster/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2018-09-27T17:33:05Z",
    "updated_at": "2018-09-27T17:33:05Z",
    "body": "There's some small difference, but I'm not sure if it's material or not.\r\n\r\n### Recursion\r\n\r\n```rust\r\n#[allow(unconditional_recursion)]\r\n#[inline(never)]\r\npub fn via_recursion<T>() -> T {\r\n    via_recursion()\r\n}\r\n\r\nfn main() {\r\n    let a: String = via_recursion();\r\n}\r\n```\r\n\r\n```llvm\r\ndefine internal void @_ZN10playground4main17h1daf53946e45b822E() unnamed_addr #2 personality i32 (i32, i32, i64, %\"unwind::libunwind::_Unwind_Exception\"*, %\"unwind::libunwind::_Unwind_Context\"*)* @rust_eh_personality {\r\n_ZN4core3ptr13drop_in_place17h95538e539a6968d0E.exit:\r\n  ret void\r\n}\r\n```\r\n\r\n### Loop\r\n\r\n```rust\r\n#[inline(never)]\r\npub fn via_loop<T>() -> T {\r\n    loop {}\r\n}\r\n\r\nfn main() {\r\n    let b: String = via_loop();\r\n}\r\n```\r\n\r\n```llvm\r\ndefine internal void @_ZN10playground4main17h1daf53946e45b822E() unnamed_addr #2 {\r\nstart:\r\n  unreachable\r\n}\r\n```\r\n\r\n### Meta\r\n\r\nRust 1.29.1, compiling in release mode, viewing the LLVM IR.",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/425178068/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/425179582",
    "html_url": "https://github.com/rust-lang/rust/issues/28728#issuecomment-425179582",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28728",
    "id": 425179582,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQyNTE3OTU4Mg==",
    "user": {
      "login": "gnzlbg",
      "id": 904614,
      "node_id": "MDQ6VXNlcjkwNDYxNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/904614?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gnzlbg",
      "html_url": "https://github.com/gnzlbg",
      "followers_url": "https://api.github.com/users/gnzlbg/followers",
      "following_url": "https://api.github.com/users/gnzlbg/following{/other_user}",
      "gists_url": "https://api.github.com/users/gnzlbg/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gnzlbg/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gnzlbg/subscriptions",
      "organizations_url": "https://api.github.com/users/gnzlbg/orgs",
      "repos_url": "https://api.github.com/users/gnzlbg/repos",
      "events_url": "https://api.github.com/users/gnzlbg/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gnzlbg/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2018-09-27T17:37:56Z",
    "updated_at": "2018-09-27T17:42:49Z",
    "body": "I don't think that we can, in general, detect recursion (trait objects, C FFI, etc.), so we would have to use `llvm.sideeffect` on pretty much every call site unless we can prove that the call site won't recurse. Proving no recursions for the cases in which it can be proven requires interprocedural analysis except for the most trivial programs like `fn main() { main() }`. It might be good to know what's the impact of implementing this fix, and whether there are alternative solutions to this problem.",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/425179582/reactions",
      "total_count": 2,
      "+1": 2,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/425181512",
    "html_url": "https://github.com/rust-lang/rust/issues/28728#issuecomment-425181512",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28728",
    "id": 425181512,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQyNTE4MTUxMg==",
    "user": {
      "login": "sunfishcode",
      "id": 4503403,
      "node_id": "MDQ6VXNlcjQ1MDM0MDM=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4503403?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sunfishcode",
      "html_url": "https://github.com/sunfishcode",
      "followers_url": "https://api.github.com/users/sunfishcode/followers",
      "following_url": "https://api.github.com/users/sunfishcode/following{/other_user}",
      "gists_url": "https://api.github.com/users/sunfishcode/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sunfishcode/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sunfishcode/subscriptions",
      "organizations_url": "https://api.github.com/users/sunfishcode/orgs",
      "repos_url": "https://api.github.com/users/sunfishcode/repos",
      "events_url": "https://api.github.com/users/sunfishcode/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sunfishcode/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2018-09-27T17:43:43Z",
    "updated_at": "2018-09-27T17:43:43Z",
    "body": "@gnzlbg That's true, though you could put the @llvm.sideeffects at the entries of functions, rather than at the call sites.",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/425181512/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/425665584",
    "html_url": "https://github.com/rust-lang/rust/issues/28728#issuecomment-425665584",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28728",
    "id": 425665584,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQyNTY2NTU4NA==",
    "user": {
      "login": "RalfJung",
      "id": 330628,
      "node_id": "MDQ6VXNlcjMzMDYyOA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/330628?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/RalfJung",
      "html_url": "https://github.com/RalfJung",
      "followers_url": "https://api.github.com/users/RalfJung/followers",
      "following_url": "https://api.github.com/users/RalfJung/following{/other_user}",
      "gists_url": "https://api.github.com/users/RalfJung/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/RalfJung/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/RalfJung/subscriptions",
      "organizations_url": "https://api.github.com/users/RalfJung/orgs",
      "repos_url": "https://api.github.com/users/RalfJung/repos",
      "events_url": "https://api.github.com/users/RalfJung/events{/privacy}",
      "received_events_url": "https://api.github.com/users/RalfJung/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2018-09-29T18:20:41Z",
    "updated_at": "2018-09-29T18:20:41Z",
    "body": "Strangely, I cannot reproduce the SEGFAULT in @SergioBenitez' test case locally.\r\n\r\nAlso, for a stack overflow, shouldn't there be a different error message? I thought we had some code to print \"The stack overflowed\" or so?",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/425665584/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/425839950",
    "html_url": "https://github.com/rust-lang/rust/issues/28728#issuecomment-425839950",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28728",
    "id": 425839950,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQyNTgzOTk1MA==",
    "user": {
      "login": "gnzlbg",
      "id": 904614,
      "node_id": "MDQ6VXNlcjkwNDYxNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/904614?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gnzlbg",
      "html_url": "https://github.com/gnzlbg",
      "followers_url": "https://api.github.com/users/gnzlbg/followers",
      "following_url": "https://api.github.com/users/gnzlbg/following{/other_user}",
      "gists_url": "https://api.github.com/users/gnzlbg/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gnzlbg/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gnzlbg/subscriptions",
      "organizations_url": "https://api.github.com/users/gnzlbg/orgs",
      "repos_url": "https://api.github.com/users/gnzlbg/repos",
      "events_url": "https://api.github.com/users/gnzlbg/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gnzlbg/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2018-10-01T09:13:27Z",
    "updated_at": "2018-10-01T09:16:13Z",
    "body": "@RalfJung did you try in debug mode? (I can reliably reproduce the stack overflow in debug mode in my machines and the playground, so maybe you need to fill a bug if for you this is not the case). In `--release` you won't get a stack overflow because all that code is misoptimized away. \r\n\r\n---\r\n\r\n@sunfishcode \r\n\r\n> That's true, though you could put the @llvm.sideeffects at the entries of functions, rather than at the call sites.\r\n\r\nIt's hard to tell what the best way forward would be without knowing exactly which optimizations `llvm.sideeffects` prevents. Is it worth it to try to generate as few `@llvm.sideeffects` as possible? If not, then putting it in every function call might be the most straightforward thing to do. Otherwise, IIUC, whether `@llvm.sideeffect` is needed depends on what the call site does: \r\n\r\n```rust\r\ntrait Foo {\r\n    fn foo(&self) { self.bar() }\r\n    fn bar(&self);\r\n}\r\n\r\nstruct A;\r\nimpl Foo for A {\r\n    fn bar(&self) {} // not recursive\r\n}\r\nstruct B;\r\nimpl Foo for B {\r\n    fn bar(&self) { self.foo() } // recursive\r\n}\r\n\r\nfn main() {\r\n    let a = A;\r\n    a.bar(); // Ok - no @llvm.sideeffect needed anywhere\r\n    let b = B;\r\n    b.bar(); // We need @llvm.sideeffect on this call site\r\n    let c: &[&dyn Foo] = &[&a, &b];\r\n    for i in c {\r\n        i.bar(); // We need @lvm.sideeffect here too\r\n    }\r\n}\r\n```\r\n\r\nAFAICT, we have to put `@llvm.sideeffect` inside the functions to prevent them from being removed away, so even if these \"optimizations\" were worth it, I don't think they are straightforward to do with the current model. Even if they were, these optimizations would rely on being able to prove that there is no recursion.",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/425839950/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/425845080",
    "html_url": "https://github.com/rust-lang/rust/issues/28728#issuecomment-425845080",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28728",
    "id": 425845080,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQyNTg0NTA4MA==",
    "user": {
      "login": "RalfJung",
      "id": 330628,
      "node_id": "MDQ6VXNlcjMzMDYyOA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/330628?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/RalfJung",
      "html_url": "https://github.com/RalfJung",
      "followers_url": "https://api.github.com/users/RalfJung/followers",
      "following_url": "https://api.github.com/users/RalfJung/following{/other_user}",
      "gists_url": "https://api.github.com/users/RalfJung/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/RalfJung/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/RalfJung/subscriptions",
      "organizations_url": "https://api.github.com/users/RalfJung/orgs",
      "repos_url": "https://api.github.com/users/RalfJung/repos",
      "events_url": "https://api.github.com/users/RalfJung/events{/privacy}",
      "received_events_url": "https://api.github.com/users/RalfJung/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2018-10-01T09:31:55Z",
    "updated_at": "2018-10-01T09:31:55Z",
    "body": "> did you try in debug mode? (I can reliably reproduce the stack overflow in debug mode in my machines and the playground, so maybe you need to fill a bug if for you this is not the case)\r\n\r\nSure, but in debug mode LLVM doesn't do the loop optimizations so there is no problem.\r\n\r\nIf the program stackoverflows in debug mode, that should not give LLVM license to create UB. The issue is figuring out whether the final program has UB, and from staring at the IR I cannot tell. It segfaults, but I do not know why. But it does seem like a bug to me to \"optimize\" a stackoverflowing program into one that segfaults.",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/425845080/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/425852477",
    "html_url": "https://github.com/rust-lang/rust/issues/28728#issuecomment-425852477",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28728",
    "id": 425852477,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQyNTg1MjQ3Nw==",
    "user": {
      "login": "gnzlbg",
      "id": 904614,
      "node_id": "MDQ6VXNlcjkwNDYxNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/904614?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gnzlbg",
      "html_url": "https://github.com/gnzlbg",
      "followers_url": "https://api.github.com/users/gnzlbg/followers",
      "following_url": "https://api.github.com/users/gnzlbg/following{/other_user}",
      "gists_url": "https://api.github.com/users/gnzlbg/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gnzlbg/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gnzlbg/subscriptions",
      "organizations_url": "https://api.github.com/users/gnzlbg/orgs",
      "repos_url": "https://api.github.com/users/gnzlbg/repos",
      "events_url": "https://api.github.com/users/gnzlbg/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gnzlbg/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2018-10-01T09:58:12Z",
    "updated_at": "2018-10-01T10:01:31Z",
    "body": "> If the program stackoverflows in debug mode, that should not give LLVM license to create UB.\r\n>\r\n> But it does seem like a bug to me to \"optimize\" a stackoverflowing program into one that segfaults.\r\n\r\nIn C, a thread of execution is assumed to terminate, perform volatile memory accesses, I/O, or a synchronizing atomic operation. It would be surprising to me if LLVM-IR did not evolve to have the same semantics either by accident or by design.\r\n\r\nThe Rust code contains a thread of execution that never terminates, and does not perform any of the operations required for this to not be UB in C. I'd suspect that we generate the same LLVM-IR that a C program with undefined behavior would, so I don't think it is surprising that LLVM is misoptimizing this Rust program.\r\n\r\n> It segfaults, but I do not know why. \r\n\r\nLLVM removes the infinite recursion, so as @SergioBenitez mentioned above, the program then proceeds to:\r\n\r\n> a reference to a random memory location was allowed to be constructed, and the reference was subsequently read. \r\n\r\nThe part of the program that does it is this one:\r\n\r\n```rust\r\nlet x = Container::from(\"hello\");  // invalid reference created here\r\nprintln!(\"{} {}\", x.string, x.num);  // invalid reference dereferenced here\r\n```\r\n\r\nwhere `Container::from` starts an infinite recursion, that LLVM concludes cannot ever happen, and replaces with some random value, which then gets dereferenced. You can see one of the many ways in which this gets misoptimized here: https://rust.godbolt.org/z/P7Snex On the playground (https://play.rust-lang.org/?gist=f00d41cc189f9f6897d429350f3781ec&version=stable&mode=release&edition=2015) one gets a different panic in release from debug builds due to this optimization, but UB is UB is UB.",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/425852477/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/425855637",
    "html_url": "https://github.com/rust-lang/rust/issues/28728#issuecomment-425855637",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28728",
    "id": 425855637,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQyNTg1NTYzNw==",
    "user": {
      "login": "RalfJung",
      "id": 330628,
      "node_id": "MDQ6VXNlcjMzMDYyOA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/330628?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/RalfJung",
      "html_url": "https://github.com/RalfJung",
      "followers_url": "https://api.github.com/users/RalfJung/followers",
      "following_url": "https://api.github.com/users/RalfJung/following{/other_user}",
      "gists_url": "https://api.github.com/users/RalfJung/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/RalfJung/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/RalfJung/subscriptions",
      "organizations_url": "https://api.github.com/users/RalfJung/orgs",
      "repos_url": "https://api.github.com/users/RalfJung/repos",
      "events_url": "https://api.github.com/users/RalfJung/events{/privacy}",
      "received_events_url": "https://api.github.com/users/RalfJung/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2018-10-01T10:09:44Z",
    "updated_at": "2018-10-01T10:11:12Z",
    "body": "> The Rust code contains a thread of execution that never terminates, and does not perform any of the operations required for this to not be UB in C. I'd suspect that we generate the same LLVM-IR that a C program with undefined behavior would, so I don't think it is surprising that LLVM is misoptimizing this Rust program.\r\n\r\nI was under the impression that you argued above that this is *not* the same bug as the infinite loop issue. It seems I misread your messages then. Sorry for the confusion.\r\n\r\nSo, seems like a good next step would be to sprinkle some `llvm.sideffect` into the IR we generate, and do some benchmarks?\r\n\r\n> In C, a thread of execution is assumed to terminate, perform volatile memory accesses, I/O, or a synchronizing atomic operation.\r\n\r\nBtw, this is not entirely correct -- a loop with a constant conditional (such as `while (true) { /* ... */ }`) *is* explicitly allowed by the standard, even if it does not contain any side-effects. This is different in C++. LLVM does not implement the C standard correctly here.",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/425855637/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/425882024",
    "html_url": "https://github.com/rust-lang/rust/issues/28728#issuecomment-425882024",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28728",
    "id": 425882024,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQyNTg4MjAyNA==",
    "user": {
      "login": "gnzlbg",
      "id": 904614,
      "node_id": "MDQ6VXNlcjkwNDYxNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/904614?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gnzlbg",
      "html_url": "https://github.com/gnzlbg",
      "followers_url": "https://api.github.com/users/gnzlbg/followers",
      "following_url": "https://api.github.com/users/gnzlbg/following{/other_user}",
      "gists_url": "https://api.github.com/users/gnzlbg/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gnzlbg/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gnzlbg/subscriptions",
      "organizations_url": "https://api.github.com/users/gnzlbg/orgs",
      "repos_url": "https://api.github.com/users/gnzlbg/repos",
      "events_url": "https://api.github.com/users/gnzlbg/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gnzlbg/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2018-10-01T12:00:21Z",
    "updated_at": "2018-10-01T12:03:34Z",
    "body": "> I was under the impression that you argued above that this is not the same bug as the infinite loop issue.\r\n\r\nThe behavior of non-terminating Rust programs is always defined, while the behavior of non-terminating LLVM-IR programs is only defined if certain conditions are met. \r\n\r\nI thought that this issue is about fixing the implementation of Rust for infinite loops such that the behavior of the generated LLVM-IR becomes defined, and for this, `@llvm.sideeffect`, sounded like a pretty good solution. \r\n\r\n@SergioBenitez mentioned that one can also create non-terminating Rust programs using recursion, and @rkruppe argued that infinite recursion and infinite loops are equivalent, so that these are both the same bug. \r\n\r\nI don't disagree that these two issues are related, or even that they are the same bug, but for me, these two issues look slightly different:\r\n\r\n* solution wise, we go from applying an optimization barrier (`@llvm.sideeffect`) exclusively to non-terminating loops, to apply it to every single Rust function. \r\n\r\n* value-wise, infinite `loop`s are useful because the program never terminates. For infinite recursion, whether the program terminates depends on optimization level (e.g. whether LLVM transforms the recursion into a loop or not), and when and how the program terminates depends on the platform (stack size, protected guard page, etc.). Fixing both is required to make the Rust implementation sound, but for the case of infinite recursion, if the user intended their program to recurse forever, a sound implementation would still be \"wrong\" in the sense that it won't always recurse forever. ",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/425882024/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/425887863",
    "html_url": "https://github.com/rust-lang/rust/issues/28728#issuecomment-425887863",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28728",
    "id": 425887863,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQyNTg4Nzg2Mw==",
    "user": {
      "login": "hanna-kruppe",
      "id": 2311707,
      "node_id": "MDQ6VXNlcjIzMTE3MDc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2311707?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hanna-kruppe",
      "html_url": "https://github.com/hanna-kruppe",
      "followers_url": "https://api.github.com/users/hanna-kruppe/followers",
      "following_url": "https://api.github.com/users/hanna-kruppe/following{/other_user}",
      "gists_url": "https://api.github.com/users/hanna-kruppe/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hanna-kruppe/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hanna-kruppe/subscriptions",
      "organizations_url": "https://api.github.com/users/hanna-kruppe/orgs",
      "repos_url": "https://api.github.com/users/hanna-kruppe/repos",
      "events_url": "https://api.github.com/users/hanna-kruppe/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hanna-kruppe/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2018-10-01T12:22:44Z",
    "updated_at": "2018-10-01T12:22:44Z",
    "body": "> solution wise, we go from applying an optimization barrier (@llvm.sideeffect) exclusively to non-terminating loops, to apply it to every single Rust function.\r\n\r\nThe analysis required to show that a loop body actually has side effects (not just *potentially*, as with calls to external functions) and thus doesn't need a `llvm.sideeffect` insertion is quite tricky, probably in roughly the same order of magnitude as showing the same for a function that may be part of infinite recursion. Proving that a loop is terminating is also difficult without doing a lot of optimizations first, since most Rust loops involve iterators. So I think we'd wind up putting `llvm.sideeffect` into the vast majority of loops regardless. Admittedly, there are quite a few functions that don't contain loops, but it still doesn't seem like a qualitative difference to me.",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/425887863/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/425893746",
    "html_url": "https://github.com/rust-lang/rust/issues/28728#issuecomment-425893746",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28728",
    "id": 425893746,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQyNTg5Mzc0Ng==",
    "user": {
      "login": "zackw",
      "id": 325899,
      "node_id": "MDQ6VXNlcjMyNTg5OQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/325899?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/zackw",
      "html_url": "https://github.com/zackw",
      "followers_url": "https://api.github.com/users/zackw/followers",
      "following_url": "https://api.github.com/users/zackw/following{/other_user}",
      "gists_url": "https://api.github.com/users/zackw/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/zackw/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/zackw/subscriptions",
      "organizations_url": "https://api.github.com/users/zackw/orgs",
      "repos_url": "https://api.github.com/users/zackw/repos",
      "events_url": "https://api.github.com/users/zackw/events{/privacy}",
      "received_events_url": "https://api.github.com/users/zackw/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2018-10-01T12:44:41Z",
    "updated_at": "2018-10-01T12:44:41Z",
    "body": "If I understand the problem correctly, to fix the infinite-loop case, it should be sufficient to insert `llvm.sideeffect` into `loop { ... }` and `while <compile-time constant true> { ... }` where the body of the loop contains no `break` expressions.  This captures the difference between C++ semantics and Rust semantics for infinite loops: in Rust, unlike C++, the compiler is not allowed to assume that a loop terminates when it is knowable at compile time that it _doesn't_.  (I'm not sure how much we need to worry about correctness in the face of loops where the body might panic, but that can always be improved later.)\r\n\r\nI don't know what to do about the infinite recursion, but I agree with RalfJung that optimizing an infinite recursion into an unrelated segfault is not desirable behavior.",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/425893746/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/425896968",
    "html_url": "https://github.com/rust-lang/rust/issues/28728#issuecomment-425896968",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28728",
    "id": 425896968,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQyNTg5Njk2OA==",
    "user": {
      "login": "gnzlbg",
      "id": 904614,
      "node_id": "MDQ6VXNlcjkwNDYxNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/904614?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gnzlbg",
      "html_url": "https://github.com/gnzlbg",
      "followers_url": "https://api.github.com/users/gnzlbg/followers",
      "following_url": "https://api.github.com/users/gnzlbg/following{/other_user}",
      "gists_url": "https://api.github.com/users/gnzlbg/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gnzlbg/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gnzlbg/subscriptions",
      "organizations_url": "https://api.github.com/users/gnzlbg/orgs",
      "repos_url": "https://api.github.com/users/gnzlbg/repos",
      "events_url": "https://api.github.com/users/gnzlbg/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gnzlbg/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2018-10-01T12:55:39Z",
    "updated_at": "2018-10-01T12:55:39Z",
    "body": "@zackw \r\n\r\n> If I understand the problem correctly, to fix the infinite-loop case, it should be sufficient to insert llvm.sideeffect into loop { ... } and while <compile-time constant true> { ... } where the body of the loop contains no break expressions.\r\n\r\nI don't think it's that simple, e.g., `loop { if false { break; } }` is an infinite loop that contains a `break` expression, yet we need to insert `@llvm.sideeffect` to prevent llvm from removing it. AFAICT we have to insert `@llvm.sideeffect` unless we can prove that the loop always terminates.",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/425896968/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/425909088",
    "html_url": "https://github.com/rust-lang/rust/issues/28728#issuecomment-425909088",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28728",
    "id": 425909088,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQyNTkwOTA4OA==",
    "user": {
      "login": "zackw",
      "id": 325899,
      "node_id": "MDQ6VXNlcjMyNTg5OQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/325899?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/zackw",
      "html_url": "https://github.com/zackw",
      "followers_url": "https://api.github.com/users/zackw/followers",
      "following_url": "https://api.github.com/users/zackw/following{/other_user}",
      "gists_url": "https://api.github.com/users/zackw/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/zackw/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/zackw/subscriptions",
      "organizations_url": "https://api.github.com/users/zackw/orgs",
      "repos_url": "https://api.github.com/users/zackw/repos",
      "events_url": "https://api.github.com/users/zackw/events{/privacy}",
      "received_events_url": "https://api.github.com/users/zackw/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2018-10-01T13:33:21Z",
    "updated_at": "2018-10-01T13:33:40Z",
    "body": "@gnzlbg \r\n> `loop { if false { break; } }` is an infinite loop that contains a break expression, yet we need to insert `@llvm.sideeffect` to prevent llvm from removing it.\r\n\r\nHm, yes, that's troublesome.  But we don't have to be _perfect_, just conservatively correct.  A loop like\r\n\r\n``` rust\r\nwhile spinlock.load(Ordering::SeqCst) != 0 {}\r\n```\r\n\r\n(from the `std::sync::atomic` documentation) would easily be seen not to need a `@llvm.sideeffect`, since the controlling condition is not constant (and an atomic load operation had better count as a side-effect for LLVM purposes, or we have bigger problems).  The kind of finite loop that might be emitted by a program generator,\r\n\r\n``` rust\r\nloop {\r\n    if /* runtime-variable condition */ { break }\r\n    /* more stuff */\r\n}\r\n```\r\n\r\nshould also not be troublesome.  In fact, is there any case that the \"no break expressions in the body of the loop\" rule gets wrong _besides_\r\n\r\n``` rust\r\nloop {\r\n    if /* provably false at compile time */ { break }\r\n}\r\n```\r\n\r\n?",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/425909088/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/425916372",
    "html_url": "https://github.com/rust-lang/rust/issues/28728#issuecomment-425916372",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28728",
    "id": 425916372,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQyNTkxNjM3Mg==",
    "user": {
      "login": "RalfJung",
      "id": 330628,
      "node_id": "MDQ6VXNlcjMzMDYyOA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/330628?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/RalfJung",
      "html_url": "https://github.com/RalfJung",
      "followers_url": "https://api.github.com/users/RalfJung/followers",
      "following_url": "https://api.github.com/users/RalfJung/following{/other_user}",
      "gists_url": "https://api.github.com/users/RalfJung/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/RalfJung/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/RalfJung/subscriptions",
      "organizations_url": "https://api.github.com/users/RalfJung/orgs",
      "repos_url": "https://api.github.com/users/RalfJung/repos",
      "events_url": "https://api.github.com/users/RalfJung/events{/privacy}",
      "received_events_url": "https://api.github.com/users/RalfJung/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2018-10-01T13:54:31Z",
    "updated_at": "2018-10-01T13:54:31Z",
    "body": "> I thought that this issue is about fixing the implementation of Rust for infinite loops such that the behavior of the generated LLVM-IR becomes defined, and for this, @llvm.sideeffect, sounded like a pretty good solution.\r\n\r\nFair enough. However, as you said, the issue (the mismatch between Rust semantics and LLVM semantics) is actually about non-termination, not about loops. So I think that's what we should be tracking here.\r\n\r\n@zackw \r\n> If I understand the problem correctly, to fix the infinite-loop case, it should be sufficient to insert llvm.sideeffect into loop { ... } and while <compile-time constant true> { ... } where the body of the loop contains no break expressions. This captures the difference between C++ semantics and Rust semantics for infinite loops: in Rust, unlike C++, the compiler is not allowed to assume that a loop terminates when it is knowable at compile time that it doesn't. (I'm not sure how much we need to worry about correctness in the face of loops where the body might panic, but that can always be improved later.)\r\n\r\nWhat you describe holds for C. In Rust, *any* loop is allowed to diverge. Everything else would just be unsound to do.\r\n\r\nSo, for example\r\n```rust\r\nwhile test_fermats_last_theorem_on_some_random_number() { }\r\n```\r\nis an okay program in Rust (but neither in C nor C++), and it will loop forever without causing a side-effect. So, it has to be *all* loops, except for those we can prove will terminate.",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/425916372/reactions",
      "total_count": 2,
      "+1": 2,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/425920814",
    "html_url": "https://github.com/rust-lang/rust/issues/28728#issuecomment-425920814",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28728",
    "id": 425920814,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQyNTkyMDgxNA==",
    "user": {
      "login": "gnzlbg",
      "id": 904614,
      "node_id": "MDQ6VXNlcjkwNDYxNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/904614?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gnzlbg",
      "html_url": "https://github.com/gnzlbg",
      "followers_url": "https://api.github.com/users/gnzlbg/followers",
      "following_url": "https://api.github.com/users/gnzlbg/following{/other_user}",
      "gists_url": "https://api.github.com/users/gnzlbg/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gnzlbg/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gnzlbg/subscriptions",
      "organizations_url": "https://api.github.com/users/gnzlbg/orgs",
      "repos_url": "https://api.github.com/users/gnzlbg/repos",
      "events_url": "https://api.github.com/users/gnzlbg/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gnzlbg/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2018-10-01T14:06:59Z",
    "updated_at": "2018-10-01T14:09:45Z",
    "body": "@zackw \r\n\r\n>  is there any case that the \"no break expressions in the body of the loop\" rule gets wrong besides\r\n\r\nIt's not only `if /*compile-time condition */`. All control-flow is affected (`while`, `match`, `for`, ...) and run-time conditions are affected as well. \r\n\r\n> But we don't have to be perfect, just conservatively correct.\r\n\r\nConsider:\r\n\r\n```rust\r\nfn foo(x: bool) { loop { if x { break; } } }\r\n```\r\n\r\nwhere `x` is a run-time condition. If we don't emit `@llvm.sideeffect` here, then if the user writes `foo(false)` somewhere, `foo` could be inlined and with constant propagation and dead code elimination, the loop optimized into an infinite loop without side-effects, resulting in a mis-optimization.\r\n\r\nIf that makes sense, one transformation that LLVM would be allowed to do is replacing `foo` with `foo_opt`:\r\n\r\n```rust\r\nfn foo_opt(x: bool) { if x { foo(true) } else { foo(false) } }\r\n```\r\n\r\nwhere both branches are optimized independently, and the second branch would be mis-optimized if we don't use `@llvm.sideeffect`. \r\n\r\nThat is, to be able to omit `@llvm.sideeffect`, we would need to prove that LLVM cannot mis-optimize that loop under any circumstances. The only way to prove this is to either prove that the loop always terminates, or to prove that if it does not terminate, that it unconditionally does one of the things that prevent mis-optimizations. Even then, optimizations like loop splitting/peeling could transform one loop into a series of loops, and it would be enough for one of them to not have `@llvm.sideeffect` for a mis-optimization to happen. ",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/425920814/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/425920838",
    "html_url": "https://github.com/rust-lang/rust/issues/28728#issuecomment-425920838",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28728",
    "id": 425920838,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQyNTkyMDgzOA==",
    "user": {
      "login": "Ekleog",
      "id": 411447,
      "node_id": "MDQ6VXNlcjQxMTQ0Nw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/411447?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Ekleog",
      "html_url": "https://github.com/Ekleog",
      "followers_url": "https://api.github.com/users/Ekleog/followers",
      "following_url": "https://api.github.com/users/Ekleog/following{/other_user}",
      "gists_url": "https://api.github.com/users/Ekleog/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Ekleog/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Ekleog/subscriptions",
      "organizations_url": "https://api.github.com/users/Ekleog/orgs",
      "repos_url": "https://api.github.com/users/Ekleog/repos",
      "events_url": "https://api.github.com/users/Ekleog/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Ekleog/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2018-10-01T14:07:04Z",
    "updated_at": "2018-10-01T14:07:04Z",
    "body": "Everything about this bug sounds to me like it'd be much easier to solve from LLVM than from `rustc`. (disclaimer: I don't really know the code base of either of these projects)\r\n\r\nAs I understand it, the fix from LLVM would be changing optimizations from running on (prove non-termination || can't prove either) to running only when non-termination can be proven (or the opposite). I'm not saying this is easy (in any way), but LLVM already (I guess) includes code to try to prove (non-)termination of loops.\r\n\r\nOn the other hand, `rustc` can only do this adding `@llvm.sideeffect`, which will potentially have more impact to optimization than \u201cjust\u201d disabling the optimizations that make inappropriate use of non-termination. And `rustc` would have to embed new code to try to detect (non-)termination of loops.\r\n\r\nSo I would think the path forward would be:\r\n1. Add `@llvm.sideeffect` on every loop and function call to fix the issue\r\n2. Fix LLVM to not perform wrong optimizations on non-terminating loops, and remove the `@llvm.sideeffects`\r\n\r\nWhat do you think about this? I hope the performance impact of step 1 wouldn't be too horrible, though, even if it's meant to vanish once 2 is implemented\u2026",
    "author_association": "NONE",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/425920838/reactions",
      "total_count": 3,
      "+1": 3,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/425934555",
    "html_url": "https://github.com/rust-lang/rust/issues/28728#issuecomment-425934555",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28728",
    "id": 425934555,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQyNTkzNDU1NQ==",
    "user": {
      "login": "gnzlbg",
      "id": 904614,
      "node_id": "MDQ6VXNlcjkwNDYxNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/904614?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gnzlbg",
      "html_url": "https://github.com/gnzlbg",
      "followers_url": "https://api.github.com/users/gnzlbg/followers",
      "following_url": "https://api.github.com/users/gnzlbg/following{/other_user}",
      "gists_url": "https://api.github.com/users/gnzlbg/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gnzlbg/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gnzlbg/subscriptions",
      "organizations_url": "https://api.github.com/users/gnzlbg/orgs",
      "repos_url": "https://api.github.com/users/gnzlbg/repos",
      "events_url": "https://api.github.com/users/gnzlbg/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gnzlbg/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2018-10-01T14:45:48Z",
    "updated_at": "2018-10-01T14:45:48Z",
    "body": "@Ekleog that's what @sunfishcode second patch might be about: https://lists.llvm.org/pipermail/llvm-dev/2017-October/118595.html\r\n\r\n> part of the function attribute proposal is to \r\n> change the default semantics of LLVM IR to have defined behavior on \r\n> infinite loops, and then add an attribute opting into potential-UB. So \r\n> if we do that, then the role of @llvm.sideeffect becomes a little \r\n> subtle -- it'd be a way for a frontend for a language like C to opt \r\n> into potential-UB for a function, but then opt out for individual \r\n> loops in that function.",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/425934555/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/426085772",
    "html_url": "https://github.com/rust-lang/rust/issues/28728#issuecomment-426085772",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28728",
    "id": 426085772,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQyNjA4NTc3Mg==",
    "user": {
      "login": "sunfishcode",
      "id": 4503403,
      "node_id": "MDQ6VXNlcjQ1MDM0MDM=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4503403?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sunfishcode",
      "html_url": "https://github.com/sunfishcode",
      "followers_url": "https://api.github.com/users/sunfishcode/followers",
      "following_url": "https://api.github.com/users/sunfishcode/following{/other_user}",
      "gists_url": "https://api.github.com/users/sunfishcode/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sunfishcode/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sunfishcode/subscriptions",
      "organizations_url": "https://api.github.com/users/sunfishcode/orgs",
      "repos_url": "https://api.github.com/users/sunfishcode/repos",
      "events_url": "https://api.github.com/users/sunfishcode/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sunfishcode/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2018-10-01T22:30:17Z",
    "updated_at": "2018-10-01T22:30:17Z",
    "body": "To be fair to LLVM, compiler writers don't approach this topic from the perspective of \"I'm going to write an optimization that proves loops are non-terminating, so that I can pedantically optimize them away!\" Instead, the assumption that loops will either terminate or have side effects just arises naturally in some common compiler algorithms. Fixing this isn't just a tweak to existing code; it'll require a significant amount of new complexity.\r\n\r\nConsider the following algorithm for testing whether a function body \"has no side effects\": if any instruction in the body has potential side effects, then the function body may have side effects. Nice and simple. Then later, calls to functions \"with no side effects\" are deleted. Cool. Except, branch instructions are considered to have no side effects, so a function containing only branches will appear to have no side effects, even though it may contain an infinite loop. Oops.\r\n\r\nIt is fixable. If anyone else is interested in looking into this, my basic idea is to split the concept of \"has side effects\" into independent concepts of \"has actual side effects\" and \"may be non-terminating\". And then go through the whole optimizer and find all the places that care about \"has side effects\" and figure out which concept(s) they actually need. And then teach the loop passes to add metadata to branches that aren't part of a loop, or the loops they're in are provably finite, in order to avoid pessimizations.\r\n\r\n----\r\n\r\nA possible compromise might be to have rustc insert @llvm.sideeffect when a user literally writes an empty `loop { }` (or similar) or unconditional recursion (which already has a lint). This compromise would allow people who actually do intend an infinite effectless spinning loop to get it, while avoiding any overhead for everyone else. Of course, this compromise wouldn't make it impossible to crash safe code, but it would likely reduce the chances of it happening accidentally, and it seems like it should be easy to implement.\r\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/426085772/reactions",
      "total_count": 10,
      "+1": 8,
      "-1": 2,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/426240752",
    "html_url": "https://github.com/rust-lang/rust/issues/28728#issuecomment-426240752",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28728",
    "id": 426240752,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQyNjI0MDc1Mg==",
    "user": {
      "login": "RalfJung",
      "id": 330628,
      "node_id": "MDQ6VXNlcjMzMDYyOA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/330628?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/RalfJung",
      "html_url": "https://github.com/RalfJung",
      "followers_url": "https://api.github.com/users/RalfJung/followers",
      "following_url": "https://api.github.com/users/RalfJung/following{/other_user}",
      "gists_url": "https://api.github.com/users/RalfJung/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/RalfJung/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/RalfJung/subscriptions",
      "organizations_url": "https://api.github.com/users/RalfJung/orgs",
      "repos_url": "https://api.github.com/users/RalfJung/repos",
      "events_url": "https://api.github.com/users/RalfJung/events{/privacy}",
      "received_events_url": "https://api.github.com/users/RalfJung/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2018-10-02T11:34:28Z",
    "updated_at": "2018-10-02T11:34:28Z",
    "body": "> Instead, the assumption that loops will either terminate or have side effects just arises naturally in some common compiler algorithms.\r\n\r\nIt is entirely unnatural though if you even start to think about correctness of those transformations. To be frank I still think it was a huge mistake of C to ever allow this assumption, but well.\r\n\r\n> if any instruction in the body has potential side effects, then the function body may have side effects.\r\n\r\nThere's a good reason that \"non-termination\" is typically considered an effect when you start to look at things formally. (Haskell isn't pure, it has two effects: Non-termination and exceptions.)\r\n\r\n> A possible compromise might be to have rustc insert @llvm.sideeffect when a user literally writes an empty loop { } (or similar) or unconditional recursion (which already has a lint). This compromise would allow people who actually do intend an infinite effectless spinning loop to get it, while avoiding any overhead for everyone else. Of course, this compromise wouldn't make it impossible to crash safe code, but it would likely reduce the chances of it happening accidentally, and it seems like it should be easy to implement.\r\n\r\nAs you noted yourself, this is still incorrect. I do not think we should accept a \"solution\" which we *know* to be incorrect. Compilers are such an integral part of our infrastructure, we shouldn't just hope that nothing goes wrong. This is no way to build a solid foundation.\r\n\r\n---\r\n\r\nWhat happened here is that the notion of correctness was built around what compilers did, instead of starting with \"What do we *want* from our compilers\" and then making that their specification. A correct compiler does not turn a program that *always* diverges into one that terminates, period. I find this rather self-evident, but with Rust having a reasonable type system, this is even clearly witnessed in the types, which is why the issue is surfacing regularly.\r\n\r\nGiven the constraints we are working with (namely, LLVM), what we should do is start by adding `llvm.sideeffect` in enough places such that every diverging execution is guaranteed to \"execute\" infinitely many of those. Then we have reached a reasonable (as in, sound and correct) baseline and can talk about improvements by way of removing these annotations when we can guarantee they are not needed.",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/426240752/reactions",
      "total_count": 12,
      "+1": 11,
      "-1": 1,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/426242534",
    "html_url": "https://github.com/rust-lang/rust/issues/28728#issuecomment-426242534",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28728",
    "id": 426242534,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQyNjI0MjUzNA==",
    "user": {
      "login": "RalfJung",
      "id": 330628,
      "node_id": "MDQ6VXNlcjMzMDYyOA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/330628?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/RalfJung",
      "html_url": "https://github.com/RalfJung",
      "followers_url": "https://api.github.com/users/RalfJung/followers",
      "following_url": "https://api.github.com/users/RalfJung/following{/other_user}",
      "gists_url": "https://api.github.com/users/RalfJung/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/RalfJung/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/RalfJung/subscriptions",
      "organizations_url": "https://api.github.com/users/RalfJung/orgs",
      "repos_url": "https://api.github.com/users/RalfJung/repos",
      "events_url": "https://api.github.com/users/RalfJung/events{/privacy}",
      "received_events_url": "https://api.github.com/users/RalfJung/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2018-10-02T11:41:50Z",
    "updated_at": "2018-10-02T11:42:22Z",
    "body": "To make my point more precise, I think the following is a sound Rust crate, with `pick_a_number_greater_2` returning (non-deterministically) some kind of big-int:\r\n```rust\r\nfn test_fermats_last_theorem() -> bool {\r\n  let x = pick_a_number_greater_2();\r\n  let y = pick_a_number_greater_2();\r\n  let z = pick_a_number_greater_2();\r\n  let n = pick_a_number_greater_2();\r\n  // x^n + y^n = z^n is impossible for n > 2\r\n  pow(x, n) + pow(y, n) != pow(z, n)\r\n}\r\n\r\npub fn diverge() -> ! {\r\n  while test_fermats_last_theorem() { }\r\n  // This code is unreachable, as proven by Andrew Wiles\r\n  unsafe { mem::transmute(()) }\r\n}\r\n```\r\nIf we compile away that diverging loop, that's a bug and it should be fixed.\r\n\r\nWe don't even have numbers so far for how much performance it would cost to fix this naively. Until we do, I see no reason to deliberately break programs like the above.",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/426242534/reactions",
      "total_count": 6,
      "+1": 5,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 1,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/426246809",
    "html_url": "https://github.com/rust-lang/rust/issues/28728#issuecomment-426246809",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28728",
    "id": 426246809,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQyNjI0NjgwOQ==",
    "user": {
      "login": "gnzlbg",
      "id": 904614,
      "node_id": "MDQ6VXNlcjkwNDYxNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/904614?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gnzlbg",
      "html_url": "https://github.com/gnzlbg",
      "followers_url": "https://api.github.com/users/gnzlbg/followers",
      "following_url": "https://api.github.com/users/gnzlbg/following{/other_user}",
      "gists_url": "https://api.github.com/users/gnzlbg/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gnzlbg/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gnzlbg/subscriptions",
      "organizations_url": "https://api.github.com/users/gnzlbg/orgs",
      "repos_url": "https://api.github.com/users/gnzlbg/repos",
      "events_url": "https://api.github.com/users/gnzlbg/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gnzlbg/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2018-10-02T11:59:30Z",
    "updated_at": "2018-10-02T12:01:06Z",
    "body": "In practice, `fn foo() { foo() }` will always terminate due to resource exhaustion, but since the Rust abstract machine has an infinitely large stack frame (AFAIK), it is valid to transform that code into `fn foo() { loop {} }` which will never terminate (or much later, when the universe freezes). Should this transformation be valid? I'd say yes, since otherwise we can't perform tail-call optimizations unless we can prove termination, which would be unfortunate.\r\n\r\nWould it make sense to have an `unsafe` intrinsic that states that a given loop, recursion, ... always terminates? [N1528](http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1528.htm) gives an example were, if loops cannot be assumed to terminate, loop fusion cannot be applied to pointer code traversing linked lists, because the linked lists could be circular, and proving that a linked list is not circular is not something that modern compilers can do.",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/426246809/reactions",
      "total_count": 6,
      "+1": 4,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 2,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/426247247",
    "html_url": "https://github.com/rust-lang/rust/issues/28728#issuecomment-426247247",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28728",
    "id": 426247247,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQyNjI0NzI0Nw==",
    "user": {
      "login": "hanna-kruppe",
      "id": 2311707,
      "node_id": "MDQ6VXNlcjIzMTE3MDc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2311707?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hanna-kruppe",
      "html_url": "https://github.com/hanna-kruppe",
      "followers_url": "https://api.github.com/users/hanna-kruppe/followers",
      "following_url": "https://api.github.com/users/hanna-kruppe/following{/other_user}",
      "gists_url": "https://api.github.com/users/hanna-kruppe/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hanna-kruppe/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hanna-kruppe/subscriptions",
      "organizations_url": "https://api.github.com/users/hanna-kruppe/orgs",
      "repos_url": "https://api.github.com/users/hanna-kruppe/repos",
      "events_url": "https://api.github.com/users/hanna-kruppe/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hanna-kruppe/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2018-10-02T12:01:13Z",
    "updated_at": "2018-10-02T12:01:50Z",
    "body": "I absolutely agree we need to fix this soundness issue for good. However, the way we go about that should be mindful of the possibility that \"add `llvm.sideeffect` everywhere we can't prove it's unnecessary\" may regress the code quality of programs that are compiled correctly today. While such concerns are ultimately overriden by the need to have a sound compiler, it might be prudent to proceed in a way that delays the proper fix a bit in exchange for avoiding performance regressions and improving quality of life for the average Rust programmer in the mean time. I propose:\r\n\r\n- As with other potentially-performance-regressing fixes for long-standing soundness bugs (#10184) we should implement the fix behind a -Z flag to be able to evaluate the performance impact on code bases in the wild.\r\n- If the impact turns out to be neglegible, great, we can just turn on the fix by default.\r\n- But if there are real regressions from it, we can take that data to LLVM people and try to improve LLVM first (or we could choose to eat the regression and fix it later, but in any case we'd make an informed decision)\r\n- If we decide to not turn on the fix by default due to regressions, we can at least go ahead with adding `llvm.sideeffect` to syntactically empty loops: they're rather common and them being miscompiled has lead to multiple people spending miserable hours debugging weird issues (#38136, #47537, #54214, and surely there's more), so even though this *mitigation* has no bearing on the soundness bug, it would have a tangible benefit for developers while we work out the kinks in the proper bug fix.\r\n\r\nAdmittedly, this perspective is informed by the fact that this issue has been standing for years. If it was a fresh regression, I would be more open to fixing it more quickly or reverting the PR that introduced it.",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/426247247/reactions",
      "total_count": 12,
      "+1": 12,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/451496549",
    "html_url": "https://github.com/rust-lang/rust/issues/28728#issuecomment-451496549",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28728",
    "id": 451496549,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ1MTQ5NjU0OQ==",
    "user": {
      "login": "NeoLegends",
      "id": 1683034,
      "node_id": "MDQ6VXNlcjE2ODMwMzQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1683034?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/NeoLegends",
      "html_url": "https://github.com/NeoLegends",
      "followers_url": "https://api.github.com/users/NeoLegends/followers",
      "following_url": "https://api.github.com/users/NeoLegends/following{/other_user}",
      "gists_url": "https://api.github.com/users/NeoLegends/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/NeoLegends/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/NeoLegends/subscriptions",
      "organizations_url": "https://api.github.com/users/NeoLegends/orgs",
      "repos_url": "https://api.github.com/users/NeoLegends/repos",
      "events_url": "https://api.github.com/users/NeoLegends/events{/privacy}",
      "received_events_url": "https://api.github.com/users/NeoLegends/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2019-01-04T16:38:11Z",
    "updated_at": "2019-01-04T16:39:19Z",
    "body": "Meanwhile, should this be mentioned in https://doc.rust-lang.org/beta/reference/behavior-considered-undefined.html as long as this issue is open?",
    "author_association": "NONE",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/451496549/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/490363600",
    "html_url": "https://github.com/rust-lang/rust/issues/28728#issuecomment-490363600",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28728",
    "id": 490363600,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ5MDM2MzYwMA==",
    "user": {
      "login": "eira-fransham",
      "id": 29733394,
      "node_id": "MDQ6VXNlcjI5NzMzMzk0",
      "avatar_url": "https://avatars.githubusercontent.com/u/29733394?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/eira-fransham",
      "html_url": "https://github.com/eira-fransham",
      "followers_url": "https://api.github.com/users/eira-fransham/followers",
      "following_url": "https://api.github.com/users/eira-fransham/following{/other_user}",
      "gists_url": "https://api.github.com/users/eira-fransham/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/eira-fransham/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/eira-fransham/subscriptions",
      "organizations_url": "https://api.github.com/users/eira-fransham/orgs",
      "repos_url": "https://api.github.com/users/eira-fransham/repos",
      "events_url": "https://api.github.com/users/eira-fransham/events{/privacy}",
      "received_events_url": "https://api.github.com/users/eira-fransham/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2019-05-08T06:23:09Z",
    "updated_at": "2019-05-08T06:23:09Z",
    "body": "> Would it make sense to have an `unsafe` intrinsic that states that a given loop, recursion, ... always terminates?\r\n\r\n`std::hint::reachable_unchecked`?",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/490363600/reactions",
      "total_count": 8,
      "+1": 0,
      "-1": 0,
      "laugh": 8,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/524708716",
    "html_url": "https://github.com/rust-lang/rust/issues/28728#issuecomment-524708716",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28728",
    "id": 524708716,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUyNDcwODcxNg==",
    "user": {
      "login": "rsimmonsjr",
      "id": 44960786,
      "node_id": "MDQ6VXNlcjQ0OTYwNzg2",
      "avatar_url": "https://avatars.githubusercontent.com/u/44960786?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/rsimmonsjr",
      "html_url": "https://github.com/rsimmonsjr",
      "followers_url": "https://api.github.com/users/rsimmonsjr/followers",
      "following_url": "https://api.github.com/users/rsimmonsjr/following{/other_user}",
      "gists_url": "https://api.github.com/users/rsimmonsjr/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/rsimmonsjr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/rsimmonsjr/subscriptions",
      "organizations_url": "https://api.github.com/users/rsimmonsjr/orgs",
      "repos_url": "https://api.github.com/users/rsimmonsjr/repos",
      "events_url": "https://api.github.com/users/rsimmonsjr/events{/privacy}",
      "received_events_url": "https://api.github.com/users/rsimmonsjr/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2019-08-26T04:15:18Z",
    "updated_at": "2019-08-26T04:15:18Z",
    "body": "Incidentally I ran into this writing real code for a TCP message system. I had an infinite loop as a stopgap until I put in a real mechanism for stopping but the thread exited immediately. ",
    "author_association": "NONE",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/524708716/reactions",
      "total_count": 2,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 2,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/532313125",
    "html_url": "https://github.com/rust-lang/rust/issues/28728#issuecomment-532313125",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28728",
    "id": 532313125,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUzMjMxMzEyNQ==",
    "user": {
      "login": "ExpHP",
      "id": 1411280,
      "node_id": "MDQ6VXNlcjE0MTEyODA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1411280?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ExpHP",
      "html_url": "https://github.com/ExpHP",
      "followers_url": "https://api.github.com/users/ExpHP/followers",
      "following_url": "https://api.github.com/users/ExpHP/following{/other_user}",
      "gists_url": "https://api.github.com/users/ExpHP/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ExpHP/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ExpHP/subscriptions",
      "organizations_url": "https://api.github.com/users/ExpHP/orgs",
      "repos_url": "https://api.github.com/users/ExpHP/repos",
      "events_url": "https://api.github.com/users/ExpHP/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ExpHP/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2019-09-17T17:09:56Z",
    "updated_at": "2019-09-17T17:12:29Z",
    "body": "In case anybody wanted to play test case code golf:\r\n\r\n```rust\r\nfn main() {\r\n    (|| loop {})()\r\n}\r\n```\r\n\r\n```\r\n$ cargo run --release\r\nIllegal instruction (core dumped)",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/532313125/reactions",
      "total_count": 29,
      "+1": 16,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 13
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/542410124",
    "html_url": "https://github.com/rust-lang/rust/issues/28728#issuecomment-542410124",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28728",
    "id": 542410124,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU0MjQxMDEyNA==",
    "user": {
      "login": "memoryruins",
      "id": 6868531,
      "node_id": "MDQ6VXNlcjY4Njg1MzE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6868531?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/memoryruins",
      "html_url": "https://github.com/memoryruins",
      "followers_url": "https://api.github.com/users/memoryruins/followers",
      "following_url": "https://api.github.com/users/memoryruins/following{/other_user}",
      "gists_url": "https://api.github.com/users/memoryruins/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/memoryruins/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/memoryruins/subscriptions",
      "organizations_url": "https://api.github.com/users/memoryruins/orgs",
      "repos_url": "https://api.github.com/users/memoryruins/repos",
      "events_url": "https://api.github.com/users/memoryruins/events{/privacy}",
      "received_events_url": "https://api.github.com/users/memoryruins/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2019-10-15T21:21:11Z",
    "updated_at": "2019-10-15T21:21:11Z",
    "body": "> In case anybody wanted to play test case code golf:\r\n> ```rust\r\n> pub fn main() {\r\n>    (|| loop {})()\r\n> }\r\n> ```\r\n\r\nWith the `-Z insert-sideeffect` rustc flag, added by @sfanxiang in https://github.com/rust-lang/rust/pull/59546, it keeps on looping :)\r\n\r\nbefore:\r\n```\r\nmain:\r\n  ud2\r\n```\r\nafter:\r\n```\r\nmain:\r\n.LBB0_1:\r\n  jmp .LBB0_1\r\n```",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/542410124/reactions",
      "total_count": 16,
      "+1": 9,
      "-1": 0,
      "laugh": 2,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 5,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/544630109",
    "html_url": "https://github.com/rust-lang/rust/issues/28728#issuecomment-544630109",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28728",
    "id": 544630109,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU0NDYzMDEwOQ==",
    "user": {
      "login": "bstrie",
      "id": 865233,
      "node_id": "MDQ6VXNlcjg2NTIzMw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/865233?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/bstrie",
      "html_url": "https://github.com/bstrie",
      "followers_url": "https://api.github.com/users/bstrie/followers",
      "following_url": "https://api.github.com/users/bstrie/following{/other_user}",
      "gists_url": "https://api.github.com/users/bstrie/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/bstrie/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/bstrie/subscriptions",
      "organizations_url": "https://api.github.com/users/bstrie/orgs",
      "repos_url": "https://api.github.com/users/bstrie/repos",
      "events_url": "https://api.github.com/users/bstrie/events{/privacy}",
      "received_events_url": "https://api.github.com/users/bstrie/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2019-10-21T17:50:12Z",
    "updated_at": "2019-10-21T17:50:12Z",
    "body": "By the way, the LLVM bug tracking this is https://bugs.llvm.org/show_bug.cgi?id=965 , which I haven't seen posted yet in this thread.",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/544630109/reactions",
      "total_count": 3,
      "+1": 3,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/544644375",
    "html_url": "https://github.com/rust-lang/rust/issues/28728#issuecomment-544644375",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28728",
    "id": 544644375,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU0NDY0NDM3NQ==",
    "user": {
      "login": "shepmaster",
      "id": 174509,
      "node_id": "MDQ6VXNlcjE3NDUwOQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/174509?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/shepmaster",
      "html_url": "https://github.com/shepmaster",
      "followers_url": "https://api.github.com/users/shepmaster/followers",
      "following_url": "https://api.github.com/users/shepmaster/following{/other_user}",
      "gists_url": "https://api.github.com/users/shepmaster/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/shepmaster/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/shepmaster/subscriptions",
      "organizations_url": "https://api.github.com/users/shepmaster/orgs",
      "repos_url": "https://api.github.com/users/shepmaster/repos",
      "events_url": "https://api.github.com/users/shepmaster/events{/privacy}",
      "received_events_url": "https://api.github.com/users/shepmaster/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2019-10-21T18:24:56Z",
    "updated_at": "2019-10-21T18:25:22Z",
    "body": "> which I haven't seen posted yet in this thread.\r\n\r\nhttps://github.com/rust-lang/rust/issues/28728#issuecomment-331460667 and https://github.com/rust-lang/rust/issues/28728#issuecomment-263956134",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/544644375/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/551412436",
    "html_url": "https://github.com/rust-lang/rust/issues/28728#issuecomment-551412436",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28728",
    "id": 551412436,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU1MTQxMjQzNg==",
    "user": {
      "login": "simnalamburt",
      "id": 4435445,
      "node_id": "MDQ6VXNlcjQ0MzU0NDU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4435445?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/simnalamburt",
      "html_url": "https://github.com/simnalamburt",
      "followers_url": "https://api.github.com/users/simnalamburt/followers",
      "following_url": "https://api.github.com/users/simnalamburt/following{/other_user}",
      "gists_url": "https://api.github.com/users/simnalamburt/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/simnalamburt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/simnalamburt/subscriptions",
      "organizations_url": "https://api.github.com/users/simnalamburt/orgs",
      "repos_url": "https://api.github.com/users/simnalamburt/repos",
      "events_url": "https://api.github.com/users/simnalamburt/events{/privacy}",
      "received_events_url": "https://api.github.com/users/simnalamburt/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2019-11-08T07:08:34Z",
    "updated_at": "2019-11-08T07:08:34Z",
    "body": "@RalfJung Can you update the hyperlink <https://github.com/simnalamburt/snippets/blob/master/rust/src/bin/infinite.rs> in the issue description into <https://github.com/simnalamburt/snippets/blob/12e73f45f3/rust/infinite.rs> this? The former hyperlink were broken for a long time since in was not a permalink. Thanks! \ud83d\ude1b",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/551412436/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/551452063",
    "html_url": "https://github.com/rust-lang/rust/issues/28728#issuecomment-551452063",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28728",
    "id": 551452063,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU1MTQ1MjA2Mw==",
    "user": {
      "login": "RalfJung",
      "id": 330628,
      "node_id": "MDQ6VXNlcjMzMDYyOA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/330628?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/RalfJung",
      "html_url": "https://github.com/RalfJung",
      "followers_url": "https://api.github.com/users/RalfJung/followers",
      "following_url": "https://api.github.com/users/RalfJung/following{/other_user}",
      "gists_url": "https://api.github.com/users/RalfJung/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/RalfJung/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/RalfJung/subscriptions",
      "organizations_url": "https://api.github.com/users/RalfJung/orgs",
      "repos_url": "https://api.github.com/users/RalfJung/repos",
      "events_url": "https://api.github.com/users/RalfJung/events{/privacy}",
      "received_events_url": "https://api.github.com/users/RalfJung/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2019-11-08T09:23:07Z",
    "updated_at": "2019-11-08T09:23:07Z",
    "body": "@simnalamburt done, thanks!",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/551452063/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/637880180",
    "html_url": "https://github.com/rust-lang/rust/issues/28728#issuecomment-637880180",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28728",
    "id": 637880180,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYzNzg4MDE4MA==",
    "user": {
      "login": "memoryruins",
      "id": 6868531,
      "node_id": "MDQ6VXNlcjY4Njg1MzE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6868531?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/memoryruins",
      "html_url": "https://github.com/memoryruins",
      "followers_url": "https://api.github.com/users/memoryruins/followers",
      "following_url": "https://api.github.com/users/memoryruins/following{/other_user}",
      "gists_url": "https://api.github.com/users/memoryruins/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/memoryruins/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/memoryruins/subscriptions",
      "organizations_url": "https://api.github.com/users/memoryruins/orgs",
      "repos_url": "https://api.github.com/users/memoryruins/repos",
      "events_url": "https://api.github.com/users/memoryruins/events{/privacy}",
      "received_events_url": "https://api.github.com/users/memoryruins/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2020-06-03T00:13:53Z",
    "updated_at": "2020-06-03T00:13:53Z",
    "body": "Increasing the MIR opt level appears to avoid the misoptimization in the following case:\r\n\r\n```rust\r\npub fn main() {\r\n   (|| loop {})()\r\n}\r\n```\r\n\r\n`--emit=llvm-ir -C opt-level=1 `\r\n```llvm\r\ndefine void @_ZN7example4main17hf7943ea78b0ea0b0E() unnamed_addr #0 !dbg !6 {\r\n  unreachable\r\n}\r\n```\r\n\r\n`--emit=llvm-ir  -C opt-level=1 -Z mir-opt-level=2`\r\n```llvm\r\ndefine void @_ZN7example4main17hf7943ea78b0ea0b0E() unnamed_addr #0 !dbg !6 {\r\n  br label %bb1, !dbg !10\r\n\r\nbb1:                                              ; preds = %bb1, %start\r\n  br label %bb1, !dbg !11\r\n}\r\n```\r\n\r\nhttps://godbolt.org/z/N7VHnj \r\n\r\n`rustc 1.45.0-nightly (5fd2f06e9 2020-05-31)` \r\n\r\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/637880180/reactions",
      "total_count": 1,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 1,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/637884651",
    "html_url": "https://github.com/rust-lang/rust/issues/28728#issuecomment-637884651",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28728",
    "id": 637884651,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYzNzg4NDY1MQ==",
    "user": {
      "login": "nbdd0121",
      "id": 4065244,
      "node_id": "MDQ6VXNlcjQwNjUyNDQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4065244?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nbdd0121",
      "html_url": "https://github.com/nbdd0121",
      "followers_url": "https://api.github.com/users/nbdd0121/followers",
      "following_url": "https://api.github.com/users/nbdd0121/following{/other_user}",
      "gists_url": "https://api.github.com/users/nbdd0121/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nbdd0121/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nbdd0121/subscriptions",
      "organizations_url": "https://api.github.com/users/nbdd0121/orgs",
      "repos_url": "https://api.github.com/users/nbdd0121/repos",
      "events_url": "https://api.github.com/users/nbdd0121/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nbdd0121/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2020-06-03T00:29:23Z",
    "updated_at": "2020-06-03T00:29:23Z",
    "body": "```Rust\r\npub fn oops() {\r\n   (|| loop {})() \r\n}\r\n\r\npub fn main() {\r\n   oops()\r\n}\r\n```\r\nIt helped with that special case but does not solve the issue in general. https://godbolt.org/z/5hv87d\r\n\r\nIn general this issue can only be solved when either rustc or LLVM can prove a pure function is total before using any relevant optimisations.",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/637884651/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/637894206",
    "html_url": "https://github.com/rust-lang/rust/issues/28728#issuecomment-637894206",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28728",
    "id": 637894206,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYzNzg5NDIwNg==",
    "user": {
      "login": "memoryruins",
      "id": 6868531,
      "node_id": "MDQ6VXNlcjY4Njg1MzE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6868531?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/memoryruins",
      "html_url": "https://github.com/memoryruins",
      "followers_url": "https://api.github.com/users/memoryruins/followers",
      "following_url": "https://api.github.com/users/memoryruins/following{/other_user}",
      "gists_url": "https://api.github.com/users/memoryruins/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/memoryruins/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/memoryruins/subscriptions",
      "organizations_url": "https://api.github.com/users/memoryruins/orgs",
      "repos_url": "https://api.github.com/users/memoryruins/repos",
      "events_url": "https://api.github.com/users/memoryruins/events{/privacy}",
      "received_events_url": "https://api.github.com/users/memoryruins/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2020-06-03T01:07:08Z",
    "updated_at": "2020-06-03T01:07:08Z",
    "body": "Indeed, I wasn't asserting that it solved the issue. The subtle effect was interesting enough to others that it seemed worth mentioning here too. `-Z insert-sideeffect` continues to correct both cases.",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/637894206/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/669799725",
    "html_url": "https://github.com/rust-lang/rust/issues/28728#issuecomment-669799725",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28728",
    "id": 669799725,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY2OTc5OTcyNQ==",
    "user": {
      "login": "RalfJung",
      "id": 330628,
      "node_id": "MDQ6VXNlcjMzMDYyOA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/330628?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/RalfJung",
      "html_url": "https://github.com/RalfJung",
      "followers_url": "https://api.github.com/users/RalfJung/followers",
      "following_url": "https://api.github.com/users/RalfJung/following{/other_user}",
      "gists_url": "https://api.github.com/users/RalfJung/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/RalfJung/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/RalfJung/subscriptions",
      "organizations_url": "https://api.github.com/users/RalfJung/orgs",
      "repos_url": "https://api.github.com/users/RalfJung/repos",
      "events_url": "https://api.github.com/users/RalfJung/events{/privacy}",
      "received_events_url": "https://api.github.com/users/RalfJung/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2020-08-06T08:48:30Z",
    "updated_at": "2020-08-06T08:48:30Z",
    "body": "Something is moving on the LLVM side: there's a proposal to add a function-level attribute to control progress guarantees. https://reviews.llvm.org/D85393",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/669799725/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/670826536",
    "html_url": "https://github.com/rust-lang/rust/issues/28728#issuecomment-670826536",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28728",
    "id": 670826536,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY3MDgyNjUzNg==",
    "user": {
      "login": "olotenko",
      "id": 50115426,
      "node_id": "MDQ6VXNlcjUwMTE1NDI2",
      "avatar_url": "https://avatars.githubusercontent.com/u/50115426?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/olotenko",
      "html_url": "https://github.com/olotenko",
      "followers_url": "https://api.github.com/users/olotenko/followers",
      "following_url": "https://api.github.com/users/olotenko/following{/other_user}",
      "gists_url": "https://api.github.com/users/olotenko/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/olotenko/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/olotenko/subscriptions",
      "organizations_url": "https://api.github.com/users/olotenko/orgs",
      "repos_url": "https://api.github.com/users/olotenko/repos",
      "events_url": "https://api.github.com/users/olotenko/events{/privacy}",
      "received_events_url": "https://api.github.com/users/olotenko/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2020-08-08T05:21:27Z",
    "updated_at": "2020-08-08T05:21:27Z",
    "body": "I am not sure why everyone (here and on the LLVM threads) seems to be emphasizing the clause about forward progress.\r\n\r\nThe elimination of the loop seems to be a direct consequence of a memory model: computations of values are allowed to be moved about, as long as they happen-before the use of the value. Now, if there is a proof there can be no use of the value, it is the proof that there is no happens-before, and the code can be moved infinitely far into the future, and still satisfy the memory model.\r\n\r\nOr, if you are not familiar with memory models, consider that the entire loop is abstracted away into a function computing a value. Now replace all reads of the value outside the loop by a call of that function. This transformation certainly is valid. Now, if there are no uses of the value, there are no invocations of the function that does the infinite loop.",
    "author_association": "NONE",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/670826536/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/670845730",
    "html_url": "https://github.com/rust-lang/rust/issues/28728#issuecomment-670845730",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28728",
    "id": 670845730,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY3MDg0NTczMA==",
    "user": {
      "login": "RalfJung",
      "id": 330628,
      "node_id": "MDQ6VXNlcjMzMDYyOA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/330628?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/RalfJung",
      "html_url": "https://github.com/RalfJung",
      "followers_url": "https://api.github.com/users/RalfJung/followers",
      "following_url": "https://api.github.com/users/RalfJung/following{/other_user}",
      "gists_url": "https://api.github.com/users/RalfJung/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/RalfJung/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/RalfJung/subscriptions",
      "organizations_url": "https://api.github.com/users/RalfJung/orgs",
      "repos_url": "https://api.github.com/users/RalfJung/repos",
      "events_url": "https://api.github.com/users/RalfJung/events{/privacy}",
      "received_events_url": "https://api.github.com/users/RalfJung/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2020-08-08T08:40:03Z",
    "updated_at": "2020-08-08T08:42:00Z",
    "body": "> computations of values are allowed to be moved about, as long as they happen-before the use of the value. Now, if there is a proof there can be no use of the value, it is the proof that there is no happens-before, and the code can be moved infinitely far into the future, and still satisfy the memory model.\r\n\r\nThis statement is correct only if that computation is guaranteed to terminate. Non-termination is a side-effect, and just like you may not remove a computation that prints to stdout (it is \"not pure\"), you may not remove a computation that does not terminate.\r\n\r\nIt is not okay to remove the following function call, even if the result is unused:\r\n```rust\r\nfn sideeffect() -> u32 {\r\n  println!(\"Hello!\");\r\n  42\r\n}\r\n\r\nfn main() {\r\n  let _ = sideffect(); // May not be removed.\r\n}\r\n```\r\n\r\nThis is true for any kind of side-effect, and it remains true when you replace the print by a `loop {}`.",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/670845730/reactions",
      "total_count": 6,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 5,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/671040815",
    "html_url": "https://github.com/rust-lang/rust/issues/28728#issuecomment-671040815",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28728",
    "id": 671040815,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY3MTA0MDgxNQ==",
    "user": {
      "login": "olotenko",
      "id": 50115426,
      "node_id": "MDQ6VXNlcjUwMTE1NDI2",
      "avatar_url": "https://avatars.githubusercontent.com/u/50115426?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/olotenko",
      "html_url": "https://github.com/olotenko",
      "followers_url": "https://api.github.com/users/olotenko/followers",
      "following_url": "https://api.github.com/users/olotenko/following{/other_user}",
      "gists_url": "https://api.github.com/users/olotenko/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/olotenko/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/olotenko/subscriptions",
      "organizations_url": "https://api.github.com/users/olotenko/orgs",
      "repos_url": "https://api.github.com/users/olotenko/repos",
      "events_url": "https://api.github.com/users/olotenko/events{/privacy}",
      "received_events_url": "https://api.github.com/users/olotenko/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2020-08-09T11:34:12Z",
    "updated_at": "2020-08-09T11:34:12Z",
    "body": "The claim about non-termination as a side-effect requires not only an agreement that it is (that is non-controversial), but also an agreement about _when_ it should be observed.\r\n\r\nNon-termination sure is observed, if the loop computes the value. Non-termination is not observed, if you are allowed to re-order the computations that do not depend on the loop's outcome.\r\n\r\nLike the example on the LLVM thread.\r\n```\r\nx = y % 42;\r\nif y < 0 return 0;\r\n...\r\n```\r\nThe termination properties of the division have nothing to do with reordering. The modern CPUs will attempt to execute the division, the comparison, the branch prediction and prefetching of the successful branch in parallel. So you are not guaranteed to observe the division completed at the time you observe `0` returned, if `y` is negative. (By \"observe\" here I mean really measuring with an oscillometer where the CPU is at, not by the program)\r\n\r\nIf you can't observe the division completed, you can't observe the division started. So the division in the example above would usually allowed to be reordered, which is what a compiler might do:\r\n```\r\nif y < 0 return 0;\r\nx = y % 42;\r\n...\r\n```\r\nI say \"usually\", because maybe there are languages where this is not allowed. I don't know if Rust is such a language.\r\n\r\nPure loops are no different.\r\n\r\n---\r\n\r\nI am not saying it is not a problem. I am only saying forward progress guarantee is not the thing that allows it to happen.",
    "author_association": "NONE",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/671040815/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/671041563",
    "html_url": "https://github.com/rust-lang/rust/issues/28728#issuecomment-671041563",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28728",
    "id": 671041563,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY3MTA0MTU2Mw==",
    "user": {
      "login": "RalfJung",
      "id": 330628,
      "node_id": "MDQ6VXNlcjMzMDYyOA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/330628?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/RalfJung",
      "html_url": "https://github.com/RalfJung",
      "followers_url": "https://api.github.com/users/RalfJung/followers",
      "following_url": "https://api.github.com/users/RalfJung/following{/other_user}",
      "gists_url": "https://api.github.com/users/RalfJung/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/RalfJung/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/RalfJung/subscriptions",
      "organizations_url": "https://api.github.com/users/RalfJung/orgs",
      "repos_url": "https://api.github.com/users/RalfJung/repos",
      "events_url": "https://api.github.com/users/RalfJung/events{/privacy}",
      "received_events_url": "https://api.github.com/users/RalfJung/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2020-08-09T11:42:14Z",
    "updated_at": "2020-08-09T11:45:16Z",
    "body": "> The claim about non-termination as a side-effect requires not only an agreement that it is (that is non-controversial), but also an agreement about when it should be observed.\r\n\r\nWhat I am expressing is the consensus of the entire research field of programming languages and compilers. Sure you are free to disagree, but then you might as well re-define terms like \"compiler correctness\" -- it's not helpful for a discussion with others.\r\n\r\nWhat the permissible observations are is always defined on the source level. The language specification defines an \"Abstract Machine\", which describes (ideally in painstaking mathematical detail) what the permissible observable behaviors of a program are. This document does not talk about any optimizations.\r\n\r\nCorrectness of a compiler is then measured in whether the programs it produces only exhibit observable behaviors that the spec says the source program can have. This is how every single programming language that takes correctness seriously works, and it is the only way we know for how to capture in a precise way when a compiler is correct.\r\n\r\nWhat is up to each language is to define what exactly is considered observable at the source level, and which source behaviors are considered \"undefined\" and thus may be assumed by the compiler to never occur. This issue arises because C++ says that an infinite loop with no other side-effects (\"silent divergence\") is undefined behavior, but Rust does not say such a thing. This means that non-termination in Rust is always observable, and must be preserved by the compiler. Most programming languages make this choice, because the C++ choice can make it very easy to accidentally introduce undefined behavior (and thus critical bugs) into a program. Rust makes a promise that no undefined behavior can arise from safe code, and since safe code can contain infinite loops, it follows that infinite loops in Rust must be defined (and thus preserved) behavior.\r\n\r\nIf these things are confusing, I suggest doing some background reading. I can recommend \"Types and Programming Languages\" by Benjamin Pierce. You'll probably also find plenty of blog posts out there, though it can be hard to judge how well-informed the author really is.",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/671041563/reactions",
      "total_count": 12,
      "+1": 5,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 7,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/671061657",
    "html_url": "https://github.com/rust-lang/rust/issues/28728#issuecomment-671061657",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28728",
    "id": 671061657,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY3MTA2MTY1Nw==",
    "user": {
      "login": "zackw",
      "id": 325899,
      "node_id": "MDQ6VXNlcjMyNTg5OQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/325899?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/zackw",
      "html_url": "https://github.com/zackw",
      "followers_url": "https://api.github.com/users/zackw/followers",
      "following_url": "https://api.github.com/users/zackw/following{/other_user}",
      "gists_url": "https://api.github.com/users/zackw/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/zackw/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/zackw/subscriptions",
      "organizations_url": "https://api.github.com/users/zackw/orgs",
      "repos_url": "https://api.github.com/users/zackw/repos",
      "events_url": "https://api.github.com/users/zackw/events{/privacy}",
      "received_events_url": "https://api.github.com/users/zackw/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2020-08-09T14:54:01Z",
    "updated_at": "2020-08-09T14:56:28Z",
    "body": "For concreteness, if your division example were changed to\r\n\r\n```\r\nx = 42 % y;\r\nif y <= 0 { return 0; }\r\n```\r\n\r\nthen I hope you would agree that the conditional _cannot_ be hoisted above the division, because that would change the observable behavior when y is zero (from crashing to returning zero).\r\n\r\nIn the same way, in\r\n\r\n```\r\nx = if y == 0 { loop {} } else { y % 42 };\r\nif y < 0 { return 0; }\r\n```\r\n\r\nthe Rust abstract machine allows this to be rewritten as\r\n\r\n```\r\nif y == 0 { loop {} }\r\nelse if y < 0 { return 0; }\r\nx = y % 42;\r\n```\r\n\r\nbut the first condition and the loop cannot be discarded.",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/671061657/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/671176626",
    "html_url": "https://github.com/rust-lang/rust/issues/28728#issuecomment-671176626",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28728",
    "id": 671176626,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY3MTE3NjYyNg==",
    "user": {
      "login": "olotenko",
      "id": 50115426,
      "node_id": "MDQ6VXNlcjUwMTE1NDI2",
      "avatar_url": "https://avatars.githubusercontent.com/u/50115426?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/olotenko",
      "html_url": "https://github.com/olotenko",
      "followers_url": "https://api.github.com/users/olotenko/followers",
      "following_url": "https://api.github.com/users/olotenko/following{/other_user}",
      "gists_url": "https://api.github.com/users/olotenko/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/olotenko/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/olotenko/subscriptions",
      "organizations_url": "https://api.github.com/users/olotenko/orgs",
      "repos_url": "https://api.github.com/users/olotenko/repos",
      "events_url": "https://api.github.com/users/olotenko/events{/privacy}",
      "received_events_url": "https://api.github.com/users/olotenko/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2020-08-10T06:02:29Z",
    "updated_at": "2020-08-10T06:03:05Z",
    "body": "Ralf, I don't pretend to know half of what you do, and I don't want to introduce new meanings. I totally agree with the definition of what the correctness is (the execution order must correspond to the program order). I only thought the \"when\" the non-termination is observable was part of it, as in: if you aren't watching the loop outcome, you don't have a witness of its termination (so can't claim its incorrectness). I need to revisit the execution model.\r\n\r\nThank you for bearing with me",
    "author_association": "NONE",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/671176626/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/671177604",
    "html_url": "https://github.com/rust-lang/rust/issues/28728#issuecomment-671177604",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28728",
    "id": 671177604,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY3MTE3NzYwNA==",
    "user": {
      "login": "olotenko",
      "id": 50115426,
      "node_id": "MDQ6VXNlcjUwMTE1NDI2",
      "avatar_url": "https://avatars.githubusercontent.com/u/50115426?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/olotenko",
      "html_url": "https://github.com/olotenko",
      "followers_url": "https://api.github.com/users/olotenko/followers",
      "following_url": "https://api.github.com/users/olotenko/following{/other_user}",
      "gists_url": "https://api.github.com/users/olotenko/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/olotenko/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/olotenko/subscriptions",
      "organizations_url": "https://api.github.com/users/olotenko/orgs",
      "repos_url": "https://api.github.com/users/olotenko/repos",
      "events_url": "https://api.github.com/users/olotenko/events{/privacy}",
      "received_events_url": "https://api.github.com/users/olotenko/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2020-08-10T06:05:35Z",
    "updated_at": "2020-08-10T06:05:35Z",
    "body": "@zackw Thank you. That's different code, which of course will result in a different optimization.\r\n\r\nMy premise about the loops being optimized the same way as the division was flawed (can't see the outcome of division == can't see the loop terminate), so the rest doesn't matter.",
    "author_association": "NONE",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/671177604/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/671247912",
    "html_url": "https://github.com/rust-lang/rust/issues/28728#issuecomment-671247912",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28728",
    "id": 671247912,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY3MTI0NzkxMg==",
    "user": {
      "login": "RalfJung",
      "id": 330628,
      "node_id": "MDQ6VXNlcjMzMDYyOA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/330628?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/RalfJung",
      "html_url": "https://github.com/RalfJung",
      "followers_url": "https://api.github.com/users/RalfJung/followers",
      "following_url": "https://api.github.com/users/RalfJung/following{/other_user}",
      "gists_url": "https://api.github.com/users/RalfJung/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/RalfJung/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/RalfJung/subscriptions",
      "organizations_url": "https://api.github.com/users/RalfJung/orgs",
      "repos_url": "https://api.github.com/users/RalfJung/repos",
      "events_url": "https://api.github.com/users/RalfJung/events{/privacy}",
      "received_events_url": "https://api.github.com/users/RalfJung/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2020-08-10T09:16:10Z",
    "updated_at": "2020-08-10T09:16:10Z",
    "body": "@olotenko I don't know what you mean by \"watching the loop outcome\". A non-terminating loop makes the entire program diverge, which is considered *observable behavior* -- this means it is observable *outside* the program. As in, the user can run the program and see that it goes on forever. A program that goes on forever may not be compiled into a program that terminates, because that changes what the user can observe about the program.\r\n\r\nIt doesn't matter what that loop was computing or if the \"return value\" of the loop is used or not. What matters is what the user can observe when running the program. The compiler must make sure that this observable behavior stays the same. Non-termination is considered observable.\r\n\r\nTo give another example:\r\n```rust\r\nfn main() {\r\n  loop {}\r\n  println!(\"Hello\");\r\n}\r\n```\r\nThis program will never print anything, because of the loop. But if you optimized the loop away (or reordered the loop with the print), suddenly the program would print \"Hello\". Thus these optimizations change the observable behavior of the program, and are disallowed.",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/671247912/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/671264465",
    "html_url": "https://github.com/rust-lang/rust/issues/28728#issuecomment-671264465",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28728",
    "id": 671264465,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY3MTI2NDQ2NQ==",
    "user": {
      "login": "olotenko",
      "id": 50115426,
      "node_id": "MDQ6VXNlcjUwMTE1NDI2",
      "avatar_url": "https://avatars.githubusercontent.com/u/50115426?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/olotenko",
      "html_url": "https://github.com/olotenko",
      "followers_url": "https://api.github.com/users/olotenko/followers",
      "following_url": "https://api.github.com/users/olotenko/following{/other_user}",
      "gists_url": "https://api.github.com/users/olotenko/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/olotenko/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/olotenko/subscriptions",
      "organizations_url": "https://api.github.com/users/olotenko/orgs",
      "repos_url": "https://api.github.com/users/olotenko/repos",
      "events_url": "https://api.github.com/users/olotenko/events{/privacy}",
      "received_events_url": "https://api.github.com/users/olotenko/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2020-08-10T09:54:59Z",
    "updated_at": "2020-08-10T09:57:00Z",
    "body": "@RalfJung it's ok, I got it now. My original problem was what role the \"forward progress guarantee\" plays here. The optimization is possible entirely from data dependency. My mistake was that actually data dependency is not part of the program order: it is literally the expressions totally ordered as per language semantics. If the program order is total, then without forward progress guarantee (which we can restate as \"any sub-path of program order is finite\") we can reorder (in the execution order) only the expressions that we can _prove_ as terminating (and preserving a few other properties, like observability of synchronization actions, OS calls, IO, etc).\r\n\r\nI need to think some more about it, but I think I can see the reason why we can \"pretend\" division happened in the example with `x = y % 42`, even if it doesn't really get executed for some inputs, but why the same does not apply to arbitrary loops. I mean, the subtleties of the correspondence of the total (program) order and the partial (execution) order.\r\n\r\nI think \"observable behaviour\" may be a little more subtle than that, as an infinite recursion will end up with a stack overflow crash (\"terminates\" in the sense of a \"user observing the outcome\"), but a tail-call optimization will turn it into a non-terminating loop. At least this is one other thing that Rust / LLVM will do. But we don't have to discuss that question  as that is not really what my problem was about (unless you want to! I sure am glad to understand if that is expected).",
    "author_association": "NONE",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/671264465/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/671273227",
    "html_url": "https://github.com/rust-lang/rust/issues/28728#issuecomment-671273227",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28728",
    "id": 671273227,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY3MTI3MzIyNw==",
    "user": {
      "login": "RalfJung",
      "id": 330628,
      "node_id": "MDQ6VXNlcjMzMDYyOA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/330628?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/RalfJung",
      "html_url": "https://github.com/RalfJung",
      "followers_url": "https://api.github.com/users/RalfJung/followers",
      "following_url": "https://api.github.com/users/RalfJung/following{/other_user}",
      "gists_url": "https://api.github.com/users/RalfJung/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/RalfJung/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/RalfJung/subscriptions",
      "organizations_url": "https://api.github.com/users/RalfJung/orgs",
      "repos_url": "https://api.github.com/users/RalfJung/repos",
      "events_url": "https://api.github.com/users/RalfJung/events{/privacy}",
      "received_events_url": "https://api.github.com/users/RalfJung/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2020-08-10T10:15:37Z",
    "updated_at": "2020-08-10T10:16:54Z",
    "body": "> stack overflow \r\n\r\nStack overflows are challenging to model indeed, good question. Same for out-of-memory situations. As a first approxmation, we formally pretend they do not happen. A better approach is to say that any time you call a function, you *may* get an error due to stack overflow, or the program may continue -- this is a non-deterministic choice made on each call. This way you can soundly approximate what actually happens.\r\n\r\n> we can reorder (in the execution order) only the expressions that we can prove as terminating\r\n\r\nIndeed. Morevoer they have to be \"pure\", i.e., side-effect-free -- you cannot reorder two `println!`. That's why we usually consider non-termination an effect as well, because then this all reduces to \"pure expressions can be reordered\", and \"non-terminating expressions are impure\" (impure = has a side-effect).\r\n\r\nDivison is also potentially impure, but only when dividing by 0 -- which causes a panic, i.e., a control effect. This is not directly observable but indirectly (e.g. by having the panic handler print something to stdout, which is then observable). Thus division can only be reordered of we are sure we are not dividing by 0.",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/671273227/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/671390637",
    "html_url": "https://github.com/rust-lang/rust/issues/28728#issuecomment-671390637",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28728",
    "id": 671390637,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY3MTM5MDYzNw==",
    "user": {
      "login": "uglyoldbob",
      "id": 921714,
      "node_id": "MDQ6VXNlcjkyMTcxNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/921714?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/uglyoldbob",
      "html_url": "https://github.com/uglyoldbob",
      "followers_url": "https://api.github.com/users/uglyoldbob/followers",
      "following_url": "https://api.github.com/users/uglyoldbob/following{/other_user}",
      "gists_url": "https://api.github.com/users/uglyoldbob/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/uglyoldbob/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/uglyoldbob/subscriptions",
      "organizations_url": "https://api.github.com/users/uglyoldbob/orgs",
      "repos_url": "https://api.github.com/users/uglyoldbob/repos",
      "events_url": "https://api.github.com/users/uglyoldbob/events{/privacy}",
      "received_events_url": "https://api.github.com/users/uglyoldbob/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2020-08-10T14:30:31Z",
    "updated_at": "2020-08-10T14:30:31Z",
    "body": "I have some demo code that I think might be this issue but I am not entirely sure. If necessary I can put this in a new bug report.\r\nI put the code for it in a git repo at [https://github.com/uglyoldbob/rust_demo](url)\r\n\r\nMy infinite loop (with side effects) is optimized out and a trap instruction is generated.",
    "author_association": "NONE",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/671390637/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/671527319",
    "html_url": "https://github.com/rust-lang/rust/issues/28728#issuecomment-671527319",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28728",
    "id": 671527319,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY3MTUyNzMxOQ==",
    "user": {
      "login": "RalfJung",
      "id": 330628,
      "node_id": "MDQ6VXNlcjMzMDYyOA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/330628?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/RalfJung",
      "html_url": "https://github.com/RalfJung",
      "followers_url": "https://api.github.com/users/RalfJung/followers",
      "following_url": "https://api.github.com/users/RalfJung/following{/other_user}",
      "gists_url": "https://api.github.com/users/RalfJung/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/RalfJung/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/RalfJung/subscriptions",
      "organizations_url": "https://api.github.com/users/RalfJung/orgs",
      "repos_url": "https://api.github.com/users/RalfJung/repos",
      "events_url": "https://api.github.com/users/RalfJung/events{/privacy}",
      "received_events_url": "https://api.github.com/users/RalfJung/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2020-08-10T18:52:16Z",
    "updated_at": "2020-08-10T18:52:16Z",
    "body": "I have no idea if that is an instance of this problem or something else... embedded devices are not my specialty at all and with all these external crate dependencies I have no idea what else that code is doing.^^ But your program is *not* safe and it *does* have a volatile access in the loop, so I'd say it is a separate problem. When I [put your example on the playground](https://play.rust-lang.org/?version=stable&mode=release&edition=2018&gist=7fc56f5c8b80573f1666dcb9123824c9), I think it is compiled correctly, so I'd suspect the problem is with one of the extra dependencies.",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/671527319/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/671532008",
    "html_url": "https://github.com/rust-lang/rust/issues/28728#issuecomment-671532008",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28728",
    "id": 671532008,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY3MTUzMjAwOA==",
    "user": {
      "login": "olotenko",
      "id": 50115426,
      "node_id": "MDQ6VXNlcjUwMTE1NDI2",
      "avatar_url": "https://avatars.githubusercontent.com/u/50115426?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/olotenko",
      "html_url": "https://github.com/olotenko",
      "followers_url": "https://api.github.com/users/olotenko/followers",
      "following_url": "https://api.github.com/users/olotenko/following{/other_user}",
      "gists_url": "https://api.github.com/users/olotenko/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/olotenko/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/olotenko/subscriptions",
      "organizations_url": "https://api.github.com/users/olotenko/orgs",
      "repos_url": "https://api.github.com/users/olotenko/repos",
      "events_url": "https://api.github.com/users/olotenko/events{/privacy}",
      "received_events_url": "https://api.github.com/users/olotenko/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2020-08-10T19:02:25Z",
    "updated_at": "2020-08-10T19:02:25Z",
    "body": "It seems everything in the loop is a reference to a local variable (none escaped to any other thread). In these circumstances it is easy to prove the absence of volatile stores and the absence of observable effects (no stores they can synchronize with). If Rust doesn't add special meaning to volatiles, then this loop can be reduced to a pure infinite loop.",
    "author_association": "NONE",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/671532008/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/671788859",
    "html_url": "https://github.com/rust-lang/rust/issues/28728#issuecomment-671788859",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28728",
    "id": 671788859,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY3MTc4ODg1OQ==",
    "user": {
      "login": "comex",
      "id": 47517,
      "node_id": "MDQ6VXNlcjQ3NTE3",
      "avatar_url": "https://avatars.githubusercontent.com/u/47517?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/comex",
      "html_url": "https://github.com/comex",
      "followers_url": "https://api.github.com/users/comex/followers",
      "following_url": "https://api.github.com/users/comex/following{/other_user}",
      "gists_url": "https://api.github.com/users/comex/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/comex/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/comex/subscriptions",
      "organizations_url": "https://api.github.com/users/comex/orgs",
      "repos_url": "https://api.github.com/users/comex/repos",
      "events_url": "https://api.github.com/users/comex/events{/privacy}",
      "received_events_url": "https://api.github.com/users/comex/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2020-08-11T07:50:51Z",
    "updated_at": "2020-08-11T07:51:50Z",
    "body": "@uglyoldbob What's really happening in your example would be more clear if `llvm-objdump` weren't being spectacularly unhelpful (and inaccurate).  That `bl #4` (which is not actually valid assembly syntax) here means branch to 4 bytes after the end of the `bl` instruction, aka the end of the `main` function, aka the start of the next function.  The next function is called (when I build it) `_ZN11broken_loop18__cortex_m_rt_main17hbe300c9f0053d54dE`, and *that* is your actual `main` function.  The function with the unmangled name `main` is not your function, but a completely different function [generated by](https://github.com/rust-embedded/cortex-m-rt/blob/master/macros/src/lib.rs#L104) the `#[entry]` macro provided by `cortex-m-rt`.  Your code is not actually being optimized away.  (In fact, the optimizer isn't even running since you're building in debug mode.)\r\n\r\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/671788859/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/757550183",
    "html_url": "https://github.com/rust-lang/rust/issues/28728#issuecomment-757550183",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28728",
    "id": 757550183,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc1NzU1MDE4Mw==",
    "user": {
      "login": "brson",
      "id": 147214,
      "node_id": "MDQ6VXNlcjE0NzIxNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/brson",
      "html_url": "https://github.com/brson",
      "followers_url": "https://api.github.com/users/brson/followers",
      "following_url": "https://api.github.com/users/brson/following{/other_user}",
      "gists_url": "https://api.github.com/users/brson/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/brson/subscriptions",
      "organizations_url": "https://api.github.com/users/brson/orgs",
      "repos_url": "https://api.github.com/users/brson/repos",
      "events_url": "https://api.github.com/users/brson/events{/privacy}",
      "received_events_url": "https://api.github.com/users/brson/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2021-01-10T21:51:51Z",
    "updated_at": "2021-01-10T21:57:28Z",
    "body": "I don't see it mentioned here: LLVM now has a \"mustprogress\" attribute:\r\n\r\n- added here: https://reviews.llvm.org/D85393\r\n- described in the manual: https://www.llvm.org/docs/LangRef.html\r\n\r\nIt appears to implement the proposal from [way back in 2015](https://lists.llvm.org/pipermail/llvm-dev/2015-July/088095.html), wherein C/C++ must annotate their functions \"mustprogress\" to enable these types of optimizations. The way it reads to me is that Rust _should_ stop miscompiling these situations in the future just by not using this attribute.\r\n\r\nEdit: oh I see @RalfJung linked this previously in some collapsed comments.",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/757550183/reactions",
      "total_count": 5,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 5,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/762423907",
    "html_url": "https://github.com/rust-lang/rust/issues/28728#issuecomment-762423907",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28728",
    "id": 762423907,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc2MjQyMzkwNw==",
    "user": {
      "login": "shepmaster",
      "id": 174509,
      "node_id": "MDQ6VXNlcjE3NDUwOQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/174509?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/shepmaster",
      "html_url": "https://github.com/shepmaster",
      "followers_url": "https://api.github.com/users/shepmaster/followers",
      "following_url": "https://api.github.com/users/shepmaster/following{/other_user}",
      "gists_url": "https://api.github.com/users/shepmaster/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/shepmaster/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/shepmaster/subscriptions",
      "organizations_url": "https://api.github.com/users/shepmaster/orgs",
      "repos_url": "https://api.github.com/users/shepmaster/repos",
      "events_url": "https://api.github.com/users/shepmaster/events{/privacy}",
      "received_events_url": "https://api.github.com/users/shepmaster/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2021-01-18T19:03:45Z",
    "updated_at": "2021-01-18T19:03:45Z",
    "body": "After #77972, this is the smallest reproduction of the original case I could make. Fails in Rust 1.49.0 and 1.51.0-nightly (2021-01-17 4253153db205251f72ea):\r\n\r\n```rust\r\npub fn oops() {\r\n    (|| loop {\r\n        drop(42)\r\n    })()\r\n}\r\n```",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/762423907/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/766128831",
    "html_url": "https://github.com/rust-lang/rust/issues/28728#issuecomment-766128831",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28728",
    "id": 766128831,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc2NjEyODgzMQ==",
    "user": {
      "login": "nikic",
      "id": 216080,
      "node_id": "MDQ6VXNlcjIxNjA4MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/216080?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nikic",
      "html_url": "https://github.com/nikic",
      "followers_url": "https://api.github.com/users/nikic/followers",
      "following_url": "https://api.github.com/users/nikic/following{/other_user}",
      "gists_url": "https://api.github.com/users/nikic/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nikic/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nikic/subscriptions",
      "organizations_url": "https://api.github.com/users/nikic/orgs",
      "repos_url": "https://api.github.com/users/nikic/repos",
      "events_url": "https://api.github.com/users/nikic/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nikic/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2021-01-23T16:30:07Z",
    "updated_at": "2021-01-23T16:30:07Z",
    "body": "This should be mostly fixed in LLVM 12 by https://reviews.llvm.org/D94106. There's still a minor issue remaining (side-effects can be hoisted across infinite loops).",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/766128831/reactions",
      "total_count": 9,
      "+1": 5,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 4,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/766422870",
    "html_url": "https://github.com/rust-lang/rust/issues/28728#issuecomment-766422870",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28728",
    "id": 766422870,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc2NjQyMjg3MA==",
    "user": {
      "login": "oxalica",
      "id": 14816024,
      "node_id": "MDQ6VXNlcjE0ODE2MDI0",
      "avatar_url": "https://avatars.githubusercontent.com/u/14816024?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/oxalica",
      "html_url": "https://github.com/oxalica",
      "followers_url": "https://api.github.com/users/oxalica/followers",
      "following_url": "https://api.github.com/users/oxalica/following{/other_user}",
      "gists_url": "https://api.github.com/users/oxalica/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/oxalica/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/oxalica/subscriptions",
      "organizations_url": "https://api.github.com/users/oxalica/orgs",
      "repos_url": "https://api.github.com/users/oxalica/repos",
      "events_url": "https://api.github.com/users/oxalica/events{/privacy}",
      "received_events_url": "https://api.github.com/users/oxalica/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2021-01-24T20:04:04Z",
    "updated_at": "2021-01-24T20:04:04Z",
    "body": "The upstream issue is marked as fixed now. https://bugs.llvm.org/show_bug.cgi?id=965",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/766422870/reactions",
      "total_count": 4,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 1,
      "rocket": 2,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/766424598",
    "html_url": "https://github.com/rust-lang/rust/issues/28728#issuecomment-766424598",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28728",
    "id": 766424598,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc2NjQyNDU5OA==",
    "user": {
      "login": "bstrie",
      "id": 865233,
      "node_id": "MDQ6VXNlcjg2NTIzMw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/865233?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/bstrie",
      "html_url": "https://github.com/bstrie",
      "followers_url": "https://api.github.com/users/bstrie/followers",
      "following_url": "https://api.github.com/users/bstrie/following{/other_user}",
      "gists_url": "https://api.github.com/users/bstrie/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/bstrie/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/bstrie/subscriptions",
      "organizations_url": "https://api.github.com/users/bstrie/orgs",
      "repos_url": "https://api.github.com/users/bstrie/repos",
      "events_url": "https://api.github.com/users/bstrie/events{/privacy}",
      "received_events_url": "https://api.github.com/users/bstrie/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2021-01-24T20:15:31Z",
    "updated_at": "2021-01-24T20:15:31Z",
    "body": "> There's still a minor issue remaining (side-effects can be hoisted across infinite loops).\r\n\r\nIs there an LLVM bug to track this issue? (I presume it's not something rustc can address on its own?)\r\n\r\nAlso, if this issue were fully addressed, would we want to revert #77972? If so, that would be worth tracking somewhere. Even though it appears to cause no noticeable regressions, not doing unnecessary work seems valuable.",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/766424598/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/766449443",
    "html_url": "https://github.com/rust-lang/rust/issues/28728#issuecomment-766449443",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28728",
    "id": 766449443,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc2NjQ0OTQ0Mw==",
    "user": {
      "login": "nikic",
      "id": 216080,
      "node_id": "MDQ6VXNlcjIxNjA4MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/216080?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nikic",
      "html_url": "https://github.com/nikic",
      "followers_url": "https://api.github.com/users/nikic/followers",
      "following_url": "https://api.github.com/users/nikic/following{/other_user}",
      "gists_url": "https://api.github.com/users/nikic/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nikic/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nikic/subscriptions",
      "organizations_url": "https://api.github.com/users/nikic/orgs",
      "repos_url": "https://api.github.com/users/nikic/repos",
      "events_url": "https://api.github.com/users/nikic/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nikic/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2021-01-24T22:20:13Z",
    "updated_at": "2021-01-24T22:25:47Z",
    "body": "> > There's still a minor issue remaining (side-effects can be hoisted across infinite loops).\r\n> \r\n> Is there an LLVM bug to track this issue? (I presume it's not something rustc can address on its own?)\r\n\r\nThis issue is fixed by https://reviews.llvm.org/D95288. There might be more places with problematic assumptions, but at least I'm not aware of any. (In default-enabled passes that is. The attributor has known issues.)\r\n\r\n> Also, if this issue were fully addressed, would we want to revert #77972? If so, that would be worth tracking somewhere. Even though it appears to cause no noticeable regressions, not doing unnecessary work seems valuable.\r\n\r\nWe shouldn't revert that yet as Rust also supports older LLVM versions, but we can limit sideeffect insertion to older versions at least.",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/766449443/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/771086278",
    "html_url": "https://github.com/rust-lang/rust/issues/28728#issuecomment-771086278",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28728",
    "id": 771086278,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc3MTA4NjI3OA==",
    "user": {
      "login": "oberien",
      "id": 4820508,
      "node_id": "MDQ6VXNlcjQ4MjA1MDg=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4820508?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/oberien",
      "html_url": "https://github.com/oberien",
      "followers_url": "https://api.github.com/users/oberien/followers",
      "following_url": "https://api.github.com/users/oberien/following{/other_user}",
      "gists_url": "https://api.github.com/users/oberien/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/oberien/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/oberien/subscriptions",
      "organizations_url": "https://api.github.com/users/oberien/orgs",
      "repos_url": "https://api.github.com/users/oberien/repos",
      "events_url": "https://api.github.com/users/oberien/events{/privacy}",
      "received_events_url": "https://api.github.com/users/oberien/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2021-02-01T19:06:56Z",
    "updated_at": "2021-02-01T19:10:47Z",
    "body": "I just found the following miscompilation resulting from this bug, which simply compiles to `ud2` on stable, beta and nightly:\r\n\r\n```rust\r\npub fn oops() -> u32 {\r\n    (0..).sum() // or .last().unwrap() instead of .sum()\r\n}\r\n```\r\n\r\nIt's a minified version of the following snippet where I mistyped `take_while` as `filter`:\r\n\r\n```rust\r\npub fn foo(end: u32) -> u32 {\r\n    (0..)\r\n        .map(|i| i * i)\r\n        .filter(|&i| i < end)\r\n        .sum()\r\n}\r\n```",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/771086278/reactions",
      "total_count": 13,
      "+1": 3,
      "-1": 0,
      "laugh": 3,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 7
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/776316633",
    "html_url": "https://github.com/rust-lang/rust/issues/28728#issuecomment-776316633",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28728",
    "id": 776316633,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc3NjMxNjYzMw==",
    "user": {
      "login": "Necior",
      "id": 2404518,
      "node_id": "MDQ6VXNlcjI0MDQ1MTg=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2404518?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Necior",
      "html_url": "https://github.com/Necior",
      "followers_url": "https://api.github.com/users/Necior/followers",
      "following_url": "https://api.github.com/users/Necior/following{/other_user}",
      "gists_url": "https://api.github.com/users/Necior/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Necior/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Necior/subscriptions",
      "organizations_url": "https://api.github.com/users/Necior/orgs",
      "repos_url": "https://api.github.com/users/Necior/repos",
      "events_url": "https://api.github.com/users/Necior/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Necior/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2021-02-09T23:33:05Z",
    "updated_at": "2021-02-09T23:33:05Z",
    "body": "I just want to notice that it's a bug on which beginner Rustaceans may stumble upon when working on the final exercise from The Book (Building a Multithreaded Web Server).\r\n\r\nWhen I was playing with the web server's code, for a moment I had an empty loop body:\r\n\r\n```rust\r\nimpl Worker {\r\n    fn new(id: usize, receiver: Arc<Mutex<mpsc::Receiver<Job>>>) -> Worker {\r\n        let thread = thread::spawn(|| loop {});\r\n        Worker { id, thread }\r\n    }\r\n}\r\n```\r\n\r\ninstead of ([Listing 20-20](https://doc.rust-lang.org/book/ch20-02-multithreaded.html#implementing-the-execute-method)):\r\n\r\n```rust\r\nimpl Worker {\r\n    fn new(id: usize, receiver: Arc<Mutex<mpsc::Receiver<Job>>>) -> Worker {\r\n        let thread = thread::spawn(move || loop {\r\n            let job = receiver.lock().unwrap().recv().unwrap();\r\n            println!(\"Worker {} got a job; executing.\", id);\r\n            job();\r\n        });\r\n        Worker { id, thread }\r\n    }\r\n}\r\n```\r\n\r\nRunning the first version ends with `Illegal instruction (core dumped)`. This example boils down to #46076 which was closed as a duplicate of #28728 (this issue). It's also similar to https://github.com/rust-lang/rust/issues/28728#issuecomment-532313125.\r\n\r\nI keep my fingers crossed for solving this issue :crossed_fingers: ",
    "author_association": "NONE",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/776316633/reactions",
      "total_count": 12,
      "+1": 12,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/791068945",
    "html_url": "https://github.com/rust-lang/rust/issues/28728#issuecomment-791068945",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28728",
    "id": 791068945,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc5MTA2ODk0NQ==",
    "user": {
      "login": "nagisa",
      "id": 679122,
      "node_id": "MDQ6VXNlcjY3OTEyMg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/679122?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nagisa",
      "html_url": "https://github.com/nagisa",
      "followers_url": "https://api.github.com/users/nagisa/followers",
      "following_url": "https://api.github.com/users/nagisa/following{/other_user}",
      "gists_url": "https://api.github.com/users/nagisa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nagisa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nagisa/subscriptions",
      "organizations_url": "https://api.github.com/users/nagisa/orgs",
      "repos_url": "https://api.github.com/users/nagisa/repos",
      "events_url": "https://api.github.com/users/nagisa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nagisa/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2021-03-05T01:10:18Z",
    "updated_at": "2021-03-05T01:10:18Z",
    "body": "Closed by #81451",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/791068945/reactions",
      "total_count": 72,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 72,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/842198878",
    "html_url": "https://github.com/rust-lang/rust/issues/28728#issuecomment-842198878",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28728",
    "id": 842198878,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg0MjE5ODg3OA==",
    "user": {
      "login": "daira",
      "id": 643204,
      "node_id": "MDQ6VXNlcjY0MzIwNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/643204?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/daira",
      "html_url": "https://github.com/daira",
      "followers_url": "https://api.github.com/users/daira/followers",
      "following_url": "https://api.github.com/users/daira/following{/other_user}",
      "gists_url": "https://api.github.com/users/daira/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/daira/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/daira/subscriptions",
      "organizations_url": "https://api.github.com/users/daira/orgs",
      "repos_url": "https://api.github.com/users/daira/repos",
      "events_url": "https://api.github.com/users/daira/events{/privacy}",
      "received_events_url": "https://api.github.com/users/daira/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2021-05-17T10:09:20Z",
    "updated_at": "2021-05-17T14:22:41Z",
    "body": "Thankyou to everyone who helped to get this fixed.\r\n\r\nHowever, I would like to note that it took *over five years* from the original report, and *four years* after LLVM devs said they would fix it on their side (https://github.com/rust-lang/rust/issues/28728#issuecomment-343284066), for this memory-unsafe soundness bug to actually be fixed in Rust.\r\n\r\nIs this the expected length of time for fixes to memory-unsafe soundness bugs? :-/\r\n\r\nIt could, of course, have been fixed much earlier by just adding a side-effect into infinite loops [edit: I know that this is a strong statement but I have seen nothing that contradicts it], and then removing that workaround as a performance optimization *after* LLVM fixed their bug.\r\n\r\nIt doesn't appear to be the only example: #52652 (which also could be triggered from safe code as noted in https://github.com/rust-lang/rust/issues/52652#issuecomment-408123653) took over three years to be fixed, measuring from the original attempted fix in #46833.\r\n\r\nBased on the evidence of this bug and #52652, there appears to be a de facto policy to leave tricky unsoundness bugs unfixed for long periods, whenever fixing them in the most obvious way could cause any potential performance regression or break any (no matter how obscure) code. I would like to register my objection to that de facto policy, which I do not think well serves the majority of Rust users.\r\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/842198878/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/842202845",
    "html_url": "https://github.com/rust-lang/rust/issues/28728#issuecomment-842202845",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28728",
    "id": 842202845,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg0MjIwMjg0NQ==",
    "user": {
      "login": "SimonSapin",
      "id": 291359,
      "node_id": "MDQ6VXNlcjI5MTM1OQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/291359?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/SimonSapin",
      "html_url": "https://github.com/SimonSapin",
      "followers_url": "https://api.github.com/users/SimonSapin/followers",
      "following_url": "https://api.github.com/users/SimonSapin/following{/other_user}",
      "gists_url": "https://api.github.com/users/SimonSapin/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/SimonSapin/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/SimonSapin/subscriptions",
      "organizations_url": "https://api.github.com/users/SimonSapin/orgs",
      "repos_url": "https://api.github.com/users/SimonSapin/repos",
      "events_url": "https://api.github.com/users/SimonSapin/events{/privacy}",
      "received_events_url": "https://api.github.com/users/SimonSapin/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2021-05-17T10:15:46Z",
    "updated_at": "2021-05-17T10:15:46Z",
    "body": "@daira While I think you make good points, closed issues are generally considered resolved and not in need of attention, so new comments there are easy to miss. Consider starting a new discussion elsewhere (though to be honest I\u2019m not sure which venue would be best in this case.)",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/842202845/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/842225136",
    "html_url": "https://github.com/rust-lang/rust/issues/28728#issuecomment-842225136",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28728",
    "id": 842225136,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg0MjIyNTEzNg==",
    "user": {
      "login": "RalfJung",
      "id": 330628,
      "node_id": "MDQ6VXNlcjMzMDYyOA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/330628?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/RalfJung",
      "html_url": "https://github.com/RalfJung",
      "followers_url": "https://api.github.com/users/RalfJung/followers",
      "following_url": "https://api.github.com/users/RalfJung/following{/other_user}",
      "gists_url": "https://api.github.com/users/RalfJung/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/RalfJung/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/RalfJung/subscriptions",
      "organizations_url": "https://api.github.com/users/RalfJung/orgs",
      "repos_url": "https://api.github.com/users/RalfJung/repos",
      "events_url": "https://api.github.com/users/RalfJung/events{/privacy}",
      "received_events_url": "https://api.github.com/users/RalfJung/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2021-05-17T10:53:57Z",
    "updated_at": "2021-05-17T10:54:24Z",
    "body": "https://internals.rust-lang.org/ might be a reasonable place.\r\n\r\n(FWIW, I disagree with your assessment @daira, in particular about \"just\" adding a side-effect into infinite loops -- it's not that simple; as usual, one has to be careful with \"why don't you just\"-style questions.)",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/842225136/reactions",
      "total_count": 4,
      "+1": 4,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/842357296",
    "html_url": "https://github.com/rust-lang/rust/issues/28728#issuecomment-842357296",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28728",
    "id": 842357296,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg0MjM1NzI5Ng==",
    "user": {
      "login": "daira",
      "id": 643204,
      "node_id": "MDQ6VXNlcjY0MzIwNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/643204?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/daira",
      "html_url": "https://github.com/daira",
      "followers_url": "https://api.github.com/users/daira/followers",
      "following_url": "https://api.github.com/users/daira/following{/other_user}",
      "gists_url": "https://api.github.com/users/daira/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/daira/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/daira/subscriptions",
      "organizations_url": "https://api.github.com/users/daira/orgs",
      "repos_url": "https://api.github.com/users/daira/repos",
      "events_url": "https://api.github.com/users/daira/events{/privacy}",
      "received_events_url": "https://api.github.com/users/daira/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2021-05-17T14:10:28Z",
    "updated_at": "2021-05-17T14:23:50Z",
    "body": "I used \"just\" advisedly. It really wouldn't have been hard, as compiler bugs go, to use that approach. Specifically, my understanding is that adding `@llvm.sideeffect` as originally proposed in #18785 would have been sufficient. No compiler bug of this kind is trivial, but they should not take 5 years to fix. (Correction: over 6 years, counting from #18785; that bug wasn't specific to loops but it was essentially the same problem.)",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/842357296/reactions",
      "total_count": 1,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 1,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/842360569",
    "html_url": "https://github.com/rust-lang/rust/issues/28728#issuecomment-842360569",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28728",
    "id": 842360569,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg0MjM2MDU2OQ==",
    "user": {
      "login": "Aaron1011",
      "id": 1408859,
      "node_id": "MDQ6VXNlcjE0MDg4NTk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1408859?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Aaron1011",
      "html_url": "https://github.com/Aaron1011",
      "followers_url": "https://api.github.com/users/Aaron1011/followers",
      "following_url": "https://api.github.com/users/Aaron1011/following{/other_user}",
      "gists_url": "https://api.github.com/users/Aaron1011/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Aaron1011/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Aaron1011/subscriptions",
      "organizations_url": "https://api.github.com/users/Aaron1011/orgs",
      "repos_url": "https://api.github.com/users/Aaron1011/repos",
      "events_url": "https://api.github.com/users/Aaron1011/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Aaron1011/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2021-05-17T14:14:46Z",
    "updated_at": "2021-05-17T14:14:46Z",
    "body": "> It doesn't appear to be the only example: #52652\r\n\r\nThat bug was 'fixed' very quickly, but the fix had to be reverted because it broke the `rlua` crate. The full fix required an RFC to add new `-unwind` ABIs to the language. While it's definitely a good idea to prioritize fixing soundness issues, it's not always a matter of making an invisible change to the compiler backend.",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/842360569/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
