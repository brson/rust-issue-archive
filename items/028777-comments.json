[
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/145403592",
    "html_url": "https://github.com/rust-lang/rust/issues/28777#issuecomment-145403592",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28777",
    "id": 145403592,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE0NTQwMzU5Mg==",
    "user": {
      "login": "steveklabnik",
      "id": 27786,
      "node_id": "MDQ6VXNlcjI3Nzg2",
      "avatar_url": "https://avatars.githubusercontent.com/u/27786?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/steveklabnik",
      "html_url": "https://github.com/steveklabnik",
      "followers_url": "https://api.github.com/users/steveklabnik/followers",
      "following_url": "https://api.github.com/users/steveklabnik/following{/other_user}",
      "gists_url": "https://api.github.com/users/steveklabnik/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/steveklabnik/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/steveklabnik/subscriptions",
      "organizations_url": "https://api.github.com/users/steveklabnik/orgs",
      "repos_url": "https://api.github.com/users/steveklabnik/repos",
      "events_url": "https://api.github.com/users/steveklabnik/events{/privacy}",
      "received_events_url": "https://api.github.com/users/steveklabnik/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-10-04T23:59:29Z",
    "updated_at": "2015-10-04T23:59:29Z",
    "body": "/cc @rust-lang/lang , I'm assuming this is not intended behavior.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/145403592/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/145976686",
    "html_url": "https://github.com/rust-lang/rust/issues/28777#issuecomment-145976686",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28777",
    "id": 145976686,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE0NTk3NjY4Ng==",
    "user": {
      "login": "nikomatsakis",
      "id": 155238,
      "node_id": "MDQ6VXNlcjE1NTIzOA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/155238?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nikomatsakis",
      "html_url": "https://github.com/nikomatsakis",
      "followers_url": "https://api.github.com/users/nikomatsakis/followers",
      "following_url": "https://api.github.com/users/nikomatsakis/following{/other_user}",
      "gists_url": "https://api.github.com/users/nikomatsakis/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nikomatsakis/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nikomatsakis/subscriptions",
      "organizations_url": "https://api.github.com/users/nikomatsakis/orgs",
      "repos_url": "https://api.github.com/users/nikomatsakis/repos",
      "events_url": "https://api.github.com/users/nikomatsakis/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nikomatsakis/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-10-06T19:44:51Z",
    "updated_at": "2015-10-06T19:44:51Z",
    "body": "Um, I agree.\n\ntriage: P-medium\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/145976686/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/161680345",
    "html_url": "https://github.com/rust-lang/rust/issues/28777#issuecomment-161680345",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28777",
    "id": 161680345,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE2MTY4MDM0NQ==",
    "user": {
      "login": "aaronkeen",
      "id": 2770032,
      "node_id": "MDQ6VXNlcjI3NzAwMzI=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2770032?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/aaronkeen",
      "html_url": "https://github.com/aaronkeen",
      "followers_url": "https://api.github.com/users/aaronkeen/followers",
      "following_url": "https://api.github.com/users/aaronkeen/following{/other_user}",
      "gists_url": "https://api.github.com/users/aaronkeen/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/aaronkeen/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/aaronkeen/subscriptions",
      "organizations_url": "https://api.github.com/users/aaronkeen/orgs",
      "repos_url": "https://api.github.com/users/aaronkeen/repos",
      "events_url": "https://api.github.com/users/aaronkeen/events{/privacy}",
      "received_events_url": "https://api.github.com/users/aaronkeen/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-12-03T15:41:17Z",
    "updated_at": "2015-12-04T09:10:42Z",
    "body": "In looking at this issue, the incorrect parse (the initializer for v1 in the example, though this occurs in an assignment as well) stems from the path to parse_assoc_expr_with from parse_block_expr (passing through, of note, parse_stmt_).  In parse_stmt_, parse_expr_res is invoked with RESTRICTION_STMT_EXPR.  This ultimately results in the expr_is_complete check (in parse_assoc_expr_with) succeeding for '{2}' which prevents matching the '*' token and, thus, building the expected right subtree.\n\nI am new to this codebase (and, for the most part, this language), so I am sill looking into the 'expr_is_complete' aspect of this portion of the parser.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/161680345/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/161718076",
    "html_url": "https://github.com/rust-lang/rust/issues/28777#issuecomment-161718076",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28777",
    "id": 161718076,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE2MTcxODA3Ng==",
    "user": {
      "login": "pnkfelix",
      "id": 173127,
      "node_id": "MDQ6VXNlcjE3MzEyNw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/173127?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/pnkfelix",
      "html_url": "https://github.com/pnkfelix",
      "followers_url": "https://api.github.com/users/pnkfelix/followers",
      "following_url": "https://api.github.com/users/pnkfelix/following{/other_user}",
      "gists_url": "https://api.github.com/users/pnkfelix/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/pnkfelix/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/pnkfelix/subscriptions",
      "organizations_url": "https://api.github.com/users/pnkfelix/orgs",
      "repos_url": "https://api.github.com/users/pnkfelix/repos",
      "events_url": "https://api.github.com/users/pnkfelix/events{/privacy}",
      "received_events_url": "https://api.github.com/users/pnkfelix/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-12-03T17:07:30Z",
    "updated_at": "2015-12-03T17:07:30Z",
    "body": "uh wow; I was going to ask if this is related to https://github.com/rust-lang/rust/issues/15300 , but this seems much worse than that to my eye...\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/161718076/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/161946469",
    "html_url": "https://github.com/rust-lang/rust/issues/28777#issuecomment-161946469",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28777",
    "id": 161946469,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE2MTk0NjQ2OQ==",
    "user": {
      "login": "aaronkeen",
      "id": 2770032,
      "node_id": "MDQ6VXNlcjI3NzAwMzI=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2770032?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/aaronkeen",
      "html_url": "https://github.com/aaronkeen",
      "followers_url": "https://api.github.com/users/aaronkeen/followers",
      "following_url": "https://api.github.com/users/aaronkeen/following{/other_user}",
      "gists_url": "https://api.github.com/users/aaronkeen/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/aaronkeen/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/aaronkeen/subscriptions",
      "organizations_url": "https://api.github.com/users/aaronkeen/orgs",
      "repos_url": "https://api.github.com/users/aaronkeen/repos",
      "events_url": "https://api.github.com/users/aaronkeen/events{/privacy}",
      "received_events_url": "https://api.github.com/users/aaronkeen/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-12-04T11:37:04Z",
    "updated_at": "2015-12-04T11:37:29Z",
    "body": "As the comment in parser.rs alludes to in regards to semi-statements, this issue is related to #29071.\n\nThe outermost braces trigger a flag to check for expressions that do not require a semicolon to in order to be considered statements (e.g., if).  If such an expression is found, then the parsing of associative expressions is terminated before consuming the next operator.  This occurs in the original examples after the '{2}' because the block does not require a semicolon to be considered a statement.\n\nFor instance, the following illustrates the same parsing issue as the original example.\n\n```\nfn main() {\n    let v1 = { if 1 > 2 {2} else {3} + 5 };   // does not parse, unexpected token at +\n    let v2 =   if 1 > 2 {2} else {3} + 5 ;    // parses and evaluates as expected\n}\n```\n\nRemoving the addition operator in the first expression results in a parse but with a typing error (to an extent further illustrating that the semi-statement is being considered a statement here; the same is true of the original binding for v1, but falling out of the recursion grabs the '\\* {3}').\n\n```\nfn main() {\n    let v1 = { if 1 > 2 {2} else {3} 5 };   // parses, but type error\n}\n```\n\n```\nmain.rs:2:26: 2:27 error: mismatched types:\n expected `()`,\n    found `_`\n(expected (),\n    found integral variable) [E0308]\nmain.rs:2     let v1 = { if 1 > 2 {2} else {3}  5 };\n                                   ^\nmain.rs:2:26: 2:27 help: run `rustc --explain E0308` to see a detailed explanation\nmain.rs:2:35: 2:36 error: mismatched types:\n expected `()`,\n    found `_`\n(expected (),\n    found integral variable) [E0308]\nmain.rs:2     let v1 = { if 1 > 2 {2} else {3}  5 };\n                                            ^\nmain.rs:2:35: 2:36 help: run `rustc --explain E0308` to see a detailed explanation\nerror: aborting due to 2 previous errors\n```\n\nI see that this all really goes back to #28379 (from which this issue was split) wherein @nikomatsakis states that a statement expression cannot start a binary expression when in statement position.  The restriction flag makes it such that in '{ 1 + {2} \\* 3 }' it looks like '{2}' is in statement position for the subexpression '{2} \\* 3' (but it would not be considered as such if the original expression were '{ 1 + {2} + 3 }' because it appears as the right-operand of the first + instead of the left-operand of the *).\n\nIf the intent is that the start of a binary expression cannot be a statement-expression, but subsequent subexpressions can be, then it may be sufficient to remove the restriction when parsing the rhs (i.e., after an operator is accepted).  Doing so in the original example given corrects the parsing (precedence) issue.  The tests are still running to check for introduced failures.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/161946469/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/162000503",
    "html_url": "https://github.com/rust-lang/rust/issues/28777#issuecomment-162000503",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28777",
    "id": 162000503,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE2MjAwMDUwMw==",
    "user": {
      "login": "aaronkeen",
      "id": 2770032,
      "node_id": "MDQ6VXNlcjI3NzAwMzI=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2770032?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/aaronkeen",
      "html_url": "https://github.com/aaronkeen",
      "followers_url": "https://api.github.com/users/aaronkeen/followers",
      "following_url": "https://api.github.com/users/aaronkeen/following{/other_user}",
      "gists_url": "https://api.github.com/users/aaronkeen/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/aaronkeen/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/aaronkeen/subscriptions",
      "organizations_url": "https://api.github.com/users/aaronkeen/orgs",
      "repos_url": "https://api.github.com/users/aaronkeen/repos",
      "events_url": "https://api.github.com/users/aaronkeen/events{/privacy}",
      "received_events_url": "https://api.github.com/users/aaronkeen/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-12-04T15:46:07Z",
    "updated_at": "2015-12-04T15:46:07Z",
    "body": "The proposed change results in parse-fail/assoc-oddities-3.rs successfully parsing.  It is unclear to me why it shouldn't.  Back to looking through the intended grammar.\n\n```\nfn that_odd_parse() {\n    // see assoc-oddities-1 for explanation\n    x + if c { a } else { b }[n]; //~ ERROR expected one of\n}\n```\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/162000503/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/164553812",
    "html_url": "https://github.com/rust-lang/rust/issues/28777#issuecomment-164553812",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28777",
    "id": 164553812,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE2NDU1MzgxMg==",
    "user": {
      "login": "aaronkeen",
      "id": 2770032,
      "node_id": "MDQ6VXNlcjI3NzAwMzI=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2770032?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/aaronkeen",
      "html_url": "https://github.com/aaronkeen",
      "followers_url": "https://api.github.com/users/aaronkeen/followers",
      "following_url": "https://api.github.com/users/aaronkeen/following{/other_user}",
      "gists_url": "https://api.github.com/users/aaronkeen/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/aaronkeen/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/aaronkeen/subscriptions",
      "organizations_url": "https://api.github.com/users/aaronkeen/orgs",
      "repos_url": "https://api.github.com/users/aaronkeen/repos",
      "events_url": "https://api.github.com/users/aaronkeen/events{/privacy}",
      "received_events_url": "https://api.github.com/users/aaronkeen/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-12-14T20:43:42Z",
    "updated_at": "2015-12-14T20:43:42Z",
    "body": "parse-fail/assoc-oddities-3.rs is successfully parsed by grammar/parser-lalr as well, so the proposed modification is consistent in this regard.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/164553812/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/182205441",
    "html_url": "https://github.com/rust-lang/rust/issues/28777#issuecomment-182205441",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28777",
    "id": 182205441,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE4MjIwNTQ0MQ==",
    "user": {
      "login": "jseyfried",
      "id": 8652869,
      "node_id": "MDQ6VXNlcjg2NTI4Njk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8652869?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jseyfried",
      "html_url": "https://github.com/jseyfried",
      "followers_url": "https://api.github.com/users/jseyfried/followers",
      "following_url": "https://api.github.com/users/jseyfried/following{/other_user}",
      "gists_url": "https://api.github.com/users/jseyfried/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jseyfried/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jseyfried/subscriptions",
      "organizations_url": "https://api.github.com/users/jseyfried/orgs",
      "repos_url": "https://api.github.com/users/jseyfried/repos",
      "events_url": "https://api.github.com/users/jseyfried/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jseyfried/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2016-02-10T05:31:55Z",
    "updated_at": "2016-02-10T05:31:55Z",
    "body": "@eddyb This can be closed -- #30375 fixed it and added a test.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/182205441/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
