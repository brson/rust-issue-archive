[
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/100404684",
    "html_url": "https://github.com/rust-lang/rust/pull/25232#issuecomment-100404684",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/25232",
    "id": 100404684,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEwMDQwNDY4NA==",
    "user": {
      "login": "rust-highfive",
      "id": 7378925,
      "node_id": "MDQ6VXNlcjczNzg5MjU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7378925?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/rust-highfive",
      "html_url": "https://github.com/rust-highfive",
      "followers_url": "https://api.github.com/users/rust-highfive/followers",
      "following_url": "https://api.github.com/users/rust-highfive/following{/other_user}",
      "gists_url": "https://api.github.com/users/rust-highfive/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/rust-highfive/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/rust-highfive/subscriptions",
      "organizations_url": "https://api.github.com/users/rust-highfive/orgs",
      "repos_url": "https://api.github.com/users/rust-highfive/repos",
      "events_url": "https://api.github.com/users/rust-highfive/events{/privacy}",
      "received_events_url": "https://api.github.com/users/rust-highfive/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-05-09T01:08:11Z",
    "updated_at": "2015-05-09T01:08:11Z",
    "body": "r? @aturon\n\n(rust_highfive has picked a reviewer for you, use r? to override)\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/100404684/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/100551533",
    "html_url": "https://github.com/rust-lang/rust/pull/25232#issuecomment-100551533",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/25232",
    "id": 100551533,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEwMDU1MTUzMw==",
    "user": {
      "login": "Diggsey",
      "id": 451321,
      "node_id": "MDQ6VXNlcjQ1MTMyMQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/451321?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Diggsey",
      "html_url": "https://github.com/Diggsey",
      "followers_url": "https://api.github.com/users/Diggsey/followers",
      "following_url": "https://api.github.com/users/Diggsey/following{/other_user}",
      "gists_url": "https://api.github.com/users/Diggsey/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Diggsey/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Diggsey/subscriptions",
      "organizations_url": "https://api.github.com/users/Diggsey/orgs",
      "repos_url": "https://api.github.com/users/Diggsey/repos",
      "events_url": "https://api.github.com/users/Diggsey/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Diggsey/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-05-09T21:39:18Z",
    "updated_at": "2015-05-09T21:39:18Z",
    "body": "Unfortunately it's still more limited than I'd like: this is a case where HKT would help, since the \"type\" of a scoped thread local, should actually be a type constructor, which would produce a concrete type given an arbitraty lifetime. However, I think it's also possible to implement the same thing using macros so that the following would be possible:\n\n`scoped_thread_local!(static TEST: &'scope u32)` where `'scope` is a lifetime specifier filled in by the macro. (Apparantly macro hygiene doesn't prevent this?)\n\nThis allows more complicated uses:\n`scoped_thread_local!(static TEST: &'scope Guard<'scope>)`\nwhich would otherwise be impossible.\n\nThe only tricky part is how to check that `'scope` is only ever used contravariantly. I _think_ not enforcing that could lead to unsafety, although I haven't come up with any examples yet.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/100551533/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/100973666",
    "html_url": "https://github.com/rust-lang/rust/pull/25232#issuecomment-100973666",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/25232",
    "id": 100973666,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEwMDk3MzY2Ng==",
    "user": {
      "login": "alexcrichton",
      "id": 64996,
      "node_id": "MDQ6VXNlcjY0OTk2",
      "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alexcrichton",
      "html_url": "https://github.com/alexcrichton",
      "followers_url": "https://api.github.com/users/alexcrichton/followers",
      "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}",
      "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions",
      "organizations_url": "https://api.github.com/users/alexcrichton/orgs",
      "repos_url": "https://api.github.com/users/alexcrichton/repos",
      "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alexcrichton/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-05-11T16:38:07Z",
    "updated_at": "2015-05-11T16:38:07Z",
    "body": "Now that I recall the limitation that we're using OS TLS as a backend sometimes, which has the requirement that the pointer is word-sized, I'm now actually somewhat more hesitant about this. This is adding an extra layer of indirection in all cases, which may not always be desired.\n\nI think the problems you pointed out about still being able to specify a lifetime are still relevant to this primitive, so it may be best to fix those first perhaps?\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/100973666/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/100981752",
    "html_url": "https://github.com/rust-lang/rust/pull/25232#issuecomment-100981752",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/25232",
    "id": 100981752,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEwMDk4MTc1Mg==",
    "user": {
      "login": "Diggsey",
      "id": 451321,
      "node_id": "MDQ6VXNlcjQ1MTMyMQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/451321?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Diggsey",
      "html_url": "https://github.com/Diggsey",
      "followers_url": "https://api.github.com/users/Diggsey/followers",
      "following_url": "https://api.github.com/users/Diggsey/following{/other_user}",
      "gists_url": "https://api.github.com/users/Diggsey/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Diggsey/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Diggsey/subscriptions",
      "organizations_url": "https://api.github.com/users/Diggsey/orgs",
      "repos_url": "https://api.github.com/users/Diggsey/repos",
      "events_url": "https://api.github.com/users/Diggsey/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Diggsey/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-05-11T17:14:01Z",
    "updated_at": "2015-05-11T17:14:01Z",
    "body": "@alexcrichton Yes I hadn't noticed that at first either. However, without specialization or negative trait bounds it's not possible to get optimal behaviour in both cases, so I opted for an extra layer of indirection.\n\nI did manage to implement the enhancement to \"scoped_thread_local!\":\nhttps://github.com/rust-lang/rfcs/issues/1112\nhttps://github.com/Diggsey/rust/tree/scoped_thread_local_hkt\n\nThe implementation might be too much of a hack to get merged in right now (what do you think?) although mostly because of unnecessary limitations in the compiler, which would not be too much work to fix:\n1) The lack of a \"lifetime token\" type for use by the macro.\n2) The lack of hygiene for structs generated in a macro, combined with the inability to generate unique identifiers.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/100981752/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/101448845",
    "html_url": "https://github.com/rust-lang/rust/pull/25232#issuecomment-101448845",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/25232",
    "id": 101448845,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEwMTQ0ODg0NQ==",
    "user": {
      "login": "alexcrichton",
      "id": 64996,
      "node_id": "MDQ6VXNlcjY0OTk2",
      "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alexcrichton",
      "html_url": "https://github.com/alexcrichton",
      "followers_url": "https://api.github.com/users/alexcrichton/followers",
      "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}",
      "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions",
      "organizations_url": "https://api.github.com/users/alexcrichton/orgs",
      "repos_url": "https://api.github.com/users/alexcrichton/repos",
      "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alexcrichton/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-05-12T22:47:20Z",
    "updated_at": "2015-05-12T22:47:20Z",
    "body": "Oh wow, interesting! I do suspect, however, that that's a bit complicated to land in-tree right now. I believe that adding a lifetime token for a macro may not be too hard (would require an RFC, but seems backwards compatible), but the hygiene problem may be difficult to overcome. \n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/101448845/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/101486269",
    "html_url": "https://github.com/rust-lang/rust/pull/25232#issuecomment-101486269",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/25232",
    "id": 101486269,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEwMTQ4NjI2OQ==",
    "user": {
      "login": "HeroesGrave",
      "id": 1934172,
      "node_id": "MDQ6VXNlcjE5MzQxNzI=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1934172?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/HeroesGrave",
      "html_url": "https://github.com/HeroesGrave",
      "followers_url": "https://api.github.com/users/HeroesGrave/followers",
      "following_url": "https://api.github.com/users/HeroesGrave/following{/other_user}",
      "gists_url": "https://api.github.com/users/HeroesGrave/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/HeroesGrave/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/HeroesGrave/subscriptions",
      "organizations_url": "https://api.github.com/users/HeroesGrave/orgs",
      "repos_url": "https://api.github.com/users/HeroesGrave/repos",
      "events_url": "https://api.github.com/users/HeroesGrave/events{/privacy}",
      "received_events_url": "https://api.github.com/users/HeroesGrave/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-05-13T02:32:47Z",
    "updated_at": "2015-05-13T02:32:47Z",
    "body": "I opened an issue a little while back about the lack of a lifetime macro fragment. https://github.com/rust-lang/rust/issues/23956\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/101486269/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/105696587",
    "html_url": "https://github.com/rust-lang/rust/pull/25232#issuecomment-105696587",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/25232",
    "id": 105696587,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEwNTY5NjU4Nw==",
    "user": {
      "login": "alexcrichton",
      "id": 64996,
      "node_id": "MDQ6VXNlcjY0OTk2",
      "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alexcrichton",
      "html_url": "https://github.com/alexcrichton",
      "followers_url": "https://api.github.com/users/alexcrichton/followers",
      "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}",
      "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions",
      "organizations_url": "https://api.github.com/users/alexcrichton/orgs",
      "repos_url": "https://api.github.com/users/alexcrichton/repos",
      "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alexcrichton/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-05-26T23:26:01Z",
    "updated_at": "2015-05-26T23:26:01Z",
    "body": "Ok for now I'm going to close this due to the need for the double-indirection in sized types, I think we may be able to explore some more macro-fun possibilities here in the future, but for now limiting this to word-sized storage is the OS limitation.\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/105696587/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
