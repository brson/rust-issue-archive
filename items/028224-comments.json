[
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/137655253",
    "html_url": "https://github.com/rust-lang/rust/issues/28224#issuecomment-137655253",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28224",
    "id": 137655253,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEzNzY1NTI1Mw==",
    "user": {
      "login": "alexcrichton",
      "id": 64996,
      "node_id": "MDQ6VXNlcjY0OTk2",
      "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alexcrichton",
      "html_url": "https://github.com/alexcrichton",
      "followers_url": "https://api.github.com/users/alexcrichton/followers",
      "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}",
      "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions",
      "organizations_url": "https://api.github.com/users/alexcrichton/orgs",
      "repos_url": "https://api.github.com/users/alexcrichton/repos",
      "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alexcrichton/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-09-04T06:00:32Z",
    "updated_at": "2015-09-04T06:00:32Z",
    "body": "This is actually an optimization that LLVM is doing, it realizes that the allocation isn't necessary so it's elided entirely. As a result I believe this is working as intended, so closing.\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/137655253/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/137714284",
    "html_url": "https://github.com/rust-lang/rust/issues/28224#issuecomment-137714284",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28224",
    "id": 137714284,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEzNzcxNDI4NA==",
    "user": {
      "login": "apasel422",
      "id": 8644784,
      "node_id": "MDQ6VXNlcjg2NDQ3ODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8644784?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/apasel422",
      "html_url": "https://github.com/apasel422",
      "followers_url": "https://api.github.com/users/apasel422/followers",
      "following_url": "https://api.github.com/users/apasel422/following{/other_user}",
      "gists_url": "https://api.github.com/users/apasel422/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/apasel422/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/apasel422/subscriptions",
      "organizations_url": "https://api.github.com/users/apasel422/orgs",
      "repos_url": "https://api.github.com/users/apasel422/repos",
      "events_url": "https://api.github.com/users/apasel422/events{/privacy}",
      "received_events_url": "https://api.github.com/users/apasel422/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-09-04T11:37:27Z",
    "updated_at": "2015-09-04T11:37:27Z",
    "body": "I'm not sure that's the case. Consider this program:\n\n``` rust\n#![feature(test)]\n\nextern crate test;\n\nfn main() {\n    for i in 0..100 {\n        let foo = Box::new(i);\n        test::black_box(foo);\n    }\n}\n```\n\nThe assembly clearly contains calls to `exchange_malloc`, and running the code under `gdb` indicates that `exchange_malloc` is called 100 times:\n\n```\n(gdb) break _ZN4heap15exchange_malloc20he8623aa1084055ffJfaE\nBreakpoint 1 at 0x4a90: file ../src/liballoc/heap.rs, line 123.\n(gdb) ignore 1 1000\nWill ignore next 1000 crossings of breakpoint 1.\n(gdb) run\nStarting program: /home/andrew/foo \n[Thread debugging using libthread_db enabled]\nUsing host libthread_db library \"/lib/x86_64-linux-gnu/libthread_db.so.1\".\n[Inferior 1 (process 1890) exited normally]\n(gdb) info breakpoints\nNum     Type           Disp Enb Address            What\n1       breakpoint     keep y   0x0000555555558a90 in foo::heap::exchange_malloc at ../src/liballoc/heap.rs:123\n    breakpoint already hit 100 times\n    ignore next 900 hits\n```\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/137714284/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/137714827",
    "html_url": "https://github.com/rust-lang/rust/issues/28224#issuecomment-137714827",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28224",
    "id": 137714827,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEzNzcxNDgyNw==",
    "user": {
      "login": "apasel422",
      "id": 8644784,
      "node_id": "MDQ6VXNlcjg2NDQ3ODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8644784?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/apasel422",
      "html_url": "https://github.com/apasel422",
      "followers_url": "https://api.github.com/users/apasel422/followers",
      "following_url": "https://api.github.com/users/apasel422/following{/other_user}",
      "gists_url": "https://api.github.com/users/apasel422/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/apasel422/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/apasel422/subscriptions",
      "organizations_url": "https://api.github.com/users/apasel422/orgs",
      "repos_url": "https://api.github.com/users/apasel422/repos",
      "events_url": "https://api.github.com/users/apasel422/events{/privacy}",
      "received_events_url": "https://api.github.com/users/apasel422/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-09-04T11:41:29Z",
    "updated_at": "2015-09-04T11:41:29Z",
    "body": "But Valgrind reports:\n\n```\n==1899== Memcheck, a memory error detector\n==1899== Copyright (C) 2002-2013, and GNU GPL'd, by Julian Seward et al.\n==1899== Using Valgrind-3.10.1 and LibVEX; rerun with -h for copyright info\n==1899== Command: ./foo\n==1899== \n==1899== \n==1899== HEAP SUMMARY:\n==1899==     in use at exit: 0 bytes in 0 blocks\n==1899==   total heap usage: 5 allocs, 5 frees, 976 bytes allocated\n==1899== \n==1899== All heap blocks were freed -- no leaks are possible\n==1899== \n==1899== For counts of detected and suppressed errors, rerun with: -v\n==1899== ERROR SUMMARY: 0 errors from 0 contexts (suppressed: 0 from 0)\n```\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/137714827/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/137786776",
    "html_url": "https://github.com/rust-lang/rust/issues/28224#issuecomment-137786776",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28224",
    "id": 137786776,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEzNzc4Njc3Ng==",
    "user": {
      "login": "alexcrichton",
      "id": 64996,
      "node_id": "MDQ6VXNlcjY0OTk2",
      "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alexcrichton",
      "html_url": "https://github.com/alexcrichton",
      "followers_url": "https://api.github.com/users/alexcrichton/followers",
      "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}",
      "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions",
      "organizations_url": "https://api.github.com/users/alexcrichton/orgs",
      "repos_url": "https://api.github.com/users/alexcrichton/repos",
      "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alexcrichton/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-09-04T16:40:12Z",
    "updated_at": "2015-09-04T16:40:12Z",
    "body": "Hm something fishy may indeed be going on here, it looks like valgrind is no longer tracking jemalloc? If you use `alloc_system` for now you'll get accurate tracking via valgrind, I'll reopen for more investigation into jemalloc though.\n\n(also tweaking the title a bit)\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/137786776/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/137811982",
    "html_url": "https://github.com/rust-lang/rust/issues/28224#issuecomment-137811982",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28224",
    "id": 137811982,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEzNzgxMTk4Mg==",
    "user": {
      "login": "apasel422",
      "id": 8644784,
      "node_id": "MDQ6VXNlcjg2NDQ3ODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8644784?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/apasel422",
      "html_url": "https://github.com/apasel422",
      "followers_url": "https://api.github.com/users/apasel422/followers",
      "following_url": "https://api.github.com/users/apasel422/following{/other_user}",
      "gists_url": "https://api.github.com/users/apasel422/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/apasel422/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/apasel422/subscriptions",
      "organizations_url": "https://api.github.com/users/apasel422/orgs",
      "repos_url": "https://api.github.com/users/apasel422/repos",
      "events_url": "https://api.github.com/users/apasel422/events{/privacy}",
      "received_events_url": "https://api.github.com/users/apasel422/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-09-04T18:22:46Z",
    "updated_at": "2015-09-04T18:22:46Z",
    "body": "Using `alloc_system` indeed causes valgrind to report the correct information.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/137811982/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/137993312",
    "html_url": "https://github.com/rust-lang/rust/issues/28224#issuecomment-137993312",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28224",
    "id": 137993312,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEzNzk5MzMxMg==",
    "user": {
      "login": "shepmaster",
      "id": 174509,
      "node_id": "MDQ6VXNlcjE3NDUwOQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/174509?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/shepmaster",
      "html_url": "https://github.com/shepmaster",
      "followers_url": "https://api.github.com/users/shepmaster/followers",
      "following_url": "https://api.github.com/users/shepmaster/following{/other_user}",
      "gists_url": "https://api.github.com/users/shepmaster/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/shepmaster/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/shepmaster/subscriptions",
      "organizations_url": "https://api.github.com/users/shepmaster/orgs",
      "repos_url": "https://api.github.com/users/shepmaster/repos",
      "events_url": "https://api.github.com/users/shepmaster/events{/privacy}",
      "received_events_url": "https://api.github.com/users/shepmaster/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-09-05T20:33:21Z",
    "updated_at": "2015-09-05T20:33:21Z",
    "body": "Sorry to jump in here, but how did you ever get valgrind to report jemalloc stats in the first place? On OS X, I've _never_ successfully gotten any useful stats.\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/137993312/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/138665398",
    "html_url": "https://github.com/rust-lang/rust/issues/28224#issuecomment-138665398",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28224",
    "id": 138665398,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEzODY2NTM5OA==",
    "user": {
      "login": "apasel422",
      "id": 8644784,
      "node_id": "MDQ6VXNlcjg2NDQ3ODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8644784?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/apasel422",
      "html_url": "https://github.com/apasel422",
      "followers_url": "https://api.github.com/users/apasel422/followers",
      "following_url": "https://api.github.com/users/apasel422/following{/other_user}",
      "gists_url": "https://api.github.com/users/apasel422/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/apasel422/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/apasel422/subscriptions",
      "organizations_url": "https://api.github.com/users/apasel422/orgs",
      "repos_url": "https://api.github.com/users/apasel422/repos",
      "events_url": "https://api.github.com/users/apasel422/events{/privacy}",
      "received_events_url": "https://api.github.com/users/apasel422/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-09-08T18:43:57Z",
    "updated_at": "2015-09-08T18:43:57Z",
    "body": "I think the issue is that Valgrind can't track calls to jemalloc's `mallocx`-family of functions. There is a way to get Valgrind to track them, but it involves some custom headers: http://valgrind.org/docs/manual/mc-manual.html#mc-manual.mempools\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/138665398/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/138671193",
    "html_url": "https://github.com/rust-lang/rust/issues/28224#issuecomment-138671193",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28224",
    "id": 138671193,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEzODY3MTE5Mw==",
    "user": {
      "login": "apasel422",
      "id": 8644784,
      "node_id": "MDQ6VXNlcjg2NDQ3ODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8644784?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/apasel422",
      "html_url": "https://github.com/apasel422",
      "followers_url": "https://api.github.com/users/apasel422/followers",
      "following_url": "https://api.github.com/users/apasel422/following{/other_user}",
      "gists_url": "https://api.github.com/users/apasel422/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/apasel422/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/apasel422/subscriptions",
      "organizations_url": "https://api.github.com/users/apasel422/orgs",
      "repos_url": "https://api.github.com/users/apasel422/repos",
      "events_url": "https://api.github.com/users/apasel422/events{/privacy}",
      "received_events_url": "https://api.github.com/users/apasel422/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-09-08T19:01:46Z",
    "updated_at": "2015-09-08T19:01:46Z",
    "body": "See also https://github.com/jemalloc/jemalloc/blob/master/include/jemalloc/internal/valgrind.h.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/138671193/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/138722600",
    "html_url": "https://github.com/rust-lang/rust/issues/28224#issuecomment-138722600",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28224",
    "id": 138722600,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEzODcyMjYwMA==",
    "user": {
      "login": "apasel422",
      "id": 8644784,
      "node_id": "MDQ6VXNlcjg2NDQ3ODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8644784?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/apasel422",
      "html_url": "https://github.com/apasel422",
      "followers_url": "https://api.github.com/users/apasel422/followers",
      "following_url": "https://api.github.com/users/apasel422/following{/other_user}",
      "gists_url": "https://api.github.com/users/apasel422/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/apasel422/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/apasel422/subscriptions",
      "organizations_url": "https://api.github.com/users/apasel422/orgs",
      "repos_url": "https://api.github.com/users/apasel422/repos",
      "events_url": "https://api.github.com/users/apasel422/events{/privacy}",
      "received_events_url": "https://api.github.com/users/apasel422/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-09-08T22:33:20Z",
    "updated_at": "2015-09-08T22:33:20Z",
    "body": "jemalloc is apparently not being built with `--enable-valgrind` (which makes sense for performance reasons):\n\nfoo.c:\n\n``` C\n#include <stdio.h>\n#include <stdlib.h>\n\nextern void je_mallctl(const char *, void *, size_t *, void *, size_t);\n\nint main() {\n    int valgrind = 6;\n    size_t len = 1;\n    je_mallctl(\"config.valgrind\", &valgrind, &len, NULL, 0);\n    printf(\"%d\\n\", valgrind);\n}\n```\n\n``` sh\n> gcc foo.c -L/usr/local/lib/rustlib/x86_64-unknown-linux-gnu/lib/ -l:liballoc_jemalloc-35017696.rlib -lpthread\n> ./a.out \n0\n```\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/138722600/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/138725566",
    "html_url": "https://github.com/rust-lang/rust/issues/28224#issuecomment-138725566",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28224",
    "id": 138725566,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEzODcyNTU2Ng==",
    "user": {
      "login": "apasel422",
      "id": 8644784,
      "node_id": "MDQ6VXNlcjg2NDQ3ODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8644784?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/apasel422",
      "html_url": "https://github.com/apasel422",
      "followers_url": "https://api.github.com/users/apasel422/followers",
      "following_url": "https://api.github.com/users/apasel422/following{/other_user}",
      "gists_url": "https://api.github.com/users/apasel422/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/apasel422/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/apasel422/subscriptions",
      "organizations_url": "https://api.github.com/users/apasel422/orgs",
      "repos_url": "https://api.github.com/users/apasel422/repos",
      "events_url": "https://api.github.com/users/apasel422/events{/privacy}",
      "received_events_url": "https://api.github.com/users/apasel422/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-09-08T22:53:47Z",
    "updated_at": "2015-09-08T22:53:47Z",
    "body": "Building nightly with\n\n``` sh\nJEMALLOC_FLAGS='--enable-valgrind' make\n```\n\nresults in the correct Valgrind behavior.\n\nNot sure how we want to address this, but providing multiple versions of `liballoc_jemalloc` seems like a possibility.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/138725566/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/145181385",
    "html_url": "https://github.com/rust-lang/rust/issues/28224#issuecomment-145181385",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28224",
    "id": 145181385,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE0NTE4MTM4NQ==",
    "user": {
      "login": "shepmaster",
      "id": 174509,
      "node_id": "MDQ6VXNlcjE3NDUwOQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/174509?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/shepmaster",
      "html_url": "https://github.com/shepmaster",
      "followers_url": "https://api.github.com/users/shepmaster/followers",
      "following_url": "https://api.github.com/users/shepmaster/following{/other_user}",
      "gists_url": "https://api.github.com/users/shepmaster/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/shepmaster/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/shepmaster/subscriptions",
      "organizations_url": "https://api.github.com/users/shepmaster/orgs",
      "repos_url": "https://api.github.com/users/shepmaster/repos",
      "events_url": "https://api.github.com/users/shepmaster/events{/privacy}",
      "received_events_url": "https://api.github.com/users/shepmaster/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-10-02T23:18:25Z",
    "updated_at": "2015-10-02T23:18:25Z",
    "body": "FWIW, I ran your example program with `rustc 1.5.0-dev (5f06607e2 2015-09-29)` and `valgrind-3.11.0.SVN` on OS X, and it seems to track allocations:\n\n```\n==28285== HEAP SUMMARY:\n==28285==     in use at exit: 35,221 bytes in 426 blocks\n==28285==   total heap usage: 611 allocs, 185 frees, 42,405 bytes allocated\n```\n\nTo my knowledge, I have not specified any custom flags when building. I also see that massif reports heap allocations over time, so I have some hope that things are just magically working together now!\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/145181385/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/145950976",
    "html_url": "https://github.com/rust-lang/rust/issues/28224#issuecomment-145950976",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28224",
    "id": 145950976,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE0NTk1MDk3Ng==",
    "user": {
      "login": "apasel422",
      "id": 8644784,
      "node_id": "MDQ6VXNlcjg2NDQ3ODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8644784?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/apasel422",
      "html_url": "https://github.com/apasel422",
      "followers_url": "https://api.github.com/users/apasel422/followers",
      "following_url": "https://api.github.com/users/apasel422/following{/other_user}",
      "gists_url": "https://api.github.com/users/apasel422/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/apasel422/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/apasel422/subscriptions",
      "organizations_url": "https://api.github.com/users/apasel422/orgs",
      "repos_url": "https://api.github.com/users/apasel422/repos",
      "events_url": "https://api.github.com/users/apasel422/events{/privacy}",
      "received_events_url": "https://api.github.com/users/apasel422/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-10-06T18:12:52Z",
    "updated_at": "2015-10-06T18:19:36Z",
    "body": "Valgrind on Ubuntu still indicates that this code, compiled with `opt-level=0` on nightly, has only 5 allocations:\n\n``` rust\n#![feature(alloc_jemalloc)]\n#![feature(test)]\n\nextern crate alloc_jemalloc;\nextern crate test;\n\nfn main() {\n    for i in 0..100 {\n        let foo = Box::new(i);\n        test::black_box(foo);\n    }\n}\n```\n\nRemoving the allocator has the same effect, while changing to `alloc_system` reports 112 allocations.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/145950976/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/212564586",
    "html_url": "https://github.com/rust-lang/rust/issues/28224#issuecomment-212564586",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28224",
    "id": 212564586,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIxMjU2NDU4Ng==",
    "user": {
      "login": "Hansyperman",
      "id": 10836055,
      "node_id": "MDQ6VXNlcjEwODM2MDU1",
      "avatar_url": "https://avatars.githubusercontent.com/u/10836055?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Hansyperman",
      "html_url": "https://github.com/Hansyperman",
      "followers_url": "https://api.github.com/users/Hansyperman/followers",
      "following_url": "https://api.github.com/users/Hansyperman/following{/other_user}",
      "gists_url": "https://api.github.com/users/Hansyperman/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Hansyperman/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Hansyperman/subscriptions",
      "organizations_url": "https://api.github.com/users/Hansyperman/orgs",
      "repos_url": "https://api.github.com/users/Hansyperman/repos",
      "events_url": "https://api.github.com/users/Hansyperman/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Hansyperman/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2016-04-20T19:15:38Z",
    "updated_at": "2016-04-20T19:15:38Z",
    "body": "I think I reported this same issue on reddit: rust 1.8 stable lost valgrind support\nhttps://www.reddit.com/r/rust/comments/4fddre/i_lost_valgrind_in_rust_18/\n\nI have a mixed rust/extern \"C\" program. I know it leaks memory and use valgrind to verify behaviour. When I upgraded to rust stable 1.8, it proudly claims not to leak anymore, and even stops allocating memory altogether! While I'm impressed by rusts memory safety guarantees, this is a bit too much for me ;-)\n\nAnyone knows what happens and how to make it un-happen? I read somewhere they integrated jemalloc, so maybe that broke the monitoring allocator from valgrind?\n\nAn example on debian 8.4, x86-64:\n\n```\nextern \"C\" {\n  fn malloc(len: usize) -> *mut u8;\n}\n\nfn main() {\n  println!(\"Allocated at {:?}\",unsafe{malloc(100)});\n}\n```\n\nOn rust 1.8:\n\n```\nme@aruba:~/atest$ rustc --version\nrustc 1.8.0 (db2939409 2016-04-11)\nme@aruba:~/atest$ cargo build\nme@aruba:~/atest$ valgrind  target/debug/atest\n==2921== Memcheck, a memory error detector\n==2921== Copyright (C) 2002-2013, and GNU GPL'd, by Julian Seward et al.\n==2921== Using Valgrind-3.10.0 and LibVEX; rerun with -h for copyright info\n==2921== Command: target/debug/atest\n==2921== \nAllocated at 0x6035000\n==2921== \n==2921== HEAP SUMMARY:\n==2921==     in use at exit: 0 bytes in 0 blocks\n==2921==   total heap usage: 0 allocs, 0 frees, 0 bytes allocated\n==2921== \n==2921== All heap blocks were freed -- no leaks are possible\n==2921== \n==2921== For counts of detected and suppressed errors, rerun with: -v\n==2921== ERROR SUMMARY: 0 errors from 0 contexts (suppressed: 0 from 0)\n```\n\nOn rust 1.7\n\n```\nme@aruba:~/atest$ rustc --version\nrustc 1.7.0 (a5d1e7a59 2016-02-29)\nme@aruba:~/proggies/atest$ cargo build\nCompiling atest v0.1.0 (file:///home/hans/proggies/atest)\nme@aruba:~/atest$ valgrind  target/debug/atest\n==5975== Memcheck, a memory error detector\n==5975== Copyright (C) 2002-2013, and GNU GPL'd, by Julian Seward et al.\n==5975== Using Valgrind-3.10.0 and LibVEX; rerun with -h for copyright info\n==5975== Command: target/debug/atest\n==5975== \nAllocated at 0x5e00570\n==5975== \n==5975== HEAP SUMMARY:\n==5975==     in use at exit: 100 bytes in 1 blocks\n==5975==   total heap usage: 7 allocs, 6 frees, 1,124 bytes allocated\n==5975== \n==5975== LEAK SUMMARY:\n==5975==    definitely lost: 100 bytes in 1 blocks\n==5975==    indirectly lost: 0 bytes in 0 blocks\n==5975==      possibly lost: 0 bytes in 0 blocks\n==5975==    still reachable: 0 bytes in 0 blocks\n==5975==         suppressed: 0 bytes in 0 blocks\n==5975== Rerun with --leak-check=full to see details of leaked memory\n==5975== \n==5975== For counts of detected and suppressed errors, rerun with: -v\n==5975== ERROR SUMMARY: 0 errors from 0 contexts (suppressed: 0 from 0)\n```\n",
    "author_association": "NONE",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/212564586/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/216937335",
    "html_url": "https://github.com/rust-lang/rust/issues/28224#issuecomment-216937335",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28224",
    "id": 216937335,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIxNjkzNzMzNQ==",
    "user": {
      "login": "alexcrichton",
      "id": 64996,
      "node_id": "MDQ6VXNlcjY0OTk2",
      "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alexcrichton",
      "html_url": "https://github.com/alexcrichton",
      "followers_url": "https://api.github.com/users/alexcrichton/followers",
      "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}",
      "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions",
      "organizations_url": "https://api.github.com/users/alexcrichton/orgs",
      "repos_url": "https://api.github.com/users/alexcrichton/repos",
      "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alexcrichton/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2016-05-04T17:18:13Z",
    "updated_at": "2016-05-04T17:18:13Z",
    "body": "The tools team discussed this issue during triage yesterday and the conclusion was that while not high priority we would very much like to see this issue fixed! The `--enable-valgrind` option [mentioned by @apasel422 above](https://github.com/rust-lang/rust/issues/28224#issuecomment-138725566) seems like the best fix here, and we'd just want to investigate if that has any runtime impact or affect on runtime dependencies.\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/216937335/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/219885797",
    "html_url": "https://github.com/rust-lang/rust/issues/28224#issuecomment-219885797",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28224",
    "id": 219885797,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIxOTg4NTc5Nw==",
    "user": {
      "login": "michaelwoerister",
      "id": 1825894,
      "node_id": "MDQ6VXNlcjE4MjU4OTQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1825894?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/michaelwoerister",
      "html_url": "https://github.com/michaelwoerister",
      "followers_url": "https://api.github.com/users/michaelwoerister/followers",
      "following_url": "https://api.github.com/users/michaelwoerister/following{/other_user}",
      "gists_url": "https://api.github.com/users/michaelwoerister/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/michaelwoerister/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/michaelwoerister/subscriptions",
      "organizations_url": "https://api.github.com/users/michaelwoerister/orgs",
      "repos_url": "https://api.github.com/users/michaelwoerister/repos",
      "events_url": "https://api.github.com/users/michaelwoerister/events{/privacy}",
      "received_events_url": "https://api.github.com/users/michaelwoerister/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2016-05-17T23:38:45Z",
    "updated_at": "2016-05-17T23:38:45Z",
    "body": "It seems that Valgrind support in jemalloc is going away:\nhttps://github.com/jemalloc/jemalloc/issues/369\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/219885797/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/239867559",
    "html_url": "https://github.com/rust-lang/rust/issues/28224#issuecomment-239867559",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28224",
    "id": 239867559,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIzOTg2NzU1OQ==",
    "user": {
      "login": "lilith",
      "id": 107935,
      "node_id": "MDQ6VXNlcjEwNzkzNQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/107935?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/lilith",
      "html_url": "https://github.com/lilith",
      "followers_url": "https://api.github.com/users/lilith/followers",
      "following_url": "https://api.github.com/users/lilith/following{/other_user}",
      "gists_url": "https://api.github.com/users/lilith/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/lilith/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/lilith/subscriptions",
      "organizations_url": "https://api.github.com/users/lilith/orgs",
      "repos_url": "https://api.github.com/users/lilith/repos",
      "events_url": "https://api.github.com/users/lilith/events{/privacy}",
      "received_events_url": "https://api.github.com/users/lilith/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2016-08-15T17:26:14Z",
    "updated_at": "2016-08-15T17:26:14Z",
    "body": "I have a mixed C/Rust project targeting windows, linux, & mac. Lots of codecs are involved, and valgrind is an essential tool for verifying that integration tests aren't exposing a new bug in libpng or another dependency (this is a very common occurrence).  \n\nDoes this change mean that I should move all of my integration tests to C++? Or is a custom build of rust required? \n",
    "author_association": "NONE",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/239867559/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/239870111",
    "html_url": "https://github.com/rust-lang/rust/issues/28224#issuecomment-239870111",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28224",
    "id": 239870111,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIzOTg3MDExMQ==",
    "user": {
      "login": "ssokolow",
      "id": 46915,
      "node_id": "MDQ6VXNlcjQ2OTE1",
      "avatar_url": "https://avatars.githubusercontent.com/u/46915?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ssokolow",
      "html_url": "https://github.com/ssokolow",
      "followers_url": "https://api.github.com/users/ssokolow/followers",
      "following_url": "https://api.github.com/users/ssokolow/following{/other_user}",
      "gists_url": "https://api.github.com/users/ssokolow/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ssokolow/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ssokolow/subscriptions",
      "organizations_url": "https://api.github.com/users/ssokolow/orgs",
      "repos_url": "https://api.github.com/users/ssokolow/repos",
      "events_url": "https://api.github.com/users/ssokolow/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ssokolow/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2016-08-15T17:35:14Z",
    "updated_at": "2016-08-15T17:35:14Z",
    "body": "I believe you just need to ask nightly rust to build your project with the system allocator rather than the bundled jemalloc.\n",
    "author_association": "NONE",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/239870111/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/239884534",
    "html_url": "https://github.com/rust-lang/rust/issues/28224#issuecomment-239884534",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28224",
    "id": 239884534,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIzOTg4NDUzNA==",
    "user": {
      "login": "shepmaster",
      "id": 174509,
      "node_id": "MDQ6VXNlcjE3NDUwOQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/174509?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/shepmaster",
      "html_url": "https://github.com/shepmaster",
      "followers_url": "https://api.github.com/users/shepmaster/followers",
      "following_url": "https://api.github.com/users/shepmaster/following{/other_user}",
      "gists_url": "https://api.github.com/users/shepmaster/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/shepmaster/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/shepmaster/subscriptions",
      "organizations_url": "https://api.github.com/users/shepmaster/orgs",
      "repos_url": "https://api.github.com/users/shepmaster/repos",
      "events_url": "https://api.github.com/users/shepmaster/events{/privacy}",
      "received_events_url": "https://api.github.com/users/shepmaster/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2016-08-15T18:23:40Z",
    "updated_at": "2016-08-15T18:23:40Z",
    "body": "Or if you produce a shared library, it will use the system allocator instead of jemalloc by default, which should allow valgrind to work.\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/239884534/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/239901265",
    "html_url": "https://github.com/rust-lang/rust/issues/28224#issuecomment-239901265",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28224",
    "id": 239901265,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIzOTkwMTI2NQ==",
    "user": {
      "login": "lilith",
      "id": 107935,
      "node_id": "MDQ6VXNlcjEwNzkzNQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/107935?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/lilith",
      "html_url": "https://github.com/lilith",
      "followers_url": "https://api.github.com/users/lilith/followers",
      "following_url": "https://api.github.com/users/lilith/following{/other_user}",
      "gists_url": "https://api.github.com/users/lilith/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/lilith/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/lilith/subscriptions",
      "organizations_url": "https://api.github.com/users/lilith/orgs",
      "repos_url": "https://api.github.com/users/lilith/repos",
      "events_url": "https://api.github.com/users/lilith/events{/privacy}",
      "received_events_url": "https://api.github.com/users/lilith/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2016-08-15T19:21:07Z",
    "updated_at": "2016-08-15T19:26:13Z",
    "body": "@ssokolow You mean the 'official' nightly build would do this? What flags would I provide? (Building nightly from source means I can't do this in Travis, which is where I valgrind as part of CI). \n",
    "author_association": "NONE",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/239901265/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/239906708",
    "html_url": "https://github.com/rust-lang/rust/issues/28224#issuecomment-239906708",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28224",
    "id": 239906708,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIzOTkwNjcwOA==",
    "user": {
      "login": "shepmaster",
      "id": 174509,
      "node_id": "MDQ6VXNlcjE3NDUwOQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/174509?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/shepmaster",
      "html_url": "https://github.com/shepmaster",
      "followers_url": "https://api.github.com/users/shepmaster/followers",
      "following_url": "https://api.github.com/users/shepmaster/following{/other_user}",
      "gists_url": "https://api.github.com/users/shepmaster/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/shepmaster/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/shepmaster/subscriptions",
      "organizations_url": "https://api.github.com/users/shepmaster/orgs",
      "repos_url": "https://api.github.com/users/shepmaster/repos",
      "events_url": "https://api.github.com/users/shepmaster/events{/privacy}",
      "received_events_url": "https://api.github.com/users/shepmaster/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2016-08-15T19:42:46Z",
    "updated_at": "2016-08-15T19:42:46Z",
    "body": "The [documentation covers specifying allocators](https://doc.rust-lang.org/book/custom-allocators.html).\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/239906708/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/239909705",
    "html_url": "https://github.com/rust-lang/rust/issues/28224#issuecomment-239909705",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28224",
    "id": 239909705,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIzOTkwOTcwNQ==",
    "user": {
      "login": "lilith",
      "id": 107935,
      "node_id": "MDQ6VXNlcjEwNzkzNQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/107935?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/lilith",
      "html_url": "https://github.com/lilith",
      "followers_url": "https://api.github.com/users/lilith/followers",
      "following_url": "https://api.github.com/users/lilith/following{/other_user}",
      "gists_url": "https://api.github.com/users/lilith/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/lilith/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/lilith/subscriptions",
      "organizations_url": "https://api.github.com/users/lilith/orgs",
      "repos_url": "https://api.github.com/users/lilith/repos",
      "events_url": "https://api.github.com/users/lilith/events{/privacy}",
      "received_events_url": "https://api.github.com/users/lilith/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2016-08-15T19:54:00Z",
    "updated_at": "2016-08-15T19:54:00Z",
    "body": "Thank you! The \"--enable-valgrind\" context led me to misunderstand @ssokolow.  \n\nSo to clarify, there's no compilation flag that can change this; I would need to inject source code `#[feature(alloc_system)] extern crate alloc_system;` into my tests, but only as a permutation for the nightly channel?\n",
    "author_association": "NONE",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/239909705/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/239912830",
    "html_url": "https://github.com/rust-lang/rust/issues/28224#issuecomment-239912830",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28224",
    "id": 239912830,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIzOTkxMjgzMA==",
    "user": {
      "login": "ssokolow",
      "id": 46915,
      "node_id": "MDQ6VXNlcjQ2OTE1",
      "avatar_url": "https://avatars.githubusercontent.com/u/46915?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ssokolow",
      "html_url": "https://github.com/ssokolow",
      "followers_url": "https://api.github.com/users/ssokolow/followers",
      "following_url": "https://api.github.com/users/ssokolow/following{/other_user}",
      "gists_url": "https://api.github.com/users/ssokolow/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ssokolow/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ssokolow/subscriptions",
      "organizations_url": "https://api.github.com/users/ssokolow/orgs",
      "repos_url": "https://api.github.com/users/ssokolow/repos",
      "events_url": "https://api.github.com/users/ssokolow/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ssokolow/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2016-08-15T20:05:31Z",
    "updated_at": "2016-08-15T20:05:31Z",
    "body": "Yes. As I understand the situation, compiling jemalloc with `--enable-valgrind` either is or was a temporary measure before support will be/was dropped entirely.\n",
    "author_association": "NONE",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/239912830/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/240835116",
    "html_url": "https://github.com/rust-lang/rust/issues/28224#issuecomment-240835116",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28224",
    "id": 240835116,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI0MDgzNTExNg==",
    "user": {
      "login": "lilith",
      "id": 107935,
      "node_id": "MDQ6VXNlcjEwNzkzNQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/107935?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/lilith",
      "html_url": "https://github.com/lilith",
      "followers_url": "https://api.github.com/users/lilith/followers",
      "following_url": "https://api.github.com/users/lilith/following{/other_user}",
      "gists_url": "https://api.github.com/users/lilith/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/lilith/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/lilith/subscriptions",
      "organizations_url": "https://api.github.com/users/lilith/orgs",
      "repos_url": "https://api.github.com/users/lilith/repos",
      "events_url": "https://api.github.com/users/lilith/events{/privacy}",
      "received_events_url": "https://api.github.com/users/lilith/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2016-08-18T19:46:38Z",
    "updated_at": "2016-08-18T19:46:38Z",
    "body": "There is the problem that I'm running valgrind against a totally different executable, compiled by nightly instead of stable. Essentially this means I can't valgrind products of a stable rust build. \n",
    "author_association": "NONE",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/240835116/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/240883198",
    "html_url": "https://github.com/rust-lang/rust/issues/28224#issuecomment-240883198",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28224",
    "id": 240883198,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI0MDg4MzE5OA==",
    "user": {
      "login": "ssokolow",
      "id": 46915,
      "node_id": "MDQ6VXNlcjQ2OTE1",
      "avatar_url": "https://avatars.githubusercontent.com/u/46915?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ssokolow",
      "html_url": "https://github.com/ssokolow",
      "followers_url": "https://api.github.com/users/ssokolow/followers",
      "following_url": "https://api.github.com/users/ssokolow/following{/other_user}",
      "gists_url": "https://api.github.com/users/ssokolow/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ssokolow/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ssokolow/subscriptions",
      "organizations_url": "https://api.github.com/users/ssokolow/orgs",
      "repos_url": "https://api.github.com/users/ssokolow/repos",
      "events_url": "https://api.github.com/users/ssokolow/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ssokolow/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2016-08-18T23:05:30Z",
    "updated_at": "2016-08-18T23:05:48Z",
    "body": "@nathanaeljones I'm no expert, but you could look into making a custom rust build with an older jemalloc and/or `--enable-valgrind` (as appropriate) while you wait for `alloc_system` support to be in stable.\n",
    "author_association": "NONE",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/240883198/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/246044782",
    "html_url": "https://github.com/rust-lang/rust/issues/28224#issuecomment-246044782",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28224",
    "id": 246044782,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI0NjA0NDc4Mg==",
    "user": {
      "login": "lilith",
      "id": 107935,
      "node_id": "MDQ6VXNlcjEwNzkzNQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/107935?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/lilith",
      "html_url": "https://github.com/lilith",
      "followers_url": "https://api.github.com/users/lilith/followers",
      "following_url": "https://api.github.com/users/lilith/following{/other_user}",
      "gists_url": "https://api.github.com/users/lilith/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/lilith/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/lilith/subscriptions",
      "organizations_url": "https://api.github.com/users/lilith/orgs",
      "repos_url": "https://api.github.com/users/lilith/repos",
      "events_url": "https://api.github.com/users/lilith/events{/privacy}",
      "received_events_url": "https://api.github.com/users/lilith/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2016-09-09T21:26:14Z",
    "updated_at": "2016-09-09T21:26:14Z",
    "body": "@ssokolow Thanks! For now it looks like nightly will be a requirement for other reasons anyway :) \n\nValgrind has been crucial for my work with unsafe Rust. As far as I can tell there's no way to make the generated test harnesses Valgrind-friendly; a standalone executable is required. \n",
    "author_association": "NONE",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/246044782/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/281552903",
    "html_url": "https://github.com/rust-lang/rust/issues/28224#issuecomment-281552903",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28224",
    "id": 281552903,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI4MTU1MjkwMw==",
    "user": {
      "login": "ssokolow",
      "id": 46915,
      "node_id": "MDQ6VXNlcjQ2OTE1",
      "avatar_url": "https://avatars.githubusercontent.com/u/46915?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ssokolow",
      "html_url": "https://github.com/ssokolow",
      "followers_url": "https://api.github.com/users/ssokolow/followers",
      "following_url": "https://api.github.com/users/ssokolow/following{/other_user}",
      "gists_url": "https://api.github.com/users/ssokolow/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ssokolow/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ssokolow/subscriptions",
      "organizations_url": "https://api.github.com/users/ssokolow/orgs",
      "repos_url": "https://api.github.com/users/ssokolow/repos",
      "events_url": "https://api.github.com/users/ssokolow/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ssokolow/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2017-02-22T02:51:09Z",
    "updated_at": "2017-02-22T02:51:09Z",
    "body": "As a quick update, since this is getting linked to, here's how I make the system allocator opt-in for nightly:\r\n\r\nFirst, add these lines to the top of main.rs:\r\n\r\n```rust\r\n#![cfg_attr(feature=\"nightly\", feature(alloc_system))]\r\n#[cfg(feature=\"nightly\")]\r\nextern crate alloc_system;\r\n```\r\nThen, add these to Cargo.toml...\r\n```rust\r\n[features]\r\nnightly = []\r\n```\r\nAnd, finally, use these commands for setup and building:\r\n```rust\r\nrustup toolchain add nightly-x86_64-unknown-linux-gnu\r\ncargo +nightly build --features=nightly\r\n```\r\n\r\nFor records purposes:\r\n* I pieced that together for an automation \"script\" I haven't yet released, where I want to crunch down the size of a musl build.\r\n* I first posted those instructions [here on reddit](https://www.reddit.com/r/rust/comments/5tgxmn/optimizing_rc_memory_usage_in_rust/ddmivgi/).\r\n* I later cleaned up the reusable bits (so far) of the project I'd developed them in and published [this CLI project boilerplate](https://github.com/ssokolow/rust-cli-boilerplate), which incorporates that code and splits it between the `just install-rustup-deps` and `just channel=nightly build-release` commands.",
    "author_association": "NONE",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/281552903/reactions",
      "total_count": 2,
      "+1": 2,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/309781289",
    "html_url": "https://github.com/rust-lang/rust/issues/28224#issuecomment-309781289",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28224",
    "id": 309781289,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMwOTc4MTI4OQ==",
    "user": {
      "login": "alexcrichton",
      "id": 64996,
      "node_id": "MDQ6VXNlcjY0OTk2",
      "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alexcrichton",
      "html_url": "https://github.com/alexcrichton",
      "followers_url": "https://api.github.com/users/alexcrichton/followers",
      "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}",
      "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions",
      "organizations_url": "https://api.github.com/users/alexcrichton/orgs",
      "repos_url": "https://api.github.com/users/alexcrichton/repos",
      "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alexcrichton/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2017-06-20T14:47:26Z",
    "updated_at": "2017-06-20T14:54:02Z",
    "body": "We're unlikely to really do anything to fix this, so I'm going to close this in favor of https://github.com/rust-lang/rust/issues/27389. It's highly likely that all programs will start to link to ~~jemalloc~~ the system allocator by default once we stabilize that feature.",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/309781289/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
