{
  "url": "https://api.github.com/repos/rust-lang/rust/issues/30652",
  "repository_url": "https://api.github.com/repos/rust-lang/rust",
  "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/30652/labels{/name}",
  "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/30652/comments",
  "events_url": "https://api.github.com/repos/rust-lang/rust/issues/30652/events",
  "html_url": "https://github.com/rust-lang/rust/pull/30652",
  "id": 124415868,
  "node_id": "MDExOlB1bGxSZXF1ZXN0NTQ4MzkxMjQ=",
  "number": 30652,
  "title": "Implement RFC 1210: impl specialization",
  "user": {
    "login": "aturon",
    "id": 709807,
    "node_id": "MDQ6VXNlcjcwOTgwNw==",
    "avatar_url": "https://avatars.githubusercontent.com/u/709807?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/aturon",
    "html_url": "https://github.com/aturon",
    "followers_url": "https://api.github.com/users/aturon/followers",
    "following_url": "https://api.github.com/users/aturon/following{/other_user}",
    "gists_url": "https://api.github.com/users/aturon/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/aturon/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/aturon/subscriptions",
    "organizations_url": "https://api.github.com/users/aturon/orgs",
    "repos_url": "https://api.github.com/users/aturon/repos",
    "events_url": "https://api.github.com/users/aturon/events{/privacy}",
    "received_events_url": "https://api.github.com/users/aturon/received_events",
    "type": "User",
    "user_view_type": "public",
    "site_admin": false
  },
  "labels": [],
  "state": "closed",
  "locked": false,
  "assignee": {
    "login": "nikomatsakis",
    "id": 155238,
    "node_id": "MDQ6VXNlcjE1NTIzOA==",
    "avatar_url": "https://avatars.githubusercontent.com/u/155238?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/nikomatsakis",
    "html_url": "https://github.com/nikomatsakis",
    "followers_url": "https://api.github.com/users/nikomatsakis/followers",
    "following_url": "https://api.github.com/users/nikomatsakis/following{/other_user}",
    "gists_url": "https://api.github.com/users/nikomatsakis/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/nikomatsakis/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/nikomatsakis/subscriptions",
    "organizations_url": "https://api.github.com/users/nikomatsakis/orgs",
    "repos_url": "https://api.github.com/users/nikomatsakis/repos",
    "events_url": "https://api.github.com/users/nikomatsakis/events{/privacy}",
    "received_events_url": "https://api.github.com/users/nikomatsakis/received_events",
    "type": "User",
    "user_view_type": "public",
    "site_admin": false
  },
  "assignees": [
    {
      "login": "nikomatsakis",
      "id": 155238,
      "node_id": "MDQ6VXNlcjE1NTIzOA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/155238?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nikomatsakis",
      "html_url": "https://github.com/nikomatsakis",
      "followers_url": "https://api.github.com/users/nikomatsakis/followers",
      "following_url": "https://api.github.com/users/nikomatsakis/following{/other_user}",
      "gists_url": "https://api.github.com/users/nikomatsakis/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nikomatsakis/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nikomatsakis/subscriptions",
      "organizations_url": "https://api.github.com/users/nikomatsakis/orgs",
      "repos_url": "https://api.github.com/users/nikomatsakis/repos",
      "events_url": "https://api.github.com/users/nikomatsakis/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nikomatsakis/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    }
  ],
  "milestone": null,
  "comments": 78,
  "created_at": "2015-12-30T23:59:30Z",
  "updated_at": "2016-03-15T04:17:47Z",
  "closed_at": "2016-03-15T04:09:38Z",
  "author_association": "CONTRIBUTOR",
  "type": null,
  "active_lock_reason": null,
  "draft": false,
  "pull_request": {
    "url": "https://api.github.com/repos/rust-lang/rust/pulls/30652",
    "html_url": "https://github.com/rust-lang/rust/pull/30652",
    "diff_url": "https://github.com/rust-lang/rust/pull/30652.diff",
    "patch_url": "https://github.com/rust-lang/rust/pull/30652.patch",
    "merged_at": "2016-03-15T04:09:38Z"
  },
  "body": "This PR implements [impl specialization](https://github.com/rust-lang/rfcs/pull/1210), \ncarefully following the proposal laid out in the RFC.\n\nThe implementation covers the bulk of the RFC. The remaining gaps I know of are: \n- no checking for lifetime-dependent specialization (a soundness hole);\n- no `default impl` yet;\n- no support for `default` with associated consts;\n\nI plan to cover these gaps in follow-up PRs, as per @nikomatsakis's preference.\n\nThe basic strategy is to build up a _specialization graph_ during\ncoherence checking. Insertion into the graph locates the right place\nto put an impl in the specialization hierarchy; if there is no right\nplace (due to partial overlap but no containment), you get an overlap\nerror. Specialization is consulted when selecting an impl (of course),\nand the graph is consulted when propagating defaults down the\nspecialization hierarchy.\n\nYou might expect that the specialization graph would be used during\nselection -- i.e., when actually performing specialization. This is\nnot done for two reasons:\n- It's merely an optimization: given a set of candidates that apply,\n  we can determine the most specialized one by comparing them directly\n  for specialization, rather than consulting the graph. Given that we\n  also cache the results of selection, the benefit of this\n  optimization is questionable.\n- To build the specialization graph in the first place, we need to use\n  selection (because we need to determine whether one impl specializes\n  another). Dealing with this reentrancy would require some additional\n  mode switch for selection. Given that there seems to be no strong\n  reason to use the graph anyway, we stick with a simpler approach in\n  selection, and use the graph only for propagating default\n  implementations.\n\nTrait impl selection can succeed even when multiple impls can apply,\nas long as they are part of the same specialization family. In that\ncase, it returns a _single_ impl on success -- this is the most\nspecialized impl _known_ to apply. However, if there are any inference\nvariables in play, the returned impl may not be the actual impl we\nwill use at trans time. Thus, we take special care to avoid projecting\nassociated types unless either (1) the associated type does not use\n`default` and thus cannot be overridden or (2) all input types are\nknown concretely.\n\nr? @nikomatsakis \n",
  "closed_by": {
    "login": "bors",
    "id": 3372342,
    "node_id": "MDQ6VXNlcjMzNzIzNDI=",
    "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/bors",
    "html_url": "https://github.com/bors",
    "followers_url": "https://api.github.com/users/bors/followers",
    "following_url": "https://api.github.com/users/bors/following{/other_user}",
    "gists_url": "https://api.github.com/users/bors/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/bors/subscriptions",
    "organizations_url": "https://api.github.com/users/bors/orgs",
    "repos_url": "https://api.github.com/users/bors/repos",
    "events_url": "https://api.github.com/users/bors/events{/privacy}",
    "received_events_url": "https://api.github.com/users/bors/received_events",
    "type": "User",
    "user_view_type": "public",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/30652/reactions",
    "total_count": 38,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 38,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/30652/timeline",
  "performed_via_github_app": null,
  "state_reason": null,
  "_meta": {
    "type": "pr"
  }
}
