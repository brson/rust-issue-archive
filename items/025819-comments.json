[
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/105879600",
    "html_url": "https://github.com/rust-lang/rust/issues/25819#issuecomment-105879600",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/25819",
    "id": 105879600,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEwNTg3OTYwMA==",
    "user": {
      "login": "jooert",
      "id": 1774713,
      "node_id": "MDQ6VXNlcjE3NzQ3MTM=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1774713?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jooert",
      "html_url": "https://github.com/jooert",
      "followers_url": "https://api.github.com/users/jooert/followers",
      "following_url": "https://api.github.com/users/jooert/following{/other_user}",
      "gists_url": "https://api.github.com/users/jooert/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jooert/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jooert/subscriptions",
      "organizations_url": "https://api.github.com/users/jooert/orgs",
      "repos_url": "https://api.github.com/users/jooert/repos",
      "events_url": "https://api.github.com/users/jooert/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jooert/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-05-27T11:38:28Z",
    "updated_at": "2015-05-27T11:38:28Z",
    "body": "The problem here is that `rustc: Unknown command line argument 'xyz'.  Try: 'rustc -help'` is actually printed by LLVM (see [src/llvm/lib/Support/CommandLine.cpp](https://github.com/rust-lang/llvm/blob/bff69076975642c64e76dbeaa53476bfa7212086/lib/Support/CommandLine.cpp#L948)) which `rustc` calls with a faked program name (see [src/librustc_trans/back/write.rs](https://github.com/rust-lang/rust/blob/master/src/librustc_trans/back/write.rs#L1027)).\n\nWe could change `CommandLine.cpp` to print `Try: 'rustc --help'` but that won't help with the real issue as `rustc --help` doesn't print anything about valid arguments to LLVM. To get information about those you would have to call `rustc dummy.rs -C llvm-args=-help` (note that you cannot call `rustc -C llvm-args=-help` without an input file, which is pretty awkward, too).\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/105879600/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/450992568",
    "html_url": "https://github.com/rust-lang/rust/issues/25819#issuecomment-450992568",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/25819",
    "id": 450992568,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ1MDk5MjU2OA==",
    "user": {
      "login": "mark-i-m",
      "id": 8827840,
      "node_id": "MDQ6VXNlcjg4Mjc4NDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8827840?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mark-i-m",
      "html_url": "https://github.com/mark-i-m",
      "followers_url": "https://api.github.com/users/mark-i-m/followers",
      "following_url": "https://api.github.com/users/mark-i-m/following{/other_user}",
      "gists_url": "https://api.github.com/users/mark-i-m/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mark-i-m/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mark-i-m/subscriptions",
      "organizations_url": "https://api.github.com/users/mark-i-m/orgs",
      "repos_url": "https://api.github.com/users/mark-i-m/repos",
      "events_url": "https://api.github.com/users/mark-i-m/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mark-i-m/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2019-01-02T21:35:51Z",
    "updated_at": "2019-01-02T21:35:51Z",
    "body": "I played around with this a little, but didn't get very far because of my lack of expertise in how codegen is called. Here's an update for the next person that comes along:\r\n- The offending message is produced from LLVM's argument parser\r\n    - src/llvm/lib/Support/CommandLine.cpp in `ParseCommandLineOptions`.\r\n- Everything else is unchanged from https://github.com/rust-lang/rust/issues/25819#issuecomment-105879600\r\n- It would be great if the fix didn't have to involve landing a patch in LLVM.\r\n- One fix is to add a rustc flag `--llvm-help` that calls LLVM with the `-help` flag. Unfortunately, this is hard because the codegen backend is not initialized until after we have parsed flags and handled stuff like `--help`.\r\n    - Help/usage messages are printed in `handle_options` in `src/librustc_driver/lib.rs` which is called from `run_compiler` (same file).\r\n    - `run_compiler` calls `run_compiler_with_pool` _after_ `handle_options` is done.\r\n    - `run_compiler_with_pool` builds a whole compiler `Session` first before building and initializing the codegen backend with `get_codegen_backend`.\r\n    - `get_codegen_backend` calls `backend.init(&sess)` which eventually calls `configure_llvm` in src/librustc_codegen_llvm/llvm_util.rs`\r\n    - `configure_llvm` makes the FFI call `llvm::LLVMRustSetLLVMOptions` which calls the parser in LLVM (in C++)...",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/450992568/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/2312485825",
    "html_url": "https://github.com/rust-lang/rust/issues/25819#issuecomment-2312485825",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/25819",
    "id": 2312485825,
    "node_id": "IC_kwDOAAsO6M6J1bvB",
    "user": {
      "login": "Dylan-DPC",
      "id": 99973273,
      "node_id": "U_kgDOBfV4mQ",
      "avatar_url": "https://avatars.githubusercontent.com/u/99973273?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Dylan-DPC",
      "html_url": "https://github.com/Dylan-DPC",
      "followers_url": "https://api.github.com/users/Dylan-DPC/followers",
      "following_url": "https://api.github.com/users/Dylan-DPC/following{/other_user}",
      "gists_url": "https://api.github.com/users/Dylan-DPC/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Dylan-DPC/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Dylan-DPC/subscriptions",
      "organizations_url": "https://api.github.com/users/Dylan-DPC/orgs",
      "repos_url": "https://api.github.com/users/Dylan-DPC/repos",
      "events_url": "https://api.github.com/users/Dylan-DPC/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Dylan-DPC/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2024-08-27T12:54:39Z",
    "updated_at": "2024-08-27T12:54:39Z",
    "body": "Closing this as it's fixed\r\n\r\nCurrent output:\r\n```\r\nrustc -Cllvm-args=\"...\" with: Unknown command line argument 'xyz'.  Try: 'rustc -Cllvm-args=\"...\" with --help'\r\n```",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/2312485825/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
