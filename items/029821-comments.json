[
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/156583413",
    "html_url": "https://github.com/rust-lang/rust/issues/29821#issuecomment-156583413",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/29821",
    "id": 156583413,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE1NjU4MzQxMw==",
    "user": {
      "login": "nikomatsakis",
      "id": 155238,
      "node_id": "MDQ6VXNlcjE1NTIzOA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/155238?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nikomatsakis",
      "html_url": "https://github.com/nikomatsakis",
      "followers_url": "https://api.github.com/users/nikomatsakis/followers",
      "following_url": "https://api.github.com/users/nikomatsakis/following{/other_user}",
      "gists_url": "https://api.github.com/users/nikomatsakis/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nikomatsakis/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nikomatsakis/subscriptions",
      "organizations_url": "https://api.github.com/users/nikomatsakis/orgs",
      "repos_url": "https://api.github.com/users/nikomatsakis/repos",
      "events_url": "https://api.github.com/users/nikomatsakis/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nikomatsakis/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-11-13T23:03:59Z",
    "updated_at": "2015-11-13T23:03:59Z",
    "body": "(@alevy expressed interest in working on this, I will mentor.)\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/156583413/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/252452148",
    "html_url": "https://github.com/rust-lang/rust/issues/29821#issuecomment-252452148",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/29821",
    "id": 252452148,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI1MjQ1MjE0OA==",
    "user": {
      "login": "bstrie",
      "id": 865233,
      "node_id": "MDQ6VXNlcjg2NTIzMw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/865233?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/bstrie",
      "html_url": "https://github.com/bstrie",
      "followers_url": "https://api.github.com/users/bstrie/followers",
      "following_url": "https://api.github.com/users/bstrie/following{/other_user}",
      "gists_url": "https://api.github.com/users/bstrie/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/bstrie/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/bstrie/subscriptions",
      "organizations_url": "https://api.github.com/users/bstrie/orgs",
      "repos_url": "https://api.github.com/users/bstrie/repos",
      "events_url": "https://api.github.com/users/bstrie/events{/privacy}",
      "received_events_url": "https://api.github.com/users/bstrie/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2016-10-08T22:31:25Z",
    "updated_at": "2016-10-08T22:31:25Z",
    "body": "Triage: still relevant.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/252452148/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/252502243",
    "html_url": "https://github.com/rust-lang/rust/issues/29821#issuecomment-252502243",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/29821",
    "id": 252502243,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI1MjUwMjI0Mw==",
    "user": {
      "login": "alevy",
      "id": 4689,
      "node_id": "MDQ6VXNlcjQ2ODk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4689?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alevy",
      "html_url": "https://github.com/alevy",
      "followers_url": "https://api.github.com/users/alevy/followers",
      "following_url": "https://api.github.com/users/alevy/following{/other_user}",
      "gists_url": "https://api.github.com/users/alevy/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alevy/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alevy/subscriptions",
      "organizations_url": "https://api.github.com/users/alevy/orgs",
      "repos_url": "https://api.github.com/users/alevy/repos",
      "events_url": "https://api.github.com/users/alevy/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alevy/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2016-10-09T18:09:32Z",
    "updated_at": "2016-10-09T18:09:32Z",
    "body": "I'm still interested in helping to fix this. @nikomatsakis you mentioned at one point that you had a hunch for where the problem was. Perhaps a pointer would be enough to get the ball rolling?\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/252502243/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/253272092",
    "html_url": "https://github.com/rust-lang/rust/issues/29821#issuecomment-253272092",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/29821",
    "id": 253272092,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI1MzI3MjA5Mg==",
    "user": {
      "login": "nikomatsakis",
      "id": 155238,
      "node_id": "MDQ6VXNlcjE1NTIzOA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/155238?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nikomatsakis",
      "html_url": "https://github.com/nikomatsakis",
      "followers_url": "https://api.github.com/users/nikomatsakis/followers",
      "following_url": "https://api.github.com/users/nikomatsakis/following{/other_user}",
      "gists_url": "https://api.github.com/users/nikomatsakis/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nikomatsakis/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nikomatsakis/subscriptions",
      "organizations_url": "https://api.github.com/users/nikomatsakis/orgs",
      "repos_url": "https://api.github.com/users/nikomatsakis/repos",
      "events_url": "https://api.github.com/users/nikomatsakis/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nikomatsakis/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2016-10-12T16:55:04Z",
    "updated_at": "2016-10-12T16:55:04Z",
    "body": "@alevy Hmm. So, the error is emitted by the \"constant qualification\" code, which walks the MIR for generating a constant value and looks for things that should be disallowed. One of those things is the creation of a struct which has a destructor.\n\nThis code is in `src/librustc_mir/transform/qualify_consts.rs`. I think where I would start is trying to insert some `debug!` to track out exactly what is happening. My guess would be that we are walking down [this branch](https://github.com/rust-lang/rust/blob/master/src/librustc_mir/transform/qualify_consts.rs#L761-L764), but I'm actually not sure. \n\ncc @eddyb, author of the code in question\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/253272092/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/253273683",
    "html_url": "https://github.com/rust-lang/rust/issues/29821#issuecomment-253273683",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/29821",
    "id": 253273683,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI1MzI3MzY4Mw==",
    "user": {
      "login": "eddyb",
      "id": 77424,
      "node_id": "MDQ6VXNlcjc3NDI0",
      "avatar_url": "https://avatars.githubusercontent.com/u/77424?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/eddyb",
      "html_url": "https://github.com/eddyb",
      "followers_url": "https://api.github.com/users/eddyb/followers",
      "following_url": "https://api.github.com/users/eddyb/following{/other_user}",
      "gists_url": "https://api.github.com/users/eddyb/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/eddyb/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/eddyb/subscriptions",
      "organizations_url": "https://api.github.com/users/eddyb/orgs",
      "repos_url": "https://api.github.com/users/eddyb/repos",
      "events_url": "https://api.github.com/users/eddyb/events{/privacy}",
      "received_events_url": "https://api.github.com/users/eddyb/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2016-10-12T17:01:05Z",
    "updated_at": "2016-10-12T17:01:05Z",
    "body": "It might be the type contents, if we use them for \"needs drop\". Aren't they conservative wrt projections?\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/253273683/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/253587824",
    "html_url": "https://github.com/rust-lang/rust/issues/29821#issuecomment-253587824",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/29821",
    "id": 253587824,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI1MzU4NzgyNA==",
    "user": {
      "login": "nikomatsakis",
      "id": 155238,
      "node_id": "MDQ6VXNlcjE1NTIzOA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/155238?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nikomatsakis",
      "html_url": "https://github.com/nikomatsakis",
      "followers_url": "https://api.github.com/users/nikomatsakis/followers",
      "following_url": "https://api.github.com/users/nikomatsakis/following{/other_user}",
      "gists_url": "https://api.github.com/users/nikomatsakis/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nikomatsakis/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nikomatsakis/subscriptions",
      "organizations_url": "https://api.github.com/users/nikomatsakis/orgs",
      "repos_url": "https://api.github.com/users/nikomatsakis/repos",
      "events_url": "https://api.github.com/users/nikomatsakis/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nikomatsakis/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2016-10-13T17:53:00Z",
    "updated_at": "2016-10-13T17:53:00Z",
    "body": "@eddyb that was my first assumption, that it was something like that. When I was poking about in the code I didn't see the place where we branch into that, but maybe I just wasn't reading very carefully. \n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/253587824/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/253597987",
    "html_url": "https://github.com/rust-lang/rust/issues/29821#issuecomment-253597987",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/29821",
    "id": 253597987,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI1MzU5Nzk4Nw==",
    "user": {
      "login": "eddyb",
      "id": 77424,
      "node_id": "MDQ6VXNlcjc3NDI0",
      "avatar_url": "https://avatars.githubusercontent.com/u/77424?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/eddyb",
      "html_url": "https://github.com/eddyb",
      "followers_url": "https://api.github.com/users/eddyb/followers",
      "following_url": "https://api.github.com/users/eddyb/following{/other_user}",
      "gists_url": "https://api.github.com/users/eddyb/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/eddyb/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/eddyb/subscriptions",
      "organizations_url": "https://api.github.com/users/eddyb/orgs",
      "repos_url": "https://api.github.com/users/eddyb/repos",
      "events_url": "https://api.github.com/users/eddyb/events{/privacy}",
      "received_events_url": "https://api.github.com/users/eddyb/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2016-10-13T18:29:32Z",
    "updated_at": "2016-10-13T18:29:32Z",
    "body": "[`Qualif::restrict`](https://github.com/rust-lang/rust/blob/d34318dd538bf4c9175e4138b3e4188ea8211620/src/librustc_mir/transform/qualify_consts.rs#L92) calls into [`TyCtxt::type_needs_drop_given_env`](https://github.com/rust-lang/rust/blob/d34318dd538bf4c9175e4138b3e4188ea8211620/src/librustc/ty/mod.rs#L2504-L2513) which references #22815.\ncc @pnkfelix This could at least try to normalize projections, which would fix the problem here.\nBtw we can now remove \"type contents\" and replace it with two cached flags (`UnsafeCell` & needs-drop).\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/253597987/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/772913483",
    "html_url": "https://github.com/rust-lang/rust/issues/29821#issuecomment-772913483",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/29821",
    "id": 772913483,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc3MjkxMzQ4Mw==",
    "user": {
      "login": "ObsidianMinor",
      "id": 10121870,
      "node_id": "MDQ6VXNlcjEwMTIxODcw",
      "avatar_url": "https://avatars.githubusercontent.com/u/10121870?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ObsidianMinor",
      "html_url": "https://github.com/ObsidianMinor",
      "followers_url": "https://api.github.com/users/ObsidianMinor/followers",
      "following_url": "https://api.github.com/users/ObsidianMinor/following{/other_user}",
      "gists_url": "https://api.github.com/users/ObsidianMinor/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ObsidianMinor/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ObsidianMinor/subscriptions",
      "organizations_url": "https://api.github.com/users/ObsidianMinor/orgs",
      "repos_url": "https://api.github.com/users/ObsidianMinor/repos",
      "events_url": "https://api.github.com/users/ObsidianMinor/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ObsidianMinor/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2021-02-04T00:02:55Z",
    "updated_at": "2021-02-04T00:02:55Z",
    "body": "This doesn't seem to be an issue anymore. Running the provided \"non-working\" code doesn't trigger a compiler error.",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/772913483/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/772937479",
    "html_url": "https://github.com/rust-lang/rust/issues/29821#issuecomment-772937479",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/29821",
    "id": 772937479,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc3MjkzNzQ3OQ==",
    "user": {
      "login": "alevy",
      "id": 4689,
      "node_id": "MDQ6VXNlcjQ2ODk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4689?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alevy",
      "html_url": "https://github.com/alevy",
      "followers_url": "https://api.github.com/users/alevy/followers",
      "following_url": "https://api.github.com/users/alevy/following{/other_user}",
      "gists_url": "https://api.github.com/users/alevy/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alevy/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alevy/subscriptions",
      "organizations_url": "https://api.github.com/users/alevy/orgs",
      "repos_url": "https://api.github.com/users/alevy/repos",
      "events_url": "https://api.github.com/users/alevy/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alevy/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2021-02-04T00:44:42Z",
    "updated_at": "2021-02-04T00:44:42Z",
    "body": "Indeed, this not longer seems to be an issue. Happy to close the issue :)",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/772937479/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/772937681",
    "html_url": "https://github.com/rust-lang/rust/issues/29821#issuecomment-772937681",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/29821",
    "id": 772937681,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc3MjkzNzY4MQ==",
    "user": {
      "login": "bstrie",
      "id": 865233,
      "node_id": "MDQ6VXNlcjg2NTIzMw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/865233?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/bstrie",
      "html_url": "https://github.com/bstrie",
      "followers_url": "https://api.github.com/users/bstrie/followers",
      "following_url": "https://api.github.com/users/bstrie/following{/other_user}",
      "gists_url": "https://api.github.com/users/bstrie/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/bstrie/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/bstrie/subscriptions",
      "organizations_url": "https://api.github.com/users/bstrie/orgs",
      "repos_url": "https://api.github.com/users/bstrie/repos",
      "events_url": "https://api.github.com/users/bstrie/events{/privacy}",
      "received_events_url": "https://api.github.com/users/bstrie/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2021-02-04T00:45:14Z",
    "updated_at": "2021-02-04T00:45:14Z",
    "body": "Should we add a regression test first?",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/772937681/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
