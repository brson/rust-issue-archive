[
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/40155322",
    "html_url": "https://github.com/rust-lang/rust/pull/13448#issuecomment-40155322",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/13448",
    "id": 40155322,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQwMTU1MzIy",
    "user": {
      "login": "liigo",
      "id": 346530,
      "node_id": "MDQ6VXNlcjM0NjUzMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/346530?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/liigo",
      "html_url": "https://github.com/liigo",
      "followers_url": "https://api.github.com/users/liigo/followers",
      "following_url": "https://api.github.com/users/liigo/following{/other_user}",
      "gists_url": "https://api.github.com/users/liigo/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/liigo/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/liigo/subscriptions",
      "organizations_url": "https://api.github.com/users/liigo/orgs",
      "repos_url": "https://api.github.com/users/liigo/repos",
      "events_url": "https://api.github.com/users/liigo/events{/privacy}",
      "received_events_url": "https://api.github.com/users/liigo/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-04-10T23:36:11Z",
    "updated_at": "2014-04-10T23:36:11Z",
    "body": "I'd suggest:\n1. Remove send and rename send_opt to send.\n2. Just rename send_opt to send_r, r means result/return.\nThe same to recv.\n2014\u5e744\u670811\u65e5 \u4e0a\u53486:16\u4e8e \"Alex Crichton\" notifications@github.com\u5199\u9053\uff1a\n\n> There are currently a number of return values from the std::comm methods,\n> not\n> all of which are necessarily completely expressive:\n> \n>    -\n> \n>    Sender::try_send(t: T) -> bool\n>    This method currently doesn't transmit back the data t if the send\n>    fails\n>    due to the other end having disconnected. Additionally, this shares\n>    the name\n>    of the synchronous try_send method, but it differs in semantics in\n>    that it\n>    only has one failure case, not two (the buffer can never be full).\n>    -\n> \n>    SyncSender::try_send(t: T) -> TrySendResult<T>\n>    This method accurately conveys all possible information, but it uses a\n>    custom type to the std::comm module with no convenience methods on it.\n>    Additionally, if you want to inspect the result you're forced to import\n>    something from std::comm.\n>    -\n> \n>    SyncSender::send_opt(t: T) -> Option<T>\n>    This method uses Some(T) as an \"error value\" and None as a \"success\n>    value\",\n>    but almost all other uses of Option have Some/None the other way\n>    -\n> \n>    Receiver::try_recv(t: T) -> TryRecvResult<T>\n>    Similarly to the synchronous try_send, this custom return type is\n>    lacking in\n>    terms of usability (no convenience methods).\n> \n> With this number of drawbacks in mind, I believed it was time to re-work\n> the\n> return types of these methods. The new API for the comm module is:\n> \n> Sender::send(t: T) -> ()\n> Sender::send_opt(t: T) -> Result<(), T>\n> SyncSender::send(t: T) -> ()\n> SyncSender::send_opt(t: T) -> Result<(), T>\n> SyncSender::try_send(t: T) -> Result<(), TrySendError<T>>\n> Receiver::recv() -> T\n> Receiver::recv_opt() -> Result<T, ()>\n> Receiver::try_recv() -> Result<T, TryRecvError>\n> \n> The notable changes made are:\n> \n>    -\n> \n>    Sender::try_send => Sender::send_opt. This renaming brings the\n>    semantics in\n>    line with the SyncSender::send_opt method. An asychronous send only\n>    has one\n>    failure case, unlike the synchronous try_send method which has two\n>    failure\n>    cases (full/disconnected).\n>    -\n> \n>    Sender::send_opt returns the data back to the caller if the send is\n>    guaranteed\n>    to fail. This method previously returned bool, but then it was unable\n>    to\n>    retrieve the data if the data was guaranteed to fail to send. There is\n>    still a\n>    race such that when Ok(()) is returned the data could still fail to be\n>    received, but that's inherent to an asynchronous channel.\n>    -\n> \n>    Result is now the basis of all return values. This not only adds lots\n>    of\n>    convenience methods to all return values for free, but it also means\n>    that you\n>    can inspect the return values with no extra imports (Ok/Err are in the\n>    prelude). Additionally, it's now self documenting when something\n>    failed or not\n>    because the return value has \"Err\" in the name.\n> \n> Things I'm a little uneasy about:\n> \n>    -\n> \n>    The methods send_opt and recv_opt are not returning options, but rather\n>    results. I felt more strongly that Option was the wrong return type\n>    than the\n>    _opt prefix was wrong, and I coudn't think of a much better name for\n>    these\n>    methods. One possible way to think about them is to read the _opt\n>    suffix as\n>    \"optionally\".\n>    -\n> \n>    Result is often better expressed as Option. This is only applicable\n>    to the recv_opt() method, but I thought it would be more consistent for\n>    everything to return Result rather than one method returning an Option.\n> \n> Despite my two reasons to feel uneasy, I feel much better about the\n> consistency\n> in return values at this point, and I think the only real open question is\n> if\n> there's a better suffix for {send,recv}_opt.\n> \n> ## Closes #11527 https://github.com/mozilla/rust/issues/11527\n> \n> You can merge this Pull Request by running\n> \n>   git pull https://github.com/alexcrichton/rust rework-chan-return-values\n> \n> Or view, comment on, or merge it at:\n> \n>   https://github.com/mozilla/rust/pull/13448\n> Commit Summary\n> - std: Make std::comm return types consistent\n> \n> File Changes\n> - _M_ src/libgreen/sched.rshttps://github.com/mozilla/rust/pull/13448/files#diff-0(7)\n> - _M_ src/libgreen/task.rshttps://github.com/mozilla/rust/pull/13448/files#diff-1(2)\n> - _M_ src/libnative/io/timer_other.rshttps://github.com/mozilla/rust/pull/13448/files#diff-2(9)\n> - _M_ src/libnative/io/timer_timerfd.rshttps://github.com/mozilla/rust/pull/13448/files#diff-3(9)\n> - _M_ src/libnative/io/timer_win32.rshttps://github.com/mozilla/rust/pull/13448/files#diff-4(9)\n> - _M_ src/libnative/task.rshttps://github.com/mozilla/rust/pull/13448/files#diff-5(2)\n> - _M_ src/librustuv/net.rshttps://github.com/mozilla/rust/pull/13448/files#diff-6(2)\n> - _M_ src/librustuv/signal.rshttps://github.com/mozilla/rust/pull/13448/files#diff-7(2)\n> - _M_ src/librustuv/timer.rshttps://github.com/mozilla/rust/pull/13448/files#diff-8(12)\n> - _M_ src/libstd/comm/mod.rshttps://github.com/mozilla/rust/pull/13448/files#diff-9(239)\n> - _M_ src/libstd/comm/oneshot.rshttps://github.com/mozilla/rust/pull/13448/files#diff-10(14)\n> - _M_ src/libstd/comm/select.rshttps://github.com/mozilla/rust/pull/13448/files#diff-11(18)\n> - _M_ src/libstd/comm/shared.rshttps://github.com/mozilla/rust/pull/13448/files#diff-12(8)\n> - _M_ src/libstd/comm/stream.rshttps://github.com/mozilla/rust/pull/13448/files#diff-13(24)\n> - _M_ src/libstd/comm/sync.rshttps://github.com/mozilla/rust/pull/13448/files#diff-14(18)\n> - _M_ src/libstd/io/comm_adapters.rshttps://github.com/mozilla/rust/pull/13448/files#diff-15(12)\n> - _M_ src/libstd/io/net/udp.rshttps://github.com/mozilla/rust/pull/13448/files#diff-16(4)\n> - _M_ src/libstd/io/signal.rshttps://github.com/mozilla/rust/pull/13448/files#diff-17(3)\n> - _M_ src/libstd/io/timer.rshttps://github.com/mozilla/rust/pull/13448/files#diff-18(22)\n> - _M_ src/libstd/rt/task.rshttps://github.com/mozilla/rust/pull/13448/files#diff-19(2)\n> - _M_ src/libsync/comm.rshttps://github.com/mozilla/rust/pull/13448/files#diff-20(8)\n> - _M_ src/libsync/lock.rshttps://github.com/mozilla/rust/pull/13448/files#diff-21(2)\n> - _M_ src/libsync/raw.rshttps://github.com/mozilla/rust/pull/13448/files#diff-22(11)\n> - _M_ src/test/bench/msgsend-pipes-shared.rshttps://github.com/mozilla/rust/pull/13448/files#diff-23(6)\n> - _M_ src/test/bench/msgsend-pipes.rshttps://github.com/mozilla/rust/pull/13448/files#diff-24(6)\n> - _M_ src/test/bench/task-perf-jargon-metal-smoke.rshttps://github.com/mozilla/rust/pull/13448/files#diff-25(2)\n> - _M_ src/test/run-pass/issue-9396.rshttps://github.com/mozilla/rust/pull/13448/files#diff-26(6)\n> \n> Patch Links:\n> - https://github.com/mozilla/rust/pull/13448.patch\n> - https://github.com/mozilla/rust/pull/13448.diff\n> \n> \u2014\n> Reply to this email directly or view it on GitHubhttps://github.com/mozilla/rust/pull/13448\n> .\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/40155322/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/40156471",
    "html_url": "https://github.com/rust-lang/rust/pull/13448#issuecomment-40156471",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/13448",
    "id": 40156471,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQwMTU2NDcx",
    "user": {
      "login": "brson",
      "id": 147214,
      "node_id": "MDQ6VXNlcjE0NzIxNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/brson",
      "html_url": "https://github.com/brson",
      "followers_url": "https://api.github.com/users/brson/followers",
      "following_url": "https://api.github.com/users/brson/following{/other_user}",
      "gists_url": "https://api.github.com/users/brson/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/brson/subscriptions",
      "organizations_url": "https://api.github.com/users/brson/orgs",
      "repos_url": "https://api.github.com/users/brson/repos",
      "events_url": "https://api.github.com/users/brson/events{/privacy}",
      "received_events_url": "https://api.github.com/users/brson/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-04-10T23:48:01Z",
    "updated_at": "2014-04-10T23:48:01Z",
    "body": "I'm pretty happy with this rationalization.\n\nIf we made `send_opt` the default send method then that forces every caller to check the result, which I've previously thought was too burdensome. For most protocols it's simply wrong for the receiver to just disappear so failing is a reasonable result.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/40156471/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/40270302",
    "html_url": "https://github.com/rust-lang/rust/pull/13448#issuecomment-40270302",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/13448",
    "id": 40270302,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQwMjcwMzAy",
    "user": {
      "login": "brson",
      "id": 147214,
      "node_id": "MDQ6VXNlcjE0NzIxNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/brson",
      "html_url": "https://github.com/brson",
      "followers_url": "https://api.github.com/users/brson/followers",
      "following_url": "https://api.github.com/users/brson/following{/other_user}",
      "gists_url": "https://api.github.com/users/brson/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/brson/subscriptions",
      "organizations_url": "https://api.github.com/users/brson/orgs",
      "repos_url": "https://api.github.com/users/brson/repos",
      "events_url": "https://api.github.com/users/brson/events{/privacy}",
      "received_events_url": "https://api.github.com/users/brson/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-04-12T03:13:49Z",
    "updated_at": "2014-04-12T03:13:49Z",
    "body": "I r+ed this despite @liigo's comments since I think this is a good improvement. The suggested improvements look contentious enough to me that we can follow up on those topics later.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/40270302/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/40270348",
    "html_url": "https://github.com/rust-lang/rust/pull/13448#issuecomment-40270348",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/13448",
    "id": 40270348,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQwMjcwMzQ4",
    "user": {
      "login": "brson",
      "id": 147214,
      "node_id": "MDQ6VXNlcjE0NzIxNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/brson",
      "html_url": "https://github.com/brson",
      "followers_url": "https://api.github.com/users/brson/followers",
      "following_url": "https://api.github.com/users/brson/following{/other_user}",
      "gists_url": "https://api.github.com/users/brson/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/brson/subscriptions",
      "organizations_url": "https://api.github.com/users/brson/orgs",
      "repos_url": "https://api.github.com/users/brson/repos",
      "events_url": "https://api.github.com/users/brson/events{/privacy}",
      "received_events_url": "https://api.github.com/users/brson/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-04-12T03:15:49Z",
    "updated_at": "2014-04-12T03:15:49Z",
    "body": "@liigo Although the `_r` isn't currently a convention it's an interesting idea that I may be slowly warming to. I wonder why this case hasn't come up before though, and I wonder how many `_opt` variants we have these days - it may not be many.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/40270348/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/40270978",
    "html_url": "https://github.com/rust-lang/rust/pull/13448#issuecomment-40270978",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/13448",
    "id": 40270978,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQwMjcwOTc4",
    "user": {
      "login": "huonw",
      "id": 1203825,
      "node_id": "MDQ6VXNlcjEyMDM4MjU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1203825?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/huonw",
      "html_url": "https://github.com/huonw",
      "followers_url": "https://api.github.com/users/huonw/followers",
      "following_url": "https://api.github.com/users/huonw/following{/other_user}",
      "gists_url": "https://api.github.com/users/huonw/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/huonw/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/huonw/subscriptions",
      "organizations_url": "https://api.github.com/users/huonw/orgs",
      "repos_url": "https://api.github.com/users/huonw/repos",
      "events_url": "https://api.github.com/users/huonw/events{/privacy}",
      "received_events_url": "https://api.github.com/users/huonw/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-04-12T03:54:59Z",
    "updated_at": "2014-04-12T03:54:59Z",
    "body": "One (weak) argument against `_r` is the meaning differs to the one in C, where it means \"reentrant\".\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/40270978/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/40297194",
    "html_url": "https://github.com/rust-lang/rust/pull/13448#issuecomment-40297194",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/13448",
    "id": 40297194,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQwMjk3MTk0",
    "user": {
      "login": "liigo",
      "id": 346530,
      "node_id": "MDQ6VXNlcjM0NjUzMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/346530?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/liigo",
      "html_url": "https://github.com/liigo",
      "followers_url": "https://api.github.com/users/liigo/followers",
      "following_url": "https://api.github.com/users/liigo/following{/other_user}",
      "gists_url": "https://api.github.com/users/liigo/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/liigo/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/liigo/subscriptions",
      "organizations_url": "https://api.github.com/users/liigo/orgs",
      "repos_url": "https://api.github.com/users/liigo/repos",
      "events_url": "https://api.github.com/users/liigo/events{/privacy}",
      "received_events_url": "https://api.github.com/users/liigo/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-04-13T01:37:27Z",
    "updated_at": "2014-04-13T01:40:01Z",
    "body": "I like @alexcrichton's this improvement too. But for `_opt` names, ...\nWe already have `Option`, `getopts::optopt`, `TaskOpts`, a little mix up.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/40297194/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
