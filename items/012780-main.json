{
  "url": "https://api.github.com/repos/rust-lang/rust/issues/12780",
  "repository_url": "https://api.github.com/repos/rust-lang/rust",
  "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/12780/labels{/name}",
  "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/12780/comments",
  "events_url": "https://api.github.com/repos/rust-lang/rust/issues/12780/events",
  "html_url": "https://github.com/rust-lang/rust/pull/12780",
  "id": 29038435,
  "node_id": "MDExOlB1bGxSZXF1ZXN0MTMzNDg4NTc=",
  "number": 12780,
  "title": "Added convenience methods to the Json class",
  "user": {
    "login": "zslayton",
    "id": 611616,
    "node_id": "MDQ6VXNlcjYxMTYxNg==",
    "avatar_url": "https://avatars.githubusercontent.com/u/611616?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/zslayton",
    "html_url": "https://github.com/zslayton",
    "followers_url": "https://api.github.com/users/zslayton/followers",
    "following_url": "https://api.github.com/users/zslayton/following{/other_user}",
    "gists_url": "https://api.github.com/users/zslayton/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/zslayton/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/zslayton/subscriptions",
    "organizations_url": "https://api.github.com/users/zslayton/orgs",
    "repos_url": "https://api.github.com/users/zslayton/repos",
    "events_url": "https://api.github.com/users/zslayton/events{/privacy}",
    "received_events_url": "https://api.github.com/users/zslayton/received_events",
    "type": "User",
    "user_view_type": "public",
    "site_admin": false
  },
  "labels": [],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [],
  "milestone": null,
  "comments": 9,
  "created_at": "2014-03-09T07:16:44Z",
  "updated_at": "2014-06-13T10:37:28Z",
  "closed_at": "2014-03-11T19:32:09Z",
  "author_association": "CONTRIBUTOR",
  "type": null,
  "active_lock_reason": null,
  "draft": false,
  "pull_request": {
    "url": "https://api.github.com/repos/rust-lang/rust/pulls/12780",
    "html_url": "https://github.com/rust-lang/rust/pull/12780",
    "diff_url": "https://github.com/rust-lang/rust/pull/12780.diff",
    "patch_url": "https://github.com/rust-lang/rust/pull/12780.patch",
    "merged_at": "2014-03-11T19:32:11Z"
  },
  "body": "This is my first non-docs contribution to Rust, so please let me know what I can fix. I probably should've submitted this to the mailing list first for comments, but it didn't take too long to implement so I figured I'd just give it a shot.\n\nThese changes are modeled loosely on the [JsonNode API](http://jackson.codehaus.org/1.7.9/javadoc/org/codehaus/jackson/JsonNode.html) provided by the [Jackson JSON processor](http://jackson.codehaus.org/).\n\nMany common use cases for parsing JSON involve pulling one or more fields out of an object, however deeply nested. At present, this requires writing a pyramid of match statements. The added methods in this PR aim to make this a more painless process.\n\n**Edited to reflect final implementation**\n\nExample JSON:\n\n``` json\n{\n    \"successful\" : true,\n    \"status\" : 200,\n    \"error\" : null,\n    \"content\" : {\n        \"vehicles\" : [\n            {\"make\" : \"Toyota\", \"model\" : \"Camry\", \"year\" : 1997},\n            {\"make\" : \"Honda\", \"model\" : \"Accord\", \"year\" : 2003}\n        ]\n    }\n}\n```\n\nAccessing \"successful\":\n\n``` rust\n let example_json : Json = from_str(\"...above json...\").unwrap();\n let was_successful: Option<bool> = example_json.find(&~\"successful\").and_then(|j| j.as_boolean());\n```\n\nAccessing \"status\":\n\n``` rust\n let example_json : Json = from_str(\"...above json...\").unwrap();\n let status_code : Option<f64> = example_json.find(&~\"status\").and_then(|j| j.as_number());\n```\n\nAccessing \"vehicles\":\n\n``` rust\n let example_json : Json = from_str(\"...above json...\").unwrap();\n let vehicle_list: Option<List> = example_json.search(&~\"vehicles\").and_then(|j| j.as_list());\n```\n\nAccessing \"vehicles\" with an explicit path:\n\n``` rust\n let example_json : Json = from_str(\"...above json...\").unwrap();\n let vehicle_list: Option<List> = example_json.find_path(&[&~\"content\", &~\"vehicles\"]).and_then(|j| j.as_list());\n```\n\nAccessing \"error\", which might be null or a string:\n\n``` rust\n let example_json : Json = from_str(\"...above json...\").unwrap();\n let error: Option<Json> = example_json.find(&~\"error\");\n if error.is_null() { // This would be nicer as a match, I'm just illustrating the boolean test methods\n    println!(\"Error is null, everything's fine.\");\n } else if error.is_str(){\n    println!(\"Something went wrong: {}\", error.as_string().unwrap());\n}\n```\n\nSome notes:\n- Macros would help to eliminate some of the repetitiveness of the implementation, but I couldn't use them due to #4621. (**Edit**: There is no longer repetitive impl. Methods were simplified to make them more composable.)\n- Would it be better to name methods after the Json enum type (e.g. `get_string`) or the associated Rust built-in? (e.g. `get_str`)\n- TreeMap requires its keys to be &~str. Because of this, all of the new methods required &~str for their parameters. I'm uncertain what the best approach to fixing this is: neither demanding an owned pointer nor allocating within the methods to appease TreeMap's find() seems desirable. If I were able to take &str, people could put together paths easily with `\"foo.bar.baz\".split('.').collect();` (**Edit**: Follow on investigation into making TreeMap able to search by Equiv would be worthwhile.)\n- At the moment, the `find_<sometype>` methods all find the first match for the provided key and attempt to return that value if it's of the specified type. This makes sense to me, but it's possible that users would interpret a call to `find_boolean(\"successful\")` as looking for the first \"successful\" item that was a boolean rather than looking for the first \"successful\" and returning None if it isn't boolean. (**Edit**: No longer relevant.)\n\nI hope this is helpful. Any feedback is appreciated! \n",
  "closed_by": {
    "login": "bors",
    "id": 3372342,
    "node_id": "MDQ6VXNlcjMzNzIzNDI=",
    "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/bors",
    "html_url": "https://github.com/bors",
    "followers_url": "https://api.github.com/users/bors/followers",
    "following_url": "https://api.github.com/users/bors/following{/other_user}",
    "gists_url": "https://api.github.com/users/bors/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/bors/subscriptions",
    "organizations_url": "https://api.github.com/users/bors/orgs",
    "repos_url": "https://api.github.com/users/bors/repos",
    "events_url": "https://api.github.com/users/bors/events{/privacy}",
    "received_events_url": "https://api.github.com/users/bors/received_events",
    "type": "User",
    "user_view_type": "public",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/12780/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/12780/timeline",
  "performed_via_github_app": null,
  "state_reason": null,
  "_meta": {
    "type": "pr"
  }
}
