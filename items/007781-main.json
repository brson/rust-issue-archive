{
  "url": "https://api.github.com/repos/rust-lang/rust/issues/7781",
  "repository_url": "https://api.github.com/repos/rust-lang/rust",
  "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/7781/labels{/name}",
  "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/7781/comments",
  "events_url": "https://api.github.com/repos/rust-lang/rust/issues/7781/events",
  "html_url": "https://github.com/rust-lang/rust/pull/7781",
  "id": 16721337,
  "node_id": "MDExOlB1bGxSZXF1ZXN0NjkxMTU3NA==",
  "number": 7781,
  "title": "Use concrete types in glue functions",
  "user": {
    "login": "dotdash",
    "id": 230962,
    "node_id": "MDQ6VXNlcjIzMDk2Mg==",
    "avatar_url": "https://avatars.githubusercontent.com/u/230962?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/dotdash",
    "html_url": "https://github.com/dotdash",
    "followers_url": "https://api.github.com/users/dotdash/followers",
    "following_url": "https://api.github.com/users/dotdash/following{/other_user}",
    "gists_url": "https://api.github.com/users/dotdash/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/dotdash/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/dotdash/subscriptions",
    "organizations_url": "https://api.github.com/users/dotdash/orgs",
    "repos_url": "https://api.github.com/users/dotdash/repos",
    "events_url": "https://api.github.com/users/dotdash/events{/privacy}",
    "received_events_url": "https://api.github.com/users/dotdash/received_events",
    "type": "User",
    "user_view_type": "public",
    "site_admin": false
  },
  "labels": [],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [],
  "milestone": null,
  "comments": 3,
  "created_at": "2013-07-13T23:24:54Z",
  "updated_at": "2014-07-17T07:36:38Z",
  "closed_at": "2013-07-14T14:34:22Z",
  "author_association": "CONTRIBUTOR",
  "type": null,
  "active_lock_reason": null,
  "draft": false,
  "pull_request": {
    "url": "https://api.github.com/repos/rust-lang/rust/pulls/7781",
    "html_url": "https://github.com/rust-lang/rust/pull/7781",
    "diff_url": "https://github.com/rust-lang/rust/pull/7781.diff",
    "patch_url": "https://github.com/rust-lang/rust/pull/7781.patch",
    "merged_at": "2013-07-14T14:34:24Z"
  },
  "body": "We used to have concrete types in glue functions, but the way we used\nto implement that broke inlining of those functions. To fix that, we\nconverted all glue to just take an i8\\* and always casted to that type.\n\nThe problem with the old implementation was that we made a wrong\nassumption about the glue functions, taking it for granted that they\nalways take an i8*, because that's the function type expected by the\nTyDesc fields. Therefore, we always ended up with some kind of cast.\n\nBut actually, we can initially have the glue with concrete types and\nonly cast the functions to the generic type once we actually emit the\nTyDesc data.\n\nThat means that for glue calls that can be statically resolved, we don't\nneed any casts, unless the glue uses a simplified type. In that case we\ncast the argument. And for glue calls that are resolved at runtime, we\ncast the argument to i8*, because that's what the glue function in the\nTyDesc expects.\n\nSince most of out glue calls are static, this saves a lot of bitcasts.\nThe size of the unoptimized librustc.ll goes down by 240k lines.\n",
  "closed_by": {
    "login": "bors",
    "id": 3372342,
    "node_id": "MDQ6VXNlcjMzNzIzNDI=",
    "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/bors",
    "html_url": "https://github.com/bors",
    "followers_url": "https://api.github.com/users/bors/followers",
    "following_url": "https://api.github.com/users/bors/following{/other_user}",
    "gists_url": "https://api.github.com/users/bors/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/bors/subscriptions",
    "organizations_url": "https://api.github.com/users/bors/orgs",
    "repos_url": "https://api.github.com/users/bors/repos",
    "events_url": "https://api.github.com/users/bors/events{/privacy}",
    "received_events_url": "https://api.github.com/users/bors/received_events",
    "type": "User",
    "user_view_type": "public",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/7781/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/7781/timeline",
  "performed_via_github_app": null,
  "state_reason": null,
  "_meta": {
    "type": "pr"
  }
}
