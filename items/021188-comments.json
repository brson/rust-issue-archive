[
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/70242587",
    "html_url": "https://github.com/rust-lang/rust/issues/21188#issuecomment-70242587",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/21188",
    "id": 70242587,
    "node_id": "MDEyOklzc3VlQ29tbWVudDcwMjQyNTg3",
    "user": {
      "login": "AndyShiue",
      "id": 7116637,
      "node_id": "MDQ6VXNlcjcxMTY2Mzc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7116637?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AndyShiue",
      "html_url": "https://github.com/AndyShiue",
      "followers_url": "https://api.github.com/users/AndyShiue/followers",
      "following_url": "https://api.github.com/users/AndyShiue/following{/other_user}",
      "gists_url": "https://api.github.com/users/AndyShiue/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AndyShiue/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AndyShiue/subscriptions",
      "organizations_url": "https://api.github.com/users/AndyShiue/orgs",
      "repos_url": "https://api.github.com/users/AndyShiue/repos",
      "events_url": "https://api.github.com/users/AndyShiue/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AndyShiue/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-01-16T11:42:43Z",
    "updated_at": "2015-01-16T11:47:21Z",
    "body": "I think `#[derive(Copy)]` for your `Point` solves the first problem?\n",
    "author_association": "NONE",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/70242587/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/70242928",
    "html_url": "https://github.com/rust-lang/rust/issues/21188#issuecomment-70242928",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/21188",
    "id": 70242928,
    "node_id": "MDEyOklzc3VlQ29tbWVudDcwMjQyOTI4",
    "user": {
      "login": "AndyShiue",
      "id": 7116637,
      "node_id": "MDQ6VXNlcjcxMTY2Mzc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7116637?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AndyShiue",
      "html_url": "https://github.com/AndyShiue",
      "followers_url": "https://api.github.com/users/AndyShiue/followers",
      "following_url": "https://api.github.com/users/AndyShiue/following{/other_user}",
      "gists_url": "https://api.github.com/users/AndyShiue/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AndyShiue/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AndyShiue/subscriptions",
      "organizations_url": "https://api.github.com/users/AndyShiue/orgs",
      "repos_url": "https://api.github.com/users/AndyShiue/repos",
      "events_url": "https://api.github.com/users/AndyShiue/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AndyShiue/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-01-16T11:46:25Z",
    "updated_at": "2015-01-16T11:47:59Z",
    "body": "And it's impossible to implement both `Point + f32` and `f32 + Point` right now, see #20749\n",
    "author_association": "NONE",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/70242928/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/70294414",
    "html_url": "https://github.com/rust-lang/rust/issues/21188#issuecomment-70294414",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/21188",
    "id": 70294414,
    "node_id": "MDEyOklzc3VlQ29tbWVudDcwMjk0NDE0",
    "user": {
      "login": "SirVer",
      "id": 140115,
      "node_id": "MDQ6VXNlcjE0MDExNQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/140115?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/SirVer",
      "html_url": "https://github.com/SirVer",
      "followers_url": "https://api.github.com/users/SirVer/followers",
      "following_url": "https://api.github.com/users/SirVer/following{/other_user}",
      "gists_url": "https://api.github.com/users/SirVer/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/SirVer/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/SirVer/subscriptions",
      "organizations_url": "https://api.github.com/users/SirVer/orgs",
      "repos_url": "https://api.github.com/users/SirVer/repos",
      "events_url": "https://api.github.com/users/SirVer/events{/privacy}",
      "received_events_url": "https://api.github.com/users/SirVer/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-01-16T18:01:46Z",
    "updated_at": "2015-01-16T18:01:46Z",
    "body": "> I think #[derive(Copy)] for your Point solves the first problem?\n\nYes. But this is just an example - what about something that is expensive to clone, like a `Mat100x100`. But I think I just found the answer in the bigint implementation: http://doc.rust-lang.org/num/src/num/bigint.rs.html#234\n\nYou just have to implement all combinations of `&ref` and `value`.. uhh.\n\nAnd I did still not figure out how you can define an overloaded operator for the RHS, i.e. `f32 + Point` yet. I read #20749 that it is just not possible???\n",
    "author_association": "NONE",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/70294414/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/70922560",
    "html_url": "https://github.com/rust-lang/rust/issues/21188#issuecomment-70922560",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/21188",
    "id": 70922560,
    "node_id": "MDEyOklzc3VlQ29tbWVudDcwOTIyNTYw",
    "user": {
      "login": "Gankra",
      "id": 1136864,
      "node_id": "MDQ6VXNlcjExMzY4NjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1136864?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Gankra",
      "html_url": "https://github.com/Gankra",
      "followers_url": "https://api.github.com/users/Gankra/followers",
      "following_url": "https://api.github.com/users/Gankra/following{/other_user}",
      "gists_url": "https://api.github.com/users/Gankra/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Gankra/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Gankra/subscriptions",
      "organizations_url": "https://api.github.com/users/Gankra/orgs",
      "repos_url": "https://api.github.com/users/Gankra/repos",
      "events_url": "https://api.github.com/users/Gankra/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Gankra/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-01-21T21:12:06Z",
    "updated_at": "2015-01-21T21:12:06Z",
    "body": "CC @aturon \n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/70922560/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/72780136",
    "html_url": "https://github.com/rust-lang/rust/issues/21188#issuecomment-72780136",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/21188",
    "id": 72780136,
    "node_id": "MDEyOklzc3VlQ29tbWVudDcyNzgwMTM2",
    "user": {
      "login": "sellibitze",
      "id": 290865,
      "node_id": "MDQ6VXNlcjI5MDg2NQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/290865?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sellibitze",
      "html_url": "https://github.com/sellibitze",
      "followers_url": "https://api.github.com/users/sellibitze/followers",
      "following_url": "https://api.github.com/users/sellibitze/following{/other_user}",
      "gists_url": "https://api.github.com/users/sellibitze/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sellibitze/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sellibitze/subscriptions",
      "organizations_url": "https://api.github.com/users/sellibitze/orgs",
      "repos_url": "https://api.github.com/users/sellibitze/repos",
      "events_url": "https://api.github.com/users/sellibitze/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sellibitze/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-02-04T02:40:05Z",
    "updated_at": "2015-02-04T02:44:48Z",
    "body": "The code\n\n``` rust\na + b + b + a\n```\n\nis equivalent to\n\n``` rust\n((a + b) + b) + a\n```\n\nwhere the inner `a+b` is of type `Point` and `b` is of type `&Point`. So, there are different ways of solving this. Option 1:\n\n``` rust\n&(&(a + b) + b) + a\n```\n\nThis option is not really desirable in my opinion. Option 2 would be to add at least another implementation:\n\n``` rust\nimpl<'a> Add<&'a Point> for Point { \u2026 }\n```\n\n(and possibly the other way around for symmetry).\n\nProviding all these impls is a bit of pain in the butt. But I think macros can mitigate this to some extend. For example, we could try to standardize a macro for `Copy`able arithmetic types which automatically implement operators on references in terms of their value variant. I already did this in libcore/ops.rs. These macros are just not exposed as part of the public interface. Another macro that might be useful is to implement the value variants in terms of the implementations for references. This should be usedful for non-`Copy`able and more complicated types.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/72780136/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/74566030",
    "html_url": "https://github.com/rust-lang/rust/issues/21188#issuecomment-74566030",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/21188",
    "id": 74566030,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc0NTY2MDMw",
    "user": {
      "login": "aturon",
      "id": 709807,
      "node_id": "MDQ6VXNlcjcwOTgwNw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/709807?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/aturon",
      "html_url": "https://github.com/aturon",
      "followers_url": "https://api.github.com/users/aturon/followers",
      "following_url": "https://api.github.com/users/aturon/following{/other_user}",
      "gists_url": "https://api.github.com/users/aturon/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/aturon/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/aturon/subscriptions",
      "organizations_url": "https://api.github.com/users/aturon/orgs",
      "repos_url": "https://api.github.com/users/aturon/repos",
      "events_url": "https://api.github.com/users/aturon/events{/privacy}",
      "received_events_url": "https://api.github.com/users/aturon/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-02-16T20:14:59Z",
    "updated_at": "2015-02-16T20:14:59Z",
    "body": "@nikomatsakis and I have been talking about ways to address this sort of thing by allowing you to write just the by-ref implementations of the operators and having the compiler automatically insert `&` for the operands in that case (as the traits used to do). Stay tuned for an RFC!\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/74566030/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/169908701",
    "html_url": "https://github.com/rust-lang/rust/issues/21188#issuecomment-169908701",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/21188",
    "id": 169908701,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE2OTkwODcwMQ==",
    "user": {
      "login": "huonw",
      "id": 1203825,
      "node_id": "MDQ6VXNlcjEyMDM4MjU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1203825?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/huonw",
      "html_url": "https://github.com/huonw",
      "followers_url": "https://api.github.com/users/huonw/followers",
      "following_url": "https://api.github.com/users/huonw/following{/other_user}",
      "gists_url": "https://api.github.com/users/huonw/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/huonw/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/huonw/subscriptions",
      "organizations_url": "https://api.github.com/users/huonw/orgs",
      "repos_url": "https://api.github.com/users/huonw/repos",
      "events_url": "https://api.github.com/users/huonw/events{/privacy}",
      "received_events_url": "https://api.github.com/users/huonw/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2016-01-08T06:21:07Z",
    "updated_at": "2016-01-08T06:21:07Z",
    "body": "I think the scheme we've settled on here is to implement the operator traits for the 4  referenced/non-referenced combinations, i.e.\n\n``` rust\nimpl Add<Point> for Point { ... }\nimpl<'a> Add<Point> for &'a Point { ... }\nimpl<'a> Add<&'a Point> for Point { ... }\nimpl<'a> Add<&'a Point> for &'a Point { ... }\n```\n\nThis is somewhat annoying, but for a simple/cheap type like `Point` 3 of those can just call the fourth (i.e. only one non-trivial implementation is needed). On the other hand, fancier types (e.g. big integers) are often be able to optimise certain combinations to, e.g., avoid copies and reuse allocations, meaning they'll _want_ to write out all the combinations anyway.\n\nI'm inclined to close this, despite us not having the auto-ref idea @aturon mentions, that is, one has to write something like `&a + &b + &b + &a` even with the `impl`s I write above. That said, it seems the auto-ref would have to be pretty magical to handle a case like `a + b + b + a` without just falling back to the ref'd `impl` always (which would be a non-trivial perf hit for, e.g., big integers).\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/169908701/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/169911560",
    "html_url": "https://github.com/rust-lang/rust/issues/21188#issuecomment-169911560",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/21188",
    "id": 169911560,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE2OTkxMTU2MA==",
    "user": {
      "login": "aturon",
      "id": 709807,
      "node_id": "MDQ6VXNlcjcwOTgwNw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/709807?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/aturon",
      "html_url": "https://github.com/aturon",
      "followers_url": "https://api.github.com/users/aturon/followers",
      "following_url": "https://api.github.com/users/aturon/following{/other_user}",
      "gists_url": "https://api.github.com/users/aturon/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/aturon/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/aturon/subscriptions",
      "organizations_url": "https://api.github.com/users/aturon/orgs",
      "repos_url": "https://api.github.com/users/aturon/repos",
      "events_url": "https://api.github.com/users/aturon/events{/privacy}",
      "received_events_url": "https://api.github.com/users/aturon/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2016-01-08T06:50:10Z",
    "updated_at": "2016-01-08T06:50:10Z",
    "body": "@huonw I have no objection to closing on that basis. I'd still love to have some for of auto-ref, but it's an RFC concern at this point.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/169911560/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
