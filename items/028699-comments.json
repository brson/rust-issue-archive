[
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/143599233",
    "html_url": "https://github.com/rust-lang/rust/issues/28699#issuecomment-143599233",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28699",
    "id": 143599233,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE0MzU5OTIzMw==",
    "user": {
      "login": "bstrie",
      "id": 865233,
      "node_id": "MDQ6VXNlcjg2NTIzMw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/865233?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/bstrie",
      "html_url": "https://github.com/bstrie",
      "followers_url": "https://api.github.com/users/bstrie/followers",
      "following_url": "https://api.github.com/users/bstrie/following{/other_user}",
      "gists_url": "https://api.github.com/users/bstrie/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/bstrie/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/bstrie/subscriptions",
      "organizations_url": "https://api.github.com/users/bstrie/orgs",
      "repos_url": "https://api.github.com/users/bstrie/repos",
      "events_url": "https://api.github.com/users/bstrie/events{/privacy}",
      "received_events_url": "https://api.github.com/users/bstrie/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-09-27T22:38:32Z",
    "updated_at": "2015-09-27T22:38:32Z",
    "body": "Note that we tried a few variations of the test case. Reassigning test as in `test = Vec::new();` has no effect, nor does inserting heap-touching code after the inner scope.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/143599233/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/143600586",
    "html_url": "https://github.com/rust-lang/rust/issues/28699#issuecomment-143600586",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28699",
    "id": 143600586,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE0MzYwMDU4Ng==",
    "user": {
      "login": "bluss",
      "id": 3209739,
      "node_id": "MDQ6VXNlcjMyMDk3Mzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3209739?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/bluss",
      "html_url": "https://github.com/bluss",
      "followers_url": "https://api.github.com/users/bluss/followers",
      "following_url": "https://api.github.com/users/bluss/following{/other_user}",
      "gists_url": "https://api.github.com/users/bluss/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/bluss/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/bluss/subscriptions",
      "organizations_url": "https://api.github.com/users/bluss/orgs",
      "repos_url": "https://api.github.com/users/bluss/repos",
      "events_url": "https://api.github.com/users/bluss/events{/privacy}",
      "received_events_url": "https://api.github.com/users/bluss/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-09-27T23:00:39Z",
    "updated_at": "2015-09-27T23:00:39Z",
    "body": "jemalloc is tunable, so we could just see if there is something we can change. It seems a non-trivial application could find better settings for itself. This seems related to #18236 too.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/143600586/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/143601866",
    "html_url": "https://github.com/rust-lang/rust/issues/28699#issuecomment-143601866",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28699",
    "id": 143601866,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE0MzYwMTg2Ng==",
    "user": {
      "login": "Stebalien",
      "id": 310393,
      "node_id": "MDQ6VXNlcjMxMDM5Mw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/310393?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Stebalien",
      "html_url": "https://github.com/Stebalien",
      "followers_url": "https://api.github.com/users/Stebalien/followers",
      "following_url": "https://api.github.com/users/Stebalien/following{/other_user}",
      "gists_url": "https://api.github.com/users/Stebalien/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Stebalien/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Stebalien/subscriptions",
      "organizations_url": "https://api.github.com/users/Stebalien/orgs",
      "repos_url": "https://api.github.com/users/Stebalien/repos",
      "events_url": "https://api.github.com/users/Stebalien/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Stebalien/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-09-27T23:08:02Z",
    "updated_at": "2015-09-27T23:08:02Z",
    "body": "What if you touch the heap inside the loop? The comment under `thread.tcache.flush` on the jemalloc man page may be relevant (but I know next to nothing about allocators):\n\n> Flush calling thread's tcache. This interface releases all cached objects and internal data structures associated with the calling thread's thread-specific cache. Ordinarily, this interface need not be called, since automatic periodic incremental garbage collection occurs, and the thread cache is automatically discarded when a thread exits. However, garbage collection is triggered by allocation activity, so it is possible for a thread that stops allocating/deallocating to retain its cache indefinitely, in which case the developer may find manual flushing useful.\n\n-- http://linux.die.net/man/3/jemalloc\n\nHowever, I can't confirm this (x86_64, linux 4.1.7, nightly). I can't run the test at full capacity (I don't have enough RAM) but I can run it at half capacity and the memory usage spikes but then drops to 6MB instantly.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/143601866/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/143957512",
    "html_url": "https://github.com/rust-lang/rust/issues/28699#issuecomment-143957512",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28699",
    "id": 143957512,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE0Mzk1NzUxMg==",
    "user": {
      "login": "Aatch",
      "id": 342416,
      "node_id": "MDQ6VXNlcjM0MjQxNg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/342416?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Aatch",
      "html_url": "https://github.com/Aatch",
      "followers_url": "https://api.github.com/users/Aatch/followers",
      "following_url": "https://api.github.com/users/Aatch/following{/other_user}",
      "gists_url": "https://api.github.com/users/Aatch/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Aatch/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Aatch/subscriptions",
      "organizations_url": "https://api.github.com/users/Aatch/orgs",
      "repos_url": "https://api.github.com/users/Aatch/repos",
      "events_url": "https://api.github.com/users/Aatch/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Aatch/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-09-29T06:23:33Z",
    "updated_at": "2015-09-29T06:23:33Z",
    "body": "Looks like that is the issue. Maybe a general `flush` API that can be a no-op in most other cases would be good here? It's pretty niche, as it would require the application to allocate a significant amount of memory then basically stop using the heap completely after that.\n\nIt should be pointed out that this is very unlikely to be a problem in most programs, given the requirement that allocation/deallocation has to basically stop completely.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/143957512/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/145990553",
    "html_url": "https://github.com/rust-lang/rust/issues/28699#issuecomment-145990553",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28699",
    "id": 145990553,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE0NTk5MDU1Mw==",
    "user": {
      "login": "antoyo",
      "id": 584972,
      "node_id": "MDQ6VXNlcjU4NDk3Mg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/584972?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/antoyo",
      "html_url": "https://github.com/antoyo",
      "followers_url": "https://api.github.com/users/antoyo/followers",
      "following_url": "https://api.github.com/users/antoyo/following{/other_user}",
      "gists_url": "https://api.github.com/users/antoyo/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/antoyo/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/antoyo/subscriptions",
      "organizations_url": "https://api.github.com/users/antoyo/orgs",
      "repos_url": "https://api.github.com/users/antoyo/repos",
      "events_url": "https://api.github.com/users/antoyo/events{/privacy}",
      "received_events_url": "https://api.github.com/users/antoyo/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-10-06T20:29:16Z",
    "updated_at": "2015-10-06T20:30:15Z",
    "body": "I wonder if this is related to [my observation of Rust programs using more memory than OCaml, Haskell, and C version of an equivalent program](http://stackoverflow.com/questions/32762102/why-do-rust-programs-use-so-much-more-memory-than-the-c-haskell-and-ocaml-versi).\n\nIn my case, there is not much memory allocation. Is this the same as this issue?\n\nI've uploaded `massif` output to show where the memory allocation happens (see in the StackOverflow question, Update 3).\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/145990553/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/285115149",
    "html_url": "https://github.com/rust-lang/rust/issues/28699#issuecomment-285115149",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28699",
    "id": 285115149,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI4NTExNTE0OQ==",
    "user": {
      "login": "steveklabnik",
      "id": 27786,
      "node_id": "MDQ6VXNlcjI3Nzg2",
      "avatar_url": "https://avatars.githubusercontent.com/u/27786?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/steveklabnik",
      "html_url": "https://github.com/steveklabnik",
      "followers_url": "https://api.github.com/users/steveklabnik/followers",
      "following_url": "https://api.github.com/users/steveklabnik/following{/other_user}",
      "gists_url": "https://api.github.com/users/steveklabnik/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/steveklabnik/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/steveklabnik/subscriptions",
      "organizations_url": "https://api.github.com/users/steveklabnik/orgs",
      "repos_url": "https://api.github.com/users/steveklabnik/repos",
      "events_url": "https://api.github.com/users/steveklabnik/events{/privacy}",
      "received_events_url": "https://api.github.com/users/steveklabnik/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2017-03-08T17:51:23Z",
    "updated_at": "2017-03-08T17:51:23Z",
    "body": "Triage: no comments in almost 18 months. While this does seem like a theoretical problem, it doesn't seem like many people are having it, and allocators' apis still aren't stable. Anyone interested in furthering this issue should probably chime in on the allocator discussion. Closing!",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/285115149/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/285141002",
    "html_url": "https://github.com/rust-lang/rust/issues/28699#issuecomment-285141002",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28699",
    "id": 285141002,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI4NTE0MTAwMg==",
    "user": {
      "login": "jonas-schievink",
      "id": 1786438,
      "node_id": "MDQ6VXNlcjE3ODY0Mzg=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1786438?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonas-schievink",
      "html_url": "https://github.com/jonas-schievink",
      "followers_url": "https://api.github.com/users/jonas-schievink/followers",
      "following_url": "https://api.github.com/users/jonas-schievink/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonas-schievink/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonas-schievink/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonas-schievink/subscriptions",
      "organizations_url": "https://api.github.com/users/jonas-schievink/orgs",
      "repos_url": "https://api.github.com/users/jonas-schievink/repos",
      "events_url": "https://api.github.com/users/jonas-schievink/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonas-schievink/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2017-03-08T19:22:59Z",
    "updated_at": "2017-03-08T19:22:59Z",
    "body": "I was having this issue in practice here: https://github.com/rust-lang/rust/issues/33082#issuecomment-279812899",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/285141002/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
