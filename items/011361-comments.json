[
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/109819921",
    "html_url": "https://github.com/rust-lang/rust/issues/11361#issuecomment-109819921",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/11361",
    "id": 109819921,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEwOTgxOTkyMQ==",
    "user": {
      "login": "eefriedman",
      "id": 12769964,
      "node_id": "MDQ6VXNlcjEyNzY5OTY0",
      "avatar_url": "https://avatars.githubusercontent.com/u/12769964?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/eefriedman",
      "html_url": "https://github.com/eefriedman",
      "followers_url": "https://api.github.com/users/eefriedman/followers",
      "following_url": "https://api.github.com/users/eefriedman/following{/other_user}",
      "gists_url": "https://api.github.com/users/eefriedman/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/eefriedman/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/eefriedman/subscriptions",
      "organizations_url": "https://api.github.com/users/eefriedman/orgs",
      "repos_url": "https://api.github.com/users/eefriedman/repos",
      "events_url": "https://api.github.com/users/eefriedman/events{/privacy}",
      "received_events_url": "https://api.github.com/users/eefriedman/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-06-08T01:09:48Z",
    "updated_at": "2015-06-08T01:09:48Z",
    "body": "It is possible to do something like the following in safe Rust:\n\n``` rust\n#![feature(collections)]\nfn main() {\n    let mut line = [0u8; 512];\n    {\n        let mut buf = &mut line[..];\n\n        /// reslice is essentially equivalent to `*buf = &mut buf[len..];`.\n        fn reslice(buf: &mut &mut [u8], len: usize) {\n            let tmp = std::mem::replace(buf, &mut []);\n            std::mem::replace(buf, &mut tmp[len..]);\n        }\n        fn append(buf: &mut &mut [u8], v: &[u8]) {\n            let len = buf.clone_from_slice(v);\n            reslice(buf, len);\n        }\n\n        append(&mut buf, b\"test\");\n        append(&mut buf, b\"foo\");\n    }\n    assert_eq!(&line[..7], b\"testfoo\");\n}\n```\n\nThe error message you get if you try to write `*buf = &mut buf[len..];` is still terrible:\n\n```\n<anon>:10:25: 10:35 error: cannot infer an appropriate lifetime for lifetime parameter 'a in function call due to conflicting requirements\n<anon>:10             *buf = &mut buf[len..];\n                                  ^~~~~~~~~~\n<anon>:9:9: 11:10 help: consider using an explicit lifetime parameter as shown: fn reslice<'a>(buf: &'a mut &'a mut [u8], len: usize)\n<anon>:9         fn reslice(buf: &mut &mut [u8], len: usize) {\n<anon>:10             *buf = &mut buf[len..];\n<anon>:11         }\nerror: aborting due to previous error\n```\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/109819921/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/270178213",
    "html_url": "https://github.com/rust-lang/rust/issues/11361#issuecomment-270178213",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/11361",
    "id": 270178213,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3MDE3ODIxMw==",
    "user": {
      "login": "steveklabnik",
      "id": 27786,
      "node_id": "MDQ6VXNlcjI3Nzg2",
      "avatar_url": "https://avatars.githubusercontent.com/u/27786?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/steveklabnik",
      "html_url": "https://github.com/steveklabnik",
      "followers_url": "https://api.github.com/users/steveklabnik/followers",
      "following_url": "https://api.github.com/users/steveklabnik/following{/other_user}",
      "gists_url": "https://api.github.com/users/steveklabnik/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/steveklabnik/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/steveklabnik/subscriptions",
      "organizations_url": "https://api.github.com/users/steveklabnik/orgs",
      "repos_url": "https://api.github.com/users/steveklabnik/repos",
      "events_url": "https://api.github.com/users/steveklabnik/events{/privacy}",
      "received_events_url": "https://api.github.com/users/steveklabnik/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2017-01-03T17:57:46Z",
    "updated_at": "2017-01-03T17:57:46Z",
    "body": "With a slight modification to @eefriedman 's example (`clone_from_slice` no longer returns its length), the example compiles, but panics with different length-d slices.\r\n\r\nWhen trying to do the `*buf` version, you still do get that bad error message.",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/270178213/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/310917641",
    "html_url": "https://github.com/rust-lang/rust/issues/11361#issuecomment-310917641",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/11361",
    "id": 310917641,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMxMDkxNzY0MQ==",
    "user": {
      "login": "Mark-Simulacrum",
      "id": 5047365,
      "node_id": "MDQ6VXNlcjUwNDczNjU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5047365?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Mark-Simulacrum",
      "html_url": "https://github.com/Mark-Simulacrum",
      "followers_url": "https://api.github.com/users/Mark-Simulacrum/followers",
      "following_url": "https://api.github.com/users/Mark-Simulacrum/following{/other_user}",
      "gists_url": "https://api.github.com/users/Mark-Simulacrum/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Mark-Simulacrum/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Mark-Simulacrum/subscriptions",
      "organizations_url": "https://api.github.com/users/Mark-Simulacrum/orgs",
      "repos_url": "https://api.github.com/users/Mark-Simulacrum/repos",
      "events_url": "https://api.github.com/users/Mark-Simulacrum/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Mark-Simulacrum/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2017-06-25T17:56:47Z",
    "updated_at": "2017-06-25T17:56:47Z",
    "body": "This issue boils down to the following, I think.\r\n\r\n```rust\r\nfn append(buf: &mut &mut [u8]) {\r\n    *buf = &mut buf[..];\r\n}\r\n```",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/310917641/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/315799649",
    "html_url": "https://github.com/rust-lang/rust/issues/11361#issuecomment-315799649",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/11361",
    "id": 315799649,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMxNTc5OTY0OQ==",
    "user": {
      "login": "nikomatsakis",
      "id": 155238,
      "node_id": "MDQ6VXNlcjE1NTIzOA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/155238?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nikomatsakis",
      "html_url": "https://github.com/nikomatsakis",
      "followers_url": "https://api.github.com/users/nikomatsakis/followers",
      "following_url": "https://api.github.com/users/nikomatsakis/following{/other_user}",
      "gists_url": "https://api.github.com/users/nikomatsakis/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nikomatsakis/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nikomatsakis/subscriptions",
      "organizations_url": "https://api.github.com/users/nikomatsakis/orgs",
      "repos_url": "https://api.github.com/users/nikomatsakis/repos",
      "events_url": "https://api.github.com/users/nikomatsakis/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nikomatsakis/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2017-07-17T16:06:03Z",
    "updated_at": "2017-07-17T16:06:03Z",
    "body": "OK, so, it's only been like 3 years since the initial issue report. Sheesh. Let me explain a bit what is going on. I don't see an obvious fix at the moment.\r\n\r\nFirst off, it's worth noting that while the original code does not compile, this variant (which uses a shared slice inside) does:\r\n\r\n```\r\nfn append(buf: &mut &[u8]) {\r\n    *buf = &buf[..];\r\n}\r\n```\r\n\r\nThe reason for this is explained in my [NLL-RFC draft](https://github.com/nikomatsakis/nll-rfc/), in particular when discussing [Reborrow constraints](https://github.com/nikomatsakis/nll-rfc/blob/master/0000-nonlexical-lifetimes.md#reborrow-constraints) and the notion of supporting prefixes. \r\n\r\nWhen we do `&mut (**buf)[..]` (fully expanded), this is reborrowing the `&mut [u8]` slice **found within another `&mut` reference**. When you borrow a mutable reference from within another, you can only borrow for the lifetime of the **outermost** reference (which must be shorter than the others); otherwise, you can introduce unsoundness where the outermost loan ends, but your reborrow is still permitted, permitting access from multiple paths. In the original program, the signature is (expanded) `&'a mut &'b mut [u8]`, where `'b: 'a`, and hence we can only reborrow for `'a` at most, but we would need to borrow for `'b`. \r\n\r\nIf we adjust to `<'a> &'a mut &'a mut [u8]`, we get a different error. **That** error arises because of the fact that `&mut buf[..]` introduces some temporaries. This error **might** be fixed by the rules proposed in the NLL RFC; I have to look at the desugaring, and I don't have time to go into that just now.",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/315799649/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/424047973",
    "html_url": "https://github.com/rust-lang/rust/issues/11361#issuecomment-424047973",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/11361",
    "id": 424047973,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQyNDA0Nzk3Mw==",
    "user": {
      "login": "steveklabnik",
      "id": 27786,
      "node_id": "MDQ6VXNlcjI3Nzg2",
      "avatar_url": "https://avatars.githubusercontent.com/u/27786?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/steveklabnik",
      "html_url": "https://github.com/steveklabnik",
      "followers_url": "https://api.github.com/users/steveklabnik/followers",
      "following_url": "https://api.github.com/users/steveklabnik/following{/other_user}",
      "gists_url": "https://api.github.com/users/steveklabnik/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/steveklabnik/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/steveklabnik/subscriptions",
      "organizations_url": "https://api.github.com/users/steveklabnik/orgs",
      "repos_url": "https://api.github.com/users/steveklabnik/repos",
      "events_url": "https://api.github.com/users/steveklabnik/events{/privacy}",
      "received_events_url": "https://api.github.com/users/steveklabnik/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2018-09-24T16:57:56Z",
    "updated_at": "2018-09-24T16:57:56Z",
    "body": "Triage: NLL does not fix this.",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/424047973/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/1904070918",
    "html_url": "https://github.com/rust-lang/rust/issues/11361#issuecomment-1904070918",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/11361",
    "id": 1904070918,
    "node_id": "IC_kwDOAAsO6M5xfdEG",
    "user": {
      "login": "alecmocatta",
      "id": 1136246,
      "node_id": "MDQ6VXNlcjExMzYyNDY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1136246?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alecmocatta",
      "html_url": "https://github.com/alecmocatta",
      "followers_url": "https://api.github.com/users/alecmocatta/followers",
      "following_url": "https://api.github.com/users/alecmocatta/following{/other_user}",
      "gists_url": "https://api.github.com/users/alecmocatta/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alecmocatta/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alecmocatta/subscriptions",
      "organizations_url": "https://api.github.com/users/alecmocatta/orgs",
      "repos_url": "https://api.github.com/users/alecmocatta/repos",
      "events_url": "https://api.github.com/users/alecmocatta/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alecmocatta/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2024-01-22T14:03:56Z",
    "updated_at": "2024-01-22T14:03:56Z",
    "body": "Issue incorrectly auto-closed. A commit in the subtree update of rust-analyzer \"Fixes https://github.com/rust-lang/rust-analyzer/issues/11361\" but GitHub misinterpreted it as this issue https://github.com/rust-lang/rust/issues/11361.",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/1904070918/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/2076325719",
    "html_url": "https://github.com/rust-lang/rust/issues/11361#issuecomment-2076325719",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/11361",
    "id": 2076325719,
    "node_id": "IC_kwDOAAsO6M57wjdX",
    "user": {
      "login": "Rudxain",
      "id": 76864299,
      "node_id": "MDQ6VXNlcjc2ODY0Mjk5",
      "avatar_url": "https://avatars.githubusercontent.com/u/76864299?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Rudxain",
      "html_url": "https://github.com/Rudxain",
      "followers_url": "https://api.github.com/users/Rudxain/followers",
      "following_url": "https://api.github.com/users/Rudxain/following{/other_user}",
      "gists_url": "https://api.github.com/users/Rudxain/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Rudxain/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Rudxain/subscriptions",
      "organizations_url": "https://api.github.com/users/Rudxain/orgs",
      "repos_url": "https://api.github.com/users/Rudxain/repos",
      "events_url": "https://api.github.com/users/Rudxain/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Rudxain/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2024-04-25T04:12:40Z",
    "updated_at": "2024-04-25T04:12:40Z",
    "body": "Is [this](https://github.com/dtolnay/rust-quiz/issues/83#issuecomment-2076295462) related?",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/2076325719/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
