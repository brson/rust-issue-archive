{
  "url": "https://api.github.com/repos/rust-lang/rust/issues/13448",
  "repository_url": "https://api.github.com/repos/rust-lang/rust",
  "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/13448/labels{/name}",
  "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/13448/comments",
  "events_url": "https://api.github.com/repos/rust-lang/rust/issues/13448/events",
  "html_url": "https://github.com/rust-lang/rust/pull/13448",
  "id": 31286753,
  "node_id": "MDExOlB1bGxSZXF1ZXN0MTQ2Mjk2MDQ=",
  "number": 13448,
  "title": "std: Make std::comm return types consistent",
  "user": {
    "login": "alexcrichton",
    "id": 64996,
    "node_id": "MDQ6VXNlcjY0OTk2",
    "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/alexcrichton",
    "html_url": "https://github.com/alexcrichton",
    "followers_url": "https://api.github.com/users/alexcrichton/followers",
    "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}",
    "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions",
    "organizations_url": "https://api.github.com/users/alexcrichton/orgs",
    "repos_url": "https://api.github.com/users/alexcrichton/repos",
    "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}",
    "received_events_url": "https://api.github.com/users/alexcrichton/received_events",
    "type": "User",
    "user_view_type": "public",
    "site_admin": false
  },
  "labels": [],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [],
  "milestone": null,
  "comments": 6,
  "created_at": "2014-04-10T22:16:48Z",
  "updated_at": "2014-07-02T14:29:10Z",
  "closed_at": "2014-04-12T20:37:01Z",
  "author_association": "MEMBER",
  "type": null,
  "active_lock_reason": null,
  "draft": false,
  "pull_request": {
    "url": "https://api.github.com/repos/rust-lang/rust/pulls/13448",
    "html_url": "https://github.com/rust-lang/rust/pull/13448",
    "diff_url": "https://github.com/rust-lang/rust/pull/13448.diff",
    "patch_url": "https://github.com/rust-lang/rust/pull/13448.patch",
    "merged_at": "2014-04-12T20:37:02Z"
  },
  "body": "There are currently a number of return values from the std::comm methods, not\nall of which are necessarily completely expressive:\n- `Sender::try_send(t: T) -> bool`\n  This method currently doesn't transmit back the data `t` if the send fails\n  due to the other end having disconnected. Additionally, this shares the name\n  of the synchronous try_send method, but it differs in semantics in that it\n  only has one failure case, not two (the buffer can never be full).\n- `SyncSender::try_send(t: T) -> TrySendResult<T>`\n  This method accurately conveys all possible information, but it uses a\n  custom type to the std::comm module with no convenience methods on it.\n  Additionally, if you want to inspect the result you're forced to import\n  something from `std::comm`.\n- `SyncSender::send_opt(t: T) -> Option<T>`\n  This method uses Some(T) as an \"error value\" and None as a \"success value\",\n  but almost all other uses of Option<T> have Some/None the other way\n- `Receiver::try_recv(t: T) -> TryRecvResult<T>`\n  Similarly to the synchronous try_send, this custom return type is lacking in\n  terms of usability (no convenience methods).\n\nWith this number of drawbacks in mind, I believed it was time to re-work the\nreturn types of these methods. The new API for the comm module is:\n\n```\nSender::send(t: T) -> ()\nSender::send_opt(t: T) -> Result<(), T>\nSyncSender::send(t: T) -> ()\nSyncSender::send_opt(t: T) -> Result<(), T>\nSyncSender::try_send(t: T) -> Result<(), TrySendError<T>>\nReceiver::recv() -> T\nReceiver::recv_opt() -> Result<T, ()>\nReceiver::try_recv() -> Result<T, TryRecvError>\n```\n\nThe notable changes made are:\n- Sender::try_send => Sender::send_opt. This renaming brings the semantics in\n  line with the SyncSender::send_opt method. An asychronous send only has one\n  failure case, unlike the synchronous try_send method which has two failure\n  cases (full/disconnected).\n- Sender::send_opt returns the data back to the caller if the send is guaranteed\n  to fail. This method previously returned `bool`, but then it was unable to\n  retrieve the data if the data was guaranteed to fail to send. There is still a\n  race such that when `Ok(())` is returned the data could still fail to be\n  received, but that's inherent to an asynchronous channel.\n- Result is now the basis of all return values. This not only adds lots of\n  convenience methods to all return values for free, but it also means that you\n  can inspect the return values with no extra imports (Ok/Err are in the\n  prelude). Additionally, it's now self documenting when something failed or not\n  because the return value has \"Err\" in the name.\n\nThings I'm a little uneasy about:\n- The methods send_opt and recv_opt are not returning options, but rather\n  results. I felt more strongly that Option was the wrong return type than the\n  _opt prefix was wrong, and I coudn't think of a much better name for these\n  methods. One possible way to think about them is to read the _opt suffix as\n  \"optionally\".\n- Result<T, ()> is often better expressed as Option<T>. This is only applicable\n  to the recv_opt() method, but I thought it would be more consistent for\n  everything to return Result rather than one method returning an Option.\n\nDespite my two reasons to feel uneasy, I feel much better about the consistency\nin return values at this point, and I think the only real open question is if\nthere's a better suffix for {send,recv}_opt.\n\nCloses #11527\n",
  "closed_by": {
    "login": "bors",
    "id": 3372342,
    "node_id": "MDQ6VXNlcjMzNzIzNDI=",
    "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/bors",
    "html_url": "https://github.com/bors",
    "followers_url": "https://api.github.com/users/bors/followers",
    "following_url": "https://api.github.com/users/bors/following{/other_user}",
    "gists_url": "https://api.github.com/users/bors/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/bors/subscriptions",
    "organizations_url": "https://api.github.com/users/bors/orgs",
    "repos_url": "https://api.github.com/users/bors/repos",
    "events_url": "https://api.github.com/users/bors/events{/privacy}",
    "received_events_url": "https://api.github.com/users/bors/received_events",
    "type": "User",
    "user_view_type": "public",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/13448/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/13448/timeline",
  "performed_via_github_app": null,
  "state_reason": null,
  "_meta": {
    "type": "pr"
  }
}
