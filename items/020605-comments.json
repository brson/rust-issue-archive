[
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/68975873",
    "html_url": "https://github.com/rust-lang/rust/issues/20605#issuecomment-68975873",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/20605",
    "id": 68975873,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY4OTc1ODcz",
    "user": {
      "login": "Sgeo",
      "id": 251161,
      "node_id": "MDQ6VXNlcjI1MTE2MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/251161?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Sgeo",
      "html_url": "https://github.com/Sgeo",
      "followers_url": "https://api.github.com/users/Sgeo/followers",
      "following_url": "https://api.github.com/users/Sgeo/following{/other_user}",
      "gists_url": "https://api.github.com/users/Sgeo/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Sgeo/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Sgeo/subscriptions",
      "organizations_url": "https://api.github.com/users/Sgeo/orgs",
      "repos_url": "https://api.github.com/users/Sgeo/repos",
      "events_url": "https://api.github.com/users/Sgeo/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Sgeo/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-01-07T03:54:53Z",
    "updated_at": "2015-01-07T03:54:53Z",
    "body": "The following also ICEs on Rust playpen:\n\n``` rust\nfn changer<'a>(things: &mut Iterator) {\n    for item in *things {  }\n}\n\nfn main() {\n}\n```\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/68975873/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/69691152",
    "html_url": "https://github.com/rust-lang/rust/issues/20605#issuecomment-69691152",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/20605",
    "id": 69691152,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY5NjkxMTUy",
    "user": {
      "login": "skurmedel",
      "id": 2054313,
      "node_id": "MDQ6VXNlcjIwNTQzMTM=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2054313?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/skurmedel",
      "html_url": "https://github.com/skurmedel",
      "followers_url": "https://api.github.com/users/skurmedel/followers",
      "following_url": "https://api.github.com/users/skurmedel/following{/other_user}",
      "gists_url": "https://api.github.com/users/skurmedel/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/skurmedel/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/skurmedel/subscriptions",
      "organizations_url": "https://api.github.com/users/skurmedel/orgs",
      "repos_url": "https://api.github.com/users/skurmedel/repos",
      "events_url": "https://api.github.com/users/skurmedel/events{/privacy}",
      "received_events_url": "https://api.github.com/users/skurmedel/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-01-13T03:40:34Z",
    "updated_at": "2015-01-13T03:44:50Z",
    "body": "I am getting this as well for a function:\n\n``` rust\n\nfn write_ppm16(\n    out: &mut Writer, \n    dims: (u16, u16), \n    pixels: &mut iter::Iterator<Item = RGB16>,\n    opt_conf: Option<PPMConfig>) -> IoResult<u32> {\n// ...\nfor p in *pixels {\n        try!(out.write_be_u16(p.r));\n        try!(out.write_be_u16(p.g));\n        try!(out.write_be_u16(p.b));\n\n        bytes_written += 6;\n    }\n// ...\n}\n```\n\nIs there a work-around?\n\n## Error\n\n> error: internal compiler error: trying to take the sizing type of <core::iter::Iterator + 'static as core::iter::Iterator>::Item, an unsized type\n> note: the compiler unexpectedly panicked. this is a bug.\n> note: we would appreciate a bug report: http://doc.rust-lang.org/complement-bugreport.html\n> note: run with `RUST_BACKTRACE=1` for a backtrace\n> thread 'rustc' panicked at 'Box<Any>', C:\\bot\\slave\\nightly-dist-rustc-win-64\\build\\src\\libsyntax\\diagnostic.rs:182\n> \n> stack backtrace:\n> 1:         0x69bee9cd - sys::backtrace::write::hd40c6de25ef01e0bfjt\n> 2:         0x69c01a32 - rt::unwind::register::hcb202fda23aef97aw7y\n> 3:         0x69b834a7 - rt::unwind::begin_unwind_inner::h43ca250f1ae88b3e64y\n> 4:         0x6f89cbf6 - diagnostic::SpanHandler::span_bug::hb66e4bdba79bcb62uGF\n> 5:         0x6f89d4a5 - diagnostic::Handler::bug::h85a78a072de1c70cuMF\n> 6:           0x902ba2 - session::Session::bug::h67201db2df2c561edcq\n> 7:          0x1184508 - trans::common::u32.AsU64::as_u64::hb09c0f9cedc2afe9Vml\n> 8:          0x129bd66 - trans::adt::Struct<'tcx>...std..cmp..Eq::assert_receiver_is_total_eq::ha4043fc1c68313ebebH\n> 9:          0x117deca - trans::cleanup::FunctionContext<'blk, 'tcx>.CleanupMethods<'blk, 'tcx>::pop_and_trans_custom_cleanup_scope::he19b59ee6fbbbdabvoK\n> 10:          0x11698b8 - trans::cleanup::FunctionContext<'blk, 'tcx>.CleanupMethods<'blk, 'tcx>::push_custom_cleanup_scope::h8a436d69fac4a20bveK\n> 11:          0x1169588 - trans::cleanup::FunctionContext<'blk, 'tcx>.CleanupMethods<'blk, 'tcx>::push_custom_cleanup_scope::h8a436d69fac4a20bveK\n> 12:          0x121591f - trans::context::CrateContext<'b, 'tcx>::report_overbig_object::h7fa55c84f4a7e14cxDm\n> 13:          0x1272821 - trans::closure::ClosureKind<'tcx>...std..cmp..PartialEq::eq::h22627d35aff317eamOx\n> 14:          0x126fb19 - trans::closure::ClosureKind<'tcx>...std..cmp..PartialEq::eq::h22627d35aff317eamOx\n> 15:          0x117bda3 - trans::cleanup::FunctionContext<'blk, 'tcx>.CleanupMethods<'blk, 'tcx>::pop_and_trans_custom_cleanup_scope::he19b59ee6fbbbdabvoK\n> 16:          0x11e43ca - trans::cleanup::FunctionContext<'blk, 'tcx>.CleanupMethods<'blk, 'tcx>::schedule_free_value::h59b3033bcd53c94bkBK\n> 17:          0x11b4b1b - trans::type_::Type...std..cmp..PartialEq::ne::hc5732761018813b3ckJ\n> 18:          0x11644a6 - trans::cleanup::FunctionContext<'blk, 'tcx>.CleanupMethods<'blk, 'tcx>::pop_and_trans_ast_cleanup_scope::h001d1bfc7990d7c63hK\n> 19:          0x116338b - trans::cleanup::FunctionContext<'blk, 'tcx>.CleanupMethods<'blk, 'tcx>::push_ast_cleanup_scope::hb0e55269a2ff9d34l9J\n> 20:          0x1164aef - trans::cleanup::FunctionContext<'blk, 'tcx>.CleanupMethods<'blk, 'tcx>::pop_and_trans_ast_cleanup_scope::h001d1bfc7990d7c63hK\n> 21:          0x122d3de - trans::base::IsUnboxedClosureFlag...std..clone..Clone::clone::h8d9b5221c757fe7fbLt\n> 22:          0x114fea0 - trans::context::CrateContext<'b, 'tcx>::sess::h0c92734bae2bfb65wmm\n> 23:          0x114b63d - trans::context::CrateContext<'b, 'tcx>::stats::hfdf50b198e5f7592qzm\n> 24:          0x122fc48 - trans::cleanup::FunctionContext<'blk, 'tcx>.CleanupMethods<'blk, 'tcx>::push_custom_cleanup_scope_with_debug_loc::hc8a6918f1c87a4b9ngK\n> 25:          0x114b857 - trans::context::CrateContext<'b, 'tcx>::stats::hfdf50b198e5f7592qzm\n> 26:          0x1234728 - trans::base::trans_crate::ha9ad2d2ee040c191Udv\n> 27:         0x70b2543a - driver::phase_4_translate_to_llvm::h9dcbc7c0b9c8c65bJFa\n> 28:         0x70b03243 - driver::compile_input::h45b30318e07c4cf6vba\n> 29:         0x70bcaa1e - run::heefafb1ff7869308B4b\n> 30:         0x70bc786a - run::heefafb1ff7869308B4b\n> 31:         0x69c288fc - rust_try\n> 32:         0x69c288d9 - rust_try\n> 33:         0x70bc7fa9 - run::heefafb1ff7869308B4b\n> 34:         0x69bf3457 - sys::tcp::TcpListener::bind::hfcf283b88d14d24bfTv\n> 35:         0x775659ed - BaseThreadInitThunk\n\n## Version\n\n> rustc 1.0.0-nightly (ea6f65c5f 2015-01-06 19:47:08 +0000)\n> binary: rustc\n> commit-hash: ea6f65c5f1a3f84e010d2cef02a0160804e9567a\n> commit-date: 2015-01-06 19:47:08 +0000\n> host: x86_64-pc-windows-gnu\n> release: 1.0.0-nightly\n",
    "author_association": "NONE",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/69691152/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/71463358",
    "html_url": "https://github.com/rust-lang/rust/issues/20605#issuecomment-71463358",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/20605",
    "id": 71463358,
    "node_id": "MDEyOklzc3VlQ29tbWVudDcxNDYzMzU4",
    "user": {
      "login": "japaric",
      "id": 5018213,
      "node_id": "MDQ6VXNlcjUwMTgyMTM=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5018213?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/japaric",
      "html_url": "https://github.com/japaric",
      "followers_url": "https://api.github.com/users/japaric/followers",
      "following_url": "https://api.github.com/users/japaric/following{/other_user}",
      "gists_url": "https://api.github.com/users/japaric/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/japaric/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/japaric/subscriptions",
      "organizations_url": "https://api.github.com/users/japaric/orgs",
      "repos_url": "https://api.github.com/users/japaric/repos",
      "events_url": "https://api.github.com/users/japaric/events{/privacy}",
      "received_events_url": "https://api.github.com/users/japaric/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-01-26T13:54:01Z",
    "updated_at": "2015-01-26T13:54:01Z",
    "body": "Updated error message is an LLVM assertion:\n\n```\nrustc: /home/rustbuild/src/rust-buildbot/slave/nightly-dist-rustc-linux/build/src/llvm/lib/IR/Instructions.cpp:550: void llvm::InvokeInst::init(llvm::Value*, llvm::BasicBlock*, llvm::BasicBlock*, llvm::ArrayRef<llvm::Value*>, const llvm::Twine&): Assertion `(i >= FTy->getNumParams() || FTy->getParamType(i) == Args[i]->getType()) && \"Invoking a function with a bad signature!\"' failed.\n[1]    8065 abort (core dumped)  rustc 20605.rs\n```\n\nTo workaround the bug, simply don't dereference the iterator, this doesn't crash:\n\n``` rust\nfn changer<'a>(mut things: Box<Iterator<Item=&'a mut u8>>) {\n    for item in things { *item = 0 }\n}\n\nfn main() {\n}\n```\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/71463358/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/71466615",
    "html_url": "https://github.com/rust-lang/rust/issues/20605#issuecomment-71466615",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/20605",
    "id": 71466615,
    "node_id": "MDEyOklzc3VlQ29tbWVudDcxNDY2NjE1",
    "user": {
      "login": "japaric",
      "id": 5018213,
      "node_id": "MDQ6VXNlcjUwMTgyMTM=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5018213?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/japaric",
      "html_url": "https://github.com/japaric",
      "followers_url": "https://api.github.com/users/japaric/followers",
      "following_url": "https://api.github.com/users/japaric/following{/other_user}",
      "gists_url": "https://api.github.com/users/japaric/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/japaric/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/japaric/subscriptions",
      "organizations_url": "https://api.github.com/users/japaric/orgs",
      "repos_url": "https://api.github.com/users/japaric/repos",
      "events_url": "https://api.github.com/users/japaric/events{/privacy}",
      "received_events_url": "https://api.github.com/users/japaric/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-01-26T14:18:54Z",
    "updated_at": "2015-01-26T14:18:54Z",
    "body": "FWIW, the new for loops (#20790) report a compiler error in this case, instead of ICEing:\n\n``` rust\nfn changer<'a>(mut things: Box<Iterator<Item=&'a mut u8>>) {\n    for item in *things { *item = 0 }\n}\n\nfn main() {\n}\n```\n\nOutput:\n\n```\n20605.rs:2:5: 3:2 error: the trait `core::marker::Sized` is not implemented for the type `core::iter::Iterator` [E0277]\n20605.rs:2     for item in *things { *item = 0 }\n20605.rs:3 }\n20605.rs:2:5: 3:2 note: `core::iter::Iterator` does not have a constant size known at compile-time\n20605.rs:2     for item in *things { *item = 0 }\n20605.rs:3 }\n20605.rs:2:5: 3:2 error: the trait `core::marker::Sized` is not implemented for the type `core::iter::Iterator` [E0277]\n20605.rs:2     for item in *things { *item = 0 }\n20605.rs:3 }\n20605.rs:2:5: 3:2 note: `core::iter::Iterator` does not have a constant size known at compile-time\n20605.rs:2     for item in *things { *item = 0 }\n20605.rs:3 }\n20605.rs:2:5: 3:2 error: the trait `core::marker::Sized` is not implemented for the type `core::iter::Iterator` [E0277]\n20605.rs:2     for item in *things { *item = 0 }\n20605.rs:3 }\n20605.rs:2:5: 3:2 note: `core::iter::Iterator` does not have a constant size known at compile-time\n20605.rs:2     for item in *things { *item = 0 }\n20605.rs:3 }\nerror: aborting due to 3 previous errors\n```\n\ncc @nikomatsakis \n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/71466615/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
