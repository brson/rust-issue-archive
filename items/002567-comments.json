[
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/6229579",
    "html_url": "https://github.com/rust-lang/rust/issues/2567#issuecomment-6229579",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/2567",
    "id": 6229579,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYyMjk1Nzk=",
    "user": {
      "login": "jesse99",
      "id": 425055,
      "node_id": "MDQ6VXNlcjQyNTA1NQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/425055?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jesse99",
      "html_url": "https://github.com/jesse99",
      "followers_url": "https://api.github.com/users/jesse99/followers",
      "following_url": "https://api.github.com/users/jesse99/following{/other_user}",
      "gists_url": "https://api.github.com/users/jesse99/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jesse99/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jesse99/subscriptions",
      "organizations_url": "https://api.github.com/users/jesse99/orgs",
      "repos_url": "https://api.github.com/users/jesse99/repos",
      "events_url": "https://api.github.com/users/jesse99/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jesse99/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2012-06-10T16:23:52Z",
    "updated_at": "2012-06-10T16:23:52Z",
    "body": "Here is a test case for the above\n\n```\n// rustc --test test.rs && ./test\nuse std;\nimport std::map::hashmap;\nimport core::dvec::*;\n\ntype pets = hashmap<str, dvec<str>>;\n\nfn broken_add(pets: pets, owner: str, name: str)\n{\n    alt pets.find(owner)\n    {\n        option::some(owns)\n        {\n            // owns is a copy so this is not very useful\n            owns.push(name);\n        }\n        option::none\n        {\n            pets.insert(owner, dvec::from_vec([mut name]));\n        }\n    }\n}\n\nfn inefficient_add(pets: pets, owner: str, name: str)\n{\n    alt pets.find(owner)\n    {\n        option::some(owns)\n        {\n            // this does work, but there are at least two copies of a\n            // potentially very large vector\n            owns.push(name);\n            pets.insert(owner, copy(owns));\n        }\n        option::none\n        {\n            pets.insert(owner, dvec::from_vec([mut name]));\n        }\n    }\n}\n\n#[test]\nfn broken()\n{\n    let pets = std::map::str_hash();\n    broken_add(pets, \"Dr Evil\", \"Mr. Bigglesworth\");\n    broken_add(pets, \"Dr Evil\", \"Sharks with frickin' laser beams\");\n    broken_add(pets, \"Pinocchio\", \"Figaro\");\n\n    assert pets.size() == 2u;\n    assert pets.get(\"Dr Evil\").len() == 2u;        // this fails\n    assert pets.get(\"Pinocchio\").len() == 1u;\n}\n\n#[test]\nfn inefficient()\n{\n    let pets = std::map::str_hash();\n    inefficient_add(pets, \"Dr Evil\", \"Mr. Bigglesworth\");\n    inefficient_add(pets, \"Dr Evil\", \"Sharks with frickin' laser beams\");\n    inefficient_add(pets, \"Pinocchio\", \"Figaro\");\n\n    assert pets.size() == 2u;\n    assert pets.get(\"Dr Evil\").len() == 2u;\n    assert pets.get(\"Pinocchio\").len() == 1u;\n}\n```\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/6229579/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/6230169",
    "html_url": "https://github.com/rust-lang/rust/issues/2567#issuecomment-6230169",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/2567",
    "id": 6230169,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYyMzAxNjk=",
    "user": {
      "login": "nikomatsakis",
      "id": 155238,
      "node_id": "MDQ6VXNlcjE1NTIzOA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/155238?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nikomatsakis",
      "html_url": "https://github.com/nikomatsakis",
      "followers_url": "https://api.github.com/users/nikomatsakis/followers",
      "following_url": "https://api.github.com/users/nikomatsakis/following{/other_user}",
      "gists_url": "https://api.github.com/users/nikomatsakis/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nikomatsakis/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nikomatsakis/subscriptions",
      "organizations_url": "https://api.github.com/users/nikomatsakis/orgs",
      "repos_url": "https://api.github.com/users/nikomatsakis/repos",
      "events_url": "https://api.github.com/users/nikomatsakis/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nikomatsakis/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2012-06-10T17:41:21Z",
    "updated_at": "2012-06-10T17:41:21Z",
    "body": "Yes I want to refactor the API so that it is based on a `with()` primitive that gives you in-place access to the value rather than `get()` and `find()`.  For now, I would suggest using `@dvec` as the value type.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/6230169/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/6231889",
    "html_url": "https://github.com/rust-lang/rust/issues/2567#issuecomment-6231889",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/2567",
    "id": 6231889,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYyMzE4ODk=",
    "user": {
      "login": "jesse99",
      "id": 425055,
      "node_id": "MDQ6VXNlcjQyNTA1NQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/425055?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jesse99",
      "html_url": "https://github.com/jesse99",
      "followers_url": "https://api.github.com/users/jesse99/followers",
      "following_url": "https://api.github.com/users/jesse99/following{/other_user}",
      "gists_url": "https://api.github.com/users/jesse99/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jesse99/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jesse99/subscriptions",
      "organizations_url": "https://api.github.com/users/jesse99/orgs",
      "repos_url": "https://api.github.com/users/jesse99/repos",
      "events_url": "https://api.github.com/users/jesse99/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jesse99/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2012-06-10T20:59:44Z",
    "updated_at": "2012-06-10T20:59:44Z",
    "body": "Ya, that works.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/6231889/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/6334433",
    "html_url": "https://github.com/rust-lang/rust/issues/2567#issuecomment-6334433",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/2567",
    "id": 6334433,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYzMzQ0MzM=",
    "user": {
      "login": "catamorphism",
      "id": 427212,
      "node_id": "MDQ6VXNlcjQyNzIxMg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/427212?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/catamorphism",
      "html_url": "https://github.com/catamorphism",
      "followers_url": "https://api.github.com/users/catamorphism/followers",
      "following_url": "https://api.github.com/users/catamorphism/following{/other_user}",
      "gists_url": "https://api.github.com/users/catamorphism/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/catamorphism/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/catamorphism/subscriptions",
      "organizations_url": "https://api.github.com/users/catamorphism/orgs",
      "repos_url": "https://api.github.com/users/catamorphism/repos",
      "events_url": "https://api.github.com/users/catamorphism/events{/privacy}",
      "received_events_url": "https://api.github.com/users/catamorphism/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2012-06-14T17:01:21Z",
    "updated_at": "2012-06-14T17:01:21Z",
    "body": "Seems like this can be closed? @nikomatsakis , if you want to open an issue for your refactoring, please do :-)\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/6334433/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
