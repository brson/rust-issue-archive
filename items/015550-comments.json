[
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/48513055",
    "html_url": "https://github.com/rust-lang/rust/pull/15550#issuecomment-48513055",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/15550",
    "id": 48513055,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ4NTEzMDU1",
    "user": {
      "login": "pnkfelix",
      "id": 173127,
      "node_id": "MDQ6VXNlcjE3MzEyNw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/173127?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/pnkfelix",
      "html_url": "https://github.com/pnkfelix",
      "followers_url": "https://api.github.com/users/pnkfelix/followers",
      "following_url": "https://api.github.com/users/pnkfelix/following{/other_user}",
      "gists_url": "https://api.github.com/users/pnkfelix/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/pnkfelix/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/pnkfelix/subscriptions",
      "organizations_url": "https://api.github.com/users/pnkfelix/orgs",
      "repos_url": "https://api.github.com/users/pnkfelix/repos",
      "events_url": "https://api.github.com/users/pnkfelix/events{/privacy}",
      "received_events_url": "https://api.github.com/users/pnkfelix/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-07-09T18:16:05Z",
    "updated_at": "2014-07-09T18:18:57Z",
    "body": "This is a good idea, but it does not solve the problem for `make install` itself.\n\nThe reason: The technique that it is using to test whether an installed `rustc` works or not _will_ be tricked by the build directory itself into thinking that the installed `rustc` _can_ run, but in fact the needed dependencies are being resolved (at least on Mac OS X), by looking in the local directory and finding the needed libraries there.\n\nThe subtle detail here that I am trying to stress is that when the current working directory _is_ the build directory, then all the build products work, _despite_ being moved to the target install directory.\n\n(The observation in the prior paragraph strikes me as a potential footgun, potentially worse than rpath itself; I do not understand the logic that the dynamic library loader is using.  Maybe we should be using absolute paths rather than relative ones in the binary that we emit?)\n\nAnyway, here is the transcript:\n\nhttps://gist.github.com/pnkfelix/8cfa7a8506023f7f1154\n\nIn particular, compare this line:\nhttps://gist.github.com/pnkfelix/8cfa7a8506023f7f1154#file-gistfile1-txt-L26\nto this line:\nhttps://gist.github.com/pnkfelix/8cfa7a8506023f7f1154#file-gistfile1-txt-L31\n\n(where in the latter all I did was move the current working directory up to the parent of the build tree.)\n\n---\n\nAnd of course, note that when I ran `make install` itself, there was no warning at the end telling me that the installed build products would not actually work without changes to my env vars, as shown here:\nhttps://gist.github.com/pnkfelix/8cfa7a8506023f7f1154#file-gistfile1-txt-L324\n\n---\n\nAgain, I approve of the spirit of this patch, and was close to r+'ing it on that basis.  But at this point it does not solve the problem at hand.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/48513055/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/48519194",
    "html_url": "https://github.com/rust-lang/rust/pull/15550#issuecomment-48519194",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/15550",
    "id": 48519194,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ4NTE5MTk0",
    "user": {
      "login": "alexcrichton",
      "id": 64996,
      "node_id": "MDQ6VXNlcjY0OTk2",
      "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alexcrichton",
      "html_url": "https://github.com/alexcrichton",
      "followers_url": "https://api.github.com/users/alexcrichton/followers",
      "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}",
      "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions",
      "organizations_url": "https://api.github.com/users/alexcrichton/orgs",
      "repos_url": "https://api.github.com/users/alexcrichton/repos",
      "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alexcrichton/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-07-09T19:00:59Z",
    "updated_at": "2014-07-09T19:00:59Z",
    "body": "This is needed to unblock a snapshot, it may lead to not printing something on OSX, but this is holding back the linux snapshot if it doesn't get merged.\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/48519194/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/48520193",
    "html_url": "https://github.com/rust-lang/rust/pull/15550#issuecomment-48520193",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/15550",
    "id": 48520193,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ4NTIwMTkz",
    "user": {
      "login": "brson",
      "id": 147214,
      "node_id": "MDQ6VXNlcjE0NzIxNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/brson",
      "html_url": "https://github.com/brson",
      "followers_url": "https://api.github.com/users/brson/followers",
      "following_url": "https://api.github.com/users/brson/following{/other_user}",
      "gists_url": "https://api.github.com/users/brson/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/brson/subscriptions",
      "organizations_url": "https://api.github.com/users/brson/orgs",
      "repos_url": "https://api.github.com/users/brson/repos",
      "events_url": "https://api.github.com/users/brson/events{/privacy}",
      "received_events_url": "https://api.github.com/users/brson/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-07-09T19:08:46Z",
    "updated_at": "2014-07-09T19:08:46Z",
    "body": "In @pnkfelix's first example, I don't understand why `rustc` links correctly when running out of the build directory.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/48520193/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/48520476",
    "html_url": "https://github.com/rust-lang/rust/pull/15550#issuecomment-48520476",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/15550",
    "id": 48520476,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ4NTIwNDc2",
    "user": {
      "login": "alexcrichton",
      "id": 64996,
      "node_id": "MDQ6VXNlcjY0OTk2",
      "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alexcrichton",
      "html_url": "https://github.com/alexcrichton",
      "followers_url": "https://api.github.com/users/alexcrichton/followers",
      "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}",
      "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions",
      "organizations_url": "https://api.github.com/users/alexcrichton/orgs",
      "repos_url": "https://api.github.com/users/alexcrichton/repos",
      "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alexcrichton/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-07-09T19:11:03Z",
    "updated_at": "2014-07-09T19:11:03Z",
    "body": "It appears that OSX has a hardcoded path to the library as the last fallback:\n\n```\n$ otool -l x86_64-apple-darwin/stage2/bin/rustc \n...\nLoad command 27\n          cmd LC_LOAD_DYLIB\n      cmdsize 112\n         name x86_64-apple-darwin/stage1/lib/rustlib/x86_64-apple-darwin/lib/librustrt-4e7c5e5c.dylib (offset 24)\n   time stamp 2 Wed Dec 31 16:00:02 1969\n      current version 0.0.0\ncompatibility version 0.0.0\n...\n```\n\nI believe it's using these hardcoded paths as the last fallback because nothing is found in `DYLD_LIBRARY_PATH`\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/48520476/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/48566081",
    "html_url": "https://github.com/rust-lang/rust/pull/15550#issuecomment-48566081",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/15550",
    "id": 48566081,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ4NTY2MDgx",
    "user": {
      "login": "netvl",
      "id": 280456,
      "node_id": "MDQ6VXNlcjI4MDQ1Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/280456?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/netvl",
      "html_url": "https://github.com/netvl",
      "followers_url": "https://api.github.com/users/netvl/followers",
      "following_url": "https://api.github.com/users/netvl/following{/other_user}",
      "gists_url": "https://api.github.com/users/netvl/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/netvl/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/netvl/subscriptions",
      "organizations_url": "https://api.github.com/users/netvl/orgs",
      "repos_url": "https://api.github.com/users/netvl/repos",
      "events_url": "https://api.github.com/users/netvl/events{/privacy}",
      "received_events_url": "https://api.github.com/users/netvl/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-07-10T05:15:25Z",
    "updated_at": "2014-07-10T05:19:55Z",
    "body": "Linux nightly still does not compile with an error about libnative :( http://buildbot.rust-lang.org/builders/nightly-linux/builds/28 It fails on distcheck.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/48566081/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/48617832",
    "html_url": "https://github.com/rust-lang/rust/pull/15550#issuecomment-48617832",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/15550",
    "id": 48617832,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ4NjE3ODMy",
    "user": {
      "login": "alexcrichton",
      "id": 64996,
      "node_id": "MDQ6VXNlcjY0OTk2",
      "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alexcrichton",
      "html_url": "https://github.com/alexcrichton",
      "followers_url": "https://api.github.com/users/alexcrichton/followers",
      "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}",
      "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions",
      "organizations_url": "https://api.github.com/users/alexcrichton/orgs",
      "repos_url": "https://api.github.com/users/alexcrichton/repos",
      "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alexcrichton/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-07-10T15:11:10Z",
    "updated_at": "2014-07-10T15:11:10Z",
    "body": "That should be fixed by https://github.com/rust-lang/rust/pull/15578\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/48617832/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
