{
  "url": "https://api.github.com/repos/rust-lang/rust/issues/16208",
  "repository_url": "https://api.github.com/repos/rust-lang/rust",
  "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/16208/labels{/name}",
  "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/16208/comments",
  "events_url": "https://api.github.com/repos/rust-lang/rust/issues/16208/events",
  "html_url": "https://github.com/rust-lang/rust/pull/16208",
  "id": 39361323,
  "node_id": "MDExOlB1bGxSZXF1ZXN0MTkyNTE1NjU=",
  "number": 16208,
  "title": "Add explicit padding to network structures; add `repr_c_implicit_padding` lint to help",
  "user": {
    "login": "apoelstra",
    "id": 1351933,
    "node_id": "MDQ6VXNlcjEzNTE5MzM=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1351933?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/apoelstra",
    "html_url": "https://github.com/apoelstra",
    "followers_url": "https://api.github.com/users/apoelstra/followers",
    "following_url": "https://api.github.com/users/apoelstra/following{/other_user}",
    "gists_url": "https://api.github.com/users/apoelstra/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/apoelstra/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/apoelstra/subscriptions",
    "organizations_url": "https://api.github.com/users/apoelstra/orgs",
    "repos_url": "https://api.github.com/users/apoelstra/repos",
    "events_url": "https://api.github.com/users/apoelstra/events{/privacy}",
    "received_events_url": "https://api.github.com/users/apoelstra/received_events",
    "type": "User",
    "user_view_type": "public",
    "site_admin": false
  },
  "labels": [],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [],
  "milestone": null,
  "comments": 10,
  "created_at": "2014-08-03T01:43:06Z",
  "updated_at": "2014-08-06T01:03:39Z",
  "closed_at": "2014-08-06T01:03:39Z",
  "author_association": "CONTRIBUTOR",
  "type": null,
  "active_lock_reason": null,
  "draft": false,
  "pull_request": {
    "url": "https://api.github.com/repos/rust-lang/rust/pulls/16208",
    "html_url": "https://github.com/rust-lang/rust/pull/16208",
    "diff_url": "https://github.com/rust-lang/rust/pull/16208.diff",
    "patch_url": "https://github.com/rust-lang/rust/pull/16208.patch",
    "merged_at": null
  },
  "body": "The recent pull request\nhttps://github.com/rust-lang/rust/issues/15763\nchanges the structure return value semantics to use a LLVM Load instruction. This instruction does not copy padding fields when copying structs, which interacts badly with BSD socket code -- which makes a habit of casting pointers to different structures amongst each other, inadvertently storing important data in struct padding. The result is that Tcp connections cannot be made after the referenced PR.\n\nThis is not a problem for C code, which generally uses `memcpy` and raw pointers to copy structures around. For Rust, which typically copies structures by value, it is a problem. The solution is to make sure that any part of a structure containing data is an explicit field. We accomplish this by adding a lint, `repr_c_implicit_padding`, and enabling it for `libc`, which emits a warning whenever a structure contains padding. This lets us detect implicit padding and replace it with an explicit field, which will be copied on load/store.\n\nThis PR will allow PR 15763 to pass the testsuite.\n\nThere should be no user-visible changes by this PR, except the new lint that is available. It is off by default.\n",
  "closed_by": {
    "login": "apoelstra",
    "id": 1351933,
    "node_id": "MDQ6VXNlcjEzNTE5MzM=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1351933?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/apoelstra",
    "html_url": "https://github.com/apoelstra",
    "followers_url": "https://api.github.com/users/apoelstra/followers",
    "following_url": "https://api.github.com/users/apoelstra/following{/other_user}",
    "gists_url": "https://api.github.com/users/apoelstra/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/apoelstra/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/apoelstra/subscriptions",
    "organizations_url": "https://api.github.com/users/apoelstra/orgs",
    "repos_url": "https://api.github.com/users/apoelstra/repos",
    "events_url": "https://api.github.com/users/apoelstra/events{/privacy}",
    "received_events_url": "https://api.github.com/users/apoelstra/received_events",
    "type": "User",
    "user_view_type": "public",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/16208/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/16208/timeline",
  "performed_via_github_app": null,
  "state_reason": null,
  "_meta": {
    "type": "pr"
  }
}
