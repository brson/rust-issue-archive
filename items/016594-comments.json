[
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/52587279",
    "html_url": "https://github.com/rust-lang/rust/issues/16594#issuecomment-52587279",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/16594",
    "id": 52587279,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUyNTg3Mjc5",
    "user": {
      "login": "Gankra",
      "id": 1136864,
      "node_id": "MDQ6VXNlcjExMzY4NjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1136864?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Gankra",
      "html_url": "https://github.com/Gankra",
      "followers_url": "https://api.github.com/users/Gankra/followers",
      "following_url": "https://api.github.com/users/Gankra/following{/other_user}",
      "gists_url": "https://api.github.com/users/Gankra/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Gankra/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Gankra/subscriptions",
      "organizations_url": "https://api.github.com/users/Gankra/orgs",
      "repos_url": "https://api.github.com/users/Gankra/repos",
      "events_url": "https://api.github.com/users/Gankra/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Gankra/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-08-19T03:49:19Z",
    "updated_at": "2014-08-19T03:49:19Z",
    "body": "This strikes me as a bit of a feature. I would be unhappy if changing the implementation details of a function (or a function called by a function... etc), suddenly caused a user of that function to fail borrow-checking. Especially since they'd only be passing borrow-checking because they were being clever (or, much more likely: lucky). \n\nAs it stands now, the signature of the function is sufficient to identify all the ownership consequences of calling the function, which is nice.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/52587279/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/52587673",
    "html_url": "https://github.com/rust-lang/rust/issues/16594#issuecomment-52587673",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/16594",
    "id": 52587673,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUyNTg3Njcz",
    "user": {
      "login": "bfops",
      "id": 196249,
      "node_id": "MDQ6VXNlcjE5NjI0OQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/196249?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/bfops",
      "html_url": "https://github.com/bfops",
      "followers_url": "https://api.github.com/users/bfops/followers",
      "following_url": "https://api.github.com/users/bfops/following{/other_user}",
      "gists_url": "https://api.github.com/users/bfops/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/bfops/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/bfops/subscriptions",
      "organizations_url": "https://api.github.com/users/bfops/orgs",
      "repos_url": "https://api.github.com/users/bfops/repos",
      "events_url": "https://api.github.com/users/bfops/events{/privacy}",
      "received_events_url": "https://api.github.com/users/bfops/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-08-19T03:57:16Z",
    "updated_at": "2014-08-19T04:12:54Z",
    "body": "It means there are patterns of common behavior that can't be factored out without aggravating the borrow checker. I have code like this:\n\n```\nfor (id, mob) in self.mobs.mut_iter() {\n    translate_mob(mob, &self.physics, &self.gl_context, &self.mob_gl_buffers, ..., Vec3::new(1.0, 2.0, 3.0));\n}\n```\n\nIf I do this in more than a few places, it would be nice to factor this out into a function, but this isn't valid, regardless of how I define `self.translate_mob`.\n\n```\nfor (id, mob) in self.mobs.mut_iter() {\n    self.translate_mob(mob, Vec3::new(1.0, 2.0, 3.0));\n}\n```\n\nI could use a macro to call the real function:\n\n```\nmacro_rules! translate_mob(\n  ($world:expr, $mob:expr, $v:expr) => (\n    App::translate_mob(\n      &$world.gl,\n      &mut $world.physics,\n      $world.mob_buffers.get_mut_ref(),\n      ...\n      $mob,\n      $v\n    );\n  );\n)\n```\n\nBut that's kind of cumbersome. Maybe this only makes sense within the context of implementing class internals, but in that case, I don't think it's really clever or lucky for me to rely on some underlying principle of how another function was implemented, and I certainly want the build breaking if those assumptions change. I'd at least like the _option_ of writing functions with \"deep\" borrow checking, to avoid the impending boilerplate of writing \"static\" functions and then writing macros to call them.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/52587673/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/52588922",
    "html_url": "https://github.com/rust-lang/rust/issues/16594#issuecomment-52588922",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/16594",
    "id": 52588922,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUyNTg4OTIy",
    "user": {
      "login": "huonw",
      "id": 1203825,
      "node_id": "MDQ6VXNlcjEyMDM4MjU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1203825?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/huonw",
      "html_url": "https://github.com/huonw",
      "followers_url": "https://api.github.com/users/huonw/followers",
      "following_url": "https://api.github.com/users/huonw/following{/other_user}",
      "gists_url": "https://api.github.com/users/huonw/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/huonw/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/huonw/subscriptions",
      "organizations_url": "https://api.github.com/users/huonw/orgs",
      "repos_url": "https://api.github.com/users/huonw/repos",
      "events_url": "https://api.github.com/users/huonw/events{/privacy}",
      "received_events_url": "https://api.github.com/users/huonw/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-08-19T04:23:02Z",
    "updated_at": "2014-08-19T04:23:02Z",
    "body": "\"refinement types\" would address this (i.e. a method could dictate exactly which fields it touched). Another approach is factoring out the functionality into distinct structs, so it would be `self.mob.mut_iter()` and `self.world.translate_mob(...)`.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/52588922/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/52589127",
    "html_url": "https://github.com/rust-lang/rust/issues/16594#issuecomment-52589127",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/16594",
    "id": 52589127,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUyNTg5MTI3",
    "user": {
      "login": "bfops",
      "id": 196249,
      "node_id": "MDQ6VXNlcjE5NjI0OQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/196249?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/bfops",
      "html_url": "https://github.com/bfops",
      "followers_url": "https://api.github.com/users/bfops/followers",
      "following_url": "https://api.github.com/users/bfops/following{/other_user}",
      "gists_url": "https://api.github.com/users/bfops/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/bfops/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/bfops/subscriptions",
      "organizations_url": "https://api.github.com/users/bfops/orgs",
      "repos_url": "https://api.github.com/users/bfops/repos",
      "events_url": "https://api.github.com/users/bfops/events{/privacy}",
      "received_events_url": "https://api.github.com/users/bfops/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-08-19T04:28:03Z",
    "updated_at": "2014-08-19T04:31:53Z",
    "body": "refinement types sound like what I want! The common factoring approach makes sense in some scenarios (and this pressure from the borrow checker has definitely caused me to factor into smaller structs in some places), but it's not universally applicable - in the mob example above, it doesn't really make immediate sense to further couple any of those things together (except maybe the gl buffers into the gl context). Ultimately a struct is composed of some fundamental and distinct units that are going to be used together, like `mobs`, `physics`, and `gl` above.\n\nI think it makes sense to have \"deeper\" borrow checking as an opt-in (e.g. via explicit typing) - again, I've definitely liked the push back from the borrow checker as a default.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/52589127/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/52590533",
    "html_url": "https://github.com/rust-lang/rust/issues/16594#issuecomment-52590533",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/16594",
    "id": 52590533,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUyNTkwNTMz",
    "user": {
      "login": "bfops",
      "id": 196249,
      "node_id": "MDQ6VXNlcjE5NjI0OQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/196249?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/bfops",
      "html_url": "https://github.com/bfops",
      "followers_url": "https://api.github.com/users/bfops/followers",
      "following_url": "https://api.github.com/users/bfops/following{/other_user}",
      "gists_url": "https://api.github.com/users/bfops/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/bfops/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/bfops/subscriptions",
      "organizations_url": "https://api.github.com/users/bfops/orgs",
      "repos_url": "https://api.github.com/users/bfops/repos",
      "events_url": "https://api.github.com/users/bfops/events{/privacy}",
      "received_events_url": "https://api.github.com/users/bfops/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-08-19T04:57:51Z",
    "updated_at": "2014-08-19T04:57:51Z",
    "body": "It's especially strange-looking with closures:\n\n```\nstruct MutThing;\n\nimpl MutThing {\n  pub fn mut_thing(&mut self, _: ||) {}\n}\n\nstruct Foo {\n    x: MutThing,\n    y: int,\n}\n\nimpl Foo {\n    pub fn foo(&mut self) {\n        self.x.mut_thing(|| {\n          self.y = 1;\n        });\n    }\n}\n```\n\nEspecially when the solution is _manually_ borrowing the individual parts of the struct:\n\n```\nstruct MutThing;\n\nimpl MutThing {\n  pub fn mut_thing(&mut self, _: ||) {}\n}\n\nstruct Foo {\n    x: MutThing,\n    y: int,\n}\n\nimpl Foo {\n    pub fn foo(&mut self) {\n        let y = &mut self.y;\n        self.x.mut_thing(|| {\n          *y = 1;\n        });\n    }\n}\n```\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/52590533/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/71681223",
    "html_url": "https://github.com/rust-lang/rust/issues/16594#issuecomment-71681223",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/16594",
    "id": 71681223,
    "node_id": "MDEyOklzc3VlQ29tbWVudDcxNjgxMjIz",
    "user": {
      "login": "steveklabnik",
      "id": 27786,
      "node_id": "MDQ6VXNlcjI3Nzg2",
      "avatar_url": "https://avatars.githubusercontent.com/u/27786?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/steveklabnik",
      "html_url": "https://github.com/steveklabnik",
      "followers_url": "https://api.github.com/users/steveklabnik/followers",
      "following_url": "https://api.github.com/users/steveklabnik/following{/other_user}",
      "gists_url": "https://api.github.com/users/steveklabnik/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/steveklabnik/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/steveklabnik/subscriptions",
      "organizations_url": "https://api.github.com/users/steveklabnik/orgs",
      "repos_url": "https://api.github.com/users/steveklabnik/repos",
      "events_url": "https://api.github.com/users/steveklabnik/events{/privacy}",
      "received_events_url": "https://api.github.com/users/steveklabnik/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-01-27T16:45:41Z",
    "updated_at": "2015-01-27T16:45:41Z",
    "body": "Closing in favor of the refinement types RFC issue: https://github.com/rust-lang/rfcs/issues/671\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/71681223/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
