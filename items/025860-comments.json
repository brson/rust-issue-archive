[
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/106516431",
    "html_url": "https://github.com/rust-lang/rust/issues/25860#issuecomment-106516431",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/25860",
    "id": 106516431,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEwNjUxNjQzMQ==",
    "user": {
      "login": "aturon",
      "id": 709807,
      "node_id": "MDQ6VXNlcjcwOTgwNw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/709807?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/aturon",
      "html_url": "https://github.com/aturon",
      "followers_url": "https://api.github.com/users/aturon/followers",
      "following_url": "https://api.github.com/users/aturon/following{/other_user}",
      "gists_url": "https://api.github.com/users/aturon/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/aturon/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/aturon/subscriptions",
      "organizations_url": "https://api.github.com/users/aturon/orgs",
      "repos_url": "https://api.github.com/users/aturon/repos",
      "events_url": "https://api.github.com/users/aturon/events{/privacy}",
      "received_events_url": "https://api.github.com/users/aturon/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-05-28T17:40:09Z",
    "updated_at": "2015-05-28T17:40:09Z",
    "body": "What's going on here is that `foo` gets to assume that `'b: 'a`, but this isn't actually checked when producing `f`.\n\nThis assumption was thought to be valid because any nested reference type `&'a &'b T` has to guarantee it for well-formedness. But variance currently allows you to switch around the lifetimes before actually passing in the witnessing argument.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/106516431/reactions",
      "total_count": 2,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 1,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/106534778",
    "html_url": "https://github.com/rust-lang/rust/issues/25860#issuecomment-106534778",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/25860",
    "id": 106534778,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEwNjUzNDc3OA==",
    "user": {
      "login": "nikomatsakis",
      "id": 155238,
      "node_id": "MDQ6VXNlcjE1NTIzOA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/155238?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nikomatsakis",
      "html_url": "https://github.com/nikomatsakis",
      "followers_url": "https://api.github.com/users/nikomatsakis/followers",
      "following_url": "https://api.github.com/users/nikomatsakis/following{/other_user}",
      "gists_url": "https://api.github.com/users/nikomatsakis/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nikomatsakis/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nikomatsakis/subscriptions",
      "organizations_url": "https://api.github.com/users/nikomatsakis/orgs",
      "repos_url": "https://api.github.com/users/nikomatsakis/repos",
      "events_url": "https://api.github.com/users/nikomatsakis/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nikomatsakis/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-05-28T18:02:02Z",
    "updated_at": "2015-05-28T18:02:02Z",
    "body": "One solution is to be more aggressive about checking WFedness, but there are other options to consider.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/106534778/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/108069727",
    "html_url": "https://github.com/rust-lang/rust/issues/25860#issuecomment-108069727",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/25860",
    "id": 108069727,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEwODA2OTcyNw==",
    "user": {
      "login": "nikomatsakis",
      "id": 155238,
      "node_id": "MDQ6VXNlcjE1NTIzOA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/155238?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nikomatsakis",
      "html_url": "https://github.com/nikomatsakis",
      "followers_url": "https://api.github.com/users/nikomatsakis/followers",
      "following_url": "https://api.github.com/users/nikomatsakis/following{/other_user}",
      "gists_url": "https://api.github.com/users/nikomatsakis/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nikomatsakis/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nikomatsakis/subscriptions",
      "organizations_url": "https://api.github.com/users/nikomatsakis/orgs",
      "repos_url": "https://api.github.com/users/nikomatsakis/repos",
      "events_url": "https://api.github.com/users/nikomatsakis/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nikomatsakis/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-06-02T19:35:08Z",
    "updated_at": "2015-06-02T19:35:08Z",
    "body": "triage: P-high T-lang\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/108069727/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/108070120",
    "html_url": "https://github.com/rust-lang/rust/issues/25860#issuecomment-108070120",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/25860",
    "id": 108070120,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEwODA3MDEyMA==",
    "user": {
      "login": "nikomatsakis",
      "id": 155238,
      "node_id": "MDQ6VXNlcjE1NTIzOA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/155238?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nikomatsakis",
      "html_url": "https://github.com/nikomatsakis",
      "followers_url": "https://api.github.com/users/nikomatsakis/followers",
      "following_url": "https://api.github.com/users/nikomatsakis/following{/other_user}",
      "gists_url": "https://api.github.com/users/nikomatsakis/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nikomatsakis/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nikomatsakis/subscriptions",
      "organizations_url": "https://api.github.com/users/nikomatsakis/orgs",
      "repos_url": "https://api.github.com/users/nikomatsakis/repos",
      "events_url": "https://api.github.com/users/nikomatsakis/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nikomatsakis/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-06-02T19:35:50Z",
    "updated_at": "2015-06-02T19:35:50Z",
    "body": "I've been working on some proposal(s) that address this bug (among others), so assigning to me.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/108070120/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/112131183",
    "html_url": "https://github.com/rust-lang/rust/issues/25860#issuecomment-112131183",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/25860",
    "id": 112131183,
    "node_id": "MDEyOklzc3VlQ29tbWVudDExMjEzMTE4Mw==",
    "user": {
      "login": "nikomatsakis",
      "id": 155238,
      "node_id": "MDQ6VXNlcjE1NTIzOA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/155238?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nikomatsakis",
      "html_url": "https://github.com/nikomatsakis",
      "followers_url": "https://api.github.com/users/nikomatsakis/followers",
      "following_url": "https://api.github.com/users/nikomatsakis/following{/other_user}",
      "gists_url": "https://api.github.com/users/nikomatsakis/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nikomatsakis/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nikomatsakis/subscriptions",
      "organizations_url": "https://api.github.com/users/nikomatsakis/orgs",
      "repos_url": "https://api.github.com/users/nikomatsakis/repos",
      "events_url": "https://api.github.com/users/nikomatsakis/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nikomatsakis/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-06-15T16:41:23Z",
    "updated_at": "2015-06-15T16:41:23Z",
    "body": "There is a related problem that doesn't require variance on argument types. The current codebase doesn't check that the _expected_ argument type is well-formed, only the provided one, which is a subtype of the expected one. This is insufficient (but easily rectified).\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/112131183/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/144252242",
    "html_url": "https://github.com/rust-lang/rust/issues/25860#issuecomment-144252242",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/25860",
    "id": 144252242,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE0NDI1MjI0Mg==",
    "user": {
      "login": "Stebalien",
      "id": 310393,
      "node_id": "MDQ6VXNlcjMxMDM5Mw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/310393?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Stebalien",
      "html_url": "https://github.com/Stebalien",
      "followers_url": "https://api.github.com/users/Stebalien/followers",
      "following_url": "https://api.github.com/users/Stebalien/following{/other_user}",
      "gists_url": "https://api.github.com/users/Stebalien/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Stebalien/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Stebalien/subscriptions",
      "organizations_url": "https://api.github.com/users/Stebalien/orgs",
      "repos_url": "https://api.github.com/users/Stebalien/repos",
      "events_url": "https://api.github.com/users/Stebalien/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Stebalien/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-09-30T01:40:22Z",
    "updated_at": "2015-09-30T01:40:22Z",
    "body": "@nikomatsakis I believe you meant to close this.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/144252242/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/144507172",
    "html_url": "https://github.com/rust-lang/rust/issues/25860#issuecomment-144507172",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/25860",
    "id": 144507172,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE0NDUwNzE3Mg==",
    "user": {
      "login": "nikomatsakis",
      "id": 155238,
      "node_id": "MDQ6VXNlcjE1NTIzOA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/155238?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nikomatsakis",
      "html_url": "https://github.com/nikomatsakis",
      "followers_url": "https://api.github.com/users/nikomatsakis/followers",
      "following_url": "https://api.github.com/users/nikomatsakis/following{/other_user}",
      "gists_url": "https://api.github.com/users/nikomatsakis/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nikomatsakis/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nikomatsakis/subscriptions",
      "organizations_url": "https://api.github.com/users/nikomatsakis/orgs",
      "repos_url": "https://api.github.com/users/nikomatsakis/repos",
      "events_url": "https://api.github.com/users/nikomatsakis/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nikomatsakis/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-09-30T18:58:25Z",
    "updated_at": "2015-09-30T18:58:25Z",
    "body": "The work needed to close this has not yet landed. It's in the queue though, once we finish up rust-lang/rfcs#1214.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/144507172/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/144508698",
    "html_url": "https://github.com/rust-lang/rust/issues/25860#issuecomment-144508698",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/25860",
    "id": 144508698,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE0NDUwODY5OA==",
    "user": {
      "login": "Stebalien",
      "id": 310393,
      "node_id": "MDQ6VXNlcjMxMDM5Mw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/310393?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Stebalien",
      "html_url": "https://github.com/Stebalien",
      "followers_url": "https://api.github.com/users/Stebalien/followers",
      "following_url": "https://api.github.com/users/Stebalien/following{/other_user}",
      "gists_url": "https://api.github.com/users/Stebalien/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Stebalien/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Stebalien/subscriptions",
      "organizations_url": "https://api.github.com/users/Stebalien/orgs",
      "repos_url": "https://api.github.com/users/Stebalien/repos",
      "events_url": "https://api.github.com/users/Stebalien/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Stebalien/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-09-30T19:05:02Z",
    "updated_at": "2015-09-30T19:05:02Z",
    "body": "Sorry, I saw the commit but didn't notice that it hadn't been merged.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/144508698/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/173500980",
    "html_url": "https://github.com/rust-lang/rust/issues/25860#issuecomment-173500980",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/25860",
    "id": 173500980,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE3MzUwMDk4MA==",
    "user": {
      "login": "pnkfelix",
      "id": 173127,
      "node_id": "MDQ6VXNlcjE3MzEyNw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/173127?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/pnkfelix",
      "html_url": "https://github.com/pnkfelix",
      "followers_url": "https://api.github.com/users/pnkfelix/followers",
      "following_url": "https://api.github.com/users/pnkfelix/following{/other_user}",
      "gists_url": "https://api.github.com/users/pnkfelix/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/pnkfelix/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/pnkfelix/subscriptions",
      "organizations_url": "https://api.github.com/users/pnkfelix/orgs",
      "repos_url": "https://api.github.com/users/pnkfelix/repos",
      "events_url": "https://api.github.com/users/pnkfelix/events{/privacy}",
      "received_events_url": "https://api.github.com/users/pnkfelix/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2016-01-21T08:44:42Z",
    "updated_at": "2016-01-21T08:44:42Z",
    "body": "One interesting thing to note, in light of the new WF checks that have landed with the preliminary implementation of rust-lang/rfcs#1214, is that if we change the definition of `fn foo` like this (where we rewrite the implied lifetime bounds to be _explicitly_ stated in a where-clause  :\n\n``` rust\nfn foo<'a, 'b, T>(_: &'a &'b (), v: &'b T) -> &'a T where 'b: 'a { v }\n```\n\nthen it seems like the code is rejected properly.\n\nI am currently trying to puzzle through whether this kind of \"switch from implicit to explicit\", assuming it were done as a kind of desugaring by the compiler, if that would be effectively the same as \"remove support for contravariance\" from the language, or if it represents some other path...\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/173500980/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/173918580",
    "html_url": "https://github.com/rust-lang/rust/issues/25860#issuecomment-173918580",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/25860",
    "id": 173918580,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE3MzkxODU4MA==",
    "user": {
      "login": "pnkfelix",
      "id": 173127,
      "node_id": "MDQ6VXNlcjE3MzEyNw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/173127?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/pnkfelix",
      "html_url": "https://github.com/pnkfelix",
      "followers_url": "https://api.github.com/users/pnkfelix/followers",
      "following_url": "https://api.github.com/users/pnkfelix/following{/other_user}",
      "gists_url": "https://api.github.com/users/pnkfelix/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/pnkfelix/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/pnkfelix/subscriptions",
      "organizations_url": "https://api.github.com/users/pnkfelix/orgs",
      "repos_url": "https://api.github.com/users/pnkfelix/repos",
      "events_url": "https://api.github.com/users/pnkfelix/events{/privacy}",
      "received_events_url": "https://api.github.com/users/pnkfelix/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2016-01-22T13:20:04Z",
    "updated_at": "2016-01-22T13:20:28Z",
    "body": "Here's a variation on the original example that retains explicit types (rather than resorting to `_` as a type like I did in the description):\n\n``` rust\nfn foo<'a, 'b, T>(_false_witness: Option<&'a &'b ()>, v: &'b T) -> &'a T { v }\n\nfn bad<'c, 'd, T>(x: &'c T) -> &'d T {\n    // below is using contravariance to assign `foo` to `f`,\n    // side-stepping the obligation to prove `'c: 'd`\n    // implicit in the original `fn foo`.\n    let f: fn(Option<&'d &'d ()>, &'c T) -> &'d T = foo;\n    f(None, x)\n}\n\nfn main() {\n    fn inner() -> &'static String {\n        bad(&format!(\"hello\"))\n    }\n\n    let x = inner();\n    println!(\"x: {}\", x);\n}\n```\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/173918580/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/173924401",
    "html_url": "https://github.com/rust-lang/rust/issues/25860#issuecomment-173924401",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/25860",
    "id": 173924401,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE3MzkyNDQwMQ==",
    "user": {
      "login": "pnkfelix",
      "id": 173127,
      "node_id": "MDQ6VXNlcjE3MzEyNw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/173127?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/pnkfelix",
      "html_url": "https://github.com/pnkfelix",
      "followers_url": "https://api.github.com/users/pnkfelix/followers",
      "following_url": "https://api.github.com/users/pnkfelix/following{/other_user}",
      "gists_url": "https://api.github.com/users/pnkfelix/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/pnkfelix/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/pnkfelix/subscriptions",
      "organizations_url": "https://api.github.com/users/pnkfelix/orgs",
      "repos_url": "https://api.github.com/users/pnkfelix/repos",
      "events_url": "https://api.github.com/users/pnkfelix/events{/privacy}",
      "received_events_url": "https://api.github.com/users/pnkfelix/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2016-01-22T13:42:53Z",
    "updated_at": "2016-01-22T13:42:53Z",
    "body": "> I am currently trying to puzzle through whether this kind of \"switch from implicit to explicit\", assuming it were done as a kind of desugaring by the compiler, if that would be effectively the same as \"remove support for contravariance\" from the language\n\nAfter some reflection, I think this does represent a (perhaps appropriately) _weakened_ variation on \"remove contravariance from the language\"\n\nIn particular, if we did the desugaring right (where implied lifetime bounds from a `fn`-signature would get transformed into where clauses on the `fn`), then we could still have useful contravariance for `fn`'s that have _no such_ implied bounds.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/173924401/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/173926193",
    "html_url": "https://github.com/rust-lang/rust/issues/25860#issuecomment-173926193",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/25860",
    "id": 173926193,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE3MzkyNjE5Mw==",
    "user": {
      "login": "pnkfelix",
      "id": 173127,
      "node_id": "MDQ6VXNlcjE3MzEyNw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/173127?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/pnkfelix",
      "html_url": "https://github.com/pnkfelix",
      "followers_url": "https://api.github.com/users/pnkfelix/followers",
      "following_url": "https://api.github.com/users/pnkfelix/following{/other_user}",
      "gists_url": "https://api.github.com/users/pnkfelix/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/pnkfelix/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/pnkfelix/subscriptions",
      "organizations_url": "https://api.github.com/users/pnkfelix/orgs",
      "repos_url": "https://api.github.com/users/pnkfelix/repos",
      "events_url": "https://api.github.com/users/pnkfelix/events{/privacy}",
      "received_events_url": "https://api.github.com/users/pnkfelix/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2016-01-22T13:51:43Z",
    "updated_at": "2016-01-22T13:51:43Z",
    "body": "as an aside, part of me does think that it would be _better_ if we also added some way to write the proposed implied `where`-clauses explicitly as part of the `fn`-type.  I.e. if you consider the following example:\n\n``` rust\nfn bad<'a, 'b>(g: fn (&'a &'b i32) -> i32) {\n    let _f: fn(x: &'b &'b i32) -> i32 = g;\n}\n```\n\nunder my imagined new system, the above assignment of `g` to `_f` would be illegal, due to the implied bounds attached to `g` (that are not part of the type of `_f`).\n\nBut it might be nice if we could actually _write_:\n\n``` rust\nfn explicit_types<'a, 'b>(callback: fn (&'a i32, &'b i32) -> i32 where 'a: 'b) {\n    ...\n}\n```\n\n(note that the `where` clause there is part of the type of `callback`)\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/173926193/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/173960173",
    "html_url": "https://github.com/rust-lang/rust/issues/25860#issuecomment-173960173",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/25860",
    "id": 173960173,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE3Mzk2MDE3Mw==",
    "user": {
      "login": "RalfJung",
      "id": 330628,
      "node_id": "MDQ6VXNlcjMzMDYyOA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/330628?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/RalfJung",
      "html_url": "https://github.com/RalfJung",
      "followers_url": "https://api.github.com/users/RalfJung/followers",
      "following_url": "https://api.github.com/users/RalfJung/following{/other_user}",
      "gists_url": "https://api.github.com/users/RalfJung/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/RalfJung/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/RalfJung/subscriptions",
      "organizations_url": "https://api.github.com/users/RalfJung/orgs",
      "repos_url": "https://api.github.com/users/RalfJung/repos",
      "events_url": "https://api.github.com/users/RalfJung/events{/privacy}",
      "received_events_url": "https://api.github.com/users/RalfJung/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2016-01-22T15:55:27Z",
    "updated_at": "2016-01-22T15:55:43Z",
    "body": "I take it from your comments that removing or restricting the variance is actually considered as a solution to this?\n\nThat's surprising me. I cannot see variance at fault here. The observation underlying the issue is that implicit bounds are not properly preserved under variance. The most obvious solution (for me, anyways) would be to make the implicit bounds explicit: If \"fn foo<'a, 'b, T>(&'a &'b (), &'b T) -> &'a T\" would be considered mere syntactic sugar for \"fn foo<'a, 'b, T>(&'a &'b (), &'b T) -> &'a T where 'b: 'a, 'a: 'fn, T: 'b\" (using `'fn` for the lifetime of the function), and from then on the checks are preserved and adapted appropriately when applying variance or specializing lifetimes, wouldn't that also catch the trouble? (Making implied bounds explicit was also discussed in https://github.com/rust-lang/rfcs/pull/1327, since implied bounds are also a trouble for drop safety.)\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/173960173/reactions",
      "total_count": 2,
      "+1": 2,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/173964458",
    "html_url": "https://github.com/rust-lang/rust/issues/25860#issuecomment-173964458",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/25860",
    "id": 173964458,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE3Mzk2NDQ1OA==",
    "user": {
      "login": "pnkfelix",
      "id": 173127,
      "node_id": "MDQ6VXNlcjE3MzEyNw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/173127?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/pnkfelix",
      "html_url": "https://github.com/pnkfelix",
      "followers_url": "https://api.github.com/users/pnkfelix/followers",
      "following_url": "https://api.github.com/users/pnkfelix/following{/other_user}",
      "gists_url": "https://api.github.com/users/pnkfelix/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/pnkfelix/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/pnkfelix/subscriptions",
      "organizations_url": "https://api.github.com/users/pnkfelix/orgs",
      "repos_url": "https://api.github.com/users/pnkfelix/repos",
      "events_url": "https://api.github.com/users/pnkfelix/events{/privacy}",
      "received_events_url": "https://api.github.com/users/pnkfelix/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2016-01-22T16:12:06Z",
    "updated_at": "2016-01-22T16:16:25Z",
    "body": "@RalfJung \n\n> I cannot see variance at fault here.\n\nI've been saying the similar things to @nikomatsakis \n\nBut the first step for me was to encode the test case in a way that made made it apparent (at least to me) that contravariance is (part of) why we are seeing this happen.\n\nI think that https://github.com/rust-lang/rust/issues/25860#issuecomment-173926193 is very much the same as what you are describing: 1. Ensure the implicit bounds are actually part of the `fn`-type itself (even if most users will not write the associated `where` clause explicitly) and are checked before allowing any calls to a value of a given `fn`-type, and then 2. fix the subtyping relation between `fn`-types to ensure that such `where`-clauses are preserved.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/173964458/reactions",
      "total_count": 2,
      "+1": 2,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/173965523",
    "html_url": "https://github.com/rust-lang/rust/issues/25860#issuecomment-173965523",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/25860",
    "id": 173965523,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE3Mzk2NTUyMw==",
    "user": {
      "login": "RalfJung",
      "id": 330628,
      "node_id": "MDQ6VXNlcjMzMDYyOA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/330628?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/RalfJung",
      "html_url": "https://github.com/RalfJung",
      "followers_url": "https://api.github.com/users/RalfJung/followers",
      "following_url": "https://api.github.com/users/RalfJung/following{/other_user}",
      "gists_url": "https://api.github.com/users/RalfJung/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/RalfJung/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/RalfJung/subscriptions",
      "organizations_url": "https://api.github.com/users/RalfJung/orgs",
      "repos_url": "https://api.github.com/users/RalfJung/repos",
      "events_url": "https://api.github.com/users/RalfJung/events{/privacy}",
      "received_events_url": "https://api.github.com/users/RalfJung/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2016-01-22T16:16:04Z",
    "updated_at": "2016-01-22T16:16:04Z",
    "body": "> I think that #25860 (comment) is very much the same as what you are describing: 1. Ensure the implicit bounds are actually part of the fn-type itself (even if most users will not write the associated where clause explicitly) and are checked before allowing any calls to a value of a given fn-type, and then 2. fix the subtyping relation between fn-types to ensure that such wshere-clauses are preserved.\n\nYes, that sounds like we're talking about the same idea.\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/173965523/reactions",
      "total_count": 2,
      "+1": 2,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/174011431",
    "html_url": "https://github.com/rust-lang/rust/issues/25860#issuecomment-174011431",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/25860",
    "id": 174011431,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE3NDAxMTQzMQ==",
    "user": {
      "login": "nikomatsakis",
      "id": 155238,
      "node_id": "MDQ6VXNlcjE1NTIzOA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/155238?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nikomatsakis",
      "html_url": "https://github.com/nikomatsakis",
      "followers_url": "https://api.github.com/users/nikomatsakis/followers",
      "following_url": "https://api.github.com/users/nikomatsakis/following{/other_user}",
      "gists_url": "https://api.github.com/users/nikomatsakis/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nikomatsakis/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nikomatsakis/subscriptions",
      "organizations_url": "https://api.github.com/users/nikomatsakis/orgs",
      "repos_url": "https://api.github.com/users/nikomatsakis/repos",
      "events_url": "https://api.github.com/users/nikomatsakis/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nikomatsakis/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2016-01-22T18:55:21Z",
    "updated_at": "2016-01-22T18:55:21Z",
    "body": "I do not consider the problem to be fundamentally about contravariance -- but I do consider removing contravariance from fn arguments to be a pragmatic way to solve the problem, at least in the short term. In one of the drafts for RFC rust-lang/rfcs#1214, I wrote [the section pasted below](https://github.com/nikomatsakis/rfcs/blob/sionara-contravariance/text/0000-wf-and-variance.md#appendix-forwhere-an-alternative-view), which I think is a good explanation of the problem as I understand it:\n\n### Appendix: for/where, an alternative view\n\nThe natural generalization of our current `fn` types is adding the ability to attach arbitrary where clauses to higher-ranked types. That is, a type like `for<'a,'b> fn(&'a &'b T)` might be written out more explicitly by adding the implied bounds as explicit where-clauses attached to the `for`:\n\n```\nfor<'a,'b> where<'b:'a, T:'b> fn(&'a &'b T)\n```\n\nThese where-clauses must be discharged before the fn can be called. They can also be discharged through subtyping, if no higher-ranked regions are involved: that is, there might be a typing rule that allows a where clause to be dropped from the type so long as it can be proven in the current environment (similarly, having fewer where clauses would be a subtype of having more.)\n\nYou can view the current notion of implied bounds as being a more limited form of this formalism where the `where` clauses are exactly the implied bounds of the argument types. However, making the `where` clauses explicit has some advantages, because it means that one can vary the types of the arguments (via contravariance) while leaving the where clauses intact.\n\nFor example, if you had a function:\n\n```\nfn foo<'a,'b,T>(&'a &'b T) { ... }\n```\n\nUnder this RFC, the type of this function is:\n\n```\nfor<'a,'b> fn(&'a &'b T)\n```\n\nUnder the for/where scheme, the full type would be:\n\n```\nfor<'a,'b> where<'b:'a, T:'b> fn(&'a &'b T)\n```\n\nNow, if we upcast this type to only accept static data as argument, the where clauses are unaffected:\n\n```\nfor<'a,'b> where<'b:'a, T:'b> fn(&'static &'static T)\n```\n\nViewed this way, we can see why the current fn types (in which one cannot write where clauses explicitly) are invariant: changing the argument types is fine, but it also changes the where clauses, and the new where clauses are not a superset of the old ones, so the subtyping relation does not hold. That is, if we write out the implicit where clauses that result implicitly, we can see why variance on fns causes problems:\n\n```\nfor<'a,'b> where<'b:'a, T:'b> fn(&'a &'b T, &'b T) -> &'a T \n<:\nfor<'a,'b> fn(&'static &'static T, &'b T) -> &'a T\n? (today yes, under this RFC no)\n```\n\nClearly, this subtype relationship should not hold, because the where clauses in the subtype are not implied by the supertype.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/174011431/reactions",
      "total_count": 2,
      "+1": 2,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/174044553",
    "html_url": "https://github.com/rust-lang/rust/issues/25860#issuecomment-174044553",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/25860",
    "id": 174044553,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE3NDA0NDU1Mw==",
    "user": {
      "login": "arielb1",
      "id": 1830974,
      "node_id": "MDQ6VXNlcjE4MzA5NzQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1830974?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/arielb1",
      "html_url": "https://github.com/arielb1",
      "followers_url": "https://api.github.com/users/arielb1/followers",
      "following_url": "https://api.github.com/users/arielb1/following{/other_user}",
      "gists_url": "https://api.github.com/users/arielb1/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/arielb1/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/arielb1/subscriptions",
      "organizations_url": "https://api.github.com/users/arielb1/orgs",
      "repos_url": "https://api.github.com/users/arielb1/repos",
      "events_url": "https://api.github.com/users/arielb1/events{/privacy}",
      "received_events_url": "https://api.github.com/users/arielb1/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2016-01-22T20:56:54Z",
    "updated_at": "2016-01-22T20:56:54Z",
    "body": "To make the point clearer, the principal part of the issue involves higher-ranked types. The rank 0 issue should not be that hard to solve (by requiring WF when instantiating a function - I am a bit surprised we don't do so already).\n\nAn example of the problem path (I am intentionally making the problem binder separate from the problem where-clause-container):\n\n``` Rust\n\nfn foo<'a, 'b, T>() -> fn(Option<&'a &'b ()>, &'b T) -> &'a T {\n    fn foo_inner<'a, 'b, T>(_witness: Option<&'a &'b ()>, v: &'b T) -> &'a T {\n        v\n    }\n    foo_inner\n}\n\nfn bad<'c, 'd, T>(x: &'c T) -> &'d T {\n    // instantiate `foo`\n    let foo1: for<'a, 'b> fn() -> fn(Option<&'a &'b ()>, &'b T) -> &'a T = foo;\n    // subtyping: instantiate `'b <- 'c`\n    let foo2: for<'a> fn() -> fn(Option<&'a &'c ()>, &'c T) -> &'a T = foo1;\n    // subtyping: contravariantly 'c becomes 'static\n    let foo3: for<'a> fn() -> fn(Option<&'a &'static ()>, &'c T) -> &'a T = foo2;\n    // subtyping: instantiate `'a <- 'd`\n    let foo4: fn() -> fn(Option<&'d &'static ()>, &'c T) -> &'d T = foo3;\n    // boom!\n    foo4()(None, x)\n}\n\nfn main() {\n    fn inner() -> &'static String {\n        bad(&format!(\"hello\"))\n    }\n\n    let x = inner();\n    println!(\"x: {}\", x);\n}\n```\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/174044553/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/228108197",
    "html_url": "https://github.com/rust-lang/rust/issues/25860#issuecomment-228108197",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/25860",
    "id": 228108197,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIyODEwODE5Nw==",
    "user": {
      "login": "brson",
      "id": 147214,
      "node_id": "MDQ6VXNlcjE0NzIxNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/brson",
      "html_url": "https://github.com/brson",
      "followers_url": "https://api.github.com/users/brson/followers",
      "following_url": "https://api.github.com/users/brson/following{/other_user}",
      "gists_url": "https://api.github.com/users/brson/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/brson/subscriptions",
      "organizations_url": "https://api.github.com/users/brson/orgs",
      "repos_url": "https://api.github.com/users/brson/repos",
      "events_url": "https://api.github.com/users/brson/events{/privacy}",
      "received_events_url": "https://api.github.com/users/brson/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2016-06-23T16:37:27Z",
    "updated_at": "2016-06-23T16:37:27Z",
    "body": "@rust-lang/lang no activity in a while. Still P-high? Anybody working on it or can we lower it?\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/228108197/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/228190584",
    "html_url": "https://github.com/rust-lang/rust/issues/25860#issuecomment-228190584",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/25860",
    "id": 228190584,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIyODE5MDU4NA==",
    "user": {
      "login": "pnkfelix",
      "id": 173127,
      "node_id": "MDQ6VXNlcjE3MzEyNw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/173127?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/pnkfelix",
      "html_url": "https://github.com/pnkfelix",
      "followers_url": "https://api.github.com/users/pnkfelix/followers",
      "following_url": "https://api.github.com/users/pnkfelix/following{/other_user}",
      "gists_url": "https://api.github.com/users/pnkfelix/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/pnkfelix/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/pnkfelix/subscriptions",
      "organizations_url": "https://api.github.com/users/pnkfelix/orgs",
      "repos_url": "https://api.github.com/users/pnkfelix/repos",
      "events_url": "https://api.github.com/users/pnkfelix/events{/privacy}",
      "received_events_url": "https://api.github.com/users/pnkfelix/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2016-06-23T21:31:57Z",
    "updated_at": "2016-06-23T21:31:57Z",
    "body": "(this issue really wants input from @nikomatsakis )\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/228190584/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/229982840",
    "html_url": "https://github.com/rust-lang/rust/issues/25860#issuecomment-229982840",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/25860",
    "id": 229982840,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIyOTk4Mjg0MA==",
    "user": {
      "login": "nikomatsakis",
      "id": 155238,
      "node_id": "MDQ6VXNlcjE1NTIzOA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/155238?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nikomatsakis",
      "html_url": "https://github.com/nikomatsakis",
      "followers_url": "https://api.github.com/users/nikomatsakis/followers",
      "following_url": "https://api.github.com/users/nikomatsakis/following{/other_user}",
      "gists_url": "https://api.github.com/users/nikomatsakis/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nikomatsakis/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nikomatsakis/subscriptions",
      "organizations_url": "https://api.github.com/users/nikomatsakis/orgs",
      "repos_url": "https://api.github.com/users/nikomatsakis/repos",
      "events_url": "https://api.github.com/users/nikomatsakis/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nikomatsakis/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2016-07-01T15:54:59Z",
    "updated_at": "2016-07-01T15:54:59Z",
    "body": "I think we need to make progress on this issue, but I've been saying that for a year and we haven't. I would put this on the list of \"important soundness issues\" to address but I'm not sure how to prioritize that work in general relative to other tasks.\n\nAs far as the range of possible fixes I think nothing has changed from [this previous comment](https://github.com/rust-lang/rust/issues/25860#issuecomment-174011431):\n- We can ban contravariance, at least for fn arguments.\n- We can make `for` carry a notion of bounds, at least internally. \n\nFrom a purely theoretical point-of-view, I would prefer the latter but I am wary of trying to implement it. It seems obvious that it will be hard to do in a complete way if we are talking about arbitrary sets of bounds. On the other hand, it may be that if we are just talking about _implied bounds_, we can implement the checks in a pretty simple way, since the bounds in question will have particular forms. I've been meaning to take some time and think about this more -- I think that some of the work being done for lazy normalization may help here -- but I've not really done so.\n\nAs far as the user-visible language changes that would result, removing contravariance for fn args is a nice simplification, but it is almost certainly more backwards incompatible than something based on making `for` carry a notion of bounds. When I first checked, the impact was small, but we have tarried quite some time and I don't know if that is still true.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/229982840/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/231212140",
    "html_url": "https://github.com/rust-lang/rust/issues/25860#issuecomment-231212140",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/25860",
    "id": 231212140,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIzMTIxMjE0MA==",
    "user": {
      "login": "aturon",
      "id": 709807,
      "node_id": "MDQ6VXNlcjcwOTgwNw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/709807?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/aturon",
      "html_url": "https://github.com/aturon",
      "followers_url": "https://api.github.com/users/aturon/followers",
      "following_url": "https://api.github.com/users/aturon/following{/other_user}",
      "gists_url": "https://api.github.com/users/aturon/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/aturon/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/aturon/subscriptions",
      "organizations_url": "https://api.github.com/users/aturon/orgs",
      "repos_url": "https://api.github.com/users/aturon/repos",
      "events_url": "https://api.github.com/users/aturon/events{/privacy}",
      "received_events_url": "https://api.github.com/users/aturon/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2016-07-07T21:25:47Z",
    "updated_at": "2016-07-07T21:25:47Z",
    "body": "The lang team met and determined that we should move to P-medium; no one is going to close this in the near future, but we want to keep it on the radar.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/231212140/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/283955348",
    "html_url": "https://github.com/rust-lang/rust/issues/25860#issuecomment-283955348",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/25860",
    "id": 283955348,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI4Mzk1NTM0OA==",
    "user": {
      "login": "nikomatsakis",
      "id": 155238,
      "node_id": "MDQ6VXNlcjE1NTIzOA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/155238?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nikomatsakis",
      "html_url": "https://github.com/nikomatsakis",
      "followers_url": "https://api.github.com/users/nikomatsakis/followers",
      "following_url": "https://api.github.com/users/nikomatsakis/following{/other_user}",
      "gists_url": "https://api.github.com/users/nikomatsakis/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nikomatsakis/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nikomatsakis/subscriptions",
      "organizations_url": "https://api.github.com/users/nikomatsakis/orgs",
      "repos_url": "https://api.github.com/users/nikomatsakis/repos",
      "events_url": "https://api.github.com/users/nikomatsakis/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nikomatsakis/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2017-03-03T13:40:58Z",
    "updated_at": "2017-03-03T13:40:58Z",
    "body": "After some further thought -- and in particular working more on chalk -- I have started to have some hope that we would be able to close this using the [more principled approach described here](https://github.com/rust-lang/rust/issues/25860#issuecomment-174011431). Basically the idea would be that `for<'a> fn(...)` has \"implied bounds\" that are sufficient to make the `fn` well-formed, and that when we upcast we have to prove an \"entailment\" for the type that we are casting to. I used to be afraid of this entailment but I am... less afraid now. =) More investigation needed, of course.",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/283955348/reactions",
      "total_count": 2,
      "+1": 2,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/515747670",
    "html_url": "https://github.com/rust-lang/rust/issues/25860#issuecomment-515747670",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/25860",
    "id": 515747670,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUxNTc0NzY3MA==",
    "user": {
      "login": "RalfJung",
      "id": 330628,
      "node_id": "MDQ6VXNlcjMzMDYyOA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/330628?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/RalfJung",
      "html_url": "https://github.com/RalfJung",
      "followers_url": "https://api.github.com/users/RalfJung/followers",
      "following_url": "https://api.github.com/users/RalfJung/following{/other_user}",
      "gists_url": "https://api.github.com/users/RalfJung/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/RalfJung/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/RalfJung/subscriptions",
      "organizations_url": "https://api.github.com/users/RalfJung/orgs",
      "repos_url": "https://api.github.com/users/RalfJung/repos",
      "events_url": "https://api.github.com/users/RalfJung/events{/privacy}",
      "received_events_url": "https://api.github.com/users/RalfJung/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2019-07-28T09:29:31Z",
    "updated_at": "2019-07-28T09:29:31Z",
    "body": "Cc https://crates.io/crates/fake-static",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/515747670/reactions",
      "total_count": 138,
      "+1": 11,
      "-1": 1,
      "laugh": 30,
      "hooray": 14,
      "confused": 17,
      "heart": 26,
      "rocket": 9,
      "eyes": 30
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/821923996",
    "html_url": "https://github.com/rust-lang/rust/issues/25860#issuecomment-821923996",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/25860",
    "id": 821923996,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgyMTkyMzk5Ng==",
    "user": {
      "login": "XX",
      "id": 320976,
      "node_id": "MDQ6VXNlcjMyMDk3Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/320976?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/XX",
      "html_url": "https://github.com/XX",
      "followers_url": "https://api.github.com/users/XX/followers",
      "following_url": "https://api.github.com/users/XX/following{/other_user}",
      "gists_url": "https://api.github.com/users/XX/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/XX/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/XX/subscriptions",
      "organizations_url": "https://api.github.com/users/XX/orgs",
      "repos_url": "https://api.github.com/users/XX/repos",
      "events_url": "https://api.github.com/users/XX/events{/privacy}",
      "received_events_url": "https://api.github.com/users/XX/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2021-04-18T03:20:17Z",
    "updated_at": "2021-04-18T03:20:17Z",
    "body": "What is the current status of fixing this bug? Rust-haters use this hole to demonstrate that the language is not safe.",
    "author_association": "NONE",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/821923996/reactions",
      "total_count": 22,
      "+1": 0,
      "-1": 0,
      "laugh": 22,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/821930152",
    "html_url": "https://github.com/rust-lang/rust/issues/25860#issuecomment-821930152",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/25860",
    "id": 821930152,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgyMTkzMDE1Mg==",
    "user": {
      "login": "ssokolow",
      "id": 46915,
      "node_id": "MDQ6VXNlcjQ2OTE1",
      "avatar_url": "https://avatars.githubusercontent.com/u/46915?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ssokolow",
      "html_url": "https://github.com/ssokolow",
      "followers_url": "https://api.github.com/users/ssokolow/followers",
      "following_url": "https://api.github.com/users/ssokolow/following{/other_user}",
      "gists_url": "https://api.github.com/users/ssokolow/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ssokolow/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ssokolow/subscriptions",
      "organizations_url": "https://api.github.com/users/ssokolow/orgs",
      "repos_url": "https://api.github.com/users/ssokolow/repos",
      "events_url": "https://api.github.com/users/ssokolow/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ssokolow/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2021-04-18T04:24:50Z",
    "updated_at": "2021-04-18T04:24:50Z",
    "body": "@XX This one specifically? As someone with no background in programming language theory, I'm curious what makes this one so special.",
    "author_association": "NONE",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/821930152/reactions",
      "total_count": 2,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 2,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/821954686",
    "html_url": "https://github.com/rust-lang/rust/issues/25860#issuecomment-821954686",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/25860",
    "id": 821954686,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgyMTk1NDY4Ng==",
    "user": {
      "login": "RalfJung",
      "id": 330628,
      "node_id": "MDQ6VXNlcjMzMDYyOA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/330628?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/RalfJung",
      "html_url": "https://github.com/RalfJung",
      "followers_url": "https://api.github.com/users/RalfJung/followers",
      "following_url": "https://api.github.com/users/RalfJung/following{/other_user}",
      "gists_url": "https://api.github.com/users/RalfJung/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/RalfJung/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/RalfJung/subscriptions",
      "organizations_url": "https://api.github.com/users/RalfJung/orgs",
      "repos_url": "https://api.github.com/users/RalfJung/repos",
      "events_url": "https://api.github.com/users/RalfJung/events{/privacy}",
      "received_events_url": "https://api.github.com/users/RalfJung/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2021-04-18T08:30:13Z",
    "updated_at": "2021-04-18T08:30:13Z",
    "body": "I don't think there was any progress, unfortunately.\r\n\r\nThat said, haters gonna hate -- I don't think that is a healthy reason to do anything.^^ There are much better reasons.\r\n\r\n> As someone with no background in programming language theory, I'm curious what makes this one so special.\r\n\r\nAs someone with background in PL theory, I don't know. ;) I assume it's just because it's one of the oldest still-unresolved soundness bugs.",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/821954686/reactions",
      "total_count": 7,
      "+1": 7,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/824166236",
    "html_url": "https://github.com/rust-lang/rust/issues/25860#issuecomment-824166236",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/25860",
    "id": 824166236,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgyNDE2NjIzNg==",
    "user": {
      "login": "stanislav-tkach",
      "id": 2997902,
      "node_id": "MDQ6VXNlcjI5OTc5MDI=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2997902?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/stanislav-tkach",
      "html_url": "https://github.com/stanislav-tkach",
      "followers_url": "https://api.github.com/users/stanislav-tkach/followers",
      "following_url": "https://api.github.com/users/stanislav-tkach/following{/other_user}",
      "gists_url": "https://api.github.com/users/stanislav-tkach/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/stanislav-tkach/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/stanislav-tkach/subscriptions",
      "organizations_url": "https://api.github.com/users/stanislav-tkach/orgs",
      "repos_url": "https://api.github.com/users/stanislav-tkach/repos",
      "events_url": "https://api.github.com/users/stanislav-tkach/events{/privacy}",
      "received_events_url": "https://api.github.com/users/stanislav-tkach/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2021-04-21T15:46:07Z",
    "updated_at": "2021-04-21T15:46:07Z",
    "body": "I have also seen code snippets exploiting this issue as a response for \"safe rust guaranties...\" claims more than once.\r\n\r\n> I assume it's just because it's one of the oldest still-unresolved soundness bugs.\r\n\r\nI guess this is true. Personally, I also think that having this issue open for five years is kind of disturbing. :upside_down_face: ",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/824166236/reactions",
      "total_count": 31,
      "+1": 31,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/1014100054",
    "html_url": "https://github.com/rust-lang/rust/issues/25860#issuecomment-1014100054",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/25860",
    "id": 1014100054,
    "node_id": "IC_kwDOAAsO6M48cfBW",
    "user": {
      "login": "Cerber-Ursi",
      "id": 12300861,
      "node_id": "MDQ6VXNlcjEyMzAwODYx",
      "avatar_url": "https://avatars.githubusercontent.com/u/12300861?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Cerber-Ursi",
      "html_url": "https://github.com/Cerber-Ursi",
      "followers_url": "https://api.github.com/users/Cerber-Ursi/followers",
      "following_url": "https://api.github.com/users/Cerber-Ursi/following{/other_user}",
      "gists_url": "https://api.github.com/users/Cerber-Ursi/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Cerber-Ursi/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Cerber-Ursi/subscriptions",
      "organizations_url": "https://api.github.com/users/Cerber-Ursi/orgs",
      "repos_url": "https://api.github.com/users/Cerber-Ursi/repos",
      "events_url": "https://api.github.com/users/Cerber-Ursi/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Cerber-Ursi/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2022-01-17T03:15:40Z",
    "updated_at": "2022-01-17T03:15:40Z",
    "body": "Bumping an issue, since it was found [(link to the corresponding URLO post)](https://users.rust-lang.org/t/negative-views-on-rust-language-based-operating-systems/70449/26) that this problem allows one to easily write `transmute` in safe code (without any IO, like `totally_safe_transmute` does, only by exploiting the soundness hole).",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/1014100054/reactions",
      "total_count": 11,
      "+1": 11,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/1030647473",
    "html_url": "https://github.com/rust-lang/rust/issues/25860#issuecomment-1030647473",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/25860",
    "id": 1030647473,
    "node_id": "IC_kwDOAAsO6M49bm6x",
    "user": {
      "login": "lcnr",
      "id": 29864074,
      "node_id": "MDQ6VXNlcjI5ODY0MDc0",
      "avatar_url": "https://avatars.githubusercontent.com/u/29864074?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/lcnr",
      "html_url": "https://github.com/lcnr",
      "followers_url": "https://api.github.com/users/lcnr/followers",
      "following_url": "https://api.github.com/users/lcnr/following{/other_user}",
      "gists_url": "https://api.github.com/users/lcnr/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/lcnr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/lcnr/subscriptions",
      "organizations_url": "https://api.github.com/users/lcnr/orgs",
      "repos_url": "https://api.github.com/users/lcnr/repos",
      "events_url": "https://api.github.com/users/lcnr/events{/privacy}",
      "received_events_url": "https://api.github.com/users/lcnr/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2022-02-05T15:45:31Z",
    "updated_at": "2024-04-01T04:24:00Z",
    "body": "wrote a blog post summarizing this issue and adding an example why I believe removing contravariance is not enough to fix this bug.\r\n\r\nhttps://lcnr.de/blog/2022/02/05/diving-deep-implied-bounds-and-variance.html",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/1030647473/reactions",
      "total_count": 14,
      "+1": 13,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 1,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/1030766729",
    "html_url": "https://github.com/rust-lang/rust/issues/25860#issuecomment-1030766729",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/25860",
    "id": 1030766729,
    "node_id": "IC_kwDOAAsO6M49cECJ",
    "user": {
      "login": "crlf0710",
      "id": 451806,
      "node_id": "MDQ6VXNlcjQ1MTgwNg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/451806?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/crlf0710",
      "html_url": "https://github.com/crlf0710",
      "followers_url": "https://api.github.com/users/crlf0710/followers",
      "following_url": "https://api.github.com/users/crlf0710/following{/other_user}",
      "gists_url": "https://api.github.com/users/crlf0710/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/crlf0710/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/crlf0710/subscriptions",
      "organizations_url": "https://api.github.com/users/crlf0710/orgs",
      "repos_url": "https://api.github.com/users/crlf0710/repos",
      "events_url": "https://api.github.com/users/crlf0710/events{/privacy}",
      "received_events_url": "https://api.github.com/users/crlf0710/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2022-02-06T07:07:59Z",
    "updated_at": "2022-02-06T07:57:21Z",
    "body": "I took a brief look into this issue, and it seems rust language contravariance rules and borrow checker can do the needed detection.\r\n\r\nHere's my inspection, i'm using `arielb`'s example code as starting point. It's obvious that the first incorrect cast is the foo2 to foo3 conversion.\r\n```rust\r\nfn bad<'c, 'd, T>(x: &'c T) -> &'d T {\r\n    // instantiate `foo`\r\n    let foo1: for<'a, 'b> fn() -> fn(Option<&'a &'b ()>, &'b T) -> &'a T = foo;\r\n    // subtyping: instantiate `'b <- 'c`\r\n    let foo2: for<'a> fn() -> fn(Option<&'a &'c ()>, &'c T) -> &'a T = foo1;\r\n    // subtyping: contravariantly 'c becomes 'static\r\n    let foo3: for<'a> fn() -> fn(Option<&'a &'static ()>, &'c T) -> &'a T = foo2;\r\n    // subtyping: instantiate `'a <- 'd`\r\n    let foo4: fn() -> fn(Option<&'d &'static ()>, &'c T) -> &'d T = foo3;\r\n    // boom!\r\n    foo4()(None, x)\r\n}\r\n```\r\n\r\nSo, i implement my fake function pointer type, my own fake `FnOnce` trait(for simplicity, i removed `Output`), and separated the early and late generics parameters and bounds manually. And I use `&dyn FnOnce` to demostrate. The code is something like this:\r\n```rust\r\nuse std::marker::PhantomData;\r\n\r\nstruct Foo<T>(PhantomData<T>);\r\ntrait MyFnOnce<Args> {}\r\nimpl<'a, 'c, T: 'c> MyFnOnce<(&'a &'c (), &'c T)> for Foo<T> {}\r\n\r\n// this compiles\r\nfn good<'c, T: 'c>() {\r\n    let foo2: &dyn for<'a> MyFnOnce<(&'a &'c (), &'c T)> = &Foo::<T>(PhantomData);\r\n}\r\n\r\n// this doesn't compile\r\n// fn bad<'c, T: 'c>() {\r\n//    let foo3: &dyn for<'a> MyFnOnce<(&'a &'static (), &'c T)> = &Foo::<T>(PhantomData);\r\n// }\r\n```\r\n\r\nThe borrow checker can properly detect the invalid cast within `bad` function. So i think this should be just an implementation issue. I'm not very familar with the code, but i doubt the problem lives within this function:\r\n\r\nhttps://github.com/rust-lang/rust/blob/master/compiler/rustc_middle/src/ty/relate.rs#L190-L214 \r\n\r\nIf it can type check similar to my example above, i think the original code will be rejected as expected.\r\n\r\nEDIT: In case there's extra magic with the builtin `FnOnce` trait, here's a version with std `FnOnce`.\r\n```rust\r\n#![feature(fn_traits)]\r\n#![feature(unboxed_closures)]\r\n// nightly only\r\nuse std::marker::PhantomData;\r\n\r\nstruct Foo<T>(PhantomData<T>);\r\n\r\nimpl<'a, 'c, T: 'c> FnOnce<(&'a &'c (), &'c T)> for Foo<T> {\r\n    type Output = ();\r\n    extern \"rust-call\" \r\n    fn call_once(self, _: (&'a &'c (), &'c T)) -> Self::Output { todo!() }\r\n}\r\n\r\n// this compiles\r\nfn bad1<'c, T: 'c>() {\r\n    let x: &dyn for<'a> FnOnce(&'a &'c (), &'c T) = &Foo::<T>(PhantomData);\r\n}\r\n\r\n// this doesn't\r\n// fn bad2<'c, T: 'c>() {\r\n//    let x: &dyn for<'a> FnOnce(&'a &'static (), &'c T) = &Foo::<T>(PhantomData);\r\n// }\r\n```\r\n\r\nAnd for reference, this is the return type example occurred in lcnr's blog.\r\n```rust\r\n// borrow checker properly handles this too.\r\n// does not compile\r\n// fn my<T: 'static>() {\r\n//    let foo1: &dyn for<'a, 'b> FnOnce(&'a (), &'b T) -> (&'a &'b (), &'a T) = todo!();\r\n//    let foo2: &dyn for<'b> FnOnce(&'static (), &'b T) -> (&'static &'b (), &'static T) = foo1;\r\n//    let foo3: &dyn for<'b> FnOnce(&'static (), &'b T) -> (&'b &'b (), &'static T) = foo2;\r\n//}\r\n```\r\n\r\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/1030766729/reactions",
      "total_count": 3,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 3
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/1030810004",
    "html_url": "https://github.com/rust-lang/rust/issues/25860#issuecomment-1030810004",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/25860",
    "id": 1030810004,
    "node_id": "IC_kwDOAAsO6M49cOmU",
    "user": {
      "login": "SkiFire13",
      "id": 9020423,
      "node_id": "MDQ6VXNlcjkwMjA0MjM=",
      "avatar_url": "https://avatars.githubusercontent.com/u/9020423?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/SkiFire13",
      "html_url": "https://github.com/SkiFire13",
      "followers_url": "https://api.github.com/users/SkiFire13/followers",
      "following_url": "https://api.github.com/users/SkiFire13/following{/other_user}",
      "gists_url": "https://api.github.com/users/SkiFire13/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/SkiFire13/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/SkiFire13/subscriptions",
      "organizations_url": "https://api.github.com/users/SkiFire13/orgs",
      "repos_url": "https://api.github.com/users/SkiFire13/repos",
      "events_url": "https://api.github.com/users/SkiFire13/events{/privacy}",
      "received_events_url": "https://api.github.com/users/SkiFire13/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2022-02-06T11:08:04Z",
    "updated_at": "2022-02-06T11:08:04Z",
    "body": "> So, i implement my fake function pointer type, my own fake FnOnce trait\r\n\r\n> EDIT: In case there's extra magic with the builtin FnOnce trait, here's a version with std FnOnce.\r\n\r\nI believe this happens because traits objects are always invariant over their generic arguments. If `MyFnOnce` and `FnOnce` were contravariant over their generic arguments then both these examples would compile, but they don't:\r\n\r\n```rust\r\nfn should_compile1<'a, 'f>(f: &'f dyn FnOnce(&'a ())) -> &'f dyn FnOnce(&'static ()) {\r\n    f\r\n}\r\n\r\nfn should_compile2<'c, F: for<'a, 'b> FnOnce(&'a &'b ())>(f: F) {\r\n    let x: &dyn for<'a> FnOnce(&'a &'c ()) = &f;\r\n    let y: &dyn for<'a> FnOnce(&'a &'static ()) = x;\r\n}\r\n```\r\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/1030810004/reactions",
      "total_count": 2,
      "+1": 2,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/1031042078",
    "html_url": "https://github.com/rust-lang/rust/issues/25860#issuecomment-1031042078",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/25860",
    "id": 1031042078,
    "node_id": "IC_kwDOAAsO6M49dHQe",
    "user": {
      "login": "crlf0710",
      "id": 451806,
      "node_id": "MDQ6VXNlcjQ1MTgwNg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/451806?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/crlf0710",
      "html_url": "https://github.com/crlf0710",
      "followers_url": "https://api.github.com/users/crlf0710/followers",
      "following_url": "https://api.github.com/users/crlf0710/following{/other_user}",
      "gists_url": "https://api.github.com/users/crlf0710/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/crlf0710/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/crlf0710/subscriptions",
      "organizations_url": "https://api.github.com/users/crlf0710/orgs",
      "repos_url": "https://api.github.com/users/crlf0710/repos",
      "events_url": "https://api.github.com/users/crlf0710/events{/privacy}",
      "received_events_url": "https://api.github.com/users/crlf0710/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2022-02-07T03:41:47Z",
    "updated_at": "2022-02-07T03:45:43Z",
    "body": "@SkiFire13 You're correct that, dyn values doesn't suffer this issue because it doesn't use **contravariance** here. However it seems to me that my trait objects examples still shows that this issue **can** be solved by removing contravariance, in contradictionary to @lcnr's belief?\r\n\r\nPS: Personally I'd love to see more aligning between `fn () -> ()` and `Box<dyn Fn() -> ()>`. I hope the later can act as \"stateful callable\" in any case, without missing functionality compared to the former...",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/1031042078/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/1031048042",
    "html_url": "https://github.com/rust-lang/rust/issues/25860#issuecomment-1031048042",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/25860",
    "id": 1031048042,
    "node_id": "IC_kwDOAAsO6M49dItq",
    "user": {
      "login": "lcnr",
      "id": 29864074,
      "node_id": "MDQ6VXNlcjI5ODY0MDc0",
      "avatar_url": "https://avatars.githubusercontent.com/u/29864074?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/lcnr",
      "html_url": "https://github.com/lcnr",
      "followers_url": "https://api.github.com/users/lcnr/followers",
      "following_url": "https://api.github.com/users/lcnr/following{/other_user}",
      "gists_url": "https://api.github.com/users/lcnr/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/lcnr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/lcnr/subscriptions",
      "organizations_url": "https://api.github.com/users/lcnr/orgs",
      "repos_url": "https://api.github.com/users/lcnr/repos",
      "events_url": "https://api.github.com/users/lcnr/events{/privacy}",
      "received_events_url": "https://api.github.com/users/lcnr/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2022-02-07T04:02:04Z",
    "updated_at": "2022-02-07T04:02:04Z",
    "body": "@crlf0710\r\n\r\nin my post i have an implementation of `bad` which does not rely on contravariance anywhere, but instead uses covariance in the function return type.\r\n```rust\r\n// we again have an implied `'input: 'out` bound, this time because of the return type\r\nfn foo<'out, 'input, T>(_dummy: &'out (), value: &'input T) -> (&'out &'input (), &'out T) {\r\n    (&&(), value)\r\n}\r\n\r\nfn bad<'short, T>(x: &'short T) -> &'static T {\r\n    // instantiate `foo`\r\n    let foo1: for<'out, 'input> fn(&'out (), &'input T) -> (&'out &'input (), &'out T) = foo;\r\n\r\n    // instantiate 'out as 'static\r\n    let foo2: for<'input> fn(&'static (), &'input T) -> (&'static &'input (), &'static T) = foo1;\r\n\r\n    // function return types are covariant,\r\n    // go from 'static to 'input\r\n    let foo3: for<'input> fn(&'static (), &'input T) -> (&'input &'input (), &'static T) = foo2;\r\n\r\n    // instantiate 'input as 'short\r\n    let foo4: fn(&'static (), &'short T) -> (&'short &'short (), &'static T) = foo3;\r\n\r\n    // boom!\r\n    foo4(&(), x).1\r\n}\r\n```\r\nWhile completely removing variance inside of binders would fix this bug, that seems neither desirable nor feasible, considering the resulting breakage and loss of expressiveness.",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/1031048042/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/1031503974",
    "html_url": "https://github.com/rust-lang/rust/issues/25860#issuecomment-1031503974",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/25860",
    "id": 1031503974,
    "node_id": "IC_kwDOAAsO6M49e4Bm",
    "user": {
      "login": "GuillaumeDIDIER",
      "id": 3857552,
      "node_id": "MDQ6VXNlcjM4NTc1NTI=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3857552?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/GuillaumeDIDIER",
      "html_url": "https://github.com/GuillaumeDIDIER",
      "followers_url": "https://api.github.com/users/GuillaumeDIDIER/followers",
      "following_url": "https://api.github.com/users/GuillaumeDIDIER/following{/other_user}",
      "gists_url": "https://api.github.com/users/GuillaumeDIDIER/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/GuillaumeDIDIER/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/GuillaumeDIDIER/subscriptions",
      "organizations_url": "https://api.github.com/users/GuillaumeDIDIER/orgs",
      "repos_url": "https://api.github.com/users/GuillaumeDIDIER/repos",
      "events_url": "https://api.github.com/users/GuillaumeDIDIER/events{/privacy}",
      "received_events_url": "https://api.github.com/users/GuillaumeDIDIER/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2022-02-07T14:05:59Z",
    "updated_at": "2022-02-07T14:05:59Z",
    "body": "@lcnr Would the RFC https://github.com/rust-lang/rust/issues/27579 https://github.com/rust-lang/rfcs/blob/master/text/1214-projections-lifetimes-and-wf.md fix the issue ?",
    "author_association": "NONE",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/1031503974/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/1031548851",
    "html_url": "https://github.com/rust-lang/rust/issues/25860#issuecomment-1031548851",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/25860",
    "id": 1031548851,
    "node_id": "IC_kwDOAAsO6M49fC-z",
    "user": {
      "login": "SkiFire13",
      "id": 9020423,
      "node_id": "MDQ6VXNlcjkwMjA0MjM=",
      "avatar_url": "https://avatars.githubusercontent.com/u/9020423?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/SkiFire13",
      "html_url": "https://github.com/SkiFire13",
      "followers_url": "https://api.github.com/users/SkiFire13/followers",
      "following_url": "https://api.github.com/users/SkiFire13/following{/other_user}",
      "gists_url": "https://api.github.com/users/SkiFire13/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/SkiFire13/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/SkiFire13/subscriptions",
      "organizations_url": "https://api.github.com/users/SkiFire13/orgs",
      "repos_url": "https://api.github.com/users/SkiFire13/repos",
      "events_url": "https://api.github.com/users/SkiFire13/events{/privacy}",
      "received_events_url": "https://api.github.com/users/SkiFire13/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2022-02-07T14:49:14Z",
    "updated_at": "2022-02-07T14:49:14Z",
    "body": "@GuillaumeDIDIER that RFC already mentions this issue (in [this section](https://github.com/rust-lang/rfcs/blob/master/text/1214-projections-lifetimes-and-wf.md#implied-lifetime-bounds)), saying it will be addressed in a separate RFC.",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/1031548851/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/1037164655",
    "html_url": "https://github.com/rust-lang/rust/issues/25860#issuecomment-1037164655",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/25860",
    "id": 1037164655,
    "node_id": "IC_kwDOAAsO6M490eBv",
    "user": {
      "login": "LHolten",
      "id": 24637999,
      "node_id": "MDQ6VXNlcjI0NjM3OTk5",
      "avatar_url": "https://avatars.githubusercontent.com/u/24637999?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/LHolten",
      "html_url": "https://github.com/LHolten",
      "followers_url": "https://api.github.com/users/LHolten/followers",
      "following_url": "https://api.github.com/users/LHolten/following{/other_user}",
      "gists_url": "https://api.github.com/users/LHolten/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/LHolten/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/LHolten/subscriptions",
      "organizations_url": "https://api.github.com/users/LHolten/orgs",
      "repos_url": "https://api.github.com/users/LHolten/repos",
      "events_url": "https://api.github.com/users/LHolten/events{/privacy}",
      "received_events_url": "https://api.github.com/users/LHolten/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2022-02-12T11:36:00Z",
    "updated_at": "2022-02-12T11:36:20Z",
    "body": "To me it looks like function declarations assume all instances of the same lifetime in the signature to be identical.\r\nBut when sub-typing functions, you don't have to substitute all instances of a generic lifetime at the same time (thus breaking the assumption).\r\nMeanwhile for functions generic over types (instead of lifetimes), all instances of the type have to be substituted at the same time.\r\nSo why not apply the same restriction to substituting generic function lifetimes?",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/1037164655/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/1175760163",
    "html_url": "https://github.com/rust-lang/rust/issues/25860#issuecomment-1175760163",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/25860",
    "id": 1175760163,
    "node_id": "IC_kwDOAAsO6M5GFK0j",
    "user": {
      "login": "Cassy343",
      "id": 15149738,
      "node_id": "MDQ6VXNlcjE1MTQ5NzM4",
      "avatar_url": "https://avatars.githubusercontent.com/u/15149738?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Cassy343",
      "html_url": "https://github.com/Cassy343",
      "followers_url": "https://api.github.com/users/Cassy343/followers",
      "following_url": "https://api.github.com/users/Cassy343/following{/other_user}",
      "gists_url": "https://api.github.com/users/Cassy343/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Cassy343/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Cassy343/subscriptions",
      "organizations_url": "https://api.github.com/users/Cassy343/orgs",
      "repos_url": "https://api.github.com/users/Cassy343/repos",
      "events_url": "https://api.github.com/users/Cassy343/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Cassy343/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2022-07-06T04:12:12Z",
    "updated_at": "2022-07-06T04:12:12Z",
    "body": "I feel like the issue here isn't fundamental to variance or implied bounds. Let's look at the two more recent examples of this problem.\r\n\r\nFrom @arielb1 \r\n```rs\r\nfn foo<'a, 'b, T>() -> fn(Option<&'a &'b ()>, &'b T) -> &'a T {\r\n    fn foo_inner<'a, 'b, T>(_witness: Option<&'a &'b ()>, v: &'b T) -> &'a T {\r\n        v\r\n    }\r\n    foo_inner\r\n}\r\n\r\nfn bad<'c, 'd, T>(x: &'c T) -> &'d T {\r\n    // instantiate `foo`\r\n    let foo1: for<'a, 'b> fn() -> fn(Option<&'a &'b ()>, &'b T) -> &'a T = foo;\r\n    // subtyping: instantiate `'b <- 'c`\r\n    let foo2: for<'a> fn() -> fn(Option<&'a &'c ()>, &'c T) -> &'a T = foo1;\r\n    // subtyping: contravariantly 'c becomes 'static\r\n    let foo3: for<'a> fn() -> fn(Option<&'a &'static ()>, &'c T) -> &'a T = foo2;\r\n    // subtyping: instantiate `'a <- 'd`\r\n    let foo4: fn() -> fn(Option<&'d &'static ()>, &'c T) -> &'d T = foo3;\r\n    // boom!\r\n    foo4()(None, x)\r\n}\r\n```\r\n\r\nAnd from @lcnr \r\n```rs\r\n// we again have an implied `'input: 'out` bound, this time because of the return type\r\nfn foo<'out, 'input, T>(_dummy: &'out (), value: &'input T) -> (&'out &'input (), &'out T) {\r\n    (&&(), value)\r\n}\r\n\r\nfn bad<'short, T>(x: &'short T) -> &'static T {\r\n    // instantiate `foo`\r\n    let foo1: for<'out, 'input> fn(&'out (), &'input T) -> (&'out &'input (), &'out T) = foo;\r\n\r\n    // instantiate 'out as 'static\r\n    let foo2: for<'input> fn(&'static (), &'input T) -> (&'static &'input (), &'static T) = foo1;\r\n\r\n    // function return types are covariant,\r\n    // go from 'static to 'input\r\n    let foo3: for<'input> fn(&'static (), &'input T) -> (&'input &'input (), &'static T) = foo2;\r\n\r\n    // instantiate 'input as 'short\r\n    let foo4: fn(&'static (), &'short T) -> (&'short &'short (), &'static T) = foo3;\r\n\r\n    // boom!\r\n    foo4(&(), x).1\r\n}\r\n```\r\n\r\nIn both examples, the invalid cast is in the transition from `foo2` to `foo3`. The thing that both these examples have in common is that a guarantee given by the implied bound is erased by the cast. In the first example, `foo2` has the bound `'c: 'a`, but the cast erases this bound. This is clearly invalid: the function behind that pointer was allowed to rely on that bound but the caller may no longer respect it. Similarly in the second example, in `foo2` we have `'input: 'static`, but that bound is then erased. It seems like what's needed here is some kind of check for bound erasure when applying sub-typing.",
    "author_association": "NONE",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/1175760163/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/1176228385",
    "html_url": "https://github.com/rust-lang/rust/issues/25860#issuecomment-1176228385",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/25860",
    "id": 1176228385,
    "node_id": "IC_kwDOAAsO6M5GG9Ih",
    "user": {
      "login": "RalfJung",
      "id": 330628,
      "node_id": "MDQ6VXNlcjMzMDYyOA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/330628?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/RalfJung",
      "html_url": "https://github.com/RalfJung",
      "followers_url": "https://api.github.com/users/RalfJung/followers",
      "following_url": "https://api.github.com/users/RalfJung/following{/other_user}",
      "gists_url": "https://api.github.com/users/RalfJung/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/RalfJung/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/RalfJung/subscriptions",
      "organizations_url": "https://api.github.com/users/RalfJung/orgs",
      "repos_url": "https://api.github.com/users/RalfJung/repos",
      "events_url": "https://api.github.com/users/RalfJung/events{/privacy}",
      "received_events_url": "https://api.github.com/users/RalfJung/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2022-07-06T13:33:15Z",
    "updated_at": "2022-07-06T13:33:15Z",
    "body": "> The thing that both these examples have in common is that a guarantee given by the implied bound is erased by the cast.\r\n\r\nIndeed. So implied bounds are clearly fundamental to the problem.\r\nAnd what's happening here isn't a cast, it's subtyping, hence the relation to variance.",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/1176228385/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/1176242880",
    "html_url": "https://github.com/rust-lang/rust/issues/25860#issuecomment-1176242880",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/25860",
    "id": 1176242880,
    "node_id": "IC_kwDOAAsO6M5GHArA",
    "user": {
      "login": "Cassy343",
      "id": 15149738,
      "node_id": "MDQ6VXNlcjE1MTQ5NzM4",
      "avatar_url": "https://avatars.githubusercontent.com/u/15149738?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Cassy343",
      "html_url": "https://github.com/Cassy343",
      "followers_url": "https://api.github.com/users/Cassy343/followers",
      "following_url": "https://api.github.com/users/Cassy343/following{/other_user}",
      "gists_url": "https://api.github.com/users/Cassy343/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Cassy343/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Cassy343/subscriptions",
      "organizations_url": "https://api.github.com/users/Cassy343/orgs",
      "repos_url": "https://api.github.com/users/Cassy343/repos",
      "events_url": "https://api.github.com/users/Cassy343/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Cassy343/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2022-07-06T13:46:30Z",
    "updated_at": "2022-07-06T13:46:30Z",
    "body": "The point I was trying to get across was that it wasn't an insurmountable problem with implied bounds and variance, rather I think it is fixable by incorporating implied bounds into variance in a way. I'm spitballing here because I have no formal experience with this stuff, but is it not possible to add a check along the lines of \"T is a subtype of U only if the implied bounds associated with T imply those associated with U.\" So like with `for<'input> fn(&'static (), &'input T) -> (&'static &'input (), &'static T)` we have \"for all `'input`, `'input: 'static`,\" but for `for<'input> fn(&'static (), &'input T) -> (&'input &'input (), &'static T)`, we just have \"for all `'input`, `'input: 'input`,\" and the latter does not imply the former. Is such a condition not sufficient/not well-defined/not computable?",
    "author_association": "NONE",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/1176242880/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/1176273089",
    "html_url": "https://github.com/rust-lang/rust/issues/25860#issuecomment-1176273089",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/25860",
    "id": 1176273089,
    "node_id": "IC_kwDOAAsO6M5GHIDB",
    "user": {
      "login": "RalfJung",
      "id": 330628,
      "node_id": "MDQ6VXNlcjMzMDYyOA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/330628?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/RalfJung",
      "html_url": "https://github.com/RalfJung",
      "followers_url": "https://api.github.com/users/RalfJung/followers",
      "following_url": "https://api.github.com/users/RalfJung/following{/other_user}",
      "gists_url": "https://api.github.com/users/RalfJung/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/RalfJung/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/RalfJung/subscriptions",
      "organizations_url": "https://api.github.com/users/RalfJung/orgs",
      "repos_url": "https://api.github.com/users/RalfJung/repos",
      "events_url": "https://api.github.com/users/RalfJung/events{/privacy}",
      "received_events_url": "https://api.github.com/users/RalfJung/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2022-07-06T14:12:03Z",
    "updated_at": "2022-07-06T14:12:03Z",
    "body": "> The point I was trying to get across was that it wasn't an insurmountable problem with implied bounds and variance, rather I think it is fixable by incorporating implied bounds into variance in a way.\r\n\r\nOh, sure. The question is just how to actually implement that. :)",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/1176273089/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/1447441809",
    "html_url": "https://github.com/rust-lang/rust/issues/25860#issuecomment-1447441809",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/25860",
    "id": 1447441809,
    "node_id": "IC_kwDOAAsO6M5WRjWR",
    "user": {
      "login": "safinaskar",
      "id": 859494,
      "node_id": "MDQ6VXNlcjg1OTQ5NA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/859494?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/safinaskar",
      "html_url": "https://github.com/safinaskar",
      "followers_url": "https://api.github.com/users/safinaskar/followers",
      "following_url": "https://api.github.com/users/safinaskar/following{/other_user}",
      "gists_url": "https://api.github.com/users/safinaskar/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/safinaskar/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/safinaskar/subscriptions",
      "organizations_url": "https://api.github.com/users/safinaskar/orgs",
      "repos_url": "https://api.github.com/users/safinaskar/repos",
      "events_url": "https://api.github.com/users/safinaskar/events{/privacy}",
      "received_events_url": "https://api.github.com/users/safinaskar/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2023-02-28T01:49:15Z",
    "updated_at": "2023-03-01T21:34:53Z",
    "body": "I think this problem is solvable. We just need to include PTS checker ( https://en.wikipedia.org/wiki/Pure_type_system ) to rustc (or some similar type system). :) This will fix not only this bug, but (I think) many other similar bugs. In very elegant and general way. So, let me explain my idea. I will try to explain clearly, so that everyone will understand. I assume the reader has basic type system knowledge. If not, I suggest reading slides 41-58 of https://www.williamjbowman.com/resources/wjb-defense.pdf .\r\n\r\nIn the end I will show you why PTS will give us ability to reject that faulty code.\r\n\r\nOkay, so I assume you have read the slides, so now I will freely use symbols \u03bb and \u03a0. Now let me actually describe my plan.\r\n\r\nI will write \u03bb and \u03a0 expressions like so: [\u03a0 a : B. C]. Note the dot here between [B] and [C]\r\n\r\n- I propose translating Rust code to PTS expressions. I will write in this text Rust code like this: `Vec<T>` and PTS expressions like this: [star->star] (i. e. in square brackets)\r\n- I will call \"type\" everything which can be type for something. Note that \"type\" is not necessary Rust type. Also note that `Vec<i32>` is type, but `Vec` is not\r\n- I will call [star] the type of all Rust types, such that values of such Rust types can be passed as argument to a Rust function. For example, `Vec<i32>` is instance of [star] (i. e. `Vec<i32>` has type [star], i. e. [Vec i32 : star]). `Vec` is not instance of [star] (because it is not a type at all). `std::convert::identity` is not instance of [star], because it is generic, and one cannot pass generic functions to functions. But `std::convert::identity::<i32>` is instance of [star]. Also `for<'a> fn(&'a i32)` is instance of [star]. [star] is not instance of [star], because [star] is not Rust type\r\n- [prop] is the type of propositions. Propositions themselves are types ( https://en.wikipedia.org/wiki/Curry%E2%80%93Howard_correspondence )\r\n- [lifetime] is the type of lifetimes\r\n- [outlives] is a predicate, which specifies that one lifetime outlives another. It is written [outlives 'a 'b], this means `'a : 'b` (`'a` outlives `'b`). [outlives] has this type: [outlives : lifetime -> lifetime -> prop]\r\n- [type_outlives] is another predicate. [type_outlives T 'a] means that type [T] outlives lifetime ['a] (`T: 'a`). As we all know, types such as `i32` outlive everything. The only interesting case here is when type contains some embedded references. Type for [type_outlives]: [type_outlives : star -> lifetime -> prop]\r\n- [ref] is constant for creating shared reference types. One may think that to create a reference type you need some type and some lifetime. So it seems one need to use [ref] so: [ref 'a T]. And thus its type seems to be [ref : lifetime -> star -> star]. But I propose different mechanism, and here goes very good part of PTS. `&'a T` has sense only if `T: 'a`. **So we require proof object of `T: 'a` as argument to [ref]. This will mean that this will not be possible to even construct reference type if `T: 'a` is not true!** So I propose this type for [ref]: [ref : \u03a0 'a: lifetime. \u03a0 T: star. (type_outlives T 'a -> star)]\r\n- We have constant ['static]. And we have axiom [axstatic], which says that ['static] outlives everything: [axstatic : \u03a0 'a: lifetime. outlives 'static 'a]\r\n- We have unit type [unittype]. Obviously [unittype : star]. And we have unit value itself, [unit]. We have [unit : unittype]. Also, we have axiom [axunit : type_outlives unittype 'static].\r\n- We have axiom about refs: `&'a T : 'a`. This is how it is written in PTS: [axref : \u03a0 'a : lifetime. \u03a0 T : star. \u03a0 proof : type_outlives T 'a. type_outlives (ref 'a T proof) 'a]\r\n- We have axiom: if `T: 'a` and `'a: 'b`, then `T: 'b`. I. e. [axtrans : \u03a0 T : star. \u03a0 'a: lifetime. \u03a0 'b: lifetime. type_outlives T 'a -> outlives 'a 'b -> type_outlives T 'b]\r\n- Also, `'a: 'a`. I. e. [axoutlivesrefl : \u03a0 'a: lifetime. outlives 'a 'a]\r\n\r\nOkay, so using all this stuff, we can now write in PTS first line of faulty example:\r\n```rust\r\nstatic UNIT: &'static &'static () = &&();\r\n```\r\nHere we go: [UNIT : ref 'static (ref 'static unittype axunit) (axref 'static unittype axunit)]\r\n\r\n(Well, in fact I specified type of UNIT, not its value. But this is not important.)\r\n\r\nNow let's prove some theorems. In PTS theorems are just short abbreviations for complex expressions. :)\r\n\r\nThe first theorem will simply state that unit type outlives everything. Here is this theorem with its proof:\r\n\r\n[unitbig : (\u03a0 'a : lifetime. type_outlives unittype 'a) = (\u03bb 'a : lifetime. axtrans unittype 'static 'a axunit (axstatic 'a))]\r\n\r\nNow let's try to write type of `foo`:\r\n```rust\r\nfn foo<'a, 'b, T>(_: &'a &'b (), v: &'b T) -> &'a T { v }\r\n```\r\n\r\n[foo: \u03a0 'a : lifetime . \u03a0 'b : lifetime . \u03a0 T : star. \u03a0 x : ref 'a (ref 'b unittype (unitbig 'b)) (???). \u03a0 v : ref 'b T (???). ref 'a T (???)]\r\n\r\nOkay, what to write instead of \"???\"? We cannot write anything, because we have no proof objects for `T: 'b` and for `'b: 'a`.\r\n\r\n**So, PTS requires us to pass all proof objects! Our example will not even typecheck, if we did not pass them! PTS will not allow us to make mistakes! So, we have to put implicit `where T: 'b, 'b: 'a` here.** Final code will look so:\r\n\r\n[foo: \u03a0 'a : lifetime . \u03a0 'b : lifetime . \u03a0 T : star. \u03a0 tb: type_outlives T 'b. \u03a0 ba: outlives 'b 'a. \u03a0 x : ref 'a (ref 'b unittype (unitbig 'b)) (axtrans (ref 'b unittype (unitbig 'b)) 'b 'a (axref 'b unittype (unitbig 'b)) ba). \u03a0 v : ref 'b T tb. ref 'a T (axtrans T 'b 'a tb ba)]\r\n\r\nLet's abbreviate type of [foo] for particular ['a], ['b], [T], [tb] and [ba] as [footype 'a 'b T tb ba]. I. e. let's introduce this:\r\n\r\n[footype 'a 'b T tb ba = \u03a0 x : ref 'a (ref 'b unittype (unitbig 'b)) (axtrans (ref 'b unittype (unitbig 'b)) 'b 'a (axref 'b unittype (unitbig 'b)) ba). \u03a0 v : ref 'b T tb. ref 'a T (axtrans T 'b 'a tb ba)]\r\n\r\nBut we wrote _type_ for `foo`. What about its value? Well, let's try:\r\n\r\n[foo = \u03bb 'a : lifetime. \u03bb 'b : lifetime. \u03bb T : star. \u03bb tb: (...). \u03bb ba: (...). \u03bb x: (...). \u03bb v: (ref 'b T (...)). v]\r\n\r\nWell, I left some \"...\" in the code, but this is not important. But our code will not typecheck anyway. Because [ref 'a T (...)] and [ref 'b T (...)] are two different types. We need subtyping.\r\n\r\nWell, now let's introduce subtyping.\r\n\r\n- Our PTS will not have any built-in subtyping. Instead all subtyping will happen explicitly\r\n- As well as I understand it is assumed among Rust devs that lifetimes are types, and thus subtyping applies to lifetimes, too. I disagree. In my formalization lifetimes and types are different things. And subtyping applies to types only\r\n- Okay, so we have constant [subtype]. [subtype T U] means that T is subtype of U. [subtype : star -> star -> prop]\r\n- Every type is subtype of itself: [axsubtyperefl : \u03a0 T: star. subtype T T]\r\n- Reference type is covariant in both lifetime and type. I. e. if `'a: 'b` and `T: U`, then `&'a T : &'b U`. I. e. [axrefcovar : \u03a0 'a : lifetime. \u03a0 'b : lifetime. \u03a0 T : star. \u03a0 U : star. \u03a0 proof1 : (...). \u03a0 proof2 : (...). outlives 'a 'b -> subtype T U -> subtype (ref 'a T (...)) (ref 'b U (...))] (some parts omitted).\r\n- Functions are covariant in results and contravariant in arguments. I. e. if `R1: R2` and `A2: A1`, then `fn(A1)->R1: fn(A2)->R2`. So, [axfn: \u03a0 A1: star. \u03a0 A2: star. \u03a0 R1: star. \u03a0 R2: star. subtype R1 R2 -> subtype A2 A1 -> subtype (A1 -> R1) (A2 -> R2)]\r\n- Okay, we have subtyping. But what we can actually do with it? Well, if `T: U`, then we can actually convert T to U! So, we have constant function [conv : \u03a0 T: star. \u03a0 U: star. subtype T U -> T -> U]\r\n\r\nNow we can write value of function `foo`:\r\n\r\n[foo = \u03bb 'a : lifetime. \u03bb 'b : lifetime. \u03bb T : star. \u03bb tb: (...). \u03bb ba: (...). \u03bb x: (...). \u03bb v: (ref 'b T (...)). conv (ref 'b T (...)) (ref 'a T (...)) (...) v]\r\n\r\nAgain, I omitted something, but you can fill missing pieces. **It is important to know: if we made even single mistake, this will not typecheck! Variance, subtyping - all this is checked!**\r\n\r\nLet's go to the next line!\r\n```rust\r\nfn bad<'a, T>(x: &'a T) -> &'static T {\r\n```\r\n\r\nThis line gives us type for [bad] (I will omit it) and introduces for us the following context:\r\n- ['a : lifetime]\r\n- [T : star]\r\n- [proof : type_outlives T 'a]\r\n- [proof2 : type_outlives T 'static]\r\n- [x : ref 'a T proof]\r\n\r\nNow, next line:\r\n\r\n```rust\r\nlet f: fn(_, &'a T) -> &'static T = foo;\r\n```\r\n\r\nSo:\r\n[f : (V1 -> ref 'a T proof -> ref 'static T proof2) = conv (footype V2 V3 V4 V5 V6) (V1 -> ref 'a T proof -> ref 'static T proof2) V7 (foo V2 V3 V4 V5 V6)]\r\n\r\n(The line above was edited 28 Feb 13:00 UTC, original line was wrong.)\r\n\r\nAnd now our rustc got really hard problem: it should fill something instead of V1, V2, V3, V4, V5, V6, V7. And do you know that? It will unable to do this no matter how hard it will try. Because this task simply has no solution. **So, this code will not typecheck, exactly as we need!**\r\n\r\nOkay, so this bug (25860) is fixed. #106431 seems to be fixed now, too. (Well, I didn't read #106431 in full, but it begins with words \"Rust currently correctly implies a `'inner: 'outer` bound when you have `&'outer &'inner _`. It is also incorrectly implying this for `&'outer fn(&'inner _)`\". It is exactly kind of problem I solved.)\r\n\r\nI think my solution can be easily extended to https://github.com/rust-lang/rust/issues/80176#issuecomment-748466836 and many other bugs mentioned in this thread.\r\n\r\nAlso, my solution proves that there is nothing wrong with contravariance.\r\n\r\nOf course, I simplified everything. Actual pure type system is harder. See Barendregt, \"Lambda calculi with types\" ( http://hdl.handle.net/2066/17231 ) for actual definition of pure type system. PTS requires specifying so-called specification. Well, I don't want to provide one, I'm too lazy.\r\n\r\nBut if you want, I can think hard and provide specialization (well, I'm nearly sure I can provide one if I try). And I can fill other remaining pieces and even check my formulas in some PTS checker or prover. So, just write here \"hey! provide specification. Fill missing parts! Actually proof in some prover\" and I will do this.\r\n\r\nI hope this post will inspire someone to dig to beautiful world of type systems. Ping @lcnr .\r\n\r\nThis post is answer to this: https://github.com/rust-lang/rust/issues/25860#issuecomment-1176273089 , i. e. \"The question is just how to actually implement that\". And to \"less afraid now\" from here: https://github.com/rust-lang/rust/issues/25860#issuecomment-283955348 . If we build everything on top of generic PTS, everything will be magically solved!",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/1447441809/reactions",
      "total_count": 16,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 4,
      "rocket": 0,
      "eyes": 12
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/1454749218",
    "html_url": "https://github.com/rust-lang/rust/issues/25860#issuecomment-1454749218",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/25860",
    "id": 1454749218,
    "node_id": "IC_kwDOAAsO6M5WtbYi",
    "user": {
      "login": "noamtashma",
      "id": 9135297,
      "node_id": "MDQ6VXNlcjkxMzUyOTc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/9135297?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/noamtashma",
      "html_url": "https://github.com/noamtashma",
      "followers_url": "https://api.github.com/users/noamtashma/followers",
      "following_url": "https://api.github.com/users/noamtashma/following{/other_user}",
      "gists_url": "https://api.github.com/users/noamtashma/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/noamtashma/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/noamtashma/subscriptions",
      "organizations_url": "https://api.github.com/users/noamtashma/orgs",
      "repos_url": "https://api.github.com/users/noamtashma/repos",
      "events_url": "https://api.github.com/users/noamtashma/events{/privacy}",
      "received_events_url": "https://api.github.com/users/noamtashma/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2023-03-04T14:00:07Z",
    "updated_at": "2023-03-04T14:00:07Z",
    "body": "@safinaskar Let me check if I understand you correctly. To me it reads like:\r\n1. Make IR explicitly state lifetime requirements and such, as part of the type. (similar to [this comment you indirectly referenced](https://github.com/rust-lang/rust/issues/25860#issuecomment-174011431)).\r\n2. Stop variance from being a built-in, automatic part of IR, and instead desugar implicit subtyping in surface rust into explicit applications of \"variance rules\".\r\n3. Check that with pure typesystem checker, that will hopefully be smaller and sound and simple. Bugs that are similar to this would supposedly fail here, because the desugaring step would produce untypable IR.\r\n\r\nCorrect?\r\n\r\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/1454749218/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/1454751228",
    "html_url": "https://github.com/rust-lang/rust/issues/25860#issuecomment-1454751228",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/25860",
    "id": 1454751228,
    "node_id": "IC_kwDOAAsO6M5Wtb38",
    "user": {
      "login": "noamtashma",
      "id": 9135297,
      "node_id": "MDQ6VXNlcjkxMzUyOTc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/9135297?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/noamtashma",
      "html_url": "https://github.com/noamtashma",
      "followers_url": "https://api.github.com/users/noamtashma/followers",
      "following_url": "https://api.github.com/users/noamtashma/following{/other_user}",
      "gists_url": "https://api.github.com/users/noamtashma/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/noamtashma/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/noamtashma/subscriptions",
      "organizations_url": "https://api.github.com/users/noamtashma/orgs",
      "repos_url": "https://api.github.com/users/noamtashma/repos",
      "events_url": "https://api.github.com/users/noamtashma/events{/privacy}",
      "received_events_url": "https://api.github.com/users/noamtashma/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2023-03-04T14:06:31Z",
    "updated_at": "2023-03-04T14:06:31Z",
    "body": "Can anyone clear up why [niko's approach](https://github.com/rust-lang/rust/issues/25860#issuecomment-174011431) wasn't implemented?\r\nDoes it not work from a theoretical point of view? Or practically? Or it has actually been implemented, but didn't solve the issue?\r\nOr just nobody got around to doing it?",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/1454751228/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/1454776541",
    "html_url": "https://github.com/rust-lang/rust/issues/25860#issuecomment-1454776541",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/25860",
    "id": 1454776541,
    "node_id": "IC_kwDOAAsO6M5WtiDd",
    "user": {
      "login": "safinaskar",
      "id": 859494,
      "node_id": "MDQ6VXNlcjg1OTQ5NA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/859494?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/safinaskar",
      "html_url": "https://github.com/safinaskar",
      "followers_url": "https://api.github.com/users/safinaskar/followers",
      "following_url": "https://api.github.com/users/safinaskar/following{/other_user}",
      "gists_url": "https://api.github.com/users/safinaskar/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/safinaskar/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/safinaskar/subscriptions",
      "organizations_url": "https://api.github.com/users/safinaskar/orgs",
      "repos_url": "https://api.github.com/users/safinaskar/repos",
      "events_url": "https://api.github.com/users/safinaskar/events{/privacy}",
      "received_events_url": "https://api.github.com/users/safinaskar/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2023-03-04T15:27:34Z",
    "updated_at": "2023-03-04T15:27:34Z",
    "body": "> Correct?\r\n\r\n@noamtashma, Yes",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/1454776541/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/1455898550",
    "html_url": "https://github.com/rust-lang/rust/issues/25860#issuecomment-1455898550",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/25860",
    "id": 1455898550,
    "node_id": "IC_kwDOAAsO6M5Wxz-2",
    "user": {
      "login": "lcnr",
      "id": 29864074,
      "node_id": "MDQ6VXNlcjI5ODY0MDc0",
      "avatar_url": "https://avatars.githubusercontent.com/u/29864074?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/lcnr",
      "html_url": "https://github.com/lcnr",
      "followers_url": "https://api.github.com/users/lcnr/followers",
      "following_url": "https://api.github.com/users/lcnr/following{/other_user}",
      "gists_url": "https://api.github.com/users/lcnr/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/lcnr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/lcnr/subscriptions",
      "organizations_url": "https://api.github.com/users/lcnr/orgs",
      "repos_url": "https://api.github.com/users/lcnr/repos",
      "events_url": "https://api.github.com/users/lcnr/events{/privacy}",
      "received_events_url": "https://api.github.com/users/lcnr/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2023-03-06T10:46:37Z",
    "updated_at": "2023-03-06T10:46:47Z",
    "body": "the comment by @safinaskar is afaict pretty much the approach suggested by niko in https://github.com/rust-lang/rust/issues/25860#issuecomment-174011431 except that it also lowers our trait system to proof objects.\r\n\r\nrustc currently does not do that. We prove trait bounds during type checking, forget that information (except for trait solver caching), and then reprove these same bounds during codegen.\r\n\r\nWhile I would love to lower rusts trait system to a far simpler language at some point and verify both borrowck and trait solving in that simpler language, this is not what's currently done. Rustc uses pretty much the same trait system until we hand off the work to llvm. This is different from what's done by haskell afaik, where its very complex type system gets mapped to an intermediate type system which is far simpler.\r\n\r\nThe issue is that currently Rust is in no state to do anything like this. Similarly, the reason why niko's approach is not yet implemented is simply that getting the type system to a point where we even can implement this is Hard. Fixing this bug is blocked on replacing the existing trait solver(s): #107374. A clean fix for this issue (and the ability to even consider using proof objects), will then also be blocked blocked on coinductive trait goals and explicit well formed bounds. We should then be able to add implications to the trait solver.\r\n\r\nSo I guess the status is that we're slowly getting there but it is very hard, especially as we have to be incredibly careful to not break backwards compatibility.\r\n\r\n\r\n\r\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/1455898550/reactions",
      "total_count": 27,
      "+1": 12,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 15,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/1579067138",
    "html_url": "https://github.com/rust-lang/rust/issues/25860#issuecomment-1579067138",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/25860",
    "id": 1579067138,
    "node_id": "IC_kwDOAAsO6M5eHqcC",
    "user": {
      "login": "John-Nagle",
      "id": 942608,
      "node_id": "MDQ6VXNlcjk0MjYwOA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/942608?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/John-Nagle",
      "html_url": "https://github.com/John-Nagle",
      "followers_url": "https://api.github.com/users/John-Nagle/followers",
      "following_url": "https://api.github.com/users/John-Nagle/following{/other_user}",
      "gists_url": "https://api.github.com/users/John-Nagle/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/John-Nagle/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/John-Nagle/subscriptions",
      "organizations_url": "https://api.github.com/users/John-Nagle/orgs",
      "repos_url": "https://api.github.com/users/John-Nagle/repos",
      "events_url": "https://api.github.com/users/John-Nagle/events{/privacy}",
      "received_events_url": "https://api.github.com/users/John-Nagle/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2023-06-06T16:14:58Z",
    "updated_at": "2023-06-06T16:14:58Z",
    "body": "Publicized as a language design flaw at https://counterexamples.org/nearly-universal.html?highlight=Rust#nearly-universal-quantification",
    "author_association": "NONE",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/1579067138/reactions",
      "total_count": 14,
      "+1": 14,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/1680007800",
    "html_url": "https://github.com/rust-lang/rust/issues/25860#issuecomment-1680007800",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/25860",
    "id": 1680007800,
    "node_id": "IC_kwDOAAsO6M5kIuJ4",
    "user": {
      "login": "ast-ral",
      "id": 33921117,
      "node_id": "MDQ6VXNlcjMzOTIxMTE3",
      "avatar_url": "https://avatars.githubusercontent.com/u/33921117?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ast-ral",
      "html_url": "https://github.com/ast-ral",
      "followers_url": "https://api.github.com/users/ast-ral/followers",
      "following_url": "https://api.github.com/users/ast-ral/following{/other_user}",
      "gists_url": "https://api.github.com/users/ast-ral/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ast-ral/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ast-ral/subscriptions",
      "organizations_url": "https://api.github.com/users/ast-ral/orgs",
      "repos_url": "https://api.github.com/users/ast-ral/repos",
      "events_url": "https://api.github.com/users/ast-ral/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ast-ral/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2023-08-16T05:59:20Z",
    "updated_at": "2023-08-16T05:59:20Z",
    "body": "This code I've found also seems to exhibit a similar problem (on version 1.71.1):\r\n```rust\r\nuse std::marker::PhantomData;\r\n\r\nstruct Bounded<'a, 'b: 'a, T>(&'a T, PhantomData<&'b ()>);\r\n\r\nfn helper<'a, 'b, T>(\r\n    input: &'a T,\r\n    closure: impl FnOnce(&T) -> Bounded<'b, '_, T>,\r\n) -> &'b T {\r\n    closure(input).0\r\n}\r\n\r\nfn extend<'a, 'b, T>(input: &'a T) -> &'b T {\r\n    helper(input, |x| Bounded(x, PhantomData))\r\n}\r\n```\r\nI'm hesitant to file this as its own issue because I don't think it's different enough to justify doing so.",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/1680007800/reactions",
      "total_count": 12,
      "+1": 12,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/1850192624",
    "html_url": "https://github.com/rust-lang/rust/issues/25860#issuecomment-1850192624",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/25860",
    "id": 1850192624,
    "node_id": "IC_kwDOAAsO6M5uR7Lw",
    "user": {
      "login": "Neutron3529",
      "id": 26130174,
      "node_id": "MDQ6VXNlcjI2MTMwMTc0",
      "avatar_url": "https://avatars.githubusercontent.com/u/26130174?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Neutron3529",
      "html_url": "https://github.com/Neutron3529",
      "followers_url": "https://api.github.com/users/Neutron3529/followers",
      "following_url": "https://api.github.com/users/Neutron3529/following{/other_user}",
      "gists_url": "https://api.github.com/users/Neutron3529/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Neutron3529/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Neutron3529/subscriptions",
      "organizations_url": "https://api.github.com/users/Neutron3529/orgs",
      "repos_url": "https://api.github.com/users/Neutron3529/repos",
      "events_url": "https://api.github.com/users/Neutron3529/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Neutron3529/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2023-12-11T14:29:13Z",
    "updated_at": "2023-12-12T13:41:42Z",
    "body": "> This code I've found also seems to exhibit a similar problem (on version 1.71.1):\r\n> \r\n> ```rust\r\n> use std::marker::PhantomData;\r\n> \r\n> struct Bounded<'a, 'b: 'a, T>(&'a T, PhantomData<&'b ()>);\r\n> \r\n> fn helper<'a, 'b, T>(\r\n>     input: &'a T,\r\n>     closure: impl FnOnce(&T) -> Bounded<'b, '_, T>,\r\n> ) -> &'b T {\r\n>     closure(input).0\r\n> }\r\n> \r\n> fn extend<'a, 'b, T>(input: &'a T) -> &'b T {\r\n>     helper(input, |x| Bounded(x, PhantomData))\r\n> }\r\n> ```\r\n> \r\n> I'm hesitant to file this as its own issue because I don't think it's different enough to justify doing so.\r\n\r\nI tried to simplify your code, got:\r\n```rust\r\nfn extend<'a, T>(input: &'a T) -> &'static T {\r\n    struct Bounded<'a, 'b: 'static, T>(&'a T, [&'b ();0]);\r\n    let n:Box<dyn FnOnce(&T) -> Bounded<'static, '_, T>>=Box::new(|x| Bounded(x, []));\r\n    n(input).0\r\n}\r\nfn extend_mut<'a, T>(input: &'a mut T) -> &'static mut T {\r\n    struct Bounded<'a, 'b: 'static, T>(&'a mut T, [&'b ();0]);\r\n    let mut n:Box<dyn FnMut(&mut T) -> Bounded<'static, '_, T>>=Box::new(|x| Bounded(x, []));\r\n    n(input).0\r\n}\r\n```\r\ndeleting the `'b` would generate an compile error, but adding it is fine. I means, this code\r\n```rust\r\nfn extend<T>(input: &T) -> &'static T {\r\n    struct Bounded<'a, T>(&'a T, [&'static ();0]);\r\n    let n:Box<dyn FnOnce(&T) -> Bounded<'static, T>>=Box::new(|x| Bounded(x, []));\r\n    n(input).0\r\n}\r\n```\r\nyields\r\n```\r\nerror: lifetime may not live long enough\r\n --> test2.rs:3:67\r\n  |\r\n3 |     let n:Box<dyn FnOnce(&T) -> Bounded<'static, T>>=Box::new(|x| Bounded(x, []));\r\n  |                                                                -- ^^^^^^^^^^^^^^ returning this value requires that `'1` must outlive `'2`\r\n  |                                                                ||\r\n  |                                                                |return type of closure is Bounded<'2, T>\r\n  |                                                                has type `&'1 T`\r\n\r\nerror: aborting due to previous error\r\n```\r\nIt seems the restriction is inverted here, we need `'a:'b` to execute instructions like `&'a T as &'b T`, but we wrote `'b outlives 'a` (actually here I wrote `'b outlives 'static`)\r\n\r\n---\r\n\r\nWhat's more, the original implementation does not need an extra lifetime `'b` since we could obtain `'b` from `'static` directly.\r\n```rust\r\npub fn make_static<'a, T>(input: &'a T) -> &'static T {\r\n    fn helper<'a, T>(_: [&'static&'a();0], v: &'a T) -> &'static T { v }\r\n    let f: fn([&'static&();0], &T) -> &'static T = helper;\r\n    f([], input) // we need not to create a &'a&'b unit directly.\r\n}\r\npub fn make_static_mut<'a, T>(input: &'a mut T) -> &'static mut T {\r\n    fn helper_mut<'a, T>(_: [&'static&'a();0], v: &'a mut T) -> &'static mut T { v }\r\n    let f: fn([&'static&'static();0], &'a mut T) -> &'static mut T = helper_mut;\r\n    // let f: fn([&'static&();0], &mut T) -> &'static mut T = helper_mut; // it also works\r\n    f([], input)\r\n}\r\n```",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/1850192624/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/1852136159",
    "html_url": "https://github.com/rust-lang/rust/issues/25860#issuecomment-1852136159",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/25860",
    "id": 1852136159,
    "node_id": "IC_kwDOAAsO6M5uZVrf",
    "user": {
      "login": "Jules-Bertholet",
      "id": 79955405,
      "node_id": "MDQ6VXNlcjc5OTU1NDA1",
      "avatar_url": "https://avatars.githubusercontent.com/u/79955405?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Jules-Bertholet",
      "html_url": "https://github.com/Jules-Bertholet",
      "followers_url": "https://api.github.com/users/Jules-Bertholet/followers",
      "following_url": "https://api.github.com/users/Jules-Bertholet/following{/other_user}",
      "gists_url": "https://api.github.com/users/Jules-Bertholet/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Jules-Bertholet/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Jules-Bertholet/subscriptions",
      "organizations_url": "https://api.github.com/users/Jules-Bertholet/orgs",
      "repos_url": "https://api.github.com/users/Jules-Bertholet/repos",
      "events_url": "https://api.github.com/users/Jules-Bertholet/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Jules-Bertholet/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2023-12-12T14:23:51Z",
    "updated_at": "2023-12-12T14:23:51Z",
    "body": "> ```rust\r\n> fn extend<'a, T>(input: &'a T) -> &'static T {\r\n>     struct Bounded<'a, 'b: 'static, T>(&'a T, [&'b ();0]);\r\n>     let n:Box<dyn FnOnce(&T) -> Bounded<'static, '_, T>>=Box::new(|x| Bounded(x, []));\r\n>     n(input).0\r\n> }\r\n> fn extend_mut<'a, T>(input: &'a mut T) -> &'static mut T {\r\n>     struct Bounded<'a, 'b: 'static, T>(&'a mut T, [&'b ();0]);\r\n>     let mut n:Box<dyn FnMut(&mut T) -> Bounded<'static, '_, T>>=Box::new(|x| Bounded(x, []));\r\n>     n(input).0\r\n> }\r\n> ```\r\n\r\nThis is a new regression from 1.64 to 1.65: https://rust.godbolt.org/z/jGxrcrjTj",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/1852136159/reactions",
      "total_count": 1,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 1
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/1954150310",
    "html_url": "https://github.com/rust-lang/rust/issues/25860#issuecomment-1954150310",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/25860",
    "id": 1954150310,
    "node_id": "IC_kwDOAAsO6M50efem",
    "user": {
      "login": "bstrie",
      "id": 865233,
      "node_id": "MDQ6VXNlcjg2NTIzMw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/865233?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/bstrie",
      "html_url": "https://github.com/bstrie",
      "followers_url": "https://api.github.com/users/bstrie/followers",
      "following_url": "https://api.github.com/users/bstrie/following{/other_user}",
      "gists_url": "https://api.github.com/users/bstrie/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/bstrie/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/bstrie/subscriptions",
      "organizations_url": "https://api.github.com/users/bstrie/orgs",
      "repos_url": "https://api.github.com/users/bstrie/repos",
      "events_url": "https://api.github.com/users/bstrie/events{/privacy}",
      "received_events_url": "https://api.github.com/users/bstrie/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2024-02-20T12:50:02Z",
    "updated_at": "2024-02-20T13:42:28Z",
    "body": "@lcnr Github seems to think that #118247 will close this issue due to how your comment here is worded: https://github.com/rust-lang/rust/pull/118247#issuecomment-1883158719 . Can that be fixed?",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/1954150310/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/1954192102",
    "html_url": "https://github.com/rust-lang/rust/issues/25860#issuecomment-1954192102",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/25860",
    "id": 1954192102,
    "node_id": "IC_kwDOAAsO6M50eprm",
    "user": {
      "login": "slanterns",
      "id": 10987206,
      "node_id": "MDQ6VXNlcjEwOTg3MjA2",
      "avatar_url": "https://avatars.githubusercontent.com/u/10987206?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/slanterns",
      "html_url": "https://github.com/slanterns",
      "followers_url": "https://api.github.com/users/slanterns/followers",
      "following_url": "https://api.github.com/users/slanterns/following{/other_user}",
      "gists_url": "https://api.github.com/users/slanterns/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/slanterns/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/slanterns/subscriptions",
      "organizations_url": "https://api.github.com/users/slanterns/orgs",
      "repos_url": "https://api.github.com/users/slanterns/repos",
      "events_url": "https://api.github.com/users/slanterns/events{/privacy}",
      "received_events_url": "https://api.github.com/users/slanterns/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2024-02-20T13:14:09Z",
    "updated_at": "2024-02-20T14:00:04Z",
    "body": "> * e.g. we intend to consider higher ranked implied bounds when subtyping to fix [Implied bounds on nested references + variance = soundness hole\u00a0#25860](https://github.com/rust-lang/rust/issues/25860), I don't know how this will interact and don't feel confident making any prediction here.\r\n\r\n#118247 is not directly related to this issue. It's Github's misunderstanding.",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/1954192102/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/1954618068",
    "html_url": "https://github.com/rust-lang/rust/issues/25860#issuecomment-1954618068",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/25860",
    "id": 1954618068,
    "node_id": "IC_kwDOAAsO6M50gRrU",
    "user": {
      "login": "Richardn2002",
      "id": 8529852,
      "node_id": "MDQ6VXNlcjg1Mjk4NTI=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8529852?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Richardn2002",
      "html_url": "https://github.com/Richardn2002",
      "followers_url": "https://api.github.com/users/Richardn2002/followers",
      "following_url": "https://api.github.com/users/Richardn2002/following{/other_user}",
      "gists_url": "https://api.github.com/users/Richardn2002/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Richardn2002/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Richardn2002/subscriptions",
      "organizations_url": "https://api.github.com/users/Richardn2002/orgs",
      "repos_url": "https://api.github.com/users/Richardn2002/repos",
      "events_url": "https://api.github.com/users/Richardn2002/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Richardn2002/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2024-02-20T16:42:58Z",
    "updated_at": "2024-02-20T23:09:54Z",
    "body": "A recent joke [repo](https://github.com/Speykious/cve-rs) exploiting this bug, segfaulting and buffer-overflowing in safe Rust.",
    "author_association": "NONE",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/1954618068/reactions",
      "total_count": 58,
      "+1": 54,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 4,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/1954871241",
    "html_url": "https://github.com/rust-lang/rust/issues/25860#issuecomment-1954871241",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/25860",
    "id": 1954871241,
    "node_id": "IC_kwDOAAsO6M50hPfJ",
    "user": {
      "login": "alexpyattaev",
      "id": 5932526,
      "node_id": "MDQ6VXNlcjU5MzI1MjY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5932526?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alexpyattaev",
      "html_url": "https://github.com/alexpyattaev",
      "followers_url": "https://api.github.com/users/alexpyattaev/followers",
      "following_url": "https://api.github.com/users/alexpyattaev/following{/other_user}",
      "gists_url": "https://api.github.com/users/alexpyattaev/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alexpyattaev/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alexpyattaev/subscriptions",
      "organizations_url": "https://api.github.com/users/alexpyattaev/orgs",
      "repos_url": "https://api.github.com/users/alexpyattaev/repos",
      "events_url": "https://api.github.com/users/alexpyattaev/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alexpyattaev/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2024-02-20T18:58:14Z",
    "updated_at": "2024-02-20T23:10:05Z",
    "body": "This is not just a joke but also a nice example for malicious actors to sneak UB into \"safe\" crates. ",
    "author_association": "NONE",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/1954871241/reactions",
      "total_count": 39,
      "+1": 36,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 3,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/1955245545",
    "html_url": "https://github.com/rust-lang/rust/issues/25860#issuecomment-1955245545",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/25860",
    "id": 1955245545,
    "node_id": "IC_kwDOAAsO6M50iq3p",
    "user": {
      "login": "nyabinary",
      "id": 97130632,
      "node_id": "U_kgDOBcoYiA",
      "avatar_url": "https://avatars.githubusercontent.com/u/97130632?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nyabinary",
      "html_url": "https://github.com/nyabinary",
      "followers_url": "https://api.github.com/users/nyabinary/followers",
      "following_url": "https://api.github.com/users/nyabinary/following{/other_user}",
      "gists_url": "https://api.github.com/users/nyabinary/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nyabinary/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nyabinary/subscriptions",
      "organizations_url": "https://api.github.com/users/nyabinary/orgs",
      "repos_url": "https://api.github.com/users/nyabinary/repos",
      "events_url": "https://api.github.com/users/nyabinary/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nyabinary/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2024-02-20T22:46:19Z",
    "updated_at": "2024-02-20T23:10:00Z",
    "body": "Yeah, this should probably be a priority to fix, lol. ",
    "author_association": "NONE",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/1955245545/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/1955285462",
    "html_url": "https://github.com/rust-lang/rust/issues/25860#issuecomment-1955285462",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/25860",
    "id": 1955285462,
    "node_id": "IC_kwDOAAsO6M50i0nW",
    "user": {
      "login": "lcnr",
      "id": 29864074,
      "node_id": "MDQ6VXNlcjI5ODY0MDc0",
      "avatar_url": "https://avatars.githubusercontent.com/u/29864074?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/lcnr",
      "html_url": "https://github.com/lcnr",
      "followers_url": "https://api.github.com/users/lcnr/followers",
      "following_url": "https://api.github.com/users/lcnr/following{/other_user}",
      "gists_url": "https://api.github.com/users/lcnr/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/lcnr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/lcnr/subscriptions",
      "organizations_url": "https://api.github.com/users/lcnr/orgs",
      "repos_url": "https://api.github.com/users/lcnr/repos",
      "events_url": "https://api.github.com/users/lcnr/events{/privacy}",
      "received_events_url": "https://api.github.com/users/lcnr/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2024-02-20T23:09:47Z",
    "updated_at": "2024-02-21T05:40:32Z",
    "body": "we already had a crate published on crates.io before which used this bug to transmute in safe code, see https://github.com/rust-lang/rust/issues/25860#issuecomment-515747670.\r\n\r\nthis issue is a priority to fix for the types team and has been so for years now. there is a reason for why it is not yet fixed. fixing it relies on where-bounds on binders which are blocked on the next-generation trait solver. we are actively working on this and cannot fix the unsoundness before it's done.\r\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/1955285462/reactions",
      "total_count": 15,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 1,
      "heart": 14,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/1956046885",
    "html_url": "https://github.com/rust-lang/rust/issues/25860#issuecomment-1956046885",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/25860",
    "id": 1956046885,
    "node_id": "IC_kwDOAAsO6M50lugl",
    "user": {
      "login": "oli-obk",
      "id": 332036,
      "node_id": "MDQ6VXNlcjMzMjAzNg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/332036?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/oli-obk",
      "html_url": "https://github.com/oli-obk",
      "followers_url": "https://api.github.com/users/oli-obk/followers",
      "following_url": "https://api.github.com/users/oli-obk/following{/other_user}",
      "gists_url": "https://api.github.com/users/oli-obk/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/oli-obk/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/oli-obk/subscriptions",
      "organizations_url": "https://api.github.com/users/oli-obk/orgs",
      "repos_url": "https://api.github.com/users/oli-obk/repos",
      "events_url": "https://api.github.com/users/oli-obk/events{/privacy}",
      "received_events_url": "https://api.github.com/users/oli-obk/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2024-02-21T07:32:21Z",
    "updated_at": "2024-02-21T07:32:21Z",
    "body": "I am locking this thread, since its 100+ comments have become impossible to navigate. Please open threads on zulip if you want to discuss this issue or related bugs",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/1956046885/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
