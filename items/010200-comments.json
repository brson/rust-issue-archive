[
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/27543648",
    "html_url": "https://github.com/rust-lang/rust/issues/10200#issuecomment-27543648",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10200",
    "id": 27543648,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3NTQzNjQ4",
    "user": {
      "login": "brson",
      "id": 147214,
      "node_id": "MDQ6VXNlcjE0NzIxNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/brson",
      "html_url": "https://github.com/brson",
      "followers_url": "https://api.github.com/users/brson/followers",
      "following_url": "https://api.github.com/users/brson/following{/other_user}",
      "gists_url": "https://api.github.com/users/brson/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/brson/subscriptions",
      "organizations_url": "https://api.github.com/users/brson/orgs",
      "repos_url": "https://api.github.com/users/brson/repos",
      "events_url": "https://api.github.com/users/brson/events{/privacy}",
      "received_events_url": "https://api.github.com/users/brson/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2013-11-01T02:14:43Z",
    "updated_at": "2013-11-01T02:14:43Z",
    "body": "It's certainly a feature that we never use.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/27543648/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/27544083",
    "html_url": "https://github.com/rust-lang/rust/issues/10200#issuecomment-27544083",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10200",
    "id": 27544083,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3NTQ0MDgz",
    "user": {
      "login": "pythonesque",
      "id": 923144,
      "node_id": "MDQ6VXNlcjkyMzE0NA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/923144?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/pythonesque",
      "html_url": "https://github.com/pythonesque",
      "followers_url": "https://api.github.com/users/pythonesque/followers",
      "following_url": "https://api.github.com/users/pythonesque/following{/other_user}",
      "gists_url": "https://api.github.com/users/pythonesque/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/pythonesque/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/pythonesque/subscriptions",
      "organizations_url": "https://api.github.com/users/pythonesque/orgs",
      "repos_url": "https://api.github.com/users/pythonesque/repos",
      "events_url": "https://api.github.com/users/pythonesque/events{/privacy}",
      "received_events_url": "https://api.github.com/users/pythonesque/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2013-11-01T02:29:21Z",
    "updated_at": "2013-11-01T02:29:21Z",
    "body": "The root cause is https://github.com/mozilla/rust/commit/b50aa827a07f398d1a9bd81cc66eebe220006f73.  So we need to figure out how to handle tuple struct exports properly--I'm not sure of exactly what that would entail, @luqmana might know more.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/27544083/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/27544591",
    "html_url": "https://github.com/rust-lang/rust/issues/10200#issuecomment-27544591",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10200",
    "id": 27544591,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3NTQ0NTkx",
    "user": {
      "login": "alexcrichton",
      "id": 64996,
      "node_id": "MDQ6VXNlcjY0OTk2",
      "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alexcrichton",
      "html_url": "https://github.com/alexcrichton",
      "followers_url": "https://api.github.com/users/alexcrichton/followers",
      "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}",
      "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions",
      "organizations_url": "https://api.github.com/users/alexcrichton/orgs",
      "repos_url": "https://api.github.com/users/alexcrichton/repos",
      "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alexcrichton/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2013-11-01T02:46:31Z",
    "updated_at": "2013-11-01T02:46:31Z",
    "body": "I'm a little confused to what the problem is. I personally really like the fact that an enum tuple variant or a struct tuple has its name as a functional constructor. It's not something that I used that much, but I really enjoy doing it when I do use it.\n\nThis code should not be passing the typechecker for sure. We don't allow arbitrary code to be run inside of a pattern, so the `foo(x)` should not compile at all. It looks like the typechecker is matching patterns based on types and `Foo` just happens to have the same type as `foo` (although that's just a guess)\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/27544591/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/27544839",
    "html_url": "https://github.com/rust-lang/rust/issues/10200#issuecomment-27544839",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10200",
    "id": 27544839,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3NTQ0ODM5",
    "user": {
      "login": "pythonesque",
      "id": 923144,
      "node_id": "MDQ6VXNlcjkyMzE0NA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/923144?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/pythonesque",
      "html_url": "https://github.com/pythonesque",
      "followers_url": "https://api.github.com/users/pythonesque/followers",
      "following_url": "https://api.github.com/users/pythonesque/following{/other_user}",
      "gists_url": "https://api.github.com/users/pythonesque/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/pythonesque/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/pythonesque/subscriptions",
      "organizations_url": "https://api.github.com/users/pythonesque/orgs",
      "repos_url": "https://api.github.com/users/pythonesque/repos",
      "events_url": "https://api.github.com/users/pythonesque/events{/privacy}",
      "received_events_url": "https://api.github.com/users/pythonesque/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2013-11-01T02:54:23Z",
    "updated_at": "2013-11-01T02:59:07Z",
    "body": "See above.  The code passes the typechecker because, as you said, `foo` and `Foo` have the same types--more generally, because we export tuple structs as functions so they are allowed to exist anywhere a tuple struct could exist.  The problem is that the results it gives are totally inconsistent with what you would expect in this situation--it doesn't run arbitrary code, it just treats it like `Foo`.\n\nIn order to make that not happen, I can't really see any way around either\n(1) explicitly marking tuple structs as different from ordinary functions, or\n(2) in general, finding some other property that is shared by tuple structs and things allowed in match patterns, like maybe figuring out if it's a constant expression.\n\nI think (1) is simplest but at that point we're essentially acknowledging that tuple structs aren't just functions, even when they look like functions.  If we do that but still let you use them as functions in other contexts, we're basically just providing coercion for a really unusual use case (especially if we do what we should be doing and compile down tuple structs to not be function calls wherever possible, as per #7435).\n\nRight now, defining a tuple struct creates both a type and a value which happen to have the same name, which seems rather confusing to me pedagogically as well.  To me, the added confusion doesn't really seem worth the very rare situation where we actually do want to treat them as functions, particularly since we can just use a closure in those situations.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/27544839/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/27545011",
    "html_url": "https://github.com/rust-lang/rust/issues/10200#issuecomment-27545011",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10200",
    "id": 27545011,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3NTQ1MDEx",
    "user": {
      "login": "alexcrichton",
      "id": 64996,
      "node_id": "MDQ6VXNlcjY0OTk2",
      "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alexcrichton",
      "html_url": "https://github.com/alexcrichton",
      "followers_url": "https://api.github.com/users/alexcrichton/followers",
      "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}",
      "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions",
      "organizations_url": "https://api.github.com/users/alexcrichton/orgs",
      "repos_url": "https://api.github.com/users/alexcrichton/repos",
      "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alexcrichton/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2013-11-01T03:00:47Z",
    "updated_at": "2013-11-01T03:00:47Z",
    "body": "I don't think that forbidding tuple structs/enum tuples from being functions is the fix for this problem.\n\nIn the above code, `foo(x)` is not a valid pattern, you're matching against something of type `Foo` which means that the binding name for the sub-pattern-matching _must_ be `Foo` (or perhaps also something which resolved to `Foo`). In this case you're using `foo` which is a function and has no relation to `Foo` at all.\n\nI don't think that this use case warrants removal of `Foo` being a function (because it's a different bug).\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/27545011/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/27545166",
    "html_url": "https://github.com/rust-lang/rust/issues/10200#issuecomment-27545166",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10200",
    "id": 27545166,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3NTQ1MTY2",
    "user": {
      "login": "pythonesque",
      "id": 923144,
      "node_id": "MDQ6VXNlcjkyMzE0NA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/923144?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/pythonesque",
      "html_url": "https://github.com/pythonesque",
      "followers_url": "https://api.github.com/users/pythonesque/followers",
      "following_url": "https://api.github.com/users/pythonesque/following{/other_user}",
      "gists_url": "https://api.github.com/users/pythonesque/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/pythonesque/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/pythonesque/subscriptions",
      "organizations_url": "https://api.github.com/users/pythonesque/orgs",
      "repos_url": "https://api.github.com/users/pythonesque/repos",
      "events_url": "https://api.github.com/users/pythonesque/events{/privacy}",
      "received_events_url": "https://api.github.com/users/pythonesque/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2013-11-01T03:06:35Z",
    "updated_at": "2013-11-01T03:14:53Z",
    "body": "I'm using `foo(x)` which is a value of type `Foo`.  It has the correct arity, and returns the correct value, so as far as the typechecker is concerned it is indeed a valid pattern (note that I changed the example to use `uint` to demonstrate that last point but even if it did check that the types of the arguments were correct that wouldn't be enough to disallow `foo`).  The only way you can disallow foo in general is to disallow all functions in match patterns, or allow some functions in match patterns and evaluate them properly.  We can't do the latter right now, and we can't do the former unless https://github.com/mozilla/rust/commit/b50aa827a07f398d1a9bd81cc66eebe220006f73 is resolved in a way that differentiates tuple structs from regular functions.\n\nAs far as your last point, yes, we can fix this without removing `Foo` as a function--but not without making tuple structure functions \"special\" in some way.  If you disallow _all_ functions in match patterns, then we don't have to represent it internally as a function at all unless it's cast as one, but then that use case just becomes type coercion from tuple structs to functions, which is what I was saying.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/27545166/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/27558932",
    "html_url": "https://github.com/rust-lang/rust/issues/10200#issuecomment-27558932",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10200",
    "id": 27558932,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3NTU4OTMy",
    "user": {
      "login": "nikomatsakis",
      "id": 155238,
      "node_id": "MDQ6VXNlcjE1NTIzOA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/155238?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nikomatsakis",
      "html_url": "https://github.com/nikomatsakis",
      "followers_url": "https://api.github.com/users/nikomatsakis/followers",
      "following_url": "https://api.github.com/users/nikomatsakis/following{/other_user}",
      "gists_url": "https://api.github.com/users/nikomatsakis/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nikomatsakis/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nikomatsakis/subscriptions",
      "organizations_url": "https://api.github.com/users/nikomatsakis/orgs",
      "repos_url": "https://api.github.com/users/nikomatsakis/repos",
      "events_url": "https://api.github.com/users/nikomatsakis/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nikomatsakis/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2013-11-01T11:04:56Z",
    "updated_at": "2013-11-01T11:04:56Z",
    "body": "I don't think we should remove the fact that variant and struct constructors are functions, we should just change the pattern matching code to insist that the path is resolved to a variant or struct name. I'm rather surprised this is not how it works now but I'd have to look at the code to see why.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/27558932/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/27568188",
    "html_url": "https://github.com/rust-lang/rust/issues/10200#issuecomment-27568188",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10200",
    "id": 27568188,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3NTY4MTg4",
    "user": {
      "login": "nikomatsakis",
      "id": 155238,
      "node_id": "MDQ6VXNlcjE1NTIzOA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/155238?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nikomatsakis",
      "html_url": "https://github.com/nikomatsakis",
      "followers_url": "https://api.github.com/users/nikomatsakis/followers",
      "following_url": "https://api.github.com/users/nikomatsakis/following{/other_user}",
      "gists_url": "https://api.github.com/users/nikomatsakis/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nikomatsakis/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nikomatsakis/subscriptions",
      "organizations_url": "https://api.github.com/users/nikomatsakis/orgs",
      "repos_url": "https://api.github.com/users/nikomatsakis/repos",
      "events_url": "https://api.github.com/users/nikomatsakis/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nikomatsakis/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2013-11-01T14:14:44Z",
    "updated_at": "2013-11-01T14:14:44Z",
    "body": "From discussions on IRC, it seems that this problem only occurs with structs, not enum variants (which makes sense...) and the reason is because, in the cross-crate metadata, we encode a struct ctor as a normal fn, rather than giving it a distinct family (the same may be true in the intracrate case, I did not investigate)\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/27568188/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
