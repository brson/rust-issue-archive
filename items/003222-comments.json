[
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/8284216",
    "html_url": "https://github.com/rust-lang/rust/issues/3222#issuecomment-8284216",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/3222",
    "id": 8284216,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgyODQyMTY=",
    "user": {
      "login": "catamorphism",
      "id": 427212,
      "node_id": "MDQ6VXNlcjQyNzIxMg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/427212?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/catamorphism",
      "html_url": "https://github.com/catamorphism",
      "followers_url": "https://api.github.com/users/catamorphism/followers",
      "following_url": "https://api.github.com/users/catamorphism/following{/other_user}",
      "gists_url": "https://api.github.com/users/catamorphism/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/catamorphism/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/catamorphism/subscriptions",
      "organizations_url": "https://api.github.com/users/catamorphism/orgs",
      "repos_url": "https://api.github.com/users/catamorphism/repos",
      "events_url": "https://api.github.com/users/catamorphism/events{/privacy}",
      "received_events_url": "https://api.github.com/users/catamorphism/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2012-09-05T00:45:24Z",
    "updated_at": "2012-09-05T00:45:24Z",
    "body": "https://github.com/mozilla/rust/pull/3316 (since it's not obvious what pull request the commit is from).\n\n@nikomatsakis , @brson said you had reservations about the pull request? I'm not even sure if the code should compile or not.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/8284216/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/8290358",
    "html_url": "https://github.com/rust-lang/rust/issues/3222#issuecomment-8290358",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/3222",
    "id": 8290358,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgyOTAzNTg=",
    "user": {
      "login": "Vincent-Belliard",
      "id": 2185554,
      "node_id": "MDQ6VXNlcjIxODU1NTQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2185554?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Vincent-Belliard",
      "html_url": "https://github.com/Vincent-Belliard",
      "followers_url": "https://api.github.com/users/Vincent-Belliard/followers",
      "following_url": "https://api.github.com/users/Vincent-Belliard/following{/other_user}",
      "gists_url": "https://api.github.com/users/Vincent-Belliard/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Vincent-Belliard/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Vincent-Belliard/subscriptions",
      "organizations_url": "https://api.github.com/users/Vincent-Belliard/orgs",
      "repos_url": "https://api.github.com/users/Vincent-Belliard/repos",
      "events_url": "https://api.github.com/users/Vincent-Belliard/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Vincent-Belliard/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2012-09-05T07:53:49Z",
    "updated_at": "2012-09-05T07:53:49Z",
    "body": "About the code: I think it must compile. The following code compile and execute well:\n\n<pre><code>\nfn f(s: &str) {\n    if s == \"a\" {}\n}\n</code></pre>\n\nYou must be able to match a borrowed string with constant. Of course, the syntax may be different but, first, this one is consistent with a if test, second, the syntax is understood by the compiler, only the generation has a problem.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/8290358/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/8290691",
    "html_url": "https://github.com/rust-lang/rust/issues/3222#issuecomment-8290691",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/3222",
    "id": 8290691,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgyOTA2OTE=",
    "user": {
      "login": "Vincent-Belliard",
      "id": 2185554,
      "node_id": "MDQ6VXNlcjIxODU1NTQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2185554?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Vincent-Belliard",
      "html_url": "https://github.com/Vincent-Belliard",
      "followers_url": "https://api.github.com/users/Vincent-Belliard/followers",
      "following_url": "https://api.github.com/users/Vincent-Belliard/following{/other_user}",
      "gists_url": "https://api.github.com/users/Vincent-Belliard/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Vincent-Belliard/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Vincent-Belliard/subscriptions",
      "organizations_url": "https://api.github.com/users/Vincent-Belliard/orgs",
      "repos_url": "https://api.github.com/users/Vincent-Belliard/repos",
      "events_url": "https://api.github.com/users/Vincent-Belliard/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Vincent-Belliard/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2012-09-05T08:10:22Z",
    "updated_at": "2012-09-05T08:10:22Z",
    "body": "About the reservations: I'm absolutely sure that my analysis of the problem is good and that what I did will work. However, there are two problems.\nA first minor one is that I had a test in compile_submatch to see if the match expression is or is not a borrowed string. It's not orthogonal but it works.\nA second more serious problem is that I substitute:\nrslt(bcx, consts::const_expr(ccx, l))\nby\ntrans_temp_expr(bcx, l)\nI did that to be consistent with a if test. However, I think that the generated LLVM bytecode is slightly different from the previous one for other cases (for example when you match unique strings). I wonder if the solution could be to modify const_expr instead of calling trans_temp_expr.\nFor someone which didn't write the LLVM generation it's quite difficult to be sure to write something consistent.\nThe major problem is that when you infer the abstract syntax tree, you didn't generate an inferred tree. Doing this, some of the job did during the inference must be done again during the LLVM generation: you must test a lot of special cases when you generate. That's why, for someone who discover your LLVM generation, it's quite difficult to be sure that a patch is consistent with the former code.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/8290691/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/8291349",
    "html_url": "https://github.com/rust-lang/rust/issues/3222#issuecomment-8291349",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/3222",
    "id": 8291349,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgyOTEzNDk=",
    "user": {
      "login": "Vincent-Belliard",
      "id": 2185554,
      "node_id": "MDQ6VXNlcjIxODU1NTQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2185554?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Vincent-Belliard",
      "html_url": "https://github.com/Vincent-Belliard",
      "followers_url": "https://api.github.com/users/Vincent-Belliard/followers",
      "following_url": "https://api.github.com/users/Vincent-Belliard/following{/other_user}",
      "gists_url": "https://api.github.com/users/Vincent-Belliard/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Vincent-Belliard/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Vincent-Belliard/subscriptions",
      "organizations_url": "https://api.github.com/users/Vincent-Belliard/orgs",
      "repos_url": "https://api.github.com/users/Vincent-Belliard/repos",
      "events_url": "https://api.github.com/users/Vincent-Belliard/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Vincent-Belliard/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2012-09-05T08:41:08Z",
    "updated_at": "2012-09-05T14:32:09Z",
    "body": "About the strings: during one week, I really wonder why you used such a syntax. I finally understood that strings can be modified. Even if the characters are not mutable, a string can grow. I think that most the problems come from that. Most of the time, a string is never modified. You can concatenate strings, take sub strings, ... Each time you generate a new string and you don't modify existing strings. In Java, you have the StringBuffer class to build dynamically a string. For all other cases, you use a String which is constant.\n\nNow, the string syntax is not orthogonal nor consistent. If you write:\n@int\nyou define a shared box which held an integer but if you write:\n@str\nyou define a shared string. The integer can be deferenced but not the string. It's not easy to use and, most of all, it's not orthogonal.\nI think that a good solution should be to define a new type: str which would hold a constant string and would replace most of the ~str, @str and &str. Then you could add an other new type str_buf (or something like that). This type would nearly behave like a [mut u8]. The only difference would be that when you add one UTF8 character, several bytes would be added. The other advantage of this is that the generated LLVM code would be more efficient.\nI insist a lot because Rust is very well designed. It may be the only new language I would like to use but only if the string model become consistent.\n\nWith a consistent string syntax, this issue may has never appeared.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/8291349/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/8306828",
    "html_url": "https://github.com/rust-lang/rust/issues/3222#issuecomment-8306828",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/3222",
    "id": 8306828,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgzMDY4Mjg=",
    "user": {
      "login": "pcwalton",
      "id": 157897,
      "node_id": "MDQ6VXNlcjE1Nzg5Nw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/157897?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/pcwalton",
      "html_url": "https://github.com/pcwalton",
      "followers_url": "https://api.github.com/users/pcwalton/followers",
      "following_url": "https://api.github.com/users/pcwalton/following{/other_user}",
      "gists_url": "https://api.github.com/users/pcwalton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/pcwalton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/pcwalton/subscriptions",
      "organizations_url": "https://api.github.com/users/pcwalton/orgs",
      "repos_url": "https://api.github.com/users/pcwalton/repos",
      "events_url": "https://api.github.com/users/pcwalton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/pcwalton/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2012-09-05T17:30:17Z",
    "updated_at": "2012-09-05T17:36:36Z",
    "body": "The reason why `@str` cannot be dereferenced is that `str` is dynamically sized. If we allowed strings to be copied to the stack like ints can, then we'd have to add dynamic allocas and that would break the segmented stacks model. Other than that, `@int` and `@str` are intended to be conceptually very similar.\n\nYour proposal would basically rename `str` as it exists today to `str_buf` and make it mutable. Remember, `[mut u8]` is also a dynamically sized type, so it's really `~[mut u8]`, `@[mut u8]`, and `&[mut u8]`; thus there would be three str_bufs, `~str_buf`, `@str_buf`, and `&str_buf`. Your new type `str` would be equivalent to `&static/str` today. All of this would add complexity to the language for little gain, as I see it. I also don't see how the generated code would be more efficient; adding to a `~[mut u8]` is exactly the same operation as adding to a `~str`.\n\nThat said, you're right that building up a unique string by appending to it is confusing. We should add a `StringBuffer` type to the standard library.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/8306828/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/8307815",
    "html_url": "https://github.com/rust-lang/rust/issues/3222#issuecomment-8307815",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/3222",
    "id": 8307815,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgzMDc4MTU=",
    "user": {
      "login": "catamorphism",
      "id": 427212,
      "node_id": "MDQ6VXNlcjQyNzIxMg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/427212?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/catamorphism",
      "html_url": "https://github.com/catamorphism",
      "followers_url": "https://api.github.com/users/catamorphism/followers",
      "following_url": "https://api.github.com/users/catamorphism/following{/other_user}",
      "gists_url": "https://api.github.com/users/catamorphism/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/catamorphism/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/catamorphism/subscriptions",
      "organizations_url": "https://api.github.com/users/catamorphism/orgs",
      "repos_url": "https://api.github.com/users/catamorphism/repos",
      "events_url": "https://api.github.com/users/catamorphism/events{/privacy}",
      "received_events_url": "https://api.github.com/users/catamorphism/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2012-09-05T18:01:08Z",
    "updated_at": "2012-09-05T18:01:24Z",
    "body": "#3316 closes this. If you want to suggest additional enhancements to strings, please open a separate issue for it :-) (And thanks for the patch!)\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/8307815/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
