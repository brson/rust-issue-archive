[
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/22047703",
    "html_url": "https://github.com/rust-lang/rust/pull/8245#issuecomment-22047703",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/8245",
    "id": 22047703,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIyMDQ3NzAz",
    "user": {
      "login": "pcwalton",
      "id": 157897,
      "node_id": "MDQ6VXNlcjE1Nzg5Nw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/157897?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/pcwalton",
      "html_url": "https://github.com/pcwalton",
      "followers_url": "https://api.github.com/users/pcwalton/followers",
      "following_url": "https://api.github.com/users/pcwalton/following{/other_user}",
      "gists_url": "https://api.github.com/users/pcwalton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/pcwalton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/pcwalton/subscriptions",
      "organizations_url": "https://api.github.com/users/pcwalton/orgs",
      "repos_url": "https://api.github.com/users/pcwalton/repos",
      "events_url": "https://api.github.com/users/pcwalton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/pcwalton/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2013-08-03T03:27:45Z",
    "updated_at": "2013-08-03T03:27:45Z",
    "body": "From looking at this it looks like the format string verified at compile time but parsed at runtime. That seems strange: is it due to internalization concerns? I would hope that for perf there is at least eventually an option to turn off runtime parsing.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/22047703/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/22052224",
    "html_url": "https://github.com/rust-lang/rust/pull/8245#issuecomment-22052224",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/8245",
    "id": 22052224,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIyMDUyMjI0",
    "user": {
      "login": "alexcrichton",
      "id": 64996,
      "node_id": "MDQ6VXNlcjY0OTk2",
      "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alexcrichton",
      "html_url": "https://github.com/alexcrichton",
      "followers_url": "https://api.github.com/users/alexcrichton/followers",
      "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}",
      "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions",
      "organizations_url": "https://api.github.com/users/alexcrichton/orgs",
      "repos_url": "https://api.github.com/users/alexcrichton/repos",
      "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alexcrichton/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2013-08-03T09:10:48Z",
    "updated_at": "2013-08-03T09:10:48Z",
    "body": "Good news! For the following benchmark:\n\n``` rust\nextern mod extra;\nuse extra::test::BenchHarness;\n\n#[bench]\nfn fmt(b: &mut BenchHarness) {\n    do b.iter {\n        do 100.times {\n            fmt!(\"aasd f df %d awe\", 4);\n        }\n    }\n}\n\n#[bench]\nfn ifmt(b: &mut BenchHarness) {\n    do b.iter {\n        do 100.times {\n            ifmt!(\"aasd f df {:d} awe\", 4);\n        }\n    }\n}\n```\n\nI get the results:\n\n```\nrunning 2 tests\ntest fmt ... bench: 31349 ns/iter (+/- 1084)\ntest ifmt ... bench: 20443 ns/iter (+/- 403)\n\ntest result: ok. 0 passed; 0 failed; 0 ignored; 2 measured\n```\n\nHere's a summary:\n- All format strings are now compiled and generate lots and lots and lots of statics all over the place. These statics are then passed into sprintf which doesn't have to parse anything at that point\n- It now uses a `&mut io::Writer` instead of string implicitly.\n- I modified `rt::io::MemWriter` to allocate a vector with 128 bytes reserved. That sped up ifmt! performance by _a lot_, but I may have also been confusing this with other improvements I was getting\n- I'm trying to keep everything on \"the fast path\" as much as possible. Currently `sprintf` only makes one allocation, and it's because you're returning an owned string anyway.\n- Changed `ct` to `parse`\n\nOn the side I also change:\n- Used a condition instead of error function since my fix landed\n- All named arguments are no longer passed as named arguments. All references to them are rewritten to be a positional argument at the end of the list of arguments.\n- All references to the implicit \"next argument\" are disallowed in nested select/plural because it wouldn't make sense if different arms used different amounts of \"next arguments\"\n\nI'm still fixing up a few bugs here and there, but this has the bulk of everything.\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/22052224/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/22059763",
    "html_url": "https://github.com/rust-lang/rust/pull/8245#issuecomment-22059763",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/8245",
    "id": 22059763,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIyMDU5NzYz",
    "user": {
      "login": "alexcrichton",
      "id": 64996,
      "node_id": "MDQ6VXNlcjY0OTk2",
      "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alexcrichton",
      "html_url": "https://github.com/alexcrichton",
      "followers_url": "https://api.github.com/users/alexcrichton/followers",
      "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}",
      "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions",
      "organizations_url": "https://api.github.com/users/alexcrichton/orgs",
      "repos_url": "https://api.github.com/users/alexcrichton/repos",
      "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alexcrichton/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2013-08-03T19:02:38Z",
    "updated_at": "2013-08-03T19:02:38Z",
    "body": "All bugs should be fixed now, everything should be good to go\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/22059763/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/22290061",
    "html_url": "https://github.com/rust-lang/rust/pull/8245#issuecomment-22290061",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/8245",
    "id": 22290061,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIyMjkwMDYx",
    "user": {
      "login": "alexcrichton",
      "id": 64996,
      "node_id": "MDQ6VXNlcjY0OTk2",
      "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alexcrichton",
      "html_url": "https://github.com/alexcrichton",
      "followers_url": "https://api.github.com/users/alexcrichton/followers",
      "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}",
      "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions",
      "organizations_url": "https://api.github.com/users/alexcrichton/orgs",
      "repos_url": "https://api.github.com/users/alexcrichton/repos",
      "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alexcrichton/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2013-08-07T22:44:00Z",
    "updated_at": "2013-08-07T22:44:00Z",
    "body": "Here's some numbers about code size generated from the new formatting syntax. This program was compiled\n\n``` rust\n#[inline(never)]\n#[no_mangle]\nfn fmtarg0() -> ~str {\n    fmt!(\"Hello world for the 4th time again!\")\n}\n\n#[inline(never)]\n#[no_mangle]\nfn ifmtarg0() -> ~str {\n    ifmt!(\"Hello world for the 4th time again!\")\n}\n\n#[inline(never)]\n#[no_mangle]\nfn fmtarg1() -> ~str {\n    fmt!(\"Hello %s for the 4th time again!\", \"world\")\n}\n\n#[inline(never)]\n#[no_mangle]\nfn ifmtarg1() -> ~str {\n    ifmt!(\"Hello {:s} for the 4th time again!\", \"world\")\n}\n\n#[inline(never)]\n#[no_mangle]\nfn fmtarg2() -> ~str {\n    fmt!(\"Hello %s for the %dth time again!\", \"world\", 4)\n}\n\n#[inline(never)]\n#[no_mangle]\nfn ifmtarg2() -> ~str {\n    ifmt!(\"Hello {:s} for the {:d}th time again!\", \"world\", 4)\n}\n\n#[inline(never)]\n#[no_mangle]\nfn fmtarg3() -> ~str {\n    fmt!(\"Hello %s for the %dth time %s!\", \"world\", 4, \"again\")\n}\n\n#[inline(never)]\n#[no_mangle]\nfn ifmtarg3() -> ~str {\n    ifmt!(\"Hello {:s} for the {:d}th time {:s}!\", \"world\", 4, \"again\")\n}\n\nfn main() {\n}\n```\n\nAnd I got this data:\n\n```\nargs    fmt     ifmt\n0       54      98  + 203 = 301\n1       207     136 + 262 = 398\n2       310     163 + 320 = 483\n3       440     200 + 379 = 579\n```\n\nThe first number for `ifmt` is the code size of the function, and the second number is the size of the static symbol generated for the format string (or at least I think it's the right size). Basically `ifmt` is almost always smaller code at the callsite, but overall a larger code impact. To optimize this it's probably mostly just struct layout in general. I could try to optimize this if we think it's a problem.\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/22290061/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/22297144",
    "html_url": "https://github.com/rust-lang/rust/pull/8245#issuecomment-22297144",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/8245",
    "id": 22297144,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIyMjk3MTQ0",
    "user": {
      "login": "emberian",
      "id": 704250,
      "node_id": "MDQ6VXNlcjcwNDI1MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/704250?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/emberian",
      "html_url": "https://github.com/emberian",
      "followers_url": "https://api.github.com/users/emberian/followers",
      "following_url": "https://api.github.com/users/emberian/following{/other_user}",
      "gists_url": "https://api.github.com/users/emberian/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/emberian/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/emberian/subscriptions",
      "organizations_url": "https://api.github.com/users/emberian/orgs",
      "repos_url": "https://api.github.com/users/emberian/repos",
      "events_url": "https://api.github.com/users/emberian/events{/privacy}",
      "received_events_url": "https://api.github.com/users/emberian/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2013-08-08T01:42:45Z",
    "updated_at": "2013-08-08T01:42:45Z",
    "body": "Closing; in my rollup\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/22297144/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/22297459",
    "html_url": "https://github.com/rust-lang/rust/pull/8245#issuecomment-22297459",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/8245",
    "id": 22297459,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIyMjk3NDU5",
    "user": {
      "login": "emberian",
      "id": 704250,
      "node_id": "MDQ6VXNlcjcwNDI1MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/704250?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/emberian",
      "html_url": "https://github.com/emberian",
      "followers_url": "https://api.github.com/users/emberian/followers",
      "following_url": "https://api.github.com/users/emberian/following{/other_user}",
      "gists_url": "https://api.github.com/users/emberian/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/emberian/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/emberian/subscriptions",
      "organizations_url": "https://api.github.com/users/emberian/orgs",
      "repos_url": "https://api.github.com/users/emberian/repos",
      "events_url": "https://api.github.com/users/emberian/events{/privacy}",
      "received_events_url": "https://api.github.com/users/emberian/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2013-08-08T01:53:56Z",
    "updated_at": "2013-08-08T01:53:56Z",
    "body": "Backing out of my rollup\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/22297459/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
