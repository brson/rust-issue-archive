[
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/123767111",
    "html_url": "https://github.com/rust-lang/rust/pull/27217#issuecomment-123767111",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/27217",
    "id": 123767111,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEyMzc2NzExMQ==",
    "user": {
      "login": "alexcrichton",
      "id": 64996,
      "node_id": "MDQ6VXNlcjY0OTk2",
      "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alexcrichton",
      "html_url": "https://github.com/alexcrichton",
      "followers_url": "https://api.github.com/users/alexcrichton/followers",
      "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}",
      "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions",
      "organizations_url": "https://api.github.com/users/alexcrichton/orgs",
      "repos_url": "https://api.github.com/users/alexcrichton/repos",
      "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alexcrichton/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-07-22T15:50:48Z",
    "updated_at": "2015-07-22T15:50:48Z",
    "body": "What are the effects of having `O_EXCL` specified on unix without `O_CREAT`? It seems somewhat odd that `.read(true).exclusive(true)` can succeed on Windows.\n\nCan you add a few more tests for the various flavors of flags as well? E.g. some cases like `.read(true).exclusive(true)` but also just throwing stuff in like `.truncate(true)` to make sure it doesn't mess with things.\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/123767111/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/123773295",
    "html_url": "https://github.com/rust-lang/rust/pull/27217#issuecomment-123773295",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/27217",
    "id": 123773295,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEyMzc3MzI5NQ==",
    "user": {
      "login": "sfackler",
      "id": 1455697,
      "node_id": "MDQ6VXNlcjE0NTU2OTc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1455697?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sfackler",
      "html_url": "https://github.com/sfackler",
      "followers_url": "https://api.github.com/users/sfackler/followers",
      "following_url": "https://api.github.com/users/sfackler/following{/other_user}",
      "gists_url": "https://api.github.com/users/sfackler/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sfackler/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sfackler/subscriptions",
      "organizations_url": "https://api.github.com/users/sfackler/orgs",
      "repos_url": "https://api.github.com/users/sfackler/repos",
      "events_url": "https://api.github.com/users/sfackler/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sfackler/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-07-22T16:07:02Z",
    "updated_at": "2015-07-22T16:07:02Z",
    "body": "The man page says that the behavior of `O_EXCL` is undefined if `O_CREAT` is not also passed, except for some corner case with block devices.\n\nI can update the unix implementation to be a bit smarter and only tack on `O_EXCL` if `create(true)` and `exclusive(true)`, or return an error in that case on both Windows and Unix, or we can just let the OS work it out. \"Just let the OS work it out\" seems fine to me personally - there's a similar situation of \"silly\" flag combinations with `append(true).truncate(true)` that I don't believe we handle specially.\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/123773295/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/123788986",
    "html_url": "https://github.com/rust-lang/rust/pull/27217#issuecomment-123788986",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/27217",
    "id": 123788986,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEyMzc4ODk4Ng==",
    "user": {
      "login": "alexcrichton",
      "id": 64996,
      "node_id": "MDQ6VXNlcjY0OTk2",
      "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alexcrichton",
      "html_url": "https://github.com/alexcrichton",
      "followers_url": "https://api.github.com/users/alexcrichton/followers",
      "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}",
      "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions",
      "organizations_url": "https://api.github.com/users/alexcrichton/orgs",
      "repos_url": "https://api.github.com/users/alexcrichton/repos",
      "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alexcrichton/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-07-22T16:51:23Z",
    "updated_at": "2015-07-22T16:51:23Z",
    "body": "We currently have another PR (https://github.com/rust-lang/rust/pull/26772) to handle some corner cases like this (which is why I ask). We still have yet to make a decision on that PR, though, although I personally favor the \"let's just call into the OS\" route over \"let's add some verification on our end\" route.\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/123788986/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/125574919",
    "html_url": "https://github.com/rust-lang/rust/pull/27217#issuecomment-125574919",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/27217",
    "id": 125574919,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEyNTU3NDkxOQ==",
    "user": {
      "login": "pitdicker",
      "id": 6255050,
      "node_id": "MDQ6VXNlcjYyNTUwNTA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6255050?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/pitdicker",
      "html_url": "https://github.com/pitdicker",
      "followers_url": "https://api.github.com/users/pitdicker/followers",
      "following_url": "https://api.github.com/users/pitdicker/following{/other_user}",
      "gists_url": "https://api.github.com/users/pitdicker/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/pitdicker/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/pitdicker/subscriptions",
      "organizations_url": "https://api.github.com/users/pitdicker/orgs",
      "repos_url": "https://api.github.com/users/pitdicker/repos",
      "events_url": "https://api.github.com/users/pitdicker/events{/privacy}",
      "received_events_url": "https://api.github.com/users/pitdicker/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-07-28T12:02:27Z",
    "updated_at": "2015-07-28T12:02:27Z",
    "body": "As alexcrichton noted, how should differences between Windows and Unix be handled?\nJust leave it to the os, always fail if `exclusive(true)` is used without `create(true)`, or let `exclusive(true)` imply `create(true)`?\nI prefer the last variant.\n\nCan we have some bikeshedding about the name?\n`exclusive` sounds to me like the locking Windows normally does, where one program can not write to a file while an other has it open.\nSome alternatives:\ncreate_new\nmust_not_exist\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/125574919/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/125583160",
    "html_url": "https://github.com/rust-lang/rust/pull/27217#issuecomment-125583160",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/27217",
    "id": 125583160,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEyNTU4MzE2MA==",
    "user": {
      "login": "pitdicker",
      "id": 6255050,
      "node_id": "MDQ6VXNlcjYyNTUwNTA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6255050?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/pitdicker",
      "html_url": "https://github.com/pitdicker",
      "followers_url": "https://api.github.com/users/pitdicker/followers",
      "following_url": "https://api.github.com/users/pitdicker/following{/other_user}",
      "gists_url": "https://api.github.com/users/pitdicker/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/pitdicker/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/pitdicker/subscriptions",
      "organizations_url": "https://api.github.com/users/pitdicker/orgs",
      "repos_url": "https://api.github.com/users/pitdicker/repos",
      "events_url": "https://api.github.com/users/pitdicker/events{/privacy}",
      "received_events_url": "https://api.github.com/users/pitdicker/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-07-28T12:28:30Z",
    "updated_at": "2015-07-28T12:28:30Z",
    "body": "Besides requiring that a file does not exist, O_EXCL has a special rule on Unix for dealing with symlinks.\nThis is to prevent a vulnerability where a privileged application would follow a symlink to for example `/etc/passwd` and overwrite it.\nSee https://lwn.net/Articles/250468/\n\nThis is not really a vulnerability on Windows, because it is somewhat difficult to create symlinks on it.\nBut if we want to guarantee the same behaviour on both platforms, it is easy to emulate on Windows:\nSet `flags_and_attributes` to `FILE_ATTRIBUTE_NORMAL | FILE_FLAG_OPEN_REPARSE_POINT`\n\nJust to make the behaviour of symlinks with O_EXCL clear, this is what happens when trying to open `dir/file`:\n\n| existing on system | normal | `O_CREAT` | `O_CREAT + O_EXCL` |\n| --- | --- | --- | --- |\n| dir/ | _fails_ | dir/file | dir/file |\n| dir/file | dir/file | dir/file | _fails_ (because dir/file exists) |\n| dir/file->file2 | (depends on file2) | dir/file2 | _fails_ (because dir/file exists) |\n| dir->dir2/ | _fails_ | dir2/file | dir2/file |\n| dir->dir2/file | dir2/file | dir2/file | _fails_ (because dir2/file exists) |\n| dir->dir2/file->file2 | (depends on file2) | dir2/file2 | _fails_ (because dir2/file exists) |\n\nI think this should be mentioned in the documentation, something like:\n`Nothing is allowed to exist on the target location, also no (dangling) symlink.`\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/125583160/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/126753649",
    "html_url": "https://github.com/rust-lang/rust/pull/27217#issuecomment-126753649",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/27217",
    "id": 126753649,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEyNjc1MzY0OQ==",
    "user": {
      "login": "alexcrichton",
      "id": 64996,
      "node_id": "MDQ6VXNlcjY0OTk2",
      "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alexcrichton",
      "html_url": "https://github.com/alexcrichton",
      "followers_url": "https://api.github.com/users/alexcrichton/followers",
      "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}",
      "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions",
      "organizations_url": "https://api.github.com/users/alexcrichton/orgs",
      "repos_url": "https://api.github.com/users/alexcrichton/repos",
      "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alexcrichton/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-07-31T17:06:57Z",
    "updated_at": "2015-07-31T17:06:57Z",
    "body": "This will probably take a relatively similar outcome to https://github.com/rust-lang/rust/pull/26772, and I wrote up some of the libs teams' thoughts here: https://github.com/rust-lang/rust/pull/26772#issuecomment-126753342.\n\nIn general it may be the case that `exclusive(true)` implies `create(true)` instead.\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/126753649/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/126758139",
    "html_url": "https://github.com/rust-lang/rust/pull/27217#issuecomment-126758139",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/27217",
    "id": 126758139,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEyNjc1ODEzOQ==",
    "user": {
      "login": "sfackler",
      "id": 1455697,
      "node_id": "MDQ6VXNlcjE0NTU2OTc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1455697?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sfackler",
      "html_url": "https://github.com/sfackler",
      "followers_url": "https://api.github.com/users/sfackler/followers",
      "following_url": "https://api.github.com/users/sfackler/following{/other_user}",
      "gists_url": "https://api.github.com/users/sfackler/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sfackler/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sfackler/subscriptions",
      "organizations_url": "https://api.github.com/users/sfackler/orgs",
      "repos_url": "https://api.github.com/users/sfackler/repos",
      "events_url": "https://api.github.com/users/sfackler/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sfackler/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-07-31T17:22:53Z",
    "updated_at": "2015-07-31T17:22:53Z",
    "body": "I think I'll wait until #26772 resolves the behavior around implied flags and then update this.\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/126758139/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/143836904",
    "html_url": "https://github.com/rust-lang/rust/pull/27217#issuecomment-143836904",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/27217",
    "id": 143836904,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE0MzgzNjkwNA==",
    "user": {
      "login": "alexcrichton",
      "id": 64996,
      "node_id": "MDQ6VXNlcjY0OTk2",
      "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alexcrichton",
      "html_url": "https://github.com/alexcrichton",
      "followers_url": "https://api.github.com/users/alexcrichton/followers",
      "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}",
      "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions",
      "organizations_url": "https://api.github.com/users/alexcrichton/orgs",
      "repos_url": "https://api.github.com/users/alexcrichton/repos",
      "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alexcrichton/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-09-28T18:35:18Z",
    "updated_at": "2015-09-28T18:35:18Z",
    "body": "I'm going to close this in favor of the associated RFC (https://github.com/rust-lang/rfcs/pull/1252) for `OpenOptions` in general).\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/143836904/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
