[
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/106095155",
    "html_url": "https://github.com/rust-lang/rust/issues/25841#issuecomment-106095155",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/25841",
    "id": 106095155,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEwNjA5NTE1NQ==",
    "user": {
      "login": "huonw",
      "id": 1203825,
      "node_id": "MDQ6VXNlcjEyMDM4MjU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1203825?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/huonw",
      "html_url": "https://github.com/huonw",
      "followers_url": "https://api.github.com/users/huonw/followers",
      "following_url": "https://api.github.com/users/huonw/following{/other_user}",
      "gists_url": "https://api.github.com/users/huonw/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/huonw/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/huonw/subscriptions",
      "organizations_url": "https://api.github.com/users/huonw/orgs",
      "repos_url": "https://api.github.com/users/huonw/repos",
      "events_url": "https://api.github.com/users/huonw/events{/privacy}",
      "received_events_url": "https://api.github.com/users/huonw/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-05-27T22:13:41Z",
    "updated_at": "2015-05-27T22:13:41Z",
    "body": "Good catch! (I wonder if this applies to `std::sync::RwLock`'s read guard too.)\n\ncc https://internals.rust-lang.org/t/rc-is-unsafe-mostly-on-32-bit-targets-due-to-overflow/2120\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/106095155/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/106095709",
    "html_url": "https://github.com/rust-lang/rust/issues/25841#issuecomment-106095709",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/25841",
    "id": 106095709,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEwNjA5NTcwOQ==",
    "user": {
      "login": "nikomatsakis",
      "id": 155238,
      "node_id": "MDQ6VXNlcjE1NTIzOA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/155238?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nikomatsakis",
      "html_url": "https://github.com/nikomatsakis",
      "followers_url": "https://api.github.com/users/nikomatsakis/followers",
      "following_url": "https://api.github.com/users/nikomatsakis/following{/other_user}",
      "gists_url": "https://api.github.com/users/nikomatsakis/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nikomatsakis/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nikomatsakis/subscriptions",
      "organizations_url": "https://api.github.com/users/nikomatsakis/orgs",
      "repos_url": "https://api.github.com/users/nikomatsakis/repos",
      "events_url": "https://api.github.com/users/nikomatsakis/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nikomatsakis/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-05-27T22:15:56Z",
    "updated_at": "2015-05-27T22:15:56Z",
    "body": "This case seems relatively easy to fix, since there are no threading complications -- saturating add (and checking for max before decrementing) is certainly one option.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/106095709/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/106096393",
    "html_url": "https://github.com/rust-lang/rust/issues/25841#issuecomment-106096393",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/25841",
    "id": 106096393,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEwNjA5NjM5Mw==",
    "user": {
      "login": "Veedrac",
      "id": 2867413,
      "node_id": "MDQ6VXNlcjI4Njc0MTM=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2867413?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Veedrac",
      "html_url": "https://github.com/Veedrac",
      "followers_url": "https://api.github.com/users/Veedrac/followers",
      "following_url": "https://api.github.com/users/Veedrac/following{/other_user}",
      "gists_url": "https://api.github.com/users/Veedrac/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Veedrac/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Veedrac/subscriptions",
      "organizations_url": "https://api.github.com/users/Veedrac/orgs",
      "repos_url": "https://api.github.com/users/Veedrac/repos",
      "events_url": "https://api.github.com/users/Veedrac/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Veedrac/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-05-27T22:19:03Z",
    "updated_at": "2015-05-27T22:19:03Z",
    "body": "AFAICT you don't need to check on decrement, assuming you don't allow for compressed storage. After all, you can't run 2^32-1 destructors without 2^32-1 objects, which is infeasible.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/106096393/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/106097463",
    "html_url": "https://github.com/rust-lang/rust/issues/25841#issuecomment-106097463",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/25841",
    "id": 106097463,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEwNjA5NzQ2Mw==",
    "user": {
      "login": "huonw",
      "id": 1203825,
      "node_id": "MDQ6VXNlcjEyMDM4MjU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1203825?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/huonw",
      "html_url": "https://github.com/huonw",
      "followers_url": "https://api.github.com/users/huonw/followers",
      "following_url": "https://api.github.com/users/huonw/following{/other_user}",
      "gists_url": "https://api.github.com/users/huonw/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/huonw/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/huonw/subscriptions",
      "organizations_url": "https://api.github.com/users/huonw/orgs",
      "repos_url": "https://api.github.com/users/huonw/repos",
      "events_url": "https://api.github.com/users/huonw/events{/privacy}",
      "received_events_url": "https://api.github.com/users/huonw/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-05-27T22:25:58Z",
    "updated_at": "2015-05-27T22:25:58Z",
    "body": "> std::sync::RwLock's read guard\n\nOn unix, it's not a direct problem with [the underlying API](http://www.daemon-systems.org/man/pthread_rwlock.3.html):\n\n```\n     The pthread_rwlock_rdlock(), pthread_rwlock_timedrdlock(), and\n     pthread_rwlock_tryrdlock() functions may fail if:\n\n     [EAGAIN]           The lock could not be acquired because the maximum\n                        number of read locks against lock has been exceeded.\n```\n\nHowever, it is a problem with how we use it at the moment:\n\n``` rust\n    #[inline]\n    pub unsafe fn read(&self) {\n        let r = ffi::pthread_rwlock_rdlock(self.inner.get());\n        debug_assert_eq!(r, 0);\n    }\n```\n\nIn particular, creating too many readers will only be detected and \"handled\" (panic) in debug builds. (cc @alexcrichton)\n\nI can't find any info about this for the [windows](https://msdn.microsoft.com/en-us/library/windows/desktop/aa904937%28v=vs.85%29.aspx) APIs.\n\n---\n\n> AFAICT you don't need to check on decrement, assuming you don't allow for compressed storage. After all, you can't run 2^32-1 destructors without 2^32-1 objects, which is infeasible.\n\n`RefCell` behaves just like `Rc` in this respect, and there is more detailed discussion on this point on the internals thread I linked above.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/106097463/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/106103529",
    "html_url": "https://github.com/rust-lang/rust/issues/25841#issuecomment-106103529",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/25841",
    "id": 106103529,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEwNjEwMzUyOQ==",
    "user": {
      "login": "ghost",
      "id": 10137,
      "node_id": "MDQ6VXNlcjEwMTM3",
      "avatar_url": "https://avatars.githubusercontent.com/u/10137?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ghost",
      "html_url": "https://github.com/ghost",
      "followers_url": "https://api.github.com/users/ghost/followers",
      "following_url": "https://api.github.com/users/ghost/following{/other_user}",
      "gists_url": "https://api.github.com/users/ghost/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ghost/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ghost/subscriptions",
      "organizations_url": "https://api.github.com/users/ghost/orgs",
      "repos_url": "https://api.github.com/users/ghost/repos",
      "events_url": "https://api.github.com/users/ghost/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ghost/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-05-27T22:59:03Z",
    "updated_at": "2015-05-27T23:03:43Z",
    "body": "``` rust\nconst WRITING: BorrowFlag = !0;\n```\n\nDoesn't this means that if you ever get to the stage where you will overflow, you'll just trigger an \"already mutably borrowed\" error, no matter how you try to borrow?\n\nI modified the example (because I'm on 64 bit) and ran it (it was optimised out and it ran instantly, whoop):\n\n``` rust\nuse std::cell::RefCell;\n\nfn main() {\n    let overflower = RefCell::new(());\n    loop {\n        std::mem::forget(overflower.borrow());\n    }\n}\n```\n\nOutput:\n\n```\nthread '<main>' panicked at 'RefCell<T> already mutably borrowed', /home/rustbuild/src/rust-buildbot/slave/nightly-dist-rustc-linux/build/src/libcore/cell.rs:392\n```\n\nI guess that the error message is technically wrong but I think it's safe at least?\n",
    "author_association": "NONE",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/106103529/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/106106671",
    "html_url": "https://github.com/rust-lang/rust/issues/25841#issuecomment-106106671",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/25841",
    "id": 106106671,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEwNjEwNjY3MQ==",
    "user": {
      "login": "Veedrac",
      "id": 2867413,
      "node_id": "MDQ6VXNlcjI4Njc0MTM=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2867413?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Veedrac",
      "html_url": "https://github.com/Veedrac",
      "followers_url": "https://api.github.com/users/Veedrac/followers",
      "following_url": "https://api.github.com/users/Veedrac/following{/other_user}",
      "gists_url": "https://api.github.com/users/Veedrac/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Veedrac/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Veedrac/subscriptions",
      "organizations_url": "https://api.github.com/users/Veedrac/orgs",
      "repos_url": "https://api.github.com/users/Veedrac/repos",
      "events_url": "https://api.github.com/users/Veedrac/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Veedrac/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-05-27T23:11:12Z",
    "updated_at": "2015-05-27T23:11:47Z",
    "body": "@whataloadofwhat I can agree with that. Alternatively you can hit a `debug_assert!` in `drop` or get the wrong result from `borrow_state` (unstable), both of which are safe.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/106106671/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/106126147",
    "html_url": "https://github.com/rust-lang/rust/issues/25841#issuecomment-106126147",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/25841",
    "id": 106126147,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEwNjEyNjE0Nw==",
    "user": {
      "login": "retep998",
      "id": 666308,
      "node_id": "MDQ6VXNlcjY2NjMwOA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/666308?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/retep998",
      "html_url": "https://github.com/retep998",
      "followers_url": "https://api.github.com/users/retep998/followers",
      "following_url": "https://api.github.com/users/retep998/following{/other_user}",
      "gists_url": "https://api.github.com/users/retep998/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/retep998/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/retep998/subscriptions",
      "organizations_url": "https://api.github.com/users/retep998/orgs",
      "repos_url": "https://api.github.com/users/retep998/repos",
      "events_url": "https://api.github.com/users/retep998/events{/privacy}",
      "received_events_url": "https://api.github.com/users/retep998/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-05-28T00:44:01Z",
    "updated_at": "2015-05-28T00:44:01Z",
    "body": "> I can't find any info about this for the windows APIs.\n\nOn 32-bit upon reaching exactly 0x10000000 readers, attempts to lock it using the try version will return a failure, while the non-try version will simply deadlock.\nI am still running the 64-bit test, and I will get back to you if I manage to reach the limit.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/106126147/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/106883012",
    "html_url": "https://github.com/rust-lang/rust/issues/25841#issuecomment-106883012",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/25841",
    "id": 106883012,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEwNjg4MzAxMg==",
    "user": {
      "login": "rkjnsn",
      "id": 7364197,
      "node_id": "MDQ6VXNlcjczNjQxOTc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7364197?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/rkjnsn",
      "html_url": "https://github.com/rkjnsn",
      "followers_url": "https://api.github.com/users/rkjnsn/followers",
      "following_url": "https://api.github.com/users/rkjnsn/following{/other_user}",
      "gists_url": "https://api.github.com/users/rkjnsn/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/rkjnsn/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/rkjnsn/subscriptions",
      "organizations_url": "https://api.github.com/users/rkjnsn/orgs",
      "repos_url": "https://api.github.com/users/rkjnsn/repos",
      "events_url": "https://api.github.com/users/rkjnsn/events{/privacy}",
      "received_events_url": "https://api.github.com/users/rkjnsn/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-05-29T17:41:46Z",
    "updated_at": "2015-05-29T17:41:46Z",
    "body": "> AFAICT you don't need to check on decrement, assuming you don't allow for compressed storage. After all, you can't run 2^32-1 destructors without 2^32-1 objects, which is infeasible.\n\n@Stebalien noted the possibility of a wider-than-address-space collection on the [internals discussion](https://internals.rust-lang.org/t/rc-is-unsafe-mostly-on-32-bit-targets-due-to-overflow/2120) about overflows in `Rc`. Rust's memcpy-based move semantics enable the possibility of a collection that can store more objects than would fit in the address space by swapping objects to disk. This would allow the user to create and subsequently destroy more than 2^32 objects.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/106883012/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/253850790",
    "html_url": "https://github.com/rust-lang/rust/issues/25841#issuecomment-253850790",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/25841",
    "id": 253850790,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI1Mzg1MDc5MA==",
    "user": {
      "login": "apasel422",
      "id": 8644784,
      "node_id": "MDQ6VXNlcjg2NDQ3ODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8644784?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/apasel422",
      "html_url": "https://github.com/apasel422",
      "followers_url": "https://api.github.com/users/apasel422/followers",
      "following_url": "https://api.github.com/users/apasel422/following{/other_user}",
      "gists_url": "https://api.github.com/users/apasel422/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/apasel422/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/apasel422/subscriptions",
      "organizations_url": "https://api.github.com/users/apasel422/orgs",
      "repos_url": "https://api.github.com/users/apasel422/repos",
      "events_url": "https://api.github.com/users/apasel422/events{/privacy}",
      "received_events_url": "https://api.github.com/users/apasel422/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2016-10-14T16:25:11Z",
    "updated_at": "2016-10-14T16:25:11Z",
    "body": "Was this fixed by #33960?\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/253850790/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/254334142",
    "html_url": "https://github.com/rust-lang/rust/issues/25841#issuecomment-254334142",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/25841",
    "id": 254334142,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI1NDMzNDE0Mg==",
    "user": {
      "login": "alexcrichton",
      "id": 64996,
      "node_id": "MDQ6VXNlcjY0OTk2",
      "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alexcrichton",
      "html_url": "https://github.com/alexcrichton",
      "followers_url": "https://api.github.com/users/alexcrichton/followers",
      "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}",
      "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions",
      "organizations_url": "https://api.github.com/users/alexcrichton/orgs",
      "repos_url": "https://api.github.com/users/alexcrichton/repos",
      "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alexcrichton/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2016-10-17T21:06:36Z",
    "updated_at": "2016-10-17T21:06:36Z",
    "body": "Indeed fixed!\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/254334142/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
