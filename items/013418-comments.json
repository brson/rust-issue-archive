[
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/39930869",
    "html_url": "https://github.com/rust-lang/rust/pull/13418#issuecomment-39930869",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/13418",
    "id": 39930869,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM5OTMwODY5",
    "user": {
      "login": "ktt3ja",
      "id": 1735399,
      "node_id": "MDQ6VXNlcjE3MzUzOTk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1735399?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ktt3ja",
      "html_url": "https://github.com/ktt3ja",
      "followers_url": "https://api.github.com/users/ktt3ja/followers",
      "following_url": "https://api.github.com/users/ktt3ja/following{/other_user}",
      "gists_url": "https://api.github.com/users/ktt3ja/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ktt3ja/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ktt3ja/subscriptions",
      "organizations_url": "https://api.github.com/users/ktt3ja/orgs",
      "repos_url": "https://api.github.com/users/ktt3ja/repos",
      "events_url": "https://api.github.com/users/ktt3ja/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ktt3ja/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-04-09T05:53:40Z",
    "updated_at": "2014-04-09T05:53:40Z",
    "body": "One caveat I have with this is, for the following function,\n\n``` rust\nfn arg_item(&_x: &~str) {}\n```\n\nThe reported error and note are\n\n``` rust\ntest.rs:20:14: 20:16 note: attempting to move value to here (to prevent the move, you can use `ref _x` to capture value by reference)\ntest.rs:20 fn arg_item(&_x: &~str) {}\n                        ^~\n```\n\nThe user may take it to mean \"replace the function declaration with `fn arg_item(ref _x: &~str) {}`, which is not what is intended. I wonder if it would be better to change the parenthetical remark to \"put `ref` before `_x` to capture value by reference\".\n\nHere are more comparisons of before and after. For the following file:\n\n``` rust\nfn with(f: |&~str|) {}\n\nfn arg_item(&_x: &~str) {}\n    //~^ ERROR cannot move out of dereference of `&`-pointer\n\nfn arg_closure() {\n    with(|&_x| ())\n    //~^ ERROR cannot move out of dereference of `&`-pointer\n}\n\nfn let_pat() {\n    let &_x = &~\"hi\";\n    //~^ ERROR cannot move out of dereference of `&`-pointer\n}\n\n// =================================================================\n\npub fn blah2() {\n    use std::rc::Rc;\n    let _x = *Rc::new(~\"hi\");\n    //~^ ERROR cannot move out of dereference of `&`-pointer\n}\n\n// =================================================================\n\nstruct S {f:~str}\nimpl Drop for S {\n    fn drop(&mut self) { println!(\"{}\", self.f); }\n}\n\nfn move_in_match() {\n    match S {f:~\"foo\"} {\n        S {f:_s} => {}\n        //~^ ERROR cannot move out of type `S`, which defines the `Drop` trait\n    }\n}\n\nfn move_in_let() {\n    let S {f:_s} = S {f:~\"foo\"};\n    //~^ ERROR cannot move out of type `S`, which defines the `Drop` trait\n}\n\nfn move_in_fn_arg(S {f:_s}: S) {\n    //~^ ERROR cannot move out of type `S`, which defines the `Drop` trait\n}\n\n// =================================================================\n\nstruct A {\n    a: ~int\n}\n\nfn free<T>(_: T) {}\n\nfn blah3() {\n    let a = &A { a: ~1 };\n    match a.a {\n        n => { free(n) }\n    }\n    free(a)\n}\n\n// =================================================================\n\nfn blah4() {\n    let bar = ~3;\n    let _g = || {\n        let _h: proc() -> int = proc() *bar; //~ ERROR cannot move out of captured outer variable\n    };\n}\n\n// =================================================================\n\nfn main() {}\n```\n\nBefore:\n\n``` rust\ntest.rs:3:13: 3:16 error: cannot move out of dereference of `&`-pointer\ntest.rs:3 fn arg_item(&_x: &~str) {}\n                      ^~~\ntest.rs:7:11: 7:14 error: cannot move out of dereference of `&`-pointer\ntest.rs:7     with(|&_x| ())\n                    ^~~\ntest.rs:12:9: 12:12 error: cannot move out of dereference of `&`-pointer\ntest.rs:12     let &_x = &~\"hi\";\n                   ^~~\ntest.rs:20:14: 20:29 error: cannot move out of dereference of `&`-pointer\ntest.rs:20     let _x = *Rc::new(~\"hi\");\n                        ^~~~~~~~~~~~~~~\ntest.rs:33:9: 33:17 error: cannot move out of type `S`, which defines the `Drop` trait\ntest.rs:33         S {f:_s} => {}\n                   ^~~~~~~~\ntest.rs:39:9: 39:17 error: cannot move out of type `S`, which defines the `Drop` trait\ntest.rs:39     let S {f:_s} = S {f:~\"foo\"};\n                   ^~~~~~~~\ntest.rs:43:19: 43:27 error: cannot move out of type `S`, which defines the `Drop` trait\ntest.rs:43 fn move_in_fn_arg(S {f:_s}: S) {\n                             ^~~~~~~~\ntest.rs:57:11: 57:14 error: cannot move out of dereference of `&`-pointer\ntest.rs:57     match a.a {\n                     ^~~\ntest.rs:68:33: 68:44 error: cannot move out of captured outer variable\ntest.rs:68         let _h: proc() -> int = proc() *bar; //~ ERROR cannot move out of captured outer variable\n                                           ^~~~~~~~~~~\n```\n\nAfter:\n\n``` rust\ntest.rs:3:13: 3:16 error: cannot move out of dereference of `&`-pointer\ntest.rs:3 fn arg_item(&_x: &~str) {}\n                      ^~~\ntest.rs:3:14: 3:16 note: attempting to move value to here (to prevent the move, you can use `ref _x` to capture value by reference)\ntest.rs:3 fn arg_item(&_x: &~str) {}\n                       ^~\ntest.rs:7:11: 7:14 error: cannot move out of dereference of `&`-pointer\ntest.rs:7     with(|&_x| ())\n                    ^~~\ntest.rs:7:12: 7:14 note: attempting to move value to here (to prevent the move, you can use `ref _x` to capture value by reference)\ntest.rs:7     with(|&_x| ())\n                     ^~\ntest.rs:12:9: 12:12 error: cannot move out of dereference of `&`-pointer\ntest.rs:12     let &_x = &~\"hi\";\n                   ^~~\ntest.rs:12:10: 12:12 note: attempting to move value to here (to prevent the move, you can use `ref _x` to capture value by reference)\ntest.rs:12     let &_x = &~\"hi\";\n                    ^~\ntest.rs:20:14: 20:29 error: cannot move out of dereference of `&`-pointer\ntest.rs:20     let _x = *Rc::new(~\"hi\");\n                        ^~~~~~~~~~~~~~~\ntest.rs:20:9: 20:11 note: attempting to move value to here (to prevent the move, you can use `ref _x` to capture value by reference)\ntest.rs:20     let _x = *Rc::new(~\"hi\");\n                   ^~\ntest.rs:33:9: 33:17 error: cannot move out of type `S`, which defines the `Drop` trait\ntest.rs:33         S {f:_s} => {}\n                   ^~~~~~~~\ntest.rs:33:14: 33:16 note: attempting to move value to here (to prevent the move, you can use `ref _s` to capture value by reference)\ntest.rs:33         S {f:_s} => {}\n                        ^~\ntest.rs:39:9: 39:17 error: cannot move out of type `S`, which defines the `Drop` trait\ntest.rs:39     let S {f:_s} = S {f:~\"foo\"};\n                   ^~~~~~~~\ntest.rs:39:14: 39:16 note: attempting to move value to here (to prevent the move, you can use `ref _s` to capture value by reference)\ntest.rs:39     let S {f:_s} = S {f:~\"foo\"};\n                        ^~\ntest.rs:43:19: 43:27 error: cannot move out of type `S`, which defines the `Drop` trait\ntest.rs:43 fn move_in_fn_arg(S {f:_s}: S) {\n                             ^~~~~~~~\ntest.rs:43:24: 43:26 note: attempting to move value to here (to prevent the move, you can use `ref _s` to capture value by reference)\ntest.rs:43 fn move_in_fn_arg(S {f:_s}: S) {\n                                  ^~\ntest.rs:57:11: 57:12 error: cannot move out of dereference of `&`-pointer\ntest.rs:57     match a.a {\n                     ^\ntest.rs:58:9: 58:10 note: attempting to move value to here (to prevent the move, you can use `ref n` to capture value by reference)\ntest.rs:58         n => { free(n) }\n                   ^\ntest.rs:68:33: 68:44 error: cannot move out of captured outer variable\ntest.rs:68         let _h: proc() -> int = proc() *bar; //~ ERROR cannot move out of captured outer variable\n                                           ^~~~~~~~~~~\n```\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/39930869/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/39931818",
    "html_url": "https://github.com/rust-lang/rust/pull/13418#issuecomment-39931818",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/13418",
    "id": 39931818,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM5OTMxODE4",
    "user": {
      "login": "huonw",
      "id": 1203825,
      "node_id": "MDQ6VXNlcjEyMDM4MjU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1203825?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/huonw",
      "html_url": "https://github.com/huonw",
      "followers_url": "https://api.github.com/users/huonw/followers",
      "following_url": "https://api.github.com/users/huonw/following{/other_user}",
      "gists_url": "https://api.github.com/users/huonw/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/huonw/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/huonw/subscriptions",
      "organizations_url": "https://api.github.com/users/huonw/orgs",
      "repos_url": "https://api.github.com/users/huonw/repos",
      "events_url": "https://api.github.com/users/huonw/events{/privacy}",
      "received_events_url": "https://api.github.com/users/huonw/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-04-09T06:15:44Z",
    "updated_at": "2014-04-09T06:15:44Z",
    "body": "Does this attempt to work out if `ref mut` is appropriate for the \"to prevent the move...\" bit? (If not, maybe `ref mut` should be mentioned too.)\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/39931818/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/39932431",
    "html_url": "https://github.com/rust-lang/rust/pull/13418#issuecomment-39932431",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/13418",
    "id": 39932431,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM5OTMyNDMx",
    "user": {
      "login": "ktt3ja",
      "id": 1735399,
      "node_id": "MDQ6VXNlcjE3MzUzOTk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1735399?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ktt3ja",
      "html_url": "https://github.com/ktt3ja",
      "followers_url": "https://api.github.com/users/ktt3ja/followers",
      "following_url": "https://api.github.com/users/ktt3ja/following{/other_user}",
      "gists_url": "https://api.github.com/users/ktt3ja/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ktt3ja/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ktt3ja/subscriptions",
      "organizations_url": "https://api.github.com/users/ktt3ja/orgs",
      "repos_url": "https://api.github.com/users/ktt3ja/repos",
      "events_url": "https://api.github.com/users/ktt3ja/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ktt3ja/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-04-09T06:29:21Z",
    "updated_at": "2014-04-09T06:33:30Z",
    "body": "@huonw: I will change the message to mention `ref mut`, too, when I get back to working on this later. It just didn't occur to me, so thanks! \n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/39932431/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/40024749",
    "html_url": "https://github.com/rust-lang/rust/pull/13418#issuecomment-40024749",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/13418",
    "id": 40024749,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQwMDI0NzQ5",
    "user": {
      "login": "ktt3ja",
      "id": 1735399,
      "node_id": "MDQ6VXNlcjE3MzUzOTk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1735399?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ktt3ja",
      "html_url": "https://github.com/ktt3ja",
      "followers_url": "https://api.github.com/users/ktt3ja/followers",
      "following_url": "https://api.github.com/users/ktt3ja/following{/other_user}",
      "gists_url": "https://api.github.com/users/ktt3ja/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ktt3ja/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ktt3ja/subscriptions",
      "organizations_url": "https://api.github.com/users/ktt3ja/orgs",
      "repos_url": "https://api.github.com/users/ktt3ja/repos",
      "events_url": "https://api.github.com/users/ktt3ja/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ktt3ja/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-04-09T22:32:48Z",
    "updated_at": "2014-04-09T22:32:48Z",
    "body": "Hmm, sadly, when we are matching against a vector, the error-reporting behavior is inconsistent with the rest (the error is on the arm instead of the expression we are matching against):\n\n``` rust\nfn c() {\n    let mut vec = vec!(~1, ~2, ~3);\n    let vec: &mut [~int] = vec.as_mut_slice();\n    match vec {\n        [_a, ..b] => {}\n        _ => {}\n    }\n}\n\ntest.rs:5:9: 5:18 error: cannot move out of dereference of `&mut`-pointer\ntest.rs:5         [_a, ..b] => {}\n                  ^~~~~~~~~\ntest.rs:5:10: 5:12 note: attempting to move value to here (to prevent the move, you can use `ref _a` to capture value by reference)\ntest.rs:5         [_a, ..b] => {}\n                   ^~\n```\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/40024749/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/40166962",
    "html_url": "https://github.com/rust-lang/rust/pull/13418#issuecomment-40166962",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/13418",
    "id": 40166962,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQwMTY2OTYy",
    "user": {
      "login": "brson",
      "id": 147214,
      "node_id": "MDQ6VXNlcjE0NzIxNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/brson",
      "html_url": "https://github.com/brson",
      "followers_url": "https://api.github.com/users/brson/followers",
      "following_url": "https://api.github.com/users/brson/following{/other_user}",
      "gists_url": "https://api.github.com/users/brson/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/brson/subscriptions",
      "organizations_url": "https://api.github.com/users/brson/orgs",
      "repos_url": "https://api.github.com/users/brson/repos",
      "events_url": "https://api.github.com/users/brson/events{/privacy}",
      "received_events_url": "https://api.github.com/users/brson/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-04-11T03:08:41Z",
    "updated_at": "2014-04-11T03:08:41Z",
    "body": "I love these error reporting improvements. :thumbsup: \n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/40166962/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/40226421",
    "html_url": "https://github.com/rust-lang/rust/pull/13418#issuecomment-40226421",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/13418",
    "id": 40226421,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQwMjI2NDIx",
    "user": {
      "login": "ktt3ja",
      "id": 1735399,
      "node_id": "MDQ6VXNlcjE3MzUzOTk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1735399?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ktt3ja",
      "html_url": "https://github.com/ktt3ja",
      "followers_url": "https://api.github.com/users/ktt3ja/followers",
      "following_url": "https://api.github.com/users/ktt3ja/following{/other_user}",
      "gists_url": "https://api.github.com/users/ktt3ja/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ktt3ja/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ktt3ja/subscriptions",
      "organizations_url": "https://api.github.com/users/ktt3ja/orgs",
      "repos_url": "https://api.github.com/users/ktt3ja/repos",
      "events_url": "https://api.github.com/users/ktt3ja/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ktt3ja/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-04-11T17:06:35Z",
    "updated_at": "2014-04-11T17:06:35Z",
    "body": "The span note has been changed from:\n\n```\nattempting to move value to here (to prevent the move, you can use `ref num1` to capture value by reference)\n```\n\nto\n\n```\nattempting to move value to here (to prevent the move, use `ref num1` or `ref mut num1` to capture value by reference)\n```\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/40226421/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
