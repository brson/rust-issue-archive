{
  "url": "https://api.github.com/repos/rust-lang/rust/issues/12039",
  "repository_url": "https://api.github.com/repos/rust-lang/rust",
  "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/12039/labels{/name}",
  "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/12039/comments",
  "events_url": "https://api.github.com/repos/rust-lang/rust/issues/12039/events",
  "html_url": "https://github.com/rust-lang/rust/pull/12039",
  "id": 26935578,
  "node_id": "MDExOlB1bGxSZXF1ZXN0MTIyMDg0ODk=",
  "number": 12039,
  "title": "Remove std::condition",
  "user": {
    "login": "alexcrichton",
    "id": 64996,
    "node_id": "MDQ6VXNlcjY0OTk2",
    "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/alexcrichton",
    "html_url": "https://github.com/alexcrichton",
    "followers_url": "https://api.github.com/users/alexcrichton/followers",
    "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}",
    "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions",
    "organizations_url": "https://api.github.com/users/alexcrichton/orgs",
    "repos_url": "https://api.github.com/users/alexcrichton/repos",
    "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}",
    "received_events_url": "https://api.github.com/users/alexcrichton/received_events",
    "type": "User",
    "user_view_type": "public",
    "site_admin": false
  },
  "labels": [],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [],
  "milestone": null,
  "comments": 10,
  "created_at": "2014-02-05T03:27:20Z",
  "updated_at": "2014-06-12T09:46:40Z",
  "closed_at": "2014-02-07T02:26:31Z",
  "author_association": "MEMBER",
  "type": null,
  "active_lock_reason": null,
  "draft": false,
  "pull_request": {
    "url": "https://api.github.com/repos/rust-lang/rust/pulls/12039",
    "html_url": "https://github.com/rust-lang/rust/pull/12039",
    "diff_url": "https://github.com/rust-lang/rust/pull/12039.diff",
    "patch_url": "https://github.com/rust-lang/rust/pull/12039.patch",
    "merged_at": "2014-02-07T02:26:32Z"
  },
  "body": "This has been a long time coming. Conditions in rust were initially envisioned\nas being a good alternative to error code return pattern. The idea is that all\nerrors are fatal-by-default, and you can opt-in to handling the error by\nregistering an error handler.\n\nWhile sounding nice, conditions ended up having some unforseen shortcomings:\n- Actually handling an error has some very awkward syntax:\n  \n  ```\n  let mut result = None;                                        \n  let mut answer = None;                                        \n  io::io_error::cond.trap(|e| { result = Some(e) }).inside(|| { \n      answer = Some(some_io_operation());                       \n  });                                                           \n  match result {                                                \n      Some(err) => { /* hit an I/O error */ }                   \n      None => {                                                 \n          let answer = answer.unwrap();                         \n          /* deal with the result of I/O */                     \n      }                                                         \n  }                                                             \n  ```\n  \n  This pattern can certainly use functions like io::result, but at its core\n  actually handling conditions is fairly difficult\n- The \"zero value\" of a function is often confusing. One of the main ideas\n  behind using conditions was to change the signature of I/O functions. Instead\n  of read_be_u32() returning a result, it returned a u32. Errors were notified\n  via a condition, and if you caught the condition you understood that the \"zero\n  value\" returned is actually a garbage value. These zero values are often\n  difficult to understand, however.\n  \n  One case of this is the read_bytes() function. The function takes an integer\n  length of the amount of bytes to read, and returns an array of that size. The\n  array may actually be shorter, however, if an error occurred.\n  \n  Another case is fs::stat(). The theoretical \"zero value\" is a blank stat\n  struct, but it's a little awkward to create and return a zero'd out stat\n  struct on a call to stat().\n  \n  In general, the return value of functions that can raise error are much more\n  natural when using a Result as opposed to an always-usable zero-value.\n- Conditions impose a necessary runtime requirement on _all_ I/O. In theory I/O\n  is as simple as calling read() and write(), but using conditions imposed the\n  restriction that a rust local task was required if you wanted to catch errors\n  with I/O. While certainly an surmountable difficulty, this was always a bit of\n  a thorn in the side of conditions.\n- Functions raising conditions are not always clear that they are raising\n  conditions. This suffers a similar problem to exceptions where you don't\n  actually know whether a function raises a condition or not. The documentation\n  likely explains, but if someone retroactively adds a condition to a function\n  there's nothing forcing upstream users to acknowledge a new point of task\n  failure.\n- Libaries using I/O are not guaranteed to correctly raise on conditions when an\n  error occurs. In developing various I/O libraries, it's much easier to just\n  return `None` from a read rather than raising an error. The silent contract of\n  \"don't raise on EOF\" was a little difficult to understand and threw a wrench\n  into the answer of the question \"when do I raise a condition?\"\n\nMany of these difficulties can be overcome through documentation, examples, and\ngeneral practice. In the end, all of these difficulties added together ended up\nbeing too overwhelming and improving various aspects didn't end up helping that\nmuch.\n\nA result-based I/O error handling strategy also has shortcomings, but the\ncognitive burden is much smaller. The tooling necessary to make this strategy as\nusable as conditions were is much smaller than the tooling necessary for\nconditions.\n\nPerhaps conditions may manifest themselves as a future entity, but for now\nwe're going to remove them from the standard library.\n\nCloses #9795\nCloses #8968\n",
  "closed_by": {
    "login": "bors",
    "id": 3372342,
    "node_id": "MDQ6VXNlcjMzNzIzNDI=",
    "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/bors",
    "html_url": "https://github.com/bors",
    "followers_url": "https://api.github.com/users/bors/followers",
    "following_url": "https://api.github.com/users/bors/following{/other_user}",
    "gists_url": "https://api.github.com/users/bors/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/bors/subscriptions",
    "organizations_url": "https://api.github.com/users/bors/orgs",
    "repos_url": "https://api.github.com/users/bors/repos",
    "events_url": "https://api.github.com/users/bors/events{/privacy}",
    "received_events_url": "https://api.github.com/users/bors/received_events",
    "type": "User",
    "user_view_type": "public",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/12039/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/12039/timeline",
  "performed_via_github_app": null,
  "state_reason": null,
  "_meta": {
    "type": "pr"
  }
}
