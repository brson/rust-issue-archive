[
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/46234262",
    "html_url": "https://github.com/rust-lang/rust/issues/14937#issuecomment-46234262",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/14937",
    "id": 46234262,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ2MjM0MjYy",
    "user": {
      "login": "alexcrichton",
      "id": 64996,
      "node_id": "MDQ6VXNlcjY0OTk2",
      "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alexcrichton",
      "html_url": "https://github.com/alexcrichton",
      "followers_url": "https://api.github.com/users/alexcrichton/followers",
      "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}",
      "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions",
      "organizations_url": "https://api.github.com/users/alexcrichton/orgs",
      "repos_url": "https://api.github.com/users/alexcrichton/repos",
      "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alexcrichton/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-06-16T20:45:55Z",
    "updated_at": "2014-06-16T20:45:55Z",
    "body": "I think that type parameters may only be half the problem, this is still a problem with all RAII-like structures with lifetimes, which are liberally used in the standard library. For example, this innocuous looking code triggers valgrind errors:\n\n``` rust\nuse std::cell::RefCell;\nfn main() {\n    let b = {\n        let a = box RefCell::new(4);\n        *a.borrow() + 1\n    };\n    println!(\"{}\", b);\n}\n```\n\n```\n$ valgrind ./foo\n==9880== Memcheck, a memory error detector\n==9880== Copyright (C) 2002-2013, and GNU GPL'd, by Julian Seward et al.\n==9880== Using Valgrind-3.10.0.SVN and LibVEX; rerun with -h for copyright info\n==9880== Command: ./foo\n==9880== \n==9880== Invalid read of size 8\n==9880==    at 0x403AC2: cell::Cell$LT$T$GT$::get::h14749520627650063431::v0.0 (in /home/alex/foo)\n==9880==    by 0x403C2A: cell::Ref$LT$$x27b$C$$x20T$GT$.Drop::drop::h5517615880807730945::v0.0 (in /home/alex/foo)\n==9880==    by 0x40406A: core..cell..Ref$LT$$x27_$C$int$GT$::glue_drop.1537::h7a74728680c53b3a (in /home/alex/foo)\n==9880==    by 0x4031E1: main::hfd2b07b8610388fafaa::v0.0 (in /home/alex/foo)\n==9880==    by 0x447512: start::closure.7199 (in /home/alex/foo)\n==9880==    by 0x463862: task::Task::run::closure.5303 (in /home/alex/foo)\n==9880==    by 0x466C4B: rust_try (in /home/alex/foo)\n==9880==    by 0x465565: unwind::try::h7d720262cba71fd0fGd::v0.11.0.pre (in /home/alex/foo)\n==9880==    by 0x463714: task::Task::run::hac578e5b353eedcbVVc::v0.11.0.pre (in /home/alex/foo)\n==9880==    by 0x4472CD: start::h0149aeff7c3a4b69Jme::v0.11.0.pre (in /home/alex/foo)\n==9880==    by 0x447098: lang_start::h3e00b03c17efac073le::v0.11.0.pre (in /home/alex/foo)\n==9880==    by 0x40332E: main (in /home/alex/foo)\n==9880==  Address 0x6014058 is 8 bytes inside a block of size 16 free'd\n==9880==    at 0x471379: je_dallocx (in /home/alex/foo)\n==9880==    by 0x40371F: heap::deallocate::h7bc897bb314e6fc3Bfa::v0.0 (in /home/alex/foo)\n==9880==    by 0x403699: heap::exchange_free::h3a6062ae495b91fcefa::v0.0 (in /home/alex/foo)\n==9880==    by 0x403FA0: _$UP$i8::glue_drop.1534::h08c160eb1ce0fd99 (in /home/alex/foo)\n==9880==    by 0x4031D4: main::hfd2b07b8610388fafaa::v0.0 (in /home/alex/foo)\n==9880==    by 0x447512: start::closure.7199 (in /home/alex/foo)\n==9880==    by 0x463862: task::Task::run::closure.5303 (in /home/alex/foo)\n==9880==    by 0x466C4B: rust_try (in /home/alex/foo)\n==9880==    by 0x465565: unwind::try::h7d720262cba71fd0fGd::v0.11.0.pre (in /home/alex/foo)\n==9880==    by 0x463714: task::Task::run::hac578e5b353eedcbVVc::v0.11.0.pre (in /home/alex/foo)\n==9880==    by 0x4472CD: start::h0149aeff7c3a4b69Jme::v0.11.0.pre (in /home/alex/foo)\n==9880==    by 0x447098: lang_start::h3e00b03c17efac073le::v0.11.0.pre (in /home/alex/foo)\n==9880== \n==9880== Invalid write of size 8\n==9880==    at 0x403B4A: cell::Cell$LT$T$GT$::set::h11020375487951902910::v0.0 (in /home/alex/foo)\n==9880==    by 0x403DA8: cell::Ref$LT$$x27b$C$$x20T$GT$.Drop::drop::h5517615880807730945::v0.0 (in /home/alex/foo)\n==9880==    by 0x40406A: core..cell..Ref$LT$$x27_$C$int$GT$::glue_drop.1537::h7a74728680c53b3a (in /home/alex/foo)\n==9880==    by 0x4031E1: main::hfd2b07b8610388fafaa::v0.0 (in /home/alex/foo)\n==9880==    by 0x447512: start::closure.7199 (in /home/alex/foo)\n==9880==    by 0x463862: task::Task::run::closure.5303 (in /home/alex/foo)\n==9880==    by 0x466C4B: rust_try (in /home/alex/foo)\n==9880==    by 0x465565: unwind::try::h7d720262cba71fd0fGd::v0.11.0.pre (in /home/alex/foo)\n==9880==    by 0x463714: task::Task::run::hac578e5b353eedcbVVc::v0.11.0.pre (in /home/alex/foo)\n==9880==    by 0x4472CD: start::h0149aeff7c3a4b69Jme::v0.11.0.pre (in /home/alex/foo)\n==9880==    by 0x447098: lang_start::h3e00b03c17efac073le::v0.11.0.pre (in /home/alex/foo)\n==9880==    by 0x40332E: main (in /home/alex/foo)\n==9880==  Address 0x6014058 is 8 bytes inside a block of size 16 free'd\n==9880==    at 0x471379: je_dallocx (in /home/alex/foo)\n==9880==    by 0x40371F: heap::deallocate::h7bc897bb314e6fc3Bfa::v0.0 (in /home/alex/foo)\n==9880==    by 0x403699: heap::exchange_free::h3a6062ae495b91fcefa::v0.0 (in /home/alex/foo)\n==9880==    by 0x403FA0: _$UP$i8::glue_drop.1534::h08c160eb1ce0fd99 (in /home/alex/foo)\n==9880==    by 0x4031D4: main::hfd2b07b8610388fafaa::v0.0 (in /home/alex/foo)\n==9880==    by 0x447512: start::closure.7199 (in /home/alex/foo)\n==9880==    by 0x463862: task::Task::run::closure.5303 (in /home/alex/foo)\n==9880==    by 0x466C4B: rust_try (in /home/alex/foo)\n==9880==    by 0x465565: unwind::try::h7d720262cba71fd0fGd::v0.11.0.pre (in /home/alex/foo)\n==9880==    by 0x463714: task::Task::run::hac578e5b353eedcbVVc::v0.11.0.pre (in /home/alex/foo)\n==9880==    by 0x4472CD: start::h0149aeff7c3a4b69Jme::v0.11.0.pre (in /home/alex/foo)\n==9880==    by 0x447098: lang_start::h3e00b03c17efac073le::v0.11.0.pre (in /home/alex/foo)\n==9880== \n5\n==9880== \n==9880== HEAP SUMMARY:\n==9880==     in use at exit: 0 bytes in 0 blocks\n==9880==   total heap usage: 18 allocs, 18 frees, 2,016 bytes allocated\n==9880== \n==9880== All heap blocks were freed -- no leaks are possible\n==9880== \n==9880== For counts of detected and suppressed errors, rerun with: -v\n==9880== ERROR SUMMARY: 2 errors from 2 contexts (suppressed: 0 from 0)\n```\n\nAs much as I'd love to punt on things for 1.0, this seems like a serious issue we need to fix.\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/46234262/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/46619319",
    "html_url": "https://github.com/rust-lang/rust/issues/14937#issuecomment-46619319",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/14937",
    "id": 46619319,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ2NjE5MzE5",
    "user": {
      "login": "brson",
      "id": 147214,
      "node_id": "MDQ6VXNlcjE0NzIxNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/brson",
      "html_url": "https://github.com/brson",
      "followers_url": "https://api.github.com/users/brson/followers",
      "following_url": "https://api.github.com/users/brson/following{/other_user}",
      "gists_url": "https://api.github.com/users/brson/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/brson/subscriptions",
      "organizations_url": "https://api.github.com/users/brson/orgs",
      "repos_url": "https://api.github.com/users/brson/repos",
      "events_url": "https://api.github.com/users/brson/events{/privacy}",
      "received_events_url": "https://api.github.com/users/brson/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-06-19T21:29:41Z",
    "updated_at": "2014-06-19T21:29:41Z",
    "body": "1.0, P-backcompat-lang\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/46619319/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/46739074",
    "html_url": "https://github.com/rust-lang/rust/issues/14937#issuecomment-46739074",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/14937",
    "id": 46739074,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ2NzM5MDc0",
    "user": {
      "login": "pcwalton",
      "id": 157897,
      "node_id": "MDQ6VXNlcjE1Nzg5Nw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/157897?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/pcwalton",
      "html_url": "https://github.com/pcwalton",
      "followers_url": "https://api.github.com/users/pcwalton/followers",
      "following_url": "https://api.github.com/users/pcwalton/following{/other_user}",
      "gists_url": "https://api.github.com/users/pcwalton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/pcwalton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/pcwalton/subscriptions",
      "organizations_url": "https://api.github.com/users/pcwalton/orgs",
      "repos_url": "https://api.github.com/users/pcwalton/repos",
      "events_url": "https://api.github.com/users/pcwalton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/pcwalton/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-06-21T00:27:55Z",
    "updated_at": "2014-06-21T00:27:55Z",
    "body": "Closed by dcbf4ec2a1.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/46739074/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
