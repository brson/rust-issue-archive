[
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/46133864",
    "html_url": "https://github.com/rust-lang/rust/pull/14904#issuecomment-46133864",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/14904",
    "id": 46133864,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ2MTMzODY0",
    "user": {
      "login": "alexcrichton",
      "id": 64996,
      "node_id": "MDQ6VXNlcjY0OTk2",
      "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alexcrichton",
      "html_url": "https://github.com/alexcrichton",
      "followers_url": "https://api.github.com/users/alexcrichton/followers",
      "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}",
      "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions",
      "organizations_url": "https://api.github.com/users/alexcrichton/orgs",
      "repos_url": "https://api.github.com/users/alexcrichton/repos",
      "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alexcrichton/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-06-16T01:12:00Z",
    "updated_at": "2014-06-16T01:12:00Z",
    "body": "I believe that this was explicitly not done before due to the hazards of invoking `as_ptr`. I have seen code similarly to this recently, which is often difficult to debug:\n\n``` rust\nfn foo(s: &str) -> *c_char { \n    s.to_c_str().as_ptr() \n}\n```\n\nThat is an example behind the reasoning of the initial decision. I, however, prefer `as_ptr()` to `with_ref()`. RAII is much more common than it when the `c_str` module was written. This probably warrants some discussion, however, to revert the explicit original decision to not include this function.\n\nStylistically, could you add some comments to the dangers of dealing with the return value of `as_ptr`?\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/46133864/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/46134249",
    "html_url": "https://github.com/rust-lang/rust/pull/14904#issuecomment-46134249",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/14904",
    "id": 46134249,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ2MTM0MjQ5",
    "user": {
      "login": "huonw",
      "id": 1203825,
      "node_id": "MDQ6VXNlcjEyMDM4MjU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1203825?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/huonw",
      "html_url": "https://github.com/huonw",
      "followers_url": "https://api.github.com/users/huonw/followers",
      "following_url": "https://api.github.com/users/huonw/following{/other_user}",
      "gists_url": "https://api.github.com/users/huonw/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/huonw/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/huonw/subscriptions",
      "organizations_url": "https://api.github.com/users/huonw/orgs",
      "repos_url": "https://api.github.com/users/huonw/repos",
      "events_url": "https://api.github.com/users/huonw/events{/privacy}",
      "received_events_url": "https://api.github.com/users/huonw/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-06-16T01:24:35Z",
    "updated_at": "2014-06-16T01:24:35Z",
    "body": "That's a good point. Will do!\n\nI wonder if it we could assist by having a lint like `#[must_use]`, something like\n\n``` rust\n#[returns_internal_raw_pointer]\nfn as_ptr(&self) -> *c_char { ... }\n\nlet p = x.to_c_str().as_ptr(); // warning: internal raw pointer may be invalidated at the end of this statement\n```\n\nHowever, I'm not sure when else this would be useful so may be pointless.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/46134249/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/46624603",
    "html_url": "https://github.com/rust-lang/rust/pull/14904#issuecomment-46624603",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/14904",
    "id": 46624603,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ2NjI0NjAz",
    "user": {
      "login": "huonw",
      "id": 1203825,
      "node_id": "MDQ6VXNlcjEyMDM4MjU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1203825?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/huonw",
      "html_url": "https://github.com/huonw",
      "followers_url": "https://api.github.com/users/huonw/followers",
      "following_url": "https://api.github.com/users/huonw/following{/other_user}",
      "gists_url": "https://api.github.com/users/huonw/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/huonw/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/huonw/subscriptions",
      "organizations_url": "https://api.github.com/users/huonw/orgs",
      "repos_url": "https://api.github.com/users/huonw/repos",
      "events_url": "https://api.github.com/users/huonw/events{/privacy}",
      "received_events_url": "https://api.github.com/users/huonw/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-06-19T22:20:38Z",
    "updated_at": "2014-06-19T22:20:38Z",
    "body": "r? @alexcrichton (added docs and expanded the first commit message)\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/46624603/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/47548709",
    "html_url": "https://github.com/rust-lang/rust/pull/14904#issuecomment-47548709",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/14904",
    "id": 47548709,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ3NTQ4NzA5",
    "user": {
      "login": "mvdnes",
      "id": 1009841,
      "node_id": "MDQ6VXNlcjEwMDk4NDE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1009841?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mvdnes",
      "html_url": "https://github.com/mvdnes",
      "followers_url": "https://api.github.com/users/mvdnes/followers",
      "following_url": "https://api.github.com/users/mvdnes/following{/other_user}",
      "gists_url": "https://api.github.com/users/mvdnes/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mvdnes/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mvdnes/subscriptions",
      "organizations_url": "https://api.github.com/users/mvdnes/orgs",
      "repos_url": "https://api.github.com/users/mvdnes/repos",
      "events_url": "https://api.github.com/users/mvdnes/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mvdnes/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-06-30T15:49:28Z",
    "updated_at": "2014-06-30T15:49:28Z",
    "body": "I was wondering if the `as_ptr()` should be unsafe? I know that to use the result, an unsafe block is needed. However, this way a bug such as calling `let p = x.to_c_str().as_ptr()` may occur outside of an unsafe block, and thus will be harder to find.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/47548709/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
