[
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/58796638",
    "html_url": "https://github.com/rust-lang/rust/issues/17959#issuecomment-58796638",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/17959",
    "id": 58796638,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU4Nzk2NjM4",
    "user": {
      "login": "little-arhat",
      "id": 240531,
      "node_id": "MDQ6VXNlcjI0MDUzMQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/240531?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/little-arhat",
      "html_url": "https://github.com/little-arhat",
      "followers_url": "https://api.github.com/users/little-arhat/followers",
      "following_url": "https://api.github.com/users/little-arhat/following{/other_user}",
      "gists_url": "https://api.github.com/users/little-arhat/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/little-arhat/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/little-arhat/subscriptions",
      "organizations_url": "https://api.github.com/users/little-arhat/orgs",
      "repos_url": "https://api.github.com/users/little-arhat/repos",
      "events_url": "https://api.github.com/users/little-arhat/events{/privacy}",
      "received_events_url": "https://api.github.com/users/little-arhat/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-10-12T12:53:58Z",
    "updated_at": "2014-10-12T12:53:58Z",
    "body": "With small changes in source code rustc produces slightly different error.\n\nHere is changed version (note addition of GBox):\n\n```\n#![feature(unsafe_destructor)]\n\nextern crate core;\n\nuse core::ops::Drop;\n\n\ntrait Bar {}\n\nstruct GBox<Sized? T> {\n    value: T\n}\n\nstruct G<Sized? T> {\n    _ptr: *mut GBox<T>\n}\n\n#[unsafe_destructor]\nimpl<T> Drop for G<T> {\n    fn drop(&mut self) {\n        if !self._ptr.is_null() {\n        }\n    }\n}\n\nfn main() {\n    let x:G<Bar>;\n}\n```\n\nAnd here is error (differs in error message, stacktrace looks very similiar): \n\n```\nx.rs:1:1: 1:1 error: internal compiler error: Encountered errors `[FulfillmentError(Obligation(trait_ref=<<generic #0> as core::kinds::Sized>,depth=1),Unimplemented)]` fulfilling `<*mut GBox<Bar+'static> as core::ptr::RawPtr<GBox<Bar+'static>>>` during trans\nx.rs:1 #![feature(unsafe_destructor)]\n       ^\nnote: the compiler hit an unexpected failure path. this is a bug.\nnote: we would appreciate a bug report: http://doc.rust-lang.org/complement-bugreport.html\nnote: run with `RUST_BACKTRACE=1` for a backtrace\ntask 'rustc' failed at 'Box<Any>', /private/tmp/rust-jaR1Yf/src/libsyntax/diagnostic.rs:113\n\nstack backtrace:\n   1:        0x10b9bdd99 - rt::backtrace::imp::write::h273044213f8a2894OLq\n   2:        0x10b9c10b1 - failure::on_fail::h0c4f1dedf6e42b45n2q\n   3:        0x10bc30a55 - unwind::begin_unwind_inner::hf294fceb7364c35dJud\n   4:        0x10b0f06a7 - unwind::begin_unwind::h15760749405991757620\n   5:        0x10b0f0640 - unwind::begin_unwind::h15760749405991757620\n   6:        0x108afebbd - driver::session::Session::span_bug::h77f162e9927192568sy\n   7:        0x108d5c953 - middle::trans::common::fulfill_obligation::hc2c86e36ef61e3720p7\n   8:        0x108d2313c - middle::trans::meth::trans_static_method_callee::hd78422dcc619c285H1k\n   9:        0x108d2b56a - middle::trans::callee::trans_call::closure.124198\n  10:        0x108d02b64 - middle::trans::callee::trans_call_inner::h7083ee476552c80bJM2\n  11:        0x108d2adc7 - middle::trans::callee::trans_call::hbcd3295eac45cd284G2\n  12:        0x108d3a621 - middle::trans::expr::trans_rvalue_dps_unadjusted::h091faa7fa9ae748diV4\n  13:        0x108d38846 - middle::trans::expr::trans_unadjusted::h4687b5440f9f001cOh4\n  14:        0x108cfc466 - middle::trans::expr::trans::h37ac91f8a5ab7eceKA3\n  15:        0x108d4261a - middle::trans::expr::trans_binary::hc03bfcc1c44bed1euW5\n  16:        0x108d38a66 - middle::trans::expr::trans_unadjusted::h4687b5440f9f001cOh4\n  17:        0x108cfafcd - middle::trans::expr::trans_into::h49532942979d7e36Qw3\n  18:        0x108cfb30d - middle::trans::controlflow::trans_block::hb62bfc3bd29145ddlKZ\n  19:        0x108dabf3e - middle::trans::base::trans_closure::h6516d41fe619fb89MFf\n  20:        0x108ced49a - middle::trans::base::trans_fn::h03123addb07e0c84aRf\n  21:        0x108cef36e - middle::trans::monomorphize::monomorphic_fn::hae161eb11b7b9b092bZ\n  22:        0x108d25fef - middle::trans::callee::trans_fn_ref_with_substs::h1c89324ccde73d421q2\n  23:        0x108d227cb - middle::trans::callee::trans_fn_ref::h08bb22de61cc16afzf2\n  24:        0x108d0465d - middle::trans::meth::trans_method_callee::h929a999be88dbc4bhXk\n  25:        0x108d2bddb - middle::trans::callee::trans_method_call::closure.124210\n  26:        0x108d02b64 - middle::trans::callee::trans_call_inner::h7083ee476552c80bJM2\n  27:        0x108d2bc34 - middle::trans::callee::trans_method_call::h56051e89a394e3d5cI2\n  28:        0x108d39a66 - middle::trans::expr::trans_rvalue_dps_unadjusted::h091faa7fa9ae748diV4\n  29:        0x108d38846 - middle::trans::expr::trans_unadjusted::h4687b5440f9f001cOh4\n  30:        0x108cfc466 - middle::trans::expr::trans::h37ac91f8a5ab7eceKA3\n  31:        0x108d42c5f - middle::trans::expr::trans_unary::h06cacce96bad061fdC5\n  32:        0x108d38a88 - middle::trans::expr::trans_unadjusted::h4687b5440f9f001cOh4\n  33:        0x108cfc466 - middle::trans::expr::trans::h37ac91f8a5ab7eceKA3\n  34:        0x108cfb7ce - middle::trans::controlflow::trans_if::h6aaf3e0e1595058b2MZ\n  35:        0x108d39f00 - middle::trans::expr::trans_rvalue_dps_unadjusted::h091faa7fa9ae748diV4\n  36:        0x108cfafad - middle::trans::expr::trans_into::h49532942979d7e36Qw3\n  37:        0x108cfb30d - middle::trans::controlflow::trans_block::hb62bfc3bd29145ddlKZ\n  38:        0x108dabf3e - middle::trans::base::trans_closure::h6516d41fe619fb89MFf\n  39:        0x108ced49a - middle::trans::base::trans_fn::h03123addb07e0c84aRf\n  40:        0x108cef36e - middle::trans::monomorphize::monomorphic_fn::hae161eb11b7b9b092bZ\n  41:        0x108d15716 - middle::trans::base::get_res_dtor::h86daf3abd2d4c636VZd\n  42:        0x108d148c2 - middle::trans::glue::trans_struct_drop::h2f0ef3a8eaf46f60NG0\n  43:        0x108d1480a - middle::trans::glue::trans_struct_drop_flag::closure.123855\n  44:        0x108d1471e - middle::trans::base::with_cond::hd938d2ce54028d64eRe\n  45:        0x108d12731 - middle::trans::glue::make_drop_glue::as_closure.123819\n  46:        0x108d114a6 - middle::trans::glue::make_generic_glue::h829e06c9ca5f1e5dji1\n  47:        0x108d0f881 - middle::trans::glue::get_drop_glue::hf9d8897b2193e2915q0\n  48:        0x108d0ee68 - middle::trans::glue::drop_ty::h4fc02bdea2206c15Bm0\n  49:        0x108e26e34 - middle::trans::cleanup::DropValue.Cleanup::trans::h29d99c7be18fce65Q9x\n  50:        0x108cfa8ec - middle::trans::cleanup::FunctionContext<'blk, 'tcx>.CleanupMethods<'blk, 'tcx>::pop_and_trans_ast_cleanup_scope::hf5d8b4a67ca0650deWw\n  51:        0x108cfb321 - middle::trans::controlflow::trans_block::hb62bfc3bd29145ddlKZ\n  52:        0x108dabf3e - middle::trans::base::trans_closure::h6516d41fe619fb89MFf\n  53:        0x108ced49a - middle::trans::base::trans_fn::h03123addb07e0c84aRf\n  54:        0x108ceac15 - middle::trans::base::trans_item::h3a59f9835edac94etag\n  55:        0x108db5a78 - middle::trans::base::trans_crate::h82fc9db67d8fc02dZ8g\n  56:        0x1091f31b5 - driver::driver::phase_4_translate_to_llvm::he6e636df9afeed0b5Tx\n  57:        0x1091eb2b8 - driver::driver::compile_input::h368552c9534b42730qx\n  58:        0x109273e34 - driver::run_compiler::h06d188804fcb3e77jfB\n  59:        0x109271f66 - driver::run::closure.147679\n  60:        0x1089573cb - task::TaskBuilder<S>::try_future::closure.101752\n  61:        0x1089572b3 - task::TaskBuilder<S>::spawn_internal::closure.101723\n  62:        0x1088ce8ad - task::spawn_opts::closure.8528\n  63:        0x10bc961fc - rust_try_inner\n  64:        0x10bc961e6 - rust_try\n  65:        0x10bc2e0c7 - unwind::try::h84e3668876f753a7rjd\n  66:        0x10bc2df4c - task::Task::run::h6ffe7aca8c2f2a9aCzc\n  67:        0x1088ce6d2 - task::spawn_opts::closure.8467\n  68:        0x10bc2f90a - thread::thread_start::h0f961398128da0abNTc\n  69:     0x7fff8df4f899 - _pthread_body\n  70:     0x7fff8df4f72a - _pthread_struct_init\n```\n\nHope that helps.\n",
    "author_association": "NONE",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/58796638/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/60303059",
    "html_url": "https://github.com/rust-lang/rust/issues/17959#issuecomment-60303059",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/17959",
    "id": 60303059,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYwMzAzMDU5",
    "user": {
      "login": "little-arhat",
      "id": 240531,
      "node_id": "MDQ6VXNlcjI0MDUzMQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/240531?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/little-arhat",
      "html_url": "https://github.com/little-arhat",
      "followers_url": "https://api.github.com/users/little-arhat/followers",
      "following_url": "https://api.github.com/users/little-arhat/following{/other_user}",
      "gists_url": "https://api.github.com/users/little-arhat/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/little-arhat/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/little-arhat/subscriptions",
      "organizations_url": "https://api.github.com/users/little-arhat/orgs",
      "repos_url": "https://api.github.com/users/little-arhat/repos",
      "events_url": "https://api.github.com/users/little-arhat/events{/privacy}",
      "received_events_url": "https://api.github.com/users/little-arhat/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-10-23T20:24:31Z",
    "updated_at": "2014-10-23T20:24:31Z",
    "body": "Possibly related: #16758\n",
    "author_association": "NONE",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/60303059/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/65061973",
    "html_url": "https://github.com/rust-lang/rust/issues/17959#issuecomment-65061973",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/17959",
    "id": 65061973,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY1MDYxOTcz",
    "user": {
      "login": "little-arhat",
      "id": 240531,
      "node_id": "MDQ6VXNlcjI0MDUzMQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/240531?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/little-arhat",
      "html_url": "https://github.com/little-arhat",
      "followers_url": "https://api.github.com/users/little-arhat/followers",
      "following_url": "https://api.github.com/users/little-arhat/following{/other_user}",
      "gists_url": "https://api.github.com/users/little-arhat/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/little-arhat/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/little-arhat/subscriptions",
      "organizations_url": "https://api.github.com/users/little-arhat/orgs",
      "repos_url": "https://api.github.com/users/little-arhat/repos",
      "events_url": "https://api.github.com/users/little-arhat/events{/privacy}",
      "received_events_url": "https://api.github.com/users/little-arhat/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-12-01T13:07:34Z",
    "updated_at": "2014-12-01T13:07:34Z",
    "body": "Any news on that one? \n",
    "author_association": "NONE",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/65061973/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/94843453",
    "html_url": "https://github.com/rust-lang/rust/issues/17959#issuecomment-94843453",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/17959",
    "id": 94843453,
    "node_id": "MDEyOklzc3VlQ29tbWVudDk0ODQzNDUz",
    "user": {
      "login": "tamird",
      "id": 1535036,
      "node_id": "MDQ6VXNlcjE1MzUwMzY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1535036?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/tamird",
      "html_url": "https://github.com/tamird",
      "followers_url": "https://api.github.com/users/tamird/followers",
      "following_url": "https://api.github.com/users/tamird/following{/other_user}",
      "gists_url": "https://api.github.com/users/tamird/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/tamird/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/tamird/subscriptions",
      "organizations_url": "https://api.github.com/users/tamird/orgs",
      "repos_url": "https://api.github.com/users/tamird/repos",
      "events_url": "https://api.github.com/users/tamird/events{/privacy}",
      "received_events_url": "https://api.github.com/users/tamird/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-04-21T15:41:30Z",
    "updated_at": "2015-04-21T15:41:30Z",
    "body": "Adapted this code to modern syntax:\n\n``` rust\n#![feature(unsafe_destructor)]\n\nextern crate core;\n\nuse core::ops::Drop;\n\ntrait Bar {}\n\nstruct G<T: ?Sized> {\n    _ptr: *const T\n}\n\n#[unsafe_destructor]\nimpl<T> Drop for G<T> {\n    fn drop(&mut self) {\n        if !self._ptr.is_null() {\n        }\n    }\n}\n\nfn main() {\n    let x:G<Bar>;\n}\n```\n\nIt doesn't compile, but it doesn't ICE:\n\n```\n$ rustc src/bin/main.rs\nsrc/bin/main.rs:14:1: 19:2 error: The requirement `T : core::marker::Sized` is added only by the Drop impl. [E0367]\nsrc/bin/main.rs:14 impl<T> Drop for G<T> {\nsrc/bin/main.rs:15     fn drop(&mut self) {\nsrc/bin/main.rs:16         if !self._ptr.is_null() {\nsrc/bin/main.rs:17         }\nsrc/bin/main.rs:18     }\nsrc/bin/main.rs:19 }\nsrc/bin/main.rs:9:1: 11:2 note: The same requirement must be part of the struct/enum definition\nsrc/bin/main.rs:9 struct G<T: ?Sized> {\nsrc/bin/main.rs:10     _ptr: *const T\nsrc/bin/main.rs:11 }\nerror: aborting due to previous error\n$\n```\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/94843453/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
