[
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/72329464",
    "html_url": "https://github.com/rust-lang/rust/issues/21812#issuecomment-72329464",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/21812",
    "id": 72329464,
    "node_id": "MDEyOklzc3VlQ29tbWVudDcyMzI5NDY0",
    "user": {
      "login": "Diggsey",
      "id": 451321,
      "node_id": "MDQ6VXNlcjQ1MTMyMQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/451321?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Diggsey",
      "html_url": "https://github.com/Diggsey",
      "followers_url": "https://api.github.com/users/Diggsey/followers",
      "following_url": "https://api.github.com/users/Diggsey/following{/other_user}",
      "gists_url": "https://api.github.com/users/Diggsey/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Diggsey/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Diggsey/subscriptions",
      "organizations_url": "https://api.github.com/users/Diggsey/orgs",
      "repos_url": "https://api.github.com/users/Diggsey/repos",
      "events_url": "https://api.github.com/users/Diggsey/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Diggsey/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-01-31T18:27:17Z",
    "updated_at": "2015-01-31T18:28:32Z",
    "body": "printf and variants are not the only variadic functions. Structs/enums should not be disallowed from variadic argument lists.\n\nIsn't there already a lint to prevent non-\"repr(C)\" types from being passed to C functions? This should prevent passing newtypes or other structs/enums not designed for that.\n\nYou could argue for applying the same conversions to new-types, however for the moment I don't think rust recognises newtypes as special in any way (they're just tuple structs with a single element), so it would be a little odd.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/72329464/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/72329570",
    "html_url": "https://github.com/rust-lang/rust/issues/21812#issuecomment-72329570",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/21812",
    "id": 72329570,
    "node_id": "MDEyOklzc3VlQ29tbWVudDcyMzI5NTcw",
    "user": {
      "login": "solson",
      "id": 26806,
      "node_id": "MDQ6VXNlcjI2ODA2",
      "avatar_url": "https://avatars.githubusercontent.com/u/26806?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/solson",
      "html_url": "https://github.com/solson",
      "followers_url": "https://api.github.com/users/solson/followers",
      "following_url": "https://api.github.com/users/solson/following{/other_user}",
      "gists_url": "https://api.github.com/users/solson/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/solson/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/solson/subscriptions",
      "organizations_url": "https://api.github.com/users/solson/orgs",
      "repos_url": "https://api.github.com/users/solson/repos",
      "events_url": "https://api.github.com/users/solson/events{/privacy}",
      "received_events_url": "https://api.github.com/users/solson/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-01-31T18:29:29Z",
    "updated_at": "2015-01-31T18:29:29Z",
    "body": "If there is such a lint it's not working in this case. When does it make sense to pass structs in variadic argument lists? Does C define how that's handled (or do specific calling conventions define it)?\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/72329570/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/72337457",
    "html_url": "https://github.com/rust-lang/rust/issues/21812#issuecomment-72337457",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/21812",
    "id": 72337457,
    "node_id": "MDEyOklzc3VlQ29tbWVudDcyMzM3NDU3",
    "user": {
      "login": "Diggsey",
      "id": 451321,
      "node_id": "MDQ6VXNlcjQ1MTMyMQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/451321?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Diggsey",
      "html_url": "https://github.com/Diggsey",
      "followers_url": "https://api.github.com/users/Diggsey/followers",
      "following_url": "https://api.github.com/users/Diggsey/following{/other_user}",
      "gists_url": "https://api.github.com/users/Diggsey/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Diggsey/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Diggsey/subscriptions",
      "organizations_url": "https://api.github.com/users/Diggsey/orgs",
      "repos_url": "https://api.github.com/users/Diggsey/repos",
      "events_url": "https://api.github.com/users/Diggsey/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Diggsey/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-01-31T21:25:27Z",
    "updated_at": "2015-01-31T21:25:27Z",
    "body": "As long as the implementation calls \"va_arg\" with the exact same type as each parameter, then it will work just fine in C.\nInternally, \"va_start\" sets up a pointer pointing to just past the last non-variadic argument. Successive calls to \"va_arg(list, T)\" dereference the pointer for the return value, and then increment the pointer by \"sizeof(T)\" (I'm ignoring alignment here for simplicity) so that it points to the next argument (cdecl stores arguments sequentially on the stack).\nvarargs requires a calling convention where the caller cleans up the stack (usually cdecl) so it won't work with eg. stdcall.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/72337457/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/72338282",
    "html_url": "https://github.com/rust-lang/rust/issues/21812#issuecomment-72338282",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/21812",
    "id": 72338282,
    "node_id": "MDEyOklzc3VlQ29tbWVudDcyMzM4Mjgy",
    "user": {
      "login": "solson",
      "id": 26806,
      "node_id": "MDQ6VXNlcjI2ODA2",
      "avatar_url": "https://avatars.githubusercontent.com/u/26806?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/solson",
      "html_url": "https://github.com/solson",
      "followers_url": "https://api.github.com/users/solson/followers",
      "following_url": "https://api.github.com/users/solson/following{/other_user}",
      "gists_url": "https://api.github.com/users/solson/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/solson/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/solson/subscriptions",
      "organizations_url": "https://api.github.com/users/solson/orgs",
      "repos_url": "https://api.github.com/users/solson/repos",
      "events_url": "https://api.github.com/users/solson/events{/privacy}",
      "received_events_url": "https://api.github.com/users/solson/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-01-31T21:41:30Z",
    "updated_at": "2015-01-31T21:41:30Z",
    "body": "Thanks for the explanation. It's curious to me that those types like u8 and u16 have to be promoted given what you said, but Rust seems to be doing everything correctly except for not warning about the non-`repr(C)` struct passing. I'll edit the issue to focus on that.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/72338282/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/72340724",
    "html_url": "https://github.com/rust-lang/rust/issues/21812#issuecomment-72340724",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/21812",
    "id": 72340724,
    "node_id": "MDEyOklzc3VlQ29tbWVudDcyMzQwNzI0",
    "user": {
      "login": "Diggsey",
      "id": 451321,
      "node_id": "MDQ6VXNlcjQ1MTMyMQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/451321?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Diggsey",
      "html_url": "https://github.com/Diggsey",
      "followers_url": "https://api.github.com/users/Diggsey/followers",
      "following_url": "https://api.github.com/users/Diggsey/following{/other_user}",
      "gists_url": "https://api.github.com/users/Diggsey/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Diggsey/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Diggsey/subscriptions",
      "organizations_url": "https://api.github.com/users/Diggsey/orgs",
      "repos_url": "https://api.github.com/users/Diggsey/repos",
      "events_url": "https://api.github.com/users/Diggsey/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Diggsey/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-01-31T22:44:37Z",
    "updated_at": "2015-01-31T22:45:05Z",
    "body": "Basically, if you accidentally mismatch types to a variadic function, you can read invalid memory (for example, if you could pass in a i16 when the function is expecting an i32 then it will read an extra two bytes, potentially corrupting later parameters as well. That's why printf is very unsafe, and the automatic conversions to \"int\" are used in C to make it just a little safer - it also means you can safely pass in a \"i16\" to a format string \"%d\" without causing undefined behaviour.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/72340724/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/181538593",
    "html_url": "https://github.com/rust-lang/rust/issues/21812#issuecomment-181538593",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/21812",
    "id": 181538593,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE4MTUzODU5Mw==",
    "user": {
      "login": "steveklabnik",
      "id": 27786,
      "node_id": "MDQ6VXNlcjI3Nzg2",
      "avatar_url": "https://avatars.githubusercontent.com/u/27786?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/steveklabnik",
      "html_url": "https://github.com/steveklabnik",
      "followers_url": "https://api.github.com/users/steveklabnik/followers",
      "following_url": "https://api.github.com/users/steveklabnik/following{/other_user}",
      "gists_url": "https://api.github.com/users/steveklabnik/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/steveklabnik/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/steveklabnik/subscriptions",
      "organizations_url": "https://api.github.com/users/steveklabnik/orgs",
      "repos_url": "https://api.github.com/users/steveklabnik/repos",
      "events_url": "https://api.github.com/users/steveklabnik/events{/privacy}",
      "received_events_url": "https://api.github.com/users/steveklabnik/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2016-02-08T19:51:22Z",
    "updated_at": "2016-02-08T19:51:22Z",
    "body": "Triage: this still does not warn today.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/181538593/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/183045149",
    "html_url": "https://github.com/rust-lang/rust/issues/21812#issuecomment-183045149",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/21812",
    "id": 183045149,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE4MzA0NTE0OQ==",
    "user": {
      "login": "steveklabnik",
      "id": 27786,
      "node_id": "MDQ6VXNlcjI3Nzg2",
      "avatar_url": "https://avatars.githubusercontent.com/u/27786?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/steveklabnik",
      "html_url": "https://github.com/steveklabnik",
      "followers_url": "https://api.github.com/users/steveklabnik/followers",
      "following_url": "https://api.github.com/users/steveklabnik/following{/other_user}",
      "gists_url": "https://api.github.com/users/steveklabnik/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/steveklabnik/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/steveklabnik/subscriptions",
      "organizations_url": "https://api.github.com/users/steveklabnik/orgs",
      "repos_url": "https://api.github.com/users/steveklabnik/repos",
      "events_url": "https://api.github.com/users/steveklabnik/events{/privacy}",
      "received_events_url": "https://api.github.com/users/steveklabnik/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2016-02-11T20:12:49Z",
    "updated_at": "2016-02-11T20:12:49Z",
    "body": "Since new lints have a big impact on users of rustc, the policy is that they should go through the RFC process like other user-facing changes. As such, I'm going to give this one a close, but if anyone comes across this ticket and wants this lint, consider adding it to clippy and/or writing up an RFC. Thanks!\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/183045149/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/572075173",
    "html_url": "https://github.com/rust-lang/rust/issues/21812#issuecomment-572075173",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/21812",
    "id": 572075173,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU3MjA3NTE3Mw==",
    "user": {
      "login": "elichai",
      "id": 2167860,
      "node_id": "MDQ6VXNlcjIxNjc4NjA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2167860?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/elichai",
      "html_url": "https://github.com/elichai",
      "followers_url": "https://api.github.com/users/elichai/followers",
      "following_url": "https://api.github.com/users/elichai/following{/other_user}",
      "gists_url": "https://api.github.com/users/elichai/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/elichai/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/elichai/subscriptions",
      "organizations_url": "https://api.github.com/users/elichai/orgs",
      "repos_url": "https://api.github.com/users/elichai/repos",
      "events_url": "https://api.github.com/users/elichai/events{/privacy}",
      "received_events_url": "https://api.github.com/users/elichai/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2020-01-08T14:19:23Z",
    "updated_at": "2020-01-08T14:20:44Z",
    "body": "FWIW it still doesn't warn even though `improper_ctypes` is a thing.\r\nCurrently `improper_ctypes` only looks at declarations not usage.\r\nit would be a big change to make this work :/",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/572075173/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
