{
  "url": "https://api.github.com/repos/rust-lang/rust/issues/21125",
  "repository_url": "https://api.github.com/repos/rust-lang/rust",
  "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/21125/labels{/name}",
  "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/21125/comments",
  "events_url": "https://api.github.com/repos/rust-lang/rust/issues/21125/events",
  "html_url": "https://github.com/rust-lang/rust/pull/21125",
  "id": 54274691,
  "node_id": "MDExOlB1bGxSZXF1ZXN0MjczMjE1MTc=",
  "number": 21125,
  "title": "std: Stabilize the std::fmt module",
  "user": {
    "login": "alexcrichton",
    "id": 64996,
    "node_id": "MDQ6VXNlcjY0OTk2",
    "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/alexcrichton",
    "html_url": "https://github.com/alexcrichton",
    "followers_url": "https://api.github.com/users/alexcrichton/followers",
    "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}",
    "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions",
    "organizations_url": "https://api.github.com/users/alexcrichton/orgs",
    "repos_url": "https://api.github.com/users/alexcrichton/repos",
    "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}",
    "received_events_url": "https://api.github.com/users/alexcrichton/received_events",
    "type": "User",
    "user_view_type": "public",
    "site_admin": false
  },
  "labels": [],
  "state": "closed",
  "locked": false,
  "assignee": {
    "login": "aturon",
    "id": 709807,
    "node_id": "MDQ6VXNlcjcwOTgwNw==",
    "avatar_url": "https://avatars.githubusercontent.com/u/709807?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/aturon",
    "html_url": "https://github.com/aturon",
    "followers_url": "https://api.github.com/users/aturon/followers",
    "following_url": "https://api.github.com/users/aturon/following{/other_user}",
    "gists_url": "https://api.github.com/users/aturon/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/aturon/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/aturon/subscriptions",
    "organizations_url": "https://api.github.com/users/aturon/orgs",
    "repos_url": "https://api.github.com/users/aturon/repos",
    "events_url": "https://api.github.com/users/aturon/events{/privacy}",
    "received_events_url": "https://api.github.com/users/aturon/received_events",
    "type": "User",
    "user_view_type": "public",
    "site_admin": false
  },
  "assignees": [
    {
      "login": "aturon",
      "id": 709807,
      "node_id": "MDQ6VXNlcjcwOTgwNw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/709807?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/aturon",
      "html_url": "https://github.com/aturon",
      "followers_url": "https://api.github.com/users/aturon/followers",
      "following_url": "https://api.github.com/users/aturon/following{/other_user}",
      "gists_url": "https://api.github.com/users/aturon/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/aturon/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/aturon/subscriptions",
      "organizations_url": "https://api.github.com/users/aturon/orgs",
      "repos_url": "https://api.github.com/users/aturon/repos",
      "events_url": "https://api.github.com/users/aturon/events{/privacy}",
      "received_events_url": "https://api.github.com/users/aturon/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    }
  ],
  "milestone": null,
  "comments": 5,
  "created_at": "2015-01-14T01:54:13Z",
  "updated_at": "2015-01-20T06:47:09Z",
  "closed_at": "2015-01-14T17:47:45Z",
  "author_association": "MEMBER",
  "type": null,
  "active_lock_reason": null,
  "draft": false,
  "pull_request": {
    "url": "https://api.github.com/repos/rust-lang/rust/pulls/21125",
    "html_url": "https://github.com/rust-lang/rust/pull/21125",
    "diff_url": "https://github.com/rust-lang/rust/pull/21125.diff",
    "patch_url": "https://github.com/rust-lang/rust/pull/21125.patch",
    "merged_at": null
  },
  "body": "This commit performs a final stabilization pass over the std::fmt module,\nmarking all necessary APIs as stable. One of the more interesting aspects of\nthis module is that it exposes a good deal of its runtime representation to the\noutside world in order for `format_args!` to be able to construct the format\nstrings. Instead of hacking the compiler to assume that these items are stable,\nthis commit instead lays out a story for the stabilization and evolution of\nthese APIs.\n\nThere are three primary details used by the `format_args!` macro:\n1. `Arguments` - an opaque package of a \"compiled format string\". This structure\n   is passed around and the `write` function is the source of truth for\n   transforming a compiled format string into a string at runtime. This must be\n   able to be constructed in stable code.\n2. `Argument` - an opaque structure representing an argument to a format string.\n   This is _almost_ a trait object as it's just a pointer/function pair, but due\n   to the function originating from one of many traits, it's not actually a\n   trait object. Like `Arguments`, this must be constructed from stable code.\n3. `fmt::rt` - this module contains the runtime type definitions primarily for\n   the `rt::Argument` structure. Whenever an argument is formatted with\n   nonstandard flags, a corresponding `rt::Argument` is generated describing how\n   the argument is being formatted. This can be used to construct an\n   `Arguments`.\n\nThe primary interface to `std::fmt` is the `Arguments` structure, and as such\nthis type name is stabilize as-is today. It is expected for libraries to pass\naround an `Arguments` structure to represent a pending formatted computation.\n\nThe remaining portions are largely \"cruft\" which would rather not be stabilized,\nbut due to the stability checks they must be. As a result, almost all pieces\nhave been renamed to represent that they are \"version 1\" of the formatting\nrepresentation. The theory is that at a later date if we change the\nrepresentation of these types we can add new definitions called \"version 2\" and\ncorresponding constructors for `Arguments`.\n\nOne of the other remaining large questions about the fmt module were how the\npending I/O reform would affect the signatures of methods in the module. Due to\n[RFC 526](https://github.com/rust-lang/rfcs/blob/master/text/0526-fmt-text-writer.md), however, the writers of fmt are now incompatible with the\nwriters of io, so this question has largely been solved. As a result the\ninterfaces are largely stabilized as-is today.\n\nSpecifically, the following changes were made:\n- The contents of `fmt::rt` were all moved under `fmt::rt::v1`\n- `fmt::rt` is stable\n- `fmt::rt::v1` is stable\n- `Error` is stable\n- `Writer` is stable\n- `Writer::write_str` is stable\n- `Writer::write_fmt` is stable\n- `Formatter` is stable\n- `Argument` has been renamed to `ArgumentV1` and is stable\n- `ArgumentV1::new` is stable\n- `ArgumentV1::from_uint` is stable\n- `Arguments::new_v1` is stable (renamed from `new`)\n- `Arguments::new_v1_formatted` is stable (renamed from `with_placeholders`)\n- All formatting traits are now stable, as well as the `fmt` method.\n- `fmt::write` is stable\n- `fmt::format` is stable\n- `Formatter::pad_integral` is stable\n- `Formatter::pad` is stable\n- `Formatter::write_str` is stable\n- `Formatter::write_fmt` is stable\n- Some assorted top level items which were only used by `format_args!` were\n  removed in favor of static functions on `ArgumentV1` as well.\n- The formatting-flag-accessing methods remain unstable\n\nWithin the contents of the `fmt::rt::v1` module, the following actions were\ntaken:\n- Reexports of all enum variants were removed\n- All prefixes on enum variants were removed\n- A few miscellaneous enum variants were renamed\n- Otherwise all structs, fields, and variants were marked stable.\n\nIn addition to these actions in the `std::fmt` module, many implementations of\n`Show` and `String` were stabilized as well.\n\nIn some other modules:\n- `ToString` is now stable\n- `ToString::to_string` is now stable\n- `Vec` no longer implements `fmt::Writer` (this has moved to `String`)\n\nWhile stabilize the formatting traits, the following change was also made to the\n`result` module:\n- `Result::unwrap` now requires `String` instead of `Show`\n- `Result::unwrap_err` now requires `String` instead of `Show`\n\nThis is a breaking change due to all of the changes to the `fmt::rt` module, but\nthis likely will not have much impact on existing programs. It is also a\nbreaking change due to the usage of `String` for `unwrap()` on `Result` instead\nof `Show`. Error types should implement `String` for human readable errors and\n`Show` for inspecting their representation.\n\nCloses #20661\n[breaking-change]\n",
  "closed_by": {
    "login": "alexcrichton",
    "id": 64996,
    "node_id": "MDQ6VXNlcjY0OTk2",
    "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/alexcrichton",
    "html_url": "https://github.com/alexcrichton",
    "followers_url": "https://api.github.com/users/alexcrichton/followers",
    "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}",
    "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions",
    "organizations_url": "https://api.github.com/users/alexcrichton/orgs",
    "repos_url": "https://api.github.com/users/alexcrichton/repos",
    "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}",
    "received_events_url": "https://api.github.com/users/alexcrichton/received_events",
    "type": "User",
    "user_view_type": "public",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/21125/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/21125/timeline",
  "performed_via_github_app": null,
  "state_reason": null,
  "_meta": {
    "type": "pr"
  }
}
