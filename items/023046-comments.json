[
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/77276815",
    "html_url": "https://github.com/rust-lang/rust/issues/23046#issuecomment-77276815",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/23046",
    "id": 77276815,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc3Mjc2ODE1",
    "user": {
      "login": "arielb1",
      "id": 1830974,
      "node_id": "MDQ6VXNlcjE4MzA5NzQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1830974?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/arielb1",
      "html_url": "https://github.com/arielb1",
      "followers_url": "https://api.github.com/users/arielb1/followers",
      "following_url": "https://api.github.com/users/arielb1/following{/other_user}",
      "gists_url": "https://api.github.com/users/arielb1/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/arielb1/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/arielb1/subscriptions",
      "organizations_url": "https://api.github.com/users/arielb1/orgs",
      "repos_url": "https://api.github.com/users/arielb1/repos",
      "events_url": "https://api.github.com/users/arielb1/events{/privacy}",
      "received_events_url": "https://api.github.com/users/arielb1/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-03-04T23:50:24Z",
    "updated_at": "2015-03-04T23:50:24Z",
    "body": "Minified:\n\n``` Rust\npub enum Expr<'var, VAR> {\n    Let(Box<Expr<'var, VAR>>,\n        Box<for<'v: 'var> Fn(Expr<'v, VAR>) -> Expr<'v, VAR> + 'var>)\n}\n\npub fn add<'var, VAR>\n                      (a: Expr<'var, VAR>, b: Expr<'var, VAR>) -> Expr<'var, VAR> {\n    loop {}\n}\n\npub fn let_<'var, VAR, F: for<'v: 'var> Fn(Expr<'v, VAR>) -> Expr<'v, VAR>>\n                       (a: Expr<'var, VAR>, b: F) -> Expr<'var, VAR> {\n    loop {}\n}\n\nfn main() {\n    let ex =  (|x| {\n        let_(add(x,x), |y| {\n            let_(add(x, x), |x|x)})});\n}\n```\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/77276815/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/87323293",
    "html_url": "https://github.com/rust-lang/rust/issues/23046#issuecomment-87323293",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/23046",
    "id": 87323293,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg3MzIzMjkz",
    "user": {
      "login": "m-r-r",
      "id": 1268110,
      "node_id": "MDQ6VXNlcjEyNjgxMTA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1268110?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/m-r-r",
      "html_url": "https://github.com/m-r-r",
      "followers_url": "https://api.github.com/users/m-r-r/followers",
      "following_url": "https://api.github.com/users/m-r-r/following{/other_user}",
      "gists_url": "https://api.github.com/users/m-r-r/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/m-r-r/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/m-r-r/subscriptions",
      "organizations_url": "https://api.github.com/users/m-r-r/orgs",
      "repos_url": "https://api.github.com/users/m-r-r/repos",
      "events_url": "https://api.github.com/users/m-r-r/events{/privacy}",
      "received_events_url": "https://api.github.com/users/m-r-r/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-03-28T22:18:55Z",
    "updated_at": "2015-03-28T22:18:55Z",
    "body": "Hello,\n\nI think I have the same bug. It happens when I try to compile this piece of code:\n\n``` rust\nuse std::collections::HashMap;\nuse std_test::Bencher;\nuse std::convert::AsRef;\n\nuse SequenceTrie;\n\nmacro_rules! u32_benchmark {\n    ($map_constructor: expr, $test_id: ident, $num_keys: expr, $key_length: expr) => (\n        #[bench]\n        fn $test_id(b: &mut Bencher) {\n            let mut test_data = Vec::<Vec<u32>>::with_capacity($num_keys);\n            let mut map = $map_constructor;\n            for i in 0 .. $num_keys {\n                let mut key = Vec::<u32>::with_capacity($key_length);\n                for j in 0 .. $key_length {\n                    key.push(i * j);\n                }\n\n                test_data.push(key);\n            }\n\n            b.iter(|| {\n                for key in &test_data {\n                    map.insert(key.as_ref(), 7u32);\n                }\n            });\n        }\n    )\n}\n\nu32_benchmark! { HashMap::new(), hashmap_k1024_l16, 1024, 16 }\nu32_benchmark! { SequenceTrie::new(), trie_k1024_l16, 1024, 16 }\n\nu32_benchmark! { HashMap::new(), hashmap_k64_l128, 64, 128 }\nu32_benchmark! { SequenceTrie::new(), trie_k64_l128, 64, 128 }\n```\n\nThe version of Rust I'm using is:\n\n```\nrustc 1.0.0-nightly (552080181 2015-03-27) (built 2015-03-28)\nbinary: rustc\ncommit-hash: 552080181c58beef03493a110b4a38b20b6b5da5\ncommit-date: 2015-03-27\nbuild-date: 2015-03-28\nhost: x86_64-unknown-linux-gnu\nrelease: 1.0.0-nightly\n```\n\nAnd the compiler output:\n\n``` console\n$ rustc src/lib.rs --crate-name sequence_trie --crate-type lib -g --test -C metadata=0808f6f1b57c7e83 -C extra-filename=-0808f6f1b57c7e83 --out-dir ./overrides/rust_sequence_trie/target/debug --emit=dep-info,link -L dependency=./overrides/rust_sequence_trie/target/debug -L dependency=./overrides/rust_sequence_trie/target/debug/deps\nsrc/benchmark.rs:23:36: 23:44 error: type annotations required: cannot resolve `collections::vec::Vec<u32> : core::convert::AsRef<_>` [E0283]\nsrc/benchmark.rs:23                     map.insert(key.as_ref(), 7u32);\n                                                       ^~~~~~~~\nerror: internal compiler error: unexpected panic\nnote: the compiler unexpectedly panicked. this is a bug.\nnote: we would appreciate a bug report: https://github.com/rust-lang/rust/blob/master/CONTRIBUTING.md#bug-reports\nnote: run with `RUST_BACKTRACE=1` for a backtrace\nthread 'rustc' panicked at 'called `Option::unwrap()` on a `None` value', /home/rustbuild/src/rust-buildbot/slave/nightly-dist-rustc-linux/build/src/libcore/option.rs:364\n\nstack backtrace:\n   1:     0x7fefb1602319 - sys::backtrace::write::hce2635debe4f9308BBD\n   2:     0x7fefb162cc3c - panicking::on_panic::h684283a75db74f52HRJ\n   3:     0x7fefb1552553 - rt::unwind::begin_unwind_inner::h5840ea28733d246foxJ\n   4:     0x7fefb155293f - rt::unwind::begin_unwind_fmt::hb23a1ee6fe217791ZvJ\n   5:     0x7fefb162c857 - rust_begin_unwind\n   6:     0x7fefb167ccb4 - panicking::panic_fmt::he15400e7c822c131brB\n   7:     0x7fefb1677a44 - panicking::panic::h143696e2c54ef9a4IpB\n   8:     0x7fefb022a4f5 - check::regionck::type_must_outlive::h7cf4171efdcb16b9n1e\n   9:     0x7fefb0270eab - check::regionck::type_of_node_must_outlive::h3b07938907cd8203Xqe\n  10:     0x7fefb026d6c2 - check::regionck::visit_expr::h9151012217c93467RHd\n  11:     0x7fefb0269f30 - check::regionck::Rcx<'a, 'tcx>::visit_fn_body::hf123615d02fb21bf4jd\n  12:     0x7fefb0301601 - check::check_bare_fn::h0c144619db1f6b78Rnn\n  13:     0x7fefb02f9235 - check::check_item::hfc51974e981a39ceCGn\n  14:     0x7fefb02ff822 - visit::walk_item::h16090704992959972715\n  15:     0x7fefb03db271 - check_crate::closure.36029\n  16:     0x7fefb03d5633 - check_crate::h4947b34bb4ea3242HlC\n  17:     0x7fefb1c653fd - driver::phase_3_run_analysis_passes::ha98c2f61eed776b9pGa\n  18:     0x7fefb1c49325 - driver::compile_input::hc85b3d46d8787bc0Rba\n  19:     0x7fefb1d00b25 - run_compiler::hcc9e5d244ab00cc3q2b\n  20:     0x7fefb1cfe5da - thunk::F.Invoke<A, R>::invoke::h15610588257015573231\n  21:     0x7fefb1cfd829 - rt::unwind::try::try_fn::h11610778690058047059\n  22:     0x7fefb16a6eb8 - rust_try_inner\n  23:     0x7fefb16a6ea5 - rust_try\n  24:     0x7fefb1cfdb87 - thunk::F.Invoke<A, R>::invoke::h2134375656366038107\n  25:     0x7fefb1617c21 - sys::thread::create::thread_start::had4589224c69738barI\n  26:     0x7fefab43b0a4 - start_thread\n  27:     0x7fefb11b8cfc - __clone\n  28:                0x0 - <unknown>\n```\n\nI think this is the same bug, because in both cases the panic happens at the same place (function `check::regionck::type_must_outlive`).\n\nI can get rid of the problem by replacing `key.as_ref()` by `(key as &AsRef<[u32]>).as_ref()`: Maybe the problem is occurring because `key.as_ref()` matches more than one trait ?!\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/87323293/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/113251506",
    "html_url": "https://github.com/rust-lang/rust/issues/23046#issuecomment-113251506",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/23046",
    "id": 113251506,
    "node_id": "MDEyOklzc3VlQ29tbWVudDExMzI1MTUwNg==",
    "user": {
      "login": "pmarcelll",
      "id": 1909968,
      "node_id": "MDQ6VXNlcjE5MDk5Njg=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1909968?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/pmarcelll",
      "html_url": "https://github.com/pmarcelll",
      "followers_url": "https://api.github.com/users/pmarcelll/followers",
      "following_url": "https://api.github.com/users/pmarcelll/following{/other_user}",
      "gists_url": "https://api.github.com/users/pmarcelll/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/pmarcelll/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/pmarcelll/subscriptions",
      "organizations_url": "https://api.github.com/users/pmarcelll/orgs",
      "repos_url": "https://api.github.com/users/pmarcelll/repos",
      "events_url": "https://api.github.com/users/pmarcelll/events{/privacy}",
      "received_events_url": "https://api.github.com/users/pmarcelll/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-06-18T18:31:29Z",
    "updated_at": "2015-06-18T18:31:29Z",
    "body": "Compiling the minified case produces the following output on `rustc 1.2.0-nightly (0250ff9a5 2015-06-17)\n`:\n\n```\ntest.rs:1:1: 4:2 error: this type cannot be instantiated without an instance of itself [E0073]\ntest.rs:1 pub enum Expr<'var, VAR> {\ntest.rs:2     Let(Box<Expr<'var, VAR>>,\ntest.rs:3         Box<for<'v: 'var> Fn(Expr<'v, VAR>) -> Expr<'v, VAR> + 'var>)\ntest.rs:4 }\ntest.rs:1:1: 4:2 help: run `rustc --explain E0073` to see a detailed explanation\ntest.rs:1:1: 4:2 help: consider using `Option<Expr<'var, VAR>>`\nerror: aborting due to previous error\n\n```\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/113251506/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/127359884",
    "html_url": "https://github.com/rust-lang/rust/issues/23046#issuecomment-127359884",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/23046",
    "id": 127359884,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEyNzM1OTg4NA==",
    "user": {
      "login": "arielb1",
      "id": 1830974,
      "node_id": "MDQ6VXNlcjE4MzA5NzQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1830974?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/arielb1",
      "html_url": "https://github.com/arielb1",
      "followers_url": "https://api.github.com/users/arielb1/followers",
      "following_url": "https://api.github.com/users/arielb1/following{/other_user}",
      "gists_url": "https://api.github.com/users/arielb1/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/arielb1/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/arielb1/subscriptions",
      "organizations_url": "https://api.github.com/users/arielb1/orgs",
      "repos_url": "https://api.github.com/users/arielb1/repos",
      "events_url": "https://api.github.com/users/arielb1/events{/privacy}",
      "received_events_url": "https://api.github.com/users/arielb1/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-08-03T18:18:09Z",
    "updated_at": "2015-08-03T18:18:09Z",
    "body": "This no longer ICEs, but still doesn't compile, even after the variance is fixed (`Var` is right-way variant) and implicator is used instead of the non-working `for<'v:'var>` syntax. It might be worth checking after @nikomatsakis makes his closure inference reform through.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/127359884/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/128644136",
    "html_url": "https://github.com/rust-lang/rust/issues/23046#issuecomment-128644136",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/23046",
    "id": 128644136,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEyODY0NDEzNg==",
    "user": {
      "login": "nikomatsakis",
      "id": 155238,
      "node_id": "MDQ6VXNlcjE1NTIzOA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/155238?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nikomatsakis",
      "html_url": "https://github.com/nikomatsakis",
      "followers_url": "https://api.github.com/users/nikomatsakis/followers",
      "following_url": "https://api.github.com/users/nikomatsakis/following{/other_user}",
      "gists_url": "https://api.github.com/users/nikomatsakis/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nikomatsakis/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nikomatsakis/subscriptions",
      "organizations_url": "https://api.github.com/users/nikomatsakis/orgs",
      "repos_url": "https://api.github.com/users/nikomatsakis/repos",
      "events_url": "https://api.github.com/users/nikomatsakis/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nikomatsakis/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-08-07T08:51:17Z",
    "updated_at": "2015-08-07T08:51:17Z",
    "body": "On nightly I see an error, not an ICE: http://is.gd/qyUHmM\n\nMarking as needs test.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/128644136/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/138871658",
    "html_url": "https://github.com/rust-lang/rust/issues/23046#issuecomment-138871658",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/23046",
    "id": 138871658,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEzODg3MTY1OA==",
    "user": {
      "login": "mitchmindtree",
      "id": 4587373,
      "node_id": "MDQ6VXNlcjQ1ODczNzM=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4587373?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mitchmindtree",
      "html_url": "https://github.com/mitchmindtree",
      "followers_url": "https://api.github.com/users/mitchmindtree/followers",
      "following_url": "https://api.github.com/users/mitchmindtree/following{/other_user}",
      "gists_url": "https://api.github.com/users/mitchmindtree/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mitchmindtree/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mitchmindtree/subscriptions",
      "organizations_url": "https://api.github.com/users/mitchmindtree/orgs",
      "repos_url": "https://api.github.com/users/mitchmindtree/repos",
      "events_url": "https://api.github.com/users/mitchmindtree/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mitchmindtree/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-09-09T10:48:03Z",
    "updated_at": "2015-09-09T10:48:03Z",
    "body": "I've just hit this error in a personal project - I'm using the 1.2.0 stable release on osx.\n\n```\nerror: internal compiler error: unexpected panic\nnote: the compiler unexpectedly panicked. this is a bug.\nnote: we would appreciate a bug report: https://github.com/rust-lang/rust/blob/master/CONTRIBUTING.md#bug-reports\nthread 'rustc' panicked at 'called `Option::unwrap()` on a `None` value', ../src/libcore/option.rs:362\n\nstack backtrace:\n   1:        0x1075d57b5 - sys::backtrace::write::hf5ea20500b66cd24uns\n   2:        0x1075de013 - panicking::on_panic::hbe02cb0d925cad49iGw\n   3:        0x107599dd2 - rt::unwind::begin_unwind_inner::h12ba0ba9dffdecc2uow\n   4:        0x10759ab29 - rt::unwind::begin_unwind_fmt::hadf0dbf11d345ebfAnw\n   5:        0x1075ddb9c - rust_begin_unwind\n   6:        0x107631d95 - panicking::panic_fmt::h987a4890059dc6e0H8B\n   7:        0x10762a7e1 - panicking::panic::hfd3e1c225039d9cae7B\n   8:        0x104510932 - check::regionck::type_must_outlive::h5135304db321371czqe\n   9:        0x10453e144 - check::regionck::type_of_node_must_outlive::h82fdc64a63ca862cOQd\n  10:        0x10453c6fb - check::regionck::visit_expr::ha7c5f37838a301d2P8c\n  11:        0x104539c0b - check::regionck::Rcx<'a, 'tcx>::visit_fn_body::ha3a67b8e2a6eacbbALc\n  12:        0x1045390b7 - check::regionck::regionck_fn::ha71fc7731cec857eWDc\n  13:        0x1045b1272 - check::check_bare_fn::h88c035244660e365WMn\n  14:        0x1045bcce7 - check::check_method_body::h069f1c1260fb3f85Qpo\n  15:        0x1045aec47 - check::check_item_body::h9873e3da412bca20ydo\n  16:        0x1045af212 - visit::walk_item::h2899112994373683709\n  17:        0x1045b0bed - check::check_item_types::h63240bfbe991be87tKn\n  18:        0x10466ecd9 - check_crate::h117ec0c1269afe619fD\n  19:        0x103eb5d16 - driver::phase_3_run_analysis_passes::closure.15766\n  20:        0x103eb4204 - middle::ty::with_ctxt::h14728011725879770170\n  21:        0x103eaf00a - driver::phase_3_run_analysis_passes::h16713467199444562124\n  22:        0x103e92107 - driver::compile_input::hb6d2be5b0fa2247fTba\n  23:        0x103f6e13f - run_compiler::h21d74b88eec3fe3bx7b\n  24:        0x103f6b9f3 - boxed::F.FnBox<A>::call_box::h1689969825914258414\n  25:        0x103f6b1b7 - rt::unwind::try::try_fn::h11273853850686318048\n  26:        0x107668cc8 - rust_try_inner\n  27:        0x107668cb5 - rust_try\n  28:        0x1075c7c95 - rt::unwind::try::inner_try::h480e3107f6a4b5b9nkw\n  29:        0x103f6b3e8 - boxed::F.FnBox<A>::call_box::h888215220722514405\n  30:        0x1075dca9d - sys::thread::Thread::new::thread_start::hdb3d925f69c5da4aHIv\n  31:     0x7fff96b7d059 - _pthread_body\n  32:     0x7fff96b7cfd6 - _pthread_start\n```\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/138871658/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
