{
  "url": "https://api.github.com/repos/rust-lang/rust/issues/7710",
  "repository_url": "https://api.github.com/repos/rust-lang/rust",
  "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/7710/labels{/name}",
  "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/7710/comments",
  "events_url": "https://api.github.com/repos/rust-lang/rust/issues/7710/events",
  "html_url": "https://github.com/rust-lang/rust/pull/7710",
  "id": 16624941,
  "node_id": "MDExOlB1bGxSZXF1ZXN0Njg2MDU4MA==",
  "number": 7710,
  "title": "debuginfo: Composite type reform and enum support.",
  "user": {
    "login": "michaelwoerister",
    "id": 1825894,
    "node_id": "MDQ6VXNlcjE4MjU4OTQ=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1825894?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/michaelwoerister",
    "html_url": "https://github.com/michaelwoerister",
    "followers_url": "https://api.github.com/users/michaelwoerister/followers",
    "following_url": "https://api.github.com/users/michaelwoerister/following{/other_user}",
    "gists_url": "https://api.github.com/users/michaelwoerister/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/michaelwoerister/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/michaelwoerister/subscriptions",
    "organizations_url": "https://api.github.com/users/michaelwoerister/orgs",
    "repos_url": "https://api.github.com/users/michaelwoerister/repos",
    "events_url": "https://api.github.com/users/michaelwoerister/events{/privacy}",
    "received_events_url": "https://api.github.com/users/michaelwoerister/received_events",
    "type": "User",
    "user_view_type": "public",
    "site_admin": false
  },
  "labels": [],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [],
  "milestone": null,
  "comments": 17,
  "created_at": "2013-07-11T10:59:47Z",
  "updated_at": "2014-06-12T12:47:48Z",
  "closed_at": "2013-07-20T17:49:37Z",
  "author_association": "MEMBER",
  "type": null,
  "active_lock_reason": null,
  "draft": false,
  "pull_request": {
    "url": "https://api.github.com/repos/rust-lang/rust/pulls/7710",
    "html_url": "https://github.com/rust-lang/rust/pull/7710",
    "diff_url": "https://github.com/rust-lang/rust/pull/7710.diff",
    "patch_url": "https://github.com/rust-lang/rust/pull/7710.patch",
    "merged_at": null
  },
  "body": "This pull request includes various improvements:\n- Composite types (structs, tuples, boxes, etc) are now handled more cleanly by debuginfo generation. Most notably, field offsets are now extracted directly from LLVM types, as opposed to trying to reconstruct them. This leads to more stable handling of edge cases (e.g. packed structs or structs implementing drop).\n- `debuginfo.rs` in general has seen a major cleanup. This includes better formatting, more readable variable and function names, removal of dead code, and better factoring of functionality.\n- Handling of `VariantInfo` in `ty.rs` has been improved. That is, the `type VariantInfo = @VariantInfo_` typedef has been replaced with explicit uses of @VariantInfo, and the duplicated logic for creating VariantInfo instances in `ty::enum_variants()` and `typeck::check::mod::check_enum_variants()` has been unified into a single constructor function. Both function now look nicer too :)\n- Debug info generation for enum types is now mostly supported. This includes:\n  - Good support for C-style enums. Both DWARF and `gdb` know how to handle them.\n  - Proper description of tuple- and struct-style enum variants as unions of structs.\n  - Proper handling of univariant enums without discriminator field.\n  - Unfortunately `gdb` always prints all possible interpretations of a union, so debug output of enums is verbose and unintuitive. Neither `LLVM` nor `gdb` support DWARF's `DW_TAG_variant` which allows to properly describe tagged unions. Adding support for this to `LLVM` seems doable. `gdb` however is another story. In the future we might be able to use `gdb`'s Python scripting support to alleviate this problem. In agreement with @jdm this is not a high priority for now.\n- The debuginfo test suite has been extended with 14 test files including tests for packed structs (with Drop), boxed structs, boxed vecs, vec slices, c-style enums (standalone and embedded), empty enums, tuple- and struct-style enums, and various pointer types to the above.\n\n~~What is not yet included is DI support for some enum edge-cases represented as described in `trans::adt::NullablePointer`.~~\n\nCheers,\nMichael\n\nPS: closes #7819,  fixes #7712\n",
  "closed_by": {
    "login": "bors",
    "id": 3372342,
    "node_id": "MDQ6VXNlcjMzNzIzNDI=",
    "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/bors",
    "html_url": "https://github.com/bors",
    "followers_url": "https://api.github.com/users/bors/followers",
    "following_url": "https://api.github.com/users/bors/following{/other_user}",
    "gists_url": "https://api.github.com/users/bors/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/bors/subscriptions",
    "organizations_url": "https://api.github.com/users/bors/orgs",
    "repos_url": "https://api.github.com/users/bors/repos",
    "events_url": "https://api.github.com/users/bors/events{/privacy}",
    "received_events_url": "https://api.github.com/users/bors/received_events",
    "type": "User",
    "user_view_type": "public",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/7710/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/7710/timeline",
  "performed_via_github_app": null,
  "state_reason": null,
  "_meta": {
    "type": "pr"
  }
}
