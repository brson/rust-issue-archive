[
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/10067211",
    "html_url": "https://github.com/rust-lang/rust/issues/3917#issuecomment-10067211",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/3917",
    "id": 10067211,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEwMDY3MjEx",
    "user": {
      "login": "Blub",
      "id": 123893,
      "node_id": "MDQ6VXNlcjEyMzg5Mw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/123893?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Blub",
      "html_url": "https://github.com/Blub",
      "followers_url": "https://api.github.com/users/Blub/followers",
      "following_url": "https://api.github.com/users/Blub/following{/other_user}",
      "gists_url": "https://api.github.com/users/Blub/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Blub/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Blub/subscriptions",
      "organizations_url": "https://api.github.com/users/Blub/orgs",
      "repos_url": "https://api.github.com/users/Blub/repos",
      "events_url": "https://api.github.com/users/Blub/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Blub/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2012-11-05T11:22:28Z",
    "updated_at": "2012-11-05T11:22:28Z",
    "body": "I replaced `vec::from_fn` with a `my_from_fn` which instead of `rusti::move_val_init` simply uses `a = move b` and this also seems to fix it. Maybe `move_val_init` doesn't honor the type-sizes correctly and writes out of bounds somewhere? (Without that change the copied function causes the same problem)\n\nThe function is a copy&paste from `libcore/vec.rs` with only the marked line exchanged\n\n``` rust\npub pure fn my_from_fn<T>(n_elts: uint, op: iter::InitOp<T>) -> ~[T] {\n    unsafe {\n        let mut v = vec::with_capacity(n_elts);\n        do vec::as_mut_buf(v) |p, _len| {\n            let mut i: uint = 0u;\n            while i < n_elts {\n                //vec::rusti::move_val_init(&mut(*ptr::mut_offset(p, i)), op(i)); <-- change here\n                *ptr::mut_offset(p, i) = move op(i); // new code\n                i += 1u;\n            }\n        }\n        vec::raw::set_len(&mut v, n_elts);\n        return move v;\n    }\n}\n```\n\nI don't know exactly `rusti::move_val_init` does, so, hope this information helps somehow.\n",
    "author_association": "NONE",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/10067211/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/10067416",
    "html_url": "https://github.com/rust-lang/rust/issues/3917#issuecomment-10067416",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/3917",
    "id": 10067416,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEwMDY3NDE2",
    "user": {
      "login": "Blub",
      "id": 123893,
      "node_id": "MDQ6VXNlcjEyMzg5Mw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/123893?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Blub",
      "html_url": "https://github.com/Blub",
      "followers_url": "https://api.github.com/users/Blub/followers",
      "following_url": "https://api.github.com/users/Blub/following{/other_user}",
      "gists_url": "https://api.github.com/users/Blub/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Blub/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Blub/subscriptions",
      "organizations_url": "https://api.github.com/users/Blub/orgs",
      "repos_url": "https://api.github.com/users/Blub/repos",
      "events_url": "https://api.github.com/users/Blub/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Blub/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2012-11-05T11:32:35Z",
    "updated_at": "2012-11-05T11:32:35Z",
    "body": "Ah, in fact, the whole testcase can be reduced: Drop the `_done` and vector creation completely, here's the new minimal testcase:\n\n``` rust\nuse io::ReaderUtil;\nfn main() {\n    let mut x: bool = false;\n    // this line breaks it\n    vec::rusti::move_val_init(&mut x, false);\n\n    let input = io::stdin();\n    let line = input.read_line(); // use core's io again\n\n    io::println(fmt!(\"got %?\", line));\n}\n```\n\n```\nwry:tmp/ $ rustc order.rs && echo aaa | ./order\ngot ~\"\\x01\\x01\\x01\"\n```\n",
    "author_association": "NONE",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/10067416/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/10085352",
    "html_url": "https://github.com/rust-lang/rust/issues/3917#issuecomment-10085352",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/3917",
    "id": 10085352,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEwMDg1MzUy",
    "user": {
      "login": "brson",
      "id": 147214,
      "node_id": "MDQ6VXNlcjE0NzIxNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/brson",
      "html_url": "https://github.com/brson",
      "followers_url": "https://api.github.com/users/brson/followers",
      "following_url": "https://api.github.com/users/brson/following{/other_user}",
      "gists_url": "https://api.github.com/users/brson/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/brson/subscriptions",
      "organizations_url": "https://api.github.com/users/brson/orgs",
      "repos_url": "https://api.github.com/users/brson/repos",
      "events_url": "https://api.github.com/users/brson/events{/privacy}",
      "received_events_url": "https://api.github.com/users/brson/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2012-11-05T19:59:58Z",
    "updated_at": "2012-11-05T19:59:58Z",
    "body": "Updated title to reflect problem\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/10085352/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/10388553",
    "html_url": "https://github.com/rust-lang/rust/issues/3917#issuecomment-10388553",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/3917",
    "id": 10388553,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEwMzg4NTUz",
    "user": {
      "login": "nikomatsakis",
      "id": 155238,
      "node_id": "MDQ6VXNlcjE1NTIzOA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/155238?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nikomatsakis",
      "html_url": "https://github.com/nikomatsakis",
      "followers_url": "https://api.github.com/users/nikomatsakis/followers",
      "following_url": "https://api.github.com/users/nikomatsakis/following{/other_user}",
      "gists_url": "https://api.github.com/users/nikomatsakis/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nikomatsakis/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nikomatsakis/subscriptions",
      "organizations_url": "https://api.github.com/users/nikomatsakis/orgs",
      "repos_url": "https://api.github.com/users/nikomatsakis/repos",
      "events_url": "https://api.github.com/users/nikomatsakis/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nikomatsakis/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2012-11-14T22:23:30Z",
    "updated_at": "2012-11-14T22:23:30Z",
    "body": "though I don't see why it would cause this problem, this use of move_val_init is invalid. The `init` is supposed to mean that this intrinsic is used to initialize the memory being moved into.  That is, it expects the memory to be uninitialized and hence does not drop the previous value (which is garbage).  Here of course the memory is initialized, but then... this is a boolean value, so it shouldn't matter.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/10388553/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/11072302",
    "html_url": "https://github.com/rust-lang/rust/issues/3917#issuecomment-11072302",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/3917",
    "id": 11072302,
    "node_id": "MDEyOklzc3VlQ29tbWVudDExMDcyMzAy",
    "user": {
      "login": "pcwalton",
      "id": 157897,
      "node_id": "MDQ6VXNlcjE1Nzg5Nw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/157897?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/pcwalton",
      "html_url": "https://github.com/pcwalton",
      "followers_url": "https://api.github.com/users/pcwalton/followers",
      "following_url": "https://api.github.com/users/pcwalton/following{/other_user}",
      "gists_url": "https://api.github.com/users/pcwalton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/pcwalton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/pcwalton/subscriptions",
      "organizations_url": "https://api.github.com/users/pcwalton/orgs",
      "repos_url": "https://api.github.com/users/pcwalton/repos",
      "events_url": "https://api.github.com/users/pcwalton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/pcwalton/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2012-12-06T03:54:16Z",
    "updated_at": "2012-12-06T03:54:16Z",
    "body": "This is a problem with type_use.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/11072302/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
