{
  "url": "https://api.github.com/repos/rust-lang/rust/issues/16110",
  "repository_url": "https://api.github.com/repos/rust-lang/rust",
  "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/16110/labels{/name}",
  "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/16110/comments",
  "events_url": "https://api.github.com/repos/rust-lang/rust/issues/16110/events",
  "html_url": "https://github.com/rust-lang/rust/pull/16110",
  "id": 39100196,
  "node_id": "MDExOlB1bGxSZXF1ZXN0MTkwOTQwODc=",
  "number": 16110,
  "title": "rustc: Link entire archives of native libraries",
  "user": {
    "login": "alexcrichton",
    "id": 64996,
    "node_id": "MDQ6VXNlcjY0OTk2",
    "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/alexcrichton",
    "html_url": "https://github.com/alexcrichton",
    "followers_url": "https://api.github.com/users/alexcrichton/followers",
    "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}",
    "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions",
    "organizations_url": "https://api.github.com/users/alexcrichton/orgs",
    "repos_url": "https://api.github.com/users/alexcrichton/repos",
    "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}",
    "received_events_url": "https://api.github.com/users/alexcrichton/received_events",
    "type": "User",
    "user_view_type": "public",
    "site_admin": false
  },
  "labels": [],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [],
  "milestone": null,
  "comments": 0,
  "created_at": "2014-07-30T14:53:14Z",
  "updated_at": "2014-08-16T05:18:24Z",
  "closed_at": "2014-08-04T23:56:28Z",
  "author_association": "MEMBER",
  "type": null,
  "active_lock_reason": null,
  "draft": false,
  "pull_request": {
    "url": "https://api.github.com/repos/rust-lang/rust/pulls/16110",
    "html_url": "https://github.com/rust-lang/rust/pull/16110",
    "diff_url": "https://github.com/rust-lang/rust/pull/16110.diff",
    "patch_url": "https://github.com/rust-lang/rust/pull/16110.patch",
    "merged_at": "2014-08-04T23:56:34Z"
  },
  "body": "As discovered in #15460, a particular #[link(kind = \"static\", ...)] line is not\nactually guaranteed to link the library at all. The reason for this is that if\nthe external library doesn't have any referenced symbols in the object generated\nby rustc, the entire library is dropped by the linker.\n\nFor dynamic native libraries, this is solved by passing -lfoo for all downstream\ncompilations unconditionally. For static libraries in rlibs this is solved\nbecause the entire archive is bundled in the rlib. The only situation in which\nthis was a problem was when a static native library was linked to a rust dynamic\nlibrary.\n\nThis commit brings the behavior of dylibs in line with rlibs by passing the\n--whole-archive flag to the linker when linking native libraries. On OSX, this\nuses the -force_load flag. This flag ensures that the entire archive is\nconsidered candidate for being linked into the final dynamic library.\n\nThis is a breaking change because if any static library is included twice in the\nsame compilation unit then the linker will start emitting errors about duplicate\ndefinitions now. The fix for this would involve only statically linking to a\nlibrary once.\n\nCloses #15460\n[breaking-change]\n",
  "closed_by": {
    "login": "bors",
    "id": 3372342,
    "node_id": "MDQ6VXNlcjMzNzIzNDI=",
    "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/bors",
    "html_url": "https://github.com/bors",
    "followers_url": "https://api.github.com/users/bors/followers",
    "following_url": "https://api.github.com/users/bors/following{/other_user}",
    "gists_url": "https://api.github.com/users/bors/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/bors/subscriptions",
    "organizations_url": "https://api.github.com/users/bors/orgs",
    "repos_url": "https://api.github.com/users/bors/repos",
    "events_url": "https://api.github.com/users/bors/events{/privacy}",
    "received_events_url": "https://api.github.com/users/bors/received_events",
    "type": "User",
    "user_view_type": "public",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/16110/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/16110/timeline",
  "performed_via_github_app": null,
  "state_reason": null,
  "_meta": {
    "type": "pr"
  }
}
