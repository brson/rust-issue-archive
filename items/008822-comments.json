[
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/23417177",
    "html_url": "https://github.com/rust-lang/rust/issues/8822#issuecomment-23417177",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/8822",
    "id": 23417177,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIzNDE3MTc3",
    "user": {
      "login": "metajack",
      "id": 28357,
      "node_id": "MDQ6VXNlcjI4MzU3",
      "avatar_url": "https://avatars.githubusercontent.com/u/28357?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/metajack",
      "html_url": "https://github.com/metajack",
      "followers_url": "https://api.github.com/users/metajack/followers",
      "following_url": "https://api.github.com/users/metajack/following{/other_user}",
      "gists_url": "https://api.github.com/users/metajack/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/metajack/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/metajack/subscriptions",
      "organizations_url": "https://api.github.com/users/metajack/orgs",
      "repos_url": "https://api.github.com/users/metajack/repos",
      "events_url": "https://api.github.com/users/metajack/events{/privacy}",
      "received_events_url": "https://api.github.com/users/metajack/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2013-08-28T14:13:34Z",
    "updated_at": "2013-08-28T14:13:34Z",
    "body": "+1 for the new annotation syntax, except that I think that we should forbid `#[stack]` alone, as it's not clear at all what it's doing.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/23417177/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/23627993",
    "html_url": "https://github.com/rust-lang/rust/issues/8822#issuecomment-23627993",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/8822",
    "id": 23627993,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIzNjI3OTkz",
    "user": {
      "login": "alexcrichton",
      "id": 64996,
      "node_id": "MDQ6VXNlcjY0OTk2",
      "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alexcrichton",
      "html_url": "https://github.com/alexcrichton",
      "followers_url": "https://api.github.com/users/alexcrichton/followers",
      "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}",
      "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions",
      "organizations_url": "https://api.github.com/users/alexcrichton/orgs",
      "repos_url": "https://api.github.com/users/alexcrichton/repos",
      "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alexcrichton/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2013-09-01T16:24:27Z",
    "updated_at": "2013-09-01T16:24:27Z",
    "body": "Could you elaborate a bit more on how the guard pages will work? Is this attempting to remove calls to `__morestack` entirely? Right now that keeps us from overrunning the stack, but if we're using guard pages instead I presume we wouldn't use that function.\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/23627993/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/23630436",
    "html_url": "https://github.com/rust-lang/rust/issues/8822#issuecomment-23630436",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/8822",
    "id": 23630436,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIzNjMwNDM2",
    "user": {
      "login": "thestinger",
      "id": 1505226,
      "node_id": "MDQ6VXNlcjE1MDUyMjY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1505226?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/thestinger",
      "html_url": "https://github.com/thestinger",
      "followers_url": "https://api.github.com/users/thestinger/followers",
      "following_url": "https://api.github.com/users/thestinger/following{/other_user}",
      "gists_url": "https://api.github.com/users/thestinger/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/thestinger/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/thestinger/subscriptions",
      "organizations_url": "https://api.github.com/users/thestinger/orgs",
      "repos_url": "https://api.github.com/users/thestinger/repos",
      "events_url": "https://api.github.com/users/thestinger/events{/privacy}",
      "received_events_url": "https://api.github.com/users/thestinger/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2013-09-01T18:39:51Z",
    "updated_at": "2013-09-01T18:41:26Z",
    "body": "It seems like we could simply use `__morestack`, but teach LLVM to omit the calls for functions under a configured size. The only issue I can see with guard pages it that it means the smallest stack size will likely be 8K, since we need to ask for 2 pages from `mmap` and `mprotect` the second.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/23630436/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/23683711",
    "html_url": "https://github.com/rust-lang/rust/issues/8822#issuecomment-23683711",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/8822",
    "id": 23683711,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIzNjgzNzEx",
    "user": {
      "login": "nikomatsakis",
      "id": 155238,
      "node_id": "MDQ6VXNlcjE1NTIzOA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/155238?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nikomatsakis",
      "html_url": "https://github.com/nikomatsakis",
      "followers_url": "https://api.github.com/users/nikomatsakis/followers",
      "following_url": "https://api.github.com/users/nikomatsakis/following{/other_user}",
      "gists_url": "https://api.github.com/users/nikomatsakis/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nikomatsakis/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nikomatsakis/subscriptions",
      "organizations_url": "https://api.github.com/users/nikomatsakis/orgs",
      "repos_url": "https://api.github.com/users/nikomatsakis/repos",
      "events_url": "https://api.github.com/users/nikomatsakis/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nikomatsakis/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2013-09-03T00:06:26Z",
    "updated_at": "2013-09-03T00:06:26Z",
    "body": "I am not entirely sure what the precise interaction between guard pages and morestack should be. Guard pages cannot replace morestack entirely. Errors detected via guard pages are non-recoverable, unlike morestack which can allocate more stack and then switch the current stack pointer. So if we wish to dynamically grow our stacks, we need morestack. But if we just want to detect stack overrun and fail in response, a guard page is adequate -- and, of course, when running non-instrumented code (like C code) a guard page is basically the only protection you can have.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/23683711/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/23687041",
    "html_url": "https://github.com/rust-lang/rust/issues/8822#issuecomment-23687041",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/8822",
    "id": 23687041,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIzNjg3MDQx",
    "user": {
      "login": "alexcrichton",
      "id": 64996,
      "node_id": "MDQ6VXNlcjY0OTk2",
      "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alexcrichton",
      "html_url": "https://github.com/alexcrichton",
      "followers_url": "https://api.github.com/users/alexcrichton/followers",
      "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}",
      "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions",
      "organizations_url": "https://api.github.com/users/alexcrichton/orgs",
      "repos_url": "https://api.github.com/users/alexcrichton/repos",
      "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alexcrichton/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2013-09-03T02:44:56Z",
    "updated_at": "2013-09-03T02:44:56Z",
    "body": "It sounds like this is two different modes of compilation.\n\nOn one hand, you have segmented stacks that could be very small. The `stack` attribute would dictate what the `__morestack` requests for in terms of allocation size for the current function. This is basically what exists today except that you would have finer-grained control over the allocated stack size (with this new attribute).\n\nOn the other hand, you don't have segmented stacks at all. This would require using guard pages and having one monolithically growing stack (per thread? maybe this mode has no runtime anyway?). We would instruct LLVM to emit a function like windows' `_chkstk`. For all functions require less than one page of stack space, this function is omitted. For all functions requiring a page or more, this function would ensure that the stack space is available, allocating more if necessary.\n\nI suppose though that one mixture of these two would be that when we allocate a \"large stack segment\" we could be sure to allocate one with a guard page at the end. This would ensure that the C function you're about to call doesn't overrun (as long as the overrunning function doesn't request more than 1 page of stack).\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/23687041/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/23700600",
    "html_url": "https://github.com/rust-lang/rust/issues/8822#issuecomment-23700600",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/8822",
    "id": 23700600,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIzNzAwNjAw",
    "user": {
      "login": "nikomatsakis",
      "id": 155238,
      "node_id": "MDQ6VXNlcjE1NTIzOA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/155238?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nikomatsakis",
      "html_url": "https://github.com/nikomatsakis",
      "followers_url": "https://api.github.com/users/nikomatsakis/followers",
      "following_url": "https://api.github.com/users/nikomatsakis/following{/other_user}",
      "gists_url": "https://api.github.com/users/nikomatsakis/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nikomatsakis/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nikomatsakis/subscriptions",
      "organizations_url": "https://api.github.com/users/nikomatsakis/orgs",
      "repos_url": "https://api.github.com/users/nikomatsakis/repos",
      "events_url": "https://api.github.com/users/nikomatsakis/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nikomatsakis/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2013-09-03T09:42:20Z",
    "updated_at": "2013-09-03T09:42:20Z",
    "body": "I agree they are distinct modes, but I don't think they need to be distinct modes of _compilation_. Even if you are using segmented stacks, there are times you want to shift (temporarily) to a large stack -- calling a C function being a notable example. The real question is whether, once you shift to a large stack chunk, you wish to continue allocating further stack chunks, or whether you are done switching at that point.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/23700600/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/23701092",
    "html_url": "https://github.com/rust-lang/rust/issues/8822#issuecomment-23701092",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/8822",
    "id": 23701092,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIzNzAxMDky",
    "user": {
      "login": "thestinger",
      "id": 1505226,
      "node_id": "MDQ6VXNlcjE1MDUyMjY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1505226?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/thestinger",
      "html_url": "https://github.com/thestinger",
      "followers_url": "https://api.github.com/users/thestinger/followers",
      "following_url": "https://api.github.com/users/thestinger/following{/other_user}",
      "gists_url": "https://api.github.com/users/thestinger/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/thestinger/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/thestinger/subscriptions",
      "organizations_url": "https://api.github.com/users/thestinger/orgs",
      "repos_url": "https://api.github.com/users/thestinger/repos",
      "events_url": "https://api.github.com/users/thestinger/events{/privacy}",
      "received_events_url": "https://api.github.com/users/thestinger/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2013-09-03T09:52:48Z",
    "updated_at": "2013-09-03T09:52:48Z",
    "body": "@nikomatsakis: You can catch the `SIGSEGV` signal and check if it was caused by a specific guard page, but I guess you've already generated a corrupt program state by then.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/23701092/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/23722974",
    "html_url": "https://github.com/rust-lang/rust/issues/8822#issuecomment-23722974",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/8822",
    "id": 23722974,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIzNzIyOTc0",
    "user": {
      "login": "nikomatsakis",
      "id": 155238,
      "node_id": "MDQ6VXNlcjE1NTIzOA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/155238?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nikomatsakis",
      "html_url": "https://github.com/nikomatsakis",
      "followers_url": "https://api.github.com/users/nikomatsakis/followers",
      "following_url": "https://api.github.com/users/nikomatsakis/following{/other_user}",
      "gists_url": "https://api.github.com/users/nikomatsakis/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nikomatsakis/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nikomatsakis/subscriptions",
      "organizations_url": "https://api.github.com/users/nikomatsakis/orgs",
      "repos_url": "https://api.github.com/users/nikomatsakis/repos",
      "events_url": "https://api.github.com/users/nikomatsakis/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nikomatsakis/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2013-09-03T15:47:51Z",
    "updated_at": "2013-09-03T15:47:51Z",
    "body": "@thestinger my point was that you can't recover from this state, except perhaps by killing the relevant task (killing the task would require some finesse but is possible, I imagine). You can't, for example, allocate a new chunk of stack and start using that instead.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/23722974/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/23737788",
    "html_url": "https://github.com/rust-lang/rust/issues/8822#issuecomment-23737788",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/8822",
    "id": 23737788,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIzNzM3Nzg4",
    "user": {
      "login": "brson",
      "id": 147214,
      "node_id": "MDQ6VXNlcjE0NzIxNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/brson",
      "html_url": "https://github.com/brson",
      "followers_url": "https://api.github.com/users/brson/followers",
      "following_url": "https://api.github.com/users/brson/following{/other_user}",
      "gists_url": "https://api.github.com/users/brson/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/brson/subscriptions",
      "organizations_url": "https://api.github.com/users/brson/orgs",
      "repos_url": "https://api.github.com/users/brson/repos",
      "events_url": "https://api.github.com/users/brson/events{/privacy}",
      "received_events_url": "https://api.github.com/users/brson/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2013-09-03T18:57:05Z",
    "updated_at": "2013-09-03T18:58:34Z",
    "body": "I'm generally ok with this plan, though it makes me a bit sad to say that once you hit an FSS you stop growing the stack.\n\nAll the `fixed`, `medium`, etc. attributes will require more rust-specific attributes in LLVM (each will be a different llvm annotation unless they've made their system more expressive recently). The more of these we have the harder time we're going to have upstreaming.\n\n\"FSS functions will not check for 2MB of space but rather check for a limit of 0, indicating a FSS\" - this sounds like it requires an entirely different prologue, which requires a bunch of platform-specific llvm changes. This is more rust-specific code to upstream.\n\nHaving rust code operate when the stack limit is 0 means that we have to fall back to TLS to retrieve the task pointer in those cases. This will result in the runtime being slightly slower in C callbacks.\n\nWhat do you mean 'we will probably want a guard page in all scenarios'? Why else is it required besides preventing overflow on the FSS?\n\nI think we should not be inlining FSS functions into non-FSS functions and I'm not clear on the current semantics there.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/23737788/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/23738045",
    "html_url": "https://github.com/rust-lang/rust/issues/8822#issuecomment-23738045",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/8822",
    "id": 23738045,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIzNzM4MDQ1",
    "user": {
      "login": "brson",
      "id": 147214,
      "node_id": "MDQ6VXNlcjE0NzIxNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/brson",
      "html_url": "https://github.com/brson",
      "followers_url": "https://api.github.com/users/brson/followers",
      "following_url": "https://api.github.com/users/brson/following{/other_user}",
      "gists_url": "https://api.github.com/users/brson/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/brson/subscriptions",
      "organizations_url": "https://api.github.com/users/brson/orgs",
      "repos_url": "https://api.github.com/users/brson/repos",
      "events_url": "https://api.github.com/users/brson/events{/privacy}",
      "received_events_url": "https://api.github.com/users/brson/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2013-09-03T19:00:29Z",
    "updated_at": "2013-09-03T19:00:29Z",
    "body": "I guess the `#[stack(small)]` etc. annotations would leave open the possibility of stack overflow if all segments did not have guard pages. Putting guard pages on all segments seems like a huge waste though.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/23738045/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/23742200",
    "html_url": "https://github.com/rust-lang/rust/issues/8822#issuecomment-23742200",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/8822",
    "id": 23742200,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIzNzQyMjAw",
    "user": {
      "login": "nikomatsakis",
      "id": 155238,
      "node_id": "MDQ6VXNlcjE1NTIzOA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/155238?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nikomatsakis",
      "html_url": "https://github.com/nikomatsakis",
      "followers_url": "https://api.github.com/users/nikomatsakis/followers",
      "following_url": "https://api.github.com/users/nikomatsakis/following{/other_user}",
      "gists_url": "https://api.github.com/users/nikomatsakis/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nikomatsakis/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nikomatsakis/subscriptions",
      "organizations_url": "https://api.github.com/users/nikomatsakis/orgs",
      "repos_url": "https://api.github.com/users/nikomatsakis/repos",
      "events_url": "https://api.github.com/users/nikomatsakis/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nikomatsakis/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2013-09-03T19:59:48Z",
    "updated_at": "2013-09-03T19:59:48Z",
    "body": "I think I was just concerned about handling the case where you call a C library that is improperly annotated and it runs over. Perhaps this is not worth guarding against. Also, minimizing LLVM churn might be a valid constraint, in which case this plan is not the best. In particular, I am not sure if the idea of \"switching to FSS and never switching back\" makes sense or not. Mostly though I am concerned about this scenario:\n- You call into C code, switching to a (let's say) 3MB stack beacuse you requested a 2MB\n- You get a callback after 1MB of stack is consumed and call another C function\n- At this point, you have 2MB of stack left, but we'll switch to another 3MB stack\n\nPerhaps rather than having FSS be a separate _mode_ what is needed is to separate out the minimum stack you require vs the amount you allocate if that minimum is unavailable. That is, just tweak the current system, essentially. And I'd probably remove the word \"fixed\" and just have small/med/large. Made medium is the default, and it requires something like 512K but allocates 2MB, whereas large requires 1MB. Or something. Probably better to do some measurements of stack depth for popular C libraries to get an idea what good numbers are (and maybe have those thresholds be tweakable via runtime calls?)\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/23742200/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/23742226",
    "html_url": "https://github.com/rust-lang/rust/issues/8822#issuecomment-23742226",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/8822",
    "id": 23742226,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIzNzQyMjI2",
    "user": {
      "login": "nikomatsakis",
      "id": 155238,
      "node_id": "MDQ6VXNlcjE1NTIzOA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/155238?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nikomatsakis",
      "html_url": "https://github.com/nikomatsakis",
      "followers_url": "https://api.github.com/users/nikomatsakis/followers",
      "following_url": "https://api.github.com/users/nikomatsakis/following{/other_user}",
      "gists_url": "https://api.github.com/users/nikomatsakis/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nikomatsakis/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nikomatsakis/subscriptions",
      "organizations_url": "https://api.github.com/users/nikomatsakis/orgs",
      "repos_url": "https://api.github.com/users/nikomatsakis/repos",
      "events_url": "https://api.github.com/users/nikomatsakis/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nikomatsakis/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2013-09-03T20:00:09Z",
    "updated_at": "2013-09-03T20:00:09Z",
    "body": "Well, we can't tweak the thresholds we check, but we can tweak how much memory is allocated.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/23742226/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/26322331",
    "html_url": "https://github.com/rust-lang/rust/issues/8822#issuecomment-26322331",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/8822",
    "id": 26322331,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI2MzIyMzMx",
    "user": {
      "login": "nikomatsakis",
      "id": 155238,
      "node_id": "MDQ6VXNlcjE1NTIzOA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/155238?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nikomatsakis",
      "html_url": "https://github.com/nikomatsakis",
      "followers_url": "https://api.github.com/users/nikomatsakis/followers",
      "following_url": "https://api.github.com/users/nikomatsakis/following{/other_user}",
      "gists_url": "https://api.github.com/users/nikomatsakis/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nikomatsakis/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nikomatsakis/subscriptions",
      "organizations_url": "https://api.github.com/users/nikomatsakis/orgs",
      "repos_url": "https://api.github.com/users/nikomatsakis/repos",
      "events_url": "https://api.github.com/users/nikomatsakis/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nikomatsakis/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2013-10-15T10:00:32Z",
    "updated_at": "2013-10-15T10:00:32Z",
    "body": "@brson and @pnkfelix and I had a discussion about this. I think that we settled on not having a notion of fixed vs unfixed but instead having a scheme like so:\n- You can annotate functions with `#[stack(SIZE)]` where `SIZE` is either `zero`, `small`, `medium`, or `large`. If `SIZE` is omitted, then `large` is assumed. (?)\n- On Rust fn items, these annotations override the normal stack request mechanism. They cause the header to check for C bytes of stack and then, if C bytes are not present, request R bytes of stack, where C and R depend on `SIZE` as defined in the table below.\n- On extern fn items, these annotations document the expected stack requirements (perhaps a separate annotation would be clearer?). The default size if an extern fn is not annotated is `large`.\n- The linter will check that every call to an extern fn annotated with `#[stack(E)]` occurs inside a Rust fn annotated with `#[stack(F)]` where `F > E`. As a special case, if `E` is `zero`, then the fn can be called from any Rust fn without error (this is the equivalent of today's `#[rust_stack]` annotation).\n- A separate linter will warn about `#[stack(zero)]` being applied to a Rust fn item, which is almost certainly an error!\n\nStack-size table. Naturally I pulled these numbers out of thin air and we should actually do some empirical investigation to try and figure out useful thresholds.\n\n```\nSize    C     R\nzero    0     0\nsmall   256  512\nmedium  512  1MB\nlarge   1MB  2MB\n```\n\nThis scheme is relatively simple and consistent. Like any scheme, it can perform poorly in some pathological scenarios, but that is true of the fixed stack segment scheme as well. An advantage of this scheme is that it means that Rust code can always rely on the invariant that limitless recursion is permitted.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/26322331/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/26351791",
    "html_url": "https://github.com/rust-lang/rust/issues/8822#issuecomment-26351791",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/8822",
    "id": 26351791,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI2MzUxNzkx",
    "user": {
      "login": "alexcrichton",
      "id": 64996,
      "node_id": "MDQ6VXNlcjY0OTk2",
      "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alexcrichton",
      "html_url": "https://github.com/alexcrichton",
      "followers_url": "https://api.github.com/users/alexcrichton/followers",
      "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}",
      "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions",
      "organizations_url": "https://api.github.com/users/alexcrichton/orgs",
      "repos_url": "https://api.github.com/users/alexcrichton/repos",
      "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alexcrichton/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2013-10-15T16:49:41Z",
    "updated_at": "2013-10-15T16:49:41Z",
    "body": "Nominating for backcompat-lang and 1.0\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/26351791/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/26529077",
    "html_url": "https://github.com/rust-lang/rust/issues/8822#issuecomment-26529077",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/8822",
    "id": 26529077,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI2NTI5MDc3",
    "user": {
      "login": "catamorphism",
      "id": 427212,
      "node_id": "MDQ6VXNlcjQyNzIxMg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/427212?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/catamorphism",
      "html_url": "https://github.com/catamorphism",
      "followers_url": "https://api.github.com/users/catamorphism/followers",
      "following_url": "https://api.github.com/users/catamorphism/following{/other_user}",
      "gists_url": "https://api.github.com/users/catamorphism/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/catamorphism/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/catamorphism/subscriptions",
      "organizations_url": "https://api.github.com/users/catamorphism/orgs",
      "repos_url": "https://api.github.com/users/catamorphism/repos",
      "events_url": "https://api.github.com/users/catamorphism/events{/privacy}",
      "received_events_url": "https://api.github.com/users/catamorphism/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2013-10-17T17:20:22Z",
    "updated_at": "2013-10-17T17:20:22Z",
    "body": "1.0, backcompat\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/26529077/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/27332803",
    "html_url": "https://github.com/rust-lang/rust/issues/8822#issuecomment-27332803",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/8822",
    "id": 27332803,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3MzMyODAz",
    "user": {
      "login": "alexcrichton",
      "id": 64996,
      "node_id": "MDQ6VXNlcjY0OTk2",
      "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alexcrichton",
      "html_url": "https://github.com/alexcrichton",
      "followers_url": "https://api.github.com/users/alexcrichton/followers",
      "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}",
      "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions",
      "organizations_url": "https://api.github.com/users/alexcrichton/orgs",
      "repos_url": "https://api.github.com/users/alexcrichton/repos",
      "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alexcrichton/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2013-10-29T19:00:16Z",
    "updated_at": "2013-10-29T19:00:16Z",
    "body": "In [today's meeting](https://github.com/mozilla/rust/wiki/Meeting-weekly-2013-10-29) we have decided to jettison segmented stacks. I think that it nullifies a bit of discussion in this issue, but not all of it. Namely I think that we should still be able to control the amount of stack requested by an extern function.\n\nOnce #10155 is dealt with, We'll only have a remaining `rust_stack` attribute, but I think this should be replaced with a generic `stack(amount)` attribute.\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/27332803/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
