[
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/133768935",
    "html_url": "https://github.com/rust-lang/rust/issues/27950#issuecomment-133768935",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/27950",
    "id": 133768935,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEzMzc2ODkzNQ==",
    "user": {
      "login": "eefriedman",
      "id": 12769964,
      "node_id": "MDQ6VXNlcjEyNzY5OTY0",
      "avatar_url": "https://avatars.githubusercontent.com/u/12769964?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/eefriedman",
      "html_url": "https://github.com/eefriedman",
      "followers_url": "https://api.github.com/users/eefriedman/followers",
      "following_url": "https://api.github.com/users/eefriedman/following{/other_user}",
      "gists_url": "https://api.github.com/users/eefriedman/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/eefriedman/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/eefriedman/subscriptions",
      "organizations_url": "https://api.github.com/users/eefriedman/orgs",
      "repos_url": "https://api.github.com/users/eefriedman/repos",
      "events_url": "https://api.github.com/users/eefriedman/events{/privacy}",
      "received_events_url": "https://api.github.com/users/eefriedman/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-08-23T01:20:50Z",
    "updated_at": "2015-08-23T01:20:50Z",
    "body": "Your suggested transformation could very easily go wrong: in some cases, the derived implementation wouldn't compile.  Very simple example: you write Input2<'a>, which contains a field Input<'a>, and Input's PartialEq is implemented like `impl <'a> PartialEq for Input<'a>`.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/133768935/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/133772626",
    "html_url": "https://github.com/rust-lang/rust/issues/27950#issuecomment-133772626",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/27950",
    "id": 133772626,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEzMzc3MjYyNg==",
    "user": {
      "login": "solson",
      "id": 26806,
      "node_id": "MDQ6VXNlcjI2ODA2",
      "avatar_url": "https://avatars.githubusercontent.com/u/26806?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/solson",
      "html_url": "https://github.com/solson",
      "followers_url": "https://api.github.com/users/solson/followers",
      "following_url": "https://api.github.com/users/solson/following{/other_user}",
      "gists_url": "https://api.github.com/users/solson/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/solson/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/solson/subscriptions",
      "organizations_url": "https://api.github.com/users/solson/orgs",
      "repos_url": "https://api.github.com/users/solson/repos",
      "events_url": "https://api.github.com/users/solson/events{/privacy}",
      "received_events_url": "https://api.github.com/users/solson/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-08-23T02:22:34Z",
    "updated_at": "2015-08-23T02:22:34Z",
    "body": "@eefriedman Can you expand on your example? `impl <'a> PartialEq for Input<'a>` is what the _current_ derive code generates.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/133772626/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/133776881",
    "html_url": "https://github.com/rust-lang/rust/issues/27950#issuecomment-133776881",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/27950",
    "id": 133776881,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEzMzc3Njg4MQ==",
    "user": {
      "login": "eefriedman",
      "id": 12769964,
      "node_id": "MDQ6VXNlcjEyNzY5OTY0",
      "avatar_url": "https://avatars.githubusercontent.com/u/12769964?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/eefriedman",
      "html_url": "https://github.com/eefriedman",
      "followers_url": "https://api.github.com/users/eefriedman/followers",
      "following_url": "https://api.github.com/users/eefriedman/following{/other_user}",
      "gists_url": "https://api.github.com/users/eefriedman/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/eefriedman/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/eefriedman/subscriptions",
      "organizations_url": "https://api.github.com/users/eefriedman/orgs",
      "repos_url": "https://api.github.com/users/eefriedman/repos",
      "events_url": "https://api.github.com/users/eefriedman/events{/privacy}",
      "received_events_url": "https://api.github.com/users/eefriedman/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-08-23T03:05:46Z",
    "updated_at": "2015-08-23T03:05:46Z",
    "body": "``` rust\nuse std::cmp::PartialEq;\n\nstruct Input<'a> {\n    bytes: &'a [u8],\n}\n\nimpl <'a> PartialEq for Input<'a> {\n    #[inline]\n    fn eq(&self, _other: &Input<'a>) -> bool {\n        panic!()\n    }\n}\n\nstruct Input2<'a> {\n    i: Input<'a>\n}\n\nimpl<'a, 'b> PartialEq<Input2<'b>> for Input2<'a> {\n    #[inline]\n    fn eq(&self, other: &Input2<'b>) -> bool {\n        self.i == other.i // error here\n    }\n}\n\nfn main() {}\n```\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/133776881/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/133813502",
    "html_url": "https://github.com/rust-lang/rust/issues/27950#issuecomment-133813502",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/27950",
    "id": 133813502,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEzMzgxMzUwMg==",
    "user": {
      "login": "eddyb",
      "id": 77424,
      "node_id": "MDQ6VXNlcjc3NDI0",
      "avatar_url": "https://avatars.githubusercontent.com/u/77424?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/eddyb",
      "html_url": "https://github.com/eddyb",
      "followers_url": "https://api.github.com/users/eddyb/followers",
      "following_url": "https://api.github.com/users/eddyb/following{/other_user}",
      "gists_url": "https://api.github.com/users/eddyb/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/eddyb/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/eddyb/subscriptions",
      "organizations_url": "https://api.github.com/users/eddyb/orgs",
      "repos_url": "https://api.github.com/users/eddyb/repos",
      "events_url": "https://api.github.com/users/eddyb/events{/privacy}",
      "received_events_url": "https://api.github.com/users/eddyb/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-08-23T10:27:12Z",
    "updated_at": "2015-08-23T10:27:12Z",
    "body": "@eefriedman You're missing the `where` clauses that the compiler is supposed to emit (but I guess that change hasn't happened yet).\nSpecifically, `where Input<'a>: PartialEq<Input<'b>>` which should automatically introduce `'a == 'b` in this specific case.\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/133813502/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/133868657",
    "html_url": "https://github.com/rust-lang/rust/issues/27950#issuecomment-133868657",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/27950",
    "id": 133868657,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEzMzg2ODY1Nw==",
    "user": {
      "login": "eefriedman",
      "id": 12769964,
      "node_id": "MDQ6VXNlcjEyNzY5OTY0",
      "avatar_url": "https://avatars.githubusercontent.com/u/12769964?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/eefriedman",
      "html_url": "https://github.com/eefriedman",
      "followers_url": "https://api.github.com/users/eefriedman/followers",
      "following_url": "https://api.github.com/users/eefriedman/following{/other_user}",
      "gists_url": "https://api.github.com/users/eefriedman/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/eefriedman/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/eefriedman/subscriptions",
      "organizations_url": "https://api.github.com/users/eefriedman/orgs",
      "repos_url": "https://api.github.com/users/eefriedman/repos",
      "events_url": "https://api.github.com/users/eefriedman/events{/privacy}",
      "received_events_url": "https://api.github.com/users/eefriedman/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-08-23T15:48:18Z",
    "updated_at": "2015-08-23T15:48:18Z",
    "body": "@eddyb The compiler currently rejects `where` clauses which don't involve a type parameter... is there an RFC somewhere to allow it?\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/133868657/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/133993721",
    "html_url": "https://github.com/rust-lang/rust/issues/27950#issuecomment-133993721",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/27950",
    "id": 133993721,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEzMzk5MzcyMQ==",
    "user": {
      "login": "eefriedman",
      "id": 12769964,
      "node_id": "MDQ6VXNlcjEyNzY5OTY0",
      "avatar_url": "https://avatars.githubusercontent.com/u/12769964?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/eefriedman",
      "html_url": "https://github.com/eefriedman",
      "followers_url": "https://api.github.com/users/eefriedman/followers",
      "following_url": "https://api.github.com/users/eefriedman/following{/other_user}",
      "gists_url": "https://api.github.com/users/eefriedman/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/eefriedman/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/eefriedman/subscriptions",
      "organizations_url": "https://api.github.com/users/eefriedman/orgs",
      "repos_url": "https://api.github.com/users/eefriedman/repos",
      "events_url": "https://api.github.com/users/eefriedman/events{/privacy}",
      "received_events_url": "https://api.github.com/users/eefriedman/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-08-24T02:24:10Z",
    "updated_at": "2015-08-24T02:24:10Z",
    "body": "Created pull request #27972.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/133993721/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/247716698",
    "html_url": "https://github.com/rust-lang/rust/issues/27950#issuecomment-247716698",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/27950",
    "id": 247716698,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI0NzcxNjY5OA==",
    "user": {
      "login": "solson",
      "id": 26806,
      "node_id": "MDQ6VXNlcjI2ODA2",
      "avatar_url": "https://avatars.githubusercontent.com/u/26806?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/solson",
      "html_url": "https://github.com/solson",
      "followers_url": "https://api.github.com/users/solson/followers",
      "following_url": "https://api.github.com/users/solson/following{/other_user}",
      "gists_url": "https://api.github.com/users/solson/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/solson/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/solson/subscriptions",
      "organizations_url": "https://api.github.com/users/solson/orgs",
      "repos_url": "https://api.github.com/users/solson/repos",
      "events_url": "https://api.github.com/users/solson/events{/privacy}",
      "received_events_url": "https://api.github.com/users/solson/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2016-09-16T21:46:40Z",
    "updated_at": "2016-09-16T21:46:40Z",
    "body": "So, it's one year later. I took @eefriedman's example with the error, added @eddyb's where clause, and it compiles just fine: https://is.gd/m3phSn\n\nIs it time we could change the derive code to work this way now?\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/247716698/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/285794167",
    "html_url": "https://github.com/rust-lang/rust/issues/27950#issuecomment-285794167",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/27950",
    "id": 285794167,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI4NTc5NDE2Nw==",
    "user": {
      "login": "solson",
      "id": 26806,
      "node_id": "MDQ6VXNlcjI2ODA2",
      "avatar_url": "https://avatars.githubusercontent.com/u/26806?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/solson",
      "html_url": "https://github.com/solson",
      "followers_url": "https://api.github.com/users/solson/followers",
      "following_url": "https://api.github.com/users/solson/following{/other_user}",
      "gists_url": "https://api.github.com/users/solson/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/solson/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/solson/subscriptions",
      "organizations_url": "https://api.github.com/users/solson/orgs",
      "repos_url": "https://api.github.com/users/solson/repos",
      "events_url": "https://api.github.com/users/solson/events{/privacy}",
      "received_events_url": "https://api.github.com/users/solson/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2017-03-10T21:50:08Z",
    "updated_at": "2017-03-10T21:51:38Z",
    "body": "I was just talking with ajeffrey on IRC about the most generalized version of `derive(PartialEq)` and I think it would work like this:\r\n\r\n```rust\r\n#[derive(PartialEq)]\r\nstruct Foo<'a, A, B> {\r\n    a: &'a [A],\r\n    b: Vec<B>,\r\n    c: String,\r\n}\r\n\r\n// generated\r\nimpl<'a1, 'a2, A1, A2, B1, B2> PartialEq<Foo<'a2, A2, B2>> for Foo<'a1, A1, B1>\r\nwhere\r\n    &'a1 [A1]: PartialEq<&'a2 [A2]>, // for self.a == other.a\r\n    Vec<B1>: PartialEq<Vec<B2>>,     // for self.b == other.b\r\n    String: PartialEq<String>,       // for self.c == other.c. Obviously redundant, but not a real problem and the macro can't be type-directed.\r\n{\r\n    ...\r\n}\r\n```\r\n\r\nThat is, with a fully separately generalized right-hand side type and constraints based on the actual field types you will be comparing, not on the type parameters. Note that it can be the case that `T: PartialEq<U>` doesn't hold but `Bar<T>: PartialEq<Bar<U>>` does hold, depending on how `Bar` uses the type parameter. The current `derive` is overly restrictive in this respect as well.\r\n\r\nThis formulation should handle cases like in the OP and a lot more besides.",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/285794167/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/310911951",
    "html_url": "https://github.com/rust-lang/rust/issues/27950#issuecomment-310911951",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/27950",
    "id": 310911951,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMxMDkxMTk1MQ==",
    "user": {
      "login": "Mark-Simulacrum",
      "id": 5047365,
      "node_id": "MDQ6VXNlcjUwNDczNjU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5047365?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Mark-Simulacrum",
      "html_url": "https://github.com/Mark-Simulacrum",
      "followers_url": "https://api.github.com/users/Mark-Simulacrum/followers",
      "following_url": "https://api.github.com/users/Mark-Simulacrum/following{/other_user}",
      "gists_url": "https://api.github.com/users/Mark-Simulacrum/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Mark-Simulacrum/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Mark-Simulacrum/subscriptions",
      "organizations_url": "https://api.github.com/users/Mark-Simulacrum/orgs",
      "repos_url": "https://api.github.com/users/Mark-Simulacrum/repos",
      "events_url": "https://api.github.com/users/Mark-Simulacrum/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Mark-Simulacrum/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2017-06-25T16:13:22Z",
    "updated_at": "2017-06-25T16:13:22Z",
    "body": "I'm going to close this in favor of https://github.com/rust-lang/rust/issues/26925. That's the specific issue this is tracking (derive being not as intelligent as perhaps we'd want); I don't think separate issues are useful in this case.",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/310911951/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
