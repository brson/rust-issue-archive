[
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/53443428",
    "html_url": "https://github.com/rust-lang/rust/pull/16743#issuecomment-53443428",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/16743",
    "id": 53443428,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUzNDQzNDI4",
    "user": {
      "login": "brson",
      "id": 147214,
      "node_id": "MDQ6VXNlcjE0NzIxNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/brson",
      "html_url": "https://github.com/brson",
      "followers_url": "https://api.github.com/users/brson/followers",
      "following_url": "https://api.github.com/users/brson/following{/other_user}",
      "gists_url": "https://api.github.com/users/brson/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/brson/subscriptions",
      "organizations_url": "https://api.github.com/users/brson/orgs",
      "repos_url": "https://api.github.com/users/brson/repos",
      "events_url": "https://api.github.com/users/brson/events{/privacy}",
      "received_events_url": "https://api.github.com/users/brson/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-08-26T15:52:10Z",
    "updated_at": "2014-08-26T15:52:10Z",
    "body": "If this hurts performance can you get some numbers? In std, performance is pretty often more important than readability.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/53443428/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/53629195",
    "html_url": "https://github.com/rust-lang/rust/pull/16743#issuecomment-53629195",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/16743",
    "id": 53629195,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUzNjI5MTk1",
    "user": {
      "login": "tstorch",
      "id": 4622615,
      "node_id": "MDQ6VXNlcjQ2MjI2MTU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4622615?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/tstorch",
      "html_url": "https://github.com/tstorch",
      "followers_url": "https://api.github.com/users/tstorch/followers",
      "following_url": "https://api.github.com/users/tstorch/following{/other_user}",
      "gists_url": "https://api.github.com/users/tstorch/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/tstorch/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/tstorch/subscriptions",
      "organizations_url": "https://api.github.com/users/tstorch/orgs",
      "repos_url": "https://api.github.com/users/tstorch/repos",
      "events_url": "https://api.github.com/users/tstorch/events{/privacy}",
      "received_events_url": "https://api.github.com/users/tstorch/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-08-27T19:44:03Z",
    "updated_at": "2014-08-28T15:27:37Z",
    "body": "I did somebenchmarks with the following code:\n\n``` rust\nextern crate time;\n\nuse std::io::BufferedReader;\nuse std::io::File;\n\nfn main() {\n    let haystack_path = Path::new(\"lorem_haystack\");\n    let haystack_file = File::open(&haystack_path);\n    let haystack_string = BufferedReader::new(haystack_file).read_to_string().unwrap();\n    let haystack = haystack_string.as_slice();\n\n    let needles_path = Path::new(\"lorem_needles\");\n    let needles_file = File::open(&needles_path);\n    let needles_string_wrapped = BufferedReader::new(needles_file).read_to_string();\n    let needles_string = needles_string_wrapped.unwrap();\n    let needles_string_slice = needles_string.as_slice();\n    let needles: Vec<&str> = needles_string_slice.split('\\n').collect();\n\n    let start = time::precise_time_s();\n\n    let mut cntr = 0 as int;\n    for i in range(0u, 100000) {\n        for needle in needles.iter() {\n            if haystack.contains(*needle) { cntr += 1; }\n        }\n    }\n\n    let end = time::precise_time_s();\n\n    println!(\"{}\", cntr);\n    println!(\"{}\", end - start as f64);\n}\n```\n\nWith some lorem ipsum as haystack and the unique words occuring in it. I also did it with War and Peace from Project Gutenberg and the unique words (with no loop). Here are the results (I did them multiple times with nearly identical outcome):\n\n```\nlorem ipsum\nvanilla: 13.530069\nmine:    13.193153\n\nwar and peace:\nvanilla: 12.775991\nmine:    12.835219\n```\n\nThere seems to be little to no effect. Any other result would have been a surprise I guess since this should be a pretty obvious optimization for any compiler.\n\nFor any non-optimality in code I apologize.\n\nEDIT:\n\nI did some more testing with some problably confusing results (each test 5 times):\n\n```\nlorem ipsum:\n    master          if_expr_str_rs\n    rustc --opt-level 0\n    13.690805       14.782988\n    13.465424       14.762841\n    13.556684       14.879488\n    13.493524       14.83802 \n    13.472988       14.884888\n    rustc --opt-level 1\n    13.422814       13.245645\n    13.265141       13.177819\n    13.171101       13.272089\n    13.205705       13.316087\n    13.24449        13.199521\n    rustc --opt-level 2\n    13.337737       14.572255\n    13.251353       14.641159\n    13.191408       14.652353\n    13.155202       14.615327\n    13.192265       14.707522\n    rustc --opt-level 3\n    13.372553       14.626931\n    13.290924       14.918047\n    13.288628       14.789471\n    13.228979       14.63678 \n    13.363937       14.625602\n\nwar and paece:\n    master             if_expr_str_rs\n    rustc --opt-level 0\n    12.955211       13.003933\n    12.997821       13.005721\n    12.810747       12.921784\n    12.913668       12.903045\n    13.078808       12.85325\n    rustc --opt-level 1\n    14.340488       13.060778\n    14.346076       12.909807\n    14.332367       12.947452\n    14.48084        13.192186\n    14.408455       12.966698\n    rustc --opt-level 2\n    14.372135       14.466737\n    14.561792       14.41009\n    14.470233       14.42181\n    14.704438       14.476918\n    14.381947       14.602977\n    rustc --opt-level 3\n    12.793627       14.258553\n    12.775934       14.330417\n    12.878962       14.251588\n    12.984928       14.378242\n    12.859788       14.303351\n```\n\nI really don't know why optimization results in worse runtime...\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/53629195/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/53748943",
    "html_url": "https://github.com/rust-lang/rust/pull/16743#issuecomment-53748943",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/16743",
    "id": 53748943,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUzNzQ4OTQz",
    "user": {
      "login": "tstorch",
      "id": 4622615,
      "node_id": "MDQ6VXNlcjQ2MjI2MTU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4622615?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/tstorch",
      "html_url": "https://github.com/tstorch",
      "followers_url": "https://api.github.com/users/tstorch/followers",
      "following_url": "https://api.github.com/users/tstorch/following{/other_user}",
      "gists_url": "https://api.github.com/users/tstorch/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/tstorch/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/tstorch/subscriptions",
      "organizations_url": "https://api.github.com/users/tstorch/orgs",
      "repos_url": "https://api.github.com/users/tstorch/repos",
      "events_url": "https://api.github.com/users/tstorch/events{/privacy}",
      "received_events_url": "https://api.github.com/users/tstorch/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-08-28T16:24:18Z",
    "updated_at": "2014-08-28T16:24:18Z",
    "body": "I did some more testing (won't bother you with details). The thing is, even though I had no load the results differed quit a bit. But i guess you could say, that they do not differ in speed, despite the previos post.\n\nI would be glad if anyone else could run some test...\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/53748943/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/54766303",
    "html_url": "https://github.com/rust-lang/rust/pull/16743#issuecomment-54766303",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/16743",
    "id": 54766303,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU0NzY2MzAz",
    "user": {
      "login": "alexcrichton",
      "id": 64996,
      "node_id": "MDQ6VXNlcjY0OTk2",
      "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alexcrichton",
      "html_url": "https://github.com/alexcrichton",
      "followers_url": "https://api.github.com/users/alexcrichton/followers",
      "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}",
      "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions",
      "organizations_url": "https://api.github.com/users/alexcrichton/orgs",
      "repos_url": "https://api.github.com/users/alexcrichton/repos",
      "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alexcrichton/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-09-08T00:22:52Z",
    "updated_at": "2014-09-08T00:22:52Z",
    "body": "Closing due to inactivity, but feel free to reopen with a rebase!\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/54766303/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
