[
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/168235356",
    "html_url": "https://github.com/rust-lang/rust/issues/17684#issuecomment-168235356",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/17684",
    "id": 168235356,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE2ODIzNTM1Ng==",
    "user": {
      "login": "steveklabnik",
      "id": 27786,
      "node_id": "MDQ6VXNlcjI3Nzg2",
      "avatar_url": "https://avatars.githubusercontent.com/u/27786?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/steveklabnik",
      "html_url": "https://github.com/steveklabnik",
      "followers_url": "https://api.github.com/users/steveklabnik/followers",
      "following_url": "https://api.github.com/users/steveklabnik/following{/other_user}",
      "gists_url": "https://api.github.com/users/steveklabnik/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/steveklabnik/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/steveklabnik/subscriptions",
      "organizations_url": "https://api.github.com/users/steveklabnik/orgs",
      "repos_url": "https://api.github.com/users/steveklabnik/repos",
      "events_url": "https://api.github.com/users/steveklabnik/events{/privacy}",
      "received_events_url": "https://api.github.com/users/steveklabnik/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-12-31T19:02:28Z",
    "updated_at": "2015-12-31T19:02:28Z",
    "body": "Triage: I am not sure if there has been any change, nor steps to reproduce.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/168235356/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/180632824",
    "html_url": "https://github.com/rust-lang/rust/issues/17684#issuecomment-180632824",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/17684",
    "id": 180632824,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE4MDYzMjgyNA==",
    "user": {
      "login": "brson",
      "id": 147214,
      "node_id": "MDQ6VXNlcjE0NzIxNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/brson",
      "html_url": "https://github.com/brson",
      "followers_url": "https://api.github.com/users/brson/followers",
      "following_url": "https://api.github.com/users/brson/following{/other_user}",
      "gists_url": "https://api.github.com/users/brson/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/brson/subscriptions",
      "organizations_url": "https://api.github.com/users/brson/orgs",
      "repos_url": "https://api.github.com/users/brson/repos",
      "events_url": "https://api.github.com/users/brson/events{/privacy}",
      "received_events_url": "https://api.github.com/users/brson/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2016-02-06T00:21:45Z",
    "updated_at": "2016-02-06T00:21:45Z",
    "body": "If this was a mingw-specific bug, we may be able to reactivate it on the msvc builds.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/180632824/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/180642124",
    "html_url": "https://github.com/rust-lang/rust/issues/17684#issuecomment-180642124",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/17684",
    "id": 180642124,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE4MDY0MjEyNA==",
    "user": {
      "login": "retep998",
      "id": 666308,
      "node_id": "MDQ6VXNlcjY2NjMwOA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/666308?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/retep998",
      "html_url": "https://github.com/retep998",
      "followers_url": "https://api.github.com/users/retep998/followers",
      "following_url": "https://api.github.com/users/retep998/following{/other_user}",
      "gists_url": "https://api.github.com/users/retep998/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/retep998/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/retep998/subscriptions",
      "organizations_url": "https://api.github.com/users/retep998/orgs",
      "repos_url": "https://api.github.com/users/retep998/repos",
      "events_url": "https://api.github.com/users/retep998/events{/privacy}",
      "received_events_url": "https://api.github.com/users/retep998/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2016-02-06T01:00:11Z",
    "updated_at": "2016-02-06T01:00:11Z",
    "body": "According to [MSDN](https://msdn.microsoft.com/en-us/library/bb384887.aspx) `By default, /DYNAMICBASE is on.` so we've already been effectively using ASLR with `-msvc` targets.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/180642124/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/299608659",
    "html_url": "https://github.com/rust-lang/rust/issues/17684#issuecomment-299608659",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/17684",
    "id": 299608659,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI5OTYwODY1OQ==",
    "user": {
      "login": "Mark-Simulacrum",
      "id": 5047365,
      "node_id": "MDQ6VXNlcjUwNDczNjU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5047365?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Mark-Simulacrum",
      "html_url": "https://github.com/Mark-Simulacrum",
      "followers_url": "https://api.github.com/users/Mark-Simulacrum/followers",
      "following_url": "https://api.github.com/users/Mark-Simulacrum/following{/other_user}",
      "gists_url": "https://api.github.com/users/Mark-Simulacrum/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Mark-Simulacrum/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Mark-Simulacrum/subscriptions",
      "organizations_url": "https://api.github.com/users/Mark-Simulacrum/orgs",
      "repos_url": "https://api.github.com/users/Mark-Simulacrum/repos",
      "events_url": "https://api.github.com/users/Mark-Simulacrum/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Mark-Simulacrum/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2017-05-06T01:56:53Z",
    "updated_at": "2017-05-06T01:56:53Z",
    "body": "Can someone comment on whether thread locals are broken on Windows MinGW-w64 today? What are the reproduction steps?",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/299608659/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/333512341",
    "html_url": "https://github.com/rust-lang/rust/issues/17684#issuecomment-333512341",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/17684",
    "id": 333512341,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMzMzUxMjM0MQ==",
    "user": {
      "login": "sipsorcery",
      "id": 197660,
      "node_id": "MDQ6VXNlcjE5NzY2MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/197660?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sipsorcery",
      "html_url": "https://github.com/sipsorcery",
      "followers_url": "https://api.github.com/users/sipsorcery/followers",
      "following_url": "https://api.github.com/users/sipsorcery/following{/other_user}",
      "gists_url": "https://api.github.com/users/sipsorcery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sipsorcery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sipsorcery/subscriptions",
      "organizations_url": "https://api.github.com/users/sipsorcery/orgs",
      "repos_url": "https://api.github.com/users/sipsorcery/repos",
      "events_url": "https://api.github.com/users/sipsorcery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sipsorcery/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2017-10-02T11:52:03Z",
    "updated_at": "2017-10-02T11:52:54Z",
    "body": "I've done a cursory check of TLS with 64 bit binaries compiled with msvc and mingw32-g++ and both are working correctly.\r\n\r\n```c++\r\n// http://en.cppreference.com/w/cpp/language/storage_duration\r\n// msvc on win64: cl tls.cpp /link\r\n// mingw on linux64: x86_64-w64-mingw32-g++ tls.cpp -static -static-libstdc++\r\n\r\n#include <iostream>\r\n#include <string>\r\n#include <thread>\r\n#include <mutex>\r\n\r\nthread_local unsigned int rage = 1;\r\nstd::mutex cout_mutex;\r\n\r\nvoid increase_rage(const std::string& thread_name)\r\n{\r\n\t++rage; // modifying outside a lock is okay; this is a thread-local variable\r\n\tstd::lock_guard<std::mutex> lock(cout_mutex);\r\n\tstd::cout << \"Rage counter for \" << thread_name << \": \" << rage << '\\n';\r\n}\r\n\r\nint main()\r\n{\r\n\tstd::thread a(increase_rage, \"a\"), b(increase_rage, \"b\");\r\n\r\n\t{\r\n\t\tstd::lock_guard<std::mutex> lock(cout_mutex);\r\n\t\tstd::cout << \"Rage counter for main: \" << rage << '\\n';\r\n\t}\r\n\r\n\ta.join();\r\n\tb.join();\r\n\r\n\tgetchar();\r\n}\r\n```\r\n\r\nmsvc output:\r\n\r\n> f:\\Temp>tls\r\nRage counter for a: 2\r\nRage counter for b: 2\r\nRage counter for main: 1\r\n\r\nmingw32-g++ output:\r\n\r\n> f:\\Temp>tls_mingw.exe\r\nRage counter for main: 1\r\nRage counter for a: 2\r\nRage counter for b: 2\r\n\r\n64 bit binaries on Windows use ASLR by default unless explicitly disabled with a linker option. Both binaries in this test had the NX Compatible flag set in the executable image header.\r\n\r\nHappy to test further if anyone has a pointer to the problem code.",
    "author_association": "NONE",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/333512341/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/333569846",
    "html_url": "https://github.com/rust-lang/rust/issues/17684#issuecomment-333569846",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/17684",
    "id": 333569846,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMzMzU2OTg0Ng==",
    "user": {
      "login": "retep998",
      "id": 666308,
      "node_id": "MDQ6VXNlcjY2NjMwOA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/666308?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/retep998",
      "html_url": "https://github.com/retep998",
      "followers_url": "https://api.github.com/users/retep998/followers",
      "following_url": "https://api.github.com/users/retep998/following{/other_user}",
      "gists_url": "https://api.github.com/users/retep998/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/retep998/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/retep998/subscriptions",
      "organizations_url": "https://api.github.com/users/retep998/orgs",
      "repos_url": "https://api.github.com/users/retep998/repos",
      "events_url": "https://api.github.com/users/retep998/events{/privacy}",
      "received_events_url": "https://api.github.com/users/retep998/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2017-10-02T15:27:59Z",
    "updated_at": "2017-10-02T15:27:59Z",
    "body": "@sipsorcery The key thing is `#[thread_local]` statics in *Rust*. The NX compatible bit does not indicate ASLR, rather it needs to have the Dynamic base bit.",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/333569846/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/671957243",
    "html_url": "https://github.com/rust-lang/rust/issues/17684#issuecomment-671957243",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/17684",
    "id": 671957243,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY3MTk1NzI0Mw==",
    "user": {
      "login": "mati865",
      "id": 1174646,
      "node_id": "MDQ6VXNlcjExNzQ2NDY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1174646?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mati865",
      "html_url": "https://github.com/mati865",
      "followers_url": "https://api.github.com/users/mati865/followers",
      "following_url": "https://api.github.com/users/mati865/following{/other_user}",
      "gists_url": "https://api.github.com/users/mati865/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mati865/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mati865/subscriptions",
      "organizations_url": "https://api.github.com/users/mati865/orgs",
      "repos_url": "https://api.github.com/users/mati865/repos",
      "events_url": "https://api.github.com/users/mati865/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mati865/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2020-08-11T13:47:14Z",
    "updated_at": "2020-08-11T13:47:23Z",
    "body": "Does anybody have reproducer?\r\n[Example from the docs](https://play.rust-lang.org/?code=%23!%5Ballow(unused)%5D%0Afn%20main()%20%7B%0Ause%20std%3A%3Acell%3A%3ARefCell%3B%0Ause%20std%3A%3Athread%3B%0A%0Athread_local!(static%20FOO%3A%20RefCell%3Cu32%3E%20%3D%20RefCell%3A%3Anew(1))%3B%0A%0AFOO.with(%7Cf%7C%20%7B%0A%20%20%20%20assert_eq!(*f.borrow()%2C%201)%3B%0A%20%20%20%20*f.borrow_mut()%20%3D%202%3B%0A%7D)%3B%0A%0A%2F%2F%20each%20thread%20starts%20out%20with%20the%20initial%20value%20of%201%0Alet%20t%20%3D%20thread%3A%3Aspawn(move%7C%7C%20%7B%0A%20%20%20%20FOO.with(%7Cf%7C%20%7B%0A%20%20%20%20%20%20%20%20assert_eq!(*f.borrow()%2C%201)%3B%0A%20%20%20%20%20%20%20%20*f.borrow_mut()%20%3D%203%3B%0A%20%20%20%20%7D)%3B%0A%7D)%3B%0A%0A%2F%2F%20wait%20for%20the%20thread%20to%20complete%20and%20bail%20out%20on%20panic%0At.join().unwrap()%3B%0A%0A%2F%2F%20we%20retain%20our%20original%20value%20of%202%20despite%20the%20child%20thread%0AFOO.with(%7Cf%7C%20%7B%0A%20%20%20%20assert_eq!(*f.borrow()%2C%202)%3B%0A%7D)%3B%0A%7D&edition=2018) still works for me after enabling ASLR.",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/671957243/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
