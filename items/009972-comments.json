[
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/26667566",
    "html_url": "https://github.com/rust-lang/rust/pull/9972#issuecomment-26667566",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/9972",
    "id": 26667566,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI2NjY3NTY2",
    "user": {
      "login": "thestinger",
      "id": 1505226,
      "node_id": "MDQ6VXNlcjE1MDUyMjY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1505226?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/thestinger",
      "html_url": "https://github.com/thestinger",
      "followers_url": "https://api.github.com/users/thestinger/followers",
      "following_url": "https://api.github.com/users/thestinger/following{/other_user}",
      "gists_url": "https://api.github.com/users/thestinger/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/thestinger/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/thestinger/subscriptions",
      "organizations_url": "https://api.github.com/users/thestinger/orgs",
      "repos_url": "https://api.github.com/users/thestinger/repos",
      "events_url": "https://api.github.com/users/thestinger/events{/privacy}",
      "received_events_url": "https://api.github.com/users/thestinger/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2013-10-20T07:48:23Z",
    "updated_at": "2013-10-20T07:48:23Z",
    "body": "I'm not convinced we should expose convenience functions for this. The usage in `rand` could be replacing by integer manipulation, and it would optimize down to the same code. In most cases, this pattern doesn't work because the data isn't equally distributed entropy where endianness doesn't matter.\n\nIn C and C++, casts like this are undefined behaviour because they break the type punning rules implemented to enable type-based alias analysis\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/26667566/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/26667596",
    "html_url": "https://github.com/rust-lang/rust/pull/9972#issuecomment-26667596",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/9972",
    "id": 26667596,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI2NjY3NTk2",
    "user": {
      "login": "lilyball",
      "id": 714,
      "node_id": "MDQ6VXNlcjcxNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/714?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/lilyball",
      "html_url": "https://github.com/lilyball",
      "followers_url": "https://api.github.com/users/lilyball/followers",
      "following_url": "https://api.github.com/users/lilyball/following{/other_user}",
      "gists_url": "https://api.github.com/users/lilyball/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/lilyball/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/lilyball/subscriptions",
      "organizations_url": "https://api.github.com/users/lilyball/orgs",
      "repos_url": "https://api.github.com/users/lilyball/repos",
      "events_url": "https://api.github.com/users/lilyball/events{/privacy}",
      "received_events_url": "https://api.github.com/users/lilyball/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2013-10-20T07:50:55Z",
    "updated_at": "2013-10-20T07:50:55Z",
    "body": "@thestinger The problem with _not_ exposing this is people will try it using `transmute()`, and it will fail horribly (and they may not even realize, e.g. the `rand:isaac` seed was broken without anyone noticing). No, it's not something people should be doing often, but then again, neither is transmuting in general. As long as we give people the tools to shoot themselves in the foot, we should try to help them avoid some of the more obvious blunders.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/26667596/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/26685968",
    "html_url": "https://github.com/rust-lang/rust/pull/9972#issuecomment-26685968",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/9972",
    "id": 26685968,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI2Njg1OTY4",
    "user": {
      "login": "lilyball",
      "id": 714,
      "node_id": "MDQ6VXNlcjcxNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/714?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/lilyball",
      "html_url": "https://github.com/lilyball",
      "followers_url": "https://api.github.com/users/lilyball/followers",
      "following_url": "https://api.github.com/users/lilyball/following{/other_user}",
      "gists_url": "https://api.github.com/users/lilyball/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/lilyball/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/lilyball/subscriptions",
      "organizations_url": "https://api.github.com/users/lilyball/orgs",
      "repos_url": "https://api.github.com/users/lilyball/repos",
      "events_url": "https://api.github.com/users/lilyball/events{/privacy}",
      "received_events_url": "https://api.github.com/users/lilyball/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2013-10-20T23:34:50Z",
    "updated_at": "2013-10-20T23:34:50Z",
    "body": "After talking with @thestinger, I get the impression that his primary objection is that TBAA makes most casts like this into undefined behavior (which is why C makes it undefined). Although technically it's only accessing the resulting object type through the pointer that's undefined, and not the cast itself (at least in C).\n\nMy response is twofold:\n1. If we don't provide this functionality, anyone who wants to coerce slices of one type to slices of another will find a way to do so regardless. Whether it's using the `Slice` repr, or converting to `*T` and then coercing that, or some other way, they will do it. This is dangerous and hard to catch errors in, as we've already seen by the fact that `rand:isaac` did this.\n2. Providing this functionality does not preclude introducing TBAA later. It just means that we have to restrict the ability to transmute slices once TBAA is introduced. This could potentially be done by introducing some form of compiler-provided trait `CompatibleType<A,B>` that is implemented for all compatible types A and B, thus allowing transmuting of slices only between compatible types, just as one example.\n\nI'm also willing to restrict this to something like `unsafe fn transmute_slice_to_u8<'a,T>(thing: &'a [V]) -> &'a [u8]` (which is expressly allowed by C), as that's really the only cast that I explicitly need (this is the cast that rand uses as well). But that reintroduces my worry that anyone who needs a different coercion will simply do so in a way that is error-prone and may break later.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/26685968/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/26778551",
    "html_url": "https://github.com/rust-lang/rust/pull/9972#issuecomment-26778551",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/9972",
    "id": 26778551,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI2Nzc4NTUx",
    "user": {
      "login": "lilyball",
      "id": 714,
      "node_id": "MDQ6VXNlcjcxNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/714?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/lilyball",
      "html_url": "https://github.com/lilyball",
      "followers_url": "https://api.github.com/users/lilyball/followers",
      "following_url": "https://api.github.com/users/lilyball/following{/other_user}",
      "gists_url": "https://api.github.com/users/lilyball/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/lilyball/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/lilyball/subscriptions",
      "organizations_url": "https://api.github.com/users/lilyball/orgs",
      "repos_url": "https://api.github.com/users/lilyball/repos",
      "events_url": "https://api.github.com/users/lilyball/events{/privacy}",
      "received_events_url": "https://api.github.com/users/lilyball/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2013-10-22T05:42:58Z",
    "updated_at": "2013-10-22T05:42:58Z",
    "body": "Upon further reflection, `transmute_slice_to_u8()` is not sufficient, because `OSRng.fill_bytes()` needs to cast back in reverse, from a `&[u8]` to a `&[u64]` and `&[u32]`.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/26778551/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/26797470",
    "html_url": "https://github.com/rust-lang/rust/pull/9972#issuecomment-26797470",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/9972",
    "id": 26797470,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI2Nzk3NDcw",
    "user": {
      "login": "huonw",
      "id": 1203825,
      "node_id": "MDQ6VXNlcjEyMDM4MjU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1203825?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/huonw",
      "html_url": "https://github.com/huonw",
      "followers_url": "https://api.github.com/users/huonw/followers",
      "following_url": "https://api.github.com/users/huonw/following{/other_user}",
      "gists_url": "https://api.github.com/users/huonw/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/huonw/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/huonw/subscriptions",
      "organizations_url": "https://api.github.com/users/huonw/orgs",
      "repos_url": "https://api.github.com/users/huonw/repos",
      "events_url": "https://api.github.com/users/huonw/events{/privacy}",
      "received_events_url": "https://api.github.com/users/huonw/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2013-10-22T12:12:24Z",
    "updated_at": "2013-10-22T12:12:24Z",
    "body": "FWIW, I've replaced the default implementation of `fill_bytes` with something that doesn't do the `[u8]` &rarr; `[u64]` and `[u32]` casts in #10015, since they seem to be very unsafe; and those casts there entirely ignored any alignment concerns. Also, I've replaced the ISAAC seeding with `vec::raw::{to_mut_ptr, mut_buf_as_slice}`, which should avoid any problems with `transmute` making things unhappy.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/26797470/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/26831180",
    "html_url": "https://github.com/rust-lang/rust/pull/9972#issuecomment-26831180",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/9972",
    "id": 26831180,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI2ODMxMTgw",
    "user": {
      "login": "lilyball",
      "id": 714,
      "node_id": "MDQ6VXNlcjcxNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/714?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/lilyball",
      "html_url": "https://github.com/lilyball",
      "followers_url": "https://api.github.com/users/lilyball/followers",
      "following_url": "https://api.github.com/users/lilyball/following{/other_user}",
      "gists_url": "https://api.github.com/users/lilyball/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/lilyball/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/lilyball/subscriptions",
      "organizations_url": "https://api.github.com/users/lilyball/orgs",
      "repos_url": "https://api.github.com/users/lilyball/repos",
      "events_url": "https://api.github.com/users/lilyball/events{/privacy}",
      "received_events_url": "https://api.github.com/users/lilyball/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2013-10-22T18:56:14Z",
    "updated_at": "2013-10-22T18:56:14Z",
    "body": "I'm going to close this out in favor of #10015. I think we should have an official way of coercing a slice to `&[u8]`, but it's not worth trying to get consensus on this right now.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/26831180/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
