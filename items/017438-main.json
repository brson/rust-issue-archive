{
  "url": "https://api.github.com/repos/rust-lang/rust/issues/17438",
  "repository_url": "https://api.github.com/repos/rust-lang/rust",
  "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/17438/labels{/name}",
  "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/17438/comments",
  "events_url": "https://api.github.com/repos/rust-lang/rust/issues/17438/events",
  "html_url": "https://github.com/rust-lang/rust/pull/17438",
  "id": 43507660,
  "node_id": "MDExOlB1bGxSZXF1ZXN0MjE1ODkzODM=",
  "number": 17438,
  "title": "collections: Stabilize String",
  "user": {
    "login": "alexcrichton",
    "id": 64996,
    "node_id": "MDQ6VXNlcjY0OTk2",
    "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/alexcrichton",
    "html_url": "https://github.com/alexcrichton",
    "followers_url": "https://api.github.com/users/alexcrichton/followers",
    "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}",
    "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions",
    "organizations_url": "https://api.github.com/users/alexcrichton/orgs",
    "repos_url": "https://api.github.com/users/alexcrichton/repos",
    "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}",
    "received_events_url": "https://api.github.com/users/alexcrichton/received_events",
    "type": "User",
    "user_view_type": "public",
    "site_admin": false
  },
  "labels": [],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [],
  "milestone": null,
  "comments": 4,
  "created_at": "2014-09-22T15:59:13Z",
  "updated_at": "2014-10-11T21:40:17Z",
  "closed_at": "2014-09-24T15:40:52Z",
  "author_association": "MEMBER",
  "type": null,
  "active_lock_reason": null,
  "draft": false,
  "pull_request": {
    "url": "https://api.github.com/repos/rust-lang/rust/pulls/17438",
    "html_url": "https://github.com/rust-lang/rust/pull/17438",
    "diff_url": "https://github.com/rust-lang/rust/pull/17438.diff",
    "patch_url": "https://github.com/rust-lang/rust/pull/17438.patch",
    "merged_at": "2014-09-24T15:40:59Z"
  },
  "body": "# Rationale\n\nWhen dealing with strings, many functions deal with either a `char` (unicode\ncodepoint) or a byte (utf-8 encoding related). There is often an inconsistent\nway in which methods are referred to as to whether they contain \"byte\", \"char\",\nor nothing in their name.  There are also issues open to rename _all_ methods to\nreflect that they operate on utf8 encodings or bytes (e.g. utf8_len() or\nbyte_len()).\n\nThe current state of String seems to largely be what is desired, so this PR\nproposes the following rationale for methods dealing with bytes or characters:\n\n> When constructing a string, the input encoding _must_ be mentioned (e.g.\n> from_utf8). This makes it clear what exactly the input type is expected to be\n> in terms of encoding.\n> \n> When a method operates on anything related to an _index_ within the string\n> such as length, capacity, position, etc, the method _implicitly_ operates on\n> bytes. It is an understood fact that String is a utf-8 encoded string, and\n> burdening all methods with \"bytes\" would be redundant.\n> \n> When a method operates on the _contents_ of a string, such as push() or pop(),\n> then \"char\" is the default type. A String can loosely be thought of as being a\n> collection of unicode codepoints, but not all collection-related operations\n> make sense because some can be woefully inefficient.\n# Method stabilization\n\nThe following methods have been marked #[stable]\n- The String type itself\n- String::new\n- String::with_capacity\n- String::from_utf16_lossy\n- String::into_bytes\n- String::as_bytes\n- String::len\n- String::clear\n- String::as_slice\n\nThe following methods have been marked #[unstable]\n- String::from_utf8 - The error type in the returned `Result` may change to\n                    provide a nicer message when it's `unwrap()`'d\n- String::from_utf8_lossy - The returned `MaybeOwned` type still needs\n                          stabilization\n- String::from_utf16 - The return type may change to become a `Result` which\n                     includes more contextual information like where the error\n                     occurred.\n- String::from_chars - This is equivalent to iter().collect(), but currently not\n                     as ergonomic.\n- String::from_char - This method is the equivalent of Vec::from_elem, and has\n                    been marked #[unstable] becuase it can be seen as a\n                    duplicate of iterator-based functionality as well as\n                    possibly being renamed.\n- String::push_str - This _can_ be emulated with .extend(foo.chars()), but is\n                   less efficient because of decoding/encoding. Due to the\n                   desire to minimize API surface this may be able to be\n                   removed in the future for something possibly generic with\n                   no loss in performance.\n- String::grow - This is a duplicate of iterator-based functionality, which may\n               become more ergonomic in the future.\n- String::capacity - This function was just added.\n- String::push - This function was just added.\n- String::pop - This function was just added.\n- String::truncate - The failure conventions around String methods and byte\n                   indices isn't totally clear at this time, so the failure\n                   semantics and return value of this method are subject to\n                   change.\n- String::as_mut_vec - the naming of this method may change.\n- string::raw::\\* - these functions are all waiting on [an RFC](rust-lang/rfcs#240)\n\nThe following method have been marked #[experimental]\n- String::from_str - This function only exists as it's more efficient than\n                   to_string(), but having a less ergonomic function for\n                   performance reasons isn't the greatest reason to keep it\n                   around. Like Vec::push_all, this has been marked\n                   experimental for now.\n\nThe following methods have been #[deprecated]\n- String::append - This method has been deprecated to remain consistent with the\n                 deprecation of Vec::append. While convenient, it is one of\n                 the only functional-style apis on String, and requires more\n                 though as to whether it belongs as a first-class method or\n                 now (and how it relates to other collections).\n- String::from_byte - This is fairly rare functionality and can be emulated with\n                    str::from_utf8 plus an assert plus a call to to_string().\n                    Additionally, String::from_char could possibly be used.\n- String::byte_capacity - Renamed to String::capacity due to the rationale\n                        above.\n- String::push_char - Renamed to String::push due to the rationale above.\n- String::pop_char - Renamed to String::pop due to the rationale above.\n- String::push_bytes - There are a number of `unsafe` functions on the `String`\n                     type which allow bypassing utf-8 checks. These have all\n                     been deprecated in favor of calling `.as_mut_vec()` and\n                     then operating directly on the vector returned. These\n                     methods were deprecated because naming them with relation\n                     to other methods was difficult to rationalize and it's\n                     arguably more composable to call .as_mut_vec().\n- String::as_mut_bytes - See push_bytes\n- String::push_byte - See push_bytes\n- String::pop_byte - See push_bytes\n- String::shift_byte - See push_bytes\n# Reservation methods\n\nThis commit does not yet touch the methods for reserving bytes. The methods on\nVec have also not yet been modified. These methods are discussed in the upcoming\n[Collections reform RFC](https://github.com/aturon/rfcs/blob/collections-conventions/active/0000-collections-conventions.md#implicit-growth)\n",
  "closed_by": {
    "login": "bors",
    "id": 3372342,
    "node_id": "MDQ6VXNlcjMzNzIzNDI=",
    "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/bors",
    "html_url": "https://github.com/bors",
    "followers_url": "https://api.github.com/users/bors/followers",
    "following_url": "https://api.github.com/users/bors/following{/other_user}",
    "gists_url": "https://api.github.com/users/bors/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/bors/subscriptions",
    "organizations_url": "https://api.github.com/users/bors/orgs",
    "repos_url": "https://api.github.com/users/bors/repos",
    "events_url": "https://api.github.com/users/bors/events{/privacy}",
    "received_events_url": "https://api.github.com/users/bors/received_events",
    "type": "User",
    "user_view_type": "public",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/17438/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/17438/timeline",
  "performed_via_github_app": null,
  "state_reason": null,
  "_meta": {
    "type": "pr"
  }
}
