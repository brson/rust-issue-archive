[
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/51739157",
    "html_url": "https://github.com/rust-lang/rust/issues/16403#issuecomment-51739157",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/16403",
    "id": 51739157,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUxNzM5MTU3",
    "user": {
      "login": "alexcrichton",
      "id": 64996,
      "node_id": "MDQ6VXNlcjY0OTk2",
      "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alexcrichton",
      "html_url": "https://github.com/alexcrichton",
      "followers_url": "https://api.github.com/users/alexcrichton/followers",
      "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}",
      "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions",
      "organizations_url": "https://api.github.com/users/alexcrichton/orgs",
      "repos_url": "https://api.github.com/users/alexcrichton/repos",
      "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alexcrichton/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-08-11T03:33:12Z",
    "updated_at": "2014-08-11T03:33:12Z",
    "body": "Closing as a dupe of #10883, but thanks for the report!\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/51739157/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/51740461",
    "html_url": "https://github.com/rust-lang/rust/issues/16403#issuecomment-51740461",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/16403",
    "id": 51740461,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUxNzQwNDYx",
    "user": {
      "login": "SSheldon",
      "id": 478311,
      "node_id": "MDQ6VXNlcjQ3ODMxMQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/478311?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/SSheldon",
      "html_url": "https://github.com/SSheldon",
      "followers_url": "https://api.github.com/users/SSheldon/followers",
      "following_url": "https://api.github.com/users/SSheldon/following{/other_user}",
      "gists_url": "https://api.github.com/users/SSheldon/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/SSheldon/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/SSheldon/subscriptions",
      "organizations_url": "https://api.github.com/users/SSheldon/orgs",
      "repos_url": "https://api.github.com/users/SSheldon/repos",
      "events_url": "https://api.github.com/users/SSheldon/events{/privacy}",
      "received_events_url": "https://api.github.com/users/SSheldon/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-08-11T04:09:48Z",
    "updated_at": "2014-08-11T04:12:51Z",
    "body": "@alexcrichton, in #10883 it's claimed that this error can only happen with `#[no_mangle]` and `#[link_name = ...]`, neither of which are used here.\n\nAlso, any suggestions for a workaround here? I'm not trying to link against my extern function, I just want to provide a pointer to it, so it'd be fine if its name gets mangled. This is inside of a macro, so having a unique name for the function every time the macro is used seems a little tricky.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/51740461/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/51740555",
    "html_url": "https://github.com/rust-lang/rust/issues/16403#issuecomment-51740555",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/16403",
    "id": 51740555,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUxNzQwNTU1",
    "user": {
      "login": "alexcrichton",
      "id": 64996,
      "node_id": "MDQ6VXNlcjY0OTk2",
      "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alexcrichton",
      "html_url": "https://github.com/alexcrichton",
      "followers_url": "https://api.github.com/users/alexcrichton/followers",
      "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}",
      "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions",
      "organizations_url": "https://api.github.com/users/alexcrichton/orgs",
      "repos_url": "https://api.github.com/users/alexcrichton/repos",
      "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alexcrichton/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-08-11T04:12:49Z",
    "updated_at": "2014-08-11T04:12:49Z",
    "body": "It's the same idea where the same symbol has two different types from LLVM's point of view, this just has a different trigger (but same underlying cause).\n\nCurrently the only workaround is for the symbol to have the same type each time it's declared.\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/51740555/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/66864518",
    "html_url": "https://github.com/rust-lang/rust/issues/16403#issuecomment-66864518",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/16403",
    "id": 66864518,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY2ODY0NTE4",
    "user": {
      "login": "huonw",
      "id": 1203825,
      "node_id": "MDQ6VXNlcjEyMDM4MjU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1203825?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/huonw",
      "html_url": "https://github.com/huonw",
      "followers_url": "https://api.github.com/users/huonw/followers",
      "following_url": "https://api.github.com/users/huonw/following{/other_user}",
      "gists_url": "https://api.github.com/users/huonw/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/huonw/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/huonw/subscriptions",
      "organizations_url": "https://api.github.com/users/huonw/orgs",
      "repos_url": "https://api.github.com/users/huonw/repos",
      "events_url": "https://api.github.com/users/huonw/events{/privacy}",
      "received_events_url": "https://api.github.com/users/huonw/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-12-13T04:17:03Z",
    "updated_at": "2014-12-13T04:28:19Z",
    "body": "I think this is a legitimately different error to #10883, since I believe the problem is we currently do other APIs by creating little wrappers that call to a function that has the Rust ABI. However, we currently don't make any effort to ensure that the name of that Rust ABI function pays attention to scoping. This is different to #10883 since it occurs simply by writing `extern fn` instead of `fn` (which, in a perfect world, would not affect symbol names), whereas that issue is caused by an explicit user action related to symbol names.\n\nIn any case, the fix is certainly different: this code should be able to compile, since the equivalent with `fn` instead of `extern fn` does.\n\nAs an example of this, consider\n\n``` rust\nfn main() {\n    { extern fn foo() {} }\n}\n```\n\n``` llvm\ntarget datalayout = \"e-i64:64-f80:128-n8:16:32:64-S128\"\ntarget triple = \"x86_64-unknown-linux-gnu\"\n\n; Function Attrs: uwtable\ndefine internal void @_ZN4main20h1c12588f54a45a2feaaE() unnamed_addr #0 {\nentry-block:\n  ret void\n}\n\ndefine i64 @main(i64, i8**) unnamed_addr #1 {\ntop:\n  %2 = call i64 @_ZN2rt10lang_start20h09857311e158dc649GyE(i8* bitcast (void ()* @_ZN4main20h1c12588f54a45a2feaaE to i8*), i64 %0, i8** %1)\n  ret i64 %2\n}\n\ndeclare i64 @_ZN2rt10lang_start20h09857311e158dc649GyE(i8*, i64, i8**) unnamed_addr #1\n\ndefine internal void @_ZN4main3foo20h2bc621e3a5534caalaaE() unnamed_addr #1 {\n\"the block\":\n  call void @_ZN4main3foo10__rust_abiE()\n  ret void\n}\n\n; Function Attrs: uwtable\ndefine internal void @_ZN4main3foo10__rust_abiE() unnamed_addr #0 {\nentry-block:\n  ret void\n}\n\nattributes #0 = { uwtable \"split-stack\" }\nattributes #1 = { \"split-stack\" }\n```\n\nThe `_ZN4main3foo10__rust_abiE` is the function with the Rust ABI, and it is the same for all `extern fn foo`s defined in `main`, which causes the problem. The symbol name should have a hash like other function symbols (preferably that `__rust_abi` function wouldn't exist at all... but that may be a little harder to solve).\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/66864518/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/92383805",
    "html_url": "https://github.com/rust-lang/rust/issues/16403#issuecomment-92383805",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/16403",
    "id": 92383805,
    "node_id": "MDEyOklzc3VlQ29tbWVudDkyMzgzODA1",
    "user": {
      "login": "nagisa",
      "id": 679122,
      "node_id": "MDQ6VXNlcjY3OTEyMg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/679122?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nagisa",
      "html_url": "https://github.com/nagisa",
      "followers_url": "https://api.github.com/users/nagisa/followers",
      "following_url": "https://api.github.com/users/nagisa/following{/other_user}",
      "gists_url": "https://api.github.com/users/nagisa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nagisa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nagisa/subscriptions",
      "organizations_url": "https://api.github.com/users/nagisa/orgs",
      "repos_url": "https://api.github.com/users/nagisa/repos",
      "events_url": "https://api.github.com/users/nagisa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nagisa/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-04-13T14:36:47Z",
    "updated_at": "2015-04-13T14:36:47Z",
    "body": "This now fails with \n\n```\nerror: internal compiler error: symbol `_ZN4main3foo10__rust_abiE` already defined\nnote: the compiler unexpectedly panicked. this is a bug.\nnote: we would appreciate a bug report: https://github.com/rust-lang/rust/blob/master/CONTRIBUTING.md#bug-reports\nnote: run with `RUST_BACKTRACE=1` for a backtrace\nthread 'rustc' panicked at 'Box<Any>', /home/rustbuild/src/rust-buildbot/slave/nightly-dist-rustc-linux/build/src/libsyntax/diagnostic.rs:209\n\nstack backtrace:\n   1:     0x7fa5345c8bb9 - sys::backtrace::write::he1173a406c2335a83JC\n   2:     0x7fa5345ed4b7 - panicking::on_panic::hfd4f10113591c07f9aJ\n   3:     0x7fa534537322 - rt::unwind::begin_unwind_inner::h5dd2f870d997f851hQI\n   4:     0x7fa531aef8ad - rt::unwind::begin_unwind::h11948444363592342521\n   5:     0x7fa531aeff6b - diagnostic::Handler::bug::h8b610b99ced770c3AtB\n   6:     0x7fa5324cae6b - session::Session::bug::h9b57e3cf31a5ccf02Sq\n   7:     0x7fa533c977df - trans::foreign::trans_rust_fn_with_foreign_abi::h5b35927ae8d3ccbae1D\n   8:     0x7fa533c912b6 - trans::base::trans_item::h5f366b9cf5915577Yci\n   9:     0x7fa533c97f85 - visit::walk_block::h6053193963480568458\n  10:     0x7fa533c91ae4 - trans::base::trans_item::h5f366b9cf5915577Yci\n  11:     0x7fa533c9fadd - trans::base::trans_crate::h4d51da86e796d34d31i\n  12:     0x7fa534c410fa - driver::phase_4_translate_to_llvm::hb8e4f02386630e0djOa\n  13:     0x7fa534c18f4a - driver::compile_input::h7fb56cda9a0f227dQba\n  14:     0x7fa534cd7711 - run_compiler::hbdd9b2c4cacce291L4b\n  15:     0x7fa534cd5362 - boxed::F.FnBox<A>::call_box::h9433597520612747\n  16:     0x7fa534cd4899 - rt::unwind::try::try_fn::h10263588931191114294\n  17:     0x7fa534663348 - rust_try_inner\n  18:     0x7fa534663335 - rust_try\n  19:     0x7fa534cd4b48 - boxed::F.FnBox<A>::call_box::h17081069488870149893\n  20:     0x7fa5345dae41 - sys::thread::create::thread_start::hb84d91b7ff5c0ddcrLH\n  21:     0x7fa52e5d8373 - start_thread\n  22:     0x7fa5341b127c - __clone\n  23:                0x0 - <unknown>\n```\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/92383805/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/144882063",
    "html_url": "https://github.com/rust-lang/rust/issues/16403#issuecomment-144882063",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/16403",
    "id": 144882063,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE0NDg4MjA2Mw==",
    "user": {
      "login": "jethrogb",
      "id": 1132307,
      "node_id": "MDQ6VXNlcjExMzIzMDc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1132307?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jethrogb",
      "html_url": "https://github.com/jethrogb",
      "followers_url": "https://api.github.com/users/jethrogb/followers",
      "following_url": "https://api.github.com/users/jethrogb/following{/other_user}",
      "gists_url": "https://api.github.com/users/jethrogb/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jethrogb/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jethrogb/subscriptions",
      "organizations_url": "https://api.github.com/users/jethrogb/orgs",
      "repos_url": "https://api.github.com/users/jethrogb/repos",
      "events_url": "https://api.github.com/users/jethrogb/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jethrogb/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-10-02T00:11:37Z",
    "updated_at": "2015-10-02T00:11:37Z",
    "body": "This no longer ICE's on stable through nightly currently\n\n``` rust\nfn main() {\n    {\n        extern fn foo() { }\n    }\n\n    {\n        extern fn foo(_bar: usize) { }\n    }\n}\n```\n\nbut it does produce a not-so-nice error message:\n\n```\n<anon>:3:9: 3:28 warning: function is never used: `foo`, #[warn(dead_code)] on by default\n<anon>:3         extern fn foo() { }\n                 ^~~~~~~~~~~~~~~~~~~\n<anon>:7:9: 7:39 warning: function is never used: `foo`, #[warn(dead_code)] on by default\n<anon>:7         extern fn foo(_bar: usize) { }\n                 ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\nerror: symbol `_ZN4main3foo10__rust_abiE` already defined\nplaypen: application terminated with error code 101\n```\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/144882063/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/145857746",
    "html_url": "https://github.com/rust-lang/rust/issues/16403#issuecomment-145857746",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/16403",
    "id": 145857746,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE0NTg1Nzc0Ng==",
    "user": {
      "login": "apasel422",
      "id": 8644784,
      "node_id": "MDQ6VXNlcjg2NDQ3ODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8644784?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/apasel422",
      "html_url": "https://github.com/apasel422",
      "followers_url": "https://api.github.com/users/apasel422/followers",
      "following_url": "https://api.github.com/users/apasel422/following{/other_user}",
      "gists_url": "https://api.github.com/users/apasel422/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/apasel422/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/apasel422/subscriptions",
      "organizations_url": "https://api.github.com/users/apasel422/orgs",
      "repos_url": "https://api.github.com/users/apasel422/repos",
      "events_url": "https://api.github.com/users/apasel422/events{/privacy}",
      "received_events_url": "https://api.github.com/users/apasel422/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-10-06T13:36:00Z",
    "updated_at": "2015-10-06T13:36:00Z",
    "body": "Should @jethrogb's example compile? Per @huonw's comment, it seems like the fix is to include a hash in the symbol name, so I don't think E-needstest is correct.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/145857746/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/145879985",
    "html_url": "https://github.com/rust-lang/rust/issues/16403#issuecomment-145879985",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/16403",
    "id": 145879985,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE0NTg3OTk4NQ==",
    "user": {
      "login": "nagisa",
      "id": 679122,
      "node_id": "MDQ6VXNlcjY3OTEyMg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/679122?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nagisa",
      "html_url": "https://github.com/nagisa",
      "followers_url": "https://api.github.com/users/nagisa/followers",
      "following_url": "https://api.github.com/users/nagisa/following{/other_user}",
      "gists_url": "https://api.github.com/users/nagisa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nagisa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nagisa/subscriptions",
      "organizations_url": "https://api.github.com/users/nagisa/orgs",
      "repos_url": "https://api.github.com/users/nagisa/repos",
      "events_url": "https://api.github.com/users/nagisa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nagisa/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-10-06T14:46:33Z",
    "updated_at": "2015-10-06T14:47:46Z",
    "body": "The issue as reported (the ICE) has been fixed in a sense that rustc no longer ICEs in such case.\n\nWe have a bunch of tests for related failures at `src/test/compile-fail/dupe-symbols-*.rs`. but I can\u2019t seem to find anything that covers `extern` so I went ahead and added one. More tests is always better and they can be removed/changed once the behaviour we decide on changes.\n\nAs for whether failing in this case is the right thing to do\u2122, we should fill a new issue IMO.\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/145879985/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
