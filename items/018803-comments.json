[
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/62293495",
    "html_url": "https://github.com/rust-lang/rust/issues/18803#issuecomment-62293495",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/18803",
    "id": 62293495,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYyMjkzNDk1",
    "user": {
      "login": "huonw",
      "id": 1203825,
      "node_id": "MDQ6VXNlcjEyMDM4MjU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1203825?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/huonw",
      "html_url": "https://github.com/huonw",
      "followers_url": "https://api.github.com/users/huonw/followers",
      "following_url": "https://api.github.com/users/huonw/following{/other_user}",
      "gists_url": "https://api.github.com/users/huonw/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/huonw/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/huonw/subscriptions",
      "organizations_url": "https://api.github.com/users/huonw/orgs",
      "repos_url": "https://api.github.com/users/huonw/repos",
      "events_url": "https://api.github.com/users/huonw/events{/privacy}",
      "received_events_url": "https://api.github.com/users/huonw/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-11-09T06:34:36Z",
    "updated_at": "2014-11-09T06:34:36Z",
    "body": "The complier output is:\n\n```\n18803.rs:33:29: 33:31 error: cannot borrow `gl` as mutable more than once at a time\n18803.rs:33   let y = Shaders::new(&mut gl);\n                                        ^~\n18803.rs:32:29: 32:31 note: previous borrow of `gl` occurs here; the mutable borrow prevents subsequent moves, borrows, or modification of `gl` until the borrow ends\n18803.rs:32   let x = Shaders::new(&mut gl);\n                                        ^~\n18803.rs:34:2: 34:2 note: previous borrow ends here\n18803.rs:29 pub fn main() {\n18803.rs:30   let mut gl = GLContext;\n18803.rs:31 \n18803.rs:32   let x = Shaders::new(&mut gl);\n18803.rs:33   let y = Shaders::new(&mut gl);\n18803.rs:34 }\n            ^\nerror: aborting due to previous error\n```\n\nI think this is to do with how the compiler handles unused lifetimes. You probably want to be storing it with a [`ContravariantLifetime` marker](http://doc.rust-lang.org/nightly/std/kinds/marker/struct.ContravariantLifetime.html), which will probably cause all variations fail to compile with the above message.\n\ncc @nikomatsakis for confirmation.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/62293495/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/62312992",
    "html_url": "https://github.com/rust-lang/rust/issues/18803#issuecomment-62312992",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/18803",
    "id": 62312992,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYyMzEyOTky",
    "user": {
      "login": "bfops",
      "id": 196249,
      "node_id": "MDQ6VXNlcjE5NjI0OQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/196249?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/bfops",
      "html_url": "https://github.com/bfops",
      "followers_url": "https://api.github.com/users/bfops/followers",
      "following_url": "https://api.github.com/users/bfops/following{/other_user}",
      "gists_url": "https://api.github.com/users/bfops/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/bfops/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/bfops/subscriptions",
      "organizations_url": "https://api.github.com/users/bfops/orgs",
      "repos_url": "https://api.github.com/users/bfops/repos",
      "events_url": "https://api.github.com/users/bfops/events{/privacy}",
      "received_events_url": "https://api.github.com/users/bfops/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-11-09T18:12:57Z",
    "updated_at": "2014-11-09T18:12:57Z",
    "body": "Thanks! I removed `<'b:'a>` and added `ContravariantLifetime<'a>` to the definition of `Shaders`, and now compilation fails regardless of whether or not I'm using a `Vec`.. But I'm still confused why that happens - `gl` isn't actually being used anywhere, it's just being threaded through for the sake of the lifetime constraint, and even if it _were_ being used, it's not necessarily being borrowed.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/62312992/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/62313781",
    "html_url": "https://github.com/rust-lang/rust/issues/18803#issuecomment-62313781",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/18803",
    "id": 62313781,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYyMzEzNzgx",
    "user": {
      "login": "bfops",
      "id": 196249,
      "node_id": "MDQ6VXNlcjE5NjI0OQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/196249?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/bfops",
      "html_url": "https://github.com/bfops",
      "followers_url": "https://api.github.com/users/bfops/followers",
      "following_url": "https://api.github.com/users/bfops/following{/other_user}",
      "gists_url": "https://api.github.com/users/bfops/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/bfops/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/bfops/subscriptions",
      "organizations_url": "https://api.github.com/users/bfops/orgs",
      "repos_url": "https://api.github.com/users/bfops/repos",
      "events_url": "https://api.github.com/users/bfops/events{/privacy}",
      "received_events_url": "https://api.github.com/users/bfops/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-11-09T18:36:40Z",
    "updated_at": "2014-11-09T18:56:31Z",
    "body": "And follow-up question: if this is the wrong way, what's the right one? I'm trying to make sure that an OpenGL context exists when I do things like create shaders, but the design above doesn't work, and neither does:\n\n```\n#[test]\npub fn foo() {\n  let mut gl = GLContext::new();\n\n  let x = gl.test_create_program();\n  let y = gl.test_create_program();\n}\n```\n\nEdit: One option is to separate the creation of the structs from their initialization, so that the structs can always be created with an immutable context (e.g. having no calls to `Bind*` functions), and the initialization logic can potentially mutate the context. That seems a little restrictive though.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/62313781/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/62370714",
    "html_url": "https://github.com/rust-lang/rust/issues/18803#issuecomment-62370714",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/18803",
    "id": 62370714,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYyMzcwNzE0",
    "user": {
      "login": "nikomatsakis",
      "id": 155238,
      "node_id": "MDQ6VXNlcjE1NTIzOA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/155238?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nikomatsakis",
      "html_url": "https://github.com/nikomatsakis",
      "followers_url": "https://api.github.com/users/nikomatsakis/followers",
      "following_url": "https://api.github.com/users/nikomatsakis/following{/other_user}",
      "gists_url": "https://api.github.com/users/nikomatsakis/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nikomatsakis/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nikomatsakis/subscriptions",
      "organizations_url": "https://api.github.com/users/nikomatsakis/orgs",
      "repos_url": "https://api.github.com/users/nikomatsakis/repos",
      "events_url": "https://api.github.com/users/nikomatsakis/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nikomatsakis/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-11-10T11:14:17Z",
    "updated_at": "2014-11-10T11:14:17Z",
    "body": "@bfops if you want to have a shared context that everyone references, I suggest you use a shared reference (`&` not `&mut`) and then use `Cell` or `RefCell` for mutability where necessary.\n\n(cc #3598 which would make the \"unused lifetime parameter\" an error)\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/62370714/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/62462060",
    "html_url": "https://github.com/rust-lang/rust/issues/18803#issuecomment-62462060",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/18803",
    "id": 62462060,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYyNDYyMDYw",
    "user": {
      "login": "bfops",
      "id": 196249,
      "node_id": "MDQ6VXNlcjE5NjI0OQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/196249?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/bfops",
      "html_url": "https://github.com/bfops",
      "followers_url": "https://api.github.com/users/bfops/followers",
      "following_url": "https://api.github.com/users/bfops/following{/other_user}",
      "gists_url": "https://api.github.com/users/bfops/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/bfops/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/bfops/subscriptions",
      "organizations_url": "https://api.github.com/users/bfops/orgs",
      "repos_url": "https://api.github.com/users/bfops/repos",
      "events_url": "https://api.github.com/users/bfops/events{/privacy}",
      "received_events_url": "https://api.github.com/users/bfops/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-11-10T21:52:08Z",
    "updated_at": "2014-11-10T21:56:25Z",
    "body": "@nikomatsakis I do specifically want the compiler giving me sane checks for mutable usage of the OpenGL context, though (and also to not incur runtime overhead). My solution right now is to have a `GLContextExistence` struct that I use for the lifetime bounds, and a `GLContext` struct that is mutated or not in certain calls (e.g. `gl.GetError` takes an immutable reference, but `gl.UseShader` takes a mutable one), but I still don't understand why it's even necessary - the `GLContext` is never being - its lifetime is only used for lifetime bounding.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/62462060/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/71707784",
    "html_url": "https://github.com/rust-lang/rust/issues/18803#issuecomment-71707784",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/18803",
    "id": 71707784,
    "node_id": "MDEyOklzc3VlQ29tbWVudDcxNzA3Nzg0",
    "user": {
      "login": "steveklabnik",
      "id": 27786,
      "node_id": "MDQ6VXNlcjI3Nzg2",
      "avatar_url": "https://avatars.githubusercontent.com/u/27786?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/steveklabnik",
      "html_url": "https://github.com/steveklabnik",
      "followers_url": "https://api.github.com/users/steveklabnik/followers",
      "following_url": "https://api.github.com/users/steveklabnik/following{/other_user}",
      "gists_url": "https://api.github.com/users/steveklabnik/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/steveklabnik/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/steveklabnik/subscriptions",
      "organizations_url": "https://api.github.com/users/steveklabnik/orgs",
      "repos_url": "https://api.github.com/users/steveklabnik/repos",
      "events_url": "https://api.github.com/users/steveklabnik/events{/privacy}",
      "received_events_url": "https://api.github.com/users/steveklabnik/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-01-27T19:09:47Z",
    "updated_at": "2015-01-27T19:09:47Z",
    "body": "So is this a bug or not? \n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/71707784/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/72188881",
    "html_url": "https://github.com/rust-lang/rust/issues/18803#issuecomment-72188881",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/18803",
    "id": 72188881,
    "node_id": "MDEyOklzc3VlQ29tbWVudDcyMTg4ODgx",
    "user": {
      "login": "nikomatsakis",
      "id": 155238,
      "node_id": "MDQ6VXNlcjE1NTIzOA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/155238?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nikomatsakis",
      "html_url": "https://github.com/nikomatsakis",
      "followers_url": "https://api.github.com/users/nikomatsakis/followers",
      "following_url": "https://api.github.com/users/nikomatsakis/following{/other_user}",
      "gists_url": "https://api.github.com/users/nikomatsakis/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nikomatsakis/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nikomatsakis/subscriptions",
      "organizations_url": "https://api.github.com/users/nikomatsakis/orgs",
      "repos_url": "https://api.github.com/users/nikomatsakis/repos",
      "events_url": "https://api.github.com/users/nikomatsakis/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nikomatsakis/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-01-30T11:37:56Z",
    "updated_at": "2015-01-30T11:37:56Z",
    "body": "Ah, I meant to reply to @bfops, sorry about that. I think this it not a bug. Basically, this is how the type system works. That said, there might be a way to express what @bfops wanted with some cleverness. Or else it is potential fodder for future type-system extensions. @bfops maybe you can ping me on IRC and we can go over the example? Right now this is all kind of \"out of cache\".\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/72188881/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/72238946",
    "html_url": "https://github.com/rust-lang/rust/issues/18803#issuecomment-72238946",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/18803",
    "id": 72238946,
    "node_id": "MDEyOklzc3VlQ29tbWVudDcyMjM4OTQ2",
    "user": {
      "login": "bfops",
      "id": 196249,
      "node_id": "MDQ6VXNlcjE5NjI0OQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/196249?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/bfops",
      "html_url": "https://github.com/bfops",
      "followers_url": "https://api.github.com/users/bfops/followers",
      "following_url": "https://api.github.com/users/bfops/following{/other_user}",
      "gists_url": "https://api.github.com/users/bfops/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/bfops/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/bfops/subscriptions",
      "organizations_url": "https://api.github.com/users/bfops/orgs",
      "repos_url": "https://api.github.com/users/bfops/repos",
      "events_url": "https://api.github.com/users/bfops/events{/privacy}",
      "received_events_url": "https://api.github.com/users/bfops/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-01-30T17:36:38Z",
    "updated_at": "2015-01-30T17:36:38Z",
    "body": "SGTM thanks!\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/72238946/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
