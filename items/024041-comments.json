[
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/92135064",
    "html_url": "https://github.com/rust-lang/rust/issues/24041#issuecomment-92135064",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/24041",
    "id": 92135064,
    "node_id": "MDEyOklzc3VlQ29tbWVudDkyMTM1MDY0",
    "user": {
      "login": "abonander",
      "id": 3198595,
      "node_id": "MDQ6VXNlcjMxOTg1OTU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3198595?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/abonander",
      "html_url": "https://github.com/abonander",
      "followers_url": "https://api.github.com/users/abonander/followers",
      "following_url": "https://api.github.com/users/abonander/following{/other_user}",
      "gists_url": "https://api.github.com/users/abonander/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/abonander/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/abonander/subscriptions",
      "organizations_url": "https://api.github.com/users/abonander/orgs",
      "repos_url": "https://api.github.com/users/abonander/repos",
      "events_url": "https://api.github.com/users/abonander/events{/privacy}",
      "received_events_url": "https://api.github.com/users/abonander/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-04-12T21:16:58Z",
    "updated_at": "2015-04-12T21:16:58Z",
    "body": "I'm not sure I follow. `&MyTrait` and `Box<MyTrait>` are the same width, neither can be zero, and the second half of the enum could be `[0us; 2]` or empty space. I don't see a way to deduce the variant without a discriminator. Maybe I'm missing something.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/92135064/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/92135824",
    "html_url": "https://github.com/rust-lang/rust/issues/24041#issuecomment-92135824",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/24041",
    "id": 92135824,
    "node_id": "MDEyOklzc3VlQ29tbWVudDkyMTM1ODI0",
    "user": {
      "login": "Diggsey",
      "id": 451321,
      "node_id": "MDQ6VXNlcjQ1MTMyMQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/451321?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Diggsey",
      "html_url": "https://github.com/Diggsey",
      "followers_url": "https://api.github.com/users/Diggsey/followers",
      "following_url": "https://api.github.com/users/Diggsey/following{/other_user}",
      "gists_url": "https://api.github.com/users/Diggsey/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Diggsey/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Diggsey/subscriptions",
      "organizations_url": "https://api.github.com/users/Diggsey/orgs",
      "repos_url": "https://api.github.com/users/Diggsey/repos",
      "events_url": "https://api.github.com/users/Diggsey/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Diggsey/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-04-12T21:31:07Z",
    "updated_at": "2015-04-12T21:31:07Z",
    "body": "The layout of the Boxed variant could theoretically be altered such that `Box<MyTrait>` occupies the same space as the `[usize; 2]` from the Inline variant. The first `usize` bytes could then be used as the discriminator, where 0 => Boxed, _ => Inline.\n\nI'm not sure how worthwhile this is, since it's very specific, and the algorithm to calculate the best layout for every possible scenario is at the very least non-obvious. If there is ever a rust ABI, then it would be preferable to have layouts controlled by predictable, easy to describe rules.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/92135824/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/92135840",
    "html_url": "https://github.com/rust-lang/rust/issues/24041#issuecomment-92135840",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/24041",
    "id": 92135840,
    "node_id": "MDEyOklzc3VlQ29tbWVudDkyMTM1ODQw",
    "user": {
      "login": "dotdash",
      "id": 230962,
      "node_id": "MDQ6VXNlcjIzMDk2Mg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/230962?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dotdash",
      "html_url": "https://github.com/dotdash",
      "followers_url": "https://api.github.com/users/dotdash/followers",
      "following_url": "https://api.github.com/users/dotdash/following{/other_user}",
      "gists_url": "https://api.github.com/users/dotdash/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dotdash/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dotdash/subscriptions",
      "organizations_url": "https://api.github.com/users/dotdash/orgs",
      "repos_url": "https://api.github.com/users/dotdash/repos",
      "events_url": "https://api.github.com/users/dotdash/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dotdash/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-04-12T21:31:21Z",
    "updated_at": "2015-04-12T21:31:21Z",
    "body": "If you put the box in the same space as the array, i.e. in the second half,\nthen you can identify the Boxed variant by the first half being set to zero.\nAm 12.04.2015 23:17 schrieb \"Austin Bonander\" notifications@github.com:\n\n> I'm not sure I follow. &MyTrait and Box<MyTrait> are the same width,\n> neither can be zero, and the second half of the enum could be [0us; 2] or\n> empty space. I don't see a way to deduce the variant without a\n> discriminator. Maybe I'm missing something.\n> \n> \u2014\n> Reply to this email directly or view it on GitHub\n> https://github.com/rust-lang/rust/issues/24041#issuecomment-92135064.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/92135840/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/116004487",
    "html_url": "https://github.com/rust-lang/rust/issues/24041#issuecomment-116004487",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/24041",
    "id": 116004487,
    "node_id": "MDEyOklzc3VlQ29tbWVudDExNjAwNDQ4Nw==",
    "user": {
      "login": "Marwes",
      "id": 957312,
      "node_id": "MDQ6VXNlcjk1NzMxMg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/957312?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Marwes",
      "html_url": "https://github.com/Marwes",
      "followers_url": "https://api.github.com/users/Marwes/followers",
      "following_url": "https://api.github.com/users/Marwes/following{/other_user}",
      "gists_url": "https://api.github.com/users/Marwes/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Marwes/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Marwes/subscriptions",
      "organizations_url": "https://api.github.com/users/Marwes/orgs",
      "repos_url": "https://api.github.com/users/Marwes/repos",
      "events_url": "https://api.github.com/users/Marwes/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Marwes/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-06-27T10:45:57Z",
    "updated_at": "2015-06-27T10:45:57Z",
    "body": "Its not necessarily a strictly better idea to put the box in the same space as the array though.\n\n``` rust\nfn zomg(foo: &Foo)\n    match *foo {\n        Inline(ref t, _) => t.zomg(),\n        Boxed(ref t) => t.zomg()\n}\n```\n\nIn a function such as above, since the the data and vtable are in the same position it could be optimized to just load those positions and call the function, avoiding the discriminant test completely. I don't know if llvm performs that sort of optimization though.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/116004487/reactions",
      "total_count": 2,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 1
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/263706815",
    "html_url": "https://github.com/rust-lang/rust/issues/24041#issuecomment-263706815",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/24041",
    "id": 263706815,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI2MzcwNjgxNQ==",
    "user": {
      "login": "steveklabnik",
      "id": 27786,
      "node_id": "MDQ6VXNlcjI3Nzg2",
      "avatar_url": "https://avatars.githubusercontent.com/u/27786?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/steveklabnik",
      "html_url": "https://github.com/steveklabnik",
      "followers_url": "https://api.github.com/users/steveklabnik/followers",
      "following_url": "https://api.github.com/users/steveklabnik/following{/other_user}",
      "gists_url": "https://api.github.com/users/steveklabnik/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/steveklabnik/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/steveklabnik/subscriptions",
      "organizations_url": "https://api.github.com/users/steveklabnik/orgs",
      "repos_url": "https://api.github.com/users/steveklabnik/repos",
      "events_url": "https://api.github.com/users/steveklabnik/events{/privacy}",
      "received_events_url": "https://api.github.com/users/steveklabnik/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2016-11-29T21:36:39Z",
    "updated_at": "2016-11-29T21:36:56Z",
    "body": "Triage: `thread 'main' panicked at 'assertion failed: (left == right) (left: 32, right: 40)',`",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/263706815/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/377804327",
    "html_url": "https://github.com/rust-lang/rust/issues/24041#issuecomment-377804327",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/24041",
    "id": 377804327,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM3NzgwNDMyNw==",
    "user": {
      "login": "nox",
      "id": 123095,
      "node_id": "MDQ6VXNlcjEyMzA5NQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/123095?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nox",
      "html_url": "https://github.com/nox",
      "followers_url": "https://api.github.com/users/nox/followers",
      "following_url": "https://api.github.com/users/nox/following{/other_user}",
      "gists_url": "https://api.github.com/users/nox/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nox/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nox/subscriptions",
      "organizations_url": "https://api.github.com/users/nox/orgs",
      "repos_url": "https://api.github.com/users/nox/repos",
      "events_url": "https://api.github.com/users/nox/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nox/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2018-04-01T17:51:46Z",
    "updated_at": "2018-04-01T17:51:46Z",
    "body": "This could be done with @eddyb's niche-filling optimisation. It currently only applies to enums with a single dataful variant, but we could make it apply to the largest variant of the enum instead. I am pretty sure this would also improve the layout of a bunch of enums in Stylo.\r\n\r\nI've thought about this a bit and I think the niche-filling optimisation should apply to the largest variant of any `repr(Rust)` enum, if there is no other variant that is as large.\r\n\r\nCc @rust-lang/wg-codegen",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/377804327/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/380075969",
    "html_url": "https://github.com/rust-lang/rust/issues/24041#issuecomment-380075969",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/24041",
    "id": 380075969,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM4MDA3NTk2OQ==",
    "user": {
      "login": "eddyb",
      "id": 77424,
      "node_id": "MDQ6VXNlcjc3NDI0",
      "avatar_url": "https://avatars.githubusercontent.com/u/77424?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/eddyb",
      "html_url": "https://github.com/eddyb",
      "followers_url": "https://api.github.com/users/eddyb/followers",
      "following_url": "https://api.github.com/users/eddyb/following{/other_user}",
      "gists_url": "https://api.github.com/users/eddyb/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/eddyb/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/eddyb/subscriptions",
      "organizations_url": "https://api.github.com/users/eddyb/orgs",
      "repos_url": "https://api.github.com/users/eddyb/repos",
      "events_url": "https://api.github.com/users/eddyb/events{/privacy}",
      "received_events_url": "https://api.github.com/users/eddyb/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2018-04-10T12:10:40Z",
    "updated_at": "2018-04-10T12:10:40Z",
    "body": "This seems to (now) be a duplicate of #46213.",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/380075969/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/511261845",
    "html_url": "https://github.com/rust-lang/rust/issues/24041#issuecomment-511261845",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/24041",
    "id": 511261845,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUxMTI2MTg0NQ==",
    "user": {
      "login": "dtolnay",
      "id": 1940490,
      "node_id": "MDQ6VXNlcjE5NDA0OTA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1940490?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dtolnay",
      "html_url": "https://github.com/dtolnay",
      "followers_url": "https://api.github.com/users/dtolnay/followers",
      "following_url": "https://api.github.com/users/dtolnay/following{/other_user}",
      "gists_url": "https://api.github.com/users/dtolnay/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dtolnay/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dtolnay/subscriptions",
      "organizations_url": "https://api.github.com/users/dtolnay/orgs",
      "repos_url": "https://api.github.com/users/dtolnay/repos",
      "events_url": "https://api.github.com/users/dtolnay/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dtolnay/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2019-07-15T03:00:08Z",
    "updated_at": "2019-07-15T03:00:08Z",
    "body": "Closing in favor of the more general #46213.",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/511261845/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
