[
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/2564205",
    "html_url": "https://github.com/rust-lang/rust/issues/999#issuecomment-2564205",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/999",
    "id": 2564205,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI1NjQyMDU=",
    "user": {
      "login": "lht",
      "id": 19508,
      "node_id": "MDQ6VXNlcjE5NTA4",
      "avatar_url": "https://avatars.githubusercontent.com/u/19508?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/lht",
      "html_url": "https://github.com/lht",
      "followers_url": "https://api.github.com/users/lht/followers",
      "following_url": "https://api.github.com/users/lht/following{/other_user}",
      "gists_url": "https://api.github.com/users/lht/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/lht/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/lht/subscriptions",
      "organizations_url": "https://api.github.com/users/lht/orgs",
      "repos_url": "https://api.github.com/users/lht/repos",
      "events_url": "https://api.github.com/users/lht/events{/privacy}",
      "received_events_url": "https://api.github.com/users/lht/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2011-10-29T09:43:31Z",
    "updated_at": "2011-10-29T12:17:08Z",
    "body": "I admit this is a bit of hackish, but it seems works. :)\n\nPlease suggest if there is a better way to handle it with keeping the crate name unchanged.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/2564205/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/2567299",
    "html_url": "https://github.com/rust-lang/rust/issues/999#issuecomment-2567299",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/999",
    "id": 2567299,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI1NjcyOTk=",
    "user": {
      "login": "brson",
      "id": 147214,
      "node_id": "MDQ6VXNlcjE0NzIxNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/brson",
      "html_url": "https://github.com/brson",
      "followers_url": "https://api.github.com/users/brson/followers",
      "following_url": "https://api.github.com/users/brson/following{/other_user}",
      "gists_url": "https://api.github.com/users/brson/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/brson/subscriptions",
      "organizations_url": "https://api.github.com/users/brson/orgs",
      "repos_url": "https://api.github.com/users/brson/repos",
      "events_url": "https://api.github.com/users/brson/events{/privacy}",
      "received_events_url": "https://api.github.com/users/brson/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2011-10-29T22:24:03Z",
    "updated_at": "2011-10-29T22:24:03Z",
    "body": "Hi lht.\n\nThanks for investigating this. I agree that is hackish. The obstacle here is that we're interpreting the filename as crate metadata; in other words, when looking for a crate named 'foo', we expect it to be in a file named 'libfoo.so'. In all other respects we treat the crate metadata as actual metadata.\n\nI think what we should try is to completely separate these two concepts, so the crate metadata is independent of the library name.\n\nSo in find_library_crate_aux the first sanity check we do is look for a library containing the crate_name. Instead I think this function should just verify that the file looks like a library, e.g. lib*.so on linux, etc. then inspect the metadata to check the crate name.\n\nThe thing you are going to run into is that the current code handles the case where the 'use' statement doesn't specify any metadata. In find_library_crate, when it's building the crate_name it uses either the 'name' meta-item, as in `use std(name = \"std\");`, or it falls back to the identifier used in the 'use' statement, as in `use std;`. If we were to just match the matadata in the library with the metadata provided in the use statement, then this would match any library to any use statement that doesn't explicitly specify metadata (so 'use std;' would end up matching libfoo.so).\n\nTo remedy this we'll need to implicitly create a \"name\"=val meta-item when the use statement doesn't provide one and match the library metadata against that.\n\nThis approach does pose a performance risk since we will end up opening every library on the search path. I suspect that this won't be an immediate problem since our default search paths are in rustc-specific directories; we're not searching /usr/lib. Nonetheless, we should probably time a full run of 'make check' both before and after this change to make sure there isn't a serious regression.\n\nI checked in some additional logging to creader that might help debugging.\n\nI hope that all made sense.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/2567299/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/2570603",
    "html_url": "https://github.com/rust-lang/rust/issues/999#issuecomment-2570603",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/999",
    "id": 2570603,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI1NzA2MDM=",
    "user": {
      "login": "lht",
      "id": 19508,
      "node_id": "MDQ6VXNlcjE5NTA4",
      "avatar_url": "https://avatars.githubusercontent.com/u/19508?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/lht",
      "html_url": "https://github.com/lht",
      "followers_url": "https://api.github.com/users/lht/followers",
      "following_url": "https://api.github.com/users/lht/following{/other_user}",
      "gists_url": "https://api.github.com/users/lht/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/lht/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/lht/subscriptions",
      "organizations_url": "https://api.github.com/users/lht/orgs",
      "repos_url": "https://api.github.com/users/lht/repos",
      "events_url": "https://api.github.com/users/lht/events{/privacy}",
      "received_events_url": "https://api.github.com/users/lht/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2011-10-30T17:53:59Z",
    "updated_at": "2011-10-30T17:53:59Z",
    "body": "Hi, Brian! Thanks a lot of such a thorough explanation! And I learnt using log fmt to help understand the code. Very useful! :)\n\n$ git log --oneline -n 2\n69e4ba4 Rename libstd.so to libruststd.so\n28bec1d rustc: Find crates by matching the name metadata\n\nI see some slow down after the commit.\nbefore:1m18.574s\nafter:    1m18.832s\nThis only run single time, and there are 2 failed cases since commit 2cebef0.\nfailures:\n    io::buffered_file_buf_writer_bad_name\n    io::file_buf_writer_bad_name\n\nI wonder is there a simple way to just compile tests but not running them?\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/2570603/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/2572082",
    "html_url": "https://github.com/rust-lang/rust/issues/999#issuecomment-2572082",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/999",
    "id": 2572082,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI1NzIwODI=",
    "user": {
      "login": "brson",
      "id": 147214,
      "node_id": "MDQ6VXNlcjE0NzIxNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/brson",
      "html_url": "https://github.com/brson",
      "followers_url": "https://api.github.com/users/brson/followers",
      "following_url": "https://api.github.com/users/brson/following{/other_user}",
      "gists_url": "https://api.github.com/users/brson/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/brson/subscriptions",
      "organizations_url": "https://api.github.com/users/brson/orgs",
      "repos_url": "https://api.github.com/users/brson/repos",
      "events_url": "https://api.github.com/users/brson/events{/privacy}",
      "received_events_url": "https://api.github.com/users/brson/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2011-10-30T22:48:50Z",
    "updated_at": "2011-10-30T22:48:50Z",
    "body": "Looks good! I compared the time for a full 'make check' before and after your patch and don't see a regression, so that's ok.\n\nMerging this is going to require some temporary makefile tweaks and a new snapshot since the stage0 compiler is still using the old rules to find libstd.so (try doing a make clean then building and you'll see the stage0 compiler can't find the standard library with the new name). I will work on that and try to get this merged on Monday.\n\nWhich OS are you running on? None of the bots show those build failures. There's no way currently to compile the tests without running them.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/2572082/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/2572925",
    "html_url": "https://github.com/rust-lang/rust/issues/999#issuecomment-2572925",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/999",
    "id": 2572925,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI1NzI5MjU=",
    "user": {
      "login": "lht",
      "id": 19508,
      "node_id": "MDQ6VXNlcjE5NTA4",
      "avatar_url": "https://avatars.githubusercontent.com/u/19508?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/lht",
      "html_url": "https://github.com/lht",
      "followers_url": "https://api.github.com/users/lht/followers",
      "following_url": "https://api.github.com/users/lht/following{/other_user}",
      "gists_url": "https://api.github.com/users/lht/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/lht/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/lht/subscriptions",
      "organizations_url": "https://api.github.com/users/lht/orgs",
      "repos_url": "https://api.github.com/users/lht/repos",
      "events_url": "https://api.github.com/users/lht/events{/privacy}",
      "received_events_url": "https://api.github.com/users/lht/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2011-10-31T02:19:55Z",
    "updated_at": "2011-10-31T02:19:55Z",
    "body": "I found there is actually a \"/?\" file exists. That's because I forgot to change owner of the root directory to \"root\" after migrating data from Btrfs to Ext4 months ago. Fix it and now all cases are passed.\n\nSorry for the false alarm!\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/2572925/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/2573085",
    "html_url": "https://github.com/rust-lang/rust/issues/999#issuecomment-2573085",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/999",
    "id": 2573085,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI1NzMwODU=",
    "user": {
      "login": "brson",
      "id": 147214,
      "node_id": "MDQ6VXNlcjE0NzIxNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/brson",
      "html_url": "https://github.com/brson",
      "followers_url": "https://api.github.com/users/brson/followers",
      "following_url": "https://api.github.com/users/brson/following{/other_user}",
      "gists_url": "https://api.github.com/users/brson/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/brson/subscriptions",
      "organizations_url": "https://api.github.com/users/brson/orgs",
      "repos_url": "https://api.github.com/users/brson/repos",
      "events_url": "https://api.github.com/users/brson/events{/privacy}",
      "received_events_url": "https://api.github.com/users/brson/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2011-10-31T02:56:26Z",
    "updated_at": "2011-10-31T02:56:26Z",
    "body": "Oh. Those tests are pretty bad then, since they will fail when running as root.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/2573085/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/2584264",
    "html_url": "https://github.com/rust-lang/rust/issues/999#issuecomment-2584264",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/999",
    "id": 2584264,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI1ODQyNjQ=",
    "user": {
      "login": "brson",
      "id": 147214,
      "node_id": "MDQ6VXNlcjE0NzIxNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/brson",
      "html_url": "https://github.com/brson",
      "followers_url": "https://api.github.com/users/brson/followers",
      "following_url": "https://api.github.com/users/brson/following{/other_user}",
      "gists_url": "https://api.github.com/users/brson/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/brson/subscriptions",
      "organizations_url": "https://api.github.com/users/brson/orgs",
      "repos_url": "https://api.github.com/users/brson/repos",
      "events_url": "https://api.github.com/users/brson/events{/privacy}",
      "received_events_url": "https://api.github.com/users/brson/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2011-10-31T22:27:05Z",
    "updated_at": "2011-10-31T22:27:05Z",
    "body": "OK. This is integrated. Thanks, lht.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/2584264/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
