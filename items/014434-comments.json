[
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/44159678",
    "html_url": "https://github.com/rust-lang/rust/issues/14434#issuecomment-44159678",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/14434",
    "id": 44159678,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ0MTU5Njc4",
    "user": {
      "login": "o11c",
      "id": 964689,
      "node_id": "MDQ6VXNlcjk2NDY4OQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/964689?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/o11c",
      "html_url": "https://github.com/o11c",
      "followers_url": "https://api.github.com/users/o11c/followers",
      "following_url": "https://api.github.com/users/o11c/following{/other_user}",
      "gists_url": "https://api.github.com/users/o11c/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/o11c/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/o11c/subscriptions",
      "organizations_url": "https://api.github.com/users/o11c/orgs",
      "repos_url": "https://api.github.com/users/o11c/repos",
      "events_url": "https://api.github.com/users/o11c/events{/privacy}",
      "received_events_url": "https://api.github.com/users/o11c/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-05-26T06:05:00Z",
    "updated_at": "2014-05-26T06:05:00Z",
    "body": "With a little further thought, `stderr` needs to be accessible to things like `fail!`. Of course, it's not necssarily the case that `fail!` has to use the _same_ `stderr` ... but it might be best to exclude `stderr`. Actually, I'm not convinced that `stderr` should entirely be an ordinary stream.\n\nHowever, I do still defend the notion of passing `stdout` as an argument to `main`, even though it doesn't have as many problems as `stdin` does. It just plain leads to better design. In C or C++, how many `dump` methods are there that are hard-coded to write to `stdout` because there is a family of functions that uses it implicitly? Sometimes `stderr` may be more appropriate, but in C `stderr` is a second-class citiizen, and often it would be nice to be able to specify an arbitrary file.\n\nBy \"argument to `main`\" I think there should be a single struct that contains the two standard streams and whatever else makes sense to put there. (personally, I would actually prefer that `os::args` and `os::args` also be members, but I'm not going to fight for that) That same struct should maybe be reused when creating tasks, but I'm unsure of what kind of lifetime it and its members will need to have.\n",
    "author_association": "NONE",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/44159678/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/44230272",
    "html_url": "https://github.com/rust-lang/rust/issues/14434#issuecomment-44230272",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/14434",
    "id": 44230272,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ0MjMwMjcy",
    "user": {
      "login": "seanmonstar",
      "id": 51479,
      "node_id": "MDQ6VXNlcjUxNDc5",
      "avatar_url": "https://avatars.githubusercontent.com/u/51479?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/seanmonstar",
      "html_url": "https://github.com/seanmonstar",
      "followers_url": "https://api.github.com/users/seanmonstar/followers",
      "following_url": "https://api.github.com/users/seanmonstar/following{/other_user}",
      "gists_url": "https://api.github.com/users/seanmonstar/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/seanmonstar/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/seanmonstar/subscriptions",
      "organizations_url": "https://api.github.com/users/seanmonstar/orgs",
      "repos_url": "https://api.github.com/users/seanmonstar/repos",
      "events_url": "https://api.github.com/users/seanmonstar/events{/privacy}",
      "received_events_url": "https://api.github.com/users/seanmonstar/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-05-27T02:27:25Z",
    "updated_at": "2014-05-27T02:27:25Z",
    "body": "it looks like there's already a `with_local_stdout`: https://github.com/mozilla/rust/blob/master/src/libstd/io/stdio.rs#L207\n\nWould a solution here be that `stdin()`, `stdout()`, and `stderr()` all use a similar `with_local_std<io>`?\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/44230272/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/44230593",
    "html_url": "https://github.com/rust-lang/rust/issues/14434#issuecomment-44230593",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/14434",
    "id": 44230593,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ0MjMwNTkz",
    "user": {
      "login": "sfackler",
      "id": 1455697,
      "node_id": "MDQ6VXNlcjE0NTU2OTc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1455697?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sfackler",
      "html_url": "https://github.com/sfackler",
      "followers_url": "https://api.github.com/users/sfackler/followers",
      "following_url": "https://api.github.com/users/sfackler/following{/other_user}",
      "gists_url": "https://api.github.com/users/sfackler/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sfackler/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sfackler/subscriptions",
      "organizations_url": "https://api.github.com/users/sfackler/orgs",
      "repos_url": "https://api.github.com/users/sfackler/repos",
      "events_url": "https://api.github.com/users/sfackler/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sfackler/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-05-27T02:34:50Z",
    "updated_at": "2014-05-27T02:34:50Z",
    "body": "`with_local_foo` isn't a great solution since it's unsafe. A better solution would probably be to have the BufferedWriter/Reader be stored in the task's internals and `stdin()` etc would return smart pointers back to that Reader/Writer. You'd still run into issues if you try to read from stdin in multiple tasks, so it might need to be a global synchronized singleton which would be rather unfortunate.\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/44230593/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/44232826",
    "html_url": "https://github.com/rust-lang/rust/issues/14434#issuecomment-44232826",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/14434",
    "id": 44232826,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ0MjMyODI2",
    "user": {
      "login": "o11c",
      "id": 964689,
      "node_id": "MDQ6VXNlcjk2NDY4OQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/964689?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/o11c",
      "html_url": "https://github.com/o11c",
      "followers_url": "https://api.github.com/users/o11c/followers",
      "following_url": "https://api.github.com/users/o11c/following{/other_user}",
      "gists_url": "https://api.github.com/users/o11c/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/o11c/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/o11c/subscriptions",
      "organizations_url": "https://api.github.com/users/o11c/orgs",
      "repos_url": "https://api.github.com/users/o11c/repos",
      "events_url": "https://api.github.com/users/o11c/events{/privacy}",
      "received_events_url": "https://api.github.com/users/o11c/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-05-27T03:30:12Z",
    "updated_at": "2014-05-27T03:30:12Z",
    "body": "I'd rather see `stdin()` return an `Option`, where it returns `None` in all other tasks but the main one if you didn't specify a stdin when starting the task\n",
    "author_association": "NONE",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/44232826/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/44272084",
    "html_url": "https://github.com/rust-lang/rust/issues/14434#issuecomment-44272084",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/14434",
    "id": 44272084,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ0MjcyMDg0",
    "user": {
      "login": "ben0x539",
      "id": 24142,
      "node_id": "MDQ6VXNlcjI0MTQy",
      "avatar_url": "https://avatars.githubusercontent.com/u/24142?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ben0x539",
      "html_url": "https://github.com/ben0x539",
      "followers_url": "https://api.github.com/users/ben0x539/followers",
      "following_url": "https://api.github.com/users/ben0x539/following{/other_user}",
      "gists_url": "https://api.github.com/users/ben0x539/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ben0x539/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ben0x539/subscriptions",
      "organizations_url": "https://api.github.com/users/ben0x539/orgs",
      "repos_url": "https://api.github.com/users/ben0x539/repos",
      "events_url": "https://api.github.com/users/ben0x539/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ben0x539/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-05-27T13:00:50Z",
    "updated_at": "2014-05-27T13:00:50Z",
    "body": "To begin with, we could rename it to `create_buffered_stdin()` or something similarly \"you shouldn't call this for every line of input\"-sounding. If I still mess it up, losing my input isn't really _unsafe_, so...\n\nEven if we change the standard streams to be arguments to main, chances are people who feel like using them deep within some code without having them passed down all the way from main will just go \"gee, rust is making this too complicated\" and call the libc stdio functions (and that will conflict with whatever we do, unless we go the C++ route of building our standard streams on top of stdio).\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/44272084/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/55967765",
    "html_url": "https://github.com/rust-lang/rust/issues/14434#issuecomment-55967765",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/14434",
    "id": 55967765,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU1OTY3NzY1",
    "user": {
      "login": "aturon",
      "id": 709807,
      "node_id": "MDQ6VXNlcjcwOTgwNw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/709807?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/aturon",
      "html_url": "https://github.com/aturon",
      "followers_url": "https://api.github.com/users/aturon/followers",
      "following_url": "https://api.github.com/users/aturon/following{/other_user}",
      "gists_url": "https://api.github.com/users/aturon/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/aturon/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/aturon/subscriptions",
      "organizations_url": "https://api.github.com/users/aturon/orgs",
      "repos_url": "https://api.github.com/users/aturon/repos",
      "events_url": "https://api.github.com/users/aturon/events{/privacy}",
      "received_events_url": "https://api.github.com/users/aturon/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-09-17T22:07:43Z",
    "updated_at": "2014-09-17T22:07:43Z",
    "body": "cc me\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/55967765/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/64974655",
    "html_url": "https://github.com/rust-lang/rust/issues/14434#issuecomment-64974655",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/14434",
    "id": 64974655,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY0OTc0NjU1",
    "user": {
      "login": "sfackler",
      "id": 1455697,
      "node_id": "MDQ6VXNlcjE0NTU2OTc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1455697?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sfackler",
      "html_url": "https://github.com/sfackler",
      "followers_url": "https://api.github.com/users/sfackler/followers",
      "following_url": "https://api.github.com/users/sfackler/following{/other_user}",
      "gists_url": "https://api.github.com/users/sfackler/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sfackler/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sfackler/subscriptions",
      "organizations_url": "https://api.github.com/users/sfackler/orgs",
      "repos_url": "https://api.github.com/users/sfackler/repos",
      "events_url": "https://api.github.com/users/sfackler/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sfackler/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-11-30T03:50:55Z",
    "updated_at": "2014-11-30T03:50:55Z",
    "body": "It seems like `stdin` should really return a `Reader` wrapping a `Arc<Mutex<BufferedReader<StdReader>>>`.\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/64974655/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/64975081",
    "html_url": "https://github.com/rust-lang/rust/issues/14434#issuecomment-64975081",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/14434",
    "id": 64975081,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY0OTc1MDgx",
    "user": {
      "login": "sfackler",
      "id": 1455697,
      "node_id": "MDQ6VXNlcjE0NTU2OTc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1455697?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sfackler",
      "html_url": "https://github.com/sfackler",
      "followers_url": "https://api.github.com/users/sfackler/followers",
      "following_url": "https://api.github.com/users/sfackler/following{/other_user}",
      "gists_url": "https://api.github.com/users/sfackler/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sfackler/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sfackler/subscriptions",
      "organizations_url": "https://api.github.com/users/sfackler/orgs",
      "repos_url": "https://api.github.com/users/sfackler/repos",
      "events_url": "https://api.github.com/users/sfackler/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sfackler/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-11-30T04:15:09Z",
    "updated_at": "2014-11-30T04:15:09Z",
    "body": "So it seems like there are two options: We can use thread-local `BufferedReader<StdReader>`s or a global singleton `Reader` wrapping an `Arc<Mutex<BufferedReader<StdReader>>>`. The first option is easier, but it runs into problems if multiple threads call `stdin()`. The second option has some weird side effects. For example, we can't actually implement `Buffer` for it, since we can't safely implement `fill_buf` and `consume` doesn't make sense. We could manually implement `read_line`, `read_until`, `read_char` and `BufferPrelude`. I'm working on the second option right now since it seems like there will be less surprises to users.\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/64975081/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
