[
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/68627969",
    "html_url": "https://github.com/rust-lang/rust/issues/20460#issuecomment-68627969",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/20460",
    "id": 68627969,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY4NjI3OTY5",
    "user": {
      "login": "lifthrasiir",
      "id": 323836,
      "node_id": "MDQ6VXNlcjMyMzgzNg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/323836?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/lifthrasiir",
      "html_url": "https://github.com/lifthrasiir",
      "followers_url": "https://api.github.com/users/lifthrasiir/followers",
      "following_url": "https://api.github.com/users/lifthrasiir/following{/other_user}",
      "gists_url": "https://api.github.com/users/lifthrasiir/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/lifthrasiir/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/lifthrasiir/subscriptions",
      "organizations_url": "https://api.github.com/users/lifthrasiir/orgs",
      "repos_url": "https://api.github.com/users/lifthrasiir/repos",
      "events_url": "https://api.github.com/users/lifthrasiir/events{/privacy}",
      "received_events_url": "https://api.github.com/users/lifthrasiir/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-01-04T10:22:27Z",
    "updated_at": "2015-01-04T10:29:04Z",
    "body": "http://is.gd/wRJF3h\n\nAs you can see, this is a fault of `Vec` assuming `size_of::<T>() >= min_align_of::<T>()` (while for `T = f32x3` this is 12 and 16 respectively). More accurately, for `T = f32x3`, every growth allocates `cap * 12` bytes while it actually needs `cap * 16` bytes; any element after `len >= cap * 3 / 4` will overflow the memory, and they will be omitted at the next reallocation.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/68627969/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/68634508",
    "html_url": "https://github.com/rust-lang/rust/issues/20460#issuecomment-68634508",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/20460",
    "id": 68634508,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY4NjM0NTA4",
    "user": {
      "login": "Gankra",
      "id": 1136864,
      "node_id": "MDQ6VXNlcjExMzY4NjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1136864?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Gankra",
      "html_url": "https://github.com/Gankra",
      "followers_url": "https://api.github.com/users/Gankra/followers",
      "following_url": "https://api.github.com/users/Gankra/following{/other_user}",
      "gists_url": "https://api.github.com/users/Gankra/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Gankra/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Gankra/subscriptions",
      "organizations_url": "https://api.github.com/users/Gankra/orgs",
      "repos_url": "https://api.github.com/users/Gankra/repos",
      "events_url": "https://api.github.com/users/Gankra/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Gankra/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-01-04T14:26:25Z",
    "updated_at": "2015-01-04T14:26:25Z",
    "body": "Ack!\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/68634508/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/68634512",
    "html_url": "https://github.com/rust-lang/rust/issues/20460#issuecomment-68634512",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/20460",
    "id": 68634512,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY4NjM0NTEy",
    "user": {
      "login": "Gankra",
      "id": 1136864,
      "node_id": "MDQ6VXNlcjExMzY4NjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1136864?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Gankra",
      "html_url": "https://github.com/Gankra",
      "followers_url": "https://api.github.com/users/Gankra/followers",
      "following_url": "https://api.github.com/users/Gankra/following{/other_user}",
      "gists_url": "https://api.github.com/users/Gankra/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Gankra/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Gankra/subscriptions",
      "organizations_url": "https://api.github.com/users/Gankra/orgs",
      "repos_url": "https://api.github.com/users/Gankra/repos",
      "events_url": "https://api.github.com/users/Gankra/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Gankra/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-01-04T14:26:37Z",
    "updated_at": "2015-01-04T14:26:37Z",
    "body": "CC @thestinger \n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/68634512/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/68651280",
    "html_url": "https://github.com/rust-lang/rust/issues/20460#issuecomment-68651280",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/20460",
    "id": 68651280,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY4NjUxMjgw",
    "user": {
      "login": "simnalamburt",
      "id": 4435445,
      "node_id": "MDQ6VXNlcjQ0MzU0NDU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4435445?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/simnalamburt",
      "html_url": "https://github.com/simnalamburt",
      "followers_url": "https://api.github.com/users/simnalamburt/followers",
      "following_url": "https://api.github.com/users/simnalamburt/following{/other_user}",
      "gists_url": "https://api.github.com/users/simnalamburt/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/simnalamburt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/simnalamburt/subscriptions",
      "organizations_url": "https://api.github.com/users/simnalamburt/orgs",
      "repos_url": "https://api.github.com/users/simnalamburt/repos",
      "events_url": "https://api.github.com/users/simnalamburt/events{/privacy}",
      "received_events_url": "https://api.github.com/users/simnalamburt/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-01-04T21:59:40Z",
    "updated_at": "2017-05-09T21:24:47Z",
    "body": "I've got through [some little experiment](http://is.gd/FEN85F) and I _guess_ there's something wrong with `size_of::<T>()` for `f32x3` and other non-power-of-2 SIMD types.<!-- _(Don't trust me!)_ -->\r\n\r\n```\r\n                     | size_of | min_align_of | align_of | size_of >= min_align_of\r\n---------------------+---------+--------------+----------+-------------------------\r\n f32x3               |      12 |           16 |       16 | false\r\n f32x3_no_c          |      12 |           16 |       16 | false\r\n f32x3_no_simd       |      12 |            4 |        8 | true\r\n\r\n                     | size_of | min_align_of | align_of | size_of >= min_align_of\r\n---------------------+---------+--------------+----------+-------------------------\r\n u8                  |       1 |            1 |        1 | true\r\n OneByte             |       1 |            1 |        8 | true\r\n u16                 |       2 |            2 |        2 | true\r\n TwoByte             |       2 |            2 |        8 | true\r\n (u8, u16)           |       4 |            2 |        8 | true\r\n (u16, u8)           |       4 |            2 |        8 | true\r\n ThreeByte           |       4 |            2 |        8 | true\r\n (u32, u8)           |       8 |            4 |        8 | true\r\n FiveByte            |       8 |            4 |        8 | true\r\n (f32x3, u8)         |      32 |           16 |       16 | true\r\n (f32x3_no_simd, u8) |      16 |            4 |        8 | true\r\n```\r\n\r\nI think now we've got 2 available options.\r\n1.  Make `size_of T >= min_align_of T` always true even for non-power-of-2 SIMD types like `f32x3`.\r\n2.  Make `Vec<T>` function properly even for `size_of T < min_align_of T` situation.\r\n\r\nI'm pretty new with Rust. Someone pleaes make me an advise!\r\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/68651280/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/68652615",
    "html_url": "https://github.com/rust-lang/rust/issues/20460#issuecomment-68652615",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/20460",
    "id": 68652615,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY4NjUyNjE1",
    "user": {
      "login": "Aatch",
      "id": 342416,
      "node_id": "MDQ6VXNlcjM0MjQxNg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/342416?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Aatch",
      "html_url": "https://github.com/Aatch",
      "followers_url": "https://api.github.com/users/Aatch/followers",
      "following_url": "https://api.github.com/users/Aatch/following{/other_user}",
      "gists_url": "https://api.github.com/users/Aatch/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Aatch/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Aatch/subscriptions",
      "organizations_url": "https://api.github.com/users/Aatch/orgs",
      "repos_url": "https://api.github.com/users/Aatch/repos",
      "events_url": "https://api.github.com/users/Aatch/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Aatch/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-01-04T22:33:26Z",
    "updated_at": "2015-01-04T22:33:26Z",
    "body": "I'm not sure what the exact behaviour _should_ be. Part of the problem is that non-power-of-two SIMD types don't exist on most platforms, so it gets widened to whatever it needs to be. However, an f32x3 is still only 12 bytes of actual data.\n\nI think that Vec should handle the case anyway. Whether the case should come up... I don't really know.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/68652615/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/68652667",
    "html_url": "https://github.com/rust-lang/rust/issues/20460#issuecomment-68652667",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/20460",
    "id": 68652667,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY4NjUyNjY3",
    "user": {
      "login": "Diggsey",
      "id": 451321,
      "node_id": "MDQ6VXNlcjQ1MTMyMQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/451321?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Diggsey",
      "html_url": "https://github.com/Diggsey",
      "followers_url": "https://api.github.com/users/Diggsey/followers",
      "following_url": "https://api.github.com/users/Diggsey/following{/other_user}",
      "gists_url": "https://api.github.com/users/Diggsey/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Diggsey/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Diggsey/subscriptions",
      "organizations_url": "https://api.github.com/users/Diggsey/orgs",
      "repos_url": "https://api.github.com/users/Diggsey/repos",
      "events_url": "https://api.github.com/users/Diggsey/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Diggsey/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-01-04T22:34:41Z",
    "updated_at": "2015-01-04T22:34:41Z",
    "body": "Given that sizeof (f32x3, u32) == 32, it seems like rust already adds padding for SIMD types, so it's simply size_of that's broken, and should include the padding.\n\nAt the same time, Vec<T> should probably assert that size_of T >= min_align_of T to catch any errors if in the future there are any types where their size is less than their alignment.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/68652667/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/68652708",
    "html_url": "https://github.com/rust-lang/rust/issues/20460#issuecomment-68652708",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/20460",
    "id": 68652708,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY4NjUyNzA4",
    "user": {
      "login": "Gankra",
      "id": 1136864,
      "node_id": "MDQ6VXNlcjExMzY4NjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1136864?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Gankra",
      "html_url": "https://github.com/Gankra",
      "followers_url": "https://api.github.com/users/Gankra/followers",
      "following_url": "https://api.github.com/users/Gankra/following{/other_user}",
      "gists_url": "https://api.github.com/users/Gankra/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Gankra/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Gankra/subscriptions",
      "organizations_url": "https://api.github.com/users/Gankra/orgs",
      "repos_url": "https://api.github.com/users/Gankra/repos",
      "events_url": "https://api.github.com/users/Gankra/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Gankra/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-01-04T22:35:35Z",
    "updated_at": "2015-01-04T22:35:35Z",
    "body": "Nominating because the required change may be a back-compat change to some primitive semantics.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/68652708/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/68652900",
    "html_url": "https://github.com/rust-lang/rust/issues/20460#issuecomment-68652900",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/20460",
    "id": 68652900,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY4NjUyOTAw",
    "user": {
      "login": "Aatch",
      "id": 342416,
      "node_id": "MDQ6VXNlcjM0MjQxNg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/342416?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Aatch",
      "html_url": "https://github.com/Aatch",
      "followers_url": "https://api.github.com/users/Aatch/followers",
      "following_url": "https://api.github.com/users/Aatch/following{/other_user}",
      "gists_url": "https://api.github.com/users/Aatch/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Aatch/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Aatch/subscriptions",
      "organizations_url": "https://api.github.com/users/Aatch/orgs",
      "repos_url": "https://api.github.com/users/Aatch/repos",
      "events_url": "https://api.github.com/users/Aatch/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Aatch/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-01-04T22:40:21Z",
    "updated_at": "2015-01-04T22:40:21Z",
    "body": "Actually, thinking about it some more. I believe that the current behaviour is correct. `size_of` doesn't account for padding, because padding is situation-dependent: `(i8, u64)` has 7 bytes of padding after the `i8`, but that doesn't stop `i8` from being 1 byte in size. Just because the type gets padding, doesn't mean it needs to change size.\n\nThe whole point of having a different alignment to size is to cover these kinds of cases, where the number of usable bytes is not a nice integer multiple of the alignment.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/68652900/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/68653141",
    "html_url": "https://github.com/rust-lang/rust/issues/20460#issuecomment-68653141",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/20460",
    "id": 68653141,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY4NjUzMTQx",
    "user": {
      "login": "Diggsey",
      "id": 451321,
      "node_id": "MDQ6VXNlcjQ1MTMyMQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/451321?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Diggsey",
      "html_url": "https://github.com/Diggsey",
      "followers_url": "https://api.github.com/users/Diggsey/followers",
      "following_url": "https://api.github.com/users/Diggsey/following{/other_user}",
      "gists_url": "https://api.github.com/users/Diggsey/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Diggsey/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Diggsey/subscriptions",
      "organizations_url": "https://api.github.com/users/Diggsey/orgs",
      "repos_url": "https://api.github.com/users/Diggsey/repos",
      "events_url": "https://api.github.com/users/Diggsey/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Diggsey/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-01-04T22:47:26Z",
    "updated_at": "2015-01-04T23:06:32Z",
    "body": "@Aatch In that situation, the extra padding is added to meet the alignment requirements of \"u64\", not the \"i8\". In the SIMD example, the extra padding is part of the SIMD type.\nie. for (f32x3, u32) there are 4 bytes of padding between the fields, even though u32 only requires alignment to 4 bytes.\n\nEither the compiler should not add any padding and sizeof (f32x3, u32) == 16, and any accesses take care to preserve the u32 or as is more usual, the SIMD type should include it's padding.\n\nedit:\nTo clarify, types do include their padding in size_of, which is why size_of (u64, i8) == 16 as opposed to 9\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/68653141/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/68657250",
    "html_url": "https://github.com/rust-lang/rust/issues/20460#issuecomment-68657250",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/20460",
    "id": 68657250,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY4NjU3MjUw",
    "user": {
      "login": "Diggsey",
      "id": 451321,
      "node_id": "MDQ6VXNlcjQ1MTMyMQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/451321?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Diggsey",
      "html_url": "https://github.com/Diggsey",
      "followers_url": "https://api.github.com/users/Diggsey/followers",
      "following_url": "https://api.github.com/users/Diggsey/following{/other_user}",
      "gists_url": "https://api.github.com/users/Diggsey/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Diggsey/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Diggsey/subscriptions",
      "organizations_url": "https://api.github.com/users/Diggsey/orgs",
      "repos_url": "https://api.github.com/users/Diggsey/repos",
      "events_url": "https://api.github.com/users/Diggsey/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Diggsey/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-01-05T00:39:34Z",
    "updated_at": "2015-01-05T00:39:34Z",
    "body": "Amusingly, `struct Test(f32x3);` has a size of 16, whereas f32x3 on it's own has a size of 12, which really shouldn't happen.\n\nThe issue is caused by size_of being implemented as a call to this function:\nhttps://github.com/rust-lang/rust/blob/618bd5d1c550cbdaac369b01716cc009b9e4d1e7/src/librustc_trans/trans/machine.rs#L52\n\nThe comment above the function is wrong: LLVM does include padding when calculating the size of types, but only for structs (not for vectorised types), which makes that function fairly useless and definitely not the preferred option as the comment suggests. `llsize_of` should be preferred instead which always includes padding, so is at least consistent.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/68657250/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/68658351",
    "html_url": "https://github.com/rust-lang/rust/issues/20460#issuecomment-68658351",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/20460",
    "id": 68658351,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY4NjU4MzUx",
    "user": {
      "login": "huonw",
      "id": 1203825,
      "node_id": "MDQ6VXNlcjEyMDM4MjU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1203825?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/huonw",
      "html_url": "https://github.com/huonw",
      "followers_url": "https://api.github.com/users/huonw/followers",
      "following_url": "https://api.github.com/users/huonw/following{/other_user}",
      "gists_url": "https://api.github.com/users/huonw/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/huonw/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/huonw/subscriptions",
      "organizations_url": "https://api.github.com/users/huonw/orgs",
      "repos_url": "https://api.github.com/users/huonw/repos",
      "events_url": "https://api.github.com/users/huonw/events{/privacy}",
      "received_events_url": "https://api.github.com/users/huonw/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-01-05T01:07:56Z",
    "updated_at": "2015-01-05T01:07:56Z",
    "body": ">  Nominating because the required change may be a back-compat change to some primitive semantics.\n\nNB. `#[simd]` and `std::simd` are experimental and are highly unlikely to be stable at 1.0.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/68658351/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/68658809",
    "html_url": "https://github.com/rust-lang/rust/issues/20460#issuecomment-68658809",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/20460",
    "id": 68658809,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY4NjU4ODA5",
    "user": {
      "login": "simnalamburt",
      "id": 4435445,
      "node_id": "MDQ6VXNlcjQ0MzU0NDU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4435445?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/simnalamburt",
      "html_url": "https://github.com/simnalamburt",
      "followers_url": "https://api.github.com/users/simnalamburt/followers",
      "following_url": "https://api.github.com/users/simnalamburt/following{/other_user}",
      "gists_url": "https://api.github.com/users/simnalamburt/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/simnalamburt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/simnalamburt/subscriptions",
      "organizations_url": "https://api.github.com/users/simnalamburt/orgs",
      "repos_url": "https://api.github.com/users/simnalamburt/repos",
      "events_url": "https://api.github.com/users/simnalamburt/events{/privacy}",
      "received_events_url": "https://api.github.com/users/simnalamburt/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-01-05T01:20:32Z",
    "updated_at": "2015-04-25T15:12:19Z",
    "body": "Current `librustc` works like below:\n\n``` rust\nsize_of::<T>() = ceil(LLVMSizeOfTypeInBits() / 8)\nmin_align_of::<T>() = LLVMABIAlignmentOfType()\n```\n\nand I found that current LLVM doesn't have any guarantee between `LLVMSizeOfTypeInBits` and `LLVMABIAlignmentOfType`. Instead, for SIMD vector types, `LLVMABIAlignmentOfType` is **guaranteed to be greater or equal** than `LLVMSizeOfTypeInBits / 8`. [Look at this.](https://github.com/rust-lang/llvm/blob/ec1fdb3b9d3b1fb9e1dae97a65dd3a13db9bfb23/lib/IR/DataLayout.cpp#L457)\n\nFor example, `LLVMSizeOfTypeInBits` and `LLVMABIAlignmentOfType` of 80-bit floating point format is `80` and `16`. I know that Rust doesn't have `f80` but if it does, `size_of::<f80>()` will be `10` and `min_align_of::<f80>()` will be `16`. Which means `Vec<f80>` would have same problem.\n\nNow I see 2 options here\n1. Make `size_of::<T>()` call `llsize_of`, not `llsize_of_real` (as @Diggsey said)\n2. Make `Vec<T>` function properly even for `size_of T < min_align_of T` situation.\n\n###### References\n- [size_of](https://github.com/rust-lang/rust/blob/master/src/librustc_trans/trans/intrinsic.rs#L311-L315) \u2192 [llsize_of_real](https://github.com/rust-lang/rust/blob/master/src/librustc_trans/trans/machine.rs#L52-L62) \u2192 [LLVMSizeOfTypeInBits](http://llvm.org/docs/doxygen/html/group__LLVMCTarget.html#gaa29cd97b498d32b9c5663574bd2659d7) \u2192 [llvm::DataLayout::getTypeSizeInBits](https://github.com/rust-lang/llvm/blob/ec1fdb3b9d3b1fb9e1dae97a65dd3a13db9bfb23/include/llvm/IR/DataLayout.h#L521)\n- [llsize_of](https://github.com/rust-lang/rust/blob/master/src/librustc_trans/trans/machine.rs#L72) \u2192 [llsize_of_alloc](https://github.com/rust-lang/rust/blob/master/src/librustc_trans/trans/machine.rs#L38) \u2192 [LLVMABISizeOfType](http://llvm.org/docs/doxygen/html/group__LLVMCTarget.html#gac457451d818eb0bf7c2f30fe2683536f) \u2192 [llvm::DataLayout::getTypeAllocSize](https://github.com/rust-lang/llvm/blob/ec1fdb3b9d3b1fb9e1dae97a65dd3a13db9bfb23/include/llvm/IR/DataLayout.h#L370)\n- [min_align_of](https://github.com/rust-lang/rust/blob/master/src/librustc_trans/trans/intrinsic.rs#L316-L319) \u2192 align_of \u2192 [llalign_of_min](https://github.com/rust-lang/rust/blob/master/src/librustc_trans/trans/machine.rs#L107-L111) \u2192 [LLVMABIAlignmentOfType](http://llvm.org/docs/doxygen/html/group__LLVMCTarget.html#ga474ae58c596b5cb5c197a3f540479135) \u2192 [llvm::DataLayout::getABITypeAlignment](https://github.com/rust-lang/llvm/blob/ec1fdb3b9d3b1fb9e1dae97a65dd3a13db9bfb23/lib/IR/DataLayout.cpp#L687-L689) \u2192 [llvm::DataLayout::getAlignment](https://github.com/rust-lang/llvm/blob/ec1fdb3b9d3b1fb9e1dae97a65dd3a13db9bfb23/lib/IR/DataLayout.cpp#L633) \u2192 [llvm::DataLayout::getAlignmentInfo](https://github.com/rust-lang/llvm/blob/ec1fdb3b9d3b1fb9e1dae97a65dd3a13db9bfb23/lib/IR/DataLayout.cpp#L414)\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/68658809/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/68659111",
    "html_url": "https://github.com/rust-lang/rust/issues/20460#issuecomment-68659111",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/20460",
    "id": 68659111,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY4NjU5MTEx",
    "user": {
      "login": "Gankra",
      "id": 1136864,
      "node_id": "MDQ6VXNlcjExMzY4NjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1136864?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Gankra",
      "html_url": "https://github.com/Gankra",
      "followers_url": "https://api.github.com/users/Gankra/followers",
      "following_url": "https://api.github.com/users/Gankra/following{/other_user}",
      "gists_url": "https://api.github.com/users/Gankra/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Gankra/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Gankra/subscriptions",
      "organizations_url": "https://api.github.com/users/Gankra/orgs",
      "repos_url": "https://api.github.com/users/Gankra/repos",
      "events_url": "https://api.github.com/users/Gankra/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Gankra/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-01-05T01:28:32Z",
    "updated_at": "2015-01-05T01:28:32Z",
    "body": "@huonw I meant more-so the size_of semantics, but simd semantics might also be affected.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/68659111/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/68684330",
    "html_url": "https://github.com/rust-lang/rust/issues/20460#issuecomment-68684330",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/20460",
    "id": 68684330,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY4Njg0MzMw",
    "user": {
      "login": "thestinger",
      "id": 1505226,
      "node_id": "MDQ6VXNlcjE1MDUyMjY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1505226?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/thestinger",
      "html_url": "https://github.com/thestinger",
      "followers_url": "https://api.github.com/users/thestinger/followers",
      "following_url": "https://api.github.com/users/thestinger/following{/other_user}",
      "gists_url": "https://api.github.com/users/thestinger/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/thestinger/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/thestinger/subscriptions",
      "organizations_url": "https://api.github.com/users/thestinger/orgs",
      "repos_url": "https://api.github.com/users/thestinger/repos",
      "events_url": "https://api.github.com/users/thestinger/events{/privacy}",
      "received_events_url": "https://api.github.com/users/thestinger/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-01-05T09:23:41Z",
    "updated_at": "2015-01-05T09:23:41Z",
    "body": "I think this is a compiler bug. There are many low-level APIs assuming that size is a multiple of the alignment...\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/68684330/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/68684466",
    "html_url": "https://github.com/rust-lang/rust/issues/20460#issuecomment-68684466",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/20460",
    "id": 68684466,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY4Njg0NDY2",
    "user": {
      "login": "thestinger",
      "id": 1505226,
      "node_id": "MDQ6VXNlcjE1MDUyMjY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1505226?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/thestinger",
      "html_url": "https://github.com/thestinger",
      "followers_url": "https://api.github.com/users/thestinger/followers",
      "following_url": "https://api.github.com/users/thestinger/following{/other_user}",
      "gists_url": "https://api.github.com/users/thestinger/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/thestinger/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/thestinger/subscriptions",
      "organizations_url": "https://api.github.com/users/thestinger/orgs",
      "repos_url": "https://api.github.com/users/thestinger/repos",
      "events_url": "https://api.github.com/users/thestinger/events{/privacy}",
      "received_events_url": "https://api.github.com/users/thestinger/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-01-05T09:25:12Z",
    "updated_at": "2015-01-05T09:25:12Z",
    "body": "For example, C11's `aligned_alloc` function requires that `size` is a multiple of the `alignment` parameter. It's expected that the compiler will always output sane values for both (unlike `rustc` :P) so it is a sensible limitation.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/68684466/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/68810497",
    "html_url": "https://github.com/rust-lang/rust/issues/20460#issuecomment-68810497",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/20460",
    "id": 68810497,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY4ODEwNDk3",
    "user": {
      "login": "gereeter",
      "id": 2328242,
      "node_id": "MDQ6VXNlcjIzMjgyNDI=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2328242?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gereeter",
      "html_url": "https://github.com/gereeter",
      "followers_url": "https://api.github.com/users/gereeter/followers",
      "following_url": "https://api.github.com/users/gereeter/following{/other_user}",
      "gists_url": "https://api.github.com/users/gereeter/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gereeter/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gereeter/subscriptions",
      "organizations_url": "https://api.github.com/users/gereeter/orgs",
      "repos_url": "https://api.github.com/users/gereeter/repos",
      "events_url": "https://api.github.com/users/gereeter/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gereeter/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-01-06T01:00:46Z",
    "updated_at": "2015-01-06T01:00:46Z",
    "body": "Unfortunately, forcing `size_of` to return a multiple of `min_align_of` would make #17027 impossible, which seems like a big missed opportunity. Perhaps there should be a `padded_size_of` function that just rounds `size_of` to the next multiple of `min_align_of`?\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/68810497/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/68812389",
    "html_url": "https://github.com/rust-lang/rust/issues/20460#issuecomment-68812389",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/20460",
    "id": 68812389,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY4ODEyMzg5",
    "user": {
      "login": "Diggsey",
      "id": 451321,
      "node_id": "MDQ6VXNlcjQ1MTMyMQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/451321?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Diggsey",
      "html_url": "https://github.com/Diggsey",
      "followers_url": "https://api.github.com/users/Diggsey/followers",
      "following_url": "https://api.github.com/users/Diggsey/following{/other_user}",
      "gists_url": "https://api.github.com/users/Diggsey/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Diggsey/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Diggsey/subscriptions",
      "organizations_url": "https://api.github.com/users/Diggsey/orgs",
      "repos_url": "https://api.github.com/users/Diggsey/repos",
      "events_url": "https://api.github.com/users/Diggsey/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Diggsey/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-01-06T01:22:28Z",
    "updated_at": "2015-01-06T01:22:28Z",
    "body": "@greeter\nYou could have both size_of and padded_size_of, but for the moment, they'd both have to include padding because for struct types LLVM provides no way to get the size without padding, and for vectorised types, even size_of should include padding as #17027 can't be applied to vectorised types without masking every load/store to avoid overwriting the u32 in (f32x3, u32).\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/68812389/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/68813737",
    "html_url": "https://github.com/rust-lang/rust/issues/20460#issuecomment-68813737",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/20460",
    "id": 68813737,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY4ODEzNzM3",
    "user": {
      "login": "simnalamburt",
      "id": 4435445,
      "node_id": "MDQ6VXNlcjQ0MzU0NDU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4435445?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/simnalamburt",
      "html_url": "https://github.com/simnalamburt",
      "followers_url": "https://api.github.com/users/simnalamburt/followers",
      "following_url": "https://api.github.com/users/simnalamburt/following{/other_user}",
      "gists_url": "https://api.github.com/users/simnalamburt/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/simnalamburt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/simnalamburt/subscriptions",
      "organizations_url": "https://api.github.com/users/simnalamburt/orgs",
      "repos_url": "https://api.github.com/users/simnalamburt/repos",
      "events_url": "https://api.github.com/users/simnalamburt/events{/privacy}",
      "received_events_url": "https://api.github.com/users/simnalamburt/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-01-06T01:39:21Z",
    "updated_at": "2016-03-23T15:23:11Z",
    "body": "Currently I'm testing https://github.com/rust-lang/rust/commit/e4c20db7766606391b3d2ba515459269f6315d9e, and it seems to cause no trouble. Please make me an advise if I'm doing something wrong.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/68813737/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/68829310",
    "html_url": "https://github.com/rust-lang/rust/issues/20460#issuecomment-68829310",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/20460",
    "id": 68829310,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY4ODI5MzEw",
    "user": {
      "login": "simnalamburt",
      "id": 4435445,
      "node_id": "MDQ6VXNlcjQ0MzU0NDU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4435445?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/simnalamburt",
      "html_url": "https://github.com/simnalamburt",
      "followers_url": "https://api.github.com/users/simnalamburt/followers",
      "following_url": "https://api.github.com/users/simnalamburt/following{/other_user}",
      "gists_url": "https://api.github.com/users/simnalamburt/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/simnalamburt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/simnalamburt/subscriptions",
      "organizations_url": "https://api.github.com/users/simnalamburt/orgs",
      "repos_url": "https://api.github.com/users/simnalamburt/repos",
      "events_url": "https://api.github.com/users/simnalamburt/events{/privacy}",
      "received_events_url": "https://api.github.com/users/simnalamburt/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-01-06T05:53:12Z",
    "updated_at": "2015-01-06T05:53:12Z",
    "body": "OK Let's do this \u2192 https://github.com/rust-lang/rust/pull/20611\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/68829310/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
