[
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/26880174",
    "html_url": "https://github.com/rust-lang/rust/issues/10025#issuecomment-26880174",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10025",
    "id": 26880174,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI2ODgwMTc0",
    "user": {
      "login": "alexcrichton",
      "id": 64996,
      "node_id": "MDQ6VXNlcjY0OTk2",
      "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alexcrichton",
      "html_url": "https://github.com/alexcrichton",
      "followers_url": "https://api.github.com/users/alexcrichton/followers",
      "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}",
      "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions",
      "organizations_url": "https://api.github.com/users/alexcrichton/orgs",
      "repos_url": "https://api.github.com/users/alexcrichton/repos",
      "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alexcrichton/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2013-10-23T04:36:11Z",
    "updated_at": "2013-10-23T04:36:11Z",
    "body": "I don't quite understand how this breaks memory safety, you explicitly have an `unsafe` block meaning that it's up to you to guarantee safety (which doesn't happen in this code). It also makes sense to me that you can write an `extern \"C\"` function which is indeed safe, you don't necessarily have to force the function to always be unsafe.\n\nIt seems like a bug that you can't declare an `extern unsafe` function, but other than that I'm not sure that there's a problem here.\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/26880174/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/26933306",
    "html_url": "https://github.com/rust-lang/rust/issues/10025#issuecomment-26933306",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10025",
    "id": 26933306,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI2OTMzMzA2",
    "user": {
      "login": "kmcallister",
      "id": 444997,
      "node_id": "MDQ6VXNlcjQ0NDk5Nw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/444997?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/kmcallister",
      "html_url": "https://github.com/kmcallister",
      "followers_url": "https://api.github.com/users/kmcallister/followers",
      "following_url": "https://api.github.com/users/kmcallister/following{/other_user}",
      "gists_url": "https://api.github.com/users/kmcallister/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/kmcallister/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kmcallister/subscriptions",
      "organizations_url": "https://api.github.com/users/kmcallister/orgs",
      "repos_url": "https://api.github.com/users/kmcallister/repos",
      "events_url": "https://api.github.com/users/kmcallister/events{/privacy}",
      "received_events_url": "https://api.github.com/users/kmcallister/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2013-10-23T18:42:34Z",
    "updated_at": "2013-10-23T18:42:34Z",
    "body": "Right, the bug is that I can't declare a function to be called from C, without allowing safe Rust code to call it too.\n\nThe memory unsafety results from the workaround of declaring a safe `extern \"C\"` function and using an `unsafe` block.  I can't satisfy the proof obligation of the `unsafe` block, but there is no other way to write the function.\n\nI agree that you should be able to declare safe `extern \"C\"` functions too.  But if all `extern \"C\"` functions were automatically `unsafe` then it would at least solve my problem, which is why I included an example to show that isn't the case.\n\n(This came up when I was defining `memset` in Rust, to satisfy `memset` calls emitted by rustc/LLVM, in a no-libc environment. I don't want to let safe Rust code call that `memset` too.)\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/26933306/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/26960335",
    "html_url": "https://github.com/rust-lang/rust/issues/10025#issuecomment-26960335",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10025",
    "id": 26960335,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI2OTYwMzM1",
    "user": {
      "login": "brson",
      "id": 147214,
      "node_id": "MDQ6VXNlcjE0NzIxNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/brson",
      "html_url": "https://github.com/brson",
      "followers_url": "https://api.github.com/users/brson/followers",
      "following_url": "https://api.github.com/users/brson/following{/other_user}",
      "gists_url": "https://api.github.com/users/brson/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/brson/subscriptions",
      "organizations_url": "https://api.github.com/users/brson/orgs",
      "repos_url": "https://api.github.com/users/brson/repos",
      "events_url": "https://api.github.com/users/brson/events{/privacy}",
      "received_events_url": "https://api.github.com/users/brson/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2013-10-24T01:27:39Z",
    "updated_at": "2013-10-24T01:27:39Z",
    "body": "There seems to be a discrepancy between extern \"C\" fns defined in Rust and those that bind to native functions. The latter are supposed to be unsafe by default, and since they're the same type, so should the former.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/26960335/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/26960343",
    "html_url": "https://github.com/rust-lang/rust/issues/10025#issuecomment-26960343",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10025",
    "id": 26960343,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI2OTYwMzQz",
    "user": {
      "login": "brson",
      "id": 147214,
      "node_id": "MDQ6VXNlcjE0NzIxNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/brson",
      "html_url": "https://github.com/brson",
      "followers_url": "https://api.github.com/users/brson/followers",
      "following_url": "https://api.github.com/users/brson/following{/other_user}",
      "gists_url": "https://api.github.com/users/brson/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/brson/subscriptions",
      "organizations_url": "https://api.github.com/users/brson/orgs",
      "repos_url": "https://api.github.com/users/brson/repos",
      "events_url": "https://api.github.com/users/brson/events{/privacy}",
      "received_events_url": "https://api.github.com/users/brson/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2013-10-24T01:27:57Z",
    "updated_at": "2013-10-24T01:27:57Z",
    "body": "Nominating.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/26960343/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/26978937",
    "html_url": "https://github.com/rust-lang/rust/issues/10025#issuecomment-26978937",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10025",
    "id": 26978937,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI2OTc4OTM3",
    "user": {
      "login": "nikomatsakis",
      "id": 155238,
      "node_id": "MDQ6VXNlcjE1NTIzOA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/155238?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nikomatsakis",
      "html_url": "https://github.com/nikomatsakis",
      "followers_url": "https://api.github.com/users/nikomatsakis/followers",
      "following_url": "https://api.github.com/users/nikomatsakis/following{/other_user}",
      "gists_url": "https://api.github.com/users/nikomatsakis/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nikomatsakis/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nikomatsakis/subscriptions",
      "organizations_url": "https://api.github.com/users/nikomatsakis/orgs",
      "repos_url": "https://api.github.com/users/nikomatsakis/repos",
      "events_url": "https://api.github.com/users/nikomatsakis/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nikomatsakis/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2013-10-24T09:43:23Z",
    "updated_at": "2013-10-24T09:43:23Z",
    "body": "Hmm. It seems to me that for maximum precision, we would set it up like so:\n1. functions declared in an extern block should have the type `unsafe extern \"C\" fn()`.\n2. Rust functions declared with `extern` would have the type `extern \"C\" fn()`.\n3. Rust functions can be declared unsafe as well as extern.\n4. Calling a bare fn is unsafe iff it is unsafe, and does not consider the ABI.\n\nThe only downside of this I can see is that the type of C functions is cumbersome. Note that the type system is mostly setup this way (that is, types like `unsafe extern \"C\" fn` exist) so it shouldn't be too hard to get it into this state.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/26978937/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/27012682",
    "html_url": "https://github.com/rust-lang/rust/issues/10025#issuecomment-27012682",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10025",
    "id": 27012682,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3MDEyNjgy",
    "user": {
      "login": "catamorphism",
      "id": 427212,
      "node_id": "MDQ6VXNlcjQyNzIxMg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/427212?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/catamorphism",
      "html_url": "https://github.com/catamorphism",
      "followers_url": "https://api.github.com/users/catamorphism/followers",
      "following_url": "https://api.github.com/users/catamorphism/following{/other_user}",
      "gists_url": "https://api.github.com/users/catamorphism/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/catamorphism/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/catamorphism/subscriptions",
      "organizations_url": "https://api.github.com/users/catamorphism/orgs",
      "repos_url": "https://api.github.com/users/catamorphism/repos",
      "events_url": "https://api.github.com/users/catamorphism/events{/privacy}",
      "received_events_url": "https://api.github.com/users/catamorphism/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2013-10-24T17:31:21Z",
    "updated_at": "2013-10-24T17:31:31Z",
    "body": "1.0, backwards-compat\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/27012682/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/29838244",
    "html_url": "https://github.com/rust-lang/rust/issues/10025#issuecomment-29838244",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10025",
    "id": 29838244,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI5ODM4MjQ0",
    "user": {
      "login": "lilyball",
      "id": 714,
      "node_id": "MDQ6VXNlcjcxNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/714?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/lilyball",
      "html_url": "https://github.com/lilyball",
      "followers_url": "https://api.github.com/users/lilyball/followers",
      "following_url": "https://api.github.com/users/lilyball/following{/other_user}",
      "gists_url": "https://api.github.com/users/lilyball/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/lilyball/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/lilyball/subscriptions",
      "organizations_url": "https://api.github.com/users/lilyball/orgs",
      "repos_url": "https://api.github.com/users/lilyball/repos",
      "events_url": "https://api.github.com/users/lilyball/events{/privacy}",
      "received_events_url": "https://api.github.com/users/lilyball/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2013-12-04T19:45:47Z",
    "updated_at": "2013-12-04T19:45:47Z",
    "body": "I just ran into this. I agree with @nikomatsakis's analysis. The type of C functions may be cumbersome, but nobody declaring an FFI function would have to type `unsafe extern \"C\" fn()`. The only time anyone should have to type that is when they're implementing an `extern \"C\"` function Rust that needs to be unsafe.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/29838244/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
