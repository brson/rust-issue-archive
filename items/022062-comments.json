[
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/73385483",
    "html_url": "https://github.com/rust-lang/rust/issues/22062#issuecomment-73385483",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/22062",
    "id": 73385483,
    "node_id": "MDEyOklzc3VlQ29tbWVudDczMzg1NDgz",
    "user": {
      "login": "gliptic",
      "id": 44585,
      "node_id": "MDQ6VXNlcjQ0NTg1",
      "avatar_url": "https://avatars.githubusercontent.com/u/44585?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gliptic",
      "html_url": "https://github.com/gliptic",
      "followers_url": "https://api.github.com/users/gliptic/followers",
      "following_url": "https://api.github.com/users/gliptic/following{/other_user}",
      "gists_url": "https://api.github.com/users/gliptic/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gliptic/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gliptic/subscriptions",
      "organizations_url": "https://api.github.com/users/gliptic/orgs",
      "repos_url": "https://api.github.com/users/gliptic/repos",
      "events_url": "https://api.github.com/users/gliptic/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gliptic/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-02-07T22:06:43Z",
    "updated_at": "2015-02-07T22:06:43Z",
    "body": "I hit an ICE trying to make sense of this:\n\n``` rust\nuse std::ops::{Deref, DerefMut};\nuse std::ptr;\n\nstruct F<'a> {\n    x: &'a mut i32\n}\n\nimpl<'a> Deref for F<'a> {\n    type Target = i32;\n\n    fn deref<'b>(&'b self) -> &'b i32 {\n        self.x\n    }\n}\n\nimpl<'a> DerefMut for F<'a> {\n    fn deref_mut<'b>(&'b mut self) -> &'b mut i32 {\n        self.x\n    }\n}\n\nstruct Foo<T>\n    where T: DerefMut\n{\n   member: *mut <T as DerefMut>::Target,\n}\n\ntrait Bar<T>\n    where T: 'static + DerefMut\n{\n    fn foo<'a>(&'a self) -> &'a Foo<T>;\n\n    fn member<'a>(&'a self) -> &'a *mut <T as DerefMut>::Target {\n        let x = self.foo();\n        &x.member\n    }\n}\n\nstruct FooContainer<T> where T: 'static + DerefMut {\n    foo: Foo<T>\n}\n\nimpl<T> Bar<T> for FooContainer<T> where T: 'static + DerefMut {\n    fn foo<'a>(&'a self) -> &'a Foo<T> {\n        &self.foo\n    }\n}\n\nfn main() {\n    let foocontainer: FooContainer<F> = FooContainer { foo: Foo { member: ptr::null_mut() } };\n}\n```\n\n```\n<anon>:50:9: 50:21 warning: unused variable: `foocontainer`, #[warn(unused_variables)] on by default\n<anon>:50     let foocontainer: FooContainer<F> = FooContainer { foo: Foo { member: ptr::null_mut() } };\n                  ^~~~~~~~~~~~\nerror: internal compiler error: type_of with ty_err\nnote: the compiler unexpectedly panicked. this is a bug.\nnote: we would appreciate a bug report: http://doc.rust-lang.org/complement-bugreport.html\nnote: run with `RUST_BACKTRACE=1` for a backtrace\nthread 'rustc' panicked at 'Box<Any>', /home/rustbuild/src/rust-buildbot/slave/nightly-dist-rustc-linux/build/src/libsyntax/diagnostic.rs:189\n```\n",
    "author_association": "NONE",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/73385483/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/94989265",
    "html_url": "https://github.com/rust-lang/rust/issues/22062#issuecomment-94989265",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/22062",
    "id": 94989265,
    "node_id": "MDEyOklzc3VlQ29tbWVudDk0OTg5MjY1",
    "user": {
      "login": "tamird",
      "id": 1535036,
      "node_id": "MDQ6VXNlcjE1MzUwMzY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1535036?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/tamird",
      "html_url": "https://github.com/tamird",
      "followers_url": "https://api.github.com/users/tamird/followers",
      "following_url": "https://api.github.com/users/tamird/following{/other_user}",
      "gists_url": "https://api.github.com/users/tamird/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/tamird/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/tamird/subscriptions",
      "organizations_url": "https://api.github.com/users/tamird/orgs",
      "repos_url": "https://api.github.com/users/tamird/repos",
      "events_url": "https://api.github.com/users/tamird/events{/privacy}",
      "received_events_url": "https://api.github.com/users/tamird/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-04-22T01:06:40Z",
    "updated_at": "2015-04-22T01:06:40Z",
    "body": "The ICE example no longer compiles:\n\n``` shell\n$ rustc main.rs\nmain.rs:25:17: 25:40 error: use of undeclared associated type `DerefMut::Target`\nmain.rs:25    member: *mut <T as DerefMut>::Target,\n                           ^~~~~~~~~~~~~~~~~~~~~~~\nmain.rs:33:41: 33:64 error: use of undeclared associated type `DerefMut::Target`\nmain.rs:33     fn member<'a>(&'a self) -> &'a *mut <T as DerefMut>::Target {\n                                                   ^~~~~~~~~~~~~~~~~~~~~~~\nerror: aborting due to 2 previous errors\n```\n\nSame goes for the original example:\n\n``` shell\n$ rustc main.rs\nmain.rs:6:16: 6:39 error: use of undeclared associated type `DerefMut::Target`\nmain.rs:6   member: *mut <T as DerefMut>::Target,\n                         ^~~~~~~~~~~~~~~~~~~~~~~\nmain.rs:13:39: 13:62 error: use of undeclared associated type `DerefMut::Target`\nmain.rs:13   fn member<'a>(&'a self) -> &'a *mut <T as DerefMut>::Target {\n                                                 ^~~~~~~~~~~~~~~~~~~~~~~\nerror: aborting due to 2 previous errors\n```\n\n@dschatzberg can you update this?\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/94989265/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/95208068",
    "html_url": "https://github.com/rust-lang/rust/issues/22062#issuecomment-95208068",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/22062",
    "id": 95208068,
    "node_id": "MDEyOklzc3VlQ29tbWVudDk1MjA4MDY4",
    "user": {
      "login": "dschatzberg",
      "id": 165988,
      "node_id": "MDQ6VXNlcjE2NTk4OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/165988?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dschatzberg",
      "html_url": "https://github.com/dschatzberg",
      "followers_url": "https://api.github.com/users/dschatzberg/followers",
      "following_url": "https://api.github.com/users/dschatzberg/following{/other_user}",
      "gists_url": "https://api.github.com/users/dschatzberg/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dschatzberg/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dschatzberg/subscriptions",
      "organizations_url": "https://api.github.com/users/dschatzberg/orgs",
      "repos_url": "https://api.github.com/users/dschatzberg/repos",
      "events_url": "https://api.github.com/users/dschatzberg/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dschatzberg/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-04-22T14:32:11Z",
    "updated_at": "2015-04-22T14:32:31Z",
    "body": "I wrote the original example. It can be updated by just making `<T as DerefMut>` into `T`\n\n```\nuse std::ops::DerefMut;\n\nstruct Foo<T>\nwhere T: DerefMut\n{\n  member: *mut T::Target,\n}\n\ntrait Bar<T>\nwhere T: DerefMut\n{\n  fn foo<'a>(&'a self) -> &'a Foo<T>;\n  fn member<'a>(&'a self) -> &'a *mut T::Target {\n    &self.foo().member\n  }\n}\n```\n\nThe ICE example can probably be fixed the same way but it is not my code\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/95208068/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/95209325",
    "html_url": "https://github.com/rust-lang/rust/issues/22062#issuecomment-95209325",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/22062",
    "id": 95209325,
    "node_id": "MDEyOklzc3VlQ29tbWVudDk1MjA5MzI1",
    "user": {
      "login": "tamird",
      "id": 1535036,
      "node_id": "MDQ6VXNlcjE1MzUwMzY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1535036?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/tamird",
      "html_url": "https://github.com/tamird",
      "followers_url": "https://api.github.com/users/tamird/followers",
      "following_url": "https://api.github.com/users/tamird/following{/other_user}",
      "gists_url": "https://api.github.com/users/tamird/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/tamird/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/tamird/subscriptions",
      "organizations_url": "https://api.github.com/users/tamird/orgs",
      "repos_url": "https://api.github.com/users/tamird/repos",
      "events_url": "https://api.github.com/users/tamird/events{/privacy}",
      "received_events_url": "https://api.github.com/users/tamird/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-04-22T14:34:58Z",
    "updated_at": "2015-04-22T14:34:58Z",
    "body": "Ah, thanks. The ICE example no longer ICEs:\n\n``` rust\nuse std::ops::{Deref, DerefMut};\nuse std::ptr;\n\nstruct F<'a> {\n    x: &'a mut i32\n}\n\nimpl<'a> Deref for F<'a> {\n    type Target = i32;\n\n    fn deref<'b>(&'b self) -> &'b i32 {\n        self.x\n    }\n}\n\nimpl<'a> DerefMut for F<'a> {\n    fn deref_mut<'b>(&'b mut self) -> &'b mut i32 {\n        self.x\n    }\n}\n\nstruct Foo<T>\n    where T: DerefMut\n{\n   member: *mut T::Target,\n}\n\ntrait Bar<T>\n    where T: 'static + DerefMut\n{\n    fn foo<'a>(&'a self) -> &'a Foo<T>;\n\n    fn member<'a>(&'a self) -> &'a *mut T::Target {\n        let x = self.foo();\n        &x.member\n    }\n}\n\nstruct FooContainer<T> where T: 'static + DerefMut {\n    foo: Foo<T>\n}\n\nimpl<T> Bar<T> for FooContainer<T> where T: 'static + DerefMut {\n    fn foo<'a>(&'a self) -> &'a Foo<T> {\n        &self.foo\n    }\n}\n\nfn main() {\n    let foocontainer: FooContainer<F> = FooContainer { foo: Foo { member: ptr::null_mut() } };\n}\n```\n\n``` shell\n$ rustc main.rs\nmain.rs:50:9: 50:21 warning: unused variable: `foocontainer`, #[warn(unused_variables)] on by default\nmain.rs:50     let foocontainer: FooContainer<F> = FooContainer { foo: Foo { member: ptr::null_mut() } };\n                   ^~~~~~~~~~~~\n$ echo $?\n0\n```\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/95209325/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/95211956",
    "html_url": "https://github.com/rust-lang/rust/issues/22062#issuecomment-95211956",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/22062",
    "id": 95211956,
    "node_id": "MDEyOklzc3VlQ29tbWVudDk1MjExOTU2",
    "user": {
      "login": "dschatzberg",
      "id": 165988,
      "node_id": "MDQ6VXNlcjE2NTk4OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/165988?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dschatzberg",
      "html_url": "https://github.com/dschatzberg",
      "followers_url": "https://api.github.com/users/dschatzberg/followers",
      "following_url": "https://api.github.com/users/dschatzberg/following{/other_user}",
      "gists_url": "https://api.github.com/users/dschatzberg/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dschatzberg/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dschatzberg/subscriptions",
      "organizations_url": "https://api.github.com/users/dschatzberg/orgs",
      "repos_url": "https://api.github.com/users/dschatzberg/repos",
      "events_url": "https://api.github.com/users/dschatzberg/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dschatzberg/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-04-22T14:38:21Z",
    "updated_at": "2015-04-22T14:38:21Z",
    "body": "To be clear my original issue still remains. Logically I don't see why I should have to specify a bound on T to use a reference to T::Target\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/95211956/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/95263527",
    "html_url": "https://github.com/rust-lang/rust/issues/22062#issuecomment-95263527",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/22062",
    "id": 95263527,
    "node_id": "MDEyOklzc3VlQ29tbWVudDk1MjYzNTI3",
    "user": {
      "login": "tamird",
      "id": 1535036,
      "node_id": "MDQ6VXNlcjE1MzUwMzY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1535036?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/tamird",
      "html_url": "https://github.com/tamird",
      "followers_url": "https://api.github.com/users/tamird/followers",
      "following_url": "https://api.github.com/users/tamird/following{/other_user}",
      "gists_url": "https://api.github.com/users/tamird/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/tamird/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/tamird/subscriptions",
      "organizations_url": "https://api.github.com/users/tamird/orgs",
      "repos_url": "https://api.github.com/users/tamird/repos",
      "events_url": "https://api.github.com/users/tamird/events{/privacy}",
      "received_events_url": "https://api.github.com/users/tamird/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-04-22T16:57:32Z",
    "updated_at": "2015-04-22T16:57:32Z",
    "body": "@steveklabnik could you remove the I-ICE?\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/95263527/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/263670429",
    "html_url": "https://github.com/rust-lang/rust/issues/22062#issuecomment-263670429",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/22062",
    "id": 263670429,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI2MzY3MDQyOQ==",
    "user": {
      "login": "steveklabnik",
      "id": 27786,
      "node_id": "MDQ6VXNlcjI3Nzg2",
      "avatar_url": "https://avatars.githubusercontent.com/u/27786?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/steveklabnik",
      "html_url": "https://github.com/steveklabnik",
      "followers_url": "https://api.github.com/users/steveklabnik/followers",
      "following_url": "https://api.github.com/users/steveklabnik/following{/other_user}",
      "gists_url": "https://api.github.com/users/steveklabnik/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/steveklabnik/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/steveklabnik/subscriptions",
      "organizations_url": "https://api.github.com/users/steveklabnik/orgs",
      "repos_url": "https://api.github.com/users/steveklabnik/repos",
      "events_url": "https://api.github.com/users/steveklabnik/events{/privacy}",
      "received_events_url": "https://api.github.com/users/steveklabnik/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2016-11-29T19:21:24Z",
    "updated_at": "2016-11-29T19:21:24Z",
    "body": "Today, the original code errors, but in a different way.\r\n\r\n```\r\nerror[E0412]: associated type `DerefMut::Target` is undefined or not in scope\r\n --> src\\lib.rs:6:16\r\n  |\r\n6 |   member: *mut <T as DerefMut>::Target,\r\n  |                ^^^^^^^^^^^^^^^^^^^^^^^ undefined or not in scope\r\n  |\r\n  = help: no candidates by the name of `Target` found in your project; maybe you misspelled the name or forgot to import an external crate?\r\n\r\nerror[E0412]: associated type `DerefMut::Target` is undefined or not in scope\r\n  --> src\\lib.rs:13:39\r\n   |\r\n13 |   fn member<'a>(&'a self) -> &'a *mut <T as DerefMut>::Target {\r\n   |                                       ^^^^^^^^^^^^^^^^^^^^^^^ undefined or not in scope\r\n   |\r\n   = help: no candidates by the name of `Target` found in your project; maybe you misspelled the name or forgot to import an external crate?\r\n\r\nerror[E0392]: parameter `T` is never used\r\n --> src\\lib.rs:3:12\r\n  |\r\n3 | struct Foo<T>\r\n  |            ^ unused type parameter\r\n  |\r\n  = help: consider removing `T` or using a marker such as `std::marker::PhantomData`\r\n\r\nerror: aborting due to previous error\r\n```\r\n\r\nchanging to just `T`, instead:\r\n\r\n```\r\nerror[E0309]: the parameter type `T` may not live long enough\r\n  --> src\\lib.rs:14:11\r\n   |\r\n14 |     &self.foo().member\r\n   |           ^^^\r\n   |\r\n   = help: consider adding an explicit lifetime bound `T: 'a`...\r\nnote: ...so that the reference type `&Foo<T>` does not outlive the data it points at\r\n  --> src\\lib.rs:14:11\r\n   |\r\n14 |     &self.foo().member\r\n   |           ^^^\r\n```\r\n\r\nAdding the `'static` bound, of course, fixes it.\r\n\r\nI _think_ this is not a bug, but I am not 100% sure.",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/263670429/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/301840364",
    "html_url": "https://github.com/rust-lang/rust/issues/22062#issuecomment-301840364",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/22062",
    "id": 301840364,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMwMTg0MDM2NA==",
    "user": {
      "login": "Mark-Simulacrum",
      "id": 5047365,
      "node_id": "MDQ6VXNlcjUwNDczNjU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5047365?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Mark-Simulacrum",
      "html_url": "https://github.com/Mark-Simulacrum",
      "followers_url": "https://api.github.com/users/Mark-Simulacrum/followers",
      "following_url": "https://api.github.com/users/Mark-Simulacrum/following{/other_user}",
      "gists_url": "https://api.github.com/users/Mark-Simulacrum/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Mark-Simulacrum/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Mark-Simulacrum/subscriptions",
      "organizations_url": "https://api.github.com/users/Mark-Simulacrum/orgs",
      "repos_url": "https://api.github.com/users/Mark-Simulacrum/repos",
      "events_url": "https://api.github.com/users/Mark-Simulacrum/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Mark-Simulacrum/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2017-05-16T16:37:35Z",
    "updated_at": "2017-05-16T16:37:35Z",
    "body": "Yeah, I'm going to close as not a bug. I don't think there's anything wrong with the way rustc handles this.",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/301840364/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
