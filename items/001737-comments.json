[
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/3780521",
    "html_url": "https://github.com/rust-lang/rust/issues/1737#issuecomment-3780521",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/1737",
    "id": 3780521,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM3ODA1MjE=",
    "user": {
      "login": "nikomatsakis",
      "id": 155238,
      "node_id": "MDQ6VXNlcjE1NTIzOA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/155238?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nikomatsakis",
      "html_url": "https://github.com/nikomatsakis",
      "followers_url": "https://api.github.com/users/nikomatsakis/followers",
      "following_url": "https://api.github.com/users/nikomatsakis/following{/other_user}",
      "gists_url": "https://api.github.com/users/nikomatsakis/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nikomatsakis/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nikomatsakis/subscriptions",
      "organizations_url": "https://api.github.com/users/nikomatsakis/orgs",
      "repos_url": "https://api.github.com/users/nikomatsakis/repos",
      "events_url": "https://api.github.com/users/nikomatsakis/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nikomatsakis/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2012-02-02T16:09:22Z",
    "updated_at": "2012-02-02T16:09:22Z",
    "body": "It occurs to me I could be seeing ref-counting costs.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/3780521/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/3781691",
    "html_url": "https://github.com/rust-lang/rust/issues/1737#issuecomment-3781691",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/1737",
    "id": 3781691,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM3ODE2OTE=",
    "user": {
      "login": "marijnh",
      "id": 144427,
      "node_id": "MDQ6VXNlcjE0NDQyNw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/144427?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/marijnh",
      "html_url": "https://github.com/marijnh",
      "followers_url": "https://api.github.com/users/marijnh/followers",
      "following_url": "https://api.github.com/users/marijnh/following{/other_user}",
      "gists_url": "https://api.github.com/users/marijnh/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/marijnh/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/marijnh/subscriptions",
      "organizations_url": "https://api.github.com/users/marijnh/orgs",
      "repos_url": "https://api.github.com/users/marijnh/repos",
      "events_url": "https://api.github.com/users/marijnh/events{/privacy}",
      "received_events_url": "https://api.github.com/users/marijnh/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2012-02-02T17:05:53Z",
    "updated_at": "2012-02-02T17:05:53Z",
    "body": "What do you mean 'purely stack-local'? I don't really see a scenario in which a refcounted box is faster than a unique one.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/3781691/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/3782885",
    "html_url": "https://github.com/rust-lang/rust/issues/1737#issuecomment-3782885",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/1737",
    "id": 3782885,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM3ODI4ODU=",
    "user": {
      "login": "nikomatsakis",
      "id": 155238,
      "node_id": "MDQ6VXNlcjE1NTIzOA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/155238?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nikomatsakis",
      "html_url": "https://github.com/nikomatsakis",
      "followers_url": "https://api.github.com/users/nikomatsakis/followers",
      "following_url": "https://api.github.com/users/nikomatsakis/following{/other_user}",
      "gists_url": "https://api.github.com/users/nikomatsakis/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nikomatsakis/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nikomatsakis/subscriptions",
      "organizations_url": "https://api.github.com/users/nikomatsakis/orgs",
      "repos_url": "https://api.github.com/users/nikomatsakis/repos",
      "events_url": "https://api.github.com/users/nikomatsakis/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nikomatsakis/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2012-02-02T18:02:18Z",
    "updated_at": "2012-02-02T18:02:18Z",
    "body": "I'm sorry, I meant \"task-local\".  Re: being faster, you are probably right, but I don't think boxes need to be slower, and certainly not this much slower.  I recognize that unique pointers don't require any form of GC, ref-counting or otherwise, thus giving them an innate advantage; box allocation, OTOH, is always thread-local, so that could work in box's favor.  OTOOH, optimized malloc implementations already reserve big pools per thread, so that may not make much of a difference in practice.\n\nI can think of two factors that work against boxes right now, and I'd like to know their relative impact:\n- Space overhead: boxes have a header in front which is non-trivial in size.\n- Ref-counting overhead: we inc and dec refs and do a bit of other bookkeeping for cycle collection.\n\nSo as to get some hard data, I was thinking of running an experiment where I disable all ref-counting, cycle collection, and freeing of unique pointers, and compare their performance.  This ought to eliminate the RC overhead.  A further experiment might be to avoid allocating the header as well for boxes.  Are there other factors to consider I am not thinking of?\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/3782885/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/4966854",
    "html_url": "https://github.com/rust-lang/rust/issues/1737#issuecomment-4966854",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/1737",
    "id": 4966854,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ5NjY4NTQ=",
    "user": {
      "login": "graydon",
      "id": 14097,
      "node_id": "MDQ6VXNlcjE0MDk3",
      "avatar_url": "https://avatars.githubusercontent.com/u/14097?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/graydon",
      "html_url": "https://github.com/graydon",
      "followers_url": "https://api.github.com/users/graydon/followers",
      "following_url": "https://api.github.com/users/graydon/following{/other_user}",
      "gists_url": "https://api.github.com/users/graydon/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/graydon/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/graydon/subscriptions",
      "organizations_url": "https://api.github.com/users/graydon/orgs",
      "repos_url": "https://api.github.com/users/graydon/repos",
      "events_url": "https://api.github.com/users/graydon/events{/privacy}",
      "received_events_url": "https://api.github.com/users/graydon/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2012-04-05T01:23:38Z",
    "updated_at": "2012-04-05T01:23:38Z",
    "body": "I don't think this is quite concrete enough to act on, or at least not in any way that's not covered elsewhere. We're working on regions, arenas, cycle collection / GC and ARC elsewhere. Closing this as vague. Reopen if you disagree.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/4966854/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
