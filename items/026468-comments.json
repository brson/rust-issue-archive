[
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/113911238",
    "html_url": "https://github.com/rust-lang/rust/issues/26468#issuecomment-113911238",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/26468",
    "id": 113911238,
    "node_id": "MDEyOklzc3VlQ29tbWVudDExMzkxMTIzOA==",
    "user": {
      "login": "Stebalien",
      "id": 310393,
      "node_id": "MDQ6VXNlcjMxMDM5Mw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/310393?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Stebalien",
      "html_url": "https://github.com/Stebalien",
      "followers_url": "https://api.github.com/users/Stebalien/followers",
      "following_url": "https://api.github.com/users/Stebalien/following{/other_user}",
      "gists_url": "https://api.github.com/users/Stebalien/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Stebalien/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Stebalien/subscriptions",
      "organizations_url": "https://api.github.com/users/Stebalien/orgs",
      "repos_url": "https://api.github.com/users/Stebalien/repos",
      "events_url": "https://api.github.com/users/Stebalien/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Stebalien/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-06-21T14:52:38Z",
    "updated_at": "2015-06-21T14:52:38Z",
    "body": "Probably a dup of #26251 (and #18060)\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/113911238/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/113951045",
    "html_url": "https://github.com/rust-lang/rust/issues/26468#issuecomment-113951045",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/26468",
    "id": 113951045,
    "node_id": "MDEyOklzc3VlQ29tbWVudDExMzk1MTA0NQ==",
    "user": {
      "login": "rprichard",
      "id": 1572855,
      "node_id": "MDQ6VXNlcjE1NzI4NTU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1572855?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/rprichard",
      "html_url": "https://github.com/rprichard",
      "followers_url": "https://api.github.com/users/rprichard/followers",
      "following_url": "https://api.github.com/users/rprichard/following{/other_user}",
      "gists_url": "https://api.github.com/users/rprichard/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/rprichard/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/rprichard/subscriptions",
      "organizations_url": "https://api.github.com/users/rprichard/orgs",
      "repos_url": "https://api.github.com/users/rprichard/repos",
      "events_url": "https://api.github.com/users/rprichard/events{/privacy}",
      "received_events_url": "https://api.github.com/users/rprichard/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-06-21T20:08:29Z",
    "updated_at": "2015-06-21T20:08:29Z",
    "body": "Perhaps it's a dup.  The other two issues are broken with and without optimizations, though.  This issue only fails with optimizations.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/113951045/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/113951229",
    "html_url": "https://github.com/rust-lang/rust/issues/26468#issuecomment-113951229",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/26468",
    "id": 113951229,
    "node_id": "MDEyOklzc3VlQ29tbWVudDExMzk1MTIyOQ==",
    "user": {
      "login": "rprichard",
      "id": 1572855,
      "node_id": "MDQ6VXNlcjE1NzI4NTU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1572855?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/rprichard",
      "html_url": "https://github.com/rprichard",
      "followers_url": "https://api.github.com/users/rprichard/followers",
      "following_url": "https://api.github.com/users/rprichard/following{/other_user}",
      "gists_url": "https://api.github.com/users/rprichard/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/rprichard/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/rprichard/subscriptions",
      "organizations_url": "https://api.github.com/users/rprichard/orgs",
      "repos_url": "https://api.github.com/users/rprichard/repos",
      "events_url": "https://api.github.com/users/rprichard/events{/privacy}",
      "received_events_url": "https://api.github.com/users/rprichard/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-06-21T20:13:18Z",
    "updated_at": "2015-06-21T20:13:18Z",
    "body": "Also: the `match` expression in this issue doesn't actually require any overlap of the match patterns.  (I'll update the test case.)\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/113951229/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/113951412",
    "html_url": "https://github.com/rust-lang/rust/issues/26468#issuecomment-113951412",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/26468",
    "id": 113951412,
    "node_id": "MDEyOklzc3VlQ29tbWVudDExMzk1MTQxMg==",
    "user": {
      "login": "rprichard",
      "id": 1572855,
      "node_id": "MDQ6VXNlcjE1NzI4NTU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1572855?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/rprichard",
      "html_url": "https://github.com/rprichard",
      "followers_url": "https://api.github.com/users/rprichard/followers",
      "following_url": "https://api.github.com/users/rprichard/following{/other_user}",
      "gists_url": "https://api.github.com/users/rprichard/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/rprichard/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/rprichard/subscriptions",
      "organizations_url": "https://api.github.com/users/rprichard/orgs",
      "repos_url": "https://api.github.com/users/rprichard/repos",
      "events_url": "https://api.github.com/users/rprichard/events{/privacy}",
      "received_events_url": "https://api.github.com/users/rprichard/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-06-21T20:17:58Z",
    "updated_at": "2015-06-21T20:17:58Z",
    "body": "The bug also happens without a `match` expression:\n\n``` rust\n#[inline(never)]\nfn broken(mode: &Mode) -> u32 {\n    for _ in 0..1 {\n        if let Mode::Bar(BarMode::Bar1) = *mode { return 17 }\n        if let Mode::Foo(5) = *mode { return 19 }\n    }\n    return 42;\n}\n```\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/113951412/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/113955290",
    "html_url": "https://github.com/rust-lang/rust/issues/26468#issuecomment-113955290",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/26468",
    "id": 113955290,
    "node_id": "MDEyOklzc3VlQ29tbWVudDExMzk1NTI5MA==",
    "user": {
      "login": "Stebalien",
      "id": 310393,
      "node_id": "MDQ6VXNlcjMxMDM5Mw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/310393?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Stebalien",
      "html_url": "https://github.com/Stebalien",
      "followers_url": "https://api.github.com/users/Stebalien/followers",
      "following_url": "https://api.github.com/users/Stebalien/following{/other_user}",
      "gists_url": "https://api.github.com/users/Stebalien/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Stebalien/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Stebalien/subscriptions",
      "organizations_url": "https://api.github.com/users/Stebalien/orgs",
      "repos_url": "https://api.github.com/users/Stebalien/repos",
      "events_url": "https://api.github.com/users/Stebalien/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Stebalien/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-06-21T20:32:40Z",
    "updated_at": "2015-06-21T20:32:40Z",
    "body": "Good point. Also, this only happens with opt-level=2 (not 0 or 3).\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/113955290/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/113963304",
    "html_url": "https://github.com/rust-lang/rust/issues/26468#issuecomment-113963304",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/26468",
    "id": 113963304,
    "node_id": "MDEyOklzc3VlQ29tbWVudDExMzk2MzMwNA==",
    "user": {
      "login": "rprichard",
      "id": 1572855,
      "node_id": "MDQ6VXNlcjE1NzI4NTU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1572855?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/rprichard",
      "html_url": "https://github.com/rprichard",
      "followers_url": "https://api.github.com/users/rprichard/followers",
      "following_url": "https://api.github.com/users/rprichard/following{/other_user}",
      "gists_url": "https://api.github.com/users/rprichard/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/rprichard/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/rprichard/subscriptions",
      "organizations_url": "https://api.github.com/users/rprichard/orgs",
      "repos_url": "https://api.github.com/users/rprichard/repos",
      "events_url": "https://api.github.com/users/rprichard/events{/privacy}",
      "received_events_url": "https://api.github.com/users/rprichard/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-06-21T21:52:18Z",
    "updated_at": "2015-06-21T21:52:18Z",
    "body": "cc @dotdash\n\nFurther refinement of the test case:\n\n``` rust\n#[allow(dead_code)]\n#[repr(u16)]\nenum FooMode {\n    First = 0x1000,\n    Check = 0x1001,\n    Last  = 0x100f,\n}\n\n#[allow(dead_code)]\n#[repr(u16)]\nenum BarMode {\n    First = 0x2000,\n    Check = 0x2001,\n    Last  = 0x200f,\n}\n\n#[allow(dead_code)]\nenum Mode {\n    Foo(FooMode),\n    Bar(BarMode),\n}\n\n#[inline(never)]\nfn broken(mode: &Mode) -> u32 {\n    for _ in 0..1 {\n        if let Mode::Foo(FooMode::Check) = *mode { return 17 }\n        if let Mode::Bar(BarMode::Check) = *mode { return 19 }\n    }\n    return 42;\n}\n\nfn main() {\n    let mode = Mode::Bar(BarMode::Check);\n    assert_eq!(broken(&mode), 19);\n}\n```\n\nChanging `FooMode::Last` from `0x100f` to a large enough value avoids the bug.  Apparently, the value needs to be large enough that, when rounded to the next highest power-of-two-minus-one, it is at least as large as `BarMode::Check`.\n\nI think this is an LLVM bug.  It involves the `!range` metadata.  It's as if the compiler is reusing the range information from the `Mode::Foo(FooMode::Check)` check to elide the `Mode::Bar(BarMode::Check)` check (which is missing from the x64 assembly).  Relevant unoptimized LLVM IR:\n\n``` llvm\nmatch_case7:                                      ; preds = %case_body2\n  %26 = bitcast %Mode* %21 to { i16, i16 }*\n  %27 = getelementptr inbounds { i16, i16 }, { i16, i16 }* %26, i32 0, i32 1\n  %28 = load i16, i16* %27, !range !3\n  switch i16 %28, label %match_else8 [\n    i16 4097, label %match_case9\n  ]\n\n...\n\nmatch_case14:                                     ; preds = %join\n  %32 = bitcast %Mode* %29 to { i16, i16 }*\n  %33 = getelementptr inbounds { i16, i16 }, { i16, i16 }* %32, i32 0, i32 1\n  %34 = load i16, i16* %33, !range !4\n  switch i16 %34, label %match_else15 [\n    i16 8193, label %match_case16\n  ]\n\n...\n\n!3 = !{i16 4096, i16 4112}\n!4 = !{i16 8192, i16 8208}\n```\n\n`FooMode::Last` isn't used in the test program.  When I change its value, the only difference I notice in the unoptimized LLVM IR is in the range metadata (i.e. `!3`).\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/113963304/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/114051797",
    "html_url": "https://github.com/rust-lang/rust/issues/26468#issuecomment-114051797",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/26468",
    "id": 114051797,
    "node_id": "MDEyOklzc3VlQ29tbWVudDExNDA1MTc5Nw==",
    "user": {
      "login": "dotdash",
      "id": 230962,
      "node_id": "MDQ6VXNlcjIzMDk2Mg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/230962?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dotdash",
      "html_url": "https://github.com/dotdash",
      "followers_url": "https://api.github.com/users/dotdash/followers",
      "following_url": "https://api.github.com/users/dotdash/following{/other_user}",
      "gists_url": "https://api.github.com/users/dotdash/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dotdash/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dotdash/subscriptions",
      "organizations_url": "https://api.github.com/users/dotdash/orgs",
      "repos_url": "https://api.github.com/users/dotdash/repos",
      "events_url": "https://api.github.com/users/dotdash/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dotdash/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-06-22T09:41:21Z",
    "updated_at": "2015-06-22T09:41:21Z",
    "body": "Thanks Ryan! Indeed LLVM replaces the load with another disregarding the range information.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/114051797/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/114203507",
    "html_url": "https://github.com/rust-lang/rust/issues/26468#issuecomment-114203507",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/26468",
    "id": 114203507,
    "node_id": "MDEyOklzc3VlQ29tbWVudDExNDIwMzUwNw==",
    "user": {
      "login": "dotdash",
      "id": 230962,
      "node_id": "MDQ6VXNlcjIzMDk2Mg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/230962?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dotdash",
      "html_url": "https://github.com/dotdash",
      "followers_url": "https://api.github.com/users/dotdash/followers",
      "following_url": "https://api.github.com/users/dotdash/following{/other_user}",
      "gists_url": "https://api.github.com/users/dotdash/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dotdash/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dotdash/subscriptions",
      "organizations_url": "https://api.github.com/users/dotdash/orgs",
      "repos_url": "https://api.github.com/users/dotdash/repos",
      "events_url": "https://api.github.com/users/dotdash/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dotdash/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-06-22T18:08:46Z",
    "updated_at": "2015-06-22T18:08:46Z",
    "body": "Patch is at http://lists.cs.uiuc.edu/pipermail/llvm-commits/Week-of-Mon-20150622/282940.html\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/114203507/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/120255719",
    "html_url": "https://github.com/rust-lang/rust/issues/26468#issuecomment-120255719",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/26468",
    "id": 120255719,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEyMDI1NTcxOQ==",
    "user": {
      "login": "dotdash",
      "id": 230962,
      "node_id": "MDQ6VXNlcjIzMDk2Mg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/230962?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dotdash",
      "html_url": "https://github.com/dotdash",
      "followers_url": "https://api.github.com/users/dotdash/followers",
      "following_url": "https://api.github.com/users/dotdash/following{/other_user}",
      "gists_url": "https://api.github.com/users/dotdash/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dotdash/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dotdash/subscriptions",
      "organizations_url": "https://api.github.com/users/dotdash/orgs",
      "repos_url": "https://api.github.com/users/dotdash/repos",
      "events_url": "https://api.github.com/users/dotdash/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dotdash/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-07-10T06:56:31Z",
    "updated_at": "2015-07-10T06:56:31Z",
    "body": "Patch landed upstream.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/120255719/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/168678835",
    "html_url": "https://github.com/rust-lang/rust/issues/26468#issuecomment-168678835",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/26468",
    "id": 168678835,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE2ODY3ODgzNQ==",
    "user": {
      "login": "MagaTailor",
      "id": 12054457,
      "node_id": "MDQ6VXNlcjEyMDU0NDU3",
      "avatar_url": "https://avatars.githubusercontent.com/u/12054457?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MagaTailor",
      "html_url": "https://github.com/MagaTailor",
      "followers_url": "https://api.github.com/users/MagaTailor/followers",
      "following_url": "https://api.github.com/users/MagaTailor/following{/other_user}",
      "gists_url": "https://api.github.com/users/MagaTailor/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MagaTailor/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MagaTailor/subscriptions",
      "organizations_url": "https://api.github.com/users/MagaTailor/orgs",
      "repos_url": "https://api.github.com/users/MagaTailor/repos",
      "events_url": "https://api.github.com/users/MagaTailor/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MagaTailor/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2016-01-04T13:42:58Z",
    "updated_at": "2016-01-04T14:00:57Z",
    "body": "Using yesterday's nightly, `make test` fails on `armv7` at this single test. The problem seems to be local llvm 3.6 is still allowed by the build system.\n",
    "author_association": "NONE",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/168678835/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
