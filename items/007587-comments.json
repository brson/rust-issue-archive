[
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/20491898",
    "html_url": "https://github.com/rust-lang/rust/issues/7587#issuecomment-20491898",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/7587",
    "id": 20491898,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIwNDkxODk4",
    "user": {
      "login": "bblum",
      "id": 1820515,
      "node_id": "MDQ6VXNlcjE4MjA1MTU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1820515?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/bblum",
      "html_url": "https://github.com/bblum",
      "followers_url": "https://api.github.com/users/bblum/followers",
      "following_url": "https://api.github.com/users/bblum/following{/other_user}",
      "gists_url": "https://api.github.com/users/bblum/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/bblum/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/bblum/subscriptions",
      "organizations_url": "https://api.github.com/users/bblum/orgs",
      "repos_url": "https://api.github.com/users/bblum/repos",
      "events_url": "https://api.github.com/users/bblum/events{/privacy}",
      "received_events_url": "https://api.github.com/users/bblum/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2013-07-04T20:02:10Z",
    "updated_at": "2013-07-04T20:02:23Z",
    "body": "The issue is with `type_contents`. That function uses a local cache to avoid repeating work for recursive types, but when it instantiates the nested Trees, the parameterized type is different. Basically any polymorphic reinstantiation seems to cause this problem, as long as the substitution keeps creating new types:\n\n```\nenum Tree<T> {\n        Leaf(T),\n        Branch(~Tree<~T>),\n}\n```\n\n```\nenum Tree<T> {\n        Leaf(T),\n        Branch(~Tree<(T,)>),\n}\n```\n\n```\nenum Tree<T> {\n        Leaf(T),\n        Branch(~Tree<Tree<T>>),\n}\n```\n\nIt shouldn't be surprising that this, however, doesn't cause the problem:\n\n```\nenum Tree<T,U> {\n        Leaf(T),\n        Branch(~Tree<U,T>),\n}\n```\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/20491898/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/20491979",
    "html_url": "https://github.com/rust-lang/rust/issues/7587#issuecomment-20491979",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/7587",
    "id": 20491979,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIwNDkxOTc5",
    "user": {
      "login": "bblum",
      "id": 1820515,
      "node_id": "MDQ6VXNlcjE4MjA1MTU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1820515?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/bblum",
      "html_url": "https://github.com/bblum",
      "followers_url": "https://api.github.com/users/bblum/followers",
      "following_url": "https://api.github.com/users/bblum/following{/other_user}",
      "gists_url": "https://api.github.com/users/bblum/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/bblum/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/bblum/subscriptions",
      "organizations_url": "https://api.github.com/users/bblum/orgs",
      "repos_url": "https://api.github.com/users/bblum/repos",
      "events_url": "https://api.github.com/users/bblum/events{/privacy}",
      "received_events_url": "https://api.github.com/users/bblum/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2013-07-04T20:05:12Z",
    "updated_at": "2013-07-04T20:05:12Z",
    "body": "i guess @nikomatsakis is most likely to know how to deal with this\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/20491979/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/20532943",
    "html_url": "https://github.com/rust-lang/rust/issues/7587#issuecomment-20532943",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/7587",
    "id": 20532943,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIwNTMyOTQz",
    "user": {
      "login": "nikomatsakis",
      "id": 155238,
      "node_id": "MDQ6VXNlcjE1NTIzOA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/155238?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nikomatsakis",
      "html_url": "https://github.com/nikomatsakis",
      "followers_url": "https://api.github.com/users/nikomatsakis/followers",
      "following_url": "https://api.github.com/users/nikomatsakis/following{/other_user}",
      "gists_url": "https://api.github.com/users/nikomatsakis/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nikomatsakis/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nikomatsakis/subscriptions",
      "organizations_url": "https://api.github.com/users/nikomatsakis/orgs",
      "repos_url": "https://api.github.com/users/nikomatsakis/repos",
      "events_url": "https://api.github.com/users/nikomatsakis/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nikomatsakis/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2013-07-05T18:32:27Z",
    "updated_at": "2013-07-05T18:32:27Z",
    "body": "This is interesting. I can't decide whether such a type ought to be legal or not. I can't think of any principled reason for it to be illegal precisely, though it's not quite clear to me what such a type is good for. In any case, handling this case does significantly complicate type contents (and perhaps a few other similar algorithms, though most are robust to such types). As @bblum points out, the current design is \"inductive\" and assumes we can fully expand out all the types.\n\nOne alternate design that comes to mind would be to modify type contents so that it computes \"type content equations\" rather than precise bit sets. These equations could then be applied to a specific set of type parameters. So, in other words, for something like `struct Foo<T> { a: @int, b: T }` we would generate a type contents like `TC_MANAGED + TC(T)`. Then when a precise T was given, we could compute the final result. In the case of sometihng like `@T` we'd need to handle that too. This design _might_ be faster, not sure. I've been wanting to reimplement type contents anyhow because it's become rather confusing, this might be a nice excuse.\n\nHowever, I should go re-read the various literature on other algorithms that operate over infinitely sized types and see whether there is another approach. This seems to be highly related to such algorithms as well as induction vs co-induction and maybe there is another solution to be had.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/20532943/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/20898402",
    "html_url": "https://github.com/rust-lang/rust/issues/7587#issuecomment-20898402",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/7587",
    "id": 20898402,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIwODk4NDAy",
    "user": {
      "login": "msullivan",
      "id": 340349,
      "node_id": "MDQ6VXNlcjM0MDM0OQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/msullivan",
      "html_url": "https://github.com/msullivan",
      "followers_url": "https://api.github.com/users/msullivan/followers",
      "following_url": "https://api.github.com/users/msullivan/following{/other_user}",
      "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions",
      "organizations_url": "https://api.github.com/users/msullivan/orgs",
      "repos_url": "https://api.github.com/users/msullivan/repos",
      "events_url": "https://api.github.com/users/msullivan/events{/privacy}",
      "received_events_url": "https://api.github.com/users/msullivan/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2013-07-12T19:18:10Z",
    "updated_at": "2013-07-12T19:18:10Z",
    "body": "Actually using such a type won't work well, since polymorphic recursion doesn't work in rust. (Because we monomorphize.)\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/20898402/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/21153123",
    "html_url": "https://github.com/rust-lang/rust/issues/7587#issuecomment-21153123",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/7587",
    "id": 21153123,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIxMTUzMTIz",
    "user": {
      "login": "pnkfelix",
      "id": 173127,
      "node_id": "MDQ6VXNlcjE3MzEyNw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/173127?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/pnkfelix",
      "html_url": "https://github.com/pnkfelix",
      "followers_url": "https://api.github.com/users/pnkfelix/followers",
      "following_url": "https://api.github.com/users/pnkfelix/following{/other_user}",
      "gists_url": "https://api.github.com/users/pnkfelix/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/pnkfelix/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/pnkfelix/subscriptions",
      "organizations_url": "https://api.github.com/users/pnkfelix/orgs",
      "repos_url": "https://api.github.com/users/pnkfelix/repos",
      "events_url": "https://api.github.com/users/pnkfelix/events{/privacy}",
      "received_events_url": "https://api.github.com/users/pnkfelix/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2013-07-17T23:32:01Z",
    "updated_at": "2013-07-17T23:49:40Z",
    "body": "\bI went ahead and looked up the references I could remember and skimmed them over, so i figured I might as well attach them here:\n- Jim's [\"What are principal typings and what are they good for?\"](http://dl.acm.org/citation.cfm?id=237728) (1996) references polymorphic recursion and mentions it as a recurring topic on the ML mailing list.  Here's a [page](http://www.cis.uni-muenchen.de/~leiss/polyrec/polyrec.examples.html) from the ML community with a couple of motivating examples.\n- [Okasaki's dissertation](http://www.cs.cmu.edu/~rwh/theses/okasaki.pdf) (1996) provides at least one motivating example for polymorphic recursion (see section 7.1), but also provides the regular datatype encoding.\n- Bird and Meertens' [\"Nested Datatypes\"](http://www.cs.ox.ac.uk/richard.bird/online/BirdMeertens98Nested.pdf) (1998) has small examples of polymorphic recursion (aka \"non-regular datatypes\" aka \"nested datatypes\").\n- [Hallett and Kfoury](http://www.sciencedirect.com/science/article/pii/S1571066105050607) (2005) has a mix of examples, but some of them require an intersection type system; perhaps eight of them may be relevant here.\n\nAm I convinced by these examples?  Well, no, at least, not the one's I've actually read and digested.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/21153123/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/23050673",
    "html_url": "https://github.com/rust-lang/rust/issues/7587#issuecomment-23050673",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/7587",
    "id": 23050673,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIzMDUwNjcz",
    "user": {
      "login": "bblum",
      "id": 1820515,
      "node_id": "MDQ6VXNlcjE4MjA1MTU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1820515?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/bblum",
      "html_url": "https://github.com/bblum",
      "followers_url": "https://api.github.com/users/bblum/followers",
      "following_url": "https://api.github.com/users/bblum/following{/other_user}",
      "gists_url": "https://api.github.com/users/bblum/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/bblum/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/bblum/subscriptions",
      "organizations_url": "https://api.github.com/users/bblum/orgs",
      "repos_url": "https://api.github.com/users/bblum/repos",
      "events_url": "https://api.github.com/users/bblum/events{/privacy}",
      "received_events_url": "https://api.github.com/users/bblum/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2013-08-21T21:11:46Z",
    "updated_at": "2013-08-21T21:11:46Z",
    "body": "actually this is a dupe of #4363.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/23050673/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
