[
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/2750228",
    "html_url": "https://github.com/rust-lang/rust/issues/792#issuecomment-2750228",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/792",
    "id": 2750228,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3NTAyMjg=",
    "user": {
      "login": "nikomatsakis",
      "id": 155238,
      "node_id": "MDQ6VXNlcjE1NTIzOA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/155238?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nikomatsakis",
      "html_url": "https://github.com/nikomatsakis",
      "followers_url": "https://api.github.com/users/nikomatsakis/followers",
      "following_url": "https://api.github.com/users/nikomatsakis/following{/other_user}",
      "gists_url": "https://api.github.com/users/nikomatsakis/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nikomatsakis/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nikomatsakis/subscriptions",
      "organizations_url": "https://api.github.com/users/nikomatsakis/orgs",
      "repos_url": "https://api.github.com/users/nikomatsakis/repos",
      "events_url": "https://api.github.com/users/nikomatsakis/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nikomatsakis/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2011-11-15T19:55:00Z",
    "updated_at": "2011-11-15T19:55:00Z",
    "body": "This problem is more urgent as we support more architectures.\n\nIn general, I think tags should be laid out as follows (this is fairly close to what the current code does):\n- No data: just like an enum.\n- Only one variant: just like that variant's data\n- Multiple variants with data:\n  \n  ```\n  struct Tag {\n      unsigned variant_id;\n      union { variant_1, variant_2, variant_3 } data;\n  }\n  ```\n  \n  where variant_N stands in for the translation of the data types.\n\nThe tricky case of course is with generic types.  For something like\n\n```\ntag option<T> { none; some(val: T); }\n```\n\nwhere is the data located? That depends on the type of T and its corresponding alignment restrictions.  I am not clear on how  the current dynamic shape-walking code (GEP-tuple-like, Shape.h, and friends) handles this kind of dynamic alignment.  I could see an argument for using a pessimistic alignment (i.e., maximally align the data in tags always), but that seems to waste a lot of space, since the maximal reasonable alignment is probably 16 bytes (vector data), and you only NEED 4 bytes (for the variant ID).  \n\nFor reference, the current behavior is:\n- No data: unsigned long variant_id\n- Only one variant: use a char[X] array where X is the size of the variant\n- Multiple variants: struct Tag { unsigned long variant_id; char[X] data; } where X is the size of the largest variant\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/2750228/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/3639248",
    "html_url": "https://github.com/rust-lang/rust/issues/792#issuecomment-3639248",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/792",
    "id": 3639248,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM2MzkyNDg=",
    "user": {
      "login": "nikomatsakis",
      "id": 155238,
      "node_id": "MDQ6VXNlcjE1NTIzOA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/155238?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nikomatsakis",
      "html_url": "https://github.com/nikomatsakis",
      "followers_url": "https://api.github.com/users/nikomatsakis/followers",
      "following_url": "https://api.github.com/users/nikomatsakis/following{/other_user}",
      "gists_url": "https://api.github.com/users/nikomatsakis/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nikomatsakis/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nikomatsakis/subscriptions",
      "organizations_url": "https://api.github.com/users/nikomatsakis/orgs",
      "repos_url": "https://api.github.com/users/nikomatsakis/repos",
      "events_url": "https://api.github.com/users/nikomatsakis/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nikomatsakis/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2012-01-24T20:00:49Z",
    "updated_at": "2012-01-24T20:00:49Z",
    "body": "Subsumed by #1645\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/3639248/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
