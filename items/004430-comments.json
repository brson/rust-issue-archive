[
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/19601131",
    "html_url": "https://github.com/rust-lang/rust/issues/4430#issuecomment-19601131",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/4430",
    "id": 19601131,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE5NjAxMTMx",
    "user": {
      "login": "pnkfelix",
      "id": 173127,
      "node_id": "MDQ6VXNlcjE3MzEyNw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/173127?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/pnkfelix",
      "html_url": "https://github.com/pnkfelix",
      "followers_url": "https://api.github.com/users/pnkfelix/followers",
      "following_url": "https://api.github.com/users/pnkfelix/following{/other_user}",
      "gists_url": "https://api.github.com/users/pnkfelix/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/pnkfelix/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/pnkfelix/subscriptions",
      "organizations_url": "https://api.github.com/users/pnkfelix/orgs",
      "repos_url": "https://api.github.com/users/pnkfelix/repos",
      "events_url": "https://api.github.com/users/pnkfelix/events{/privacy}",
      "received_events_url": "https://api.github.com/users/pnkfelix/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2013-06-18T09:48:14Z",
    "updated_at": "2013-06-18T10:43:09Z",
    "body": "To save future reviewers time: the FIXME is referring to a loop for comparing two encoded JSON Objects (as opposed to Number, String, Boolean, Null, and List (aka \"JSON Arrays\")).  Such Objects are represented as hashmaps.  The comparison of two Objects is implemented by copying each hashmap to a `~[(~str, Json)]` vector, quick-sorting the vectors, and finally returning the result of comparing the two vectors.\n\nThere are potentially some interesting backwards-compatibility questions here; i.e. would we be willing to change the ordering defined by the above algorithm in order to have better overall performance.  I assume the answer there is yes.\n\nExamples of some hacks that would change the ordering and improve performance (at least in special cases):\n- Use the number of hashmap entries as a partial ordering on Object.\n- Use the keys alone as a (second) partial ordering on Object (to avoid recursive copy and traversal of the values until we've confirmed it is necessary).\n- Extract the keys alone, sort them, then traverse the sorted list of keys and compare the associated values.  This cuts the size of the temporary  `~[(~str, Json)]` list structure in half (and I think usually much more than that, since its it looks like the Json objects are copied into the temporary list structure).\n  - I had thought it might also help avoid unnecessary comparisons between Json objects, but since there will not be duplicate keys in the `~[(~str, Json)]`, and since presumably `d0_flat < d1_flat` will short-circuit as soon as it sees the first smaller Json Object, I am no longer sure there's a further win to be had here.\n\nBut since json.rs lives in libextra (and not the core), I am guessing that this does not mean that we need to worry about its backwards-compatibility.  It would be good to clarify that, though.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/19601131/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/19868336",
    "html_url": "https://github.com/rust-lang/rust/issues/4430#issuecomment-19868336",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/4430",
    "id": 19868336,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE5ODY4MzM2",
    "user": {
      "login": "alexcrichton",
      "id": 64996,
      "node_id": "MDQ6VXNlcjY0OTk2",
      "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alexcrichton",
      "html_url": "https://github.com/alexcrichton",
      "followers_url": "https://api.github.com/users/alexcrichton/followers",
      "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}",
      "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions",
      "organizations_url": "https://api.github.com/users/alexcrichton/orgs",
      "repos_url": "https://api.github.com/users/alexcrichton/repos",
      "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alexcrichton/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2013-06-23T03:12:18Z",
    "updated_at": "2013-06-23T03:12:18Z",
    "body": "Another interesting idea that could happen here is to use a `TreeMap` instead of a `HashMap` by default. I like the idea of not performing an allocation during a comparison because that's always a sad thing to do. Obviously a bad part here is that lookups are then not O(1). This probably isn't enough reason to use `TreeMap`, but it would have the other bonus of 0 allocations during comparisons.\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/19868336/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/22121003",
    "html_url": "https://github.com/rust-lang/rust/issues/4430#issuecomment-22121003",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/4430",
    "id": 22121003,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIyMTIxMDAz",
    "user": {
      "login": "emberian",
      "id": 704250,
      "node_id": "MDQ6VXNlcjcwNDI1MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/704250?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/emberian",
      "html_url": "https://github.com/emberian",
      "followers_url": "https://api.github.com/users/emberian/followers",
      "following_url": "https://api.github.com/users/emberian/following{/other_user}",
      "gists_url": "https://api.github.com/users/emberian/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/emberian/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/emberian/subscriptions",
      "organizations_url": "https://api.github.com/users/emberian/orgs",
      "repos_url": "https://api.github.com/users/emberian/repos",
      "events_url": "https://api.github.com/users/emberian/events{/privacy}",
      "received_events_url": "https://api.github.com/users/emberian/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2013-08-05T17:13:08Z",
    "updated_at": "2013-08-05T17:13:08Z",
    "body": "The fixme is still there and does all sorts of horrible things, but TreeMap is now used rather than HashMap.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/22121003/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
