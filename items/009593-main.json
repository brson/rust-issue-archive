{
  "url": "https://api.github.com/repos/rust-lang/rust/issues/9593",
  "repository_url": "https://api.github.com/repos/rust-lang/rust",
  "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/9593/labels{/name}",
  "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/9593/comments",
  "events_url": "https://api.github.com/repos/rust-lang/rust/issues/9593/events",
  "html_url": "https://github.com/rust-lang/rust/pull/9593",
  "id": 20216582,
  "node_id": "MDExOlB1bGxSZXF1ZXN0ODY4NDgzNg==",
  "number": 9593,
  "title": "Logging unsafe removal",
  "user": {
    "login": "fhahn",
    "id": 450489,
    "node_id": "MDQ6VXNlcjQ1MDQ4OQ==",
    "avatar_url": "https://avatars.githubusercontent.com/u/450489?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/fhahn",
    "html_url": "https://github.com/fhahn",
    "followers_url": "https://api.github.com/users/fhahn/followers",
    "following_url": "https://api.github.com/users/fhahn/following{/other_user}",
    "gists_url": "https://api.github.com/users/fhahn/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/fhahn/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/fhahn/subscriptions",
    "organizations_url": "https://api.github.com/users/fhahn/orgs",
    "repos_url": "https://api.github.com/users/fhahn/repos",
    "events_url": "https://api.github.com/users/fhahn/events{/privacy}",
    "received_events_url": "https://api.github.com/users/fhahn/received_events",
    "type": "User",
    "user_view_type": "public",
    "site_admin": false
  },
  "labels": [],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [],
  "milestone": null,
  "comments": 18,
  "created_at": "2013-09-28T18:14:27Z",
  "updated_at": "2014-06-13T16:25:19Z",
  "closed_at": "2013-10-06T11:36:30Z",
  "author_association": "CONTRIBUTOR",
  "type": null,
  "active_lock_reason": null,
  "draft": false,
  "pull_request": {
    "url": "https://api.github.com/repos/rust-lang/rust/pulls/9593",
    "html_url": "https://github.com/rust-lang/rust/pull/9593",
    "diff_url": "https://github.com/rust-lang/rust/pull/9593.diff",
    "patch_url": "https://github.com/rust-lang/rust/pull/9593.patch",
    "merged_at": "2013-10-06T11:36:31Z"
  },
  "body": "This pull request changes to memory layout of the `CrateMap` struct to use static slices instead of raw pointers. Most of the discussion took place [here](https://github.com/fhahn/rust/commit/63b5975efa10af7df3df0a50d8d7f9c8d5bcf9e9#L1R92) .\n\nThe memory layout of CrateMap changed, without bumping the version number in the struct. Another, more backward compatible, solution would be to keep the old code and increase the version number in the new struct. On the other hand, the `annihilate_fn` pointer was removed without bumping the version number recently.\n\nAt the moment, the stage0 compiler does not use the new memory layout, which would lead the segfaults during stage0 compilation, so I've added a dummy `iter_crate_map` function for stage0, which does nothing. Again, this could be avoided if we'd bump the version number in the struct and keep the old code.\n\nI'd like to use a normal `for` loop [here](https://github.com/fhahn/rust/compare/logging-unsafe-removal?expand=1#L1R109), \n\n```\n    for child in children.iter() {\n        do_iter_crate_map(child, |x| f(x), visited);\n    }\n```\n\nbut for some reason this only yields `error: unresolved enum variant, struct or const 'Some'` and I have no idea why.\n",
  "closed_by": {
    "login": "bors",
    "id": 3372342,
    "node_id": "MDQ6VXNlcjMzNzIzNDI=",
    "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/bors",
    "html_url": "https://github.com/bors",
    "followers_url": "https://api.github.com/users/bors/followers",
    "following_url": "https://api.github.com/users/bors/following{/other_user}",
    "gists_url": "https://api.github.com/users/bors/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/bors/subscriptions",
    "organizations_url": "https://api.github.com/users/bors/orgs",
    "repos_url": "https://api.github.com/users/bors/repos",
    "events_url": "https://api.github.com/users/bors/events{/privacy}",
    "received_events_url": "https://api.github.com/users/bors/received_events",
    "type": "User",
    "user_view_type": "public",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/9593/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/9593/timeline",
  "performed_via_github_app": null,
  "state_reason": null,
  "_meta": {
    "type": "pr"
  }
}
