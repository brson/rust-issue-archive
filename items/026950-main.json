{
  "url": "https://api.github.com/repos/rust-lang/rust/issues/26950",
  "repository_url": "https://api.github.com/repos/rust-lang/rust",
  "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/26950/labels{/name}",
  "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/26950/comments",
  "events_url": "https://api.github.com/repos/rust-lang/rust/issues/26950/events",
  "html_url": "https://github.com/rust-lang/rust/pull/26950",
  "id": 94399631,
  "node_id": "MDExOlB1bGxSZXF1ZXN0Mzk3MjcyNDc=",
  "number": 26950,
  "title": "Add specializations of read_to_end for Stdin and File using uninitialised buffers",
  "user": {
    "login": "AlisdairO",
    "id": 6296622,
    "node_id": "MDQ6VXNlcjYyOTY2MjI=",
    "avatar_url": "https://avatars.githubusercontent.com/u/6296622?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/AlisdairO",
    "html_url": "https://github.com/AlisdairO",
    "followers_url": "https://api.github.com/users/AlisdairO/followers",
    "following_url": "https://api.github.com/users/AlisdairO/following{/other_user}",
    "gists_url": "https://api.github.com/users/AlisdairO/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/AlisdairO/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/AlisdairO/subscriptions",
    "organizations_url": "https://api.github.com/users/AlisdairO/orgs",
    "repos_url": "https://api.github.com/users/AlisdairO/repos",
    "events_url": "https://api.github.com/users/AlisdairO/events{/privacy}",
    "received_events_url": "https://api.github.com/users/AlisdairO/received_events",
    "type": "User",
    "user_view_type": "public",
    "site_admin": false
  },
  "labels": [
    {
      "id": 223796632,
      "node_id": "MDU6TGFiZWwyMjM3OTY2MzI=",
      "url": "https://api.github.com/repos/rust-lang/rust/labels/relnotes",
      "name": "relnotes",
      "color": "fad8c7",
      "default": false,
      "description": "Marks issues that should be documented in the release notes of the next release."
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": {
    "login": "huonw",
    "id": 1203825,
    "node_id": "MDQ6VXNlcjEyMDM4MjU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1203825?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/huonw",
    "html_url": "https://github.com/huonw",
    "followers_url": "https://api.github.com/users/huonw/followers",
    "following_url": "https://api.github.com/users/huonw/following{/other_user}",
    "gists_url": "https://api.github.com/users/huonw/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/huonw/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/huonw/subscriptions",
    "organizations_url": "https://api.github.com/users/huonw/orgs",
    "repos_url": "https://api.github.com/users/huonw/repos",
    "events_url": "https://api.github.com/users/huonw/events{/privacy}",
    "received_events_url": "https://api.github.com/users/huonw/received_events",
    "type": "User",
    "user_view_type": "public",
    "site_admin": false
  },
  "assignees": [
    {
      "login": "huonw",
      "id": 1203825,
      "node_id": "MDQ6VXNlcjEyMDM4MjU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1203825?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/huonw",
      "html_url": "https://github.com/huonw",
      "followers_url": "https://api.github.com/users/huonw/followers",
      "following_url": "https://api.github.com/users/huonw/following{/other_user}",
      "gists_url": "https://api.github.com/users/huonw/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/huonw/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/huonw/subscriptions",
      "organizations_url": "https://api.github.com/users/huonw/orgs",
      "repos_url": "https://api.github.com/users/huonw/repos",
      "events_url": "https://api.github.com/users/huonw/events{/privacy}",
      "received_events_url": "https://api.github.com/users/huonw/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    }
  ],
  "milestone": null,
  "comments": 17,
  "created_at": "2015-07-10T21:41:30Z",
  "updated_at": "2015-07-17T20:30:19Z",
  "closed_at": "2015-07-17T08:03:33Z",
  "author_association": "CONTRIBUTOR",
  "type": null,
  "active_lock_reason": null,
  "draft": false,
  "pull_request": {
    "url": "https://api.github.com/repos/rust-lang/rust/pulls/26950",
    "html_url": "https://github.com/rust-lang/rust/pull/26950",
    "diff_url": "https://github.com/rust-lang/rust/pull/26950.diff",
    "patch_url": "https://github.com/rust-lang/rust/pull/26950.patch",
    "merged_at": "2015-07-17T08:03:33Z"
  },
  "body": "In general, it's undesirable to have read_to_end use a buffer with uninitialized memory, as that could lead to undefined behaviour in the event of a bad Read implementation.  Since we control the implementations of Read for Stdin and File, however, it should be okay for us to specialise them to improve performance.  This PR is to do that!\n\nAdds some unsafe code to deal with creating the buffers.  Since the read_to_end function needed to be used from the io and fs crates, I moved it into a newly-created sys::common::io module.  Alternatively we could expose the new read_to_end functions to allow people to create their own read_to_end implementations for code they trust.\n\nBenchmarks:\n\nRead a 2.5MB file:\nsys_common::io::tests::bench_init_file      ... bench:  27,473,317 ns/iter (+/- 2,490,767)\nsys_common::io::tests::bench_uninit_file    ... bench:  25,611,793 ns/iter (+/- 2,137,387)\n\nRead a buffer full of constant values\nsys_common::io::tests::bench_uninitialized  ... bench:  12,877,645 ns/iter (+/- 931,025)\nsys_common::io::tests::bench_zeroed         ... bench:  18,581,082 ns/iter (+/- 1,541,108)\n\nSo, approx a 7% speedup for file reading, which I think is worthwhile.\n",
  "closed_by": {
    "login": "bors",
    "id": 3372342,
    "node_id": "MDQ6VXNlcjMzNzIzNDI=",
    "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/bors",
    "html_url": "https://github.com/bors",
    "followers_url": "https://api.github.com/users/bors/followers",
    "following_url": "https://api.github.com/users/bors/following{/other_user}",
    "gists_url": "https://api.github.com/users/bors/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/bors/subscriptions",
    "organizations_url": "https://api.github.com/users/bors/orgs",
    "repos_url": "https://api.github.com/users/bors/repos",
    "events_url": "https://api.github.com/users/bors/events{/privacy}",
    "received_events_url": "https://api.github.com/users/bors/received_events",
    "type": "User",
    "user_view_type": "public",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/26950/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/26950/timeline",
  "performed_via_github_app": null,
  "state_reason": null,
  "_meta": {
    "type": "pr"
  }
}
