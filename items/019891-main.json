{
  "url": "https://api.github.com/repos/rust-lang/rust/issues/19891",
  "repository_url": "https://api.github.com/repos/rust-lang/rust",
  "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/19891/labels{/name}",
  "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/19891/comments",
  "events_url": "https://api.github.com/repos/rust-lang/rust/issues/19891/events",
  "html_url": "https://github.com/rust-lang/rust/pull/19891",
  "id": 52041544,
  "node_id": "MDExOlB1bGxSZXF1ZXN0MjYxMDMxODA=",
  "number": 19891,
  "title": "Implement unique types per fn item, rather than having all fn items have fn pointer type",
  "user": {
    "login": "nikomatsakis",
    "id": 155238,
    "node_id": "MDQ6VXNlcjE1NTIzOA==",
    "avatar_url": "https://avatars.githubusercontent.com/u/155238?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/nikomatsakis",
    "html_url": "https://github.com/nikomatsakis",
    "followers_url": "https://api.github.com/users/nikomatsakis/followers",
    "following_url": "https://api.github.com/users/nikomatsakis/following{/other_user}",
    "gists_url": "https://api.github.com/users/nikomatsakis/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/nikomatsakis/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/nikomatsakis/subscriptions",
    "organizations_url": "https://api.github.com/users/nikomatsakis/orgs",
    "repos_url": "https://api.github.com/users/nikomatsakis/repos",
    "events_url": "https://api.github.com/users/nikomatsakis/events{/privacy}",
    "received_events_url": "https://api.github.com/users/nikomatsakis/received_events",
    "type": "User",
    "user_view_type": "public",
    "site_admin": false
  },
  "labels": [],
  "state": "closed",
  "locked": false,
  "assignee": {
    "login": "nrc",
    "id": 762626,
    "node_id": "MDQ6VXNlcjc2MjYyNg==",
    "avatar_url": "https://avatars.githubusercontent.com/u/762626?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/nrc",
    "html_url": "https://github.com/nrc",
    "followers_url": "https://api.github.com/users/nrc/followers",
    "following_url": "https://api.github.com/users/nrc/following{/other_user}",
    "gists_url": "https://api.github.com/users/nrc/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/nrc/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/nrc/subscriptions",
    "organizations_url": "https://api.github.com/users/nrc/orgs",
    "repos_url": "https://api.github.com/users/nrc/repos",
    "events_url": "https://api.github.com/users/nrc/events{/privacy}",
    "received_events_url": "https://api.github.com/users/nrc/received_events",
    "type": "User",
    "user_view_type": "public",
    "site_admin": false
  },
  "assignees": [
    {
      "login": "nrc",
      "id": 762626,
      "node_id": "MDQ6VXNlcjc2MjYyNg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/762626?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nrc",
      "html_url": "https://github.com/nrc",
      "followers_url": "https://api.github.com/users/nrc/followers",
      "following_url": "https://api.github.com/users/nrc/following{/other_user}",
      "gists_url": "https://api.github.com/users/nrc/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nrc/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nrc/subscriptions",
      "organizations_url": "https://api.github.com/users/nrc/orgs",
      "repos_url": "https://api.github.com/users/nrc/repos",
      "events_url": "https://api.github.com/users/nrc/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nrc/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    }
  ],
  "milestone": null,
  "comments": 3,
  "created_at": "2014-12-15T21:32:16Z",
  "updated_at": "2014-12-23T05:02:06Z",
  "closed_at": "2014-12-23T05:02:06Z",
  "author_association": "CONTRIBUTOR",
  "type": null,
  "active_lock_reason": null,
  "draft": false,
  "pull_request": {
    "url": "https://api.github.com/repos/rust-lang/rust/pulls/19891",
    "html_url": "https://github.com/rust-lang/rust/pull/19891",
    "diff_url": "https://github.com/rust-lang/rust/pull/19891.diff",
    "patch_url": "https://github.com/rust-lang/rust/pull/19891.patch",
    "merged_at": "2014-12-23T05:02:06Z"
  },
  "body": "This is part of the coercion RFC but also makes sense given unboxed closures. The idea is that every fn item has its own type. This type can be coerced to a fn pointer but is not a fn pointer. This PR does almost all the end-user visible changes, but leaves one thing undone: the representation of an instance of a \"fn item type\" is still a fn pointer at runtime. A later PR will have to change them to zero-sized values (I'll open an isssue on this).\n\nThis is a [breaking-change]. In general, the coercion rules ensure that code which used to take a `fn()` type continus to work, but there are some patterns that need to be changed to insert explicit coercions.\n\nExample 1:\n\nIf/match arms sometimes require explicit types now:\n\n``` rust\nfn foo(x: int) -> int { x }\nfn bar(x: int) -> int { x + 1}\n\n// old:\n// let x = if some_cond { foo } else { bar };\n\n// new:\nlet x: fn(int) -> int = if some_cond { foo } else { bar } // coerce to a fn pointer\n```\n\nExample 2: \n\nGeneric functions are another place where coercions often fail to trigger. Example:\n\n``` rust\nfn foo(x: int) -> int { x }\n\nfn optional() -> Option<fn(int) -> int> {\n    // Old:\n    // Some(foo) // here the type argument on `Some` is inferred to be the fn item type\n\n    // New:\n    Some(foo as fn(int) -> int)\n}\n```\n\nThis one may or may not get fixed going forward; inserting coercions in cases like these involves subtle changes to program semantics that may not be appropriate.\n\nr? @nick29581 \n",
  "closed_by": {
    "login": "bors",
    "id": 3372342,
    "node_id": "MDQ6VXNlcjMzNzIzNDI=",
    "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/bors",
    "html_url": "https://github.com/bors",
    "followers_url": "https://api.github.com/users/bors/followers",
    "following_url": "https://api.github.com/users/bors/following{/other_user}",
    "gists_url": "https://api.github.com/users/bors/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/bors/subscriptions",
    "organizations_url": "https://api.github.com/users/bors/orgs",
    "repos_url": "https://api.github.com/users/bors/repos",
    "events_url": "https://api.github.com/users/bors/events{/privacy}",
    "received_events_url": "https://api.github.com/users/bors/received_events",
    "type": "User",
    "user_view_type": "public",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/19891/reactions",
    "total_count": 1,
    "+1": 1,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/19891/timeline",
  "performed_via_github_app": null,
  "state_reason": null,
  "_meta": {
    "type": "pr"
  }
}
