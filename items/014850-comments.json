[
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/62794741",
    "html_url": "https://github.com/rust-lang/rust/pull/14850#issuecomment-62794741",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/14850",
    "id": 62794741,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYyNzk0NzQx",
    "user": {
      "login": "wizeman",
      "id": 168610,
      "node_id": "MDQ6VXNlcjE2ODYxMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/168610?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/wizeman",
      "html_url": "https://github.com/wizeman",
      "followers_url": "https://api.github.com/users/wizeman/followers",
      "following_url": "https://api.github.com/users/wizeman/following{/other_user}",
      "gists_url": "https://api.github.com/users/wizeman/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/wizeman/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/wizeman/subscriptions",
      "organizations_url": "https://api.github.com/users/wizeman/orgs",
      "repos_url": "https://api.github.com/users/wizeman/repos",
      "events_url": "https://api.github.com/users/wizeman/events{/privacy}",
      "received_events_url": "https://api.github.com/users/wizeman/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-11-12T21:15:18Z",
    "updated_at": "2014-11-12T21:15:18Z",
    "body": "It seems like MPROTECT still needs to be disabled after all. Specifically, running `make test` fails with a `cannot make segment writable for relocation: Permission denied` error unless MPROTECT is disabled in the resulting binary of the `relocation-model` test, when using the `default` or `static` relocation models:\n\n``` diff\ndiff --git a/src/test/run-make/relocation-model/Makefile b/src/test/run-make/relocation-model/Makefile\nindex 2fcdd32..2d9ddb0 100644\n--- a/src/test/run-make/relocation-model/Makefile\n+++ b/src/test/run-make/relocation-model/Makefile\n@@ -5,9 +5,11 @@ all:\n >      $(call RUN,foo)\n$\n >      $(RUSTC) -C relocation-model=default foo.rs\n+>      paxctl -czexm $(TMPDIR)/foo\n >      $(call RUN,foo)\n$\n >      $(RUSTC) -C relocation-model=static foo.rs\n+>      paxctl -czexm $(TMPDIR)/foo\n >      $(call RUN,foo)\n$\n >      $(RUSTC) -C relocation-model=default --crate-type=dylib foo.rs\n```\n\nThe tests pass if the patch above is used, but I'm not sure if this should only be patched in the test's Makefile or if rustc itself should call paxctl. This was on a 64-bit system, BTW.\n\nAdditionally, if Rust is compiled with a 32-bit userland on a 64-bit kernel (which I'm using for testing), I can't even get rustc to compile, as it fails with a similar error during the build:\n\n```\n[q\u001b[pbuilding i686-unknown-linux-gnu/stage1/lib/rustlib/i686-unknown-linux-gnu/lib/libmorestack.a\ncp: i686-unknown-linux-gnu/stage1/lib/rustlib/i686-unknown-linux-gnu/lib/libmorestack.a\n\u001b[q\u001b[pbuilding i686-unknown-linux-gnu/stage1/lib/rustlib/i686-unknown-linux-gnu/lib/libcompiler-rt.a\ncp: i686-unknown-linux-gnu/stage1/lib/rustlib/i686-unknown-linux-gnu/lib/libcompiler-rt.a\n\u001b[q\u001b[pbuilding i686-unknown-linux-gnu/stage1/lib/rustlib/i686-unknown-linux-gnu/lib/stamp.core\nrustc: i686-unknown-linux-gnu/stage1/lib/rustlib/i686-unknown-linux-gnu/lib/libcore\ni686-unknown-linux-gnu/stage1/bin/rustc: error while loading shared libraries: /tmp/nix-build-rustc-0.12.0-pre-961-g93c85eb.drv-0/git-export/i686-unknown-linux-gnu/stage1/lib/librustrt-4e7c5e5c.so: cannot make segment writable for relocation: Permission denied\nmake: *** [i686-unknown-linux-gnu/stage1/lib/rustlib/i686-unknown-linux-gnu/lib/stamp.core] Error 127\n```\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/62794741/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/62795622",
    "html_url": "https://github.com/rust-lang/rust/pull/14850#issuecomment-62795622",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/14850",
    "id": 62795622,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYyNzk1NjIy",
    "user": {
      "login": "wizeman",
      "id": 168610,
      "node_id": "MDQ6VXNlcjE2ODYxMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/168610?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/wizeman",
      "html_url": "https://github.com/wizeman",
      "followers_url": "https://api.github.com/users/wizeman/followers",
      "following_url": "https://api.github.com/users/wizeman/following{/other_user}",
      "gists_url": "https://api.github.com/users/wizeman/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/wizeman/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/wizeman/subscriptions",
      "organizations_url": "https://api.github.com/users/wizeman/orgs",
      "repos_url": "https://api.github.com/users/wizeman/repos",
      "events_url": "https://api.github.com/users/wizeman/events{/privacy}",
      "received_events_url": "https://api.github.com/users/wizeman/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-11-12T21:19:58Z",
    "updated_at": "2014-11-12T21:20:24Z",
    "body": "The following FAQ has more info about this issue:\n\nhttp://wiki.gentoo.org/wiki/Hardened/FAQ#I_keep_getting_the_message:_.22error_while_loading_shared_libraries:_cannot_make_segment_writable_for_relocation:_Permission_denied..22_What_does_this_mean.3F\n\nBased on my reading of the FAQ, disabling MPROTECT is probably not the best way to handle the errors above, although I'm not sure what is the best way to fix it.\n\nI'm not using Gentoo, BTW.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/62795622/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/62796761",
    "html_url": "https://github.com/rust-lang/rust/pull/14850#issuecomment-62796761",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/14850",
    "id": 62796761,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYyNzk2NzYx",
    "user": {
      "login": "thestinger",
      "id": 1505226,
      "node_id": "MDQ6VXNlcjE1MDUyMjY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1505226?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/thestinger",
      "html_url": "https://github.com/thestinger",
      "followers_url": "https://api.github.com/users/thestinger/followers",
      "following_url": "https://api.github.com/users/thestinger/following{/other_user}",
      "gists_url": "https://api.github.com/users/thestinger/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/thestinger/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/thestinger/subscriptions",
      "organizations_url": "https://api.github.com/users/thestinger/orgs",
      "repos_url": "https://api.github.com/users/thestinger/repos",
      "events_url": "https://api.github.com/users/thestinger/events{/privacy}",
      "received_events_url": "https://api.github.com/users/thestinger/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-11-12T21:25:54Z",
    "updated_at": "2014-11-12T21:25:54Z",
    "body": "The test case is broken because it's mixing the static relocation model with dynamic linking.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/62796761/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/62797323",
    "html_url": "https://github.com/rust-lang/rust/pull/14850#issuecomment-62797323",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/14850",
    "id": 62797323,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYyNzk3MzIz",
    "user": {
      "login": "thestinger",
      "id": 1505226,
      "node_id": "MDQ6VXNlcjE1MDUyMjY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1505226?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/thestinger",
      "html_url": "https://github.com/thestinger",
      "followers_url": "https://api.github.com/users/thestinger/followers",
      "following_url": "https://api.github.com/users/thestinger/following{/other_user}",
      "gists_url": "https://api.github.com/users/thestinger/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/thestinger/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/thestinger/subscriptions",
      "organizations_url": "https://api.github.com/users/thestinger/orgs",
      "repos_url": "https://api.github.com/users/thestinger/repos",
      "events_url": "https://api.github.com/users/thestinger/events{/privacy}",
      "received_events_url": "https://api.github.com/users/thestinger/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-11-12T21:28:38Z",
    "updated_at": "2014-11-12T21:28:38Z",
    "body": "> It seems like MPROTECT still needs to be disabled after all. \n\nThe issue you're reporting has nothing to do with this old `paxctl` code used to mark the Rust compiler binaries since they included a JIT compiler.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/62797323/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
