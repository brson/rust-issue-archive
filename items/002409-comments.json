[
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/5805572",
    "html_url": "https://github.com/rust-lang/rust/pull/2409#issuecomment-5805572",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/2409",
    "id": 5805572,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU4MDU1NzI=",
    "user": {
      "login": "brson",
      "id": 147214,
      "node_id": "MDQ6VXNlcjE0NzIxNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/brson",
      "html_url": "https://github.com/brson",
      "followers_url": "https://api.github.com/users/brson/followers",
      "following_url": "https://api.github.com/users/brson/following{/other_user}",
      "gists_url": "https://api.github.com/users/brson/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/brson/subscriptions",
      "organizations_url": "https://api.github.com/users/brson/orgs",
      "repos_url": "https://api.github.com/users/brson/repos",
      "events_url": "https://api.github.com/users/brson/events{/privacy}",
      "received_events_url": "https://api.github.com/users/brson/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2012-05-19T23:38:05Z",
    "updated_at": "2012-05-19T23:38:05Z",
    "body": "How safe is `conn_recv_spawn`? Do you have to ensure the server_port outlives the task handling the connection?\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/5805572/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/5809227",
    "html_url": "https://github.com/rust-lang/rust/pull/2409#issuecomment-5809227",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/2409",
    "id": 5809227,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU4MDkyMjc=",
    "user": {
      "login": "olsonjeffery",
      "id": 10408,
      "node_id": "MDQ6VXNlcjEwNDA4",
      "avatar_url": "https://avatars.githubusercontent.com/u/10408?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/olsonjeffery",
      "html_url": "https://github.com/olsonjeffery",
      "followers_url": "https://api.github.com/users/olsonjeffery/followers",
      "following_url": "https://api.github.com/users/olsonjeffery/following{/other_user}",
      "gists_url": "https://api.github.com/users/olsonjeffery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/olsonjeffery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/olsonjeffery/subscriptions",
      "organizations_url": "https://api.github.com/users/olsonjeffery/orgs",
      "repos_url": "https://api.github.com/users/olsonjeffery/repos",
      "events_url": "https://api.github.com/users/olsonjeffery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/olsonjeffery/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2012-05-20T14:24:45Z",
    "updated_at": "2012-05-20T14:24:45Z",
    "body": "@brson ok, so once the `new_conn_po` in `conn_recv_spawn` recvs, we have a valid stream for the client. We then pass that valid stream into a new task, where a `tcp_socket` is created and is then passed to the user-supplied callback. At this point, `conn_recv_spawn` returns.. So if the `server_port` goes out of scope and tears down during/before the body of the callback is ran, then operations against the client stream (contained in the `tcp_socket`) will error out.\n\nIdeally, the user would keep the `server_port` bottled up in a loop or somesuch, so this wouldn't be an issue. But if it does happen, it won't be a catostrophic failure/segfault, since the stream contained in the `tcp_socket` is a different one from the stream contained in the `server_port`/`tcp_conn_port` (the client stream is created in `tcp_nl_on_connection_cb` L884, with the call to `malloc_uv_tcp_t`)\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/5809227/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/5866321",
    "html_url": "https://github.com/rust-lang/rust/pull/2409#issuecomment-5866321",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/2409",
    "id": 5866321,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU4NjYzMjE=",
    "user": {
      "login": "brson",
      "id": 147214,
      "node_id": "MDQ6VXNlcjE0NzIxNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/brson",
      "html_url": "https://github.com/brson",
      "followers_url": "https://api.github.com/users/brson/followers",
      "following_url": "https://api.github.com/users/brson/following{/other_user}",
      "gists_url": "https://api.github.com/users/brson/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/brson/subscriptions",
      "organizations_url": "https://api.github.com/users/brson/orgs",
      "repos_url": "https://api.github.com/users/brson/repos",
      "events_url": "https://api.github.com/users/brson/events{/privacy}",
      "received_events_url": "https://api.github.com/users/brson/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2012-05-23T06:51:46Z",
    "updated_at": "2012-05-23T06:51:46Z",
    "body": "Merged!\n\nThanks for this huge amount of work and for writing such of thorough description in the pull request.\n\nI've read a fair bit of the code now and I am happy with the direction we're going. The overall design seems to get a little clearer every iteration. I have yet to take a close look at the final tcp interface, though I do intend to. Integrating it with servo might help me get a better feel for where we are - this week I will try to do some experiments with it.\n\nSome miscellaneous things we should consider for the future:\n- We need to figure out the right abstractions to make the high level APIs memory-safe. Atomic ref counted types will help.\n- The safe APIs need clearly defined failure modes with accompanying tests. Using the high-level API it ultimately shouldn't be possible to break the uv loop, even when any client tasks fail.\n- At some point we need to think about how rust's I/O API's (streams in particular) should look and how uv fits in.\n\nI am going to leave this pull request open a while longer because I want to come back to it again.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/5866321/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/5871043",
    "html_url": "https://github.com/rust-lang/rust/pull/2409#issuecomment-5871043",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/2409",
    "id": 5871043,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU4NzEwNDM=",
    "user": {
      "login": "olsonjeffery",
      "id": 10408,
      "node_id": "MDQ6VXNlcjEwNDA4",
      "avatar_url": "https://avatars.githubusercontent.com/u/10408?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/olsonjeffery",
      "html_url": "https://github.com/olsonjeffery",
      "followers_url": "https://api.github.com/users/olsonjeffery/followers",
      "following_url": "https://api.github.com/users/olsonjeffery/following{/other_user}",
      "gists_url": "https://api.github.com/users/olsonjeffery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/olsonjeffery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/olsonjeffery/subscriptions",
      "organizations_url": "https://api.github.com/users/olsonjeffery/orgs",
      "repos_url": "https://api.github.com/users/olsonjeffery/repos",
      "events_url": "https://api.github.com/users/olsonjeffery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/olsonjeffery/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2012-05-23T12:05:33Z",
    "updated_at": "2012-05-23T12:05:33Z",
    "body": "thanks for fixing timer, with the send/copy kind change. I did a fix last night, but was running tests overnight, so you beat me to it.\n\n100% agreement on all points. we're getting there. \n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/5871043/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
