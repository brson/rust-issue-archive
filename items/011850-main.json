{
  "url": "https://api.github.com/repos/rust-lang/rust/issues/11850",
  "repository_url": "https://api.github.com/repos/rust-lang/rust",
  "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/11850/labels{/name}",
  "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/11850/comments",
  "events_url": "https://api.github.com/repos/rust-lang/rust/issues/11850/events",
  "html_url": "https://github.com/rust-lang/rust/pull/11850",
  "id": 26384061,
  "node_id": "MDExOlB1bGxSZXF1ZXN0MTE5MTYwMDE=",
  "number": 11850,
  "title": "check for broken pipe when streaming the output.",
  "user": {
    "login": "abhaykadam",
    "id": 1008013,
    "node_id": "MDQ6VXNlcjEwMDgwMTM=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1008013?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/abhaykadam",
    "html_url": "https://github.com/abhaykadam",
    "followers_url": "https://api.github.com/users/abhaykadam/followers",
    "following_url": "https://api.github.com/users/abhaykadam/following{/other_user}",
    "gists_url": "https://api.github.com/users/abhaykadam/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/abhaykadam/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/abhaykadam/subscriptions",
    "organizations_url": "https://api.github.com/users/abhaykadam/orgs",
    "repos_url": "https://api.github.com/users/abhaykadam/repos",
    "events_url": "https://api.github.com/users/abhaykadam/events{/privacy}",
    "received_events_url": "https://api.github.com/users/abhaykadam/received_events",
    "type": "User",
    "user_view_type": "public",
    "site_admin": false
  },
  "labels": [],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [],
  "milestone": null,
  "comments": 6,
  "created_at": "2014-01-27T19:29:38Z",
  "updated_at": "2014-06-18T10:32:24Z",
  "closed_at": "2014-01-29T17:32:28Z",
  "author_association": "NONE",
  "type": null,
  "active_lock_reason": null,
  "draft": false,
  "pull_request": {
    "url": "https://api.github.com/repos/rust-lang/rust/pulls/11850",
    "html_url": "https://github.com/rust-lang/rust/pull/11850",
    "diff_url": "https://github.com/rust-lang/rust/pull/11850.diff",
    "patch_url": "https://github.com/rust-lang/rust/pull/11850.patch",
    "merged_at": null
  },
  "body": "For instance, if we give command:\n\n```\n$rust | xargs -v\n```\n\nwe get,\n\n```\nxargs: illegal option -- v\n\nusage: xargs [-0opt] [-E eofstr] [-I replstr [-R replacements]] [-J replstr]\n\n             [-L number] [-n number [-x]] [-P maxprocs] [-s size]\n\n             [utility [argument ...]]\n\nerror: internal compiler error: unexpected failure\n\nThis message reflects a bug in the Rust compiler.\n\nWe would appreciate a bug report: http://static.rust-lang.org/doc/master/complement-bugreport.html\n\nnote: the compiler hit an unexpected failure path. this is a bug\n\ntask '<main>' failed at 'Unhandled condition: io_error: io::IoError{kind: BrokenPipe, desc: \"broken pipe\", detail: None}', /Users/abhay/devel/rust/rust/src/libstd/condition.rs:139\n```\n\nThe `BrokenPipe` (or `EPIPE`) occurs when the receiving-end process returns non-zero exit-status.\n\nI tested raising the condition with following `C` code:\n\n```\n//C File: test_line.c\n#include <stdio.h>\n\nint main() {\n    char *line = NULL;\n    size_t linecap = 0;\n    ssize_t linelen;\n\n    while ((linelen = getline(&line, &linecap, stdin)) > 0)\n        fwrite(line, linelen, 1, stdout);   \n\n    return 1;\n}\n\n```\n\nThe above code returns 1 after reading everything from the piped process.\nThe commands i executed:\n\n```\n$clang test_line.c -o test_line\n$rustc | ./test_line\n```\n\nThe last command gave the `unexpected failure` error.\n\nThis patch checks if raised condition is not BrokenPipe, and otherwise, it raised the condition.\n",
  "closed_by": {
    "login": "alexcrichton",
    "id": 64996,
    "node_id": "MDQ6VXNlcjY0OTk2",
    "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/alexcrichton",
    "html_url": "https://github.com/alexcrichton",
    "followers_url": "https://api.github.com/users/alexcrichton/followers",
    "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}",
    "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions",
    "organizations_url": "https://api.github.com/users/alexcrichton/orgs",
    "repos_url": "https://api.github.com/users/alexcrichton/repos",
    "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}",
    "received_events_url": "https://api.github.com/users/alexcrichton/received_events",
    "type": "User",
    "user_view_type": "public",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/11850/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/11850/timeline",
  "performed_via_github_app": null,
  "state_reason": null,
  "_meta": {
    "type": "pr"
  }
}
