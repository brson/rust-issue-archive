[
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/155981574",
    "html_url": "https://github.com/rust-lang/rust/issues/29793#issuecomment-155981574",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/29793",
    "id": 155981574,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE1NTk4MTU3NA==",
    "user": {
      "login": "Aatch",
      "id": 342416,
      "node_id": "MDQ6VXNlcjM0MjQxNg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/342416?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Aatch",
      "html_url": "https://github.com/Aatch",
      "followers_url": "https://api.github.com/users/Aatch/followers",
      "following_url": "https://api.github.com/users/Aatch/following{/other_user}",
      "gists_url": "https://api.github.com/users/Aatch/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Aatch/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Aatch/subscriptions",
      "organizations_url": "https://api.github.com/users/Aatch/orgs",
      "repos_url": "https://api.github.com/users/Aatch/repos",
      "events_url": "https://api.github.com/users/Aatch/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Aatch/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-11-12T02:46:54Z",
    "updated_at": "2015-11-12T02:46:54Z",
    "body": "I'm looking into this, trying to get a reasonably accurate reproduction and have come across this:\n\n``` rust\nfn main() {\n    let x = Some(|x: usize, y: usize| {\n        |t: bool| if t { x } else { y }\n    });\n\n    // If the following line is uncommented, it doesn't compile\n    //use_(x);\n}\n\nfn use_<G, F: FnMut(usize, usize) -> G>(f: Option<F>) {\n    if let Some(mut f) = f {\n        let _ = f(1, 2);\n    }\n}\n```\n\nhttps://play.rust-lang.org/?gist=b4a25867408e0056c8f3&version=stable\n\nWhich I believe is related.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/155981574/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/155986340",
    "html_url": "https://github.com/rust-lang/rust/issues/29793#issuecomment-155986340",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/29793",
    "id": 155986340,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE1NTk4NjM0MA==",
    "user": {
      "login": "Aatch",
      "id": 342416,
      "node_id": "MDQ6VXNlcjM0MjQxNg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/342416?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Aatch",
      "html_url": "https://github.com/Aatch",
      "followers_url": "https://api.github.com/users/Aatch/followers",
      "following_url": "https://api.github.com/users/Aatch/following{/other_user}",
      "gists_url": "https://api.github.com/users/Aatch/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Aatch/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Aatch/subscriptions",
      "organizations_url": "https://api.github.com/users/Aatch/orgs",
      "repos_url": "https://api.github.com/users/Aatch/repos",
      "events_url": "https://api.github.com/users/Aatch/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Aatch/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-11-12T03:28:34Z",
    "updated_at": "2015-11-12T03:38:48Z",
    "body": "Woo! Took me a while, but here is a minimal(-ish) reproduction (while still being similar to the original example):\n\n``` rust\nstruct WrapA<F>(Option<F>);\n\nimpl<F> WrapA<F> {\n    fn new() -> WrapA<F> {\n        WrapA(None)\n    }\n    fn set(mut self, f: F) -> Self {\n        self.0 = Some(f);\n        self\n    }\n}\n\nstruct WrapB<F>(Option<F>);\n\nimpl<F> WrapB<F> {\n    fn new() -> WrapB<F> {\n        WrapB(None)\n    }\n    fn set(mut self, f: F) -> Self {\n        self.0 = Some(f);\n        self\n    }\n}\n\ntrait DoStuff : Sized {\n    fn handle(self);\n}\n\nimpl<F, T> DoStuff for WrapA<F> \nwhere F: FnMut(usize, usize) -> T, T: DoStuff {\n    fn handle(mut self) {\n        if let Some(ref mut f) = self.0 {\n            let x = f(1, 2);\n            let _foo = [0usize; 16];\n            x.handle();\n        }\n    }\n}\n\nimpl<F> DoStuff for WrapB<F> where F: FnMut(bool) -> usize {\n    fn handle(mut self) {\n        if let Some(ref mut f) = self.0 {\n            println!(\"{}\", f(true));\n        }\n    }\n}\n\nimpl<F, T> WrapA<F> \nwhere F: FnMut(usize, usize) -> T, T: DoStuff {\n    fn handle_ref(&mut self) {\n        if let Some(ref mut f) = self.0 {\n            let x = f(1, 2);\n        }\n    }\n}\n\nfn main() {\n    let mut w = WrapA::new().set(|x: usize, y: usize| {\n        WrapB::new().set(|t: bool| if t { x } else { y })\n    })\n    w.handle(); // This works\n    // w.handle_ref(); // This doesn't\n}\n```\n\nhttps://play.rust-lang.org/?gist=330b4ee92fecd1c8f499&version=stable\n\n~~I think the move of the wrapping type has something to do with it, given that `handle_ref` doesn't work, while `handle` does.~~\n\nNope, just double-checked and it's actually inherent vs. trait methods. Making an identical `handle` method on `WrapA` directly works (as in, it causes the expected error) just fine. No idea why that would be the case though.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/155986340/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/155987840",
    "html_url": "https://github.com/rust-lang/rust/issues/29793#issuecomment-155987840",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/29793",
    "id": 155987840,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE1NTk4Nzg0MA==",
    "user": {
      "login": "Aatch",
      "id": 342416,
      "node_id": "MDQ6VXNlcjM0MjQxNg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/342416?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Aatch",
      "html_url": "https://github.com/Aatch",
      "followers_url": "https://api.github.com/users/Aatch/followers",
      "following_url": "https://api.github.com/users/Aatch/following{/other_user}",
      "gists_url": "https://api.github.com/users/Aatch/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Aatch/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Aatch/subscriptions",
      "organizations_url": "https://api.github.com/users/Aatch/orgs",
      "repos_url": "https://api.github.com/users/Aatch/repos",
      "events_url": "https://api.github.com/users/Aatch/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Aatch/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-11-12T03:43:51Z",
    "updated_at": "2015-11-12T03:47:09Z",
    "body": "I decided to go back to my simple case:\n\n``` rust\nfn main() {\n    let _x = |x: usize, y: usize| {\n        |t: bool| if t { x } else { y }\n    };\n```\n\nThis compiles (and probably shouldn't), while the following doesn't (which is expected):\n\n``` rust\nfn main() {\n    let _x = |x: usize, y: usize| {\n        let x = x;\n        let y = y;\n        |t: bool| if t { x } else { y }\n    };\n```\n\nThis suggests to me that the lifetimes associated with the `x` and `y` arguments are slightly too long.\n\nAlso /cc @rust-lang/compiler \n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/155987840/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/156109953",
    "html_url": "https://github.com/rust-lang/rust/issues/29793#issuecomment-156109953",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/29793",
    "id": 156109953,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE1NjEwOTk1Mw==",
    "user": {
      "login": "nikomatsakis",
      "id": 155238,
      "node_id": "MDQ6VXNlcjE1NTIzOA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/155238?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nikomatsakis",
      "html_url": "https://github.com/nikomatsakis",
      "followers_url": "https://api.github.com/users/nikomatsakis/followers",
      "following_url": "https://api.github.com/users/nikomatsakis/following{/other_user}",
      "gists_url": "https://api.github.com/users/nikomatsakis/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nikomatsakis/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nikomatsakis/subscriptions",
      "organizations_url": "https://api.github.com/users/nikomatsakis/orgs",
      "repos_url": "https://api.github.com/users/nikomatsakis/repos",
      "events_url": "https://api.github.com/users/nikomatsakis/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nikomatsakis/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-11-12T14:03:47Z",
    "updated_at": "2015-11-12T14:03:47Z",
    "body": "agreed, seems wrong. sigh.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/156109953/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/156109970",
    "html_url": "https://github.com/rust-lang/rust/issues/29793#issuecomment-156109970",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/29793",
    "id": 156109970,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE1NjEwOTk3MA==",
    "user": {
      "login": "nikomatsakis",
      "id": 155238,
      "node_id": "MDQ6VXNlcjE1NTIzOA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/155238?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nikomatsakis",
      "html_url": "https://github.com/nikomatsakis",
      "followers_url": "https://api.github.com/users/nikomatsakis/followers",
      "following_url": "https://api.github.com/users/nikomatsakis/following{/other_user}",
      "gists_url": "https://api.github.com/users/nikomatsakis/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nikomatsakis/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nikomatsakis/subscriptions",
      "organizations_url": "https://api.github.com/users/nikomatsakis/orgs",
      "repos_url": "https://api.github.com/users/nikomatsakis/repos",
      "events_url": "https://api.github.com/users/nikomatsakis/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nikomatsakis/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-11-12T14:03:52Z",
    "updated_at": "2015-11-12T14:03:52Z",
    "body": "triage: P-high\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/156109970/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/156813631",
    "html_url": "https://github.com/rust-lang/rust/issues/29793#issuecomment-156813631",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/29793",
    "id": 156813631,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE1NjgxMzYzMQ==",
    "user": {
      "login": "arielb1",
      "id": 1830974,
      "node_id": "MDQ6VXNlcjE4MzA5NzQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1830974?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/arielb1",
      "html_url": "https://github.com/arielb1",
      "followers_url": "https://api.github.com/users/arielb1/followers",
      "following_url": "https://api.github.com/users/arielb1/following{/other_user}",
      "gists_url": "https://api.github.com/users/arielb1/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/arielb1/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/arielb1/subscriptions",
      "organizations_url": "https://api.github.com/users/arielb1/orgs",
      "repos_url": "https://api.github.com/users/arielb1/repos",
      "events_url": "https://api.github.com/users/arielb1/events{/privacy}",
      "received_events_url": "https://api.github.com/users/arielb1/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-11-15T14:00:06Z",
    "updated_at": "2015-11-15T14:00:26Z",
    "body": "The issue is that:\n    \\* Closure signatures are not required to be well-formed.\n    \\* That would not be regularly a problem, as regions in closure signatures are supposed to always outlive the closure.\n    \\* However, parameters are regarded as being \"outside\" the closure, so they pass this check.\n\nI am not sure of the best way to fix this. Maybe add an actual \"root\" region wrapping a closure, instead of using the DestructionScope?\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/156813631/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/158202296",
    "html_url": "https://github.com/rust-lang/rust/issues/29793#issuecomment-158202296",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/29793",
    "id": 158202296,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE1ODIwMjI5Ng==",
    "user": {
      "login": "pnkfelix",
      "id": 173127,
      "node_id": "MDQ6VXNlcjE3MzEyNw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/173127?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/pnkfelix",
      "html_url": "https://github.com/pnkfelix",
      "followers_url": "https://api.github.com/users/pnkfelix/followers",
      "following_url": "https://api.github.com/users/pnkfelix/following{/other_user}",
      "gists_url": "https://api.github.com/users/pnkfelix/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/pnkfelix/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/pnkfelix/subscriptions",
      "organizations_url": "https://api.github.com/users/pnkfelix/orgs",
      "repos_url": "https://api.github.com/users/pnkfelix/repos",
      "events_url": "https://api.github.com/users/pnkfelix/events{/privacy}",
      "received_events_url": "https://api.github.com/users/pnkfelix/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-11-19T21:24:34Z",
    "updated_at": "2015-11-19T21:24:34Z",
    "body": "assigning to self to try to help niko with his plate of stuff\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/158202296/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/163713042",
    "html_url": "https://github.com/rust-lang/rust/issues/29793#issuecomment-163713042",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/29793",
    "id": 163713042,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE2MzcxMzA0Mg==",
    "user": {
      "login": "pnkfelix",
      "id": 173127,
      "node_id": "MDQ6VXNlcjE3MzEyNw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/173127?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/pnkfelix",
      "html_url": "https://github.com/pnkfelix",
      "followers_url": "https://api.github.com/users/pnkfelix/followers",
      "following_url": "https://api.github.com/users/pnkfelix/following{/other_user}",
      "gists_url": "https://api.github.com/users/pnkfelix/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/pnkfelix/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/pnkfelix/subscriptions",
      "organizations_url": "https://api.github.com/users/pnkfelix/orgs",
      "repos_url": "https://api.github.com/users/pnkfelix/repos",
      "events_url": "https://api.github.com/users/pnkfelix/events{/privacy}",
      "received_events_url": "https://api.github.com/users/pnkfelix/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-12-10T18:40:57Z",
    "updated_at": "2015-12-10T18:40:57Z",
    "body": "Okay, I've done something much like what @arielb1 described, namely adding a new `Scope` variant that outlives the `ParameterScope` and then using that for these lifetimes, rather than `DestructionScope`.\n\nI should have a PR up shortly, assuming my `make check` run passes... \n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/163713042/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
