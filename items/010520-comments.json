[
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/29002326",
    "html_url": "https://github.com/rust-lang/rust/issues/10520#issuecomment-29002326",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10520",
    "id": 29002326,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI5MDAyMzI2",
    "user": {
      "login": "pnkfelix",
      "id": 173127,
      "node_id": "MDQ6VXNlcjE3MzEyNw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/173127?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/pnkfelix",
      "html_url": "https://github.com/pnkfelix",
      "followers_url": "https://api.github.com/users/pnkfelix/followers",
      "following_url": "https://api.github.com/users/pnkfelix/following{/other_user}",
      "gists_url": "https://api.github.com/users/pnkfelix/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/pnkfelix/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/pnkfelix/subscriptions",
      "organizations_url": "https://api.github.com/users/pnkfelix/orgs",
      "repos_url": "https://api.github.com/users/pnkfelix/repos",
      "events_url": "https://api.github.com/users/pnkfelix/events{/privacy}",
      "received_events_url": "https://api.github.com/users/pnkfelix/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2013-11-21T17:04:44Z",
    "updated_at": "2013-11-21T17:04:44Z",
    "body": "cc me\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/29002326/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/32472204",
    "html_url": "https://github.com/rust-lang/rust/issues/10520#issuecomment-32472204",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10520",
    "id": 32472204,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMyNDcyMjA0",
    "user": {
      "login": "nikomatsakis",
      "id": 155238,
      "node_id": "MDQ6VXNlcjE1NTIzOA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/155238?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nikomatsakis",
      "html_url": "https://github.com/nikomatsakis",
      "followers_url": "https://api.github.com/users/nikomatsakis/followers",
      "following_url": "https://api.github.com/users/nikomatsakis/following{/other_user}",
      "gists_url": "https://api.github.com/users/nikomatsakis/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nikomatsakis/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nikomatsakis/subscriptions",
      "organizations_url": "https://api.github.com/users/nikomatsakis/orgs",
      "repos_url": "https://api.github.com/users/nikomatsakis/repos",
      "events_url": "https://api.github.com/users/nikomatsakis/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nikomatsakis/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-01-16T14:19:51Z",
    "updated_at": "2014-01-16T14:19:51Z",
    "body": "Issue #11558 includes another example.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/32472204/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/51032163",
    "html_url": "https://github.com/rust-lang/rust/issues/10520#issuecomment-51032163",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10520",
    "id": 51032163,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUxMDMyMTYz",
    "user": {
      "login": "huonw",
      "id": 1203825,
      "node_id": "MDQ6VXNlcjEyMDM4MjU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1203825?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/huonw",
      "html_url": "https://github.com/huonw",
      "followers_url": "https://api.github.com/users/huonw/followers",
      "following_url": "https://api.github.com/users/huonw/following{/other_user}",
      "gists_url": "https://api.github.com/users/huonw/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/huonw/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/huonw/subscriptions",
      "organizations_url": "https://api.github.com/users/huonw/orgs",
      "repos_url": "https://api.github.com/users/huonw/repos",
      "events_url": "https://api.github.com/users/huonw/events{/privacy}",
      "received_events_url": "https://api.github.com/users/huonw/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-08-04T08:54:17Z",
    "updated_at": "2014-08-04T08:54:17Z",
    "body": "Triage, no change that I know of.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/51032163/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/69399820",
    "html_url": "https://github.com/rust-lang/rust/issues/10520#issuecomment-69399820",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10520",
    "id": 69399820,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY5Mzk5ODIw",
    "user": {
      "login": "nikomatsakis",
      "id": 155238,
      "node_id": "MDQ6VXNlcjE1NTIzOA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/155238?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nikomatsakis",
      "html_url": "https://github.com/nikomatsakis",
      "followers_url": "https://api.github.com/users/nikomatsakis/followers",
      "following_url": "https://api.github.com/users/nikomatsakis/following{/other_user}",
      "gists_url": "https://api.github.com/users/nikomatsakis/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nikomatsakis/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nikomatsakis/subscriptions",
      "organizations_url": "https://api.github.com/users/nikomatsakis/orgs",
      "repos_url": "https://api.github.com/users/nikomatsakis/repos",
      "events_url": "https://api.github.com/users/nikomatsakis/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nikomatsakis/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-01-09T21:13:37Z",
    "updated_at": "2015-01-09T21:13:37Z",
    "body": "This may have become more important. As part of https://github.com/rust-lang/rust/pull/20341, we started doing coercions on assignments of the form:\n\n``` rust\nx = y\n```\n\nIf `x` has type `&mut X`, then this causes a reborrow of `y` whereas it used to cause a move. Unfortunately, this can break [code that used to work](https://github.com/RustOS-Fork-Holding-Ground/intrusive-red-black-tree/blob/master/src/red_black.rs#L284-L303). Here is a reduced example:\n\n``` rust\nfn foo(mut vec: Vec<int>) {\n    let mut iter = vec.iter_mut();\n    let mut cur = iter.next().unwrap();\n    let mut next = iter.next().unwrap();\n    loop {\n        *next = 22; // ERROR cannot assign to `next` because it is borrowed\n        cur = next; // NOTE borrowed here\n        next = iter.next().unwrap();\n    }\n}\nfn main() {}\n```\n\nThis can be worked around by forcing a move using a dummy newtype:\n\n``` rust\nstruct Dummy<T>(T);\n\nfn foo(mut vec: Vec<isize>) {\n    let mut iter = vec.iter_mut();\n    let mut cur = Dummy(iter.next().unwrap());\n    let mut next = iter.next().unwrap();\n    loop {\n        *next = 22;\n        cur = Dummy(next);\n        next = iter.next().unwrap();\n    }\n}\nfn main() {}\n```\n\nBut that's awful!\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/69399820/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/69400099",
    "html_url": "https://github.com/rust-lang/rust/issues/10520#issuecomment-69400099",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10520",
    "id": 69400099,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY5NDAwMDk5",
    "user": {
      "login": "nikomatsakis",
      "id": 155238,
      "node_id": "MDQ6VXNlcjE1NTIzOA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/155238?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nikomatsakis",
      "html_url": "https://github.com/nikomatsakis",
      "followers_url": "https://api.github.com/users/nikomatsakis/followers",
      "following_url": "https://api.github.com/users/nikomatsakis/following{/other_user}",
      "gists_url": "https://api.github.com/users/nikomatsakis/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nikomatsakis/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nikomatsakis/subscriptions",
      "organizations_url": "https://api.github.com/users/nikomatsakis/orgs",
      "repos_url": "https://api.github.com/users/nikomatsakis/repos",
      "events_url": "https://api.github.com/users/nikomatsakis/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nikomatsakis/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-01-09T21:15:34Z",
    "updated_at": "2015-01-09T21:15:34Z",
    "body": "Nominating because it may be worth trying to fix this for ergonomic reasons (or else maybe reverting the coercion change).\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/69400099/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/232724051",
    "html_url": "https://github.com/rust-lang/rust/issues/10520#issuecomment-232724051",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10520",
    "id": 232724051,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIzMjcyNDA1MQ==",
    "user": {
      "login": "brson",
      "id": 147214,
      "node_id": "MDQ6VXNlcjE0NzIxNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/brson",
      "html_url": "https://github.com/brson",
      "followers_url": "https://api.github.com/users/brson/followers",
      "following_url": "https://api.github.com/users/brson/following{/other_user}",
      "gists_url": "https://api.github.com/users/brson/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/brson/subscriptions",
      "organizations_url": "https://api.github.com/users/brson/orgs",
      "repos_url": "https://api.github.com/users/brson/repos",
      "events_url": "https://api.github.com/users/brson/events{/privacy}",
      "received_events_url": "https://api.github.com/users/brson/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2016-07-14T16:50:10Z",
    "updated_at": "2016-07-14T16:50:10Z",
    "body": "Triage: closing. Old wishlist. Do RFC.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/232724051/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/390283309",
    "html_url": "https://github.com/rust-lang/rust/issues/10520#issuecomment-390283309",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10520",
    "id": 390283309,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM5MDI4MzMwOQ==",
    "user": {
      "login": "shepmaster",
      "id": 174509,
      "node_id": "MDQ6VXNlcjE3NDUwOQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/174509?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/shepmaster",
      "html_url": "https://github.com/shepmaster",
      "followers_url": "https://api.github.com/users/shepmaster/followers",
      "following_url": "https://api.github.com/users/shepmaster/following{/other_user}",
      "gists_url": "https://api.github.com/users/shepmaster/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/shepmaster/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/shepmaster/subscriptions",
      "organizations_url": "https://api.github.com/users/shepmaster/orgs",
      "repos_url": "https://api.github.com/users/shepmaster/repos",
      "events_url": "https://api.github.com/users/shepmaster/events{/privacy}",
      "received_events_url": "https://api.github.com/users/shepmaster/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2018-05-18T17:51:31Z",
    "updated_at": "2018-05-18T17:52:21Z",
    "body": "Zombie revivification. The updated example is \r\n\r\n```rust\r\nfn foo(mut vec: Vec<i32>) {\r\n    let mut iter = vec.iter_mut();\r\n    let mut cur = iter.next().unwrap();\r\n    let mut next = iter.next().unwrap();\r\n    loop {\r\n        *next = 22;\r\n        cur = next;\r\n        next = iter.next().unwrap();\r\n    }\r\n}\r\nfn main() {}\r\n```\r\n\r\nAnd error:\r\n\r\n```\r\nerror[E0506]: cannot assign to `*next` because it is borrowed\r\n --> src/main.rs:6:9\r\n  |\r\n6 |         *next = 22;\r\n  |         ^^^^^^^^^^ assignment to borrowed `*next` occurs here\r\n7 |         cur = next;\r\n  |               ---- borrow of `*next` occurs here\r\n\r\nerror[E0499]: cannot borrow `*next` as mutable more than once at a time\r\n  --> src/main.rs:7:15\r\n   |\r\n7  |         cur = next;\r\n   |               ^^^^ mutable borrow starts here in previous iteration of loop\r\n...\r\n10 | }\r\n   | - mutable borrow ends here\r\n\r\nerror[E0506]: cannot assign to `next` because it is borrowed\r\n --> src/main.rs:8:9\r\n  |\r\n7 |         cur = next;\r\n  |               ---- borrow of `next` occurs here\r\n8 |         next = iter.next().unwrap();\r\n  |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^ assignment to borrowed `next` occurs here\r\n```\r\n\r\nThis code now compiles with NLL enabled.",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/390283309/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
