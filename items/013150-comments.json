[
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/38648659",
    "html_url": "https://github.com/rust-lang/rust/pull/13150#issuecomment-38648659",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/13150",
    "id": 38648659,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM4NjQ4NjU5",
    "user": {
      "login": "nrc",
      "id": 762626,
      "node_id": "MDQ6VXNlcjc2MjYyNg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/762626?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nrc",
      "html_url": "https://github.com/nrc",
      "followers_url": "https://api.github.com/users/nrc/followers",
      "following_url": "https://api.github.com/users/nrc/following{/other_user}",
      "gists_url": "https://api.github.com/users/nrc/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nrc/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nrc/subscriptions",
      "organizations_url": "https://api.github.com/users/nrc/orgs",
      "repos_url": "https://api.github.com/users/nrc/repos",
      "events_url": "https://api.github.com/users/nrc/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nrc/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-03-26T04:18:42Z",
    "updated_at": "2014-03-26T04:18:42Z",
    "body": "TBH, I have no idea if the call site, name, and span are right. It would be nice to have some more documentation around these things.\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/38648659/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/38649041",
    "html_url": "https://github.com/rust-lang/rust/pull/13150#issuecomment-38649041",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/13150",
    "id": 38649041,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM4NjQ5MDQx",
    "user": {
      "login": "emberian",
      "id": 704250,
      "node_id": "MDQ6VXNlcjcwNDI1MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/704250?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/emberian",
      "html_url": "https://github.com/emberian",
      "followers_url": "https://api.github.com/users/emberian/followers",
      "following_url": "https://api.github.com/users/emberian/following{/other_user}",
      "gists_url": "https://api.github.com/users/emberian/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/emberian/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/emberian/subscriptions",
      "organizations_url": "https://api.github.com/users/emberian/orgs",
      "repos_url": "https://api.github.com/users/emberian/repos",
      "events_url": "https://api.github.com/users/emberian/events{/privacy}",
      "received_events_url": "https://api.github.com/users/emberian/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-03-26T04:29:04Z",
    "updated_at": "2014-03-26T04:29:04Z",
    "body": "cc @huonw \n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/38649041/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/38654099",
    "html_url": "https://github.com/rust-lang/rust/pull/13150#issuecomment-38654099",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/13150",
    "id": 38654099,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM4NjU0MDk5",
    "user": {
      "login": "huonw",
      "id": 1203825,
      "node_id": "MDQ6VXNlcjEyMDM4MjU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1203825?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/huonw",
      "html_url": "https://github.com/huonw",
      "followers_url": "https://api.github.com/users/huonw/followers",
      "following_url": "https://api.github.com/users/huonw/following{/other_user}",
      "gists_url": "https://api.github.com/users/huonw/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/huonw/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/huonw/subscriptions",
      "organizations_url": "https://api.github.com/users/huonw/orgs",
      "repos_url": "https://api.github.com/users/huonw/repos",
      "events_url": "https://api.github.com/users/huonw/events{/privacy}",
      "received_events_url": "https://api.github.com/users/huonw/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-03-26T06:41:52Z",
    "updated_at": "2014-03-26T06:41:52Z",
    "body": "Looks fine to me, but I'm not 100% sure about what the fields of expn_info are either; I'll investigate that, report back/submit docs and then (presumably) r+ in a few hours.\n\n(Someone else is free to do these steps too.)\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/38654099/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/38687289",
    "html_url": "https://github.com/rust-lang/rust/pull/13150#issuecomment-38687289",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/13150",
    "id": 38687289,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM4Njg3Mjg5",
    "user": {
      "login": "huonw",
      "id": 1203825,
      "node_id": "MDQ6VXNlcjEyMDM4MjU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1203825?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/huonw",
      "html_url": "https://github.com/huonw",
      "followers_url": "https://api.github.com/users/huonw/followers",
      "following_url": "https://api.github.com/users/huonw/following{/other_user}",
      "gists_url": "https://api.github.com/users/huonw/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/huonw/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/huonw/subscriptions",
      "organizations_url": "https://api.github.com/users/huonw/orgs",
      "repos_url": "https://api.github.com/users/huonw/repos",
      "events_url": "https://api.github.com/users/huonw/events{/privacy}",
      "received_events_url": "https://api.github.com/users/huonw/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-03-26T14:10:35Z",
    "updated_at": "2014-03-26T14:10:35Z",
    "body": "https://github.com/mozilla/rust/pull/13152\n\nWhile doing that I poured over the expansion source, and I'm thoroughly confused as to why this specific change (and similar changes I've done in the past) have any effect, specifically: there's this [`new_span`](https://github.com/mozilla/rust/blob/0908ffa660667f90186f79e70fd13d68e99836bf/src/libsyntax/ext/expand.rs#L831) function that, afaict, [is called on every single span](https://github.com/mozilla/rust/blob/0908ffa660667f90186f79e70fd13d68e99836bf/src/libsyntax/ext/expand.rs#L866) (except for the single one I caught in that PR) in every single expansion, rewriting the `expn_info` based on the current macro backtrace.\n\n@nick29581 Can you double check that this change has the effect you need for DXR? (Also, derived implementations get the attribute `#[automatically_derived]` now (although I'm inclined to change the exact wording of that attribute, since the `#[deriving]` attribute is certainly not automatically applied).)\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/38687289/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/38737797",
    "html_url": "https://github.com/rust-lang/rust/pull/13150#issuecomment-38737797",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/13150",
    "id": 38737797,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM4NzM3Nzk3",
    "user": {
      "login": "nrc",
      "id": 762626,
      "node_id": "MDQ6VXNlcjc2MjYyNg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/762626?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nrc",
      "html_url": "https://github.com/nrc",
      "followers_url": "https://api.github.com/users/nrc/followers",
      "following_url": "https://api.github.com/users/nrc/following{/other_user}",
      "gists_url": "https://api.github.com/users/nrc/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nrc/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nrc/subscriptions",
      "organizations_url": "https://api.github.com/users/nrc/orgs",
      "repos_url": "https://api.github.com/users/nrc/repos",
      "events_url": "https://api.github.com/users/nrc/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nrc/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-03-26T20:51:05Z",
    "updated_at": "2014-03-26T20:51:05Z",
    "body": "@huonw I don't think new_span is called on every single span, see for example `expand_deriving_clone` in clone.rs where we just set the span to the span passed in from `expand_meta_deriving`. That is why I added the assert there. Possibly that is a bug, I don't understand this code well enough to tell. Also `new_span` can set expn_info to None if `cx.backtrace()` is None, which is possible (I fixed exactly such a bug a while ago). So I think this change is required as DXR exists at the moment.\n\nI guess I could check automatically_derived (I'm glad it is there), but I do think in general it is nice if all generated code has some expn_info, not just for DXR.\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/38737797/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/38739403",
    "html_url": "https://github.com/rust-lang/rust/pull/13150#issuecomment-38739403",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/13150",
    "id": 38739403,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM4NzM5NDAz",
    "user": {
      "login": "nrc",
      "id": 762626,
      "node_id": "MDQ6VXNlcjc2MjYyNg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/762626?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nrc",
      "html_url": "https://github.com/nrc",
      "followers_url": "https://api.github.com/users/nrc/followers",
      "following_url": "https://api.github.com/users/nrc/following{/other_user}",
      "gists_url": "https://api.github.com/users/nrc/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nrc/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nrc/subscriptions",
      "organizations_url": "https://api.github.com/users/nrc/orgs",
      "repos_url": "https://api.github.com/users/nrc/repos",
      "events_url": "https://api.github.com/users/nrc/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nrc/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-03-26T21:04:06Z",
    "updated_at": "2014-03-26T21:04:06Z",
    "body": "And I don't know what that travis fail is about, passes that test locally.\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/38739403/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/38771229",
    "html_url": "https://github.com/rust-lang/rust/pull/13150#issuecomment-38771229",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/13150",
    "id": 38771229,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM4NzcxMjI5",
    "user": {
      "login": "huonw",
      "id": 1203825,
      "node_id": "MDQ6VXNlcjEyMDM4MjU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1203825?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/huonw",
      "html_url": "https://github.com/huonw",
      "followers_url": "https://api.github.com/users/huonw/followers",
      "following_url": "https://api.github.com/users/huonw/following{/other_user}",
      "gists_url": "https://api.github.com/users/huonw/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/huonw/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/huonw/subscriptions",
      "organizations_url": "https://api.github.com/users/huonw/orgs",
      "repos_url": "https://api.github.com/users/huonw/repos",
      "events_url": "https://api.github.com/users/huonw/events{/privacy}",
      "received_events_url": "https://api.github.com/users/huonw/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-03-27T05:50:58Z",
    "updated_at": "2014-03-27T05:50:58Z",
    "body": "I'd guess the travis failure was just a spurious one (it's passing now).\n\n> I don't think new_span is called on every single span\n\nI think it is, since every item has `expand_item` called on it, _including_ the items that macros create (and `expand_item` calls `noop_fold_item` which then runs the rest of the folding, including `new_span`s on everything). However, this happens outside `#[deriving]`, i.e. the spans are set after deriving returns so the assert inside `expand_deriving_clone` isn't seeing the rewritten span. \n\nI could easily be reading the code incorrectly, though.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/38771229/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/38779269",
    "html_url": "https://github.com/rust-lang/rust/pull/13150#issuecomment-38779269",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/13150",
    "id": 38779269,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM4Nzc5MjY5",
    "user": {
      "login": "flaper87",
      "id": 13816,
      "node_id": "MDQ6VXNlcjEzODE2",
      "avatar_url": "https://avatars.githubusercontent.com/u/13816?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/flaper87",
      "html_url": "https://github.com/flaper87",
      "followers_url": "https://api.github.com/users/flaper87/followers",
      "following_url": "https://api.github.com/users/flaper87/following{/other_user}",
      "gists_url": "https://api.github.com/users/flaper87/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/flaper87/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/flaper87/subscriptions",
      "organizations_url": "https://api.github.com/users/flaper87/orgs",
      "repos_url": "https://api.github.com/users/flaper87/repos",
      "events_url": "https://api.github.com/users/flaper87/events{/privacy}",
      "received_events_url": "https://api.github.com/users/flaper87/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-03-27T08:41:24Z",
    "updated_at": "2014-03-27T08:41:24Z",
    "body": "(btw, if the travis failure seems spurious, it's possible to restart the job from travis' UI, I did that yday for this PR and then forgot to comment here)\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/38779269/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/39053276",
    "html_url": "https://github.com/rust-lang/rust/pull/13150#issuecomment-39053276",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/13150",
    "id": 39053276,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM5MDUzMjc2",
    "user": {
      "login": "nrc",
      "id": 762626,
      "node_id": "MDQ6VXNlcjc2MjYyNg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/762626?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nrc",
      "html_url": "https://github.com/nrc",
      "followers_url": "https://api.github.com/users/nrc/followers",
      "following_url": "https://api.github.com/users/nrc/following{/other_user}",
      "gists_url": "https://api.github.com/users/nrc/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nrc/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nrc/subscriptions",
      "organizations_url": "https://api.github.com/users/nrc/orgs",
      "repos_url": "https://api.github.com/users/nrc/repos",
      "events_url": "https://api.github.com/users/nrc/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nrc/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-03-31T04:28:03Z",
    "updated_at": "2014-03-31T04:28:03Z",
    "body": "@huonw looks like you're right, as far as I can tell - at least without this patch, DXR still produces the same output. This was definitely not the case at some point, but DXR tests are much better now, so hopefully this won't regress again.\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/39053276/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
