[
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/13063680",
    "html_url": "https://github.com/rust-lang/rust/pull/4777#issuecomment-13063680",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/4777",
    "id": 13063680,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEzMDYzNjgw",
    "user": {
      "login": "alexcrichton",
      "id": 64996,
      "node_id": "MDQ6VXNlcjY0OTk2",
      "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alexcrichton",
      "html_url": "https://github.com/alexcrichton",
      "followers_url": "https://api.github.com/users/alexcrichton/followers",
      "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}",
      "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions",
      "organizations_url": "https://api.github.com/users/alexcrichton/orgs",
      "repos_url": "https://api.github.com/users/alexcrichton/repos",
      "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alexcrichton/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2013-02-04T06:16:26Z",
    "updated_at": "2013-02-04T06:16:26Z",
    "body": "Just curious, but is there a vision at some point for making this nice for keys which can actually be copied? Before I was able to have things like:\n\n```\nlet map : HashMap<int, int> = ...;\nlet bar = 2;\n// Don't need the address to bar, and also implements\n// the Index<K, V> trait which would also be nice\nlet foo = map[bar];\n// Perhaps there could be an trait for 'foo[k] = v' syntax?\nmap.insert(foo, 3);\n// Don't need the address here again because '&4' looks kinda silly\nmap.remove(4);\n```\n\nI do agree that for most of rust it's necessary to have `&K` instead of `K`, so I was just wondering if this was ever going to manifest itself in some form or fashion. I think it pretty much always make sense to return `&V` as opposed to `V`, but sometimes it's far nicer (and just makes more sense) to use `K` as the key on all the functions instead of `&K`. If this could be a choice of the user of the map as opposed to one decided ahead of time, that would be awesome (or maybe some other map/trait pair?)\n\nI took a look at the `Map` trait to see if things like `LinearMap` could implement `Map<&K, &V>` whereas something like `SmallIntMap` would implement `Map<int, &V>` or something like that. It didn't look like it'd be \"easy\" to do because `insert` takes `K` while remove takes `&K` and `&&K` makes no sense.\n\nAgain, just a general question, I think the container work you've been doing is awesome and things are becoming far more unified than when I started to use rust (0.5 release as comparison)\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/13063680/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/13065878",
    "html_url": "https://github.com/rust-lang/rust/pull/4777#issuecomment-13065878",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/4777",
    "id": 13065878,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEzMDY1ODc4",
    "user": {
      "login": "thestinger",
      "id": 1505226,
      "node_id": "MDQ6VXNlcjE1MDUyMjY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1505226?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/thestinger",
      "html_url": "https://github.com/thestinger",
      "followers_url": "https://api.github.com/users/thestinger/followers",
      "following_url": "https://api.github.com/users/thestinger/following{/other_user}",
      "gists_url": "https://api.github.com/users/thestinger/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/thestinger/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/thestinger/subscriptions",
      "organizations_url": "https://api.github.com/users/thestinger/orgs",
      "repos_url": "https://api.github.com/users/thestinger/repos",
      "events_url": "https://api.github.com/users/thestinger/events{/privacy}",
      "received_events_url": "https://api.github.com/users/thestinger/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2013-02-04T08:11:18Z",
    "updated_at": "2013-02-04T08:14:49Z",
    "body": "@alexcrichton: It's a little bit uglier for small implicitly copyable types (the built-in integer types), but there isn't a performance loss and I can't think of any better alternatives. The `insert` method still takes the parameters by-value since it needs ownership, but the `find` and `remove` methods use `&K` because that's all they need.\n\nUsing `&` on generic type parameters when ownership isn't required provides good support for types that can't be copied or cloned, and it avoids potentially expensive copies/clones for ones that can be. For the built-in numeric types it's just a bit of syntactic noise instead of better semantics though. The other traits in the standard library are similar, and C++/D do it this way too (although they use implicit pass-by-reference so it's less noticeable).\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/13065878/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/13084722",
    "html_url": "https://github.com/rust-lang/rust/pull/4777#issuecomment-13084722",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/4777",
    "id": 13084722,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEzMDg0NzIy",
    "user": {
      "login": "alexcrichton",
      "id": 64996,
      "node_id": "MDQ6VXNlcjY0OTk2",
      "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alexcrichton",
      "html_url": "https://github.com/alexcrichton",
      "followers_url": "https://api.github.com/users/alexcrichton/followers",
      "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}",
      "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions",
      "organizations_url": "https://api.github.com/users/alexcrichton/orgs",
      "repos_url": "https://api.github.com/users/alexcrichton/repos",
      "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alexcrichton/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2013-02-04T16:23:23Z",
    "updated_at": "2013-02-04T16:23:23Z",
    "body": "Oh I completely understand why it's the wait it is, I was just curious if there were any visions for making this syntactically nicer or somehow controllable. Thanks for the explanation!\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/13084722/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/13275846",
    "html_url": "https://github.com/rust-lang/rust/pull/4777#issuecomment-13275846",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/4777",
    "id": 13275846,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEzMjc1ODQ2",
    "user": {
      "login": "nikomatsakis",
      "id": 155238,
      "node_id": "MDQ6VXNlcjE1NTIzOA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/155238?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nikomatsakis",
      "html_url": "https://github.com/nikomatsakis",
      "followers_url": "https://api.github.com/users/nikomatsakis/followers",
      "following_url": "https://api.github.com/users/nikomatsakis/following{/other_user}",
      "gists_url": "https://api.github.com/users/nikomatsakis/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nikomatsakis/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nikomatsakis/subscriptions",
      "organizations_url": "https://api.github.com/users/nikomatsakis/orgs",
      "repos_url": "https://api.github.com/users/nikomatsakis/repos",
      "events_url": "https://api.github.com/users/nikomatsakis/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nikomatsakis/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2013-02-08T03:57:43Z",
    "updated_at": "2013-02-08T03:57:43Z",
    "body": "@alexcrichton One option might be to make an alternate map interface that is intended for copyable keys which is implemented for all maps, like:\n\n```\ntrait MapCopy<K:Copy, V> {\n    fn get_copy(&'lt self, k: K) -> &'lt V;\n    ...\n}\n\nimpl<K:Copy,V,M:Map<K,V>> MapCopy<K,V> for M {\n    fn get_copy(&'lt self, K: K) -> &'lt V {\n        self.get(&k)\n    }\n}\n```\n\nProbably we would want to find a nicer name than `get_copy()`.  Maybe just `get()`, and then in your code you would want to have either `Map` or `MapCopy` in scope, but not both.  Anyway, something like that could work.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/13275846/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/13277475",
    "html_url": "https://github.com/rust-lang/rust/pull/4777#issuecomment-13277475",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/4777",
    "id": 13277475,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEzMjc3NDc1",
    "user": {
      "login": "alexcrichton",
      "id": 64996,
      "node_id": "MDQ6VXNlcjY0OTk2",
      "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alexcrichton",
      "html_url": "https://github.com/alexcrichton",
      "followers_url": "https://api.github.com/users/alexcrichton/followers",
      "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}",
      "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions",
      "organizations_url": "https://api.github.com/users/alexcrichton/orgs",
      "repos_url": "https://api.github.com/users/alexcrichton/repos",
      "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alexcrichton/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2013-02-08T05:21:43Z",
    "updated_at": "2013-02-08T05:21:43Z",
    "body": "Hmm... I wouldn't be in favor of something like `get_copy` because the `_copy` is already more characters than a `&` symbol anyway. Disallowing them to be used at the same time might also make things difficult.\n\nWould something like this be out of the question?\n\n```\npub trait Container {\n    // I was always more in favor of 'size' because I only really consider\n    // vectors as having a 'length'\n    pure fn len(&self) -> uint;\n    pure fn is_empty(&self) -> bool;\n}\n\npub trait Mutable: Container {\n    fn clear(&mut self);\n}\n\npub trait Map<K, V>: Mutable {\n    pure fn contains_key(&self, key: K) -> bool;\n    pure fn each(&self, f: fn(K, V) -> bool);\n    pure fn each_key(&self, f: fn(K) -> bool);\n    pure fn each_value(&self, f: fn(V) -> bool);\n    pure fn find(&self, key: K) -> Option<V>;\n    fn remove(&mut self, key: K) -> bool;\n}\n\npub trait GrowableMap<K, V> {\n    fn insert(&mut self, key: K, value: V) -> bool;\n}\n\nimpl<K, V> Map<&K, &V> for LinearMap<K, V> { ... }\nimpl<K, V> GrowableMap<K, V> for LinearMap<K, V> { ... }\n\nimpl<V> Map<int, &V> for SmallIntMap<V> { ... }\nimpl<V> GrowableMap<int, V> for SmallIntMap<V> { ... }\n```\n\nIt's kind of an odd workaround, but the `insert` method is the only one which needs to be different from all the other ones. With this kind of trait all `SmallIntMap` instances wouldn't need `&uint`. One of the other problems is that if you wanted to add like the `pop` method onto the `Map` trait, you'd have to have another `PoppableMap` trait which doesn't quite make sense and just looks silly to have N traits for N methods:\n\n```\npub trait PoppableMap<K, V> {\n    fn pop(&mut self, key: K) -> Option<V>;\n}\n\nimpl<K, V> PoppableMap<&K, V> for LinearMap<K, V> { ... }\nimpl<V> PoppableMap<uint, V> for SmallIntMap<V> { ... }\n```\n\nI'm not sure if this is even possible. I don't quite have a complete grasp on where methods go and how you access them when dealing with traits, so this could just not even work. Regardless, I was just looking into if there was an easy way to use the maps as naturally as possible. When I first started using rust I was really confused that I had to write `&~\"str\"` to key into a one of `json`'s `Object` maps, but at some point you just get used to it and it's just a rust thing (not that any of this would fix that anyway).\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/13277475/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
