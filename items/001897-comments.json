[
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/4162782",
    "html_url": "https://github.com/rust-lang/rust/issues/1897#issuecomment-4162782",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/1897",
    "id": 4162782,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQxNjI3ODI=",
    "user": {
      "login": "catamorphism",
      "id": 427212,
      "node_id": "MDQ6VXNlcjQyNzIxMg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/427212?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/catamorphism",
      "html_url": "https://github.com/catamorphism",
      "followers_url": "https://api.github.com/users/catamorphism/followers",
      "following_url": "https://api.github.com/users/catamorphism/following{/other_user}",
      "gists_url": "https://api.github.com/users/catamorphism/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/catamorphism/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/catamorphism/subscriptions",
      "organizations_url": "https://api.github.com/users/catamorphism/orgs",
      "repos_url": "https://api.github.com/users/catamorphism/repos",
      "events_url": "https://api.github.com/users/catamorphism/events{/privacy}",
      "received_events_url": "https://api.github.com/users/catamorphism/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2012-02-24T18:57:25Z",
    "updated_at": "2012-02-24T18:57:25Z",
    "body": "I'd like to work on this, but if someone else gets there first, feel free to steal it :-)\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/4162782/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/4164886",
    "html_url": "https://github.com/rust-lang/rust/issues/1897#issuecomment-4164886",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/1897",
    "id": 4164886,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQxNjQ4ODY=",
    "user": {
      "login": "marijnh",
      "id": 144427,
      "node_id": "MDQ6VXNlcjE0NDQyNw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/144427?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/marijnh",
      "html_url": "https://github.com/marijnh",
      "followers_url": "https://api.github.com/users/marijnh/followers",
      "following_url": "https://api.github.com/users/marijnh/following{/other_user}",
      "gists_url": "https://api.github.com/users/marijnh/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/marijnh/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/marijnh/subscriptions",
      "organizations_url": "https://api.github.com/users/marijnh/orgs",
      "repos_url": "https://api.github.com/users/marijnh/repos",
      "events_url": "https://api.github.com/users/marijnh/events{/privacy}",
      "received_events_url": "https://api.github.com/users/marijnh/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2012-02-24T20:50:18Z",
    "updated_at": "2012-02-24T20:50:18Z",
    "body": "I'm not very enthusiastic about most of these. I'll give my reasons point-by-point below:\n\n> - For dense enums, use i = (x - smallest)\n\nDense enums tend to start at zero (or is it one?), so I don't think this'll help in a lot of cases.\n\n> - For sparse enums, use i = perfecthash(x)\n> - For strings, look up i in a hash table\n\nUnless there's a ton of cases, the overhead of hashing will be more than the cost of just running down the list of cases.\n\n> - Otherwise (e.g. pattern matching) fall back on testing each case (if/elif/else)\n\nNested pattern matches are reduced to a nested set of direct tag matches by a simple algorithm.\n\n> - For constant values, use i as an index into an array of values\n\nWe should first check whether LLVM doesn't already manage this. I believe we use Phi nodes in a way that would make this possible (given enough cleverness on LLVM's side).\n\n> - For similar-length blocks, pad the shorter blocks with nops, and jump to i \\* block_length\n\nWould need an (invasive) LLVM patch to do this. Probably not worth it.\n\n> - For differing-length blocks, use i as an index into an array of jump offsets\n\nThis is what an LLVM switch instruction will do, I believe. We're already using those.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/4164886/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/4230713",
    "html_url": "https://github.com/rust-lang/rust/issues/1897#issuecomment-4230713",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/1897",
    "id": 4230713,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQyMzA3MTM=",
    "user": {
      "login": "pcwalton",
      "id": 157897,
      "node_id": "MDQ6VXNlcjE1Nzg5Nw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/157897?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/pcwalton",
      "html_url": "https://github.com/pcwalton",
      "followers_url": "https://api.github.com/users/pcwalton/followers",
      "following_url": "https://api.github.com/users/pcwalton/following{/other_user}",
      "gists_url": "https://api.github.com/users/pcwalton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/pcwalton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/pcwalton/subscriptions",
      "organizations_url": "https://api.github.com/users/pcwalton/orgs",
      "repos_url": "https://api.github.com/users/pcwalton/repos",
      "events_url": "https://api.github.com/users/pcwalton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/pcwalton/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2012-02-29T02:46:44Z",
    "updated_at": "2012-02-29T02:46:44Z",
    "body": "The only one I'm enthusiastic about is string comparisons, but I think the most efficient way to do that is to basically encode a trie. For example:\n\n```\nalt x {\n    \"foo\" { ... }\n    \"bar\" { ... }\n    \"baz\" { ... }\n}\n```\n\nCould become:\n\n```\nif (x[0] == 'b' && x[1] == 'a') {\n    if (x[2] == 'r') { ... }\n    else if (x[2] == 'z') { ... }\n} else if (!strcmp(x, \"foo\")) {\n    ...\n} else {\n    ...\n}\n```\n\nBut I think there's far more low-hanging optimization fruit...\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/4230713/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/4232534",
    "html_url": "https://github.com/rust-lang/rust/issues/1897#issuecomment-4232534",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/1897",
    "id": 4232534,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQyMzI1MzQ=",
    "user": {
      "login": "graydon",
      "id": 14097,
      "node_id": "MDQ6VXNlcjE0MDk3",
      "avatar_url": "https://avatars.githubusercontent.com/u/14097?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/graydon",
      "html_url": "https://github.com/graydon",
      "followers_url": "https://api.github.com/users/graydon/followers",
      "following_url": "https://api.github.com/users/graydon/following{/other_user}",
      "gists_url": "https://api.github.com/users/graydon/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/graydon/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/graydon/subscriptions",
      "organizations_url": "https://api.github.com/users/graydon/orgs",
      "repos_url": "https://api.github.com/users/graydon/repos",
      "events_url": "https://api.github.com/users/graydon/events{/privacy}",
      "received_events_url": "https://api.github.com/users/graydon/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2012-02-29T06:28:05Z",
    "updated_at": "2012-02-29T06:28:05Z",
    "body": "Agreed, O(N) with small constant factors and small N does, in practice, often beat O(lg(N)) or O(1) with more substantial constant factors. Switches are usually small N, integer and string compare are the lowest-overhead operations known, and when N is large users often have their own cleverness in mind anyways.\n\nJust stick with the simple thing for now. The backend authors have already got the table-switching logic done, and they employ it when there's reason to believe it's a win. If we start seeing real world code that has this sort of thing hot in real profiles, then investigate. I'll bet it never comes up.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/4232534/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/4407677",
    "html_url": "https://github.com/rust-lang/rust/issues/1897#issuecomment-4407677",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/1897",
    "id": 4407677,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ0MDc2Nzc=",
    "user": {
      "login": "catamorphism",
      "id": 427212,
      "node_id": "MDQ6VXNlcjQyNzIxMg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/427212?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/catamorphism",
      "html_url": "https://github.com/catamorphism",
      "followers_url": "https://api.github.com/users/catamorphism/followers",
      "following_url": "https://api.github.com/users/catamorphism/following{/other_user}",
      "gists_url": "https://api.github.com/users/catamorphism/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/catamorphism/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/catamorphism/subscriptions",
      "organizations_url": "https://api.github.com/users/catamorphism/orgs",
      "repos_url": "https://api.github.com/users/catamorphism/repos",
      "events_url": "https://api.github.com/users/catamorphism/events{/privacy}",
      "received_events_url": "https://api.github.com/users/catamorphism/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2012-03-09T01:06:09Z",
    "updated_at": "2012-03-09T01:06:09Z",
    "body": "I'm closing this since there seems to be consensus that LLVM is better suited to do these optimizations than our middle-end is.\n\nFeel free to open a new, more specific issue if necessary.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/4407677/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
