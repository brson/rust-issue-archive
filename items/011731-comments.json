[
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/33171129",
    "html_url": "https://github.com/rust-lang/rust/issues/11731#issuecomment-33171129",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/11731",
    "id": 33171129,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMzMTcxMTI5",
    "user": {
      "login": "alexcrichton",
      "id": 64996,
      "node_id": "MDQ6VXNlcjY0OTk2",
      "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alexcrichton",
      "html_url": "https://github.com/alexcrichton",
      "followers_url": "https://api.github.com/users/alexcrichton/followers",
      "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}",
      "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions",
      "organizations_url": "https://api.github.com/users/alexcrichton/orgs",
      "repos_url": "https://api.github.com/users/alexcrichton/repos",
      "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alexcrichton/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-01-23T21:34:34Z",
    "updated_at": "2014-01-23T21:34:34Z",
    "body": "Hm, [this thread](https://groups.google.com/forum/#!topic/android-ndk/J3lzK4X--bM) seems to indicate that this is \"just how android is\". As in, `dlopen` will not open dependent libraries, so you're forced to do the bottup-up `dlopen` calls yourself.\n\nIt appears that libreoffice has their own version of the function, `lo_dlopen` which does what I think it does on linux and co (reads the elf header and goes and dlopen's dependent libraries first).\n\nhttp://motah.org.sa/dev/libreoffice.git/sal/android/lo-bootstrap.c\nhttp://motah.org.sa/dev/libreoffice.git//android/Bootstrap/src/org/libreoffice/android/Bootstrap.java\n\nUnsure if we'd want to bundle that inside of rust itself?\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/33171129/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/33247668",
    "html_url": "https://github.com/rust-lang/rust/issues/11731#issuecomment-33247668",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/11731",
    "id": 33247668,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMzMjQ3NjY4",
    "user": {
      "login": "larsbergstrom",
      "id": 475847,
      "node_id": "MDQ6VXNlcjQ3NTg0Nw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/475847?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/larsbergstrom",
      "html_url": "https://github.com/larsbergstrom",
      "followers_url": "https://api.github.com/users/larsbergstrom/followers",
      "following_url": "https://api.github.com/users/larsbergstrom/following{/other_user}",
      "gists_url": "https://api.github.com/users/larsbergstrom/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/larsbergstrom/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/larsbergstrom/subscriptions",
      "organizations_url": "https://api.github.com/users/larsbergstrom/orgs",
      "repos_url": "https://api.github.com/users/larsbergstrom/repos",
      "events_url": "https://api.github.com/users/larsbergstrom/events{/privacy}",
      "received_events_url": "https://api.github.com/users/larsbergstrom/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-01-24T18:23:55Z",
    "updated_at": "2014-01-24T18:23:55Z",
    "body": "The `dlopen` stuff has been fixed:\n\nhttp://code.google.com/p/android/issues/detail?id=34416&can=1&q=dlopen&colspec=ID%20Type%20Status%20Owner%20Summary%20Stars\n\nThe main problem for us (when using the windows path instead of the weak symbol path) is not that `dlopen` does not load dependencies, but that `dlsym` with `RTLD_DEFAULT` is not finding libservo.so and the `_rust_crate_map_toplevel` symbol.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/33247668/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/35547352",
    "html_url": "https://github.com/rust-lang/rust/issues/11731#issuecomment-35547352",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/11731",
    "id": 35547352,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM1NTQ3MzUy",
    "user": {
      "login": "larsbergstrom",
      "id": 475847,
      "node_id": "MDQ6VXNlcjQ3NTg0Nw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/475847?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/larsbergstrom",
      "html_url": "https://github.com/larsbergstrom",
      "followers_url": "https://api.github.com/users/larsbergstrom/followers",
      "following_url": "https://api.github.com/users/larsbergstrom/following{/other_user}",
      "gists_url": "https://api.github.com/users/larsbergstrom/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/larsbergstrom/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/larsbergstrom/subscriptions",
      "organizations_url": "https://api.github.com/users/larsbergstrom/orgs",
      "repos_url": "https://api.github.com/users/larsbergstrom/repos",
      "events_url": "https://api.github.com/users/larsbergstrom/events{/privacy}",
      "received_events_url": "https://api.github.com/users/larsbergstrom/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-02-19T20:56:08Z",
    "updated_at": "2014-02-19T20:56:17Z",
    "body": "Could you possible expose a function that I could call from C to set the toplevel crate map? We're going to be looking to upgrade Rust soon, and without a way to help the Rust runtime find the crate map when loaded as a shared library, we will have to continue having a funky android-only patch that \"knows\" to look in the libservo.so crate for it, ala: \nhttps://gist.github.com/larsbergstrom/9101334\n\n(ignore all the debugging output :-))\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/35547352/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/35559342",
    "html_url": "https://github.com/rust-lang/rust/issues/11731#issuecomment-35559342",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/11731",
    "id": 35559342,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM1NTU5MzQy",
    "user": {
      "login": "alexcrichton",
      "id": 64996,
      "node_id": "MDQ6VXNlcjY0OTk2",
      "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alexcrichton",
      "html_url": "https://github.com/alexcrichton",
      "followers_url": "https://api.github.com/users/alexcrichton/followers",
      "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}",
      "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions",
      "organizations_url": "https://api.github.com/users/alexcrichton/orgs",
      "repos_url": "https://api.github.com/users/alexcrichton/repos",
      "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alexcrichton/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-02-19T22:44:14Z",
    "updated_at": "2014-02-19T22:44:14Z",
    "body": "Hm, I believe we could, I would imagine something along the lines of:\n\n``` rust\nstatic mut MANUAL_CRATE_MAP: *CrateMap = 0 as *CrateMap;\n\n#[no_mangle]\npub extern fn rust_set_crate_map(map: *CrateMap) {\n    unsafe { MANUAL_CRATE_MAP = map; }\n}\n```\n\nAnd then all functions using the crate map would check if `MANUAL_CRATE_MAP` were not null before looking for the dynamically linked or weak linked one. It seems bad that we would have to do this, but I'm not sure of a better situation for android. \n\nBasically, yes, it could be possible.\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/35559342/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/35561457",
    "html_url": "https://github.com/rust-lang/rust/issues/11731#issuecomment-35561457",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/11731",
    "id": 35561457,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM1NTYxNDU3",
    "user": {
      "login": "alexcrichton",
      "id": 64996,
      "node_id": "MDQ6VXNlcjY0OTk2",
      "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alexcrichton",
      "html_url": "https://github.com/alexcrichton",
      "followers_url": "https://api.github.com/users/alexcrichton/followers",
      "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}",
      "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions",
      "organizations_url": "https://api.github.com/users/alexcrichton/orgs",
      "repos_url": "https://api.github.com/users/alexcrichton/repos",
      "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alexcrichton/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-02-19T23:07:19Z",
    "updated_at": "2014-02-19T23:07:19Z",
    "body": "@larsbergstrom, would something like that work for servo?\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/35561457/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/35561885",
    "html_url": "https://github.com/rust-lang/rust/issues/11731#issuecomment-35561885",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/11731",
    "id": 35561885,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM1NTYxODg1",
    "user": {
      "login": "larsbergstrom",
      "id": 475847,
      "node_id": "MDQ6VXNlcjQ3NTg0Nw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/475847?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/larsbergstrom",
      "html_url": "https://github.com/larsbergstrom",
      "followers_url": "https://api.github.com/users/larsbergstrom/followers",
      "following_url": "https://api.github.com/users/larsbergstrom/following{/other_user}",
      "gists_url": "https://api.github.com/users/larsbergstrom/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/larsbergstrom/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/larsbergstrom/subscriptions",
      "organizations_url": "https://api.github.com/users/larsbergstrom/orgs",
      "repos_url": "https://api.github.com/users/larsbergstrom/repos",
      "events_url": "https://api.github.com/users/larsbergstrom/events{/privacy}",
      "received_events_url": "https://api.github.com/users/larsbergstrom/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-02-19T23:12:36Z",
    "updated_at": "2014-02-19T23:12:36Z",
    "body": "Yes, definitely!\n\nIf it's easier, we can alternatively provide the module name to look in for the symbol (though I guess that only works on dlsym-using platforms.\n\nThanks!\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/35561885/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
