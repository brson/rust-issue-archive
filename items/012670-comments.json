[
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/36601262",
    "html_url": "https://github.com/rust-lang/rust/pull/12670#issuecomment-36601262",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/12670",
    "id": 36601262,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM2NjAxMjYy",
    "user": {
      "login": "alexcrichton",
      "id": 64996,
      "node_id": "MDQ6VXNlcjY0OTk2",
      "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alexcrichton",
      "html_url": "https://github.com/alexcrichton",
      "followers_url": "https://api.github.com/users/alexcrichton/followers",
      "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}",
      "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions",
      "organizations_url": "https://api.github.com/users/alexcrichton/orgs",
      "repos_url": "https://api.github.com/users/alexcrichton/repos",
      "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alexcrichton/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-03-04T08:19:45Z",
    "updated_at": "2014-03-04T08:19:45Z",
    "body": "Can you amend the title and commit message to be a little more specific in the first phrase? \"converting Spans to stuff\" makes it difficult to know what's being fixed.\n\nAlso, cc @nick29581\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/36601262/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/36602068",
    "html_url": "https://github.com/rust-lang/rust/pull/12670#issuecomment-36602068",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/12670",
    "id": 36602068,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM2NjAyMDY4",
    "user": {
      "login": "nrc",
      "id": 762626,
      "node_id": "MDQ6VXNlcjc2MjYyNg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/762626?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nrc",
      "html_url": "https://github.com/nrc",
      "followers_url": "https://api.github.com/users/nrc/followers",
      "following_url": "https://api.github.com/users/nrc/following{/other_user}",
      "gists_url": "https://api.github.com/users/nrc/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nrc/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nrc/subscriptions",
      "organizations_url": "https://api.github.com/users/nrc/orgs",
      "repos_url": "https://api.github.com/users/nrc/repos",
      "events_url": "https://api.github.com/users/nrc/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nrc/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-03-04T08:32:20Z",
    "updated_at": "2014-03-04T08:32:20Z",
    "body": "Is this only ever an issue when a file ends without a newline? (It has been bothering me for a while that we require a newline, so thanks for looking into it). I am pretty tired and will take a proper look tomorrow. In the mean time, could we avoid all this by just adding a newline character to all filemaps that don't end with one? Or some similar but nicer hack?\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/36602068/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/36625015",
    "html_url": "https://github.com/rust-lang/rust/pull/12670#issuecomment-36625015",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/12670",
    "id": 36625015,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM2NjI1MDE1",
    "user": {
      "login": "dmski",
      "id": 1293095,
      "node_id": "MDQ6VXNlcjEyOTMwOTU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1293095?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dmski",
      "html_url": "https://github.com/dmski",
      "followers_url": "https://api.github.com/users/dmski/followers",
      "following_url": "https://api.github.com/users/dmski/following{/other_user}",
      "gists_url": "https://api.github.com/users/dmski/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dmski/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dmski/subscriptions",
      "organizations_url": "https://api.github.com/users/dmski/orgs",
      "repos_url": "https://api.github.com/users/dmski/repos",
      "events_url": "https://api.github.com/users/dmski/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dmski/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-03-04T13:49:40Z",
    "updated_at": "2014-03-04T13:49:40Z",
    "body": "@alexcrichton: done.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/36625015/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/36627420",
    "html_url": "https://github.com/rust-lang/rust/pull/12670#issuecomment-36627420",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/12670",
    "id": 36627420,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM2NjI3NDIw",
    "user": {
      "login": "dmski",
      "id": 1293095,
      "node_id": "MDQ6VXNlcjEyOTMwOTU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1293095?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dmski",
      "html_url": "https://github.com/dmski",
      "followers_url": "https://api.github.com/users/dmski/followers",
      "following_url": "https://api.github.com/users/dmski/following{/other_user}",
      "gists_url": "https://api.github.com/users/dmski/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dmski/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dmski/subscriptions",
      "organizations_url": "https://api.github.com/users/dmski/orgs",
      "repos_url": "https://api.github.com/users/dmski/repos",
      "events_url": "https://api.github.com/users/dmski/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dmski/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-03-04T14:16:49Z",
    "updated_at": "2014-03-04T21:08:01Z",
    "body": "@nick29581: The specific issue that motivated this fix would have been fixed by adding a newline character to every filemap without one, and indeed this was my original idea for the fix too. Dismissed it as being a hack, however, as this will still leave span_to_\\* slightly broken in that they'll still treat Spans in a way different from what lexer/parser think and  will always try to look up 1 byte further than needed when looking up line nums and char positions. This might cause some issue with unicode in the future (it doesn't seem to cause them now however, and i can't at the moment think of unicode example which will break with current code).\n\nMy second idea for a nicer hack was to just subtract BytePos(1) from sp.hi when looking up positions (so that look up lands into the byte range of given Span instead of one byte after it), but that had problems with multi-byte characters and caused unreasonable test breakages.\n\nThe current fix is the nicest i could come up with so far, and it isn't too bad in my opinion (obviously :) ). It doesn't change signatures of any existing public methods for codemap (most of changes are in private methods), only changes the behaviour of span_to_\\* (to look up _up to_ sp.hi index, rather than at sp.hi index). It can also be considered a proper fix and not a hack as it makes span_to_\\* treat Spans the same way lexer and parser do, which can help preventing any issues that might arise from the disconnect between what lexer/parser think of spans and what codemap does.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/36627420/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/36815079",
    "html_url": "https://github.com/rust-lang/rust/pull/12670#issuecomment-36815079",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/12670",
    "id": 36815079,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM2ODE1MDc5",
    "user": {
      "login": "nrc",
      "id": 762626,
      "node_id": "MDQ6VXNlcjc2MjYyNg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/762626?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nrc",
      "html_url": "https://github.com/nrc",
      "followers_url": "https://api.github.com/users/nrc/followers",
      "following_url": "https://api.github.com/users/nrc/following{/other_user}",
      "gists_url": "https://api.github.com/users/nrc/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nrc/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nrc/subscriptions",
      "organizations_url": "https://api.github.com/users/nrc/orgs",
      "repos_url": "https://api.github.com/users/nrc/repos",
      "events_url": "https://api.github.com/users/nrc/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nrc/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-03-06T01:17:41Z",
    "updated_at": "2014-03-06T01:17:41Z",
    "body": "We discussed this a bit. You are quite right that your second idea won't work due to MBCs. I think we still prefer the first 'hack' to this solution though. I don't understand your point \"this will still leave span_to_\\* slightly broken in that they'll still treat Spans in a way different from what lexer/parser think\" - shouldn't we always have half-open intervals? In general, I think functions which deal with a 'point' shouldn't know about or deal with open vs closed ranges and all functions which deal with ranges should assume half-open ranges (unless I'm missing a use case).\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/36815079/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/36912806",
    "html_url": "https://github.com/rust-lang/rust/pull/12670#issuecomment-36912806",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/12670",
    "id": 36912806,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM2OTEyODA2",
    "user": {
      "login": "dmski",
      "id": 1293095,
      "node_id": "MDQ6VXNlcjEyOTMwOTU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1293095?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dmski",
      "html_url": "https://github.com/dmski",
      "followers_url": "https://api.github.com/users/dmski/followers",
      "following_url": "https://api.github.com/users/dmski/following{/other_user}",
      "gists_url": "https://api.github.com/users/dmski/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dmski/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dmski/subscriptions",
      "organizations_url": "https://api.github.com/users/dmski/orgs",
      "repos_url": "https://api.github.com/users/dmski/repos",
      "events_url": "https://api.github.com/users/dmski/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dmski/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-03-06T17:26:59Z",
    "updated_at": "2014-03-06T17:26:59Z",
    "body": "On 6 Mar 2014, at 5:17, Nick Cameron wrote:\n\n> We discussed this a bit. You are quite right that your second idea \n> won't work due to MBCs. I think we still prefer the first 'hack' to \n> this solution though. I don't understand your point \"this will still \n> leave span_to_\\* slightly broken in that they'll still treat Spans in a \n> way different from what lexer/parser think\" - shouldn't we always have \n> half-open intervals?\n> We should! What i was trying to say is that by looking up at \n> BytePos(sp.hi) span_to_\\* tried to look at what's clearly outside of the \n> range denoted by span.\n> In general, I think functions which deal with a 'point' shouldn't know \n> about or deal with open vs closed ranges and all functions which deal \n> with ranges should assume half-open ranges (unless I'm missing a use \n> case).\n> I see the point - the distinction between open vs. closed ranges is \n> really only used when looking up line numbers and filemap indices now. \n> Lines are naturally padded by newlines, so not affected, and filemap \n> indices are fixed by adding a newline (and open vs closed ranges on \n> point lookups can be implemented if there's ever a use case for that).\n\nHave now amended PR description and commit to implement the fix with \nadding a newline.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/36912806/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/36955405",
    "html_url": "https://github.com/rust-lang/rust/pull/12670#issuecomment-36955405",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/12670",
    "id": 36955405,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM2OTU1NDA1",
    "user": {
      "login": "nrc",
      "id": 762626,
      "node_id": "MDQ6VXNlcjc2MjYyNg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/762626?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nrc",
      "html_url": "https://github.com/nrc",
      "followers_url": "https://api.github.com/users/nrc/followers",
      "following_url": "https://api.github.com/users/nrc/following{/other_user}",
      "gists_url": "https://api.github.com/users/nrc/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nrc/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nrc/subscriptions",
      "organizations_url": "https://api.github.com/users/nrc/orgs",
      "repos_url": "https://api.github.com/users/nrc/repos",
      "events_url": "https://api.github.com/users/nrc/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nrc/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-03-07T00:31:12Z",
    "updated_at": "2014-03-07T00:31:12Z",
    "body": "I fear this will not work - the lexer will call `next_line` with the byte offsets it expects, then Codemap adds a char and so the byte offsets for the following filemap will be wrong. I think you need for the lexer to add the newlines.\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/36955405/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/37067263",
    "html_url": "https://github.com/rust-lang/rust/pull/12670#issuecomment-37067263",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/12670",
    "id": 37067263,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM3MDY3MjYz",
    "user": {
      "login": "dmski",
      "id": 1293095,
      "node_id": "MDQ6VXNlcjEyOTMwOTU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1293095?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dmski",
      "html_url": "https://github.com/dmski",
      "followers_url": "https://api.github.com/users/dmski/followers",
      "following_url": "https://api.github.com/users/dmski/following{/other_user}",
      "gists_url": "https://api.github.com/users/dmski/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dmski/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dmski/subscriptions",
      "organizations_url": "https://api.github.com/users/dmski/orgs",
      "repos_url": "https://api.github.com/users/dmski/repos",
      "events_url": "https://api.github.com/users/dmski/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dmski/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-03-07T21:02:54Z",
    "updated_at": "2014-03-07T21:10:39Z",
    "body": "When `codemap::StringReader` is constructed, it's provided with the filemap that would have been already constructed in `CodeMap::new_filemap` and padded with newline if needed. `StringReader.pos` is then initially set to `filemap.start_pos` (lexer.rs:79), so if `filemap.start_pos` is correct then lexer's `next_line` calls will also use correct offsets.\n\n`filemap.start_pos` is calculated in `CodeMap::new_filemap` by adding previous filemap's source length to previous filemap's start_pos (codemap.rs:274), so this takes into account any padding that the previous filemap might've had.\n\nSo, unless i'm missing something, padding with newlines this way won't result in incorrect offsets for newlines. I've also checked that newline offsets are correct manually, just to be sure: https://gist.github.com/dmski/9418492 (which outputs https://gist.github.com/dmski/9420111 for me).\nNot sure if that should be added as a test somewhere - what do you think?\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/37067263/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/37080018",
    "html_url": "https://github.com/rust-lang/rust/pull/12670#issuecomment-37080018",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/12670",
    "id": 37080018,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM3MDgwMDE4",
    "user": {
      "login": "nrc",
      "id": 762626,
      "node_id": "MDQ6VXNlcjc2MjYyNg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/762626?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nrc",
      "html_url": "https://github.com/nrc",
      "followers_url": "https://api.github.com/users/nrc/followers",
      "following_url": "https://api.github.com/users/nrc/following{/other_user}",
      "gists_url": "https://api.github.com/users/nrc/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nrc/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nrc/subscriptions",
      "organizations_url": "https://api.github.com/users/nrc/orgs",
      "repos_url": "https://api.github.com/users/nrc/repos",
      "events_url": "https://api.github.com/users/nrc/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nrc/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-03-07T23:40:30Z",
    "updated_at": "2014-03-07T23:40:30Z",
    "body": "So, I think this is OK then. BUT you must add a comment to `new_line` because this is pretty scary. The input to `new_line` is relative to the start of the Codemap, but taking into account the fact that the Codemap might have been manipulated. So the only safe way to call the method is with a value calculated from what codemap thinks is the start of the filemap plus what the client thinks is the start of the line. I.e., you are providing are value relative to the start of the codemap, but you can only rely on your knowledge to be correct relative to the start of the filemap.\n\nAlso, I think in the tests, you change the `new_line` calls which is correct, but the change to `fm3.next_line(BytePos(34));` should be to `fm3.next_line(BytePos(35));` because two newline chars have been added.\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/37080018/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/37136892",
    "html_url": "https://github.com/rust-lang/rust/pull/12670#issuecomment-37136892",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/12670",
    "id": 37136892,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM3MTM2ODky",
    "user": {
      "login": "alexcrichton",
      "id": 64996,
      "node_id": "MDQ6VXNlcjY0OTk2",
      "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alexcrichton",
      "html_url": "https://github.com/alexcrichton",
      "followers_url": "https://api.github.com/users/alexcrichton/followers",
      "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}",
      "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions",
      "organizations_url": "https://api.github.com/users/alexcrichton/orgs",
      "repos_url": "https://api.github.com/users/alexcrichton/repos",
      "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alexcrichton/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-03-09T19:53:57Z",
    "updated_at": "2014-03-09T19:53:57Z",
    "body": "@nick29581 does this look good to you? I'd be willing to merge this as-is, but you have more experience in this area than I do.\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/37136892/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/37142202",
    "html_url": "https://github.com/rust-lang/rust/pull/12670#issuecomment-37142202",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/12670",
    "id": 37142202,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM3MTQyMjAy",
    "user": {
      "login": "dmski",
      "id": 1293095,
      "node_id": "MDQ6VXNlcjEyOTMwOTU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1293095?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dmski",
      "html_url": "https://github.com/dmski",
      "followers_url": "https://api.github.com/users/dmski/followers",
      "following_url": "https://api.github.com/users/dmski/following{/other_user}",
      "gists_url": "https://api.github.com/users/dmski/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dmski/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dmski/subscriptions",
      "organizations_url": "https://api.github.com/users/dmski/orgs",
      "repos_url": "https://api.github.com/users/dmski/repos",
      "events_url": "https://api.github.com/users/dmski/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dmski/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-03-09T22:33:10Z",
    "updated_at": "2014-03-09T22:36:22Z",
    "body": "Have now added a warning on FileMap.next_line.\nAs for next_line calls in tests - they should be correct, as the second \nfilemap in test data is empty (i thought it'd be a good idea to leave empty filemaps empty), and new_filemap will only add a newline \nto non-empty filemaps, so all offsets are +1 after the first filemap.\n\nOn 8 Mar 2014, at 3:40, Nick Cameron wrote:\n\n> So, I think this is OK then. BUT you must add a comment to `new_line` \n> because this is pretty scary. The input to `new_line` is relative to \n> the start of the Codemap, but taking into account the fact that the \n> Codemap might have been manipulated. So the only safe way to call the \n> method is with a value calculated from what codemap thinks is the \n> start of the filemap plus what the client thinks is the start of the \n> line. I.e., you are providing are value relative to the start of the \n> codemap, but you can only rely on your knowledge to be correct \n> relative to the start of the filemap.\n> \n> Also, I think in the tests, you change the `new_line` calls which is \n> correct, but the change to `fm3.next_line(BytePos(34));` should be to \n> `fm3.next_line(BytePos(35));` because two newline chars have been \n> added.\n> \n> ---\n> \n> Reply to this email directly or view it on GitHub:\n> https://github.com/mozilla/rust/pull/12670#issuecomment-37080018\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/37142202/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/37148706",
    "html_url": "https://github.com/rust-lang/rust/pull/12670#issuecomment-37148706",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/12670",
    "id": 37148706,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM3MTQ4NzA2",
    "user": {
      "login": "nrc",
      "id": 762626,
      "node_id": "MDQ6VXNlcjc2MjYyNg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/762626?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nrc",
      "html_url": "https://github.com/nrc",
      "followers_url": "https://api.github.com/users/nrc/followers",
      "following_url": "https://api.github.com/users/nrc/following{/other_user}",
      "gists_url": "https://api.github.com/users/nrc/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nrc/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nrc/subscriptions",
      "organizations_url": "https://api.github.com/users/nrc/orgs",
      "repos_url": "https://api.github.com/users/nrc/repos",
      "events_url": "https://api.github.com/users/nrc/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nrc/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-03-10T02:24:53Z",
    "updated_at": "2014-03-10T02:24:53Z",
    "body": "r+\n\n@dmski aha! I had missed that you did not add a newline to empty filemaps. I agree that that is the right thing to do. Thanks for iterating over the patch with me, I appreciate the effort and I'm glad this is fixed.\n\n@alexcrichton could you give this your magic r+ please? I fear my r+ is not enough for Bors.\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/37148706/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
