[
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/49959727",
    "html_url": "https://github.com/rust-lang/rust/issues/15932#issuecomment-49959727",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/15932",
    "id": 49959727,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ5OTU5NzI3",
    "user": {
      "login": "alexcrichton",
      "id": 64996,
      "node_id": "MDQ6VXNlcjY0OTk2",
      "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alexcrichton",
      "html_url": "https://github.com/alexcrichton",
      "followers_url": "https://api.github.com/users/alexcrichton/followers",
      "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}",
      "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions",
      "organizations_url": "https://api.github.com/users/alexcrichton/orgs",
      "repos_url": "https://api.github.com/users/alexcrichton/repos",
      "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alexcrichton/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-07-24T02:07:40Z",
    "updated_at": "2014-07-24T02:07:40Z",
    "body": "In the past I've seen false positives (#11710) produced by valgrind, but I'm not sure if this falls in that category.\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/49959727/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/49959764",
    "html_url": "https://github.com/rust-lang/rust/issues/15932#issuecomment-49959764",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/15932",
    "id": 49959764,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ5OTU5NzY0",
    "user": {
      "login": "alexcrichton",
      "id": 64996,
      "node_id": "MDQ6VXNlcjY0OTk2",
      "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alexcrichton",
      "html_url": "https://github.com/alexcrichton",
      "followers_url": "https://api.github.com/users/alexcrichton/followers",
      "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}",
      "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions",
      "organizations_url": "https://api.github.com/users/alexcrichton/orgs",
      "repos_url": "https://api.github.com/users/alexcrichton/repos",
      "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alexcrichton/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-07-24T02:08:20Z",
    "updated_at": "2014-07-24T02:08:20Z",
    "body": "The corresponding LLVM bug is http://llvm.org/bugs/show_bug.cgi?id=12319\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/49959764/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/55685602",
    "html_url": "https://github.com/rust-lang/rust/issues/15932#issuecomment-55685602",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/15932",
    "id": 55685602,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU1Njg1NjAy",
    "user": {
      "login": "thestinger",
      "id": 1505226,
      "node_id": "MDQ6VXNlcjE1MDUyMjY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1505226?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/thestinger",
      "html_url": "https://github.com/thestinger",
      "followers_url": "https://api.github.com/users/thestinger/followers",
      "following_url": "https://api.github.com/users/thestinger/following{/other_user}",
      "gists_url": "https://api.github.com/users/thestinger/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/thestinger/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/thestinger/subscriptions",
      "organizations_url": "https://api.github.com/users/thestinger/orgs",
      "repos_url": "https://api.github.com/users/thestinger/repos",
      "events_url": "https://api.github.com/users/thestinger/events{/privacy}",
      "received_events_url": "https://api.github.com/users/thestinger/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-09-16T02:01:15Z",
    "updated_at": "2014-09-16T02:01:50Z",
    "body": "This isn't a bug but rather a known a consequence of enabling optimizations. If LLVM does provide a way to deal with this, it will be in the form of a lower optimization level compatible with Valgrind. It's always going to happen at the normal optimization level unless they cripple the instruction scheduling to avoid Valgrind false positives. There's nothing Rust can do about it at a compiler / library level, although it could be mentioned in documentation.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/55685602/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/180783213",
    "html_url": "https://github.com/rust-lang/rust/issues/15932#issuecomment-180783213",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/15932",
    "id": 180783213,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE4MDc4MzIxMw==",
    "user": {
      "login": "Wilfred",
      "id": 70800,
      "node_id": "MDQ6VXNlcjcwODAw",
      "avatar_url": "https://avatars.githubusercontent.com/u/70800?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Wilfred",
      "html_url": "https://github.com/Wilfred",
      "followers_url": "https://api.github.com/users/Wilfred/followers",
      "following_url": "https://api.github.com/users/Wilfred/following{/other_user}",
      "gists_url": "https://api.github.com/users/Wilfred/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Wilfred/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Wilfred/subscriptions",
      "organizations_url": "https://api.github.com/users/Wilfred/orgs",
      "repos_url": "https://api.github.com/users/Wilfred/repos",
      "events_url": "https://api.github.com/users/Wilfred/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Wilfred/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2016-02-06T15:03:16Z",
    "updated_at": "2016-02-06T15:03:16Z",
    "body": "FWIW, this still occurs on rust 1.6. Note that a closure isn't necessary:\n\n``` rust\nuse self::Instruction::*;\n\n#[derive(PartialEq, Eq, Debug)]\nenum Instruction {\n    Increment {\n        amount: i8,\n    },\n    Loop {\n        body: Vec<Instruction>,\n    },\n}\n\nfn is_zero_inc(instr: &Instruction) -> bool {\n    if let Increment { amount: 0 } = *instr {\n        return false;\n    }\n    true\n}\n\nfn combine_increments(instrs: Vec<Instruction>) -> Vec<Instruction> {\n    instrs.into_iter()\n          .filter(is_zero_inc)\n          .collect()\n}\n\nfn main() {\n    let instrs = vec![Increment { amount: 1 },\n                      Loop { body: vec![Increment { amount: -1 }] },\n                      Increment { amount: 1 },\n                      Increment { amount: 1 }];\n    println!(\"{:?}\", combine_increments(instrs));\n}\n```\n\nCompiling with optimisations, then running with valgrind gives:\n\n```\n==19708== Conditional jump or move depends on uninitialised value(s)\n==19708==    at 0x10D11C: main::h65be9b608b513c16Ifa (in /home/wilfred/projects/bfc/target/release/bfc)\n==19708==    by 0x1152D4: sys_common::unwind::try::try_fn::h11901883998771707766 (in /home/wilfred/projects/bfc/target/release/bfc)\n==19708==    by 0x112E28: __rust_try (in /home/wilfred/projects/bfc/target/release/bfc)\n==19708==    by 0x114F76: rt::lang_start::hc150f651dd2af18b44x (in /home/wilfred/projects/bfc/target/release/bfc)\n==19708==    by 0x548B60F: (below main) (in /usr/lib/libc-2.22.so)\n```\n\nIt would be nice to document this, but I'm not sure where in the docs would be the natural place to put it.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/180783213/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/265243273",
    "html_url": "https://github.com/rust-lang/rust/issues/15932#issuecomment-265243273",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/15932",
    "id": 265243273,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI2NTI0MzI3Mw==",
    "user": {
      "login": "lilith",
      "id": 107935,
      "node_id": "MDQ6VXNlcjEwNzkzNQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/107935?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/lilith",
      "html_url": "https://github.com/lilith",
      "followers_url": "https://api.github.com/users/lilith/followers",
      "following_url": "https://api.github.com/users/lilith/following{/other_user}",
      "gists_url": "https://api.github.com/users/lilith/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/lilith/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/lilith/subscriptions",
      "organizations_url": "https://api.github.com/users/lilith/orgs",
      "repos_url": "https://api.github.com/users/lilith/repos",
      "events_url": "https://api.github.com/users/lilith/events{/privacy}",
      "received_events_url": "https://api.github.com/users/lilith/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2016-12-06T19:12:47Z",
    "updated_at": "2016-12-06T19:12:47Z",
    "body": "@thestinger Is there an rustc optimization level that should work with Valgrind?",
    "author_association": "NONE",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/265243273/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/265243823",
    "html_url": "https://github.com/rust-lang/rust/issues/15932#issuecomment-265243823",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/15932",
    "id": 265243823,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI2NTI0MzgyMw==",
    "user": {
      "login": "thestinger",
      "id": 1505226,
      "node_id": "MDQ6VXNlcjE1MDUyMjY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1505226?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/thestinger",
      "html_url": "https://github.com/thestinger",
      "followers_url": "https://api.github.com/users/thestinger/followers",
      "following_url": "https://api.github.com/users/thestinger/following{/other_user}",
      "gists_url": "https://api.github.com/users/thestinger/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/thestinger/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/thestinger/subscriptions",
      "organizations_url": "https://api.github.com/users/thestinger/orgs",
      "repos_url": "https://api.github.com/users/thestinger/repos",
      "events_url": "https://api.github.com/users/thestinger/events{/privacy}",
      "received_events_url": "https://api.github.com/users/thestinger/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2016-12-06T19:14:49Z",
    "updated_at": "2016-12-06T19:14:49Z",
    "body": "Just turn off that Valgrind feature, it doesn't work with modern optimizing compilers. Rust could support sanitizers instead.",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/265243823/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
