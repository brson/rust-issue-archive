[
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/68322652",
    "html_url": "https://github.com/rust-lang/rust/issues/20267#issuecomment-68322652",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/20267",
    "id": 68322652,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY4MzIyNjUy",
    "user": {
      "login": "BenTheElder",
      "id": 917931,
      "node_id": "MDQ6VXNlcjkxNzkzMQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/917931?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/BenTheElder",
      "html_url": "https://github.com/BenTheElder",
      "followers_url": "https://api.github.com/users/BenTheElder/followers",
      "following_url": "https://api.github.com/users/BenTheElder/following{/other_user}",
      "gists_url": "https://api.github.com/users/BenTheElder/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/BenTheElder/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/BenTheElder/subscriptions",
      "organizations_url": "https://api.github.com/users/BenTheElder/orgs",
      "repos_url": "https://api.github.com/users/BenTheElder/repos",
      "events_url": "https://api.github.com/users/BenTheElder/events{/privacy}",
      "received_events_url": "https://api.github.com/users/BenTheElder/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-12-30T01:42:21Z",
    "updated_at": "2014-12-30T01:42:21Z",
    "body": "I've since rewritten all of the wrapper functions I intended to exclude from the rlib to be totally safe and documented them with their c equivalent definitions. I plan to just ensure the documentation notes that the wrapper functions are not intended to be used from rust and that the implementation defined mangled methods should be preferred.\n\nI'm leaving this open for now, but feel free to close it. It might still be useful to have, but I've given up on it for now rather than complicate my project structure further (E.G. having a rust lib and a seperate wrapper lib), in favor of better documentation and safer code.\n",
    "author_association": "NONE",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/68322652/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/172942915",
    "html_url": "https://github.com/rust-lang/rust/issues/20267#issuecomment-172942915",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/20267",
    "id": 172942915,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE3Mjk0MjkxNQ==",
    "user": {
      "login": "Stebalien",
      "id": 310393,
      "node_id": "MDQ6VXNlcjMxMDM5Mw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/310393?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Stebalien",
      "html_url": "https://github.com/Stebalien",
      "followers_url": "https://api.github.com/users/Stebalien/followers",
      "following_url": "https://api.github.com/users/Stebalien/following{/other_user}",
      "gists_url": "https://api.github.com/users/Stebalien/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Stebalien/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Stebalien/subscriptions",
      "organizations_url": "https://api.github.com/users/Stebalien/orgs",
      "repos_url": "https://api.github.com/users/Stebalien/repos",
      "events_url": "https://api.github.com/users/Stebalien/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Stebalien/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2016-01-19T18:29:11Z",
    "updated_at": "2016-01-19T18:29:11Z",
    "body": "Triage: I believe this is fixed (see https://doc.rust-lang.org/reference.html#linkage).\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/172942915/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/172951568",
    "html_url": "https://github.com/rust-lang/rust/issues/20267#issuecomment-172951568",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/20267",
    "id": 172951568,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE3Mjk1MTU2OA==",
    "user": {
      "login": "steveklabnik",
      "id": 27786,
      "node_id": "MDQ6VXNlcjI3Nzg2",
      "avatar_url": "https://avatars.githubusercontent.com/u/27786?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/steveklabnik",
      "html_url": "https://github.com/steveklabnik",
      "followers_url": "https://api.github.com/users/steveklabnik/followers",
      "following_url": "https://api.github.com/users/steveklabnik/following{/other_user}",
      "gists_url": "https://api.github.com/users/steveklabnik/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/steveklabnik/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/steveklabnik/subscriptions",
      "organizations_url": "https://api.github.com/users/steveklabnik/orgs",
      "repos_url": "https://api.github.com/users/steveklabnik/repos",
      "events_url": "https://api.github.com/users/steveklabnik/events{/privacy}",
      "received_events_url": "https://api.github.com/users/steveklabnik/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2016-01-19T18:58:35Z",
    "updated_at": "2016-01-19T18:58:35Z",
    "body": "I believe so as well, and given that @BenTheElder found another way in the meantime, and nobody else has commented in a year, let's give it a close.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/172951568/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/281627755",
    "html_url": "https://github.com/rust-lang/rust/issues/20267#issuecomment-281627755",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/20267",
    "id": 281627755,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI4MTYyNzc1NQ==",
    "user": {
      "login": "ccll",
      "id": 5366582,
      "node_id": "MDQ6VXNlcjUzNjY1ODI=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5366582?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ccll",
      "html_url": "https://github.com/ccll",
      "followers_url": "https://api.github.com/users/ccll/followers",
      "following_url": "https://api.github.com/users/ccll/following{/other_user}",
      "gists_url": "https://api.github.com/users/ccll/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ccll/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ccll/subscriptions",
      "organizations_url": "https://api.github.com/users/ccll/orgs",
      "repos_url": "https://api.github.com/users/ccll/repos",
      "events_url": "https://api.github.com/users/ccll/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ccll/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2017-02-22T10:19:09Z",
    "updated_at": "2017-02-22T10:19:09Z",
    "body": "This is not working, at least on these versions as I tried:\r\nrustc 1.17.0-nightly (a17e5e294 2017-02-20)\r\nrustc 1.15.1 (021bd294c 2017-02-08)\r\nrustc 1.15.0 (10893a9a3 2017-01-19)\r\nrustc 1.14.0 (e8a012324 2016-12-16)\r\n\r\nPossibly a regression?\r\n\r\n**Details**\r\nI'm working on a Windows project, where one crate needs to be an DLL (\"cdylib\"), and the function named \"DllMain\" should be exported as a C function to do some initialization when the DLL is loaded. In the meanwhile this crate contains some type definitions used by other high-level crates, so this crate should be built to both \"rlib\" and \"cdylib\", and the \"rlib\" version should NOT export \"DllMain\" as the other high-level crates may themselves be an \"cdylib\" and has their own version of \"DllMain\" exported.\r\nBut as I added the conditional compilation as stated above, the function \"DllMain\" just disappears from the DLL's exported symbol table.\r\n\r\nhere is an shorter version of the snippet:\r\n```\r\n// lib.rs\r\n#[no_mangle]\r\n#[cfg(crate_type=\"cdylib\")]\r\npub extern \"stdcall\" fn DllMain() {\r\n\r\n}\r\n```\r\n\r\n```\r\n# Cargo.toml\r\n...\r\n[lib]\r\ncrate_type = [\"rlib\", \"cdylib\"]\r\n...\r\n```",
    "author_association": "NONE",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/281627755/reactions",
      "total_count": 2,
      "+1": 2,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/289464351",
    "html_url": "https://github.com/rust-lang/rust/issues/20267#issuecomment-289464351",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/20267",
    "id": 289464351,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI4OTQ2NDM1MQ==",
    "user": {
      "login": "tmccombs",
      "id": 2541726,
      "node_id": "MDQ6VXNlcjI1NDE3MjY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2541726?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/tmccombs",
      "html_url": "https://github.com/tmccombs",
      "followers_url": "https://api.github.com/users/tmccombs/followers",
      "following_url": "https://api.github.com/users/tmccombs/following{/other_user}",
      "gists_url": "https://api.github.com/users/tmccombs/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/tmccombs/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/tmccombs/subscriptions",
      "organizations_url": "https://api.github.com/users/tmccombs/orgs",
      "repos_url": "https://api.github.com/users/tmccombs/repos",
      "events_url": "https://api.github.com/users/tmccombs/events{/privacy}",
      "received_events_url": "https://api.github.com/users/tmccombs/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2017-03-27T14:07:47Z",
    "updated_at": "2017-03-27T14:07:47Z",
    "body": "I don't see anything about this in the link to the documentation.",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/289464351/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/301881179",
    "html_url": "https://github.com/rust-lang/rust/issues/20267#issuecomment-301881179",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/20267",
    "id": 301881179,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMwMTg4MTE3OQ==",
    "user": {
      "login": "nbigaouette-eai",
      "id": 25907218,
      "node_id": "MDQ6VXNlcjI1OTA3MjE4",
      "avatar_url": "https://avatars.githubusercontent.com/u/25907218?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nbigaouette-eai",
      "html_url": "https://github.com/nbigaouette-eai",
      "followers_url": "https://api.github.com/users/nbigaouette-eai/followers",
      "following_url": "https://api.github.com/users/nbigaouette-eai/following{/other_user}",
      "gists_url": "https://api.github.com/users/nbigaouette-eai/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nbigaouette-eai/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nbigaouette-eai/subscriptions",
      "organizations_url": "https://api.github.com/users/nbigaouette-eai/orgs",
      "repos_url": "https://api.github.com/users/nbigaouette-eai/repos",
      "events_url": "https://api.github.com/users/nbigaouette-eai/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nbigaouette-eai/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2017-05-16T18:58:54Z",
    "updated_at": "2017-05-16T18:58:54Z",
    "body": "I can't find anything about this in the reference either.\r\n\r\nUsing `#[cfg(crate_type=\"cdylib\")]` to include something only when `cdylib` crate is being built (with `crate_type = [\"rlib\", \"cdylib\"]` in Cargo.toml) does not work for me either.\r\n\r\nI would like to do this to not have to expose an unsage API meant to be consumed by FFI/Python.",
    "author_association": "NONE",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/301881179/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/450525297",
    "html_url": "https://github.com/rust-lang/rust/issues/20267#issuecomment-450525297",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/20267",
    "id": 450525297,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ1MDUyNTI5Nw==",
    "user": {
      "login": "dtolnay",
      "id": 1940490,
      "node_id": "MDQ6VXNlcjE5NDA0OTA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1940490?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dtolnay",
      "html_url": "https://github.com/dtolnay",
      "followers_url": "https://api.github.com/users/dtolnay/followers",
      "following_url": "https://api.github.com/users/dtolnay/following{/other_user}",
      "gists_url": "https://api.github.com/users/dtolnay/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dtolnay/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dtolnay/subscriptions",
      "organizations_url": "https://api.github.com/users/dtolnay/orgs",
      "repos_url": "https://api.github.com/users/dtolnay/repos",
      "events_url": "https://api.github.com/users/dtolnay/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dtolnay/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2018-12-29T22:36:10Z",
    "updated_at": "2018-12-29T22:36:10Z",
    "body": "Reopening because I was looking for this today and it doesn't seem like it was ever implemented.\r\n\r\nI don't think an RFC would be required for this.",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/450525297/reactions",
      "total_count": 11,
      "+1": 11,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/515718559",
    "html_url": "https://github.com/rust-lang/rust/issues/20267#issuecomment-515718559",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/20267",
    "id": 515718559,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUxNTcxODU1OQ==",
    "user": {
      "login": "pheki",
      "id": 19574371,
      "node_id": "MDQ6VXNlcjE5NTc0Mzcx",
      "avatar_url": "https://avatars.githubusercontent.com/u/19574371?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/pheki",
      "html_url": "https://github.com/pheki",
      "followers_url": "https://api.github.com/users/pheki/followers",
      "following_url": "https://api.github.com/users/pheki/following{/other_user}",
      "gists_url": "https://api.github.com/users/pheki/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/pheki/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/pheki/subscriptions",
      "organizations_url": "https://api.github.com/users/pheki/orgs",
      "repos_url": "https://api.github.com/users/pheki/repos",
      "events_url": "https://api.github.com/users/pheki/events{/privacy}",
      "received_events_url": "https://api.github.com/users/pheki/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2019-07-27T22:44:01Z",
    "updated_at": "2019-07-27T22:44:01Z",
    "body": "I'm working on this! Can I be assigned?",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/515718559/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/517509326",
    "html_url": "https://github.com/rust-lang/rust/issues/20267#issuecomment-517509326",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/20267",
    "id": 517509326,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUxNzUwOTMyNg==",
    "user": {
      "login": "pheki",
      "id": 19574371,
      "node_id": "MDQ6VXNlcjE5NTc0Mzcx",
      "avatar_url": "https://avatars.githubusercontent.com/u/19574371?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/pheki",
      "html_url": "https://github.com/pheki",
      "followers_url": "https://api.github.com/users/pheki/followers",
      "following_url": "https://api.github.com/users/pheki/following{/other_user}",
      "gists_url": "https://api.github.com/users/pheki/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/pheki/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/pheki/subscriptions",
      "organizations_url": "https://api.github.com/users/pheki/orgs",
      "repos_url": "https://api.github.com/users/pheki/repos",
      "events_url": "https://api.github.com/users/pheki/events{/privacy}",
      "received_events_url": "https://api.github.com/users/pheki/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2019-08-02T01:05:32Z",
    "updated_at": "2019-08-02T01:36:27Z",
    "body": "I did implement this, but I'm not sure it is possible to be intuitive as rustc allows multiple crate types in the same session.\r\n\r\nWhen you compile a crate with `crate-type = [\"rlib\",\"cdylib\"]`, cargo generates a single `rustc` call with both `--crate-type rlib` and `--crate-type cdylib`, which would make both `#[cfg(crate_type=\"rlib\")]` and `#[cfg(crate_type=\"cdylib\")]` compile...\r\n\r\nI can create a PR anyone's interested.",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/517509326/reactions",
      "total_count": 5,
      "+1": 5,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/750100751",
    "html_url": "https://github.com/rust-lang/rust/issues/20267#issuecomment-750100751",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/20267",
    "id": 750100751,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc1MDEwMDc1MQ==",
    "user": {
      "login": "osa1",
      "id": 448274,
      "node_id": "MDQ6VXNlcjQ0ODI3NA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/448274?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/osa1",
      "html_url": "https://github.com/osa1",
      "followers_url": "https://api.github.com/users/osa1/followers",
      "following_url": "https://api.github.com/users/osa1/following{/other_user}",
      "gists_url": "https://api.github.com/users/osa1/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/osa1/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/osa1/subscriptions",
      "organizations_url": "https://api.github.com/users/osa1/orgs",
      "repos_url": "https://api.github.com/users/osa1/repos",
      "events_url": "https://api.github.com/users/osa1/events{/privacy}",
      "received_events_url": "https://api.github.com/users/osa1/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2020-12-23T10:26:33Z",
    "updated_at": "2020-12-23T10:26:33Z",
    "body": "A use case for this is when I have a `no_std` static library (i.e. `staticlib` crate type, I build it to `.a` and link it with external code), but I also want to use it in another Rust executable create for testing and want to use `std` in the testing crate. So I generate both `staticlib` and `rlib`.\r\n\r\nTo be able to generate `.a` (`staticlib`) I need to define a `panic_handler` but if I do that I can't build the crate to `rlib` (or maybe I can but you can't use it in my test crate as I'll have multiple `panic_handler`s).\r\n\r\nWith this feature I could do\r\n\r\n```rust\r\n#[cfg(crate_type = \"staticlib\")]\r\n#[panic_handler]\r\nfn panic(info: &core::panic::PanicInfo) -> ! {\r\n    ...\r\n}\r\n```\r\n\r\nwhich would make it possible to build the crate to both `rlib` and `staticlib`.",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/750100751/reactions",
      "total_count": 6,
      "+1": 5,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 1
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/899044709",
    "html_url": "https://github.com/rust-lang/rust/issues/20267#issuecomment-899044709",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/20267",
    "id": 899044709,
    "node_id": "IC_kwDOAAsO6M41llVl",
    "user": {
      "login": "guilhermewerner",
      "id": 26710260,
      "node_id": "MDQ6VXNlcjI2NzEwMjYw",
      "avatar_url": "https://avatars.githubusercontent.com/u/26710260?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/guilhermewerner",
      "html_url": "https://github.com/guilhermewerner",
      "followers_url": "https://api.github.com/users/guilhermewerner/followers",
      "following_url": "https://api.github.com/users/guilhermewerner/following{/other_user}",
      "gists_url": "https://api.github.com/users/guilhermewerner/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/guilhermewerner/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/guilhermewerner/subscriptions",
      "organizations_url": "https://api.github.com/users/guilhermewerner/orgs",
      "repos_url": "https://api.github.com/users/guilhermewerner/repos",
      "events_url": "https://api.github.com/users/guilhermewerner/events{/privacy}",
      "received_events_url": "https://api.github.com/users/guilhermewerner/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2021-08-15T12:41:44Z",
    "updated_at": "2021-08-15T12:41:44Z",
    "body": "Another use case is the creation of plugins, where an application can dynamically load the plugins via an extern \"C\" function, but also be able to use the plugins statically, like a normal rust library.\r\n\r\nThat way we could disable the dynamic loading function in the plugin, to be able to statically link.\r\n\r\nA quick way to solve this is to create two crates, one rlib, with the api in rust, and another cdylib, containing the function to load the plugin. Although this method is not very ergonomic, it would be much better to be able to use conditional compilation to control whether or not the extern function is defined.\r\n\r\nThis has already been mentioned in: https://github.com/eclipse-zenoh/zenoh/issues/89#issuecomment-831241728",
    "author_association": "NONE",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/899044709/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/905482474",
    "html_url": "https://github.com/rust-lang/rust/issues/20267#issuecomment-905482474",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/20267",
    "id": 905482474,
    "node_id": "IC_kwDOAAsO6M41-JDq",
    "user": {
      "login": "dabretin",
      "id": 7630676,
      "node_id": "MDQ6VXNlcjc2MzA2NzY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7630676?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dabretin",
      "html_url": "https://github.com/dabretin",
      "followers_url": "https://api.github.com/users/dabretin/followers",
      "following_url": "https://api.github.com/users/dabretin/following{/other_user}",
      "gists_url": "https://api.github.com/users/dabretin/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dabretin/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dabretin/subscriptions",
      "organizations_url": "https://api.github.com/users/dabretin/orgs",
      "repos_url": "https://api.github.com/users/dabretin/repos",
      "events_url": "https://api.github.com/users/dabretin/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dabretin/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2021-08-25T13:03:27Z",
    "updated_at": "2021-08-25T13:03:27Z",
    "body": "It seems that using `#![crate_type=\"...\"]` in top of different source files could solve the problem...\r\n\r\nstatic_lib.rs:\r\n```\r\n#![allow(unused_attributes)]\r\n#![crate_type=\"lib\"]\r\n...\r\n```\r\n\r\ndynamic_lib.rs:\r\n```\r\n#![allow(unused_attributes)]\r\n#![crate_type=\"cdylib\"]\r\n...\r\n```\r\n\r\nlib.rs:\r\n```\r\nmod static_lib;\r\nmod dynamic_lib;\r\n...\r\n```",
    "author_association": "NONE",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/905482474/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/905500443",
    "html_url": "https://github.com/rust-lang/rust/issues/20267#issuecomment-905500443",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/20267",
    "id": 905500443,
    "node_id": "IC_kwDOAAsO6M41-Ncb",
    "user": {
      "login": "guilhermewerner",
      "id": 26710260,
      "node_id": "MDQ6VXNlcjI2NzEwMjYw",
      "avatar_url": "https://avatars.githubusercontent.com/u/26710260?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/guilhermewerner",
      "html_url": "https://github.com/guilhermewerner",
      "followers_url": "https://api.github.com/users/guilhermewerner/followers",
      "following_url": "https://api.github.com/users/guilhermewerner/following{/other_user}",
      "gists_url": "https://api.github.com/users/guilhermewerner/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/guilhermewerner/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/guilhermewerner/subscriptions",
      "organizations_url": "https://api.github.com/users/guilhermewerner/orgs",
      "repos_url": "https://api.github.com/users/guilhermewerner/repos",
      "events_url": "https://api.github.com/users/guilhermewerner/events{/privacy}",
      "received_events_url": "https://api.github.com/users/guilhermewerner/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2021-08-25T13:26:26Z",
    "updated_at": "2021-08-25T13:27:11Z",
    "body": "Unfortunately this doesn't work with cargo.\r\n\r\nBut I think rust-lang/cargo#8628 can solve this and other problems.",
    "author_association": "NONE",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/905500443/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/1031056943",
    "html_url": "https://github.com/rust-lang/rust/issues/20267#issuecomment-1031056943",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/20267",
    "id": 1031056943,
    "node_id": "IC_kwDOAAsO6M49dK4v",
    "user": {
      "login": "js2xxx",
      "id": 12331626,
      "node_id": "MDQ6VXNlcjEyMzMxNjI2",
      "avatar_url": "https://avatars.githubusercontent.com/u/12331626?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/js2xxx",
      "html_url": "https://github.com/js2xxx",
      "followers_url": "https://api.github.com/users/js2xxx/followers",
      "following_url": "https://api.github.com/users/js2xxx/following{/other_user}",
      "gists_url": "https://api.github.com/users/js2xxx/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/js2xxx/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/js2xxx/subscriptions",
      "organizations_url": "https://api.github.com/users/js2xxx/orgs",
      "repos_url": "https://api.github.com/users/js2xxx/repos",
      "events_url": "https://api.github.com/users/js2xxx/events{/privacy}",
      "received_events_url": "https://api.github.com/users/js2xxx/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2022-02-07T04:17:38Z",
    "updated_at": "2022-02-07T04:17:38Z",
    "body": "@dabretin 's method seems not working for implementing conditional `#[panic_handler]` at least in my case. I also tried using unstable `#[linkage = \"weak\"]` but not working either. I wonder if there are some other alternatives because I don't want to duplicate dozens of interface functions in different crates...",
    "author_association": "NONE",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/1031056943/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/1312814684",
    "html_url": "https://github.com/rust-lang/rust/issues/20267#issuecomment-1312814684",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/20267",
    "id": 1312814684,
    "node_id": "IC_kwDOAAsO6M5OP_Zc",
    "user": {
      "login": "cr1901",
      "id": 6418027,
      "node_id": "MDQ6VXNlcjY0MTgwMjc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6418027?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cr1901",
      "html_url": "https://github.com/cr1901",
      "followers_url": "https://api.github.com/users/cr1901/followers",
      "following_url": "https://api.github.com/users/cr1901/following{/other_user}",
      "gists_url": "https://api.github.com/users/cr1901/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cr1901/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cr1901/subscriptions",
      "organizations_url": "https://api.github.com/users/cr1901/orgs",
      "repos_url": "https://api.github.com/users/cr1901/repos",
      "events_url": "https://api.github.com/users/cr1901/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cr1901/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2022-11-13T20:30:43Z",
    "updated_at": "2022-11-13T20:30:43Z",
    "body": "I ended up needing something like this for crates that's intended to be used from C, but can also in principle be used in a Rust binary crate:\r\n\r\nAll but one of the crates define an `extern \"C\" { static mut GLOBAL: Foo }` if compiled as an `rlib`. The remaining `rlib` and each crate compiled as a `staticlib` define `#[no_mangle] static mut GLOBAL: Foo = Foo::new()`. This works for `staticlib`s because ELF allows global definitions to be preempted by default (embedded crate, possibly unsound with linkers that don't allow preemption?).\r\n\r\nRight now, I have all crates do `extern \"C\" { static mut GLOBAL: Foo }` and tell the user \"they need to define a `GLOBAL` in the main app\". But the user not having to do that would be better ergonomics IMO.",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/1312814684/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/1397005636",
    "html_url": "https://github.com/rust-lang/rust/issues/20267#issuecomment-1397005636",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/20267",
    "id": 1397005636,
    "node_id": "IC_kwDOAAsO6M5TRJ1E",
    "user": {
      "login": "tgross35",
      "id": 13724985,
      "node_id": "MDQ6VXNlcjEzNzI0OTg1",
      "avatar_url": "https://avatars.githubusercontent.com/u/13724985?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/tgross35",
      "html_url": "https://github.com/tgross35",
      "followers_url": "https://api.github.com/users/tgross35/followers",
      "following_url": "https://api.github.com/users/tgross35/following{/other_user}",
      "gists_url": "https://api.github.com/users/tgross35/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/tgross35/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/tgross35/subscriptions",
      "organizations_url": "https://api.github.com/users/tgross35/orgs",
      "repos_url": "https://api.github.com/users/tgross35/repos",
      "events_url": "https://api.github.com/users/tgross35/events{/privacy}",
      "received_events_url": "https://api.github.com/users/tgross35/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2023-01-19T13:47:46Z",
    "updated_at": "2023-01-19T13:47:46Z",
    "body": "@pheki did you ever make the PR, or would you be able to? Even if there are merge conflicts or it doesn't work, it might be a good starting point for somebody else.\r\n\r\nBit of an annoying issue when you stumble upon this. You could workaround using features instead, if you pass them manually while compiling. \r\n\r\nGist to a playground example of what likely should work: https://play.rust-lang.org/?version=stable&mode=debug&edition=2021&gist=18fcde81a38b7e8cb6f3f62fd5df851a",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/1397005636/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/1397983361",
    "html_url": "https://github.com/rust-lang/rust/issues/20267#issuecomment-1397983361",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/20267",
    "id": 1397983361,
    "node_id": "IC_kwDOAAsO6M5TU4iB",
    "user": {
      "login": "pheki",
      "id": 19574371,
      "node_id": "MDQ6VXNlcjE5NTc0Mzcx",
      "avatar_url": "https://avatars.githubusercontent.com/u/19574371?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/pheki",
      "html_url": "https://github.com/pheki",
      "followers_url": "https://api.github.com/users/pheki/followers",
      "following_url": "https://api.github.com/users/pheki/following{/other_user}",
      "gists_url": "https://api.github.com/users/pheki/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/pheki/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/pheki/subscriptions",
      "organizations_url": "https://api.github.com/users/pheki/orgs",
      "repos_url": "https://api.github.com/users/pheki/repos",
      "events_url": "https://api.github.com/users/pheki/events{/privacy}",
      "received_events_url": "https://api.github.com/users/pheki/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2023-01-20T06:46:13Z",
    "updated_at": "2023-01-20T06:46:13Z",
    "body": "@tgross35 I think I left the code in my rust clone and eventually cleaned it up. My bad, I should have just made the PR.\r\n\r\nI ended up just using a feature for my use case.",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/1397983361/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/1407065944",
    "html_url": "https://github.com/rust-lang/rust/issues/20267#issuecomment-1407065944",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/20267",
    "id": 1407065944,
    "node_id": "IC_kwDOAAsO6M5T3h9Y",
    "user": {
      "login": "PonasKovas",
      "id": 25486263,
      "node_id": "MDQ6VXNlcjI1NDg2MjYz",
      "avatar_url": "https://avatars.githubusercontent.com/u/25486263?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/PonasKovas",
      "html_url": "https://github.com/PonasKovas",
      "followers_url": "https://api.github.com/users/PonasKovas/followers",
      "following_url": "https://api.github.com/users/PonasKovas/following{/other_user}",
      "gists_url": "https://api.github.com/users/PonasKovas/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/PonasKovas/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/PonasKovas/subscriptions",
      "organizations_url": "https://api.github.com/users/PonasKovas/orgs",
      "repos_url": "https://api.github.com/users/PonasKovas/repos",
      "events_url": "https://api.github.com/users/PonasKovas/events{/privacy}",
      "received_events_url": "https://api.github.com/users/PonasKovas/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2023-01-27T20:57:15Z",
    "updated_at": "2023-01-28T07:35:53Z",
    "body": "As @pheki has already meantioned earlier, currently cargo always builds all `crate_type`s at the same time, as you can see if you make a `[\"cdylib\", \"lib\"]` crate and build it, both `cdylib` and `lib` will be generated without recompiling the code 2 times, and you can't tell cargo to build only one of them, or separately. So `#[cfg(crate_type = \"type\")]` would not be practical, as it would always compile if the `type` is in `Cargo.toml`.\r\n\r\nThe best solution at the moment seems to be using features or separate crates.\r\n\r\n<details>\r\n<summary>My proposal</summary>\r\n\r\n# My proposal\r\n\r\nI am not sure if the way `crate_type` is treated is optimal though. How often do you actually need all of those `crate_type`s at the same time? As far as I can imagine, you almost always need either one or the other. I am not deeply familiar with `cargo` or `rustc`'s inner workings so take my words with a grain of salt, but here's what I think:\r\n\r\n*Note:  I am not mentioning `bin` or `proc-macro` types purposely in this proposal since they are mutually exclusive with all the other types already and are not affected in any way.*\r\n\r\n`crate_type` should define \"allowed\" types, and if only 1 type is given, it should work the same way it works now.\r\nHowever, if there are multiple types given, it should **compile all of them separately** (allowing conditional compilation based on the `crate_type`), and **only the types that will be needed** (decided by context).\r\n\r\nSo, if you were to `cargo build` such a crate, it would build all of them by default, but you could specify which type you want with a command line argument like `--crate-type <which type to generate>`. *(A related idea that I haven't thought out very well but still want to mention: something like `default-crate-type` key in Cargo.toml which, if set, would make `cargo build` only build the given type instead of all of them **by default** (still can be overriden by `--crate-type` argument of course))*\r\n\r\nAnd if your crate was used as a dependency in another crate, it should only build `rlib` or `dylib`.\r\nIf both `rlib` and `dylib` are \"allowed\" in `crate_type`, then cargo should require you to explicitly specify which one you want to use in the dependency definition (for example `some_lib = { version = \"1.0\", crate-type = \"dylib\" }`, where `some_lib` has `crate-type = [\"rlib\", \"dylib\"]` in it's Cargo.toml). *(Or use the `default-crate-type` key I suggested earlier)*\r\nIf neither of them is \"allowed\", it should be a hard error (it's already a warning with a notice that it might become a hard error in the future).\r\n\r\n![the warning](https://user-images.githubusercontent.com/25486263/215187851-c22e92cd-03dd-482a-b4bf-2ad8ca7a283e.png)\r\n\r\n# What this would solve\r\n\r\n - The vagueness of which  `crate_type` is actually used if a dependency has `crate_type = [\"rlib\", \"dylib\"]`. (Currently it seems to just use `rlib`, generating the `dylib` but not actually using it)\r\n - It would make conditional compilation based on `crate_type` that is being generated easier and more intuitive.\r\n - Make it easier to use `crate_type` correctly: not allowing crates to depend on `cdylib` and `staticlib` crates in Cargo.toml (`build.rs` should be used).\r\n\r\n# Potential problems/downsides\r\n\r\n - Compiling all `crate_type`s separately will require to compile all dependencies too. This shouldn't affect the majority of existing crates, since most of them only have one `crate_type`. But for the small subset of crates that do have multiple `crate_type`s and actually need all of them compiled at the same time/place it may increase compilation time significantly. Of course this could be fixed by making cargo keep the cache of builds for all `crate_type`s.\r\n - This would be a breaking change. I am not sure what's the exact Cargo take on breaking changes, but [glancing at it's Cargo.toml I see that it's still pre-1.0](https://github.com/rust-lang/cargo/blob/master/Cargo.toml#L3) and should be possible.\r\n\r\n# Example use-case\r\n\r\nImplementing this proposal would allow one to, for example, make a `cdylib` and define it's public API for Rust in the form of `rlib` very easily in the same crate without using features.\r\n```rust\r\n// Dynamic library implementation\r\n// If a different Rust crate adds this crate as a dependency, only `rlib` will be compiled\r\n// and the following won't be included.\r\n// However, if specifically building the `cdylib` type with `cargo build`, it will be included\r\n#[cfg(crate_type = \"cdylib\")]\r\n#[no_mangle]\r\nextern \"C\" fn example() -> interface::MyGuard {\r\n    interface::MyGuard {\r\n        inner: 123,\r\n    }\r\n}\r\n\r\n// The public API of the dynamic library, that is shared both by the dynamic library itself,\r\n// and binary that uses it. This makes it as simple as adding a dependency to your Cargo.toml\r\n// to get access to the API, without separating the dynamic library into two crates \"impl\" and\r\n// \"interface\" or using features.\r\npub mod interface {\r\n    #[repr(C)]\r\n    pub struct MyGuard {\r\n        pub(crate) inner: usize,\r\n    }\r\n    \r\n    impl Drop for MyGuard {\r\n        fn drop(&mut self) {\r\n            println!(\"guard dropped: {}\", self.inner);\r\n        }\r\n    }\r\n}\r\n```\r\n\r\n</details>\r\n\r\nLooking forward to your comments and thoughts on this proposal.\r\nHopefully I am not making a clown out of myself again \ud83d\ude42",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/1407065944/reactions",
      "total_count": 1,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 1
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/1407416462",
    "html_url": "https://github.com/rust-lang/rust/issues/20267#issuecomment-1407416462",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/20267",
    "id": 1407416462,
    "node_id": "IC_kwDOAAsO6M5T43iO",
    "user": {
      "login": "guilhermewerner",
      "id": 26710260,
      "node_id": "MDQ6VXNlcjI2NzEwMjYw",
      "avatar_url": "https://avatars.githubusercontent.com/u/26710260?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/guilhermewerner",
      "html_url": "https://github.com/guilhermewerner",
      "followers_url": "https://api.github.com/users/guilhermewerner/followers",
      "following_url": "https://api.github.com/users/guilhermewerner/following{/other_user}",
      "gists_url": "https://api.github.com/users/guilhermewerner/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/guilhermewerner/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/guilhermewerner/subscriptions",
      "organizations_url": "https://api.github.com/users/guilhermewerner/orgs",
      "repos_url": "https://api.github.com/users/guilhermewerner/repos",
      "events_url": "https://api.github.com/users/guilhermewerner/events{/privacy}",
      "received_events_url": "https://api.github.com/users/guilhermewerner/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2023-01-28T15:03:15Z",
    "updated_at": "2023-01-28T15:03:15Z",
    "body": "> (A related idea that I haven't thought out very well but still want to mention: something like `default-crate-type` key in Cargo.toml which, if set, would make `cargo build` only build the given type instead of all of them **by default** (still can be overriden by `--crate-type` argument of course))\r\n\r\nIt is possible to achieve this behavior if you set the crate-type to rlib in Cargo.toml and use the following command:\r\n```\r\ncargo rustc --package <package_name> --crate-type cdylib\r\n```\r\nIt will only compile the crate for the crate-types specified in the command, this is possible after https://github.com/rust-lang/rfcs/pull/3180\r\n\r\nThis is a way around the problem of #[cfg(crate_type = \"type\")], where all crates in the project are rlib only, to be used as a dependency on other crates, and when I need to create a cdylib I compile it separately.\r\n\r\nHowever, it would be very interesting not to compile twice to get this result.",
    "author_association": "NONE",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/1407416462/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
