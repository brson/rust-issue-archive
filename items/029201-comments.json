[
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/149832715",
    "html_url": "https://github.com/rust-lang/rust/issues/29201#issuecomment-149832715",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/29201",
    "id": 149832715,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE0OTgzMjcxNQ==",
    "user": {
      "login": "arielb1",
      "id": 1830974,
      "node_id": "MDQ6VXNlcjE4MzA5NzQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1830974?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/arielb1",
      "html_url": "https://github.com/arielb1",
      "followers_url": "https://api.github.com/users/arielb1/followers",
      "following_url": "https://api.github.com/users/arielb1/following{/other_user}",
      "gists_url": "https://api.github.com/users/arielb1/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/arielb1/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/arielb1/subscriptions",
      "organizations_url": "https://api.github.com/users/arielb1/orgs",
      "repos_url": "https://api.github.com/users/arielb1/repos",
      "events_url": "https://api.github.com/users/arielb1/events{/privacy}",
      "received_events_url": "https://api.github.com/users/arielb1/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-10-21T09:22:31Z",
    "updated_at": "2015-10-21T09:22:31Z",
    "body": "This looks like a bug in cargo, not in rustc.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/149832715/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/149835936",
    "html_url": "https://github.com/rust-lang/rust/issues/29201#issuecomment-149835936",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/29201",
    "id": 149835936,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE0OTgzNTkzNg==",
    "user": {
      "login": "octplane",
      "id": 22177,
      "node_id": "MDQ6VXNlcjIyMTc3",
      "avatar_url": "https://avatars.githubusercontent.com/u/22177?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/octplane",
      "html_url": "https://github.com/octplane",
      "followers_url": "https://api.github.com/users/octplane/followers",
      "following_url": "https://api.github.com/users/octplane/following{/other_user}",
      "gists_url": "https://api.github.com/users/octplane/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/octplane/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/octplane/subscriptions",
      "organizations_url": "https://api.github.com/users/octplane/orgs",
      "repos_url": "https://api.github.com/users/octplane/repos",
      "events_url": "https://api.github.com/users/octplane/events{/privacy}",
      "received_events_url": "https://api.github.com/users/octplane/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-10-21T09:32:18Z",
    "updated_at": "2015-10-21T09:32:18Z",
    "body": "Just to be clear, the aforementioned stacktrace is generated using the command:\n\n``` shell\nRUST_BACKTRACE=1 target/debug/rsnotify-33\n```\n\nI fail to see how Cargo is involved here :astonished: \n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/149835936/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/149954094",
    "html_url": "https://github.com/rust-lang/rust/issues/29201#issuecomment-149954094",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/29201",
    "id": 149954094,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE0OTk1NDA5NA==",
    "user": {
      "login": "alexcrichton",
      "id": 64996,
      "node_id": "MDQ6VXNlcjY0OTk2",
      "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alexcrichton",
      "html_url": "https://github.com/alexcrichton",
      "followers_url": "https://api.github.com/users/alexcrichton/followers",
      "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}",
      "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions",
      "organizations_url": "https://api.github.com/users/alexcrichton/orgs",
      "repos_url": "https://api.github.com/users/alexcrichton/repos",
      "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alexcrichton/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-10-21T16:35:20Z",
    "updated_at": "2015-10-21T16:35:26Z",
    "body": "Yes this looks to not be an issue in Cargo. I'm not entirely sure this is a bug in the standard library, however. There's quite a bit of `unsafe` code behind that application (the `notify` crate), so it could be in there perhaps? On nightly the faulting instruction looks like:\n\n```\n(lldb) disas\nrsnotify-33`notify::sync::mpsc::oneshot::Packet<T>::sent:\n    0x100034af0 <+0>:  pushq  %rbp\n    0x100034af1 <+1>:  movq   %rsp, %rbp\n    0x100034af4 <+4>:  movq   %rdi, -0x10(%rbp)\n->  0x100034af8 <+8>:  movq   0x50(%rdi), %rdi\n    ...\n(lldb) print/x $rdi\n(unsigned long) $0 = 0x0000000000001010\n```\n\nThat sort of value getting into a register doesn't look so much like a bug as it does memory corruption. @octplane is there a way to perhaps run the application on Linux instead of just OSX? That should enable using tools like valgrind which can help debug.\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/149954094/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/149956977",
    "html_url": "https://github.com/rust-lang/rust/issues/29201#issuecomment-149956977",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/29201",
    "id": 149956977,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE0OTk1Njk3Nw==",
    "user": {
      "login": "octplane",
      "id": 22177,
      "node_id": "MDQ6VXNlcjIyMTc3",
      "avatar_url": "https://avatars.githubusercontent.com/u/22177?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/octplane",
      "html_url": "https://github.com/octplane",
      "followers_url": "https://api.github.com/users/octplane/followers",
      "following_url": "https://api.github.com/users/octplane/following{/other_user}",
      "gists_url": "https://api.github.com/users/octplane/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/octplane/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/octplane/subscriptions",
      "organizations_url": "https://api.github.com/users/octplane/orgs",
      "repos_url": "https://api.github.com/users/octplane/repos",
      "events_url": "https://api.github.com/users/octplane/events{/privacy}",
      "received_events_url": "https://api.github.com/users/octplane/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-10-21T16:43:46Z",
    "updated_at": "2015-10-21T16:43:46Z",
    "body": "This is not possible to run on linux. It demonstrates the use of OSX FSEvent library binding... If I understand correctly, this issue is strongly related to the unsafe code called thereafter...\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/149956977/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/149962175",
    "html_url": "https://github.com/rust-lang/rust/issues/29201#issuecomment-149962175",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/29201",
    "id": 149962175,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE0OTk2MjE3NQ==",
    "user": {
      "login": "alexcrichton",
      "id": 64996,
      "node_id": "MDQ6VXNlcjY0OTk2",
      "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alexcrichton",
      "html_url": "https://github.com/alexcrichton",
      "followers_url": "https://api.github.com/users/alexcrichton/followers",
      "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}",
      "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions",
      "organizations_url": "https://api.github.com/users/alexcrichton/orgs",
      "repos_url": "https://api.github.com/users/alexcrichton/repos",
      "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alexcrichton/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-10-21T17:00:34Z",
    "updated_at": "2015-10-21T17:00:34Z",
    "body": "Ah yeah this looks like it's a bug in the `notify` crate, [this unsafe block](https://github.com/passcod/rsnotify/blob/master/src/fsevent.rs#L132-L164) will spawn a thread that contains a pointer to `self`, but there's no guarantee that `self` doesn't disappear in the meantime. In your example you drop the `Watcher` before a notification is sent, causing a use-after-free\n\nAs this isn't a bug in channels, however, closing.\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/149962175/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/149964632",
    "html_url": "https://github.com/rust-lang/rust/issues/29201#issuecomment-149964632",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/29201",
    "id": 149964632,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE0OTk2NDYzMg==",
    "user": {
      "login": "octplane",
      "id": 22177,
      "node_id": "MDQ6VXNlcjIyMTc3",
      "avatar_url": "https://avatars.githubusercontent.com/u/22177?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/octplane",
      "html_url": "https://github.com/octplane",
      "followers_url": "https://api.github.com/users/octplane/followers",
      "following_url": "https://api.github.com/users/octplane/following{/other_user}",
      "gists_url": "https://api.github.com/users/octplane/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/octplane/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/octplane/subscriptions",
      "organizations_url": "https://api.github.com/users/octplane/orgs",
      "repos_url": "https://api.github.com/users/octplane/repos",
      "events_url": "https://api.github.com/users/octplane/events{/privacy}",
      "received_events_url": "https://api.github.com/users/octplane/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-10-21T17:07:30Z",
    "updated_at": "2015-10-21T17:07:30Z",
    "body": "Thanks @alexcrichton, much appreciated.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/149964632/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
