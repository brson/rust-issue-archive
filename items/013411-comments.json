[
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/40012450",
    "html_url": "https://github.com/rust-lang/rust/issues/13411#issuecomment-40012450",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/13411",
    "id": 40012450,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQwMDEyNDUw",
    "user": {
      "login": "pongad",
      "id": 1617025,
      "node_id": "MDQ6VXNlcjE2MTcwMjU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1617025?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/pongad",
      "html_url": "https://github.com/pongad",
      "followers_url": "https://api.github.com/users/pongad/followers",
      "following_url": "https://api.github.com/users/pongad/following{/other_user}",
      "gists_url": "https://api.github.com/users/pongad/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/pongad/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/pongad/subscriptions",
      "organizations_url": "https://api.github.com/users/pongad/orgs",
      "repos_url": "https://api.github.com/users/pongad/repos",
      "events_url": "https://api.github.com/users/pongad/events{/privacy}",
      "received_events_url": "https://api.github.com/users/pongad/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-04-09T20:29:21Z",
    "updated_at": "2014-04-09T20:29:21Z",
    "body": "@huonw Would keeping an index be sufficient? Just return `Some(stack[pos])` and bump `pos` each time. It seems to me we don't need any fancy data structure. I can work on this.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/40012450/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/40046273",
    "html_url": "https://github.com/rust-lang/rust/issues/13411#issuecomment-40046273",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/13411",
    "id": 40046273,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQwMDQ2Mjcz",
    "user": {
      "login": "huonw",
      "id": 1203825,
      "node_id": "MDQ6VXNlcjEyMDM4MjU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1203825?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/huonw",
      "html_url": "https://github.com/huonw",
      "followers_url": "https://api.github.com/users/huonw/followers",
      "following_url": "https://api.github.com/users/huonw/following{/other_user}",
      "gists_url": "https://api.github.com/users/huonw/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/huonw/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/huonw/subscriptions",
      "organizations_url": "https://api.github.com/users/huonw/orgs",
      "repos_url": "https://api.github.com/users/huonw/repos",
      "events_url": "https://api.github.com/users/huonw/events{/privacy}",
      "received_events_url": "https://api.github.com/users/huonw/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-04-10T06:13:49Z",
    "updated_at": "2014-04-10T06:13:49Z",
    "body": "That might work, but it does mean that the size of the internal vector grows to be the total number of elements ever touched, rather than just the number of children of recently-walked directories. It would also require cloning each of them. (Maybe not, if it stored `Option<Path>` internally and returned `stack[pos].take()`...)\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/40046273/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/40113468",
    "html_url": "https://github.com/rust-lang/rust/issues/13411#issuecomment-40113468",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/13411",
    "id": 40113468,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQwMTEzNDY4",
    "user": {
      "login": "pongad",
      "id": 1617025,
      "node_id": "MDQ6VXNlcjE2MTcwMjU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1617025?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/pongad",
      "html_url": "https://github.com/pongad",
      "followers_url": "https://api.github.com/users/pongad/followers",
      "following_url": "https://api.github.com/users/pongad/following{/other_user}",
      "gists_url": "https://api.github.com/users/pongad/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/pongad/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/pongad/subscriptions",
      "organizations_url": "https://api.github.com/users/pongad/orgs",
      "repos_url": "https://api.github.com/users/pongad/repos",
      "events_url": "https://api.github.com/users/pongad/events{/privacy}",
      "received_events_url": "https://api.github.com/users/pongad/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-04-10T17:27:23Z",
    "updated_at": "2014-04-10T17:27:23Z",
    "body": "What about this. When we run out of space at the end, check if we are using\nmore than half of the vector. If we are, allocate a new one at least twice\nas large. If we are not, swap all the values to the beginning of the vector.\nThis way we have amortized linear time without needing to use a full blown\ndeque.\nOn Apr 10, 2014 2:14 AM, \"Huon Wilson\" notifications@github.com wrote:\n\n> That might work, but it does mean that the size of the internal vector\n> grows to be the total number of elements ever touched, rather than just the\n> number of children of recently-walked directories. It would also require\n> cloning each of them. (Maybe not, if it stored Option<Path> internally\n> and returned stack[pos].take()...)\n> \n> \u2014\n> Reply to this email directly or view it on GitHubhttps://github.com/mozilla/rust/issues/13411#issuecomment-40046273\n> .\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/40113468/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/40145685",
    "html_url": "https://github.com/rust-lang/rust/issues/13411#issuecomment-40145685",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/13411",
    "id": 40145685,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQwMTQ1Njg1",
    "user": {
      "login": "huonw",
      "id": 1203825,
      "node_id": "MDQ6VXNlcjEyMDM4MjU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1203825?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/huonw",
      "html_url": "https://github.com/huonw",
      "followers_url": "https://api.github.com/users/huonw/followers",
      "following_url": "https://api.github.com/users/huonw/following{/other_user}",
      "gists_url": "https://api.github.com/users/huonw/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/huonw/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/huonw/subscriptions",
      "organizations_url": "https://api.github.com/users/huonw/orgs",
      "repos_url": "https://api.github.com/users/huonw/repos",
      "events_url": "https://api.github.com/users/huonw/events{/privacy}",
      "received_events_url": "https://api.github.com/users/huonw/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-04-10T21:33:10Z",
    "updated_at": "2014-04-10T21:33:10Z",
    "body": "If you can get that to work, I guess so. But really, it would be better/more correct to just use a proper `Deque`... if std had access to one.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/40145685/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/40289496",
    "html_url": "https://github.com/rust-lang/rust/issues/13411#issuecomment-40289496",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/13411",
    "id": 40289496,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQwMjg5NDk2",
    "user": {
      "login": "pongad",
      "id": 1617025,
      "node_id": "MDQ6VXNlcjE2MTcwMjU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1617025?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/pongad",
      "html_url": "https://github.com/pongad",
      "followers_url": "https://api.github.com/users/pongad/followers",
      "following_url": "https://api.github.com/users/pongad/following{/other_user}",
      "gists_url": "https://api.github.com/users/pongad/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/pongad/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/pongad/subscriptions",
      "organizations_url": "https://api.github.com/users/pongad/orgs",
      "repos_url": "https://api.github.com/users/pongad/repos",
      "events_url": "https://api.github.com/users/pongad/events{/privacy}",
      "received_events_url": "https://api.github.com/users/pongad/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-04-12T19:31:57Z",
    "updated_at": "2014-04-12T19:31:57Z",
    "body": "I am going to guess that taking `walk_dir` out of std is undesirable. I can't really think of another way to do this rather than creating a simple `deque`. I'll work on it if you think this is acceptable.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/40289496/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/40296408",
    "html_url": "https://github.com/rust-lang/rust/issues/13411#issuecomment-40296408",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/13411",
    "id": 40296408,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQwMjk2NDA4",
    "user": {
      "login": "liigo",
      "id": 346530,
      "node_id": "MDQ6VXNlcjM0NjUzMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/346530?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/liigo",
      "html_url": "https://github.com/liigo",
      "followers_url": "https://api.github.com/users/liigo/followers",
      "following_url": "https://api.github.com/users/liigo/following{/other_user}",
      "gists_url": "https://api.github.com/users/liigo/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/liigo/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/liigo/subscriptions",
      "organizations_url": "https://api.github.com/users/liigo/orgs",
      "repos_url": "https://api.github.com/users/liigo/repos",
      "events_url": "https://api.github.com/users/liigo/events{/privacy}",
      "received_events_url": "https://api.github.com/users/liigo/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-04-13T00:40:37Z",
    "updated_at": "2014-04-13T00:41:00Z",
    "body": "\"It calls .shift on a vector repeatedly.\" but it's very slow.\n#12884 Vec/Str need an efficient way to shift() multi-items\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/40296408/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/40297350",
    "html_url": "https://github.com/rust-lang/rust/issues/13411#issuecomment-40297350",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/13411",
    "id": 40297350,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQwMjk3MzUw",
    "user": {
      "login": "huonw",
      "id": 1203825,
      "node_id": "MDQ6VXNlcjEyMDM4MjU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1203825?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/huonw",
      "html_url": "https://github.com/huonw",
      "followers_url": "https://api.github.com/users/huonw/followers",
      "following_url": "https://api.github.com/users/huonw/following{/other_user}",
      "gists_url": "https://api.github.com/users/huonw/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/huonw/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/huonw/subscriptions",
      "organizations_url": "https://api.github.com/users/huonw/orgs",
      "repos_url": "https://api.github.com/users/huonw/repos",
      "events_url": "https://api.github.com/users/huonw/events{/privacy}",
      "received_events_url": "https://api.github.com/users/huonw/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-04-13T01:50:00Z",
    "updated_at": "2014-04-13T01:50:00Z",
    "body": "This isn't multiple items, it needs to shift the `Path`s off one at a time.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/40297350/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/40297368",
    "html_url": "https://github.com/rust-lang/rust/issues/13411#issuecomment-40297368",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/13411",
    "id": 40297368,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQwMjk3MzY4",
    "user": {
      "login": "huonw",
      "id": 1203825,
      "node_id": "MDQ6VXNlcjEyMDM4MjU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1203825?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/huonw",
      "html_url": "https://github.com/huonw",
      "followers_url": "https://api.github.com/users/huonw/followers",
      "following_url": "https://api.github.com/users/huonw/following{/other_user}",
      "gists_url": "https://api.github.com/users/huonw/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/huonw/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/huonw/subscriptions",
      "organizations_url": "https://api.github.com/users/huonw/orgs",
      "repos_url": "https://api.github.com/users/huonw/repos",
      "events_url": "https://api.github.com/users/huonw/events{/privacy}",
      "received_events_url": "https://api.github.com/users/huonw/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-04-13T01:51:45Z",
    "updated_at": "2014-04-13T01:51:45Z",
    "body": "(@pongad I would be OK with moving deque into a \"secret\" module inside std and reexporting it from libcollections, however rustdoc doesn't support this nicely just yet.)\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/40297368/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/40304973",
    "html_url": "https://github.com/rust-lang/rust/issues/13411#issuecomment-40304973",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/13411",
    "id": 40304973,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQwMzA0OTcz",
    "user": {
      "login": "Thiez",
      "id": 204550,
      "node_id": "MDQ6VXNlcjIwNDU1MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/204550?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Thiez",
      "html_url": "https://github.com/Thiez",
      "followers_url": "https://api.github.com/users/Thiez/followers",
      "following_url": "https://api.github.com/users/Thiez/following{/other_user}",
      "gists_url": "https://api.github.com/users/Thiez/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Thiez/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Thiez/subscriptions",
      "organizations_url": "https://api.github.com/users/Thiez/orgs",
      "repos_url": "https://api.github.com/users/Thiez/repos",
      "events_url": "https://api.github.com/users/Thiez/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Thiez/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-04-13T11:06:46Z",
    "updated_at": "2014-04-13T11:09:33Z",
    "body": "How about something along these lines:\n\n``` rust\n/// An iterator which walks over a directory\npub struct Directories {\n    stack: Vec<std::vec::MoveItems<Path>>,\n}\n\nimpl Iterator<Path> for Directories {\n  fn next(&mut self) -> Option<Path> {\n    enum LoopResult {\n        AddAndReturn(std::vec::MoveItems<Path,Path),\n        Return(Path),\n        Pop,\n    }\n    loop {\n      let loop_result;\n      match self.stack.last() {\n        Some(ref mut path_iter.next()) => {\n          Some(path) {\n            if (path.is_dir() {\n              match readdir(&path) {\n                Ok(dirs) => {\n                  loop_result = AddAndReturn(dirs.move_iter(), path)\n                },\n                Err(..) => {\n                  loop_result = Return(path)\n                },\n              }\n            } else {\n              loop_result = Return(path)\n            }\n          },\n          None => {\n            loop_result = Pop\n          },\n        }\n        None => {\n          return None,\n        }\n      };\n      match loop_result {\n        AddAndReturn(dirs,path) => {\n          self.stack.push(dirs);\n          return path\n        },\n        Return(path) => {\n          return path\n        },\n        Pop => {\n          self.stack.pop()\n        },\n      };\n    }\n  }\n}\n```\n\nI didn't test the above, removing syntax errors is left as an exercise to the reader.\n\nEdit: Never mind, I see this changes the order that walk_dir guarantees. I'll try and rewrite my proposal tonight to make it emulate the current behaviour.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/40304973/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/40305170",
    "html_url": "https://github.com/rust-lang/rust/issues/13411#issuecomment-40305170",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/13411",
    "id": 40305170,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQwMzA1MTcw",
    "user": {
      "login": "huonw",
      "id": 1203825,
      "node_id": "MDQ6VXNlcjEyMDM4MjU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1203825?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/huonw",
      "html_url": "https://github.com/huonw",
      "followers_url": "https://api.github.com/users/huonw/followers",
      "following_url": "https://api.github.com/users/huonw/following{/other_user}",
      "gists_url": "https://api.github.com/users/huonw/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/huonw/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/huonw/subscriptions",
      "organizations_url": "https://api.github.com/users/huonw/orgs",
      "repos_url": "https://api.github.com/users/huonw/repos",
      "events_url": "https://api.github.com/users/huonw/events{/privacy}",
      "received_events_url": "https://api.github.com/users/huonw/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-04-13T11:19:10Z",
    "updated_at": "2014-04-13T11:19:10Z",
    "body": "I'm not sure the current order is important, I don't know though (if it's not important we can probably just use `Vec` as a stack, which is efficient).\n\nHowever, if we wish to retain the current order, I really do think the correct solution is to just use a deque, rather than write a complicated specialised data structure for this relatively simple task. (Unless that data structure has other significant benefits, of course. Maybe avoiding the copies from each `readdir` vec to main deque will be noticably more efficient?)\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/40305170/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
