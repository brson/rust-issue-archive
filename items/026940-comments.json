[
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/120469765",
    "html_url": "https://github.com/rust-lang/rust/issues/26940#issuecomment-120469765",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/26940",
    "id": 120469765,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEyMDQ2OTc2NQ==",
    "user": {
      "login": "pnkfelix",
      "id": 173127,
      "node_id": "MDQ6VXNlcjE3MzEyNw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/173127?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/pnkfelix",
      "html_url": "https://github.com/pnkfelix",
      "followers_url": "https://api.github.com/users/pnkfelix/followers",
      "following_url": "https://api.github.com/users/pnkfelix/following{/other_user}",
      "gists_url": "https://api.github.com/users/pnkfelix/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/pnkfelix/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/pnkfelix/subscriptions",
      "organizations_url": "https://api.github.com/users/pnkfelix/orgs",
      "repos_url": "https://api.github.com/users/pnkfelix/repos",
      "events_url": "https://api.github.com/users/pnkfelix/events{/privacy}",
      "received_events_url": "https://api.github.com/users/pnkfelix/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-07-10T17:33:58Z",
    "updated_at": "2015-07-10T17:33:58Z",
    "body": "-1.  I don't agree with the reasoning by equivalence with `mem::forget` here -- it is usually easy to grep for and otherwise notice uses of `mem::forget` to catch (non-leak) cases where the destructor is not run, but this change would make it much hard to catch such cases.\n\n(That is, I am inferring that is the effect you want here, that the destructor will not be run... maybe I misunderstood that part of the proposal.)\n\nAlso, shouldn't this be in the RFCs repo?\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/120469765/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/120471201",
    "html_url": "https://github.com/rust-lang/rust/issues/26940#issuecomment-120471201",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/26940",
    "id": 120471201,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEyMDQ3MTIwMQ==",
    "user": {
      "login": "Diggsey",
      "id": 451321,
      "node_id": "MDQ6VXNlcjQ1MTMyMQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/451321?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Diggsey",
      "html_url": "https://github.com/Diggsey",
      "followers_url": "https://api.github.com/users/Diggsey/followers",
      "following_url": "https://api.github.com/users/Diggsey/following{/other_user}",
      "gists_url": "https://api.github.com/users/Diggsey/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Diggsey/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Diggsey/subscriptions",
      "organizations_url": "https://api.github.com/users/Diggsey/orgs",
      "repos_url": "https://api.github.com/users/Diggsey/repos",
      "events_url": "https://api.github.com/users/Diggsey/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Diggsey/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-07-10T17:35:52Z",
    "updated_at": "2015-07-10T17:35:52Z",
    "body": "It's only possible to get equivalent behaviour via `mem::forget` if the type has no private fields. At the moment you're guaranteed that the destructor for private fields can only ever run if the container's destructor has already run. Even if you only allow destructuring of the public fields, that's new behaviour that couldn't be emulated before.\n\nHowever, with the restriction that destructuring can only be used in a context where ALL fields are accessible, I'm all for this feature.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/120471201/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/120478214",
    "html_url": "https://github.com/rust-lang/rust/issues/26940#issuecomment-120478214",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/26940",
    "id": 120478214,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEyMDQ3ODIxNA==",
    "user": {
      "login": "Gankra",
      "id": 1136864,
      "node_id": "MDQ6VXNlcjExMzY4NjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1136864?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Gankra",
      "html_url": "https://github.com/Gankra",
      "followers_url": "https://api.github.com/users/Gankra/followers",
      "following_url": "https://api.github.com/users/Gankra/following{/other_user}",
      "gists_url": "https://api.github.com/users/Gankra/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Gankra/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Gankra/subscriptions",
      "organizations_url": "https://api.github.com/users/Gankra/orgs",
      "repos_url": "https://api.github.com/users/Gankra/repos",
      "events_url": "https://api.github.com/users/Gankra/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Gankra/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-07-10T17:55:27Z",
    "updated_at": "2015-07-10T17:55:27Z",
    "body": "@pnkfelix you understand my proposal, but I think the warn lint would handle grepping, no?\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/120478214/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/120502565",
    "html_url": "https://github.com/rust-lang/rust/issues/26940#issuecomment-120502565",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/26940",
    "id": 120502565,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEyMDUwMjU2NQ==",
    "user": {
      "login": "eefriedman",
      "id": 12769964,
      "node_id": "MDQ6VXNlcjEyNzY5OTY0",
      "avatar_url": "https://avatars.githubusercontent.com/u/12769964?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/eefriedman",
      "html_url": "https://github.com/eefriedman",
      "followers_url": "https://api.github.com/users/eefriedman/followers",
      "following_url": "https://api.github.com/users/eefriedman/following{/other_user}",
      "gists_url": "https://api.github.com/users/eefriedman/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/eefriedman/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/eefriedman/subscriptions",
      "organizations_url": "https://api.github.com/users/eefriedman/orgs",
      "repos_url": "https://api.github.com/users/eefriedman/repos",
      "events_url": "https://api.github.com/users/eefriedman/events{/privacy}",
      "received_events_url": "https://api.github.com/users/eefriedman/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-07-10T19:29:21Z",
    "updated_at": "2015-07-10T19:29:21Z",
    "body": "Another problem you might not have considered:\n\n``` rust\npub struct MaybeCrashOnDrop { c: bool }\nimpl Drop for MaybeCrashOnDrop {\n    fn drop(&mut self) {\n        if self.c {\n            unsafe { *(1 as *mut u8) = 0 }\n        }\n    }\n}\npub struct InteriorUnsafe { pub m: MaybeCrashOnDrop }\nimpl InteriorUnsafe {\n    pub fn new() -> InteriorUnsafe {\n        InteriorUnsafe { m: MaybeCrashOnDrop{ c: true } }\n    }\n}\nimpl Drop for InteriorUnsafe {\n    fn drop(&mut self) {\n        self.m.c = false;\n    }\n}\n```\n\nThis code is safe on current Rust, but isn't safe if destructuring arbitrary types where all the fields are visible is allowed.  This is kind of subtle: it depends on the property that it isn't possible for safe code to create a value of type MaybeCrashOnDrop that isn't wrapped in an InteriorUnsafe.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/120502565/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/120514442",
    "html_url": "https://github.com/rust-lang/rust/issues/26940#issuecomment-120514442",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/26940",
    "id": 120514442,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEyMDUxNDQ0Mg==",
    "user": {
      "login": "Gankra",
      "id": 1136864,
      "node_id": "MDQ6VXNlcjExMzY4NjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1136864?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Gankra",
      "html_url": "https://github.com/Gankra",
      "followers_url": "https://api.github.com/users/Gankra/followers",
      "following_url": "https://api.github.com/users/Gankra/following{/other_user}",
      "gists_url": "https://api.github.com/users/Gankra/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Gankra/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Gankra/subscriptions",
      "organizations_url": "https://api.github.com/users/Gankra/orgs",
      "repos_url": "https://api.github.com/users/Gankra/repos",
      "events_url": "https://api.github.com/users/Gankra/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Gankra/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-07-10T20:31:33Z",
    "updated_at": "2015-07-10T20:31:33Z",
    "body": "Hmm... that's an interesting example, for sure! I suppose I will have to live with ptr::read'ing the fields and mem::forgetting the struct.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/120514442/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
