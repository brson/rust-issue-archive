[
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/19082576",
    "html_url": "https://github.com/rust-lang/rust/issues/5900#issuecomment-19082576",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/5900",
    "id": 19082576,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE5MDgyNTc2",
    "user": {
      "login": "Aatch",
      "id": 342416,
      "node_id": "MDQ6VXNlcjM0MjQxNg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/342416?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Aatch",
      "html_url": "https://github.com/Aatch",
      "followers_url": "https://api.github.com/users/Aatch/followers",
      "following_url": "https://api.github.com/users/Aatch/following{/other_user}",
      "gists_url": "https://api.github.com/users/Aatch/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Aatch/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Aatch/subscriptions",
      "organizations_url": "https://api.github.com/users/Aatch/orgs",
      "repos_url": "https://api.github.com/users/Aatch/repos",
      "events_url": "https://api.github.com/users/Aatch/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Aatch/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2013-06-07T00:21:59Z",
    "updated_at": "2013-06-07T00:21:59Z",
    "body": "Still valid.\n\nNominating for a milestone.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/19082576/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/21389076",
    "html_url": "https://github.com/rust-lang/rust/issues/5900#issuecomment-21389076",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/5900",
    "id": 21389076,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIxMzg5MDc2",
    "user": {
      "login": "huonw",
      "id": 1203825,
      "node_id": "MDQ6VXNlcjEyMDM4MjU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1203825?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/huonw",
      "html_url": "https://github.com/huonw",
      "followers_url": "https://api.github.com/users/huonw/followers",
      "following_url": "https://api.github.com/users/huonw/following{/other_user}",
      "gists_url": "https://api.github.com/users/huonw/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/huonw/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/huonw/subscriptions",
      "organizations_url": "https://api.github.com/users/huonw/orgs",
      "repos_url": "https://api.github.com/users/huonw/repos",
      "events_url": "https://api.github.com/users/huonw/events{/privacy}",
      "received_events_url": "https://api.github.com/users/huonw/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2013-07-23T02:09:27Z",
    "updated_at": "2013-07-23T02:09:27Z",
    "body": "This appears to be an interaction between the `as int` and the submodule specifically, i.e. removing either of them makes it compile without issue.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/21389076/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/23107336",
    "html_url": "https://github.com/rust-lang/rust/issues/5900#issuecomment-23107336",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/5900",
    "id": 23107336,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIzMTA3MzM2",
    "user": {
      "login": "graydon",
      "id": 14097,
      "node_id": "MDQ6VXNlcjE0MDk3",
      "avatar_url": "https://avatars.githubusercontent.com/u/14097?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/graydon",
      "html_url": "https://github.com/graydon",
      "followers_url": "https://api.github.com/users/graydon/followers",
      "following_url": "https://api.github.com/users/graydon/following{/other_user}",
      "gists_url": "https://api.github.com/users/graydon/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/graydon/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/graydon/subscriptions",
      "organizations_url": "https://api.github.com/users/graydon/orgs",
      "repos_url": "https://api.github.com/users/graydon/repos",
      "events_url": "https://api.github.com/users/graydon/events{/privacy}",
      "received_events_url": "https://api.github.com/users/graydon/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2013-08-22T16:58:15Z",
    "updated_at": "2013-08-22T16:58:15Z",
    "body": "accepted for production-ready milestone\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/23107336/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/26755239",
    "html_url": "https://github.com/rust-lang/rust/issues/5900#issuecomment-26755239",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/5900",
    "id": 26755239,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI2NzU1MjM5",
    "user": {
      "login": "ghost",
      "id": 10137,
      "node_id": "MDQ6VXNlcjEwMTM3",
      "avatar_url": "https://avatars.githubusercontent.com/u/10137?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ghost",
      "html_url": "https://github.com/ghost",
      "followers_url": "https://api.github.com/users/ghost/followers",
      "following_url": "https://api.github.com/users/ghost/following{/other_user}",
      "gists_url": "https://api.github.com/users/ghost/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ghost/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ghost/subscriptions",
      "organizations_url": "https://api.github.com/users/ghost/orgs",
      "repos_url": "https://api.github.com/users/ghost/repos",
      "events_url": "https://api.github.com/users/ghost/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ghost/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2013-10-21T20:53:08Z",
    "updated_at": "2013-10-21T20:53:46Z",
    "body": "this still happens with 69e46f3 from master.\n\nBut thx for the workaround Aatch\n",
    "author_association": "NONE",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/26755239/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/26763656",
    "html_url": "https://github.com/rust-lang/rust/issues/5900#issuecomment-26763656",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/5900",
    "id": 26763656,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI2NzYzNjU2",
    "user": {
      "login": "jld",
      "id": 254973,
      "node_id": "MDQ6VXNlcjI1NDk3Mw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/254973?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jld",
      "html_url": "https://github.com/jld",
      "followers_url": "https://api.github.com/users/jld/followers",
      "following_url": "https://api.github.com/users/jld/following{/other_user}",
      "gists_url": "https://api.github.com/users/jld/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jld/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jld/subscriptions",
      "organizations_url": "https://api.github.com/users/jld/orgs",
      "repos_url": "https://api.github.com/users/jld/repos",
      "events_url": "https://api.github.com/users/jld/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jld/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2013-10-21T22:46:19Z",
    "updated_at": "2013-10-21T22:46:19Z",
    "body": "#9942 looks like it might be a duplicate of this issue.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/26763656/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/28990153",
    "html_url": "https://github.com/rust-lang/rust/issues/5900#issuecomment-28990153",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/5900",
    "id": 28990153,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI4OTkwMTUz",
    "user": {
      "login": "jfager",
      "id": 23755,
      "node_id": "MDQ6VXNlcjIzNzU1",
      "avatar_url": "https://avatars.githubusercontent.com/u/23755?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jfager",
      "html_url": "https://github.com/jfager",
      "followers_url": "https://api.github.com/users/jfager/followers",
      "following_url": "https://api.github.com/users/jfager/following{/other_user}",
      "gists_url": "https://api.github.com/users/jfager/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jfager/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jfager/subscriptions",
      "organizations_url": "https://api.github.com/users/jfager/orgs",
      "repos_url": "https://api.github.com/users/jfager/repos",
      "events_url": "https://api.github.com/users/jfager/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jfager/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2013-11-21T14:51:33Z",
    "updated_at": "2013-11-23T14:36:31Z",
    "body": "I've been digging into this a little bit.  The direct problem on the non-compiling case given is that a cast expression needs more information than is currently available when check_item is called for the Context struct.\n\nThe lookup that's failing is\n\n```\nlet ety = tcx.expr_ty(e);\n```\n\nin the ExprCast arm of middle::const_eval::eval_const_expr_partial, which is getting called via check_struct -> check_instantiable -> is_instantiable -> subtypes_require (ty_enum case) -> enum_variants.\n\nI can make the sample code compile if I add\n\n```\nmatch variant.node.disr_expr {\n    Some(e) => write_ty_to_tcx(tcx, e.id, result_ty),\n    _ => {}\n}\n```\n\nto the end of middle::typeck::collect::get_enum_variant_types and then pad out the inner case list on the ExprCast arm of middle::const_eval::eval_const_expr_partial to:\n\n```\nty::ty_int(_) | ty::ty_bool | ty::ty_enum(_,_) => {\n```\n\nI'm pretty doubtful this is the right solution, it's just a hack to highlight the issue.   \n\nAs far as why slight variations work:  \n- If the cast is removed, the code compiles because we hit the ExprLit arm of eval_const_expr_partial instead of ExprCast.  \n- If the enum is placed before the mod block, the code compiles because check_item gets called on the enum before it gets called on the struct, which has the side effect of putting all the right ids into the type context.\n\nIt seems like the \"right\" answer would be ensuring that enums are checked before things that use them, but figuring out how to do that is still a bit out of my depth.  \n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/28990153/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
