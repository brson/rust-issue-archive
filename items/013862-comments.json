[
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/41829645",
    "html_url": "https://github.com/rust-lang/rust/pull/13862#issuecomment-41829645",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/13862",
    "id": 41829645,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQxODI5NjQ1",
    "user": {
      "login": "alexcrichton",
      "id": 64996,
      "node_id": "MDQ6VXNlcjY0OTk2",
      "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alexcrichton",
      "html_url": "https://github.com/alexcrichton",
      "followers_url": "https://api.github.com/users/alexcrichton/followers",
      "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}",
      "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions",
      "organizations_url": "https://api.github.com/users/alexcrichton/orgs",
      "repos_url": "https://api.github.com/users/alexcrichton/repos",
      "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alexcrichton/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-04-30T18:11:22Z",
    "updated_at": "2014-04-30T18:11:22Z",
    "body": "I would have expected this to be done through selection with a timer channel itself, rather than encapsulating it in a `TimeoutReceiver`. I'm curious, did you have some use cases which weren't suitable for that?\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/41829645/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/41899192",
    "html_url": "https://github.com/rust-lang/rust/pull/13862#issuecomment-41899192",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/13862",
    "id": 41899192,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQxODk5MTky",
    "user": {
      "login": "Seldaek",
      "id": 183678,
      "node_id": "MDQ6VXNlcjE4MzY3OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/183678?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Seldaek",
      "html_url": "https://github.com/Seldaek",
      "followers_url": "https://api.github.com/users/Seldaek/followers",
      "following_url": "https://api.github.com/users/Seldaek/following{/other_user}",
      "gists_url": "https://api.github.com/users/Seldaek/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Seldaek/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Seldaek/subscriptions",
      "organizations_url": "https://api.github.com/users/Seldaek/orgs",
      "repos_url": "https://api.github.com/users/Seldaek/repos",
      "events_url": "https://api.github.com/users/Seldaek/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Seldaek/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-05-01T10:45:02Z",
    "updated_at": "2014-05-01T10:45:02Z",
    "body": "Hmm ideally yes it should select either the timer channel or the other channel, like in Go you can select multiple and the first to send something will trigger that part. I have no idea how to achieve this in rust though so I resorted to this loop which seems kinda ugly and not very performant but does the job. If you have some pointers I am happy to try and improve this though.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/41899192/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/41900534",
    "html_url": "https://github.com/rust-lang/rust/pull/13862#issuecomment-41900534",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/13862",
    "id": 41900534,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQxOTAwNTM0",
    "user": {
      "login": "huonw",
      "id": 1203825,
      "node_id": "MDQ6VXNlcjEyMDM4MjU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1203825?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/huonw",
      "html_url": "https://github.com/huonw",
      "followers_url": "https://api.github.com/users/huonw/followers",
      "following_url": "https://api.github.com/users/huonw/following{/other_user}",
      "gists_url": "https://api.github.com/users/huonw/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/huonw/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/huonw/subscriptions",
      "organizations_url": "https://api.github.com/users/huonw/orgs",
      "repos_url": "https://api.github.com/users/huonw/repos",
      "events_url": "https://api.github.com/users/huonw/events{/privacy}",
      "received_events_url": "https://api.github.com/users/huonw/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-05-01T11:13:57Z",
    "updated_at": "2014-05-01T11:13:57Z",
    "body": "I believe the [`select!` macro](http://static.rust-lang.org/doc/master/std/macros/macro.select.html) might do what you want.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/41900534/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/41919201",
    "html_url": "https://github.com/rust-lang/rust/pull/13862#issuecomment-41919201",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/13862",
    "id": 41919201,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQxOTE5MjAx",
    "user": {
      "login": "Seldaek",
      "id": 183678,
      "node_id": "MDQ6VXNlcjE4MzY3OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/183678?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Seldaek",
      "html_url": "https://github.com/Seldaek",
      "followers_url": "https://api.github.com/users/Seldaek/followers",
      "following_url": "https://api.github.com/users/Seldaek/following{/other_user}",
      "gists_url": "https://api.github.com/users/Seldaek/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Seldaek/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Seldaek/subscriptions",
      "organizations_url": "https://api.github.com/users/Seldaek/orgs",
      "repos_url": "https://api.github.com/users/Seldaek/repos",
      "events_url": "https://api.github.com/users/Seldaek/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Seldaek/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-05-01T15:16:08Z",
    "updated_at": "2014-05-01T15:16:08Z",
    "body": "I updated the code to use the stuff from the select macro, this way it now uses 0% cpu while waiting as opposed to slamming one core fully like the previous commit ;)\n\nNow regarding the usefulness of this PR, you could say that `select!()` is enough, but IMO it isn't. It still requires you to understand timers, think about using a timer to interrupt the other channel, and then find out about select!'s existence. This TimeoutReceiver should stand out a bit more in searches and it's possibly easier to grasp. Up to you though of course.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/41919201/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/41928253",
    "html_url": "https://github.com/rust-lang/rust/pull/13862#issuecomment-41928253",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/13862",
    "id": 41928253,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQxOTI4MjUz",
    "user": {
      "login": "alexcrichton",
      "id": 64996,
      "node_id": "MDQ6VXNlcjY0OTk2",
      "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alexcrichton",
      "html_url": "https://github.com/alexcrichton",
      "followers_url": "https://api.github.com/users/alexcrichton/followers",
      "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}",
      "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions",
      "organizations_url": "https://api.github.com/users/alexcrichton/orgs",
      "repos_url": "https://api.github.com/users/alexcrichton/repos",
      "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alexcrichton/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-05-01T16:41:52Z",
    "updated_at": "2014-05-01T16:41:52Z",
    "body": "In general, we favor composability over specific use cases in libraries, one of the best examples of this being iterators. This seems like it falls into the bucket of a convenience function rather than serving a core purpose, so I would be inclined to have better documentation about timers and select.\n\nCurrently the `select!` macro and interface are pretty bad, and I would love to clean them up (especially making them safe), which may explain why the documentation around them is a bit sparse. I can imagine, however, that the `select!` macro itself will not change much over time.\n\nSo, all in all, I would be more in favor of documenting how to receive with a timeout, which would introduce both timers and selection, instead of adding a new primitive. While this primitive is useful for some cases, it unfortunately requires many allocations for each `recv` (creating an I/O object and channel) which is often a burdensome requirement on callers.\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/41928253/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/42003401",
    "html_url": "https://github.com/rust-lang/rust/pull/13862#issuecomment-42003401",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/13862",
    "id": 42003401,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQyMDAzNDAx",
    "user": {
      "login": "Seldaek",
      "id": 183678,
      "node_id": "MDQ6VXNlcjE4MzY3OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/183678?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Seldaek",
      "html_url": "https://github.com/Seldaek",
      "followers_url": "https://api.github.com/users/Seldaek/followers",
      "following_url": "https://api.github.com/users/Seldaek/following{/other_user}",
      "gists_url": "https://api.github.com/users/Seldaek/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Seldaek/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Seldaek/subscriptions",
      "organizations_url": "https://api.github.com/users/Seldaek/orgs",
      "repos_url": "https://api.github.com/users/Seldaek/repos",
      "events_url": "https://api.github.com/users/Seldaek/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Seldaek/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-05-02T08:35:02Z",
    "updated_at": "2014-05-02T08:37:21Z",
    "body": "With this patch:\n\n```\nlet (tx, rx) = channel();\nlet mut rx = TimeoutReceiver::new(rx, 10000);\nmatch rx.recv() {\n    Some(val) => println!(\"Received {}\", val),\n    None => println!(\"timed out, no message received in 10 seconds\"),\n}\n```\n\nWithout:\n\n``` rust\nlet (tx, rx) = channel();\nlet timer = Timer::new().unwrap();\nlet timeout = timer.oneshot(10000);\nselect!(\n    val = rx.recv() => println!(\"Received {}\", val),\n    () = timeout.recv() => println!(\"timed out, no message received in 10 seconds\"),\n)\n```\n\nOn one hand I think it's a bit nicer with this TimeoutReceiver, it feels more rustic to me with the Option than with select!. But I agree it's not a massive difference, once you know how to do it :) So I guess I'll update the PR to just add a doc example then if that's ok, because I think that would have solved my problem as well.\n\nJust for my knowledge's sake however @alexcrichton would you mind expanding on what you said with regard to my patch allocating too much? AFAIK it doesn't allocate more than my example above, and I don't see how it could do less per recv(), maybe using a periodic timer vs a oneshot one, but that's not exactly the same behavior.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/42003401/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/42048325",
    "html_url": "https://github.com/rust-lang/rust/pull/13862#issuecomment-42048325",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/13862",
    "id": 42048325,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQyMDQ4MzI1",
    "user": {
      "login": "alexcrichton",
      "id": 64996,
      "node_id": "MDQ6VXNlcjY0OTk2",
      "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alexcrichton",
      "html_url": "https://github.com/alexcrichton",
      "followers_url": "https://api.github.com/users/alexcrichton/followers",
      "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}",
      "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions",
      "organizations_url": "https://api.github.com/users/alexcrichton/orgs",
      "repos_url": "https://api.github.com/users/alexcrichton/repos",
      "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alexcrichton/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-05-02T16:07:49Z",
    "updated_at": "2014-05-02T16:07:49Z",
    "body": "Ah, sorry, by more allocate-y I meant in terms of continual receiving. The `TimeoutReceiver` in this PR will allocate a timer and a channal for each message received, whereas this code would in theory handle the same use case (roughly).\n\n``` rust\nlet (tx, rx) = channel();\nlet timer = Timer::new().unwrap();\nlet timeout = timer.period(10000);\nloop {\n    select! {\n        val = rx.recv() => println!(\"Received {}\", val),\n        () = timeout.recv() => println!(\"timed out, no message received in 10 seconds\"),\n    }\n}\n```\n\n(in this case no allocations are done on the inner loop).\n\nThat seems like a good idea to add a new example. I think at the top of `std::comm` may be the best location?\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/42048325/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/42099991",
    "html_url": "https://github.com/rust-lang/rust/pull/13862#issuecomment-42099991",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/13862",
    "id": 42099991,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQyMDk5OTkx",
    "user": {
      "login": "Seldaek",
      "id": 183678,
      "node_id": "MDQ6VXNlcjE4MzY3OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/183678?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Seldaek",
      "html_url": "https://github.com/Seldaek",
      "followers_url": "https://api.github.com/users/Seldaek/followers",
      "following_url": "https://api.github.com/users/Seldaek/following{/other_user}",
      "gists_url": "https://api.github.com/users/Seldaek/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Seldaek/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Seldaek/subscriptions",
      "organizations_url": "https://api.github.com/users/Seldaek/orgs",
      "repos_url": "https://api.github.com/users/Seldaek/repos",
      "events_url": "https://api.github.com/users/Seldaek/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Seldaek/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-05-03T08:57:01Z",
    "updated_at": "2014-05-03T08:57:01Z",
    "body": "I will send another PR with an example yes, but your code there is not really correct in that if you receive a message after 5seconds, the next message will only have 5seconds before a timeout occurs, since it doesn't seem possible to \"reset\" a periodic timer. With my version it really was 10seconds per message. This usually matters quite a lot IMO since if you build in a timeout you probably want to abort when it fires.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/42099991/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/42917475",
    "html_url": "https://github.com/rust-lang/rust/pull/13862#issuecomment-42917475",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/13862",
    "id": 42917475,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQyOTE3NDc1",
    "user": {
      "login": "alexcrichton",
      "id": 64996,
      "node_id": "MDQ6VXNlcjY0OTk2",
      "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alexcrichton",
      "html_url": "https://github.com/alexcrichton",
      "followers_url": "https://api.github.com/users/alexcrichton/followers",
      "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}",
      "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions",
      "organizations_url": "https://api.github.com/users/alexcrichton/orgs",
      "repos_url": "https://api.github.com/users/alexcrichton/repos",
      "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alexcrichton/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-05-13T05:05:14Z",
    "updated_at": "2014-05-13T05:05:14Z",
    "body": "Closing due to inactivity, but feel free to reopen with the example we talked about!\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/42917475/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
