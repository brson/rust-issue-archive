[
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/19001588",
    "html_url": "https://github.com/rust-lang/rust/issues/6837#issuecomment-19001588",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/6837",
    "id": 19001588,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE5MDAxNTg4",
    "user": {
      "login": "brson",
      "id": 147214,
      "node_id": "MDQ6VXNlcjE0NzIxNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/brson",
      "html_url": "https://github.com/brson",
      "followers_url": "https://api.github.com/users/brson/followers",
      "following_url": "https://api.github.com/users/brson/following{/other_user}",
      "gists_url": "https://api.github.com/users/brson/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/brson/subscriptions",
      "organizations_url": "https://api.github.com/users/brson/orgs",
      "repos_url": "https://api.github.com/users/brson/repos",
      "events_url": "https://api.github.com/users/brson/events{/privacy}",
      "received_events_url": "https://api.github.com/users/brson/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2013-06-05T19:14:55Z",
    "updated_at": "2013-06-05T19:14:55Z",
    "body": "@Thiez is working on this\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/19001588/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/21593619",
    "html_url": "https://github.com/rust-lang/rust/issues/6837#issuecomment-21593619",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/6837",
    "id": 21593619,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIxNTkzNjE5",
    "user": {
      "login": "msullivan",
      "id": 340349,
      "node_id": "MDQ6VXNlcjM0MDM0OQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/msullivan",
      "html_url": "https://github.com/msullivan",
      "followers_url": "https://api.github.com/users/msullivan/followers",
      "following_url": "https://api.github.com/users/msullivan/following{/other_user}",
      "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions",
      "organizations_url": "https://api.github.com/users/msullivan/orgs",
      "repos_url": "https://api.github.com/users/msullivan/repos",
      "events_url": "https://api.github.com/users/msullivan/events{/privacy}",
      "received_events_url": "https://api.github.com/users/msullivan/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2013-07-26T00:07:16Z",
    "updated_at": "2013-07-26T00:07:16Z",
    "body": "How's this going?\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/21593619/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/21693771",
    "html_url": "https://github.com/rust-lang/rust/issues/6837#issuecomment-21693771",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/6837",
    "id": 21693771,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIxNjkzNzcx",
    "user": {
      "login": "Thiez",
      "id": 204550,
      "node_id": "MDQ6VXNlcjIwNDU1MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/204550?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Thiez",
      "html_url": "https://github.com/Thiez",
      "followers_url": "https://api.github.com/users/Thiez/followers",
      "following_url": "https://api.github.com/users/Thiez/following{/other_user}",
      "gists_url": "https://api.github.com/users/Thiez/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Thiez/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Thiez/subscriptions",
      "organizations_url": "https://api.github.com/users/Thiez/orgs",
      "repos_url": "https://api.github.com/users/Thiez/repos",
      "events_url": "https://api.github.com/users/Thiez/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Thiez/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2013-07-28T23:43:19Z",
    "updated_at": "2013-07-28T23:43:19Z",
    "body": "I've had https://github.com/Thiez/rust/blob/ll-message-queue/src/libstd/rt/message_queue.rs lying around for a while now. It is a Michael-Scott lockless queue as described here http://www.cs.rochester.edu/~scott/papers/1996_PODC_queues.pdf . However, since Rust does not (at this time) have an intrinsic for double-word compare-and-swap, my version is considerably more vulnerable to the ABA-problem and thus I am hesitant to declare this queue complete.\nAdding a DWCAS intrinsic is not a good option as it is not supported on all the architectures we target. I think the best option would be to have a ABA-safe atomic pointer type defined in the library (it would help with the implementation of other datastructures as well). I suspect such a thing could be implemented for each target architecture with some `#[cfg(target_arch = <sometarget>)]` annotations; using LLVM would be tricky as it has no IR instruction that captures the semantics of of LL/SC (on architectures such as ARM).\nI have no MIPS or multicore ARM devices lying around so I would not be able to test such a pointer.\n\nTo summarize, the basic algorithm is implemented and appears to work (without leaking memory, or so valgrind tells me) but it's going to fail randomly (but rarely) when at least two threads are writing and one thread is reading.\nCurrently there's manual malloc/free in the code but now that ~ has lost the headers the malloc could be replaced by a normal ~ followed by a transmute (and transmute back to ~ to delete).\n\nSuggestions are welcome.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/21693771/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/22263808",
    "html_url": "https://github.com/rust-lang/rust/issues/6837#issuecomment-22263808",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/6837",
    "id": 22263808,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIyMjYzODA4",
    "user": {
      "login": "plokhotnyuk",
      "id": 890289,
      "node_id": "MDQ6VXNlcjg5MDI4OQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/890289?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/plokhotnyuk",
      "html_url": "https://github.com/plokhotnyuk",
      "followers_url": "https://api.github.com/users/plokhotnyuk/followers",
      "following_url": "https://api.github.com/users/plokhotnyuk/following{/other_user}",
      "gists_url": "https://api.github.com/users/plokhotnyuk/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/plokhotnyuk/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/plokhotnyuk/subscriptions",
      "organizations_url": "https://api.github.com/users/plokhotnyuk/orgs",
      "repos_url": "https://api.github.com/users/plokhotnyuk/repos",
      "events_url": "https://api.github.com/users/plokhotnyuk/events{/privacy}",
      "received_events_url": "https://api.github.com/users/plokhotnyuk/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2013-08-07T16:24:18Z",
    "updated_at": "2013-08-07T16:26:03Z",
    "body": "I used lock-free MPSC queue that was described by Dmitriy Vyukov (http://www.1024cores.net/home/lock-free-algorithms/queues/non-intrusive-mpsc-node-based-queue) to implement one of fastest and lightweight actor for JVM: https://github.com/plokhotnyuk/actors/blob/master/src/test/scala/com/github/plokhotnyuk/actors/Actor2.scala\n",
    "author_association": "NONE",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/22263808/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/22821669",
    "html_url": "https://github.com/rust-lang/rust/issues/6837#issuecomment-22821669",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/6837",
    "id": 22821669,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIyODIxNjY5",
    "user": {
      "login": "brson",
      "id": 147214,
      "node_id": "MDQ6VXNlcjE0NzIxNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/brson",
      "html_url": "https://github.com/brson",
      "followers_url": "https://api.github.com/users/brson/followers",
      "following_url": "https://api.github.com/users/brson/following{/other_user}",
      "gists_url": "https://api.github.com/users/brson/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/brson/subscriptions",
      "organizations_url": "https://api.github.com/users/brson/orgs",
      "repos_url": "https://api.github.com/users/brson/repos",
      "events_url": "https://api.github.com/users/brson/events{/privacy}",
      "received_events_url": "https://api.github.com/users/brson/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2013-08-17T23:24:06Z",
    "updated_at": "2013-08-17T23:24:06Z",
    "body": "The biggest place where we need to reduce lock contention is the global sleeper list #6838. Its lock is just getting hammered constantly. There are lots of ways we might fix this but an obvious one to replace it with a lock-free queue.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/22821669/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/23655156",
    "html_url": "https://github.com/rust-lang/rust/issues/6837#issuecomment-23655156",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/6837",
    "id": 23655156,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIzNjU1MTU2",
    "user": {
      "login": "Thiez",
      "id": 204550,
      "node_id": "MDQ6VXNlcjIwNDU1MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/204550?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Thiez",
      "html_url": "https://github.com/Thiez",
      "followers_url": "https://api.github.com/users/Thiez/followers",
      "following_url": "https://api.github.com/users/Thiez/following{/other_user}",
      "gists_url": "https://api.github.com/users/Thiez/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Thiez/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Thiez/subscriptions",
      "organizations_url": "https://api.github.com/users/Thiez/orgs",
      "repos_url": "https://api.github.com/users/Thiez/repos",
      "events_url": "https://api.github.com/users/Thiez/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Thiez/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2013-09-02T11:35:58Z",
    "updated_at": "2013-09-02T11:35:58Z",
    "body": "@plokhotnyuk thanks for that link, implementing it in rust was incredibly easy https://github.com/Thiez/rust/blob/better-message-queue/src/libstd/rt/message_queue.rs\n@brson did you have a good benchmark for message-passing lying around?\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/23655156/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/27274070",
    "html_url": "https://github.com/rust-lang/rust/issues/6837#issuecomment-27274070",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/6837",
    "id": 27274070,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3Mjc0MDcw",
    "user": {
      "login": "alexcrichton",
      "id": 64996,
      "node_id": "MDQ6VXNlcjY0OTk2",
      "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alexcrichton",
      "html_url": "https://github.com/alexcrichton",
      "followers_url": "https://api.github.com/users/alexcrichton/followers",
      "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}",
      "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions",
      "organizations_url": "https://api.github.com/users/alexcrichton/orgs",
      "repos_url": "https://api.github.com/users/alexcrichton/repos",
      "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alexcrichton/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2013-10-29T02:25:12Z",
    "updated_at": "2013-10-29T02:25:12Z",
    "body": "Closed by #9710 \n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/27274070/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
