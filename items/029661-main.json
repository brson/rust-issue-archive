{
  "url": "https://api.github.com/repos/rust-lang/rust/issues/29661",
  "repository_url": "https://api.github.com/repos/rust-lang/rust",
  "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/29661/labels{/name}",
  "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/29661/comments",
  "events_url": "https://api.github.com/repos/rust-lang/rust/issues/29661/events",
  "html_url": "https://github.com/rust-lang/rust/issues/29661",
  "id": 115559940,
  "node_id": "MDU6SXNzdWUxMTU1NTk5NDA=",
  "number": 29661,
  "title": "Tracking issue for RFC 2532, \"Associated type defaults\"",
  "user": {
    "login": "aturon",
    "id": 709807,
    "node_id": "MDQ6VXNlcjcwOTgwNw==",
    "avatar_url": "https://avatars.githubusercontent.com/u/709807?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/aturon",
    "html_url": "https://github.com/aturon",
    "followers_url": "https://api.github.com/users/aturon/followers",
    "following_url": "https://api.github.com/users/aturon/following{/other_user}",
    "gists_url": "https://api.github.com/users/aturon/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/aturon/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/aturon/subscriptions",
    "organizations_url": "https://api.github.com/users/aturon/orgs",
    "repos_url": "https://api.github.com/users/aturon/repos",
    "events_url": "https://api.github.com/users/aturon/events{/privacy}",
    "received_events_url": "https://api.github.com/users/aturon/received_events",
    "type": "User",
    "user_view_type": "public",
    "site_admin": false
  },
  "labels": [
    {
      "id": 89436934,
      "node_id": "MDU6TGFiZWw4OTQzNjkzNA==",
      "url": "https://api.github.com/repos/rust-lang/rust/labels/B-RFC-approved",
      "name": "B-RFC-approved",
      "color": "d304cb",
      "default": false,
      "description": "Blocker: Approved by a merged RFC but not yet implemented."
    },
    {
      "id": 149689562,
      "node_id": "MDU6TGFiZWwxNDk2ODk1NjI=",
      "url": "https://api.github.com/repos/rust-lang/rust/labels/A-associated-items",
      "name": "A-associated-items",
      "color": "f7e101",
      "default": false,
      "description": "Area: Associated items (types, constants & functions)"
    },
    {
      "id": 211668019,
      "node_id": "MDU6TGFiZWwyMTE2NjgwMTk=",
      "url": "https://api.github.com/repos/rust-lang/rust/labels/T-lang",
      "name": "T-lang",
      "color": "bfd4f2",
      "default": false,
      "description": "Relevant to the language team"
    },
    {
      "id": 246778137,
      "node_id": "MDU6TGFiZWwyNDY3NzgxMzc=",
      "url": "https://api.github.com/repos/rust-lang/rust/labels/B-unstable",
      "name": "B-unstable",
      "color": "d304cb",
      "default": false,
      "description": "Blocker: Implemented in the nightly compiler and unstable."
    },
    {
      "id": 650846969,
      "node_id": "MDU6TGFiZWw2NTA4NDY5Njk=",
      "url": "https://api.github.com/repos/rust-lang/rust/labels/C-tracking-issue",
      "name": "C-tracking-issue",
      "color": "f5f1fd",
      "default": false,
      "description": "Category: An issue tracking the progress of sth. like the implementation of an RFC"
    },
    {
      "id": 1525709585,
      "node_id": "MDU6TGFiZWwxNTI1NzA5NTg1",
      "url": "https://api.github.com/repos/rust-lang/rust/labels/F-associated_type_defaults",
      "name": "F-associated_type_defaults",
      "color": "f9c0cc",
      "default": false,
      "description": "`#![feature(associated_type_defaults)]`"
    },
    {
      "id": 3537250192,
      "node_id": "LA_kwDOAAsO6M7S1ieQ",
      "url": "https://api.github.com/repos/rust-lang/rust/labels/S-tracking-needs-summary",
      "name": "S-tracking-needs-summary",
      "color": "4682b4",
      "default": false,
      "description": "Status: It's hard to tell what's been done and what hasn't! Someone should do some investigation."
    }
  ],
  "state": "open",
  "locked": false,
  "assignee": null,
  "assignees": [],
  "milestone": null,
  "comments": 43,
  "created_at": "2015-11-06T18:21:43Z",
  "updated_at": "2025-12-03T18:26:53Z",
  "closed_at": null,
  "author_association": "CONTRIBUTOR",
  "type": null,
  "active_lock_reason": null,
  "sub_issues_summary": {
    "total": 0,
    "completed": 0,
    "percent_completed": 0
  },
  "issue_dependencies_summary": {
    "blocked_by": 0,
    "total_blocked_by": 0,
    "blocking": 0,
    "total_blocking": 0
  },
  "body": "This is a tracking issue for the RFC \"Associated type defaults\" (rust-lang/rfcs#2532) under the feature gate `#![feature(associated_type_defaults)]`.\n\n--------------------------\n\nThe [associated item RFC](https://github.com/rust-lang/rfcs/pull/195) included the ability to provide defaults for associated types, with some tricky rules about how that would influence defaulted methods. \n\nThe early implementation of this feature was gated, because there is a widespread feeling that we want a different semantics from the RFC -- namely, that default methods should not be able to assume anything about associated types. This is especially true given the [specialization RFC](https://github.com/rust-lang/rfcs/pull/1210), which provides a much cleaner way of tailoring default implementations.\n\nThe new RFC, rust-lang/rfcs#2532, specifies that this should be the new semantics but has not been implemented yet. The existing behavior under `#![feature(associated_type_defaults)]` is buggy and does not conform to the new RFC. Consult it for a discussion on changes that will be made.\n\n--------------------------\n\n### Steps:\n\n- [ ] Implement rust-lang/rfcs#2532 (cc @rust-lang/wg-traits @rust-lang/compiler)\n  - [X] #61812\n  - [x] handle https://github.com/rust-lang/trait-system-refactor-initiative/issues/46\n  - [ ] Implement the changes to object types specified in the RFC\n- [ ] Improve type mismatch errors when an associated type default can not be projected (https://github.com/rust-lang/rust/pull/61812#discussion_r293952743)\n- [ ] Adjust documentation ([see instructions on forge][doc-guide])\n- [ ] Stabilization PR ([see instructions on forge][stabilization-guide])\n\n[stabilization-guide]: https://forge.rust-lang.org/stabilization-guide.html\n[doc-guide]: https://forge.rust-lang.org/stabilization-guide.html#updating-documentation\n\n### Unresolved questions:\n\n- [ ] [1. When do suitability of defaults need to be proven?](https://github.com/rust-lang/rfcs/blob/master/text/2532-associated-type-defaults.md#1-when-do-suitability-of-defaults-need-to-be-proven)\n- [ ] [2. Where are cycles checked?](https://github.com/rust-lang/rfcs/blob/master/text/2532-associated-type-defaults.md#2-where-are-cycles-checked)\n- [ ] How do associated types interact with supertrait shadowing?  (Since stabilizing associated type defaults would make adding associated types a non-breaking change.)\n\n### Test checklist \n\nOriginally created [as a comment](https://github.com/rust-lang/rust/pull/61812#issuecomment-527959874) on #61812 \n\n- Trait objects and defaults\n    - Independent defaults (`type Foo = u8;`)\n        - [ ] where not specified (`dyn Trait`)\n            - show that it's an error to coerce from `dyn Trait<Foo = u16>` to that\n            - show that we assume it is `u8` by invoking some method etc\n        - [ ] where specified (`dyn Trait<Foo = u16>`)\n            - show that it's an error to coerce from `dyn Trait<Foo = u16>` to that\n            - show that we assume it is `u8` by invoking some method etc\n    - Mixed with type without a default (`type Foo = u8; type Bar;`)\n        - [ ] where neither is specified (`dyn Trait`) -- error\n        - [ ] where `Foo` is specified (`dyn Trait<Foo = u16>`) -- error\n        - [ ] where `Bar` is specified (`dyn Trait<Bar = u32>`) -- ok, check `Foo` defaults to `u8`\n        - [ ] where both are specified (`dyn Trait<Foo = u16, Bar = u32>`) -- ok\n    - Dependent defaults (`type Foo = u8; type Bar = Vec<Self::Foo>`)\n        - [ ] where neither is specified (`dyn Trait`) -- error\n        - [ ] where `Foo` is specified (`dyn Trait<Foo = u16>`) -- unclear, maybe an error?\n        - [ ] where `Bar` is specified (`dyn Trait<Bar = u32>`) -- unclear, maybe an error?\n        - [ ] where both are specified (`dyn Trait<Foo = u16, Bar = u32>`) -- ok\n    - Cyclic defaults (`type Foo = Self::Bar; type Bar = Self::Foo`)\n        - [ ] where neither is specified (`dyn Trait`)\n        - [ ] where `Foo` is specified (`dyn Trait<Foo = u16>`)\n        - [ ] where `Bar` is specified (`dyn Trait<Bar = u32>`)\n        - [ ] where both are specified (`dyn Trait<Foo = u16, Bar = u32>`)\n    - Non-trivial recursive defaults (`type Foo = Vec<Self::Bar>; type Bar = Box<Self::Foo>;`)\n        - [ ] where neither is specified (`dyn Trait`)\n        - [ ] where `Foo` is specified (`dyn Trait<Foo = u16>`)\n        - [ ] where `Bar` is specified (`dyn Trait<Bar = u32>`)\n        - [ ] where both are specified (`dyn Trait<Foo = u16, Bar = u32>`)\n- Specialization\n    - [x] Default values unknown in traits \n    - [x] trait definition cannot rely on `type Foo = u8;` (`defaults-in-other-trait-items.rs`)\n    - [x] impl for trait that manually specifies *can* rely\n        - [x] also, can rely on it from outside the impl\n    - [x] impl for trait that does not specify *can* rely\n    - [x] impl with `default type Foo = u8`, cannot rely on that internally (`defaults-specialization.rs`)\n    - [x] default impl with `type Foo = u8`, cannot rely on that internally (`defaults-specialization.rs`)\n    - [x] impl that specializes but manually specifies *can* rely\n    - [ ] impl that specializes but does not specify *can* rely\n        - right? want also a test that this impl cannot be *further* specialized -- is \"default\" inherited, in other words?\n- Correct defaults in impls (type)\n    - Independent defaults (`type Foo = u8;`)\n        - [x] overriding one default does not require overriding the others (`associated-types/associated-types-overridden-default.rs`)\n            - (does not test that the projections are as expected)\n        - [x] where not specified (`impl Trait { }`) (`associated-types/issue-54182-2.rs`)\n        - [x] where specified (`impl Trait { type Foo = u16; }`) (`issue-54182-1.rs`)\n    - Mixed with type without a default (`type Foo = u8; type Bar;`)\n        - [x] where neither is specified (`impl Trait { }`) -- error\n        - [x] where `Foo` is specified (`impl Trait { type Foo = u16; }`) -- error\n        - [x] where `Bar` is specified (`impl Trait { type Bar = u32; }`) -- ok\n        - [x] where both are specified (`impl Trait { type Foo = u16; type Bar = u32; }`) -- ok\n    - Dependent defaults (`type Foo = u8; type Bar = Vec<Self::Foo>`) -- `defaults-in-other-trait-items-pass.rs`, `defaults-in-other-trait-items-fail.rs`\n        - [x] where neither is specified (`impl Trait { }`)\n        - [x] where `Foo` is specified (`impl Trait { type Foo = u16; }`)\n        - [x] where `Bar` is specified (`impl Trait { type Bar = u32; }`)\n        - [x] where both are specified (`impl Trait { type Foo = u16; type Bar = u32; }`)\n    - Cyclic defaults (`type Foo = Self::Bar; type Bar = Self::Foo`) -- `defaults-cyclic-fail.rs`, `defaults-cyclic-pass.rs`\n        - [x] where neither is specified (`impl Trait { }`)\n            - considered to be an error only if a projection takes place (is this what we want?)\n        - [x] where `Foo` is specified (`impl Trait { type Foo = u16; }`)\n        - [x] where `Bar` is specified (`impl Trait { type Bar = u32; }`)\n        - [x] where both are specified (`impl Trait { type Foo = u16; type Bar = u32; }`)\n    - Non-trivial recursive defaults (`type Foo = Vec<Self::Bar>; type Bar = Box<Self::Foo>;`)\n        - [x] where neither is specified (`impl Trait { }`)\n        - [x] where `Foo` is specified (`impl Trait { type Foo = u16; }`)\n        - [x] where `Bar` is specified (`impl Trait { type Bar = u32; }`)\n        - [x] where both are specified (`impl Trait { type Foo = u16; type Bar = u32; }`)\n- Correct defaults in impls (const)\n    - Independent defaults\n        - [ ] where not specified\n        - [ ] where specified\n    - Mixed with type without a default\n        - [ ] where neither is specified\n        - [ ] where `Foo` is specified\n        - [ ] where `Bar` is specified\n        - [ ] where both are specified\n    - Dependent defaults\n        - [ ] where neither is specified\n        - [ ] where `Foo` is specified\n        - [ ] where `Bar` is specified\n        - [ ] where both are specified\n    - Cyclic defaults -- `defaults-cyclic-fail.rs`, `defaults-cyclic-pass.rs`\n        - [x] where neither is specified (`impl Trait { }`)\n            - considered to be an error only if a projection takes place (is this what we want?)\n        - [x] where `Foo` is specified\n        - [x] where `Bar` is specified\n        - [x] where both are specified\n    - Non-trivial recursive defaults\n        - [ ] where neither is specified\n        - [ ] where `Foo` is specified\n        - [ ] where `Bar` is specified\n        - [ ] where both are specified\n- Overflow errors in const evaluation\n    - check that errors in evaluation do not occur based on default values, but only the final values\n    - Dependent defaults (defaults-not-assumed-fail, defaults-not-assumed-pass)\n        - [x] where neither is specified\n        - [x] where `Foo` is specified\n        - [x] where `Bar` is specified\n        - [x] where both are specified\n- WF checking (`defaults-suitability.rs`)\n    - requires that defaults meet WF check requirements (is this what we want?)\n    - [x] `type` in trait body, bound appears on the item\n    - [x] `type` in trait body, type not wf\n    - [x] `type` in trait body, bound appears as trait where clause\n    - [ ] `default type` in impl, bound appears on the item\n    - [ ] `type` in impl, bound appears on the item\n    - [ ] `type` in default impl, bound appears on the item\n    - [x] `type` in trait body, conditionally wf depending on another default\n        - currently gives an error (is this what we want?)\n    - [x] `type` in trait body, depends on another default whose bounds suffice\n",
  "closed_by": null,
  "reactions": {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/29661/reactions",
    "total_count": 242,
    "+1": 188,
    "-1": 1,
    "laugh": 0,
    "hooray": 21,
    "confused": 0,
    "heart": 11,
    "rocket": 14,
    "eyes": 7
  },
  "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/29661/timeline",
  "performed_via_github_app": null,
  "state_reason": null,
  "_meta": {
    "type": "issue"
  }
}
