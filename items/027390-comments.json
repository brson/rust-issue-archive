[
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/126107830",
    "html_url": "https://github.com/rust-lang/rust/pull/27390#issuecomment-126107830",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/27390",
    "id": 126107830,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEyNjEwNzgzMA==",
    "user": {
      "login": "rust-highfive",
      "id": 7378925,
      "node_id": "MDQ6VXNlcjczNzg5MjU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7378925?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/rust-highfive",
      "html_url": "https://github.com/rust-highfive",
      "followers_url": "https://api.github.com/users/rust-highfive/followers",
      "following_url": "https://api.github.com/users/rust-highfive/following{/other_user}",
      "gists_url": "https://api.github.com/users/rust-highfive/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/rust-highfive/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/rust-highfive/subscriptions",
      "organizations_url": "https://api.github.com/users/rust-highfive/orgs",
      "repos_url": "https://api.github.com/users/rust-highfive/repos",
      "events_url": "https://api.github.com/users/rust-highfive/events{/privacy}",
      "received_events_url": "https://api.github.com/users/rust-highfive/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-07-29T21:54:28Z",
    "updated_at": "2015-07-29T21:54:28Z",
    "body": "r? @aturon\n\n(rust_highfive has picked a reviewer for you, use r? to override)\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/126107830/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/126107859",
    "html_url": "https://github.com/rust-lang/rust/pull/27390#issuecomment-126107859",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/27390",
    "id": 126107859,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEyNjEwNzg1OQ==",
    "user": {
      "login": "remram44",
      "id": 426784,
      "node_id": "MDQ6VXNlcjQyNjc4NA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/426784?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/remram44",
      "html_url": "https://github.com/remram44",
      "followers_url": "https://api.github.com/users/remram44/followers",
      "following_url": "https://api.github.com/users/remram44/following{/other_user}",
      "gists_url": "https://api.github.com/users/remram44/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/remram44/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/remram44/subscriptions",
      "organizations_url": "https://api.github.com/users/remram44/orgs",
      "repos_url": "https://api.github.com/users/remram44/repos",
      "events_url": "https://api.github.com/users/remram44/events{/privacy}",
      "received_events_url": "https://api.github.com/users/remram44/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-07-29T21:54:41Z",
    "updated_at": "2015-07-29T21:54:41Z",
    "body": "r? @alexcrichton\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/126107859/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/126128480",
    "html_url": "https://github.com/rust-lang/rust/pull/27390#issuecomment-126128480",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/27390",
    "id": 126128480,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEyNjEyODQ4MA==",
    "user": {
      "login": "Diggsey",
      "id": 451321,
      "node_id": "MDQ6VXNlcjQ1MTMyMQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/451321?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Diggsey",
      "html_url": "https://github.com/Diggsey",
      "followers_url": "https://api.github.com/users/Diggsey/followers",
      "following_url": "https://api.github.com/users/Diggsey/following{/other_user}",
      "gists_url": "https://api.github.com/users/Diggsey/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Diggsey/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Diggsey/subscriptions",
      "organizations_url": "https://api.github.com/users/Diggsey/orgs",
      "repos_url": "https://api.github.com/users/Diggsey/repos",
      "events_url": "https://api.github.com/users/Diggsey/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Diggsey/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-07-29T23:36:41Z",
    "updated_at": "2015-07-29T23:50:45Z",
    "body": "This is incorrect on windows: OsString does not use UTF8 encoding on windows, it uses WTF8, a superset of UTF8 designed to have a one-to-one mapping with \"potentially ill-formed UTF16\", which is the platform encoding of unicode strings on windows. This function can't exist in a cross-platform way in its current form: it should either restrict the input to valid UTF8 across all platforms, or it should put no additional restrictions on the input, by taking a `&[u16]` on windows and converting losslessly to WTF8 internally (which is the correct way to process strings returned by any windows API functions).\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/126128480/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/126131340",
    "html_url": "https://github.com/rust-lang/rust/pull/27390#issuecomment-126131340",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/27390",
    "id": 126131340,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEyNjEzMTM0MA==",
    "user": {
      "login": "nagisa",
      "id": 679122,
      "node_id": "MDQ6VXNlcjY3OTEyMg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/679122?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nagisa",
      "html_url": "https://github.com/nagisa",
      "followers_url": "https://api.github.com/users/nagisa/followers",
      "following_url": "https://api.github.com/users/nagisa/following{/other_user}",
      "gists_url": "https://api.github.com/users/nagisa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nagisa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nagisa/subscriptions",
      "organizations_url": "https://api.github.com/users/nagisa/orgs",
      "repos_url": "https://api.github.com/users/nagisa/repos",
      "events_url": "https://api.github.com/users/nagisa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nagisa/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-07-29T23:53:42Z",
    "updated_at": "2015-07-29T23:53:42Z",
    "body": "I see absolutely no reason to rename; there\u2019s UFCS for resolving such ambiguities.\n\nAs far as conversion goes, you really want to convert from `&[u16]` rather than `&[u8]` on Windows, hence why `OsStrExt::from_bytes()` exists on UNIX, but not Windows. Overall, :-1: from me.\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/126131340/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/126140167",
    "html_url": "https://github.com/rust-lang/rust/pull/27390#issuecomment-126140167",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/27390",
    "id": 126140167,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEyNjE0MDE2Nw==",
    "user": {
      "login": "retep998",
      "id": 666308,
      "node_id": "MDQ6VXNlcjY2NjMwOA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/666308?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/retep998",
      "html_url": "https://github.com/retep998",
      "followers_url": "https://api.github.com/users/retep998/followers",
      "following_url": "https://api.github.com/users/retep998/following{/other_user}",
      "gists_url": "https://api.github.com/users/retep998/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/retep998/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/retep998/subscriptions",
      "organizations_url": "https://api.github.com/users/retep998/orgs",
      "repos_url": "https://api.github.com/users/retep998/repos",
      "events_url": "https://api.github.com/users/retep998/events{/privacy}",
      "received_events_url": "https://api.github.com/users/retep998/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-07-30T00:36:11Z",
    "updated_at": "2015-07-30T16:27:21Z",
    "body": "We already have `OsStringExt::from_wide` for converting from `&[u16]` anyway.\n\nI believe that exposing `OsString::from_platform_bytes` will give people the false idea that they can use it for narrow strings from system functions on Windows, so I'm somewhat against this.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/126140167/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/126386230",
    "html_url": "https://github.com/rust-lang/rust/pull/27390#issuecomment-126386230",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/27390",
    "id": 126386230,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEyNjM4NjIzMA==",
    "user": {
      "login": "remram44",
      "id": 426784,
      "node_id": "MDQ6VXNlcjQyNjc4NA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/426784?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/remram44",
      "html_url": "https://github.com/remram44",
      "followers_url": "https://api.github.com/users/remram44/followers",
      "following_url": "https://api.github.com/users/remram44/following{/other_user}",
      "gists_url": "https://api.github.com/users/remram44/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/remram44/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/remram44/subscriptions",
      "organizations_url": "https://api.github.com/users/remram44/orgs",
      "repos_url": "https://api.github.com/users/remram44/repos",
      "events_url": "https://api.github.com/users/remram44/events{/privacy}",
      "received_events_url": "https://api.github.com/users/remram44/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-07-30T16:12:18Z",
    "updated_at": "2015-07-30T16:12:18Z",
    "body": "Interesting detail: I'm not adding functionality here, just providing the zero-copy &OsStr version with the same semantics as the existing (unstable) owned OsString method.\n\n---\n\nAs for the functionality, I know it's not perfectly right, but it's still closer than parsing UTF-8 then converting String to OsString. Non-UTF-8 strings definitely appear on UNIX systems in day-to-day situations (they are not an error, they are not an oversight; people still use non-UTF-8 locales), whereas non-unicode strings on Windows are (arguably) an error people shouldn't really rely on; I'm ok not supporting it in some methods (like this one) _with proper warnings_ (which I can add if you want).\n\nYou have to understand that the alternative is for everyone trying to get an OsString (and thus a Path) from bytes is to write a UNIX and a Windows version themselves. My view is that nobody is going to do that, everyone is going to use either this or go from String (UTF-8) and back (if we remove this feature), and it'll be a lot more broken (see things like [getopts which just panics](https://github.com/rust-lang/getopts/issues/28) if you feed it non-UTF-8 arguments)! People will not get this right, don't take away the easy tool to get this right just because it misses one impossible-to-cover corner-case on one platform.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/126386230/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/126387405",
    "html_url": "https://github.com/rust-lang/rust/pull/27390#issuecomment-126387405",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/27390",
    "id": 126387405,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEyNjM4NzQwNQ==",
    "user": {
      "login": "aturon",
      "id": 709807,
      "node_id": "MDQ6VXNlcjcwOTgwNw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/709807?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/aturon",
      "html_url": "https://github.com/aturon",
      "followers_url": "https://api.github.com/users/aturon/followers",
      "following_url": "https://api.github.com/users/aturon/following{/other_user}",
      "gists_url": "https://api.github.com/users/aturon/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/aturon/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/aturon/subscriptions",
      "organizations_url": "https://api.github.com/users/aturon/orgs",
      "repos_url": "https://api.github.com/users/aturon/repos",
      "events_url": "https://api.github.com/users/aturon/events{/privacy}",
      "received_events_url": "https://api.github.com/users/aturon/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-07-30T16:17:23Z",
    "updated_at": "2015-07-30T16:17:23Z",
    "body": "There seems to be some misunderstanding about this PR. As @remram44, this is just filling out a variant of functionality we already have. While it's true that in general on Windows strings may be arbitrary `u16` sequences, there are often cases where you are given some _byte_ sequence and need to view it as an OS string -- and on Windows, often the only way to make sense of that is to interpret that byte sequence as UTF8.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/126387405/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/126388319",
    "html_url": "https://github.com/rust-lang/rust/pull/27390#issuecomment-126388319",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/27390",
    "id": 126388319,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEyNjM4ODMxOQ==",
    "user": {
      "login": "remram44",
      "id": 426784,
      "node_id": "MDQ6VXNlcjQyNjc4NA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/426784?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/remram44",
      "html_url": "https://github.com/remram44",
      "followers_url": "https://api.github.com/users/remram44/followers",
      "following_url": "https://api.github.com/users/remram44/following{/other_user}",
      "gists_url": "https://api.github.com/users/remram44/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/remram44/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/remram44/subscriptions",
      "organizations_url": "https://api.github.com/users/remram44/orgs",
      "repos_url": "https://api.github.com/users/remram44/repos",
      "events_url": "https://api.github.com/users/remram44/events{/privacy}",
      "received_events_url": "https://api.github.com/users/remram44/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-07-30T16:19:20Z",
    "updated_at": "2015-07-30T16:19:20Z",
    "body": "btw tests don't pass because of the last commit, which should arguably just be dropped (no need to deprecate something that has never been stable?)\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/126388319/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/126395856",
    "html_url": "https://github.com/rust-lang/rust/pull/27390#issuecomment-126395856",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/27390",
    "id": 126395856,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEyNjM5NTg1Ng==",
    "user": {
      "login": "nagisa",
      "id": 679122,
      "node_id": "MDQ6VXNlcjY3OTEyMg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/679122?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nagisa",
      "html_url": "https://github.com/nagisa",
      "followers_url": "https://api.github.com/users/nagisa/followers",
      "following_url": "https://api.github.com/users/nagisa/following{/other_user}",
      "gists_url": "https://api.github.com/users/nagisa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nagisa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nagisa/subscriptions",
      "organizations_url": "https://api.github.com/users/nagisa/orgs",
      "repos_url": "https://api.github.com/users/nagisa/repos",
      "events_url": "https://api.github.com/users/nagisa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nagisa/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-07-30T16:36:25Z",
    "updated_at": "2015-07-30T16:37:51Z",
    "body": "@aturon I still don\u2019t see how assumption that any byte sequence on Windows will be UTF-8 is correct; is there a document anywhere that mandates all bytestrings returned by the Windows \u201cplatform\u201d to be valid UTF-8?\n\nEDIT: oooh, it returns an Option. Yeah, ok. I have nothing else to say here.\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/126395856/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/126397602",
    "html_url": "https://github.com/rust-lang/rust/pull/27390#issuecomment-126397602",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/27390",
    "id": 126397602,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEyNjM5NzYwMg==",
    "user": {
      "login": "aturon",
      "id": 709807,
      "node_id": "MDQ6VXNlcjcwOTgwNw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/709807?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/aturon",
      "html_url": "https://github.com/aturon",
      "followers_url": "https://api.github.com/users/aturon/followers",
      "following_url": "https://api.github.com/users/aturon/following{/other_user}",
      "gists_url": "https://api.github.com/users/aturon/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/aturon/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/aturon/subscriptions",
      "organizations_url": "https://api.github.com/users/aturon/orgs",
      "repos_url": "https://api.github.com/users/aturon/repos",
      "events_url": "https://api.github.com/users/aturon/events{/privacy}",
      "received_events_url": "https://api.github.com/users/aturon/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-07-30T16:42:41Z",
    "updated_at": "2015-07-30T16:42:41Z",
    "body": "@nagisa Consider the existing `from_bytes` function. The point is that if you want to interpret a byte sequence as an `OsString` on Windows, the only way to do so is to interpret the bytes as UTF8. Or, put differently: if you want to take a `&[u8]` and produce an `OsString` (or `&OsStr`), what can you possibly do if the slice isn't in UTF8 format? The ways that an arbitrary `u8` sequence can violate UTF8 are distinct from how an arbitrary `u16` sequence can vioalte UTF16.\n\n(The WTF8 encoding is a private representation detail for our `OsString` API; it's not a representation actually used in the wild. Furthermore, not every `u8` sequence is valid WTF8.)\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/126397602/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/126507501",
    "html_url": "https://github.com/rust-lang/rust/pull/27390#issuecomment-126507501",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/27390",
    "id": 126507501,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEyNjUwNzUwMQ==",
    "user": {
      "login": "Diggsey",
      "id": 451321,
      "node_id": "MDQ6VXNlcjQ1MTMyMQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/451321?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Diggsey",
      "html_url": "https://github.com/Diggsey",
      "followers_url": "https://api.github.com/users/Diggsey/followers",
      "following_url": "https://api.github.com/users/Diggsey/following{/other_user}",
      "gists_url": "https://api.github.com/users/Diggsey/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Diggsey/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Diggsey/subscriptions",
      "organizations_url": "https://api.github.com/users/Diggsey/orgs",
      "repos_url": "https://api.github.com/users/Diggsey/repos",
      "events_url": "https://api.github.com/users/Diggsey/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Diggsey/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-07-30T22:14:29Z",
    "updated_at": "2015-07-30T22:24:53Z",
    "body": "> Consider the existing from_bytes function.\n\nI don't think that function should have been added in the first place in this form, but it's a bit late for that.\n\n> on Windows, the only way to do so is to interpret the bytes as UTF8. Or, put differently: if you want to take a &[u8] and produce an OsString (or &OsStr), what can you possibly do if the slice isn't in UTF8 format?\n\nOn windows, strings are not byte sequences, so any code which blindly takes a byte sequence and converts to an OsString using this method will be broken.\n\nThe closest approximation would be when using the non-unicode version of the windows API, in which case, assuming that the bytes are UTF8 is still wrong: the string should first be converted to a wide string using the correct code-page with the functions windows provides (`MultiByteToWideChar`)., and only then stored in an OsString.\n\nCan you give a single example where this would give the correct behaviour on both platforms?\n\n> (The WTF8 encoding is a private representation detail for our OsString API; it's not a representation actually used in the wild. Furthermore, not every u8 sequence is valid WTF8.)\n\nAgreed, which is precisely why there shouldn't be a way to construct an OsString from a byte sequence. There should be platform specific function, which converts to/from a raw platform string on each platform, taking a `&[u8]` on linux, and a `&[u16]` on windows, a conversion to/from the built-in string type, and _maybe_ a helper function for using multi-byte strings on windows, implemented as I described above, nothing else.\n\n> Non-UTF-8 strings definitely appear on UNIX systems in day-to-day situations (they are not an error, they are not an oversight; people still use non-UTF-8 locales), whereas non-unicode strings on Windows are (arguably) an error people shouldn't really rely on\n\nThat's absurd, the situation is the same on both platforms with regard to ill-formed UTF8/UTF16, you're just giving your personal preference for one platform over another.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/126507501/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/126518885",
    "html_url": "https://github.com/rust-lang/rust/pull/27390#issuecomment-126518885",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/27390",
    "id": 126518885,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEyNjUxODg4NQ==",
    "user": {
      "login": "retep998",
      "id": 666308,
      "node_id": "MDQ6VXNlcjY2NjMwOA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/666308?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/retep998",
      "html_url": "https://github.com/retep998",
      "followers_url": "https://api.github.com/users/retep998/followers",
      "following_url": "https://api.github.com/users/retep998/following{/other_user}",
      "gists_url": "https://api.github.com/users/retep998/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/retep998/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/retep998/subscriptions",
      "organizations_url": "https://api.github.com/users/retep998/orgs",
      "repos_url": "https://api.github.com/users/retep998/repos",
      "events_url": "https://api.github.com/users/retep998/events{/privacy}",
      "received_events_url": "https://api.github.com/users/retep998/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-07-30T23:21:55Z",
    "updated_at": "2015-07-30T23:21:55Z",
    "body": "`OsStr` is specifically for working with strings provided by OS APIs. Windows does not use UTF-8 for its APIs. It either uses UCS-2 wide strings, or narrow strings with an arbitrary encoding that is most likely not UTF-8. I don't know of any APIs that only work with narrow strings, everything always has a wide version. Therefore you should never be getting a byte sequence in the first place since all correct code will be using the wide versions to handle unicode properly. If you're getting a byte sequence from somewhere other than the OS, what in the world are you using `OsStr` for?\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/126518885/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/126725982",
    "html_url": "https://github.com/rust-lang/rust/pull/27390#issuecomment-126725982",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/27390",
    "id": 126725982,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEyNjcyNTk4Mg==",
    "user": {
      "login": "remram44",
      "id": 426784,
      "node_id": "MDQ6VXNlcjQyNjc4NA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/426784?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/remram44",
      "html_url": "https://github.com/remram44",
      "followers_url": "https://api.github.com/users/remram44/followers",
      "following_url": "https://api.github.com/users/remram44/following{/other_user}",
      "gists_url": "https://api.github.com/users/remram44/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/remram44/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/remram44/subscriptions",
      "organizations_url": "https://api.github.com/users/remram44/orgs",
      "repos_url": "https://api.github.com/users/remram44/repos",
      "events_url": "https://api.github.com/users/remram44/events{/privacy}",
      "received_events_url": "https://api.github.com/users/remram44/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-07-31T15:33:08Z",
    "updated_at": "2015-07-31T15:33:08Z",
    "body": "`OsStr` is not just for things you get from the OS, obviously: it's also for things you _feed to_ the OS. One very obvious example of this is paths. Why wouldn't you want to read path names from a file or a socket, for example? (file contents are bytes)\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/126725982/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/126732196",
    "html_url": "https://github.com/rust-lang/rust/pull/27390#issuecomment-126732196",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/27390",
    "id": 126732196,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEyNjczMjE5Ng==",
    "user": {
      "login": "Diggsey",
      "id": 451321,
      "node_id": "MDQ6VXNlcjQ1MTMyMQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/451321?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Diggsey",
      "html_url": "https://github.com/Diggsey",
      "followers_url": "https://api.github.com/users/Diggsey/followers",
      "following_url": "https://api.github.com/users/Diggsey/following{/other_user}",
      "gists_url": "https://api.github.com/users/Diggsey/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Diggsey/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Diggsey/subscriptions",
      "organizations_url": "https://api.github.com/users/Diggsey/orgs",
      "repos_url": "https://api.github.com/users/Diggsey/repos",
      "events_url": "https://api.github.com/users/Diggsey/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Diggsey/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-07-31T15:53:33Z",
    "updated_at": "2015-07-31T15:55:48Z",
    "body": "> Why wouldn't you want to read path names from a file or a socket, for example? (file contents are bytes)\n\nIn which case you must know how those path names are encoded. The file format or protocol will dictate what encoding should be used - this function misrepresents itself as being valid regardless of such context. Furthermore, it has different behaviour on each platform, and so is useless for data from files or sockets, which must read the same everywhere.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/126732196/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/126733316",
    "html_url": "https://github.com/rust-lang/rust/pull/27390#issuecomment-126733316",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/27390",
    "id": 126733316,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEyNjczMzMxNg==",
    "user": {
      "login": "retep998",
      "id": 666308,
      "node_id": "MDQ6VXNlcjY2NjMwOA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/666308?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/retep998",
      "html_url": "https://github.com/retep998",
      "followers_url": "https://api.github.com/users/retep998/followers",
      "following_url": "https://api.github.com/users/retep998/following{/other_user}",
      "gists_url": "https://api.github.com/users/retep998/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/retep998/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/retep998/subscriptions",
      "organizations_url": "https://api.github.com/users/retep998/orgs",
      "repos_url": "https://api.github.com/users/retep998/repos",
      "events_url": "https://api.github.com/users/retep998/events{/privacy}",
      "received_events_url": "https://api.github.com/users/retep998/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-07-31T15:56:24Z",
    "updated_at": "2015-07-31T15:56:24Z",
    "body": "@remram44 Also, if you're reading/writing bytes instead of UTF-8, while that allows for *nix paths which might not be unicode, it completely disregards Windows paths which might not be unicode. Blatant disregard for non-unicode paths on one side is not going to make your code cross-platform.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/126733316/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/126774811",
    "html_url": "https://github.com/rust-lang/rust/pull/27390#issuecomment-126774811",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/27390",
    "id": 126774811,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEyNjc3NDgxMQ==",
    "user": {
      "login": "alexcrichton",
      "id": 64996,
      "node_id": "MDQ6VXNlcjY0OTk2",
      "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alexcrichton",
      "html_url": "https://github.com/alexcrichton",
      "followers_url": "https://api.github.com/users/alexcrichton/followers",
      "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}",
      "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions",
      "organizations_url": "https://api.github.com/users/alexcrichton/orgs",
      "repos_url": "https://api.github.com/users/alexcrichton/repos",
      "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alexcrichton/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-07-31T18:15:32Z",
    "updated_at": "2015-07-31T18:15:32Z",
    "body": "I personally would like to see these sorts of methods added and stabilized (in addition to the `to_bytes`, `to_cstring`, and perhaps a future `to_str` methods). I personally find myself commonly writing functions that converts between a list of bytes and an OS string, for example:\n- Cargo [does this](https://github.com/rust-lang/cargo/blob/3eb04414dcb2bcff94e26794f5ff398230b9e669/src/cargo/ops/cargo_rustc/fingerprint.rs#L347) because paths are encoded into file names.\n- git2-rs [does this](https://github.com/alexcrichton/git2-rs/blob/10cdbbcd45bb4ef1c51d79370fa9a96ec1523562/src/util.rs#L54-L63) because the libgit2 API does not expose an OS string, but all paths going in and out are `*const c_char`\n\nI feel that the use case for \"this path needs to be representable as bytes\" really does come up from time to time. I'm quite thankful that I'm forced to acknowledge _somewhere_ along the line that the path probably needs to be unicode on some platforms, but I don't think that we should never adds these convenience methods because they're seen as \"wrong to call\". In each of the above situations there are a few courses of action I could take:\n- For putting paths in files, I could create some form of encoding scheme which isn't lossy on Windows, but this doesn't exist as far as I know and it's _much_ harder to do than just requiring unicode on Windows.\n- For libgit2 I don't believe there's any other recourse. The library wants a byte string there has to be a way to convert a path to that.\n\nI totally agree that we should have proper names for all these to indicate that they're lossy, and that they should be very clearly documented with _why_ they're returning an `Option` and how it can fail on some platforms. Despite the hazards of them, though, I do think the standard library should continue to provide them. These methods will be written in downstream crates whether the standard library contains them or not, so I'm not sure there's much benefit to forcing the implementation to be rewritten downstream (perhaps not as robustly in some cases as well).\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/126774811/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/126827893",
    "html_url": "https://github.com/rust-lang/rust/pull/27390#issuecomment-126827893",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/27390",
    "id": 126827893,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEyNjgyNzg5Mw==",
    "user": {
      "login": "Diggsey",
      "id": 451321,
      "node_id": "MDQ6VXNlcjQ1MTMyMQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/451321?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Diggsey",
      "html_url": "https://github.com/Diggsey",
      "followers_url": "https://api.github.com/users/Diggsey/followers",
      "following_url": "https://api.github.com/users/Diggsey/following{/other_user}",
      "gists_url": "https://api.github.com/users/Diggsey/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Diggsey/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Diggsey/subscriptions",
      "organizations_url": "https://api.github.com/users/Diggsey/orgs",
      "repos_url": "https://api.github.com/users/Diggsey/repos",
      "events_url": "https://api.github.com/users/Diggsey/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Diggsey/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-07-31T22:30:33Z",
    "updated_at": "2015-07-31T22:30:33Z",
    "body": "@alexcrichton Both of those cases you describe are cases where you _shouldn't_ be using this function - the problem is not that its lossy, but that it has entirely different behaviour on the two platforms.\n\nFor example, by using this implementation for cargo, it's now possible for crates to be published from linux inadvertantly using non-UTF8 filenames, which are then completely inaccessible to windows users.\n\nThe best option IMO, when you need paths to be modestly portable, is to just pick an encoding such as UTF8, and enforce it everywhere, requiring that paths be well-formed strings. That at least allows problems to be caught early.\n\nThe only exception, which your `git` example may fall under, is if you have to deal with old software which doesn't cater for strings not being arbitrary byte sequences: in this specific case, the best option is still not to just fail on windows when presented with invalid UTF8 - instead you have some (maybe lossy) mapping from byte sequences to valid windows filenames. For reference, `MultiByteToWideChar` will, by default, strip out invalid byte sequences rather than failing altogether, and this seems to be how TortoiseGit maps paths. Normally you'd want such a mapping to be customizable by the user, (eg. by having a config file tell you what encoding the filenames are expected to be in).\n\nHow exactly would you name this function such that its behaviour would not be surpising? `from_utf8_on_windows_but_unencoded_bytes_elsewhere()`? UTF8 is not even native to windows - the entire OS works in what is essentially UCS-2. All the windows API functions which take raw byte sequences in place of strings expect them to be encoded using the system codepage, not UTF8, and all C/C++ programs written in the recommended way by using TCHARs for strings will also use the system codepage, not UTF8 when compiled with multi-byte character set selected.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/126827893/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/127331001",
    "html_url": "https://github.com/rust-lang/rust/pull/27390#issuecomment-127331001",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/27390",
    "id": 127331001,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEyNzMzMTAwMQ==",
    "user": {
      "login": "alexcrichton",
      "id": 64996,
      "node_id": "MDQ6VXNlcjY0OTk2",
      "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alexcrichton",
      "html_url": "https://github.com/alexcrichton",
      "followers_url": "https://api.github.com/users/alexcrichton/followers",
      "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}",
      "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions",
      "organizations_url": "https://api.github.com/users/alexcrichton/orgs",
      "repos_url": "https://api.github.com/users/alexcrichton/repos",
      "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alexcrichton/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-08-03T16:57:26Z",
    "updated_at": "2015-08-03T16:57:26Z",
    "body": "> Both of those cases you describe are cases where you shouldn't be using this function\n\nI personally don't quite agree with this. For example why should Cargo be hamstrung on Unix because it also supports Windows. Like the standard library, Cargo should work to the fullest extent on all platforms, and you just have to opt-in to cross platform support yourself. The only difference between Cargo and the standard library is that with Cargo you don't ever declare \"allow non-unicode filenames\".\n\n> The only exception, which your git example may fall under, is if you have to deal with old software which doesn't cater for strings not being arbitrary byte sequences\n\nI don't really consider this the \"only exception\". It's quite ubiquitous to have filenames stored as an array of bytes. For example I just remembered the other day that the tarball archive format [stores paths as bytes](https://github.com/alexcrichton/tar-rs/blob/f64a6004b1c9c15aa215d820af47a4f563af4e31/src/lib.rs#L91) and sure enough I have a function [to do the necessary platform logic](https://github.com/alexcrichton/tar-rs/blob/f64a6004b1c9c15aa215d820af47a4f563af4e31/src/lib.rs#L523-L550).\n\n> the best option is still not to just fail on windows when presented with invalid UTF8\n\nI agree! This is what current implementations do, but it would be much nicer if the origin of this error (e.g. the \"this isn't utf-8\" statement) came from the standard library instead of each crate that needs this logic.\n\n> How exactly would you name this function such that its behaviour would not be surpising? \n\nIt sounds like we should focus more on whether this function should exist in the standard library first, because that's what seems in question here. I am not personally a huge fan of `from_platform_bytes` but lack of a name _right now_ does not mean that we shouldn't land this in any form.\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/127331001/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/127338966",
    "html_url": "https://github.com/rust-lang/rust/pull/27390#issuecomment-127338966",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/27390",
    "id": 127338966,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEyNzMzODk2Ng==",
    "user": {
      "login": "nagisa",
      "id": 679122,
      "node_id": "MDQ6VXNlcjY3OTEyMg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/679122?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nagisa",
      "html_url": "https://github.com/nagisa",
      "followers_url": "https://api.github.com/users/nagisa/followers",
      "following_url": "https://api.github.com/users/nagisa/following{/other_user}",
      "gists_url": "https://api.github.com/users/nagisa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nagisa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nagisa/subscriptions",
      "organizations_url": "https://api.github.com/users/nagisa/orgs",
      "repos_url": "https://api.github.com/users/nagisa/repos",
      "events_url": "https://api.github.com/users/nagisa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nagisa/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-08-03T17:31:48Z",
    "updated_at": "2015-08-03T17:31:48Z",
    "body": "> tarball archive format stores paths as bytes and sure enough I have a function to do the necessary platform logic.\n\nLooks like the \u201cplatform\u201d part of `from_platform_bytes` in your example is very unix-centric (sure, tar _is_ a unix-centric format) and towards the OS side you try to convert to the proper representation (and fail; only on windows, for some inputs). `str::from_utf8` at least has the same semantics on all platforms, so maybe just go to `OsStr` through `str` instead?\n\nAt least you won\u2019t have to pretend that any corner case is completely fine as long as the case is noted in the documentation.\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/127338966/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/127340008",
    "html_url": "https://github.com/rust-lang/rust/pull/27390#issuecomment-127340008",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/27390",
    "id": 127340008,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEyNzM0MDAwOA==",
    "user": {
      "login": "remram44",
      "id": 426784,
      "node_id": "MDQ6VXNlcjQyNjc4NA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/426784?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/remram44",
      "html_url": "https://github.com/remram44",
      "followers_url": "https://api.github.com/users/remram44/followers",
      "following_url": "https://api.github.com/users/remram44/following{/other_user}",
      "gists_url": "https://api.github.com/users/remram44/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/remram44/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/remram44/subscriptions",
      "organizations_url": "https://api.github.com/users/remram44/orgs",
      "repos_url": "https://api.github.com/users/remram44/repos",
      "events_url": "https://api.github.com/users/remram44/events{/privacy}",
      "received_events_url": "https://api.github.com/users/remram44/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-08-03T17:34:10Z",
    "updated_at": "2015-08-03T17:34:10Z",
    "body": "> `str::from_utf8` at least has the same semantics on all platforms, so maybe just go to `OsStr` through `str` instead?\n\nThat does the same thing except it chokes on valid filenames on UNIX. Why would anyone do that?\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/127340008/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/127347671",
    "html_url": "https://github.com/rust-lang/rust/pull/27390#issuecomment-127347671",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/27390",
    "id": 127347671,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEyNzM0NzY3MQ==",
    "user": {
      "login": "nagisa",
      "id": 679122,
      "node_id": "MDQ6VXNlcjY3OTEyMg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/679122?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nagisa",
      "html_url": "https://github.com/nagisa",
      "followers_url": "https://api.github.com/users/nagisa/followers",
      "following_url": "https://api.github.com/users/nagisa/following{/other_user}",
      "gists_url": "https://api.github.com/users/nagisa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nagisa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nagisa/subscriptions",
      "organizations_url": "https://api.github.com/users/nagisa/orgs",
      "repos_url": "https://api.github.com/users/nagisa/repos",
      "events_url": "https://api.github.com/users/nagisa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nagisa/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-08-03T17:50:28Z",
    "updated_at": "2015-08-03T17:50:28Z",
    "body": "> That does the same thing except it chokes on valid filenames on UNIX. Why would anyone do that?\n\nThat has the same semantics on all platforms. \n\nI might get a little less opposed to this if there\u2019s another already stable method/function that panics for same input on some platforms, but not others, and the suggested behaviour is as (or more) misleading (no such thing as \u201cOS\u201d bytes on windows). \n\nOtherwise, I honestly care little about windows, so am not inclined to waste my energy arguing over this anymore, since I\u2019m sure you all already got my point.\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/127347671/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/127349791",
    "html_url": "https://github.com/rust-lang/rust/pull/27390#issuecomment-127349791",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/27390",
    "id": 127349791,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEyNzM0OTc5MQ==",
    "user": {
      "login": "Diggsey",
      "id": 451321,
      "node_id": "MDQ6VXNlcjQ1MTMyMQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/451321?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Diggsey",
      "html_url": "https://github.com/Diggsey",
      "followers_url": "https://api.github.com/users/Diggsey/followers",
      "following_url": "https://api.github.com/users/Diggsey/following{/other_user}",
      "gists_url": "https://api.github.com/users/Diggsey/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Diggsey/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Diggsey/subscriptions",
      "organizations_url": "https://api.github.com/users/Diggsey/orgs",
      "repos_url": "https://api.github.com/users/Diggsey/repos",
      "events_url": "https://api.github.com/users/Diggsey/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Diggsey/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-08-03T17:55:26Z",
    "updated_at": "2015-08-03T17:55:26Z",
    "body": "> Why should Cargo be hamstrung on Unix because it also supports Windows.\n\nWhy should Cargo be hamstrung on Windows because it also supports Unix?\n\n> Like the standard library, Cargo should work to the fullest extent on all platforms, and you just have to opt-in to cross platform support yourself. The only difference between Cargo and the standard library is that with Cargo you don't ever declare \"allow non-unicode filenames\".\n\nWith the standard libary, portability is the default. If you want to use platform specific features you can, but you have to opt-in explicitly by using `std::os::linux` or similar. That seems like a very good precedent to follow.\n\n>  It's quite ubiquitous to have filenames stored as an array of bytes.\n\nAmong tools developed solely for unix-like platforms, yes. Unsurprisingly, few of those see extensive use on windows, outside of compatibility layers like cygwin and mingw.\n\n> It would be much nicer if the origin of this error (e.g. the \"this isn't utf-8\" statement) came from the standard library instead of each crate that needs this logic.\n\nIt would be much nicer if it didn't error at all. Any API which can error on some platforms and not others will suffer from programmers not bothering to handle the error, forwarding it to their users instead, as is demonstrated by your `tar` example, which will give up completely if it encounters a non-unicode filename!\n\nPersonally, I think this functionality should exist in a \"unix compatibility\" module, maybe in an external crate, and should perform a best-effort, potentially lossy mapping from byte arrays to OsStrings, which will always succeed. Invalid UTF8 sequences could be removed or replaced with unicode substitution characters on windows.\n\nOne could imagine a similar \"windows compatibility\" module, which takes a `&[u16]` and will perform a best-effort mapping to OsStrings. There could even be a `PortableOsString` type which remembers the source encoding, can be serialized to a file, and will perform a best-effort conversion to an OsString as-needed.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/127349791/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/127406725",
    "html_url": "https://github.com/rust-lang/rust/pull/27390#issuecomment-127406725",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/27390",
    "id": 127406725,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEyNzQwNjcyNQ==",
    "user": {
      "login": "alexcrichton",
      "id": 64996,
      "node_id": "MDQ6VXNlcjY0OTk2",
      "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alexcrichton",
      "html_url": "https://github.com/alexcrichton",
      "followers_url": "https://api.github.com/users/alexcrichton/followers",
      "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}",
      "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions",
      "organizations_url": "https://api.github.com/users/alexcrichton/orgs",
      "repos_url": "https://api.github.com/users/alexcrichton/repos",
      "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alexcrichton/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-08-03T21:08:17Z",
    "updated_at": "2015-08-03T21:08:17Z",
    "body": "@Diggsey I think we're talking in circles, the point I'm trying to get across is that there are situations where you have no choice but to convert an array of bytes to a path. This typically happens because you're doing something like:\n- Using a C library that wants or gives you a `*const c_char`\n- Working with a predefined file format that uses bytes\n\nThe standard library can't just pretend these situations don't exist, and it would be quite nice if there were convenience functions for handling these cases as opposed to every crate having to reinvent the same logic. On unix this bytes-to-path conversion is fine, but on Windows there just fundamentally isn't that many courses of action to take. The only real ubiquitous one which the standard library can take is attempt to interpret the data as UTF-8. This of course means that some input will be rejected, but that's just a fact that can't be worked around.\n\nThese convenience functions being added in this PR will **always** be well documented in terms of what they mean for portability. They seem desired enough to also warrant inclusion into the standard library itself as well.\n\n---\n\n@nagisa \n\n> Looks like the \u201cplatform\u201d part of from_platform_bytes in your example is very unix-centric (sure, tar is a unix-centric format) and towards the OS side you try to convert to the proper representation (and fail; only on windows, for some inputs). str::from_utf8 at least has the same semantics on all platforms, so maybe just go to OsStr through str instead?\n\nI think @remram44 answered this as well, but there's just nothing else that can be done. This library (and I suspect many others) want to be as lossless as possible, so it doesn't always make sense to require that filenames (even on unix) be valid unicode when there's an otherwise valid interpretation.\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/127406725/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/127416365",
    "html_url": "https://github.com/rust-lang/rust/pull/27390#issuecomment-127416365",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/27390",
    "id": 127416365,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEyNzQxNjM2NQ==",
    "user": {
      "login": "Diggsey",
      "id": 451321,
      "node_id": "MDQ6VXNlcjQ1MTMyMQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/451321?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Diggsey",
      "html_url": "https://github.com/Diggsey",
      "followers_url": "https://api.github.com/users/Diggsey/followers",
      "following_url": "https://api.github.com/users/Diggsey/following{/other_user}",
      "gists_url": "https://api.github.com/users/Diggsey/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Diggsey/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Diggsey/subscriptions",
      "organizations_url": "https://api.github.com/users/Diggsey/orgs",
      "repos_url": "https://api.github.com/users/Diggsey/repos",
      "events_url": "https://api.github.com/users/Diggsey/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Diggsey/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-08-03T21:52:51Z",
    "updated_at": "2015-08-03T21:52:51Z",
    "body": "> I think we're talking in circles, the point I'm trying to get across is that there are situations where you have no choice but to convert an array of bytes to a path.\n\nI'm not disagreeing there, I'm simply saying that such a function should absolutely not take the form it does in the existing (thankfully unstable) from_bytes implementation, and that this implementation is inherently non-portable.\n\n> I think @remram44 answered this as well, but there's just nothing else that can be done.\n\nThere's alot else that can be done, as I've been trying to say. Why do you insist on an implementation that will (and already has, by looking at your own examples) lead to programs being broken on non-unix platforms? Especially when it is incompatible with how existing software like git for windows and 7-zip solve the exact same problem.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/127416365/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/127422147",
    "html_url": "https://github.com/rust-lang/rust/pull/27390#issuecomment-127422147",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/27390",
    "id": 127422147,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEyNzQyMjE0Nw==",
    "user": {
      "login": "remram44",
      "id": 426784,
      "node_id": "MDQ6VXNlcjQyNjc4NA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/426784?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/remram44",
      "html_url": "https://github.com/remram44",
      "followers_url": "https://api.github.com/users/remram44/followers",
      "following_url": "https://api.github.com/users/remram44/following{/other_user}",
      "gists_url": "https://api.github.com/users/remram44/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/remram44/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/remram44/subscriptions",
      "organizations_url": "https://api.github.com/users/remram44/orgs",
      "repos_url": "https://api.github.com/users/remram44/repos",
      "events_url": "https://api.github.com/users/remram44/events{/privacy}",
      "received_events_url": "https://api.github.com/users/remram44/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-08-03T22:31:20Z",
    "updated_at": "2015-08-03T22:32:24Z",
    "body": "> There's alot else that can be done, as I've been trying to say. Why do you insist on an implementation that will (and already has, by looking at your own examples) lead to programs being broken on non-unix platforms? Especially when it is incompatible with how existing software like git for windows and 7-zip solve the exact same problem.\n\nMy opinion is that, on Windows, the goal was for filenames to be unicode, and on UNIX, bytes. The fact that Windows accepts invalid unicode data is a bug, and while it's good to support broken strings when it is possible, having them be handled as second-class citizens is fine. That is why I am ok with these functions choking on this (non-silently, and in a recoverable way), if the doc explains clearly why/when it happens.\n\nHow do \"software like git or 7-zip solve the exact same problem\"? Apparently MSYS-Git decodes UTF-8 if valid, else defaults to some other fixed-length encoding. Might be better, but it's still broken (try [checking this out](https://gist.github.com/remram44/49defffeadc5f09778e4)); how much complexity do we want to put in here?\n\nI'm ok with touching up the Windows implementation (though it wouldn't be able to return references anymore), but of course if `from_platform_bytes(to_playform_bytes(.))` doesn't roundtrip, it's in no way safer for the user.\n\nLet me know what you think. Of course, all this has nothing to do with the PR.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/127422147/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/127430708",
    "html_url": "https://github.com/rust-lang/rust/pull/27390#issuecomment-127430708",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/27390",
    "id": 127430708,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEyNzQzMDcwOA==",
    "user": {
      "login": "Diggsey",
      "id": 451321,
      "node_id": "MDQ6VXNlcjQ1MTMyMQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/451321?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Diggsey",
      "html_url": "https://github.com/Diggsey",
      "followers_url": "https://api.github.com/users/Diggsey/followers",
      "following_url": "https://api.github.com/users/Diggsey/following{/other_user}",
      "gists_url": "https://api.github.com/users/Diggsey/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Diggsey/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Diggsey/subscriptions",
      "organizations_url": "https://api.github.com/users/Diggsey/orgs",
      "repos_url": "https://api.github.com/users/Diggsey/repos",
      "events_url": "https://api.github.com/users/Diggsey/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Diggsey/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-08-03T23:27:51Z",
    "updated_at": "2015-08-03T23:29:21Z",
    "body": "> My opinion is that, on Windows, the goal was for filenames to be unicode, and on UNIX, bytes. The fact that Windows accepts invalid unicode data is a bug.\n\nI still disagree with that sentiment, but discussing that is somewhat pointless.\n\n> it's still broken (try checking this out);\n\nThat behaviour is far better: equality between paths has always been ill-defined, even on a single platform. You can have different filesystems mounted, network filesystems, etc. some of which may be case-insensitive, or have other peculiarities. The fact that two very similar paths map to the same thing under some circumstances can happen on any platform, is not particularly surpising, and there's no way to avoid it, save for not using such similar paths.\n\nHowever, the most important thing, is that I _can_ check out that repository. I can even commit changes to either file, and although it may be difficult to modify both files in a single commit, I could probably tweak some config files and get it to work. If git relied on a function like this, I wouldn't even be able check out the repository!\n\n> if from_platform_bytes(to_playform_bytes(.)) doesn't roundtrip, it's in no way safer for the user.\n\nThis has nothing to do with \"platform bytes\": we're not talking about how byte sequences should be decoded on the current platform (which would be according the system codepage on windows), so let's call it what it actually is: `from_ill_formed_utf8_lossy`/`to_ill_formed_utf8_lossy` (utf16 versions would also be useful).\n\nValid unicode will round-trip on all platforms. Invalid unicode is not guaranteed to round-trip, but may (and will on linux). It doesn't need a complicated algorithm: replacing invalid bytes with the unicode replacement character is easy enough and works well (it's also how github renders paths with invalid utf8).\n\nBeing able to round-trip invalid UTF8 is not a guarantee that's necessary to get a far superior user experience, as your git example shows.\n\n> Of course, all this has nothing to do with the PR.\n\nWhen I started this discussion I wasn't aware of the existing `from_bytes` method - we can continue this on the forums instead if you want. However, it would probably be a bad idea to add these new methods, and then soon after remove them in favour of something else, even if they don't get stabilized.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/127430708/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/127459862",
    "html_url": "https://github.com/rust-lang/rust/pull/27390#issuecomment-127459862",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/27390",
    "id": 127459862,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEyNzQ1OTg2Mg==",
    "user": {
      "login": "remram44",
      "id": 426784,
      "node_id": "MDQ6VXNlcjQyNjc4NA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/426784?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/remram44",
      "html_url": "https://github.com/remram44",
      "followers_url": "https://api.github.com/users/remram44/followers",
      "following_url": "https://api.github.com/users/remram44/following{/other_user}",
      "gists_url": "https://api.github.com/users/remram44/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/remram44/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/remram44/subscriptions",
      "organizations_url": "https://api.github.com/users/remram44/orgs",
      "repos_url": "https://api.github.com/users/remram44/repos",
      "events_url": "https://api.github.com/users/remram44/events{/privacy}",
      "received_events_url": "https://api.github.com/users/remram44/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-08-04T02:42:56Z",
    "updated_at": "2015-08-04T02:42:56Z",
    "body": "You're starting to convince me here. Of course, we should consider whether this only makes sense for paths, and move it there if it does.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/127459862/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/127702327",
    "html_url": "https://github.com/rust-lang/rust/pull/27390#issuecomment-127702327",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/27390",
    "id": 127702327,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEyNzcwMjMyNw==",
    "user": {
      "login": "alexcrichton",
      "id": 64996,
      "node_id": "MDQ6VXNlcjY0OTk2",
      "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alexcrichton",
      "html_url": "https://github.com/alexcrichton",
      "followers_url": "https://api.github.com/users/alexcrichton/followers",
      "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}",
      "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions",
      "organizations_url": "https://api.github.com/users/alexcrichton/orgs",
      "repos_url": "https://api.github.com/users/alexcrichton/repos",
      "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alexcrichton/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-08-04T18:29:51Z",
    "updated_at": "2015-08-04T18:29:51Z",
    "body": "> this implementation is inherently non-portable\n\nTrue, but the concept of an array of bytes representing a path is also just inherently non-portable, so your hands are tied in situations like this.\n\n> There's alot else that can be done, as I've been trying to say. Why do you insist on an implementation that will (and already has, by looking at your own examples) lead to programs being broken on non-unix platforms? Especially when it is incompatible with how existing software like git for windows and 7-zip solve the exact same problem.\n\nThat's the problem with a non-portable encoding, there's no correct interpretation of a non-utf8 array of bytes on Windows. Each program can end up doing something subtly different and there's nothing guaranteeing that everyone agrees. Are you saying there's a \"well accepted standard\" for what do do in this case, though?\n\n---\n\nOverall I totally agree that we should try to work with as many paths as possible on all platforms, but attempting to work with non-utf8 arrays on Windows is just a hard operation to do. Applications surely need a pretty heft amount of support behind them to support this, and it's something that could easily exist as an external crates.io library. The standard library, however, can always provide a convenience when this isn't possible.\n\nCorrectly saying that a path can't be handled on Windows is in my opinion better than incorrectly attempting to translate it, later leading to conflicts and/or confusion which can corrupt unrelated files.\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/127702327/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/127740986",
    "html_url": "https://github.com/rust-lang/rust/pull/27390#issuecomment-127740986",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/27390",
    "id": 127740986,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEyNzc0MDk4Ng==",
    "user": {
      "login": "Diggsey",
      "id": 451321,
      "node_id": "MDQ6VXNlcjQ1MTMyMQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/451321?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Diggsey",
      "html_url": "https://github.com/Diggsey",
      "followers_url": "https://api.github.com/users/Diggsey/followers",
      "following_url": "https://api.github.com/users/Diggsey/following{/other_user}",
      "gists_url": "https://api.github.com/users/Diggsey/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Diggsey/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Diggsey/subscriptions",
      "organizations_url": "https://api.github.com/users/Diggsey/orgs",
      "repos_url": "https://api.github.com/users/Diggsey/repos",
      "events_url": "https://api.github.com/users/Diggsey/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Diggsey/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-08-04T20:04:31Z",
    "updated_at": "2015-08-04T20:04:31Z",
    "body": "> Each program can end up doing something subtly different and there's nothing guaranteeing that everyone agrees.\n\nAt least if this is in the standard library, then all rust code will agree.\n\n> Are you saying there's a \"well accepted standard\" for what do do in this case, though?\n\nReplacing invalid bytes with the unicode replacement character is a standard way to interpret ill-formed utf8, and one of the main reasons for the inclusion of that character within unicode.\n\n> Correctly saying that a path can't be handled on Windows is in my opinion better than incorrectly attempting to translate it, later leading to conflicts and/or confusion which can corrupt unrelated files.\n\nUnix is normally case sensitive, so you can have two files, 'A' and 'a' which on windows will refer to the same thing. Are you suggesting that it should also return an error on windows unless all characters are in lower-case? (good luck figuring out which case-conversion algorithm microsoft used!)\n\nReturning an error is actively bad because it implies that this function has any sort of guarantees at all about uniqueness and equality of paths, which it doesn't, even on linux.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/127740986/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/127772925",
    "html_url": "https://github.com/rust-lang/rust/pull/27390#issuecomment-127772925",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/27390",
    "id": 127772925,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEyNzc3MjkyNQ==",
    "user": {
      "login": "alexcrichton",
      "id": 64996,
      "node_id": "MDQ6VXNlcjY0OTk2",
      "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alexcrichton",
      "html_url": "https://github.com/alexcrichton",
      "followers_url": "https://api.github.com/users/alexcrichton/followers",
      "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}",
      "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions",
      "organizations_url": "https://api.github.com/users/alexcrichton/orgs",
      "repos_url": "https://api.github.com/users/alexcrichton/repos",
      "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alexcrichton/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-08-04T21:53:09Z",
    "updated_at": "2015-08-04T21:53:09Z",
    "body": "@Diggsey I think that this is going off into the weeds so let's try to reel this back in. I don't understand where you're coming from about path equality, that seems pretty orthogonal to this helper function in the standard library. The purpose here is to provide a function which can return an interpretation of an array of bytes as an `OsStr` in a **lossless** fashion. There are some cases where that cannot be done, so it returns `None`.\n\nWe already have methods of dealing with a lossy conversion, such as replacing with the unicode replacement character, via `to_string_lossy`. This helper method is simply for situations where this lossiness is unacceptable.\n\nWhether or not a lossy or lossless conversion should be done is up to the application at hand, for example one may wish to do something like:\n\n```\nlet bytes: &[u8] = ...;\nlet os_string = OsString::from_platform_bytes(bytes).unwrap_or_else(|| {\n    OsString::from(String::from_utf8_lossy(bytes))\n});\n```\n\nWhat you seem to be advocating is that this function should not exist in the standard library because it is infallible on Unix and may fail on Windows, and this fallibility may lead to code unnecessarily failing on Windows where it would otherwise succeed on Unix. I think that it is certainly admirable to get as many applications working on all platforms as robustly as possible, but it shouldn't come at the cost of forcing all code to be less ergonomic or reimplemented conversions. \n\nThere are some situations where you simply _must_ do a conversion of bytes to a path, and the application at hand is the one that gets to decide what to do in the erroneous cases. Just because there are erroneous cases doesn't mean that we should avoid any sort of support in the standard library.\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/127772925/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/127815702",
    "html_url": "https://github.com/rust-lang/rust/pull/27390#issuecomment-127815702",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/27390",
    "id": 127815702,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEyNzgxNTcwMg==",
    "user": {
      "login": "Diggsey",
      "id": 451321,
      "node_id": "MDQ6VXNlcjQ1MTMyMQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/451321?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Diggsey",
      "html_url": "https://github.com/Diggsey",
      "followers_url": "https://api.github.com/users/Diggsey/followers",
      "following_url": "https://api.github.com/users/Diggsey/following{/other_user}",
      "gists_url": "https://api.github.com/users/Diggsey/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Diggsey/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Diggsey/subscriptions",
      "organizations_url": "https://api.github.com/users/Diggsey/orgs",
      "repos_url": "https://api.github.com/users/Diggsey/repos",
      "events_url": "https://api.github.com/users/Diggsey/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Diggsey/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-08-05T01:45:07Z",
    "updated_at": "2015-08-05T01:45:07Z",
    "body": "> I don't understand where you're coming from about path equality\n\nYou previously objected to using a lossy conversion on the basis that it may cause two paths to refer to the same file, possibly resulting in one overwriting the other. My point was that this can happen anyway, even on linux with lossless conversions: it's not something you can realistically prevent.\n\n> What you seem to be advocating is that this function should not exist in the standard library because it is infallible on Unix and may fail on Windows\n\nYes. More specifically, it has additional requirements on the input for windows.\n\n> it shouldn't come at the cost of forcing all code to be less ergonomic or reimplemented conversions. \n\nI think in many situations it _is_ worth trading off ergonomics for portability. However, all of the uses of this function which we've discussed would be better served by using the potentially lossy version of this function. If that is provided as the de-facto way to convert bytes to a path, then they all get a consistent, sensible fallback mechanism. The alternative means that many users will not provide a fallback at all, and the rest will likely implement it inconsistently.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/127815702/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/129278598",
    "html_url": "https://github.com/rust-lang/rust/pull/27390#issuecomment-129278598",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/27390",
    "id": 129278598,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEyOTI3ODU5OA==",
    "user": {
      "login": "retep998",
      "id": 666308,
      "node_id": "MDQ6VXNlcjY2NjMwOA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/666308?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/retep998",
      "html_url": "https://github.com/retep998",
      "followers_url": "https://api.github.com/users/retep998/followers",
      "following_url": "https://api.github.com/users/retep998/following{/other_user}",
      "gists_url": "https://api.github.com/users/retep998/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/retep998/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/retep998/subscriptions",
      "organizations_url": "https://api.github.com/users/retep998/orgs",
      "repos_url": "https://api.github.com/users/retep998/repos",
      "events_url": "https://api.github.com/users/retep998/events{/privacy}",
      "received_events_url": "https://api.github.com/users/retep998/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-08-10T02:15:20Z",
    "updated_at": "2015-08-10T02:15:20Z",
    "body": "> Using a C library that wants or gives you a *const c_char\n\nIn this case you're not working with the OS so `OsString` isn't appropriate here. Plus if the C library _is_ doing OS calls with narrow strings, then it is completely not unicode whatsoever, so attempting to interpret it as UTF-8 will fail flat on its face. For this case, where a C library is calling narrow OS functions, perhaps we should provide a method that calls to `MultiByteToWideChar` to convert from the current code page to unicode (and also include a big warning that you really should be using wide versions of Windows functions).\n\n> Working with a predefined file format that uses bytes\n\nWhat sort of file format doesn't specify the encoding on text? If no encoding is specified, then there is absolutely no way to interpret it correctly. At best you can guess. Also, again, this isn't working with the OS so `OsString` still isn't relevant.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/129278598/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/129283909",
    "html_url": "https://github.com/rust-lang/rust/pull/27390#issuecomment-129283909",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/27390",
    "id": 129283909,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEyOTI4MzkwOQ==",
    "user": {
      "login": "Diggsey",
      "id": 451321,
      "node_id": "MDQ6VXNlcjQ1MTMyMQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/451321?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Diggsey",
      "html_url": "https://github.com/Diggsey",
      "followers_url": "https://api.github.com/users/Diggsey/followers",
      "following_url": "https://api.github.com/users/Diggsey/following{/other_user}",
      "gists_url": "https://api.github.com/users/Diggsey/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Diggsey/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Diggsey/subscriptions",
      "organizations_url": "https://api.github.com/users/Diggsey/orgs",
      "repos_url": "https://api.github.com/users/Diggsey/repos",
      "events_url": "https://api.github.com/users/Diggsey/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Diggsey/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-08-10T02:41:41Z",
    "updated_at": "2015-08-10T02:41:41Z",
    "body": "@retep998 For most cases you're absolutely right on both counts. The one exception is when dealing with filesystem paths. Rust's PathBuf uses an OsString to store these, but some C libraries and file formats use unencoded bytes to match how paths are stored on linux.\n\nOn linux, it's desirable to be able to handle ill-formed utf8 in these paths. The question is how to handle conversion from bytes to path in a portable way, given the existence of non-linux platforms. My preferred option is to _only_ provide a potentially lossy \"bytes -> path\" conversion which will always succeed, rather than a reversible \"bytes -> path\" conversion which may fail, but only when not on linux. The justification being that programs which rely on the conversion function being perfectly injective are inherently broken anyway (case insensitivity ftw!), and that it will result in a massively better compatibility story on windows.\n\nFurthermore, the name of the function should at the very least include \"utf8\" and not \"platform\", and should exist for Path/PathBuf not OsString/OsStr.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/129283909/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/129613090",
    "html_url": "https://github.com/rust-lang/rust/pull/27390#issuecomment-129613090",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/27390",
    "id": 129613090,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEyOTYxMzA5MA==",
    "user": {
      "login": "alexcrichton",
      "id": 64996,
      "node_id": "MDQ6VXNlcjY0OTk2",
      "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alexcrichton",
      "html_url": "https://github.com/alexcrichton",
      "followers_url": "https://api.github.com/users/alexcrichton/followers",
      "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}",
      "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions",
      "organizations_url": "https://api.github.com/users/alexcrichton/orgs",
      "repos_url": "https://api.github.com/users/alexcrichton/repos",
      "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alexcrichton/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-08-10T21:29:07Z",
    "updated_at": "2015-08-10T21:29:07Z",
    "body": "@Diggsey \n\n> You previously objected to using a lossy conversion on the basis that it may cause two paths to refer to the same file, possibly resulting in one overwriting the other. My point was that this can happen anyway, even on linux with lossless conversions: it's not something you can realistically prevent.\n\nI believe that issuing syscalls vs the interpretations of those issuings are orthogonal concepts. If we had our own lossy translation then we'd be issuing syscalls with the exact same set of parameters, whereas if various encodings were later treated the same then that's up to the filesystem and out of our control 100% of the time. It's the our job to represent data as faithfully as possible to the point where it hits the filesystem to enable all possible use cases.\n\n> I think in many situations it is worth trading off ergonomics for portability.\n\nI feel that this is not the tradeoff in play here, however. Omitting functions like this are forcing applications on Unix to either:\n- Use `unwrap` or return errors more eagerly than they should.\n- Re-implement the same functionality described here, perhaps incorrectly in some cases.\n\nAdding these functions means that strictly more cases are seamlessly handled across all platforms. It's true that some paths will be accepted on Unix where they'll be rejected on Windows, but it's not the case that every application has this kind of behavior and would run into it.\n\n> However, all of the uses of this function which we've discussed would be better served by using the potentially lossy version of this function.\n\nThis is possible to do today with the `to_string_lossy` function, this PR is pretty orthogonal to this as it's providing a function for those who want to deal with a non-lossy version.\n\n---\n\n@retep998 \n\n> > Using a C library that wants or gives you a *const c_char\n> \n> In this case you're not working with the OS so OsString isn't appropriate here. \n\nI don't think it's correct to make a blanket statement like this. These libraries exist, and they work on Windows, they've made the decision to take `*const c_char`, and most of the time this **simply cannot change**. We can't just turn a blind eye and present an unergonomic interface to all of these libraries, idiomatic Rust bindings will want to interpret these values as `OsStr` or some variant of it.\n\nAs a result there aren't many choices when binding these libraries. You have some bytes, and it's intended to be used as a `Path` in Rust, so you're basically forced to expose it somehow. I do think that you'd of course also want to expose the raw bytes for those extra-robust use cases.\n\nThe difference between OS strings on Windows and Unix should not plauge all of Rust and constantly make any OS interaction as unergonomic as possible. We've selected a pretty nice solution in the standard library, but that does not constitute the entire world. Working with other libraries on all platforms is also a strong point of Rust!\n\n---\n\n@Diggsey \n\n> Furthermore, the name of the function should at the very least include \"utf8\" and not \"platform\", and should exist for Path/PathBuf not OsString/OsStr.\n\nI disagree with this because that's just the meaning on Windows, on Unix there's no utf-8 guarantee needed at all.\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/129613090/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/129636963",
    "html_url": "https://github.com/rust-lang/rust/pull/27390#issuecomment-129636963",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/27390",
    "id": 129636963,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEyOTYzNjk2Mw==",
    "user": {
      "login": "Diggsey",
      "id": 451321,
      "node_id": "MDQ6VXNlcjQ1MTMyMQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/451321?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Diggsey",
      "html_url": "https://github.com/Diggsey",
      "followers_url": "https://api.github.com/users/Diggsey/followers",
      "following_url": "https://api.github.com/users/Diggsey/following{/other_user}",
      "gists_url": "https://api.github.com/users/Diggsey/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Diggsey/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Diggsey/subscriptions",
      "organizations_url": "https://api.github.com/users/Diggsey/orgs",
      "repos_url": "https://api.github.com/users/Diggsey/repos",
      "events_url": "https://api.github.com/users/Diggsey/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Diggsey/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-08-10T22:45:55Z",
    "updated_at": "2015-08-10T22:48:21Z",
    "body": "> I feel that this is not the tradeoff in play here, however. Omitting functions like this are forcing applications on Unix to either:\n> - Use unwrap or return errors more eagerly than they should.\n> - Re-implement the same functionality described here, perhaps incorrectly in some cases.\n\nI don't follow? Surely those are both arguments _against_ a version returning an Option! A version which always succeeds cannot result in more calls to unwrap, and there's no need to reimplement the functionality: the lossy version behaves exactly the same on linux as the non-lossy version does, except you don't need to unwrap it! The difference is that they don't have to reimplement the lossy fallback themselves, which as you point out, they are likely to omit or do incorrectly.\n\n> This is possible to do today with the to_string_lossy function, this PR is pretty orthogonal to this as it's providing a function for those who want to deal with a non-lossy version.\n\n`to_string_lossy` is not the same, and although the function I'm advocating can be implemented in terms of it, that's no guarantee that people will do so correctly or consistently. (to clarify, the function I am advocating is equivalent to 'to_string_lossy' on windows, and a no-op on linux).\n\nAlso, a non-lossy version only makes sense on linux: there is no sensible non-lossy conversion from bytes to strings on windows, so just leave it in the platform specific part of the standard library!\n\n> I disagree with this because that's just the meaning on Windows, on Unix there's no utf-8 guarantee needed at all.\n\nNO, it's NOT the meaning on windows. UTF8 has absolutely no connection to windows AT ALL. The only reason it even remotely makes sense to try decoding the paths as UTF8 is because they are coming from linux, where utf8 is the norm. This is why it should not include \"platform\" in the name.\n\nNow, for why it _should_ include UTF8 in the name: in rust, paths _do_ have an encoding specified: potentially ill-formed UTF8. This is why, when you convert from a Path/OsString to a String, you don't need to specify an encoding (whereas to go from a `Vec<u8>` to a String, you do).\n\nYou're confusing the concepts of data which has an encoding, and data where the encoding is enforced. Paths _are_ UTF8, it's just that they're not guaranteed to be _valid_ UTF8: whenever you display a path in rust, it will interpret it as UTF8, replacing invalid bytes with escape sequences.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/129636963/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/129952153",
    "html_url": "https://github.com/rust-lang/rust/pull/27390#issuecomment-129952153",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/27390",
    "id": 129952153,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEyOTk1MjE1Mw==",
    "user": {
      "login": "aturon",
      "id": 709807,
      "node_id": "MDQ6VXNlcjcwOTgwNw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/709807?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/aturon",
      "html_url": "https://github.com/aturon",
      "followers_url": "https://api.github.com/users/aturon/followers",
      "following_url": "https://api.github.com/users/aturon/following{/other_user}",
      "gists_url": "https://api.github.com/users/aturon/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/aturon/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/aturon/subscriptions",
      "organizations_url": "https://api.github.com/users/aturon/orgs",
      "repos_url": "https://api.github.com/users/aturon/repos",
      "events_url": "https://api.github.com/users/aturon/events{/privacy}",
      "received_events_url": "https://api.github.com/users/aturon/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-08-11T16:15:44Z",
    "updated_at": "2015-08-11T16:15:44Z",
    "body": "As explained [in this comment](https://github.com/rust-lang/rust/pull/27657#issuecomment-129951912), this issue has reached the point that an RFC is warranted to take any action around these APIs (including stabilization of the existing API). As such, I'm going to close out this PR, and hope everyone will continue discussion in a new RFC thread.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/129952153/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
