[
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/73284809",
    "html_url": "https://github.com/rust-lang/rust/issues/21906#issuecomment-73284809",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/21906",
    "id": 73284809,
    "node_id": "MDEyOklzc3VlQ29tbWVudDczMjg0ODA5",
    "user": {
      "login": "gereeter",
      "id": 2328242,
      "node_id": "MDQ6VXNlcjIzMjgyNDI=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2328242?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gereeter",
      "html_url": "https://github.com/gereeter",
      "followers_url": "https://api.github.com/users/gereeter/followers",
      "following_url": "https://api.github.com/users/gereeter/following{/other_user}",
      "gists_url": "https://api.github.com/users/gereeter/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gereeter/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gereeter/subscriptions",
      "organizations_url": "https://api.github.com/users/gereeter/orgs",
      "repos_url": "https://api.github.com/users/gereeter/repos",
      "events_url": "https://api.github.com/users/gereeter/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gereeter/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-02-06T18:11:00Z",
    "updated_at": "2015-02-06T18:11:00Z",
    "body": "I believe this is correct behavior. To see why, consider the code with explicit lifetime annotations:\n\n``` rust\nstruct A {\n    a: i32\n}\n\nimpl A {\n    fn one<'a>(&'a mut self) -> &'a i32{\n        self.a = 10;\n        &self.a\n    }\n    fn two<'a>(&'a mut self) -> &'a i32 {\n        loop {\n            let k = self.one();\n            if *k > 10i32 {\n                return k;\n            }\n        }\n    }\n}\n```\n\n`two` needs to return a reference with the same lifetime as the mutable borrow given to it. However, since it gets its. This means that `k` must have lifetime `'a`. However, for the returned value of `one` to have lifetime `'a`, the input to `one` must also have lifetime `'a`. This means that Rust is forced to not \"reborrow\" `self` and move it in to `one`. Since mutable references are linear, they can only be moved once, but the `loop` means that `one` may need to be called with the same mutable reference repeatedly.\n\nThe second example only works because Rust can see that the loop will only run once, so `self` will only be moved once.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/73284809/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/73296543",
    "html_url": "https://github.com/rust-lang/rust/issues/21906#issuecomment-73296543",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/21906",
    "id": 73296543,
    "node_id": "MDEyOklzc3VlQ29tbWVudDczMjk2NTQz",
    "user": {
      "login": "Gankra",
      "id": 1136864,
      "node_id": "MDQ6VXNlcjExMzY4NjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1136864?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Gankra",
      "html_url": "https://github.com/Gankra",
      "followers_url": "https://api.github.com/users/Gankra/followers",
      "following_url": "https://api.github.com/users/Gankra/following{/other_user}",
      "gists_url": "https://api.github.com/users/Gankra/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Gankra/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Gankra/subscriptions",
      "organizations_url": "https://api.github.com/users/Gankra/orgs",
      "repos_url": "https://api.github.com/users/Gankra/repos",
      "events_url": "https://api.github.com/users/Gankra/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Gankra/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-02-06T19:22:23Z",
    "updated_at": "2016-06-29T17:50:30Z",
    "body": "This looks like a non-lexical borrows issue. You can get similar behaviour without any loops at all:\n\n``` rust\nstruct Foo { data: Option<i32> }\n\nfn main() {\n    let mut x = Foo{data: Some(1)};\n\n    foo(&mut x);\n}\n\nfn foo(x: &mut Foo) -> Option<&mut i32> {\n    if let Some(y) = x.data.as_mut() {\n        return Some(y);\n    }\n\n    println!(\"{:?}\", x.data); \n    None\n}\n```\n\n```\n<anon>:14:22: 14:28 error: cannot borrow `x.data` as immutable because it is also borrowed as mutable\n<anon>:14     println!(\"{:?}\", x.data); \n                               ^~~~~~\nnote: in expansion of format_args!\n<std macros>:2:43: 2:76 note: expansion site\n<std macros>:1:1: 2:78 note: in expansion of println!\n<anon>:14:5: 14:30 note: expansion site\n<anon>:10:22: 10:28 note: previous borrow of `x.data` occurs here; the mutable borrow prevents subsequent moves, borrows, or modification of `x.data` until the borrow ends\n<anon>:10     if let Some(y) = x.data.as_mut() {\n                               ^~~~~~\n<anon>:16:2: 16:2 note: previous borrow ends here\n<anon>:9 fn foo(x: &mut Foo) -> Option<&mut i32> {\n...\n<anon>:16 }\n          ^\nerror: aborting due to previous error\n```\n\nRustc can't \"deal\" with conditional borrowing returns.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/73296543/reactions",
      "total_count": 8,
      "+1": 8,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/73296575",
    "html_url": "https://github.com/rust-lang/rust/issues/21906#issuecomment-73296575",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/21906",
    "id": 73296575,
    "node_id": "MDEyOklzc3VlQ29tbWVudDczMjk2NTc1",
    "user": {
      "login": "Gankra",
      "id": 1136864,
      "node_id": "MDQ6VXNlcjExMzY4NjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1136864?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Gankra",
      "html_url": "https://github.com/Gankra",
      "followers_url": "https://api.github.com/users/Gankra/followers",
      "following_url": "https://api.github.com/users/Gankra/following{/other_user}",
      "gists_url": "https://api.github.com/users/Gankra/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Gankra/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Gankra/subscriptions",
      "organizations_url": "https://api.github.com/users/Gankra/orgs",
      "repos_url": "https://api.github.com/users/Gankra/repos",
      "events_url": "https://api.github.com/users/Gankra/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Gankra/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-02-06T19:22:33Z",
    "updated_at": "2015-02-06T19:22:33Z",
    "body": "CC @pcwalton \n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/73296575/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/92406530",
    "html_url": "https://github.com/rust-lang/rust/issues/21906#issuecomment-92406530",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/21906",
    "id": 92406530,
    "node_id": "MDEyOklzc3VlQ29tbWVudDkyNDA2NTMw",
    "user": {
      "login": "oli-obk",
      "id": 332036,
      "node_id": "MDQ6VXNlcjMzMjAzNg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/332036?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/oli-obk",
      "html_url": "https://github.com/oli-obk",
      "followers_url": "https://api.github.com/users/oli-obk/followers",
      "following_url": "https://api.github.com/users/oli-obk/following{/other_user}",
      "gists_url": "https://api.github.com/users/oli-obk/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/oli-obk/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/oli-obk/subscriptions",
      "organizations_url": "https://api.github.com/users/oli-obk/orgs",
      "repos_url": "https://api.github.com/users/oli-obk/repos",
      "events_url": "https://api.github.com/users/oli-obk/events{/privacy}",
      "received_events_url": "https://api.github.com/users/oli-obk/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-04-13T15:41:37Z",
    "updated_at": "2015-04-13T15:41:37Z",
    "body": "I think the issue is actually that not the return value's mutability is used but the function argument's mutability.\n\nThe following code calls a mutating function that returns an immutable reference. After that I cannot take immutable references.\n\n``` rust\nstruct Foo (u8);\n\nimpl Foo {\n    fn bar(&mut self) -> &u8 {\n        self.0 += 1;\n        &self.0\n    }\n}\n\nfn main() {\n    let mut x = Foo(42);\n    let a = x.bar(); // note: borrow of `x` occurs here\n    let b = x.0; // error: cannot use `x.0` because it was mutably borrowed\n}\n```\n\n[Playpen](http://is.gd/qiKsXL)\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/92406530/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/165926886",
    "html_url": "https://github.com/rust-lang/rust/issues/21906#issuecomment-165926886",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/21906",
    "id": 165926886,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE2NTkyNjg4Ng==",
    "user": {
      "login": "ghost",
      "id": 10137,
      "node_id": "MDQ6VXNlcjEwMTM3",
      "avatar_url": "https://avatars.githubusercontent.com/u/10137?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ghost",
      "html_url": "https://github.com/ghost",
      "followers_url": "https://api.github.com/users/ghost/followers",
      "following_url": "https://api.github.com/users/ghost/following{/other_user}",
      "gists_url": "https://api.github.com/users/ghost/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ghost/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ghost/subscriptions",
      "organizations_url": "https://api.github.com/users/ghost/orgs",
      "repos_url": "https://api.github.com/users/ghost/repos",
      "events_url": "https://api.github.com/users/ghost/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ghost/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-12-19T00:31:31Z",
    "updated_at": "2015-12-19T00:34:28Z",
    "body": "I'm still running into this issue on the latest nightly. It appears that it treats returns as having a lifetime until the end of the function, even if the function without the return passes the borrow checker. This seems kind of odd, considering how the point of a return is to end the function early.\n\nIf you take a look at @Gankro's example, it passes the borrow checker if you remove the return keyword, even though the resulting function won't work properly.\n",
    "author_association": "NONE",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/165926886/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/166683858",
    "html_url": "https://github.com/rust-lang/rust/issues/21906#issuecomment-166683858",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/21906",
    "id": 166683858,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE2NjY4Mzg1OA==",
    "user": {
      "login": "Gankra",
      "id": 1136864,
      "node_id": "MDQ6VXNlcjExMzY4NjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1136864?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Gankra",
      "html_url": "https://github.com/Gankra",
      "followers_url": "https://api.github.com/users/Gankra/followers",
      "following_url": "https://api.github.com/users/Gankra/following{/other_user}",
      "gists_url": "https://api.github.com/users/Gankra/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Gankra/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Gankra/subscriptions",
      "organizations_url": "https://api.github.com/users/Gankra/orgs",
      "repos_url": "https://api.github.com/users/Gankra/repos",
      "events_url": "https://api.github.com/users/Gankra/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Gankra/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-12-22T17:38:59Z",
    "updated_at": "2015-12-22T17:38:59Z",
    "body": "This is blocked on non-lexical lifetimes, which is in turn blocked on MIR. Ideally this will be fixed by the end of 2016, but a fix won't land soon.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/166683858/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/229279040",
    "html_url": "https://github.com/rust-lang/rust/issues/21906#issuecomment-229279040",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/21906",
    "id": 229279040,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIyOTI3OTA0MA==",
    "user": {
      "login": "oli-obk",
      "id": 332036,
      "node_id": "MDQ6VXNlcjMzMjAzNg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/332036?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/oli-obk",
      "html_url": "https://github.com/oli-obk",
      "followers_url": "https://api.github.com/users/oli-obk/followers",
      "following_url": "https://api.github.com/users/oli-obk/following{/other_user}",
      "gists_url": "https://api.github.com/users/oli-obk/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/oli-obk/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/oli-obk/subscriptions",
      "organizations_url": "https://api.github.com/users/oli-obk/orgs",
      "repos_url": "https://api.github.com/users/oli-obk/repos",
      "events_url": "https://api.github.com/users/oli-obk/events{/privacy}",
      "received_events_url": "https://api.github.com/users/oli-obk/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2016-06-29T07:33:42Z",
    "updated_at": "2016-06-29T07:33:42Z",
    "body": "Some discussion on internals: https://internals.rust-lang.org/t/relaxing-the-borrow-checker-for-fn-mut-self-t/3256\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/229279040/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/233931961",
    "html_url": "https://github.com/rust-lang/rust/issues/21906#issuecomment-233931961",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/21906",
    "id": 233931961,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIzMzkzMTk2MQ==",
    "user": {
      "login": "aidanhs",
      "id": 1050652,
      "node_id": "MDQ6VXNlcjEwNTA2NTI=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1050652?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/aidanhs",
      "html_url": "https://github.com/aidanhs",
      "followers_url": "https://api.github.com/users/aidanhs/followers",
      "following_url": "https://api.github.com/users/aidanhs/following{/other_user}",
      "gists_url": "https://api.github.com/users/aidanhs/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/aidanhs/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/aidanhs/subscriptions",
      "organizations_url": "https://api.github.com/users/aidanhs/orgs",
      "repos_url": "https://api.github.com/users/aidanhs/repos",
      "events_url": "https://api.github.com/users/aidanhs/events{/privacy}",
      "received_events_url": "https://api.github.com/users/aidanhs/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2016-07-20T12:14:31Z",
    "updated_at": "2016-07-20T12:14:31Z",
    "body": "Non lexical borrows feature discussion: https://github.com/rust-lang/rfcs/issues/811\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/233931961/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/299708795",
    "html_url": "https://github.com/rust-lang/rust/issues/21906#issuecomment-299708795",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/21906",
    "id": 299708795,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI5OTcwODc5NQ==",
    "user": {
      "login": "Mark-Simulacrum",
      "id": 5047365,
      "node_id": "MDQ6VXNlcjUwNDczNjU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5047365?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Mark-Simulacrum",
      "html_url": "https://github.com/Mark-Simulacrum",
      "followers_url": "https://api.github.com/users/Mark-Simulacrum/followers",
      "following_url": "https://api.github.com/users/Mark-Simulacrum/following{/other_user}",
      "gists_url": "https://api.github.com/users/Mark-Simulacrum/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Mark-Simulacrum/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Mark-Simulacrum/subscriptions",
      "organizations_url": "https://api.github.com/users/Mark-Simulacrum/orgs",
      "repos_url": "https://api.github.com/users/Mark-Simulacrum/repos",
      "events_url": "https://api.github.com/users/Mark-Simulacrum/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Mark-Simulacrum/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2017-05-07T14:11:02Z",
    "updated_at": "2017-05-07T14:11:02Z",
    "body": "So reading the [internals thread] makes me feel like this isn't fixable (even with NLL). Can someone confirm? (@eddyb?)\r\n\r\n\r\n[internals thread]: https://internals.rust-lang.org/t/relaxing-the-borrow-checker-for-fn-mut-self-t/3256",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/299708795/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/299710653",
    "html_url": "https://github.com/rust-lang/rust/issues/21906#issuecomment-299710653",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/21906",
    "id": 299710653,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI5OTcxMDY1Mw==",
    "user": {
      "login": "eddyb",
      "id": 77424,
      "node_id": "MDQ6VXNlcjc3NDI0",
      "avatar_url": "https://avatars.githubusercontent.com/u/77424?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/eddyb",
      "html_url": "https://github.com/eddyb",
      "followers_url": "https://api.github.com/users/eddyb/followers",
      "following_url": "https://api.github.com/users/eddyb/following{/other_user}",
      "gists_url": "https://api.github.com/users/eddyb/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/eddyb/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/eddyb/subscriptions",
      "organizations_url": "https://api.github.com/users/eddyb/orgs",
      "repos_url": "https://api.github.com/users/eddyb/repos",
      "events_url": "https://api.github.com/users/eddyb/events{/privacy}",
      "received_events_url": "https://api.github.com/users/eddyb/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2017-05-07T14:41:00Z",
    "updated_at": "2017-05-07T14:41:00Z",
    "body": "cc @rust-lang/lang",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/299710653/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/299953993",
    "html_url": "https://github.com/rust-lang/rust/issues/21906#issuecomment-299953993",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/21906",
    "id": 299953993,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI5OTk1Mzk5Mw==",
    "user": {
      "login": "nikomatsakis",
      "id": 155238,
      "node_id": "MDQ6VXNlcjE1NTIzOA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/155238?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nikomatsakis",
      "html_url": "https://github.com/nikomatsakis",
      "followers_url": "https://api.github.com/users/nikomatsakis/followers",
      "following_url": "https://api.github.com/users/nikomatsakis/following{/other_user}",
      "gists_url": "https://api.github.com/users/nikomatsakis/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nikomatsakis/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nikomatsakis/subscriptions",
      "organizations_url": "https://api.github.com/users/nikomatsakis/orgs",
      "repos_url": "https://api.github.com/users/nikomatsakis/repos",
      "events_url": "https://api.github.com/users/nikomatsakis/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nikomatsakis/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2017-05-08T18:40:23Z",
    "updated_at": "2017-05-08T18:40:23Z",
    "body": "This is indeed NLL and, if I'm not mistaken, it would be fixed by the various proposals that I have made. This roughly corresponds to \"problem case \\#3\" from [my first blog post](http://smallcultfollowing.com/babysteps/blog/2016/04/27/non-lexical-lifetimes-introduction/). The basic idea (in terms of [the formulation from the latest blog post](http://smallcultfollowing.com/babysteps/blog/2017/02/21/non-lexical-lifetimes-using-liveness-and-location/)) of why it would work is that the subtyping the borrow would only be required to extend until the end of `'a` in the branch of the `if` that causes a `return`.",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/299953993/reactions",
      "total_count": 2,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 2,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/302152464",
    "html_url": "https://github.com/rust-lang/rust/issues/21906#issuecomment-302152464",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/21906",
    "id": 302152464,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMwMjE1MjQ2NA==",
    "user": {
      "login": "krdln",
      "id": 3074996,
      "node_id": "MDQ6VXNlcjMwNzQ5OTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3074996?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/krdln",
      "html_url": "https://github.com/krdln",
      "followers_url": "https://api.github.com/users/krdln/followers",
      "following_url": "https://api.github.com/users/krdln/following{/other_user}",
      "gists_url": "https://api.github.com/users/krdln/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/krdln/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/krdln/subscriptions",
      "organizations_url": "https://api.github.com/users/krdln/orgs",
      "repos_url": "https://api.github.com/users/krdln/repos",
      "events_url": "https://api.github.com/users/krdln/events{/privacy}",
      "received_events_url": "https://api.github.com/users/krdln/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2017-05-17T16:54:12Z",
    "updated_at": "2017-05-17T16:54:12Z",
    "body": "@nikomatsakis Could you please elaborate more on how NLL interacts with this issue? In my mental model of `&mut` references, they can be passed either by *move* or *reborrow*, and the problem in this issue is that the return requires the *move* mode, and the re-use of `self` afterwards requires *reborrow*. In my understanding, the new *reborrowed* `&mut` reference's lifetime is limited by the lifetime of the variable holding the `&mut`-reference \u2013 in this case, `self` variable, thus it's limited by the function's body, thus it cannot extend outside the function call. Are the NLL going to change that limitation of reborrows (or maybe there is no such limitation)?\r\n\r\nAlso I am wondering if fixing this issue is something inherently tied to NLL or is it maybe orthogonal? If it's the latter, maybe it's worth landing a fix before NLL?\r\n\r\nAlso, if NLL are going to fix this issue, does that mean that under NLL you'll never have to manually choose between a move and reborrow?",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/302152464/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/303258612",
    "html_url": "https://github.com/rust-lang/rust/issues/21906#issuecomment-303258612",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/21906",
    "id": 303258612,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMwMzI1ODYxMg==",
    "user": {
      "login": "nikomatsakis",
      "id": 155238,
      "node_id": "MDQ6VXNlcjE1NTIzOA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/155238?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nikomatsakis",
      "html_url": "https://github.com/nikomatsakis",
      "followers_url": "https://api.github.com/users/nikomatsakis/followers",
      "following_url": "https://api.github.com/users/nikomatsakis/following{/other_user}",
      "gists_url": "https://api.github.com/users/nikomatsakis/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nikomatsakis/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nikomatsakis/subscriptions",
      "organizations_url": "https://api.github.com/users/nikomatsakis/orgs",
      "repos_url": "https://api.github.com/users/nikomatsakis/repos",
      "events_url": "https://api.github.com/users/nikomatsakis/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nikomatsakis/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2017-05-23T00:46:38Z",
    "updated_at": "2017-05-23T00:46:38Z",
    "body": "@krdln \r\n\r\n> Could you please elaborate more on how NLL interacts with this issue?\r\n\r\nThe summary is that, today, if a value gets returned out of the function on **any** path, the loan must be valid for the rest of the function on **all** paths. Under the NLL proposal I wrote up, that restriction is lifted.\r\n\r\nIn more detail, if you take the elaborated signature here, you can see that we must return a reference with lifetime `'a`:\r\n\r\n```rust\r\nfn two<'a>(&'a mut self) -> &'a i32 { .. }\r\n```\r\n\r\nnow observe that we call `let k = self.one()` and then return this `k`. This means that the type of `k` must be `&'a i32`. This in turn means that when we call `self.one()`, we must supply it a borrow of `self` with type `&'a mut Self`. Therefore, at the `let k = self.one()` we issue a loan of `self` with lifetime `'a`. This lifetime is bigger than the loop (and, indeed, the entire function), so it persists as we go around the loop, leading to the error report. Under the NLL rules that I proposed, the lifetime of `k` is only required to extend to `'a` if the `if` is taken. Therefore, if the `if` is not taken, the loan can end earlier.\r\n\r\nDoes that help?\r\n\r\n----\r\n\r\n@osa1 \r\n\r\n> Is this going to be fixed any time soon?\r\n\r\nThere are still a few steps to go before we can do this, but there is active work on doing the refactorings needed.",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/303258612/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/303366585",
    "html_url": "https://github.com/rust-lang/rust/issues/21906#issuecomment-303366585",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/21906",
    "id": 303366585,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMwMzM2NjU4NQ==",
    "user": {
      "login": "krdln",
      "id": 3074996,
      "node_id": "MDQ6VXNlcjMwNzQ5OTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3074996?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/krdln",
      "html_url": "https://github.com/krdln",
      "followers_url": "https://api.github.com/users/krdln/followers",
      "following_url": "https://api.github.com/users/krdln/following{/other_user}",
      "gists_url": "https://api.github.com/users/krdln/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/krdln/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/krdln/subscriptions",
      "organizations_url": "https://api.github.com/users/krdln/orgs",
      "repos_url": "https://api.github.com/users/krdln/repos",
      "events_url": "https://api.github.com/users/krdln/events{/privacy}",
      "received_events_url": "https://api.github.com/users/krdln/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2017-05-23T11:13:03Z",
    "updated_at": "2017-05-23T11:13:03Z",
    "body": "@nikomatsakis \r\nThanks, it helped somewhat. But there's one little thing that I don't understand \u2013 what exactly happens when you write `self` in your code \u2013 how the reborrow of `self` works. I've read your exaplanation of the \"Problem case 3\" (`get_default`), where you inline the code inside the caller, but there, you've changed every use of `self` into borrowing the `map` variable directly, so that desugaring didn't clear it up for me.\r\n\r\nHere's where I'm stuck: When we call `let k = self.one()`, the `self` can't be moved (because it's needed later), so it's consider borrowed. Later, we conditionally return that `k`, so that borrow has to have a lifetime `'a`, which outlives the function call. But! We've borrowed from `self`, which lives only till the end of the function. That limitation seems to shorten `'a`, so in my mental model, even under NLL, we should get \"does not live long enough\" error.",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/303366585/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/304043028",
    "html_url": "https://github.com/rust-lang/rust/issues/21906#issuecomment-304043028",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/21906",
    "id": 304043028,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMwNDA0MzAyOA==",
    "user": {
      "login": "nikomatsakis",
      "id": 155238,
      "node_id": "MDQ6VXNlcjE1NTIzOA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/155238?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nikomatsakis",
      "html_url": "https://github.com/nikomatsakis",
      "followers_url": "https://api.github.com/users/nikomatsakis/followers",
      "following_url": "https://api.github.com/users/nikomatsakis/following{/other_user}",
      "gists_url": "https://api.github.com/users/nikomatsakis/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nikomatsakis/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nikomatsakis/subscriptions",
      "organizations_url": "https://api.github.com/users/nikomatsakis/orgs",
      "repos_url": "https://api.github.com/users/nikomatsakis/repos",
      "events_url": "https://api.github.com/users/nikomatsakis/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nikomatsakis/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2017-05-25T15:40:22Z",
    "updated_at": "2017-05-25T15:40:22Z",
    "body": "@krdln we've actually borrowed from `*self` -- that is, we've reborrowed what self refers to. We permit you to borrow `*self` for a lifetime outliving `self` itself because the type of `self` implies a 'lock' for the entire lifetime `'a`. Hence, as long as we can guarantee that during `'a`, self is no longer used, the result should be an exclusive reference -- in this case, after the fn returns, self has been popped, and hence it could not be used, so just guaranteeing that self is not used until the end of the fn suffices. (At least I hope that's true. =)",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/304043028/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/389400841",
    "html_url": "https://github.com/rust-lang/rust/issues/21906#issuecomment-389400841",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/21906",
    "id": 389400841,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM4OTQwMDg0MQ==",
    "user": {
      "login": "starwed",
      "id": 34907,
      "node_id": "MDQ6VXNlcjM0OTA3",
      "avatar_url": "https://avatars.githubusercontent.com/u/34907?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/starwed",
      "html_url": "https://github.com/starwed",
      "followers_url": "https://api.github.com/users/starwed/followers",
      "following_url": "https://api.github.com/users/starwed/following{/other_user}",
      "gists_url": "https://api.github.com/users/starwed/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/starwed/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/starwed/subscriptions",
      "organizations_url": "https://api.github.com/users/starwed/orgs",
      "repos_url": "https://api.github.com/users/starwed/repos",
      "events_url": "https://api.github.com/users/starwed/events{/privacy}",
      "received_events_url": "https://api.github.com/users/starwed/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2018-05-16T05:41:08Z",
    "updated_at": "2018-05-16T05:41:08Z",
    "body": ">This is blocked on non-lexical lifetimes, which is in turn blocked on MIR. Ideally this will be fixed by the end of 2016, but a fix won't land soon.\r\n\r\nNot very surprising, but I confirmed that the initial example does indeed [compile on nightly](https://play.rust-lang.org/?gist=2029a9e63f6bde4a1f8bd71b3403cfab&version=nightly&mode=debug) if you turn the non-lexical lifetimes feature on.",
    "author_association": "NONE",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/389400841/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/396003512",
    "html_url": "https://github.com/rust-lang/rust/issues/21906#issuecomment-396003512",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/21906",
    "id": 396003512,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM5NjAwMzUxMg==",
    "user": {
      "login": "SkylerLipthay",
      "id": 38674,
      "node_id": "MDQ6VXNlcjM4Njc0",
      "avatar_url": "https://avatars.githubusercontent.com/u/38674?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/SkylerLipthay",
      "html_url": "https://github.com/SkylerLipthay",
      "followers_url": "https://api.github.com/users/SkylerLipthay/followers",
      "following_url": "https://api.github.com/users/SkylerLipthay/following{/other_user}",
      "gists_url": "https://api.github.com/users/SkylerLipthay/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/SkylerLipthay/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/SkylerLipthay/subscriptions",
      "organizations_url": "https://api.github.com/users/SkylerLipthay/orgs",
      "repos_url": "https://api.github.com/users/SkylerLipthay/repos",
      "events_url": "https://api.github.com/users/SkylerLipthay/events{/privacy}",
      "received_events_url": "https://api.github.com/users/SkylerLipthay/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2018-06-09T22:33:51Z",
    "updated_at": "2018-06-09T22:33:51Z",
    "body": "I think I ran into a similar problem in production where an [immutable borrow seems to live too long](https://play.rust-lang.org/?gist=8311842c6c402cd11b4d2f8ba161ecea&version=stable&mode=debug) ([workaround](https://play.rust-lang.org/?gist=98db57d5e84b456f107f7b3522722ba5&version=stable&mode=debug)).\r\n\r\nI should also mention that [starwed's code](https://play.rust-lang.org/?gist=2029a9e63f6bde4a1f8bd71b3403cfab&version=nightly&mode=debug) no longer compiles on the latest nightly. @oberien suggested a \"`regression-from-nightly-to-nightly`\" tag, and it was also suggested I should tag @nikomatsakis in case this was an urgent problem :)",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/396003512/reactions",
      "total_count": 3,
      "+1": 3,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/460963210",
    "html_url": "https://github.com/rust-lang/rust/issues/21906#issuecomment-460963210",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/21906",
    "id": 460963210,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ2MDk2MzIxMA==",
    "user": {
      "login": "kurnevsky",
      "id": 2943605,
      "node_id": "MDQ6VXNlcjI5NDM2MDU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2943605?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/kurnevsky",
      "html_url": "https://github.com/kurnevsky",
      "followers_url": "https://api.github.com/users/kurnevsky/followers",
      "following_url": "https://api.github.com/users/kurnevsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/kurnevsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/kurnevsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kurnevsky/subscriptions",
      "organizations_url": "https://api.github.com/users/kurnevsky/orgs",
      "repos_url": "https://api.github.com/users/kurnevsky/repos",
      "events_url": "https://api.github.com/users/kurnevsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/kurnevsky/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2019-02-06T09:53:58Z",
    "updated_at": "2019-02-06T14:26:28Z",
    "body": "Stumbled upon this issue trying to do something very similar (which is not allowed by current nll):\r\n\r\n```rust\r\nfn f(vec: &mut Vec<u8>) -> &u8 {\r\n    if let Some(n) = vec.iter_mut().find(|n| **n == 1) {\r\n        *n = 10;\r\n        n\r\n    } else {\r\n        vec.push(10);\r\n        vec.last().unwrap()\r\n    }\r\n}\r\n\r\nfn main() {\r\n    let mut vec = vec![1, 2, 3];\r\n    f(&mut vec);\r\n}\r\n```\r\n\r\n```\r\nerror[E0499]: cannot borrow `*vec` as mutable more than once at a time\r\n --> src/main.rs:6:9\r\n  |\r\n1 | fn f(vec: &mut Vec<u8>) -> &u8 {\r\n  |           - let's call the lifetime of this reference `'1`\r\n2 |     if let Some(n) = vec.iter_mut().find(|n| **n == 1) {\r\n  |                      --- first mutable borrow occurs here\r\n3 |         *n = 10;\r\n4 |         n\r\n  |         - returning this value requires that `*vec` is borrowed for `'1`\r\n5 |     } else {\r\n6 |         vec.push(10);\r\n  |         ^^^ second mutable borrow occurs here\r\n\r\nerror[E0502]: cannot borrow `*vec` as immutable because it is also borrowed as mutable\r\n --> src/main.rs:7:9\r\n  |\r\n1 | fn f(vec: &mut Vec<u8>) -> &u8 {\r\n  |           - let's call the lifetime of this reference `'1`\r\n2 |     if let Some(n) = vec.iter_mut().find(|n| **n == 1) {\r\n  |                      --- mutable borrow occurs here\r\n3 |         *n = 10;\r\n4 |         n\r\n  |         - returning this value requires that `*vec` is borrowed for `'1`\r\n...\r\n7 |         vec.last().unwrap()\r\n  |         ^^^ immutable borrow occurs here\r\n```",
    "author_association": "NONE",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/460963210/reactions",
      "total_count": 3,
      "+1": 3,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/506397399",
    "html_url": "https://github.com/rust-lang/rust/issues/21906#issuecomment-506397399",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/21906",
    "id": 506397399,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUwNjM5NzM5OQ==",
    "user": {
      "login": "pnkfelix",
      "id": 173127,
      "node_id": "MDQ6VXNlcjE3MzEyNw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/173127?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/pnkfelix",
      "html_url": "https://github.com/pnkfelix",
      "followers_url": "https://api.github.com/users/pnkfelix/followers",
      "following_url": "https://api.github.com/users/pnkfelix/following{/other_user}",
      "gists_url": "https://api.github.com/users/pnkfelix/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/pnkfelix/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/pnkfelix/subscriptions",
      "organizations_url": "https://api.github.com/users/pnkfelix/orgs",
      "repos_url": "https://api.github.com/users/pnkfelix/repos",
      "events_url": "https://api.github.com/users/pnkfelix/events{/privacy}",
      "received_events_url": "https://api.github.com/users/pnkfelix/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2019-06-27T15:35:42Z",
    "updated_at": "2019-06-27T15:35:42Z",
    "body": "(we should have removed E-needstest when we removed NLL-fixed-by-NLL)",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/506397399/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/776779199",
    "html_url": "https://github.com/rust-lang/rust/issues/21906#issuecomment-776779199",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/21906",
    "id": 776779199,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc3Njc3OTE5OQ==",
    "user": {
      "login": "camsteffen",
      "id": 5565418,
      "node_id": "MDQ6VXNlcjU1NjU0MTg=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5565418?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/camsteffen",
      "html_url": "https://github.com/camsteffen",
      "followers_url": "https://api.github.com/users/camsteffen/followers",
      "following_url": "https://api.github.com/users/camsteffen/following{/other_user}",
      "gists_url": "https://api.github.com/users/camsteffen/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/camsteffen/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/camsteffen/subscriptions",
      "organizations_url": "https://api.github.com/users/camsteffen/orgs",
      "repos_url": "https://api.github.com/users/camsteffen/repos",
      "events_url": "https://api.github.com/users/camsteffen/events{/privacy}",
      "received_events_url": "https://api.github.com/users/camsteffen/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2021-02-10T15:18:30Z",
    "updated_at": "2021-02-10T15:18:30Z",
    "body": "I just ran into this and it really confused me for a while. I think a tip along the lines of \"try changing the first borrow to an immutable borrow\" would have helped me find a solution faster, at least in my case. Even though in retrospect that seems obvious...\r\n\r\n<details>\r\n<summary>Example</summary>\r\n\r\n```rust\r\nfn last_big(vec: &mut Vec<i32>) -> &mut i32 {\r\n    match **vec {\r\n        [.., ref mut last] if *last > 99 => last,\r\n        _ => {\r\n            vec.push(100); // ERROR: can't borrow mutably again\r\n            vec.last_mut().unwrap()\r\n        }\r\n    }\r\n}\r\n```\r\n</summary>",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/776779199/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/1761712562",
    "html_url": "https://github.com/rust-lang/rust/issues/21906#issuecomment-1761712562",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/21906",
    "id": 1761712562,
    "node_id": "IC_kwDOAAsO6M5pAZmy",
    "user": {
      "login": "tamird",
      "id": 1535036,
      "node_id": "MDQ6VXNlcjE1MzUwMzY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1535036?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/tamird",
      "html_url": "https://github.com/tamird",
      "followers_url": "https://api.github.com/users/tamird/followers",
      "following_url": "https://api.github.com/users/tamird/following{/other_user}",
      "gists_url": "https://api.github.com/users/tamird/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/tamird/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/tamird/subscriptions",
      "organizations_url": "https://api.github.com/users/tamird/orgs",
      "repos_url": "https://api.github.com/users/tamird/repos",
      "events_url": "https://api.github.com/users/tamird/events{/privacy}",
      "received_events_url": "https://api.github.com/users/tamird/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2023-10-13T15:32:32Z",
    "updated_at": "2023-10-13T15:32:32Z",
    "body": "This bug has a lot of duplicates, and is [problem case #3 in the NLL RFC](https://rust-lang.github.io/rfcs/2094-nll.html#problem-case-3-conditional-control-flow-across-functions). Should we close some of these duplicates?\r\n\r\n#51545\r\n#54663\r\n#58910\r\n#70255\r\n#97901\r\n#112087\r\n\r\nThis was intentionally cut from NLL, which @shepmaster described in https://github.com/rust-lang/rust/issues/51545#issuecomment-397773063.\r\n\r\nShould some of these duplicates be closed so that there's on canonical bug with all the relevant breadcrumbs (and perhaps an update on polonius :crossed_fingers:)? cc @nikomatsakis.",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/1761712562/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/1960865178",
    "html_url": "https://github.com/rust-lang/rust/issues/21906#issuecomment-1960865178",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/21906",
    "id": 1960865178,
    "node_id": "IC_kwDOAAsO6M504G2a",
    "user": {
      "login": "JakkuSakura",
      "id": 33482468,
      "node_id": "MDQ6VXNlcjMzNDgyNDY4",
      "avatar_url": "https://avatars.githubusercontent.com/u/33482468?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/JakkuSakura",
      "html_url": "https://github.com/JakkuSakura",
      "followers_url": "https://api.github.com/users/JakkuSakura/followers",
      "following_url": "https://api.github.com/users/JakkuSakura/following{/other_user}",
      "gists_url": "https://api.github.com/users/JakkuSakura/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/JakkuSakura/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/JakkuSakura/subscriptions",
      "organizations_url": "https://api.github.com/users/JakkuSakura/orgs",
      "repos_url": "https://api.github.com/users/JakkuSakura/repos",
      "events_url": "https://api.github.com/users/JakkuSakura/events{/privacy}",
      "received_events_url": "https://api.github.com/users/JakkuSakura/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2024-02-23T07:45:27Z",
    "updated_at": "2024-02-23T07:45:27Z",
    "body": "> > This is blocked on non-lexical lifetimes, which is in turn blocked on MIR. Ideally this will be fixed by the end of 2016, but a fix won't land soon.\r\n> \r\n> Not very surprising, but I confirmed that the initial example does indeed [compile on nightly](https://play.rust-lang.org/?gist=2029a9e63f6bde4a1f8bd71b3403cfab&version=nightly&mode=debug) if you turn the non-lexical lifetimes feature on.\r\n\r\nSadly, latest nightly doesn't compile it.\r\n\r\nI wrote an Entry API for Vec instead",
    "author_association": "NONE",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/1960865178/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
