[
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/84417854",
    "html_url": "https://github.com/rust-lang/rust/issues/22638#issuecomment-84417854",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/22638",
    "id": 84417854,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg0NDE3ODU0",
    "user": {
      "login": "ebfull",
      "id": 3794471,
      "node_id": "MDQ6VXNlcjM3OTQ0NzE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3794471?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ebfull",
      "html_url": "https://github.com/ebfull",
      "followers_url": "https://api.github.com/users/ebfull/followers",
      "following_url": "https://api.github.com/users/ebfull/following{/other_user}",
      "gists_url": "https://api.github.com/users/ebfull/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ebfull/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ebfull/subscriptions",
      "organizations_url": "https://api.github.com/users/ebfull/orgs",
      "repos_url": "https://api.github.com/users/ebfull/repos",
      "events_url": "https://api.github.com/users/ebfull/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ebfull/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-03-21T18:45:33Z",
    "updated_at": "2015-03-23T09:32:07Z",
    "body": "I'm getting a similar stack overflow with closures. (I think this shouldn't be able to monomorphize?)\n\n``` rust\nextern crate threadpool;\n\nuse std::sync::{Arc,Mutex};\nuse threadpool::ScopedPool;\n\nfn test<'pool, F: FnMut(usize) + Send + Sync + 'pool>(mut callback: F, depth: usize, pool: Arc<Mutex<ScopedPool<'pool>>>) {\n    if depth == 0 {\n        callback(100);\n    } else {\n        struct Foo<F: FnMut(usize)> {\n            callback: F\n        }\n\n        let foo = Arc::new(Mutex::new(Foo{callback: move |u| {\n            callback(u);\n        }}));\n\n        for _ in 0..50 {\n            struct Bar<F: FnMut(usize)> {\n                callback: F\n            }\n\n            let foo = foo.clone();\n\n            let bar = Arc::new(Mutex::new(Bar {\n                callback: move |u| {\n                    let foo = &mut *foo.lock().unwrap();\n\n                    (foo.callback)(u);\n                }\n            }));\n\n            for _ in 0..5 {\n                let descending_pool = pool.clone();\n                let pool = pool.lock().unwrap();\n                let bar = bar.clone();\n                pool.execute(move || {\n                    test(move |n| {\n                        let bar = &mut *bar.lock().unwrap();\n\n                        (bar.callback)(n);\n                    }, depth - 1, descending_pool);\n                });\n            }\n        }\n    }\n}\n\nfn main() {\n    let pool = Arc::new(Mutex::new(ScopedPool::new(4)));\n\n    test(|num| {\n        println!(\"woohoo {}\", num);\n    }, 1, pool);\n}\n```\n\n```\nthread 'rustc' has overflowed its stack\n```\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/84417854/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/91988254",
    "html_url": "https://github.com/rust-lang/rust/issues/22638#issuecomment-91988254",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/22638",
    "id": 91988254,
    "node_id": "MDEyOklzc3VlQ29tbWVudDkxOTg4MjU0",
    "user": {
      "login": "VladimirZhilyakov",
      "id": 749014,
      "node_id": "MDQ6VXNlcjc0OTAxNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/749014?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/VladimirZhilyakov",
      "html_url": "https://github.com/VladimirZhilyakov",
      "followers_url": "https://api.github.com/users/VladimirZhilyakov/followers",
      "following_url": "https://api.github.com/users/VladimirZhilyakov/following{/other_user}",
      "gists_url": "https://api.github.com/users/VladimirZhilyakov/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/VladimirZhilyakov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/VladimirZhilyakov/subscriptions",
      "organizations_url": "https://api.github.com/users/VladimirZhilyakov/orgs",
      "repos_url": "https://api.github.com/users/VladimirZhilyakov/repos",
      "events_url": "https://api.github.com/users/VladimirZhilyakov/events{/privacy}",
      "received_events_url": "https://api.github.com/users/VladimirZhilyakov/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-04-12T04:38:13Z",
    "updated_at": "2015-04-12T04:38:13Z",
    "body": "This code doesn't compile too.\n\n```\nstruct Button<T: FnMut()> {\n    f: Option<T>,\n    title: &'static str,\n}\n\nimpl<T: FnMut()> Button<T> {\n    fn new() -> Button<T>\n    { Button { f: None, title: \"ClickMe\" } }\n\n    fn set(&mut self, f: T)\n    { self.f = Some(f); }\n\n    fn title(&mut self, title: &'static str)\n    { self.title = title; }\n\n    fn click(&mut self) {\n        match self.f {\n            Some(ref mut f) => f(),\n            None => ()\n        }\n    }\n}\n\nfn main() {\n    let mut btn = Button::new();\n    btn.set(|| btn.title(\"Done\"));\n    btn.click();\n    btn.click();\n}\n```\n",
    "author_association": "NONE",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/91988254/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/96102434",
    "html_url": "https://github.com/rust-lang/rust/issues/22638#issuecomment-96102434",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/22638",
    "id": 96102434,
    "node_id": "MDEyOklzc3VlQ29tbWVudDk2MTAyNDM0",
    "user": {
      "login": "frewsxcv",
      "id": 416575,
      "node_id": "MDQ6VXNlcjQxNjU3NQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/416575?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/frewsxcv",
      "html_url": "https://github.com/frewsxcv",
      "followers_url": "https://api.github.com/users/frewsxcv/followers",
      "following_url": "https://api.github.com/users/frewsxcv/following{/other_user}",
      "gists_url": "https://api.github.com/users/frewsxcv/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/frewsxcv/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/frewsxcv/subscriptions",
      "organizations_url": "https://api.github.com/users/frewsxcv/orgs",
      "repos_url": "https://api.github.com/users/frewsxcv/repos",
      "events_url": "https://api.github.com/users/frewsxcv/events{/privacy}",
      "received_events_url": "https://api.github.com/users/frewsxcv/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-04-24T23:44:17Z",
    "updated_at": "2015-04-24T23:44:17Z",
    "body": "Status update: my code no longer has an ICE, but instead has:\n\n```\n<anon>:5:5: 8:6 error: reached the recursion limit during monomorphization\n<anon>:5     pub fn matches<F: Fn()>(&self, f: &F) {\n<anon>:6         let &A(ref term) = self;\n<anon>:7         term.matches(f);\n<anon>:8     }\nplaypen: application terminated with error code 101\n```\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/96102434/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/96309466",
    "html_url": "https://github.com/rust-lang/rust/issues/22638#issuecomment-96309466",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/22638",
    "id": 96309466,
    "node_id": "MDEyOklzc3VlQ29tbWVudDk2MzA5NDY2",
    "user": {
      "login": "ebfull",
      "id": 3794471,
      "node_id": "MDQ6VXNlcjM3OTQ0NzE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3794471?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ebfull",
      "html_url": "https://github.com/ebfull",
      "followers_url": "https://api.github.com/users/ebfull/followers",
      "following_url": "https://api.github.com/users/ebfull/following{/other_user}",
      "gists_url": "https://api.github.com/users/ebfull/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ebfull/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ebfull/subscriptions",
      "organizations_url": "https://api.github.com/users/ebfull/orgs",
      "repos_url": "https://api.github.com/users/ebfull/repos",
      "events_url": "https://api.github.com/users/ebfull/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ebfull/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-04-26T02:15:47Z",
    "updated_at": "2015-04-26T02:15:47Z",
    "body": "@frewsxcv That's good. Most of these code snippets should result in that sort of error. The type inference is hiding a recursive type definition which will necessarily arise during monomorphization. These are impossible to express statically.\n\nBy the way, here's a reduced example of the stack overflow:\n\n``` rust\nfn main() {\n    let mut test = None;\n    test = Some(|| test.unwrap());\n}\n```\n\nI think because it's otherwise impossible to express recursive type definitions in code, a lot of different areas of the compiler assume this will not happen. But with closures it can right now; we should probably check for that somewhere.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/96309466/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/136639861",
    "html_url": "https://github.com/rust-lang/rust/issues/22638#issuecomment-136639861",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/22638",
    "id": 136639861,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEzNjYzOTg2MQ==",
    "user": {
      "login": "pmarcelll",
      "id": 1909968,
      "node_id": "MDQ6VXNlcjE5MDk5Njg=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1909968?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/pmarcelll",
      "html_url": "https://github.com/pmarcelll",
      "followers_url": "https://api.github.com/users/pmarcelll/followers",
      "following_url": "https://api.github.com/users/pmarcelll/following{/other_user}",
      "gists_url": "https://api.github.com/users/pmarcelll/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/pmarcelll/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/pmarcelll/subscriptions",
      "organizations_url": "https://api.github.com/users/pmarcelll/orgs",
      "repos_url": "https://api.github.com/users/pmarcelll/repos",
      "events_url": "https://api.github.com/users/pmarcelll/events{/privacy}",
      "received_events_url": "https://api.github.com/users/pmarcelll/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-09-01T08:55:51Z",
    "updated_at": "2015-09-01T08:55:51Z",
    "body": "This seems to be fixed in nightly.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/136639861/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
