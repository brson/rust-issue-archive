[
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/140044476",
    "html_url": "https://github.com/rust-lang/rust/issues/28398#issuecomment-140044476",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28398",
    "id": 140044476,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE0MDA0NDQ3Ng==",
    "user": {
      "login": "arielb1",
      "id": 1830974,
      "node_id": "MDQ6VXNlcjE4MzA5NzQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1830974?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/arielb1",
      "html_url": "https://github.com/arielb1",
      "followers_url": "https://api.github.com/users/arielb1/followers",
      "following_url": "https://api.github.com/users/arielb1/following{/other_user}",
      "gists_url": "https://api.github.com/users/arielb1/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/arielb1/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/arielb1/subscriptions",
      "organizations_url": "https://api.github.com/users/arielb1/orgs",
      "repos_url": "https://api.github.com/users/arielb1/repos",
      "events_url": "https://api.github.com/users/arielb1/events{/privacy}",
      "received_events_url": "https://api.github.com/users/arielb1/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-09-14T11:26:29Z",
    "updated_at": "2015-09-14T11:26:29Z",
    "body": "We probably need some heuristic here - if the data is truly big, we should memcpy it completely rather than skipping fragments. Maybe we should find a partialmemcpy intrinsic in LLVM?\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/140044476/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/140049983",
    "html_url": "https://github.com/rust-lang/rust/issues/28398#issuecomment-140049983",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28398",
    "id": 140049983,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE0MDA0OTk4Mw==",
    "user": {
      "login": "huonw",
      "id": 1203825,
      "node_id": "MDQ6VXNlcjEyMDM4MjU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1203825?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/huonw",
      "html_url": "https://github.com/huonw",
      "followers_url": "https://api.github.com/users/huonw/followers",
      "following_url": "https://api.github.com/users/huonw/following{/other_user}",
      "gists_url": "https://api.github.com/users/huonw/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/huonw/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/huonw/subscriptions",
      "organizations_url": "https://api.github.com/users/huonw/orgs",
      "repos_url": "https://api.github.com/users/huonw/repos",
      "events_url": "https://api.github.com/users/huonw/events{/privacy}",
      "received_events_url": "https://api.github.com/users/huonw/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-09-14T12:05:57Z",
    "updated_at": "2015-09-14T12:05:57Z",
    "body": "Could you clarify what you mean? The IR in the issue has a single memcpy with no skipped fragments.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/140049983/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/140167539",
    "html_url": "https://github.com/rust-lang/rust/issues/28398#issuecomment-140167539",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28398",
    "id": 140167539,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE0MDE2NzUzOQ==",
    "user": {
      "login": "arielb1",
      "id": 1830974,
      "node_id": "MDQ6VXNlcjE4MzA5NzQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1830974?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/arielb1",
      "html_url": "https://github.com/arielb1",
      "followers_url": "https://api.github.com/users/arielb1/followers",
      "following_url": "https://api.github.com/users/arielb1/following{/other_user}",
      "gists_url": "https://api.github.com/users/arielb1/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/arielb1/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/arielb1/subscriptions",
      "organizations_url": "https://api.github.com/users/arielb1/orgs",
      "repos_url": "https://api.github.com/users/arielb1/repos",
      "events_url": "https://api.github.com/users/arielb1/events{/privacy}",
      "received_events_url": "https://api.github.com/users/arielb1/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-09-14T18:29:15Z",
    "updated_at": "2015-09-14T18:30:15Z",
    "body": "@huonw \n\nIn the example, we want to do\n\n``` C\n    char *buf = e;\n    buf[0]  = 0;\n    *(uint32_t*)(buf+4) = 32;\n```\n\nThis sets bytes 0, 4, 5, 6, and 7.\n\nIf, instead, we had\n\n``` Rust\npub fn slow_2(e: &mut (MyEnum, u32)) {\n    *e = (MyEnum::A(32), 42);\n}\n```\n\nwe would want to set bytes 0, 4, 5, 6, 7, 65540, 65541, 65542, and 65543. In LLVM terms, we set the other bytes to undefs (this makes LLVM leave them as they were before). It would be nice if we could tell LLVM that and have it find the best lowering strategy.\n\nMaybe just skipping large holes in rustc would be enough, however.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/140167539/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/140270148",
    "html_url": "https://github.com/rust-lang/rust/issues/28398#issuecomment-140270148",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28398",
    "id": 140270148,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE0MDI3MDE0OA==",
    "user": {
      "login": "huonw",
      "id": 1203825,
      "node_id": "MDQ6VXNlcjEyMDM4MjU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1203825?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/huonw",
      "html_url": "https://github.com/huonw",
      "followers_url": "https://api.github.com/users/huonw/followers",
      "following_url": "https://api.github.com/users/huonw/following{/other_user}",
      "gists_url": "https://api.github.com/users/huonw/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/huonw/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/huonw/subscriptions",
      "organizations_url": "https://api.github.com/users/huonw/orgs",
      "repos_url": "https://api.github.com/users/huonw/repos",
      "events_url": "https://api.github.com/users/huonw/events{/privacy}",
      "received_events_url": "https://api.github.com/users/huonw/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-09-15T03:35:46Z",
    "updated_at": "2015-09-15T03:35:46Z",
    "body": "Ah, I think my confusion is because your initial comment inverted partial and complete?\n\nIn any case, note that the dynamic case _does_ what you are suggesting---just set specific fields---while the static case is explicitly creating a whole static instance and then assigning it to the local (i.e. doing a memcpy). Are you just saying that our assignments/loads in general should be more precise about what bytes they copy?\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/140270148/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/284235628",
    "html_url": "https://github.com/rust-lang/rust/issues/28398#issuecomment-284235628",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28398",
    "id": 284235628,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI4NDIzNTYyOA==",
    "user": {
      "login": "pmarcelll",
      "id": 1909968,
      "node_id": "MDQ6VXNlcjE5MDk5Njg=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1909968?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/pmarcelll",
      "html_url": "https://github.com/pmarcelll",
      "followers_url": "https://api.github.com/users/pmarcelll/followers",
      "following_url": "https://api.github.com/users/pmarcelll/following{/other_user}",
      "gists_url": "https://api.github.com/users/pmarcelll/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/pmarcelll/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/pmarcelll/subscriptions",
      "organizations_url": "https://api.github.com/users/pmarcelll/orgs",
      "repos_url": "https://api.github.com/users/pmarcelll/repos",
      "events_url": "https://api.github.com/users/pmarcelll/events{/privacy}",
      "received_events_url": "https://api.github.com/users/pmarcelll/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2017-03-05T15:32:04Z",
    "updated_at": "2017-03-05T15:32:04Z",
    "body": "Triage: this is the current output from the playground (stable, release mode):\r\n ```llvm\r\n; ModuleID = 'rust_out.cgu-0.rs'\r\nsource_filename = \"rust_out.cgu-0.rs\"\r\ntarget datalayout = \"e-m:e-i64:64-f80:128-n8:16:32:64-S128\"\r\ntarget triple = \"x86_64-unknown-linux-gnu\"\r\n\r\n%MyEnum = type { i8, [3 x i8], [16384 x i32] }\r\n\r\n; Function Attrs: norecurse nounwind uwtable\r\ndefine void @_ZN8rust_out4slow17h69b71af2db2df8c0E(%MyEnum* nocapture dereferenceable(65540)) unnamed_addr #0 {\r\nentry-block:\r\n  %1 = getelementptr inbounds %MyEnum, %MyEnum* %0, i64 0, i32 0\r\n  store i8 0, i8* %1, align 1\r\n  %2 = getelementptr inbounds %MyEnum, %MyEnum* %0, i64 0, i32 2, i64 0\r\n  store i32 32, i32* %2, align 4\r\n  ret void\r\n}\r\n\r\n; Function Attrs: norecurse nounwind uwtable\r\ndefine void @_ZN8rust_out4fast17hd831faf6e2383adeE(%MyEnum* nocapture dereferenceable(65540), i32) unnamed_addr #0 {\r\nentry-block:\r\n  %2 = getelementptr inbounds %MyEnum, %MyEnum* %0, i64 0, i32 0\r\n  store i8 0, i8* %2, align 1\r\n  %3 = getelementptr inbounds %MyEnum, %MyEnum* %0, i64 0, i32 2, i64 0\r\n  store i32 %1, i32* %3, align 4\r\n  ret void\r\n}\r\n\r\nattributes #0 = { norecurse nounwind uwtable }\r\n```\r\n\r\nThe memcopy disappeared.",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/284235628/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/304409083",
    "html_url": "https://github.com/rust-lang/rust/issues/28398#issuecomment-304409083",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/28398",
    "id": 304409083,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMwNDQwOTA4Mw==",
    "user": {
      "login": "Mark-Simulacrum",
      "id": 5047365,
      "node_id": "MDQ6VXNlcjUwNDczNjU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5047365?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Mark-Simulacrum",
      "html_url": "https://github.com/Mark-Simulacrum",
      "followers_url": "https://api.github.com/users/Mark-Simulacrum/followers",
      "following_url": "https://api.github.com/users/Mark-Simulacrum/following{/other_user}",
      "gists_url": "https://api.github.com/users/Mark-Simulacrum/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Mark-Simulacrum/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Mark-Simulacrum/subscriptions",
      "organizations_url": "https://api.github.com/users/Mark-Simulacrum/orgs",
      "repos_url": "https://api.github.com/users/Mark-Simulacrum/repos",
      "events_url": "https://api.github.com/users/Mark-Simulacrum/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Mark-Simulacrum/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2017-05-26T23:37:33Z",
    "updated_at": "2017-05-26T23:37:33Z",
    "body": "I'm going to close as fixed since it seems this is now fixed -- the IR is identical for both slow and fast, and neither case has a memcpy. If that's incorrect, please provide a reproducible example.",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/304409083/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
