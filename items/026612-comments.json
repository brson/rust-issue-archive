[
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/115948903",
    "html_url": "https://github.com/rust-lang/rust/issues/26612#issuecomment-115948903",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/26612",
    "id": 115948903,
    "node_id": "MDEyOklzc3VlQ29tbWVudDExNTk0ODkwMw==",
    "user": {
      "login": "emberian",
      "id": 704250,
      "node_id": "MDQ6VXNlcjcwNDI1MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/704250?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/emberian",
      "html_url": "https://github.com/emberian",
      "followers_url": "https://api.github.com/users/emberian/followers",
      "following_url": "https://api.github.com/users/emberian/following{/other_user}",
      "gists_url": "https://api.github.com/users/emberian/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/emberian/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/emberian/subscriptions",
      "organizations_url": "https://api.github.com/users/emberian/orgs",
      "repos_url": "https://api.github.com/users/emberian/repos",
      "events_url": "https://api.github.com/users/emberian/events{/privacy}",
      "received_events_url": "https://api.github.com/users/emberian/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-06-27T03:15:57Z",
    "updated_at": "2015-06-27T03:15:57Z",
    "body": "We'll need to upgrade our compiler-rt as well. We will probably need to add an attribute to allow functions or maybe even crates to opt-out of this treatment, as things such as signal handlers and the lowest levels of a kernel or other bare-metal system will not want this (interrupt handlers and bootstrap, mainly).\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/115948903/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/115949496",
    "html_url": "https://github.com/rust-lang/rust/issues/26612#issuecomment-115949496",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/26612",
    "id": 115949496,
    "node_id": "MDEyOklzc3VlQ29tbWVudDExNTk0OTQ5Ng==",
    "user": {
      "login": "emberian",
      "id": 704250,
      "node_id": "MDQ6VXNlcjcwNDI1MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/704250?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/emberian",
      "html_url": "https://github.com/emberian",
      "followers_url": "https://api.github.com/users/emberian/followers",
      "following_url": "https://api.github.com/users/emberian/following{/other_user}",
      "gists_url": "https://api.github.com/users/emberian/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/emberian/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/emberian/subscriptions",
      "organizations_url": "https://api.github.com/users/emberian/orgs",
      "repos_url": "https://api.github.com/users/emberian/repos",
      "events_url": "https://api.github.com/users/emberian/events{/privacy}",
      "received_events_url": "https://api.github.com/users/emberian/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-06-27T03:17:17Z",
    "updated_at": "2015-06-27T03:17:17Z",
    "body": "It would also be interesting to look at what patterns we have that force use of the unsafe stack (if any) and how to avoid that.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/115949496/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/115991312",
    "html_url": "https://github.com/rust-lang/rust/issues/26612#issuecomment-115991312",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/26612",
    "id": 115991312,
    "node_id": "MDEyOklzc3VlQ29tbWVudDExNTk5MTMxMg==",
    "user": {
      "login": "Aatch",
      "id": 342416,
      "node_id": "MDQ6VXNlcjM0MjQxNg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/342416?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Aatch",
      "html_url": "https://github.com/Aatch",
      "followers_url": "https://api.github.com/users/Aatch/followers",
      "following_url": "https://api.github.com/users/Aatch/following{/other_user}",
      "gists_url": "https://api.github.com/users/Aatch/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Aatch/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Aatch/subscriptions",
      "organizations_url": "https://api.github.com/users/Aatch/orgs",
      "repos_url": "https://api.github.com/users/Aatch/repos",
      "events_url": "https://api.github.com/users/Aatch/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Aatch/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-06-27T09:14:23Z",
    "updated_at": "2015-06-27T09:14:23Z",
    "body": "@cmr looking at the [CPI paper](http://dslab.epfl.ch/pubs/cpi.pdf), any stack-allocated value that has its address taken. That's actually fairly common in Rust code, and avoiding it isn't really feasible. I'd be interested in seeing what performance effects it has on Rust code, as the patterns in Rust code are quite different to those in C/C++.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/115991312/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/115991580",
    "html_url": "https://github.com/rust-lang/rust/issues/26612#issuecomment-115991580",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/26612",
    "id": 115991580,
    "node_id": "MDEyOklzc3VlQ29tbWVudDExNTk5MTU4MA==",
    "user": {
      "login": "bstrie",
      "id": 865233,
      "node_id": "MDQ6VXNlcjg2NTIzMw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/865233?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/bstrie",
      "html_url": "https://github.com/bstrie",
      "followers_url": "https://api.github.com/users/bstrie/followers",
      "following_url": "https://api.github.com/users/bstrie/following{/other_user}",
      "gists_url": "https://api.github.com/users/bstrie/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/bstrie/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/bstrie/subscriptions",
      "organizations_url": "https://api.github.com/users/bstrie/orgs",
      "repos_url": "https://api.github.com/users/bstrie/repos",
      "events_url": "https://api.github.com/users/bstrie/events{/privacy}",
      "received_events_url": "https://api.github.com/users/bstrie/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-06-27T09:14:47Z",
    "updated_at": "2015-06-27T09:14:47Z",
    "body": "The SafeStack commit message says that the safe stack can contain \"local variables that are statically verified to be accessed in a safe way\". Are our notions of safety stronger than what LLVM considers to be \"safe\" here, meaning that basically all variables would be living in the safe stack?\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/115991580/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/116106553",
    "html_url": "https://github.com/rust-lang/rust/issues/26612#issuecomment-116106553",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/26612",
    "id": 116106553,
    "node_id": "MDEyOklzc3VlQ29tbWVudDExNjEwNjU1Mw==",
    "user": {
      "login": "lambda",
      "id": 37398,
      "node_id": "MDQ6VXNlcjM3Mzk4",
      "avatar_url": "https://avatars.githubusercontent.com/u/37398?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/lambda",
      "html_url": "https://github.com/lambda",
      "followers_url": "https://api.github.com/users/lambda/followers",
      "following_url": "https://api.github.com/users/lambda/following{/other_user}",
      "gists_url": "https://api.github.com/users/lambda/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/lambda/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/lambda/subscriptions",
      "organizations_url": "https://api.github.com/users/lambda/orgs",
      "repos_url": "https://api.github.com/users/lambda/repos",
      "events_url": "https://api.github.com/users/lambda/events{/privacy}",
      "received_events_url": "https://api.github.com/users/lambda/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-06-27T17:36:14Z",
    "updated_at": "2015-06-27T17:36:14Z",
    "body": "Posted this in the Reddit thread, but this might be a better place to leave it.\n\nIt looks like the way this determines 'safe' vs 'unsafe' is by looking at how a function uses a pointer returned by `alloca`.\n\n[The code that check this](https://github.com/llvm-mirror/llvm/commit/7ffec838a2b72e6841d9fb993b5fe6a45f3b2a90#diff-0882c05a6450ec2a878ae0a5f6f93b2aR63) looks like it basically whitelists a few safe operations, such as dereferencing the pointer directly, using a constant index into a constant sized array, and passing it in to arguments of functions annotated with `nocapture` (which seems like a somewhat dubious choice, as it seems like there's plenty unsafe that a function could do without capturing a pointer).\n\nIt doesn't look like there's any way to whitelist any potential uses, other than using `nocapture` for arguments to functions. Searching through the Rust source, it doesn't look like `nocatpure` is currently applied except in one specialized case; [in some of the tests, there is a TODO](https://github.com/rust-lang/rust/blob/306a99e66a4ca7bb1d1445275360b79c5b7b1815/src/test/codegen/function-arguments.rs#L29) indicating that it should probably be applied in more cases.\n\nSo, I'm guessing that the best thing that Rust could do to give it more information would be applying `nocapture` to appropriate arguments. However, when doing that, it seems like the guarantess are fairly best-effort, as there's no interprocedural analysis done, so a `nocapture` argument that eventually gets passed into unsafe code could probably wind up being exploited.\n\nNote that this was just a very cursory look that I took at the code, I could be wrong about how it works.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/116106553/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/116136963",
    "html_url": "https://github.com/rust-lang/rust/issues/26612#issuecomment-116136963",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/26612",
    "id": 116136963,
    "node_id": "MDEyOklzc3VlQ29tbWVudDExNjEzNjk2Mw==",
    "user": {
      "login": "emberian",
      "id": 704250,
      "node_id": "MDQ6VXNlcjcwNDI1MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/704250?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/emberian",
      "html_url": "https://github.com/emberian",
      "followers_url": "https://api.github.com/users/emberian/followers",
      "following_url": "https://api.github.com/users/emberian/following{/other_user}",
      "gists_url": "https://api.github.com/users/emberian/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/emberian/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/emberian/subscriptions",
      "organizations_url": "https://api.github.com/users/emberian/orgs",
      "repos_url": "https://api.github.com/users/emberian/repos",
      "events_url": "https://api.github.com/users/emberian/events{/privacy}",
      "received_events_url": "https://api.github.com/users/emberian/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-06-27T20:32:40Z",
    "updated_at": "2015-06-27T20:32:40Z",
    "body": "@lambda Yeah, it looks pretty conservative right now. I suspect many locals would end up on the unsafe stack. Alas.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/116136963/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/125339944",
    "html_url": "https://github.com/rust-lang/rust/issues/26612#issuecomment-125339944",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/26612",
    "id": 125339944,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEyNTMzOTk0NA==",
    "user": {
      "login": "alexcrichton",
      "id": 64996,
      "node_id": "MDQ6VXNlcjY0OTk2",
      "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alexcrichton",
      "html_url": "https://github.com/alexcrichton",
      "followers_url": "https://api.github.com/users/alexcrichton/followers",
      "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}",
      "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions",
      "organizations_url": "https://api.github.com/users/alexcrichton/orgs",
      "repos_url": "https://api.github.com/users/alexcrichton/repos",
      "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alexcrichton/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2015-07-27T20:55:22Z",
    "updated_at": "2015-07-27T20:55:22Z",
    "body": "We updated LLVM so there's support for this in our LLVM, and I think that turning this on by default probably wants some investigation and likely an RFC first, so I'm going to close this for now.\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/125339944/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
