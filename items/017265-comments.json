[
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/55685680",
    "html_url": "https://github.com/rust-lang/rust/pull/17265#issuecomment-55685680",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/17265",
    "id": 55685680,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU1Njg1Njgw",
    "user": {
      "login": "donkopotamus",
      "id": 4120456,
      "node_id": "MDQ6VXNlcjQxMjA0NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4120456?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/donkopotamus",
      "html_url": "https://github.com/donkopotamus",
      "followers_url": "https://api.github.com/users/donkopotamus/followers",
      "following_url": "https://api.github.com/users/donkopotamus/following{/other_user}",
      "gists_url": "https://api.github.com/users/donkopotamus/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/donkopotamus/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/donkopotamus/subscriptions",
      "organizations_url": "https://api.github.com/users/donkopotamus/orgs",
      "repos_url": "https://api.github.com/users/donkopotamus/repos",
      "events_url": "https://api.github.com/users/donkopotamus/events{/privacy}",
      "received_events_url": "https://api.github.com/users/donkopotamus/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-09-16T02:02:45Z",
    "updated_at": "2014-09-16T02:02:45Z",
    "body": "Some possibly relevant information about the current usage of `errno`.\n- errno spends a lot of its time either being casted, or being compared to other casted things (eg things like `os::errno() != libc::ERROR_IO_PENDING as uint`\n  - and its inconsistent ... sometimes `libc::ERROR*` is cast to `uint`, sometimes to `int`\n- src/libnative/io/process.rs:586 seems to make an implicit assumption that errno is an i32\n\n```\n                let mut bytes = [0, ..4];\n                return match input.inner_read(bytes) {\n                    Ok(4) => {\n                        let errno = (bytes[0] << 24) as i32 |\n                                    (bytes[1] << 16) as i32 |\n                                    (bytes[2] <<  8) as i32 |\n                                    (bytes[3] <<  0) as i32;\n```\n- so does the code at line 640\n\n```\n            fn fail(output: &mut file::FileDesc) -> ! {\n                let errno = os::errno();\n                let bytes = [\n                    (errno << 24) as u8,\n                    (errno << 16) as u8,\n                    (errno <<  8) as u8,\n                    (errno <<  0) as u8,\n                ];\n                assert!(output.inner_write(bytes).is_ok());\n                unsafe { libc::_exit(1) }\n            }\n```\n- ./src/libstd/io/mod.rs:393 casts errno to an i32\n\n```\n        fn get_err(errno: i32) -> (IoErrorKind, &'static str) {\n            // FIXME: this should probably be a bit more descriptive...\n            match errno {\n                libc::EOF => (EndOfFile, \"end of file\"),\n                <clipped>\n            }\n        }\n\n        let (kind, desc) = get_err(errno as i32);\n        IoError {\n            kind: kind,\n            desc: desc,\n            detail: if detail && kind == OtherIoError {\n                Some(os::error_string(errno).as_slice().chars().map(|c| c.to_lowercase()).collect())\n            } else {\n                None\n            },\n        }\n    }\n```\n- `IoError::from_errno` signature will need to change of `errno` changes to a `c_int`\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/55685680/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/56164502",
    "html_url": "https://github.com/rust-lang/rust/pull/17265#issuecomment-56164502",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/17265",
    "id": 56164502,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU2MTY0NTAy",
    "user": {
      "login": "tomjakubowski",
      "id": 667901,
      "node_id": "MDQ6VXNlcjY2NzkwMQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/667901?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/tomjakubowski",
      "html_url": "https://github.com/tomjakubowski",
      "followers_url": "https://api.github.com/users/tomjakubowski/followers",
      "following_url": "https://api.github.com/users/tomjakubowski/following{/other_user}",
      "gists_url": "https://api.github.com/users/tomjakubowski/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/tomjakubowski/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/tomjakubowski/subscriptions",
      "organizations_url": "https://api.github.com/users/tomjakubowski/orgs",
      "repos_url": "https://api.github.com/users/tomjakubowski/repos",
      "events_url": "https://api.github.com/users/tomjakubowski/events{/privacy}",
      "received_events_url": "https://api.github.com/users/tomjakubowski/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-09-19T11:13:32Z",
    "updated_at": "2014-09-19T11:13:32Z",
    "body": "cc #16786 \n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/56164502/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/60413942",
    "html_url": "https://github.com/rust-lang/rust/pull/17265#issuecomment-60413942",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/17265",
    "id": 60413942,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYwNDEzOTQy",
    "user": {
      "login": "alexcrichton",
      "id": 64996,
      "node_id": "MDQ6VXNlcjY0OTk2",
      "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alexcrichton",
      "html_url": "https://github.com/alexcrichton",
      "followers_url": "https://api.github.com/users/alexcrichton/followers",
      "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}",
      "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions",
      "organizations_url": "https://api.github.com/users/alexcrichton/orgs",
      "repos_url": "https://api.github.com/users/alexcrichton/repos",
      "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alexcrichton/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-10-24T16:40:32Z",
    "updated_at": "2014-10-24T16:40:32Z",
    "body": "Closing due to inactivity, but feel free to reopen with a rebase!\n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/60413942/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/62051187",
    "html_url": "https://github.com/rust-lang/rust/pull/17265#issuecomment-62051187",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/17265",
    "id": 62051187,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYyMDUxMTg3",
    "user": {
      "login": "donkopotamus",
      "id": 4120456,
      "node_id": "MDQ6VXNlcjQxMjA0NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4120456?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/donkopotamus",
      "html_url": "https://github.com/donkopotamus",
      "followers_url": "https://api.github.com/users/donkopotamus/followers",
      "following_url": "https://api.github.com/users/donkopotamus/following{/other_user}",
      "gists_url": "https://api.github.com/users/donkopotamus/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/donkopotamus/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/donkopotamus/subscriptions",
      "organizations_url": "https://api.github.com/users/donkopotamus/orgs",
      "repos_url": "https://api.github.com/users/donkopotamus/repos",
      "events_url": "https://api.github.com/users/donkopotamus/events{/privacy}",
      "received_events_url": "https://api.github.com/users/donkopotamus/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-11-06T21:06:37Z",
    "updated_at": "2014-11-06T21:06:37Z",
    "body": "@alexcrichton I reopened this as PR #18642, which adds `errno() -> c_int` and `set_errno(c_int)` to `libc` and implements `std::os::errno() -> int` using those.  This addresses some of the comments in this old PR.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/62051187/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
