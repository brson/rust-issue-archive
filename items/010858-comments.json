[
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/30087783",
    "html_url": "https://github.com/rust-lang/rust/issues/10858#issuecomment-30087783",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10858",
    "id": 30087783,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMwMDg3Nzgz",
    "user": {
      "login": "alexcrichton",
      "id": 64996,
      "node_id": "MDQ6VXNlcjY0OTk2",
      "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alexcrichton",
      "html_url": "https://github.com/alexcrichton",
      "followers_url": "https://api.github.com/users/alexcrichton/followers",
      "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}",
      "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions",
      "organizations_url": "https://api.github.com/users/alexcrichton/orgs",
      "repos_url": "https://api.github.com/users/alexcrichton/repos",
      "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alexcrichton/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2013-12-08T18:33:52Z",
    "updated_at": "2013-12-08T18:33:52Z",
    "body": "While this looks the same, the cases are indeed behaving differently (which is why the borrow checker is complaining). In cases 1-3, you never move out of `n`, but in case 4 the intermediate value `(Nat, int)` is getting created to match against, which is indeed moving out of `n`. Essentially, your bindings with `ref` are occurring after it has already been moved (because the tuple is its own value).\n\nThis appears to be to be working-as-intended today, but I'm unsure of whether we'd want to try to allow things like this.\n\ncc @nikomatsakis \n",
    "author_association": "MEMBER",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/30087783/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/30092329",
    "html_url": "https://github.com/rust-lang/rust/issues/10858#issuecomment-30092329",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10858",
    "id": 30092329,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMwMDkyMzI5",
    "user": {
      "login": "ezyang",
      "id": 13564,
      "node_id": "MDQ6VXNlcjEzNTY0",
      "avatar_url": "https://avatars.githubusercontent.com/u/13564?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ezyang",
      "html_url": "https://github.com/ezyang",
      "followers_url": "https://api.github.com/users/ezyang/followers",
      "following_url": "https://api.github.com/users/ezyang/following{/other_user}",
      "gists_url": "https://api.github.com/users/ezyang/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ezyang/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ezyang/subscriptions",
      "organizations_url": "https://api.github.com/users/ezyang/orgs",
      "repos_url": "https://api.github.com/users/ezyang/repos",
      "events_url": "https://api.github.com/users/ezyang/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ezyang/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2013-12-08T20:47:58Z",
    "updated_at": "2013-12-08T20:47:58Z",
    "body": "It still seems to me that case 2 is being handled specially. Here is another variant which fails the borrow check:\n\n``` rust\nfn foo(input: &Nat) {\n    let mut n = input;\n    loop {\n        let x = *n;\n        n = match x {\n            S(~ref m) => m,\n            _ => return\n        }\n    }\n}\n```\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/30092329/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/30151024",
    "html_url": "https://github.com/rust-lang/rust/issues/10858#issuecomment-30151024",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/10858",
    "id": 30151024,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMwMTUxMDI0",
    "user": {
      "login": "nikomatsakis",
      "id": 155238,
      "node_id": "MDQ6VXNlcjE1NTIzOA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/155238?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nikomatsakis",
      "html_url": "https://github.com/nikomatsakis",
      "followers_url": "https://api.github.com/users/nikomatsakis/followers",
      "following_url": "https://api.github.com/users/nikomatsakis/following{/other_user}",
      "gists_url": "https://api.github.com/users/nikomatsakis/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nikomatsakis/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nikomatsakis/subscriptions",
      "organizations_url": "https://api.github.com/users/nikomatsakis/orgs",
      "repos_url": "https://api.github.com/users/nikomatsakis/repos",
      "events_url": "https://api.github.com/users/nikomatsakis/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nikomatsakis/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2013-12-09T17:13:20Z",
    "updated_at": "2013-12-09T17:13:31Z",
    "body": "This is behaving as intended. In case 4, the tuple creation expression perfoms a move, as @alexcrichton states. In the final example (modified case 2), the assignment to `x` creates a move.\n\nThe behavior of match with ref bindings _is_ a bit magical in that it accepts either an lvalue or an rvalue and either creates a ref into the lvalue or stores the rvalue in a temp location. `(*x, 0)` is an rvalue, hence the error message. You can address this problem by doing `(&*x, 0)` and matching with a pattern like `(&S(~ref m), n)`.\n\nClosing.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/30151024/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
