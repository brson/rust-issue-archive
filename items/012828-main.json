{
  "url": "https://api.github.com/repos/rust-lang/rust/issues/12828",
  "repository_url": "https://api.github.com/repos/rust-lang/rust",
  "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/12828/labels{/name}",
  "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/12828/comments",
  "events_url": "https://api.github.com/repos/rust-lang/rust/issues/12828/events",
  "html_url": "https://github.com/rust-lang/rust/pull/12828",
  "id": 29205259,
  "node_id": "MDExOlB1bGxSZXF1ZXN0MTM0MzY3Mzk=",
  "number": 12828,
  "title": "WIP: Incorporate variance into typeck",
  "user": {
    "login": "edwardw",
    "id": 454049,
    "node_id": "MDQ6VXNlcjQ1NDA0OQ==",
    "avatar_url": "https://avatars.githubusercontent.com/u/454049?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/edwardw",
    "html_url": "https://github.com/edwardw",
    "followers_url": "https://api.github.com/users/edwardw/followers",
    "following_url": "https://api.github.com/users/edwardw/following{/other_user}",
    "gists_url": "https://api.github.com/users/edwardw/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/edwardw/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/edwardw/subscriptions",
    "organizations_url": "https://api.github.com/users/edwardw/orgs",
    "repos_url": "https://api.github.com/users/edwardw/repos",
    "events_url": "https://api.github.com/users/edwardw/events{/privacy}",
    "received_events_url": "https://api.github.com/users/edwardw/received_events",
    "type": "User",
    "user_view_type": "public",
    "site_admin": false
  },
  "labels": [],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [],
  "milestone": null,
  "comments": 17,
  "created_at": "2014-03-11T18:39:19Z",
  "updated_at": "2014-06-13T10:45:23Z",
  "closed_at": "2014-03-22T17:39:46Z",
  "author_association": "CONTRIBUTOR",
  "type": null,
  "active_lock_reason": null,
  "draft": false,
  "pull_request": {
    "url": "https://api.github.com/repos/rust-lang/rust/pulls/12828",
    "html_url": "https://github.com/rust-lang/rust/pull/12828",
    "diff_url": "https://github.com/rust-lang/rust/pull/12828.diff",
    "patch_url": "https://github.com/rust-lang/rust/pull/12828.patch",
    "merged_at": null
  },
  "body": "Currently, rustc only does so for regions substitution. Applies the same\nrule to type and self parameter substitution.\n\nWith all three substitutions on, the following becomes legitimate:\n\n``` rust\nfn foo<'a, 'b>(x: &'b Option<&'a int>) -> Option<&'b int> {\n    *x\n}\n```\n\n`x` here is contravariant with respect to the region parameter `b`, so\nit is eligible to the return position, also contravariant.\n\nIt is also found that rustc handled one special case incorrectly. In\nvariance inference pass, constraints are added and then solved. But rustc\ndidn't add any constraint for nullary generic enum and struct so they\nwere classified as bivariant, the default. Then the following two\nimplementations of `Foo`:\n\n``` rust\npub struct S<T>;\n\nimpl Foo for S<int> {\n    fn bar(&self) {}\n}\n\nimpl Foo for S<uint> {\n    fn bar(&self) {}\n}\n```\n\nwould be identical therefor conflicting under type substitution, which\nis incorrect.\n\nCloses #3598.\nCloses #5781.\n",
  "closed_by": {
    "login": "edwardw",
    "id": 454049,
    "node_id": "MDQ6VXNlcjQ1NDA0OQ==",
    "avatar_url": "https://avatars.githubusercontent.com/u/454049?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/edwardw",
    "html_url": "https://github.com/edwardw",
    "followers_url": "https://api.github.com/users/edwardw/followers",
    "following_url": "https://api.github.com/users/edwardw/following{/other_user}",
    "gists_url": "https://api.github.com/users/edwardw/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/edwardw/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/edwardw/subscriptions",
    "organizations_url": "https://api.github.com/users/edwardw/orgs",
    "repos_url": "https://api.github.com/users/edwardw/repos",
    "events_url": "https://api.github.com/users/edwardw/events{/privacy}",
    "received_events_url": "https://api.github.com/users/edwardw/received_events",
    "type": "User",
    "user_view_type": "public",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/12828/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/12828/timeline",
  "performed_via_github_app": null,
  "state_reason": null,
  "_meta": {
    "type": "pr"
  }
}
