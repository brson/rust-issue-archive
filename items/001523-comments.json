[
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/3495607",
    "html_url": "https://github.com/rust-lang/rust/issues/1523#issuecomment-3495607",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/1523",
    "id": 3495607,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM0OTU2MDc=",
    "user": {
      "login": "brson",
      "id": 147214,
      "node_id": "MDQ6VXNlcjE0NzIxNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/brson",
      "html_url": "https://github.com/brson",
      "followers_url": "https://api.github.com/users/brson/followers",
      "following_url": "https://api.github.com/users/brson/following{/other_user}",
      "gists_url": "https://api.github.com/users/brson/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/brson/subscriptions",
      "organizations_url": "https://api.github.com/users/brson/orgs",
      "repos_url": "https://api.github.com/users/brson/repos",
      "events_url": "https://api.github.com/users/brson/events{/privacy}",
      "received_events_url": "https://api.github.com/users/brson/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2012-01-14T22:41:03Z",
    "updated_at": "2012-01-14T22:41:03Z",
    "body": "Maybe there's some way to build something that looks like try finally. It's not safe to put a block into a resource, but we could do it unsafely if we can guarantee the resource doesn't escape. Something that looks vaguely like:\n\n```\ntry {||\n  ... something\n} finally {||\n  ... always run this\n}\n```\n\nCould be implemented.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/3495607/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/3495921",
    "html_url": "https://github.com/rust-lang/rust/issues/1523#issuecomment-3495921",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/1523",
    "id": 3495921,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM0OTU5MjE=",
    "user": {
      "login": "brson",
      "id": 147214,
      "node_id": "MDQ6VXNlcjE0NzIxNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/brson",
      "html_url": "https://github.com/brson",
      "followers_url": "https://api.github.com/users/brson/followers",
      "following_url": "https://api.github.com/users/brson/following{/other_user}",
      "gists_url": "https://api.github.com/users/brson/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/brson/subscriptions",
      "organizations_url": "https://api.github.com/users/brson/orgs",
      "repos_url": "https://api.github.com/users/brson/repos",
      "events_url": "https://api.github.com/users/brson/events{/privacy}",
      "received_events_url": "https://api.github.com/users/brson/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2012-01-14T23:35:24Z",
    "updated_at": "2012-01-14T23:35:24Z",
    "body": "So this works:\n\n```\nimpl finally for fn@() {                                                                                                                           \n    fn finally(f: block()) {                                                                                                                       \n        resource r(f: fn@()) {                                                                                                                     \n            f();                                                                                                                                   \n        }                                                                                                                                          \n        unsafe {                                                                                                                                   \n            let _r = r(unsafe::reinterpret_cast(f));                                                                                               \n            self();                                                                                                                                \n        }                                                                                                                                          \n    }                                                                                                                                              \n}                                                                                                                                                  \n\nfn main() {                                                                                                                                        \n    let a = @\"toast\";                                                                                                                              \n    fn@() {                                                                                                                                        \n        log(error, \"test\");                                                                                                                        \n    }.finally {||                                                                                                                                  \n        log(error, a);                                                                                                                             \n    }                                                                                                                                              \n}  \n```\n\nThe only problem is that the try block is a fn@ not a fn& because of limitations on where you can write fn&.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/3495921/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/3496123",
    "html_url": "https://github.com/rust-lang/rust/issues/1523#issuecomment-3496123",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/1523",
    "id": 3496123,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM0OTYxMjM=",
    "user": {
      "login": "nikomatsakis",
      "id": 155238,
      "node_id": "MDQ6VXNlcjE1NTIzOA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/155238?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nikomatsakis",
      "html_url": "https://github.com/nikomatsakis",
      "followers_url": "https://api.github.com/users/nikomatsakis/followers",
      "following_url": "https://api.github.com/users/nikomatsakis/following{/other_user}",
      "gists_url": "https://api.github.com/users/nikomatsakis/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nikomatsakis/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nikomatsakis/subscriptions",
      "organizations_url": "https://api.github.com/users/nikomatsakis/orgs",
      "repos_url": "https://api.github.com/users/nikomatsakis/repos",
      "events_url": "https://api.github.com/users/nikomatsakis/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nikomatsakis/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2012-01-15T00:19:12Z",
    "updated_at": "2012-01-15T05:23:19Z",
    "body": "It seems to me that we should just define an inline resource syntax.  Admittedly, the \"finally\" code then appears at the top---but that kind of makes sense to me.  D has something similar: a way to say, \"this code will run on all exits\"\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/3496123/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/4465966",
    "html_url": "https://github.com/rust-lang/rust/issues/1523#issuecomment-4465966",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/1523",
    "id": 4465966,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ0NjU5NjY=",
    "user": {
      "login": "brson",
      "id": 147214,
      "node_id": "MDQ6VXNlcjE0NzIxNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/brson",
      "html_url": "https://github.com/brson",
      "followers_url": "https://api.github.com/users/brson/followers",
      "following_url": "https://api.github.com/users/brson/following{/other_user}",
      "gists_url": "https://api.github.com/users/brson/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/brson/subscriptions",
      "organizations_url": "https://api.github.com/users/brson/orgs",
      "repos_url": "https://api.github.com/users/brson/repos",
      "events_url": "https://api.github.com/users/brson/events{/privacy}",
      "received_events_url": "https://api.github.com/users/brson/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2012-03-13T01:41:30Z",
    "updated_at": "2012-03-13T01:41:30Z",
    "body": "I took another stab at it:\n\n```\nfn main() {\n    let a = @\"toast\";\n    {|finally| try(finally) {||\n        log(error, \"test\");\n    } } {||\n        log(error, a);\n    }\n}\n\nfn try(finally: fn(), try: fn()) {\n    resource r(finally: fn@()) {\n        finally();\n    }\n    unsafe {\n        let finally: *u8 = unsafe::reinterpret_cast(ptr::addr_of(finally));\n        let wrapper = fn@() {\n            (*unsafe::reinterpret_cast::<*u8, *fn()>(finally))();\n        };\n        let _r = r(wrapper);\n        try();\n    }\n}\n```\n\nIt's hideous, but it's all stack closures.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/4465966/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/5101842",
    "html_url": "https://github.com/rust-lang/rust/issues/1523#issuecomment-5101842",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/1523",
    "id": 5101842,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUxMDE4NDI=",
    "user": {
      "login": "catamorphism",
      "id": 427212,
      "node_id": "MDQ6VXNlcjQyNzIxMg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/427212?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/catamorphism",
      "html_url": "https://github.com/catamorphism",
      "followers_url": "https://api.github.com/users/catamorphism/followers",
      "following_url": "https://api.github.com/users/catamorphism/following{/other_user}",
      "gists_url": "https://api.github.com/users/catamorphism/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/catamorphism/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/catamorphism/subscriptions",
      "organizations_url": "https://api.github.com/users/catamorphism/orgs",
      "repos_url": "https://api.github.com/users/catamorphism/repos",
      "events_url": "https://api.github.com/users/catamorphism/events{/privacy}",
      "received_events_url": "https://api.github.com/users/catamorphism/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2012-04-12T22:08:33Z",
    "updated_at": "2012-04-12T22:08:33Z",
    "body": "If resources are going away, to be replaced with classes, how does that affect this issue? Currently it doesn't seem possible to have \"anonymous\" classes, since classes are inherently nominal.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/5101842/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/5129581",
    "html_url": "https://github.com/rust-lang/rust/issues/1523#issuecomment-5129581",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/1523",
    "id": 5129581,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUxMjk1ODE=",
    "user": {
      "login": "brson",
      "id": 147214,
      "node_id": "MDQ6VXNlcjE0NzIxNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/brson",
      "html_url": "https://github.com/brson",
      "followers_url": "https://api.github.com/users/brson/followers",
      "following_url": "https://api.github.com/users/brson/following{/other_user}",
      "gists_url": "https://api.github.com/users/brson/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/brson/subscriptions",
      "organizations_url": "https://api.github.com/users/brson/orgs",
      "repos_url": "https://api.github.com/users/brson/repos",
      "events_url": "https://api.github.com/users/brson/events{/privacy}",
      "received_events_url": "https://api.github.com/users/brson/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2012-04-14T07:43:55Z",
    "updated_at": "2012-04-14T07:43:55Z",
    "body": "I'm hoping that classes with region fields can be used to build defer, but I don't know how.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/5129581/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/13257434",
    "html_url": "https://github.com/rust-lang/rust/issues/1523#issuecomment-13257434",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/1523",
    "id": 13257434,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEzMjU3NDM0",
    "user": {
      "login": "catamorphism",
      "id": 427212,
      "node_id": "MDQ6VXNlcjQyNzIxMg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/427212?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/catamorphism",
      "html_url": "https://github.com/catamorphism",
      "followers_url": "https://api.github.com/users/catamorphism/followers",
      "following_url": "https://api.github.com/users/catamorphism/following{/other_user}",
      "gists_url": "https://api.github.com/users/catamorphism/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/catamorphism/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/catamorphism/subscriptions",
      "organizations_url": "https://api.github.com/users/catamorphism/orgs",
      "repos_url": "https://api.github.com/users/catamorphism/repos",
      "events_url": "https://api.github.com/users/catamorphism/events{/privacy}",
      "received_events_url": "https://api.github.com/users/catamorphism/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2013-02-07T20:21:36Z",
    "updated_at": "2013-02-07T20:21:36Z",
    "body": "Closing this because the last activity was 10 months ago and I'm going to assume that was @brson was hoping for is true. Reopen if necessary.\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/13257434/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
