{
  "url": "https://api.github.com/repos/rust-lang/rust/issues/12144",
  "repository_url": "https://api.github.com/repos/rust-lang/rust",
  "labels_url": "https://api.github.com/repos/rust-lang/rust/issues/12144/labels{/name}",
  "comments_url": "https://api.github.com/repos/rust-lang/rust/issues/12144/comments",
  "events_url": "https://api.github.com/repos/rust-lang/rust/issues/12144/events",
  "html_url": "https://github.com/rust-lang/rust/pull/12144",
  "id": 27237802,
  "node_id": "MDExOlB1bGxSZXF1ZXN0MTIzNTY4ODM=",
  "number": 12144,
  "title": "Give all fatals, errors, and warnings unique diagnostic codes",
  "user": {
    "login": "brson",
    "id": 147214,
    "node_id": "MDQ6VXNlcjE0NzIxNA==",
    "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/brson",
    "html_url": "https://github.com/brson",
    "followers_url": "https://api.github.com/users/brson/followers",
    "following_url": "https://api.github.com/users/brson/following{/other_user}",
    "gists_url": "https://api.github.com/users/brson/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/brson/subscriptions",
    "organizations_url": "https://api.github.com/users/brson/orgs",
    "repos_url": "https://api.github.com/users/brson/repos",
    "events_url": "https://api.github.com/users/brson/events{/privacy}",
    "received_events_url": "https://api.github.com/users/brson/received_events",
    "type": "User",
    "user_view_type": "public",
    "site_admin": false
  },
  "labels": [],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [],
  "milestone": null,
  "comments": 18,
  "created_at": "2014-02-10T02:05:32Z",
  "updated_at": "2014-07-01T16:36:18Z",
  "closed_at": "2014-04-04T21:01:58Z",
  "author_association": "CONTRIBUTOR",
  "type": null,
  "active_lock_reason": null,
  "draft": false,
  "pull_request": {
    "url": "https://api.github.com/repos/rust-lang/rust/pulls/12144",
    "html_url": "https://github.com/rust-lang/rust/pull/12144",
    "diff_url": "https://github.com/rust-lang/rust/pull/12144.diff",
    "patch_url": "https://github.com/rust-lang/rust/pull/12144.patch",
    "merged_at": null
  },
  "body": "Initial support for #2092.\n\nThere's a lot more that can be done to make this useful, but I'm hoping to get at least the error code conversion upstream.\n\nCodes are a single letter followed by four digits, 'C0348'. The letter is just a simple namespace, currently rustc uses 'A', `syntax::ext` uses 'B', and the rest of `syntax` uses 'C'. For errors to be stable we have to live with this scheme forever, so think about it.\n\nThe procedure for introducing a new error is:\n\n1) Add a new code to either `libsyntax/diag_index.rs` or `librustc/diag_index.rs`, depending on which crate emits the errors.\n2) Use the code in the `span_fatal!`, `span_err!`, `span_warn!`, `alert_fatal!`, `alert_err!`, `alert_warn!` macros:\n\n```\nspan_fatal!(cx, sp, C0348, \"found a rotten {}\", vegetable);\n```\n\nThen some time later to add a FAQ about it you modify the `diag_db_data.rs` file:\n\n```\n(C0348, \"\n\nSome markdown about the error.\n\n\")\n```\n\nWhen the user hits the error it says\n\n```\n../src/test/compile-fail/bad-bang-ann.rs:14:5: 14:36 error: found a rotten potato [C0348*]\n../src/test/compile-fail/bad-bang-ann.rs:14     if i < 0u { } else { fail!(); }\n                                                ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\nerror: aborting due to previous error\nnote: some of these errors have extended explanations (see `rustc --explain help`)\n```\n\nThe error code is displayed in magenta `[C0348*]`, with the asterisk indicating there is additional info. Then there's a note at the end that hints how to use it.\n\nYou then run `rustc --explain help` to learn about this feature.\n\n```\nRust includes extended documentation about some compiler errors\nthat explain in greater depth what the errors means, present examples,\nand suggestions for how to fix them.\n\nEach Rust error message has a corresponding code. When emitted by\nrustc the code will be included in square brackets, like `[A0001]`. If\nthe error has additional documentation the code will be appended with\nan asterisk, as in `[A0002*]`.\n\nTo view the extended documentation, run `rustc --explain A0002`, replacing\n'A0002' with your error code.\n\nThe extent and quality of extended error documentation depends on user\ncontributions. To learn how to improve Rust's error documentation visit\nhttp://github.com/mozilla/rust/wiki/Note-extended-diagnostics.\n```\n\nYou then rust `rustc --explain C0348` to get\n\n```\n# C0348: found a rotten {}\n\nSome markdown about the error.\n```\n## Weaknesses\n- There are a lot of very similar errors, particularly in the syntax crate, that all get different codes.\n- Lints all fall under a single code for now because they are reported in a way that is not compatible with the macros used in this scheme.\n- Splitting up the `diag_index.rs` files when refactoring crates could get ugly.\n- Editing docs means editing Rust macros in a .rs file.\n- The extended docs use the error's format string as a title, and some of our fmt strings are like \"{} {}\", which is not instructive. I think we may be able to substitute parameter names into the fmt strings to make them display better.\n- Could be documented better.\n- No actually extended docs yet.\n- This adds a `__tt_map` feature gate and two ugly syntax extensions behind it.\n## Future\n- Needs to export docs to markdown so examples can be tested\n- Need to create wiki page mentioned in `--explain help`\n",
  "closed_by": {
    "login": "alexcrichton",
    "id": 64996,
    "node_id": "MDQ6VXNlcjY0OTk2",
    "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/alexcrichton",
    "html_url": "https://github.com/alexcrichton",
    "followers_url": "https://api.github.com/users/alexcrichton/followers",
    "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}",
    "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions",
    "organizations_url": "https://api.github.com/users/alexcrichton/orgs",
    "repos_url": "https://api.github.com/users/alexcrichton/repos",
    "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}",
    "received_events_url": "https://api.github.com/users/alexcrichton/received_events",
    "type": "User",
    "user_view_type": "public",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/12144/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/rust-lang/rust/issues/12144/timeline",
  "performed_via_github_app": null,
  "state_reason": null,
  "_meta": {
    "type": "pr"
  }
}
