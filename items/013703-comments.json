[
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/41152312",
    "html_url": "https://github.com/rust-lang/rust/issues/13703#issuecomment-41152312",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/13703",
    "id": 41152312,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQxMTUyMzEy",
    "user": {
      "login": "pnkfelix",
      "id": 173127,
      "node_id": "MDQ6VXNlcjE3MzEyNw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/173127?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/pnkfelix",
      "html_url": "https://github.com/pnkfelix",
      "followers_url": "https://api.github.com/users/pnkfelix/followers",
      "following_url": "https://api.github.com/users/pnkfelix/following{/other_user}",
      "gists_url": "https://api.github.com/users/pnkfelix/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/pnkfelix/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/pnkfelix/subscriptions",
      "organizations_url": "https://api.github.com/users/pnkfelix/orgs",
      "repos_url": "https://api.github.com/users/pnkfelix/repos",
      "events_url": "https://api.github.com/users/pnkfelix/events{/privacy}",
      "received_events_url": "https://api.github.com/users/pnkfelix/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-04-23T11:58:32Z",
    "updated_at": "2014-04-23T11:58:32Z",
    "body": "cc @nikomatsakis \n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/41152312/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/41876989",
    "html_url": "https://github.com/rust-lang/rust/issues/13703#issuecomment-41876989",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/13703",
    "id": 41876989,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQxODc2OTg5",
    "user": {
      "login": "Valloric",
      "id": 919444,
      "node_id": "MDQ6VXNlcjkxOTQ0NA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/919444?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Valloric",
      "html_url": "https://github.com/Valloric",
      "followers_url": "https://api.github.com/users/Valloric/followers",
      "following_url": "https://api.github.com/users/Valloric/following{/other_user}",
      "gists_url": "https://api.github.com/users/Valloric/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Valloric/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Valloric/subscriptions",
      "organizations_url": "https://api.github.com/users/Valloric/orgs",
      "repos_url": "https://api.github.com/users/Valloric/repos",
      "events_url": "https://api.github.com/users/Valloric/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Valloric/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-05-01T03:34:38Z",
    "updated_at": "2014-06-11T03:58:19Z",
    "body": "I think this issue (as pointed out by @eddyb in IRC) is currently preventing me from implementing iterators for a trait. Here's my testcase (I've reduced it quite a bit from the original code):\n\n``` rust\nuse std::iter::Iterator;\n\npub struct PreOrderNodes<'a, 'b> {\n  queue: Vec<&'a Node<'b>>\n}\n\nimpl<'a, 'b> Iterator<&'a Node<'b>> for PreOrderNodes<'a, 'b> {\n  fn next( &mut self ) -> Option<&'a Node<'b>> {\n    match self.queue.pop() {\n      ex @ Some( node ) => {\n        match node.contents {\n          Children( ref x ) => {\n            for child in x.as_slice().iter().rev() {\n              self.queue.push( child )\n            }\n          }\n          _ => ()\n        };\n        ex\n      }\n      _ => None\n    }\n  }\n}\n\npub enum NodeContents<'a> {\n  Data( &'a [u8] ),\n  Children( Vec<Node<'a>> )\n}\n\n\npub struct Node<'a> {\n  pub name: &'static str,\n  pub contents: NodeContents<'a>\n}\n\nimpl<'a> Node<'a> {\n  pub fn preOrder<'b>( &'b self ) -> PreOrderNodes<'b, 'a> {\n    PreOrderNodes { queue: vec!( self ) }\n  }\n}\n\n#[cfg(test)]\nmod tests {\n  use super::{Node, Data};\n\n  #[test]\n  fn preOrder() {\n    static data: &'static [u8] = &[];\n    let root = Node { name: \"a\", contents: Data( data ) };\n    let mut names : Vec<char> = vec!();\n    root.preOrder().map( |x| {\n      names.push( x.name.char_at( 0 ) )\n    });\n\n    assert_eq!( names, vec!( 'a' ) )\n  }\n}\n```\n\nThat with `rustc --test testcase.rs` (with rustc compiled from commit 9f484e6) gives me the following:\n\n```\ntestcase.rs:14:15: 14:25 error: in type `&mut std::vec::Vec<&'a Node<'b>>`, pointer has a longer lifetime than the data it references\ntestcase.rs:14               self.queue.push( child )\n                             ^~~~~~~~~~\ntestcase.rs:8:48: 23:4 note: the pointer is valid for the lifetime &'a  as defined on the block at 8:47\ntestcase.rs:8   fn next( &mut self ) -> Option<&'a Node<'b>> {\ntestcase.rs:9     match self.queue.pop() {\ntestcase.rs:10       ex @ Some( node ) => {\ntestcase.rs:11         match node.contents {\ntestcase.rs:12           Children( ref x ) => {\ntestcase.rs:13             for child in x.as_slice().rev_iter() {\n               ...\ntestcase.rs:8:48: 23:4 note: but the referenced data is only valid for the lifetime &'b  as defined on the block at 8:47\ntestcase.rs:8   fn next( &mut self ) -> Option<&'a Node<'b>> {\ntestcase.rs:9     match self.queue.pop() {\ntestcase.rs:10       ex @ Some( node ) => {\ntestcase.rs:11         match node.contents {\ntestcase.rs:12           Children( ref x ) => {\ntestcase.rs:13             for child in x.as_slice().rev_iter() {\n               ...\ntestcase.rs:8:3: 23:4 note: consider using an explicit lifetime parameter as shown: fn next(&mut self) -> Option<&'a Node<'a>>\ntestcase.rs:8   fn next( &mut self ) -> Option<&'a Node<'b>> {\ntestcase.rs:9     match self.queue.pop() {\ntestcase.rs:10       ex @ Some( node ) => {\ntestcase.rs:11         match node.contents {\ntestcase.rs:12           Children( ref x ) => {\ntestcase.rs:13             for child in x.as_slice().rev_iter() {\n               ...\ntestcase.rs:12:21: 12:26 error: cannot infer an appropriate lifetime for pattern due to conflicting requirements\ntestcase.rs:12           Children( ref x ) => {\n                                   ^~~~~\nerror: aborting due to 2 previous errors\n```\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/41876989/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/54555954",
    "html_url": "https://github.com/rust-lang/rust/issues/13703#issuecomment-54555954",
    "issue_url": "https://api.github.com/repos/rust-lang/rust/issues/13703",
    "id": 54555954,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU0NTU1OTU0",
    "user": {
      "login": "huonw",
      "id": 1203825,
      "node_id": "MDQ6VXNlcjEyMDM4MjU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1203825?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/huonw",
      "html_url": "https://github.com/huonw",
      "followers_url": "https://api.github.com/users/huonw/followers",
      "following_url": "https://api.github.com/users/huonw/following{/other_user}",
      "gists_url": "https://api.github.com/users/huonw/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/huonw/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/huonw/subscriptions",
      "organizations_url": "https://api.github.com/users/huonw/orgs",
      "repos_url": "https://api.github.com/users/huonw/repos",
      "events_url": "https://api.github.com/users/huonw/events{/privacy}",
      "received_events_url": "https://api.github.com/users/huonw/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "created_at": "2014-09-04T22:42:42Z",
    "updated_at": "2014-09-04T22:42:53Z",
    "body": "This was fixed by https://github.com/rust-lang/rust/pull/16453. Both versions of `foo` now compile by changing the `Foo` definition to\n\n``` rust\npub struct Foo<'a, 'b: 'a> { foo: &'a &'b int }\n```\n",
    "author_association": "CONTRIBUTOR",
    "reactions": {
      "url": "https://api.github.com/repos/rust-lang/rust/issues/comments/54555954/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
